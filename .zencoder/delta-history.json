{"snapshots":{"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/main.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/main.dart","baseContent":"import 'package:flutter/material.dart';\n\nvoid main() {\n  runApp(const MyApp());\n}","baseTimestamp":1754368554988,"deltas":[{"timestamp":1754617623421,"changes":[{"type":"DELETE","lineNumber":50,"oldContent":"     "},{"type":"INSERT","lineNumber":51,"content":"      providers: ["},{"type":"INSERT","lineNumber":52,"content":"     "}]},{"timestamp":1754617626591,"changes":[{"type":"MODIFY","lineNumber":6,"content":"import 'package:family_tree_firebase/core/di/injection_container.dart' as di;","oldContent":"  runApp(const MyApp());"},{"type":"MODIFY","lineNumber":23,"content":"import 'package:family_tree_firebase/features/home/presentation/screens/home_screen.dart';","oldContent":"              );"},{"type":"DELETE","lineNumber":50,"oldContent":"      providers: ["}]},{"timestamp":1754617631609,"changes":[{"type":"MODIFY","lineNumber":50,"content":"    return MultiProvider();","oldContent":"    return MultiProvider("}]},{"timestamp":1754617634118,"changes":[{"type":"INSERT","lineNumber":51,"content":"    "}]},{"timestamp":1754617640052,"changes":[{"type":"MODIFY","lineNumber":3,"content":"import 'package:shared_preferences/shared_preferences.dart';","oldContent":"void main() {"},{"type":"MODIFY","lineNumber":51,"content":"  }","oldContent":"    "},{"type":"INSERT","lineNumber":52,"content":"  "}]},{"timestamp":1754617642742,"changes":[{"type":"MODIFY","lineNumber":52,"content":"  }","oldContent":"  "}]},{"timestamp":1754617648296,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:google_fonts/google_fonts.dart';","oldContent":"void main() {"},{"type":"MODIFY","lineNumber":7,"content":"import 'package:family_tree_firebase/core/theme/app_theme.dart';","oldContent":"            );"},{"type":"DELETE","lineNumber":9,"oldContent":"              ),"},{"type":"DELETE","lineNumber":10,"oldContent":"      ),"},{"type":"INSERT","lineNumber":9,"content":"import 'package:family_tree_firebase/core/utils/shared_prefs_manager.dart';"},{"type":"INSERT","lineNumber":10,"content":""},{"type":"MODIFY","lineNumber":38,"content":"  await Firebase.initializeApp(","oldContent":"      ),"},{"type":"MODIFY","lineNumber":50,"content":"    return MultiProvider(providers: [],);","oldContent":"    return MultiProvider();"}]},{"timestamp":1754617657912,"changes":[{"type":"MODIFY","lineNumber":18,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/otp_verification_screen.dart';","oldContent":"          return const SplashScreen();"},{"type":"MODIFY","lineNumber":21,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/success_screen.dart';","oldContent":"              );"},{"type":"DELETE","lineNumber":24,"oldContent":"  await di.init();"},{"type":"DELETE","lineNumber":25,"oldContent":"  "},{"type":"INSERT","lineNumber":24,"content":"import 'package:family_tree_firebase/features/splash/presentation/screens/splash_screen.dart';"},{"type":"INSERT","lineNumber":25,"content":""},{"type":"MODIFY","lineNumber":50,"content":"    return M","oldContent":"    return MultiProvider(providers: [],);"}]},{"timestamp":1754617663876,"changes":[{"type":"MODIFY","lineNumber":4,"content":"","oldContent":"}"},{"type":"MODIFY","lineNumber":8,"content":"import 'package:family_tree_firebase/core/utils/navigation_service.dart';","oldContent":"import 'package:firebase_core/firebase_core.dart';"},{"type":"MODIFY","lineNumber":19,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/register_screen.dart';","oldContent":"import 'package:family_tree_firebase/features/auth/domain/usecases/check_auth_status.dart';"},{"type":"MODIFY","lineNumber":27,"content":"import 'package:family_tree_firebase/features/auth/domain/usecases/check_auth_status.dart';","oldContent":"                  return const MaterialPageRoute("},{"type":"MODIFY","lineNumber":50,"content":"    return Ma","oldContent":"    return M"}]},{"timestamp":1754617671191,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:provider/provider.dart';","oldContent":""},{"type":"DELETE","lineNumber":11,"oldContent":"                  return const MaterialPageRoute("},{"type":"DELETE","lineNumber":12,"oldContent":"                default:"},{"type":"INSERT","lineNumber":11,"content":"// Features - ViewModels"},{"type":"INSERT","lineNumber":12,"content":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"MODIFY","lineNumber":15,"content":"","oldContent":"                  );"},{"type":"MODIFY","lineNumber":20,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/setup_password_screen.dart';","oldContent":"                  );"},{"type":"MODIFY","lineNumber":50,"content":"    return MaterialApp()","oldContent":"    return Ma"}]},{"timestamp":1754617675645,"changes":[{"type":"MODIFY","lineNumber":17,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/login_screen.dart';","oldContent":"              }"},{"type":"DELETE","lineNumber":31,"oldContent":"                case AppConstants.successRoute:"},{"type":"DELETE","lineNumber":32,"oldContent":"                  );"},{"type":"DELETE","lineNumber":33,"oldContent":"        ),"},{"type":"DELETE","lineNumber":34,"oldContent":"          create: (context) => di.sl<FamilyViewModel>(),"},{"type":"DELETE","lineNumber":35,"oldContent":"        // Family ViewModel"},{"type":"DELETE","lineNumber":36,"oldContent":"        ),"},{"type":"INSERT","lineNumber":31,"content":"import 'firebase_options.dart';"},{"type":"INSERT","lineNumber":33,"content":"Future<void> main() async {"},{"type":"INSERT","lineNumber":34,"content":"  // Ensure Flutter binding is initialized"},{"type":"INSERT","lineNumber":35,"content":"  WidgetsFlutterBinding.ensureInitialized();"},{"type":"INSERT","lineNumber":36,"content":"  "},{"type":"INSERT","lineNumber":37,"content":"  // Initialize Firebase"},{"type":"MODIFY","lineNumber":50,"content":"    return MaterialApp(","oldContent":"    return MaterialApp()"},{"type":"INSERT","lineNumber":51,"content":"      title: 'Family Tree Firebase',"},{"type":"INSERT","lineNumber":52,"content":"      theme: appTheme,"},{"type":"INSERT","lineNumber":53,"content":"      home: const SplashScreen(),"},{"type":"INSERT","lineNumber":54,"content":"    );"}]},{"timestamp":1754617693285,"changes":[{"type":"DELETE","lineNumber":29,"oldContent":"                  return const MaterialPageRoute("},{"type":"DELETE","lineNumber":30,"oldContent":"                  );"},{"type":"INSERT","lineNumber":29,"content":"// Firebase"},{"type":"INSERT","lineNumber":30,"content":"import 'package:firebase_core/firebase_core.dart';"},{"type":"INSERT","lineNumber":32,"content":""},{"type":"DELETE","lineNumber":37,"oldContent":"                  final args = settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":52,"oldContent":"  }"},{"type":"INSERT","lineNumber":53,"content":"      home: const (),"},{"type":"INSERT","lineNumber":54,"content":"    );"},{"type":"DELETE","lineNumber":55,"oldContent":"      home: const SplashScreen(),"},{"type":"INSERT","lineNumber":56,"content":"  }"},{"type":"DELETE","lineNumber":57,"oldContent":"    );"}]},{"timestamp":1754617697310,"changes":[{"type":"MODIFY","lineNumber":16,"content":"// Features - Screens","oldContent":"                      message: args?['message'] ?? 'Operation completed successfully',"},{"type":"DELETE","lineNumber":46,"oldContent":"                    builder: (_) => SuccessScreen("},{"type":"DELETE","lineNumber":47,"oldContent":"                  return MaterialPageRoute("},{"type":"DELETE","lineNumber":48,"oldContent":"        ),"},{"type":"DELETE","lineNumber":49,"oldContent":"        ChangeNotifierProvider<AuthViewModel>("},{"type":"INSERT","lineNumber":46,"content":"  const MyApp({super.key});"},{"type":"INSERT","lineNumber":47,"content":""},{"type":"INSERT","lineNumber":48,"content":"  @override"},{"type":"INSERT","lineNumber":49,"content":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":52,"oldContent":"      home: const (),"},{"type":"INSERT","lineNumber":53,"content":"      "}]},{"timestamp":1754617701098,"changes":[{"type":"MODIFY","lineNumber":13,"content":"import 'package:family_tree_firebase/features/family/presentation/viewmodels/family_viewmodel.dart';","oldContent":"                  return MaterialPageRoute("},{"type":"MODIFY","lineNumber":28,"content":"","oldContent":"    // Initialize SharedPreferences"},{"type":"DELETE","lineNumber":44,"oldContent":"          );"},{"type":"DELETE","lineNumber":45,"oldContent":"                  );"},{"type":"INSERT","lineNumber":44,"content":""},{"type":"INSERT","lineNumber":45,"content":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":53,"oldContent":"      theme: appTheme,"}]},{"timestamp":1754617707907,"changes":[{"type":"DELETE","lineNumber":1,"oldContent":"import 'package:provider/provider.dart';"},{"type":"DELETE","lineNumber":2,"oldContent":"import 'package:google_fonts/google_fonts.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:shared_preferences/shared_preferences.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":""},{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/core/constants/app_constants.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":"import 'package:family_tree_firebase/core/di/injection_container.dart' as di;"},{"type":"DELETE","lineNumber":7,"oldContent":"import 'package:family_tree_firebase/core/theme/app_theme.dart';"},{"type":"DELETE","lineNumber":8,"oldContent":"import 'package:family_tree_firebase/core/utils/navigation_service.dart';"},{"type":"DELETE","lineNumber":9,"oldContent":"import 'package:family_tree_firebase/core/utils/shared_prefs_manager.dart';"},{"type":"DELETE","lineNumber":10,"oldContent":""},{"type":"DELETE","lineNumber":11,"oldContent":"// Features - ViewModels"},{"type":"DELETE","lineNumber":12,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"DELETE","lineNumber":13,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/viewmodels/family_viewmodel.dart';"},{"type":"DELETE","lineNumber":14,"oldContent":"import 'package:family_tree_firebase/features/splash/presentation/viewmodels/splash_viewmodel.dart';"},{"type":"DELETE","lineNumber":15,"oldContent":""},{"type":"DELETE","lineNumber":16,"oldContent":"// Features - Screens"},{"type":"DELETE","lineNumber":17,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/login_screen.dart';"},{"type":"DELETE","lineNumber":18,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/otp_verification_screen.dart';"},{"type":"DELETE","lineNumber":19,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/register_screen.dart';"},{"type":"DELETE","lineNumber":20,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/setup_password_screen.dart';"},{"type":"DELETE","lineNumber":21,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/success_screen.dart';"},{"type":"DELETE","lineNumber":22,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/screens/join_or_create_family_screen.dart';"},{"type":"DELETE","lineNumber":23,"oldContent":"import 'package:family_tree_firebase/features/home/presentation/screens/home_screen.dart';"},{"type":"DELETE","lineNumber":24,"oldContent":"import 'package:family_tree_firebase/features/splash/presentation/screens/splash_screen.dart';"},{"type":"DELETE","lineNumber":25,"oldContent":""},{"type":"DELETE","lineNumber":26,"oldContent":"                case AppConstants.successRoute:"},{"type":"DELETE","lineNumber":27,"oldContent":"import 'package:family_tree_firebase/features/auth/domain/usecases/check_auth_status.dart';"},{"type":"DELETE","lineNumber":28,"oldContent":""},{"type":"DELETE","lineNumber":40,"oldContent":"                  );"},{"type":"DELETE","lineNumber":41,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":12,"content":"  );"},{"type":"INSERT","lineNumber":13,"content":"  "}]},{"timestamp":1754617721226,"changes":[{"type":"DELETE","lineNumber":1,"oldContent":"  );"},{"type":"DELETE","lineNumber":2,"oldContent":"  "},{"type":"DELETE","lineNumber":13,"oldContent":"                case AppConstants.successRoute:"},{"type":"INSERT","lineNumber":11,"content":"    options: DefaultFirebaseOptions.currentPlatform,"},{"type":"INSERT","lineNumber":12,"content":"  );"},{"type":"INSERT","lineNumber":13,"content":""},{"type":"MODIFY","lineNumber":24,"content":"","oldContent":"      "},{"type":"MODIFY","lineNumber":26,"content":"  }","oldContent":"      home: const SplashScreen(),"},{"type":"INSERT","lineNumber":27,"content":"  }"},{"type":"INSERT","lineNumber":28,"content":""}]},{"timestamp":1754621225755,"changes":[{"type":"DELETE","lineNumber":0,"oldContent":"import 'package:flutter/material.dart';"},{"type":"DELETE","lineNumber":1,"oldContent":"// Firebase"},{"type":"INSERT","lineNumber":0,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/login_screen.dart';"},{"type":"INSERT","lineNumber":2,"content":"import 'package:flutter/material.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"INSERT","lineNumber":4,"content":""},{"type":"INSERT","lineNumber":5,"content":"import 'app.dart';"},{"type":"INSERT","lineNumber":6,"content":"import 'features/auth/presentation/bloc/auth_bloc.dart';"},{"type":"DELETE","lineNumber":9,"oldContent":"    options: DefaultFirebaseOptions.currentPlatform,"},{"type":"DELETE","lineNumber":10,"oldContent":"  // Initialize Firebase"},{"type":"DELETE","lineNumber":11,"oldContent":"  );"},{"type":"DELETE","lineNumber":12,"oldContent":"  await Firebase.initializeApp("},{"type":"DELETE","lineNumber":13,"oldContent":""},{"type":"DELETE","lineNumber":14,"oldContent":"      title: 'Family Tree Firebase',"},{"type":"INSERT","lineNumber":13,"content":"  try {"},{"type":"INSERT","lineNumber":14,"content":"    // Initialize Firebase"},{"type":"INSERT","lineNumber":15,"content":"    await Firebase.initializeApp("},{"type":"INSERT","lineNumber":16,"content":"      options: DefaultFirebaseOptions.currentPlatform,"},{"type":"INSERT","lineNumber":17,"content":"    );"},{"type":"INSERT","lineNumber":18,"content":"    "},{"type":"INSERT","lineNumber":19,"content":"    // Enable Firebase emulator for development"},{"type":"INSERT","lineNumber":20,"content":"    // Uncomment and update with your emulator host and port"},{"type":"INSERT","lineNumber":21,"content":"    // await _connectToFirebaseEmulator();"},{"type":"INSERT","lineNumber":22,"content":"    "},{"type":"INSERT","lineNumber":23,"content":"    runApp("},{"type":"INSERT","lineNumber":24,"content":"      MultiBlocProvider("},{"type":"INSERT","lineNumber":25,"content":"        providers: ["},{"type":"INSERT","lineNumber":26,"content":"          BlocProvider(create: (_) => AuthBloc()..add(CheckAuthStatus())),"},{"type":"INSERT","lineNumber":27,"content":"        ],"},{"type":"INSERT","lineNumber":28,"content":"        child: const MyApp(),"},{"type":"INSERT","lineNumber":29,"content":"      ),"},{"type":"INSERT","lineNumber":30,"content":"    );"},{"type":"INSERT","lineNumber":31,"content":"  } catch (e) {"},{"type":"INSERT","lineNumber":32,"content":"    // Handle Firebase initialization errors"},{"type":"INSERT","lineNumber":33,"content":"    debugPrint('Firebase initialization error: $e');"},{"type":"INSERT","lineNumber":34,"content":"    runApp("},{"type":"INSERT","lineNumber":35,"content":"      MaterialApp("},{"type":"INSERT","lineNumber":36,"content":"        home: Scaffold("},{"type":"INSERT","lineNumber":37,"content":"          body: Center("},{"type":"INSERT","lineNumber":38,"content":"            child: Text('Error initializing Firebase: $e'),"},{"type":"INSERT","lineNumber":39,"content":"          ),"},{"type":"INSERT","lineNumber":40,"content":"        ),"},{"type":"INSERT","lineNumber":41,"content":"      ),"},{"type":"INSERT","lineNumber":42,"content":"    );"},{"type":"INSERT","lineNumber":44,"content":"}"},{"type":"DELETE","lineNumber":17,"oldContent":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":18,"oldContent":"  const MyApp({super.key});"},{"type":"INSERT","lineNumber":46,"content":"// Helper function to connect to Firebase emulator (for development)"},{"type":"INSERT","lineNumber":47,"content":"// Future<void> _connectToFirebaseEmulator() async {"},{"type":"INSERT","lineNumber":48,"content":"//   final host = 'localhost';"},{"type":"INSERT","lineNumber":49,"content":"//   await FirebaseAuth.instance.useAuthEmulator(host, 9099);"},{"type":"INSERT","lineNumber":50,"content":"//   FirebaseFirestore.instance.useFirestoreEmulator(host, 8080);"},{"type":"INSERT","lineNumber":51,"content":"//   await FirebaseStorage.instance.useStorageEmulator(host, 9199);"},{"type":"INSERT","lineNumber":52,"content":"// }"},{"type":"DELETE","lineNumber":20,"oldContent":"  @override"},{"type":"DELETE","lineNumber":21,"oldContent":""},{"type":"DELETE","lineNumber":22,"oldContent":"  }"}]},{"timestamp":1754652050804,"changes":[{"type":"DELETE","lineNumber":0,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/login_screen.dart';"},{"type":"MODIFY","lineNumber":1,"content":"import 'package:flutter/material.dart';","oldContent":"import 'package:flutter/material.dart';"},{"type":"MODIFY","lineNumber":3,"content":"import 'package:get_storage/get_storage.dart';","oldContent":"import 'firebase_options.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":""},{"type":"DELETE","lineNumber":8,"oldContent":"Future<void> main() async {"},{"type":"INSERT","lineNumber":6,"content":"import 'core/service_locator.dart' as di;"},{"type":"INSERT","lineNumber":8,"content":"import 'firebase_options.dart';"},{"type":"INSERT","lineNumber":9,"content":""},{"type":"INSERT","lineNumber":10,"content":"Future<void> main() async {"},{"type":"DELETE","lineNumber":12,"oldContent":"  }"},{"type":"INSERT","lineNumber":13,"content":"  "},{"type":"INSERT","lineNumber":15,"content":"    // Initialize local storage"},{"type":"INSERT","lineNumber":16,"content":"    await GetStorage.init();"},{"type":"INSERT","lineNumber":17,"content":"    "},{"type":"DELETE","lineNumber":16,"oldContent":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":18,"oldContent":""},{"type":"INSERT","lineNumber":23,"content":"    // Initialize dependency injection"},{"type":"INSERT","lineNumber":24,"content":"    await di.init();"},{"type":"INSERT","lineNumber":25,"content":"    "},{"type":"DELETE","lineNumber":22,"oldContent":"// }"},{"type":"DELETE","lineNumber":27,"oldContent":"//   final host = 'localhost';"},{"type":"DELETE","lineNumber":29,"oldContent":"// Future<void> _connectToFirebaseEmulator() async {"},{"type":"DELETE","lineNumber":31,"oldContent":"// Helper function to connect to Firebase emulator (for development)"},{"type":"DELETE","lineNumber":32,"oldContent":"          BlocProvider(create: (_) => AuthBloc()..add(CheckAuthStatus())),"},{"type":"MODIFY","lineNumber":33,"content":"          BlocProvider(","oldContent":"}"},{"type":"INSERT","lineNumber":34,"content":"            create: (context) => AuthBloc()..add(CheckAuthStatus()),"},{"type":"INSERT","lineNumber":35,"content":"          ),"},{"type":"DELETE","lineNumber":35,"oldContent":"    );"},{"type":"DELETE","lineNumber":38,"oldContent":"      ),"},{"type":"DELETE","lineNumber":39,"oldContent":"        ),"},{"type":"DELETE","lineNumber":41,"oldContent":"          ),"},{"type":"DELETE","lineNumber":42,"oldContent":"  } catch (e) {"},{"type":"DELETE","lineNumber":43,"oldContent":"            child: Text('Error initializing Firebase: $e'),"},{"type":"DELETE","lineNumber":44,"oldContent":"    // Handle Firebase initialization errors"},{"type":"DELETE","lineNumber":45,"oldContent":"          body: Center("},{"type":"DELETE","lineNumber":46,"oldContent":"    debugPrint('Firebase initialization error: $e');"},{"type":"DELETE","lineNumber":47,"oldContent":"        home: Scaffold("},{"type":"INSERT","lineNumber":40,"content":"  } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":41,"content":"    // Handle initialization errors"},{"type":"INSERT","lineNumber":42,"content":"    debugPrint('Initialization error: $e');"},{"type":"INSERT","lineNumber":43,"content":"    debugPrint('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":44,"content":"    "},{"type":"INSERT","lineNumber":47,"content":"        home: Scaffold("},{"type":"INSERT","lineNumber":48,"content":"          body: Center("},{"type":"INSERT","lineNumber":49,"content":"            child: Column("},{"type":"INSERT","lineNumber":50,"content":"              mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":51,"content":"              children: ["},{"type":"INSERT","lineNumber":52,"content":"                const Text("},{"type":"INSERT","lineNumber":53,"content":"                  'Initialization Error',"},{"type":"INSERT","lineNumber":54,"content":"                  style: TextStyle(fontSize: 20, fontWeight: FontWeight.bold),"},{"type":"INSERT","lineNumber":55,"content":"                ),"},{"type":"INSERT","lineNumber":56,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":57,"content":"                Text("},{"type":"INSERT","lineNumber":58,"content":"                  e.toString(),"},{"type":"INSERT","lineNumber":59,"content":"                  textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":60,"content":"                  style: const TextStyle(color: Colors.red),"},{"type":"INSERT","lineNumber":61,"content":"                ),"},{"type":"INSERT","lineNumber":62,"content":"              ],"},{"type":"INSERT","lineNumber":63,"content":"            ),"},{"type":"INSERT","lineNumber":64,"content":"          ),"},{"type":"INSERT","lineNumber":65,"content":"        ),"},{"type":"INSERT","lineNumber":66,"content":"      ),"},{"type":"INSERT","lineNumber":67,"content":"    );"},{"type":"INSERT","lineNumber":68,"content":"  }"},{"type":"INSERT","lineNumber":69,"content":"}"},{"type":"INSERT","lineNumber":70,"content":""},{"type":"INSERT","lineNumber":71,"content":"// Helper function to connect to Firebase emulator (for development)"},{"type":"INSERT","lineNumber":72,"content":"// Future<void> _connectToFirebaseEmulator() async {"},{"type":"INSERT","lineNumber":73,"content":"//   final host = 'localhost';"},{"type":"INSERT","lineNumber":74,"content":"//   await FirebaseAuth.instance.useAuthEmulator(host, 9099);"},{"type":"INSERT","lineNumber":75,"content":"//   FirebaseFirestore.instance.useFirestoreEmulator(host, 8080);"},{"type":"INSERT","lineNumber":76,"content":"//   await FirebaseStorage.instance.useStorageEmulator(host, 9199);"},{"type":"INSERT","lineNumber":77,"content":"// }"},{"type":"INSERT","lineNumber":78,"content":""}]},{"timestamp":1754652186693,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:flutter/material.dart';","oldContent":"import 'package:flutter/material.dart';"},{"type":"INSERT","lineNumber":2,"content":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"  }"},{"type":"INSERT","lineNumber":4,"content":"import 'package:flutter/services.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import 'core/service_locator.dart' as di;"},{"type":"INSERT","lineNumber":7,"content":"import 'core/service_locator.dart' as di;"},{"type":"INSERT","lineNumber":8,"content":"import 'features/auth/presentation/bloc/auth_bloc.dart';"},{"type":"DELETE","lineNumber":9,"oldContent":"import 'features/auth/presentation/bloc/auth_bloc.dart';"},{"type":"INSERT","lineNumber":11,"content":"// Initialize GetStorage"},{"type":"INSERT","lineNumber":12,"content":"final GetStorage getStorage = GetStorage();"},{"type":"INSERT","lineNumber":13,"content":""},{"type":"DELETE","lineNumber":11,"oldContent":"      home: const (),"},{"type":"DELETE","lineNumber":12,"oldContent":"      "},{"type":"INSERT","lineNumber":15,"content":"  // Ensure Flutter binding is initialized"},{"type":"INSERT","lineNumber":16,"content":"  WidgetsFlutterBinding.ensureInitialized();"},{"type":"DELETE","lineNumber":15,"oldContent":"    // Initialize Firebase"},{"type":"DELETE","lineNumber":17,"oldContent":"    await Firebase.initializeApp("},{"type":"INSERT","lineNumber":22,"content":"    // Set preferred orientations"},{"type":"INSERT","lineNumber":23,"content":"    await SystemChrome.setPreferredOrientations(["},{"type":"INSERT","lineNumber":24,"content":"      DeviceOrientation.portraitUp,"},{"type":"INSERT","lineNumber":25,"content":"      DeviceOrientation.portraitDown,"},{"type":"INSERT","lineNumber":26,"content":"    ]);"},{"type":"INSERT","lineNumber":27,"content":"    "},{"type":"INSERT","lineNumber":28,"content":"    // Initialize Firebase"},{"type":"INSERT","lineNumber":29,"content":"    await Firebase.initializeApp("},{"type":"DELETE","lineNumber":23,"oldContent":"    // Enable Firebase emulator for development"},{"type":"DELETE","lineNumber":25,"oldContent":"    // Uncomment and update with your emulator host and port"},{"type":"DELETE","lineNumber":27,"oldContent":"    // await _connectToFirebaseEmulator();"},{"type":"INSERT","lineNumber":36,"content":"    // Set system UI overlay style"},{"type":"INSERT","lineNumber":37,"content":"    SystemChrome.setSystemUIOverlayStyle(const SystemUiOverlayStyle("},{"type":"INSERT","lineNumber":38,"content":"      statusBarColor: Colors.transparent,"},{"type":"INSERT","lineNumber":39,"content":"      statusBarIconBrightness: Brightness.dark,"},{"type":"INSERT","lineNumber":40,"content":"      statusBarBrightness: Brightness.light,"},{"type":"INSERT","lineNumber":41,"content":"    ));"},{"type":"INSERT","lineNumber":43,"content":"    // Enable Firebase emulator for development"},{"type":"INSERT","lineNumber":44,"content":"    // Uncomment and update with your emulator host and port"},{"type":"INSERT","lineNumber":45,"content":"    // await _connectToFirebaseEmulator();"},{"type":"INSERT","lineNumber":46,"content":"    "},{"type":"DELETE","lineNumber":35,"oldContent":"        ],"},{"type":"INSERT","lineNumber":53,"content":"        ],"},{"type":"DELETE","lineNumber":38,"oldContent":"            child: Text('Error initializing Firebase: $e'),"},{"type":"DELETE","lineNumber":39,"oldContent":"  } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":55,"content":"      ),"},{"type":"INSERT","lineNumber":57,"content":"  } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":62,"content":"    runApp("},{"type":"INSERT","lineNumber":63,"content":"      MaterialApp("},{"type":"DELETE","lineNumber":47,"oldContent":"// }"},{"type":"DELETE","lineNumber":49,"oldContent":"//   await FirebaseStorage.instance.useStorageEmulator(host, 9199);"},{"type":"DELETE","lineNumber":51,"oldContent":"//   FirebaseFirestore.instance.useFirestoreEmulator(host, 8080);"},{"type":"DELETE","lineNumber":53,"oldContent":"//   await FirebaseAuth.instance.useAuthEmulator(host, 9099);"},{"type":"DELETE","lineNumber":55,"oldContent":"//   final host = 'localhost';"},{"type":"DELETE","lineNumber":57,"oldContent":"// Future<void> _connectToFirebaseEmulator() async {"},{"type":"DELETE","lineNumber":59,"oldContent":"// Helper function to connect to Firebase emulator (for development)"},{"type":"DELETE","lineNumber":61,"oldContent":""},{"type":"DELETE","lineNumber":63,"oldContent":"}"},{"type":"DELETE","lineNumber":65,"oldContent":"  }"},{"type":"DELETE","lineNumber":67,"oldContent":"    );"},{"type":"DELETE","lineNumber":69,"oldContent":"      ),"},{"type":"DELETE","lineNumber":71,"oldContent":"        ),"},{"type":"DELETE","lineNumber":73,"oldContent":"          ),"},{"type":"INSERT","lineNumber":81,"content":"          ),"},{"type":"INSERT","lineNumber":82,"content":"        ),"},{"type":"INSERT","lineNumber":83,"content":"      ),"},{"type":"INSERT","lineNumber":84,"content":"    );"},{"type":"INSERT","lineNumber":85,"content":"  }"},{"type":"INSERT","lineNumber":86,"content":"}"},{"type":"INSERT","lineNumber":87,"content":""},{"type":"INSERT","lineNumber":88,"content":"// Helper function to connect to Firebase emulator (for development)"},{"type":"INSERT","lineNumber":89,"content":"// Future<void> _connectToFirebaseEmulator() async {"},{"type":"INSERT","lineNumber":90,"content":"//   final host = 'localhost';"},{"type":"INSERT","lineNumber":91,"content":"//   await FirebaseAuth.instance.useAuthEmulator(host, 9099);"},{"type":"INSERT","lineNumber":92,"content":"//   FirebaseFirestore.instance.useFirestoreEmulator(host, 8080);"},{"type":"INSERT","lineNumber":93,"content":"//   await FirebaseStorage.instance.useStorageEmulator(host, 9199);"},{"type":"INSERT","lineNumber":94,"content":"// }"},{"type":"INSERT","lineNumber":95,"content":""}]},{"timestamp":1754652276943,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:firebase_core/firebase_core.dart';"},{"type":"DELETE","lineNumber":1,"oldContent":"import 'package:flutter/material.dart';"},{"type":"DELETE","lineNumber":2,"oldContent":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"MODIFY","lineNumber":3,"content":"import 'package:get_storage/get_storage.dart';","oldContent":"import 'package:get_storage/get_storage.dart';"},{"type":"DELETE","lineNumber":9,"oldContent":"import 'features/auth/presentation/bloc/auth_bloc.dart';"},{"type":"DELETE","lineNumber":12,"oldContent":"// Initialize GetStorage"},{"type":"DELETE","lineNumber":13,"oldContent":"final GetStorage getStorage = GetStorage();"},{"type":"DELETE","lineNumber":14,"oldContent":""},{"type":"DELETE","lineNumber":15,"oldContent":"  "},{"type":"DELETE","lineNumber":16,"oldContent":"  try {"},{"type":"INSERT","lineNumber":12,"content":"  "},{"type":"INSERT","lineNumber":13,"content":"  try {"},{"type":"DELETE","lineNumber":22,"oldContent":"      options: DefaultFirebaseOptions.currentPlatform,"},{"type":"DELETE","lineNumber":23,"oldContent":"    );"},{"type":"DELETE","lineNumber":25,"oldContent":"    "},{"type":"DELETE","lineNumber":28,"oldContent":"    // Initialize dependency injection"},{"type":"DELETE","lineNumber":31,"oldContent":"    await di.init();"},{"type":"DELETE","lineNumber":34,"oldContent":"    "},{"type":"INSERT","lineNumber":25,"content":"      options: DefaultFirebaseOptions.currentPlatform,"},{"type":"INSERT","lineNumber":26,"content":"    );"},{"type":"DELETE","lineNumber":37,"oldContent":"    runApp("},{"type":"DELETE","lineNumber":38,"oldContent":"      MultiBlocProvider("},{"type":"DELETE","lineNumber":39,"oldContent":"        providers: ["},{"type":"DELETE","lineNumber":40,"oldContent":"          BlocProvider("},{"type":"DELETE","lineNumber":41,"oldContent":"            create: (context) => AuthBloc()..add(CheckAuthStatus()),"},{"type":"INSERT","lineNumber":28,"content":"    // Initialize dependency injection"},{"type":"INSERT","lineNumber":29,"content":"    await di.init();"},{"type":"INSERT","lineNumber":30,"content":"    "},{"type":"DELETE","lineNumber":43,"oldContent":"          ),"},{"type":"DELETE","lineNumber":45,"oldContent":"        child: const MyApp(),"},{"type":"DELETE","lineNumber":49,"oldContent":"    );"},{"type":"INSERT","lineNumber":37,"content":"    "},{"type":"INSERT","lineNumber":38,"content":"    // Enable Firebase emulator for development"},{"type":"INSERT","lineNumber":39,"content":"    // Uncomment and update with your emulator host and port"},{"type":"INSERT","lineNumber":40,"content":"    // await _connectToFirebaseEmulator();"},{"type":"INSERT","lineNumber":41,"content":"    "},{"type":"INSERT","lineNumber":42,"content":"    runApp(const MyApp());"},{"type":"INSERT","lineNumber":43,"content":"  } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":53,"oldContent":"    // Enable Firebase emulator for development"},{"type":"DELETE","lineNumber":55,"oldContent":"    // Uncomment and update with your emulator host and port"},{"type":"DELETE","lineNumber":57,"oldContent":"    // await _connectToFirebaseEmulator();"},{"type":"INSERT","lineNumber":48,"content":"    runApp("},{"type":"INSERT","lineNumber":49,"content":"      MaterialApp("},{"type":"DELETE","lineNumber":59,"oldContent":"    "},{"type":"DELETE","lineNumber":64,"oldContent":"        ],"},{"type":"DELETE","lineNumber":66,"oldContent":"      ),"},{"type":"DELETE","lineNumber":68,"oldContent":"  } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":71,"oldContent":"    runApp("},{"type":"DELETE","lineNumber":73,"oldContent":"      MaterialApp("},{"type":"DELETE","lineNumber":79,"oldContent":"// }"},{"type":"DELETE","lineNumber":80,"oldContent":"//   await FirebaseStorage.instance.useStorageEmulator(host, 9199);"},{"type":"DELETE","lineNumber":81,"oldContent":"//   FirebaseFirestore.instance.useFirestoreEmulator(host, 8080);"},{"type":"DELETE","lineNumber":82,"oldContent":"//   await FirebaseAuth.instance.useAuthEmulator(host, 9099);"},{"type":"DELETE","lineNumber":83,"oldContent":"//   final host = 'localhost';"},{"type":"DELETE","lineNumber":84,"oldContent":"// Future<void> _connectToFirebaseEmulator() async {"},{"type":"DELETE","lineNumber":85,"oldContent":"// Helper function to connect to Firebase emulator (for development)"},{"type":"INSERT","lineNumber":65,"content":"              ],"},{"type":"INSERT","lineNumber":66,"content":"            ),"},{"type":"DELETE","lineNumber":87,"oldContent":""},{"type":"DELETE","lineNumber":89,"oldContent":"}"},{"type":"DELETE","lineNumber":91,"oldContent":"  }"},{"type":"INSERT","lineNumber":71,"content":"  }"},{"type":"INSERT","lineNumber":72,"content":"}"},{"type":"INSERT","lineNumber":73,"content":""},{"type":"INSERT","lineNumber":74,"content":"// Helper function to connect to Firebase emulator (for development)"},{"type":"INSERT","lineNumber":75,"content":"// Future<void> _connectToFirebaseEmulator() async {"},{"type":"INSERT","lineNumber":76,"content":"//   final host = 'localhost';"},{"type":"INSERT","lineNumber":77,"content":"//   await FirebaseAuth.instance.useAuthEmulator(host, 9099);"},{"type":"INSERT","lineNumber":78,"content":"//   FirebaseFirestore.instance.useFirestoreEmulator(host, 8080);"},{"type":"INSERT","lineNumber":79,"content":"//   await FirebaseStorage.instance.useStorageEmulator(host, 9199);"},{"type":"INSERT","lineNumber":80,"content":"// }"},{"type":"INSERT","lineNumber":81,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/test/widget_test.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/test/widget_test.dart","baseContent":"// This is a basic Flutter widget test.\n//\n// To perform an interaction with a widget in your test, use the WidgetTester\n// utility in the flutter_test package. For example, you can send tap and scroll\n// gestures. You can also use WidgetTester to find child widgets in the widget\n// tree, read text, and verify that the values of widget properties are correct.\n\nimport 'package:flutter/material.dart';\nimport 'package:flutter_test/flutter_test.dart';\n\nimport 'package:family_tree_firebase/main.dart';\n\nvoid main() {\n  testWidgets('Counter increments smoke test', (WidgetTester tester) async {\n    // Build our app and trigger a frame.\n    await tester.pumpWidget(const Family_tree());\n\n    // Verify that our counter starts at 0.\n    expect(find.text('0'), findsOneWidget);\n    expect(find.text('1'), findsNothing);\n\n    // Tap the '+' icon and trigger a frame.\n    await tester.tap(find.byIcon(Icons.add));\n    await tester.pump();\n\n    // Verify that our counter has incremented.\n    expect(find.text('0'), findsNothing);\n    expect(find.text('1'), findsOneWidget);\n  });\n}\n","baseTimestamp":1754368636214,"deltas":[{"timestamp":1754517121512,"changes":[{"type":"MODIFY","lineNumber":15,"content":"    await tester.pumpWidget(const MyApp());","oldContent":"    await tester.pumpWidget(const Family_tree());"}]},{"timestamp":1754629422891,"changes":[{"type":"INSERT","lineNumber":7,"content":"import 'package:family_tree_firebase/app.dart';"}]}]},"/Dummy.txt":{"filePath":"/Dummy.txt","baseContent":"first commit","baseTimestamp":1754368836704,"deltas":[{"timestamp":1754629279862,"changes":[{"type":"MODIFY","lineNumber":0,"content":"f","oldContent":"first commit"}]},{"timestamp":1754629305754,"changes":[{"type":"MODIFY","lineNumber":0,"content":"first commit","oldContent":"f"}]},{"timestamp":1754629314303,"changes":[{"type":"MODIFY","lineNumber":0,"content":"loging demo","oldContent":"first commit"}]},{"timestamp":1754694342484,"changes":[{"type":"MODIFY","lineNumber":0,"content":"home screen demo","oldContent":"loging demo"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/android/app/build.gradle.kts":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/android/app/build.gradle.kts","baseContent":"plugins {\n    id(\"com.android.application\")\n    // START: FlutterFire Configuration\n    id(\"com.google.gms.google-services\")\n    // END: FlutterFire Configuration\n    id(\"kotlin-android\")\n    // The Flutter Gradle Plugin must be applied after the Android and Kotlin Gradle plugins.\n    id(\"dev.flutter.flutter-gradle-plugin\")\n}\n\nandroid {\n    namespace = \"com.example.family_tree_firebase\"\n    compileSdk = flutter.compileSdkVersion\n    ndkVersion = \"27.0.12077973\"\n    ndkVersion = flutter.ndkVersion\n\n    compileOptions {\n        sourceCompatibility = JavaVersion.VERSION_11\n        targetCompatibility = JavaVersion.VERSION_11\n    }\n\n    kotlinOptions {\n        jvmTarget = JavaVersion.VERSION_11.toString()\n    }\n\n    defaultConfig {\n        // TODO: Specify your own unique Application ID (https://developer.android.com/studio/build/application-id.html).\n        applicationId = \"com.example.family_tree_firebase\"\n        // You can update the following values to match your application needs.\n        // For more information, see: https://flutter.dev/to/review-gradle-config.\n        minSdk = 23  // Increased from 21 to meet firebase_core requirements\n        targetSdk = flutter.targetSdkVersion\n        versionCode = flutter.versionCode\n        versionName = flutter.versionName\n    }\n\n    buildTypes {\n        release {\n            // TODO: Add your own signing config for the release build.\n            // Signing with the debug keys for now, so `flutter run --release` works.\n            signingConfig = signingConfigs.getByName(\"debug\")\n        }\n    }\n}\n\nflutter {\n    source = \"../..\"\n}\n","baseTimestamp":1754370366879,"deltas":[{"timestamp":1754370591777,"changes":[{"type":"DELETE","lineNumber":14,"oldContent":"    ndkVersion = flutter.ndkVersion"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/android/build.gradle.kts":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/android/build.gradle.kts","baseContent":"buildscript {\n    ext {\n        ndkVersion = \"27.0.12077973\"\n    }\n}\n\nallprojects {\n    repositories {\n        google()\n        mavenCentral()\n    }\n}\n\nval newBuildDir: Directory = rootProject.layout.buildDirectory.dir(\"../../build\").get()\nrootProject.layout.buildDirectory.value(newBuildDir)\n\nsubprojects {\n    val newSubprojectBuildDir: Directory = newBuildDir.dir(project.name)\n    project.layout.buildDirectory.value(newSubprojectBuildDir)\n}\nsubprojects {\n    project.evaluationDependsOn(\":app\")\n}\n\ntasks.register<Delete>(\"clean\") {\n    delete(rootProject.layout.buildDirectory)\n}\n","baseTimestamp":1754370440749,"deltas":[{"timestamp":1754370474001,"changes":[{"type":"INSERT","lineNumber":0,"content":"// Top-level build file where you can add configuration options common to all sub-projects/modules."},{"type":"INSERT","lineNumber":1,"content":""},{"type":"DELETE","lineNumber":1,"oldContent":"    ext {"},{"type":"DELETE","lineNumber":2,"oldContent":"        ndkVersion = \"27.0.12077973\""},{"type":"MODIFY","lineNumber":3,"content":"    extra[\"ndkVersion\"] = \"27.0.12077973\"","oldContent":"    }"}]}]},"/Users/rathin/.codeium/brain/44505ce5-c11f-41a2-8868-2301a09e0b83/plan.md":{"filePath":"/Users/rathin/.codeium/brain/44505ce5-c11f-41a2-8868-2301a09e0b83/plan.md","baseContent":"# Family Tree App Implementation Plan\n\n## Notes\n- User wants an app with splash screen, login, registration (name, email, phone), password, OTP, success, and home screen flows.\n- UI implementation for splash, login, registration, and OTP flows is in progress.\n- Home screen should have Instagram-like UI showing posts and stories from family group.\n- After login/register, users can join an existing family (with invite code) or create a new family (with unique invite code per user).\n- Invite codes must be unique and not reused for any user.\n- Screenshots provided as reference for UI/UX.\n- Use MVVM + BLoC architecture for state management and code organization.\n- Folder structure should separate core, data, domain, and presentation layers as described.\n\n## Task List\n- [x] Implement splash screen\n- [x] Implement login screen\n- [x] Implement registration screen (name, email, phone)\n- [ ] Implement password creation screen\n- [x] Implement OTP send/verify flow\n- [ ] Implement successful registration screen\n- [ ] Implement home screen (Instagram-like UI for posts/stories)\n- [ ] Implement join family screen (with invite code)\n- [ ] Implement create family screen (generate unique code per user)\n- [ ] Ensure invite codes are unique for each user\n- [ ] Set up folder structure for MVVM + BLoC\n- [ ] Implement navigation between all screens\n- [ ] Integrate Firebase/Auth backend for OTP, login, and registration\n\n## Current Goal\nImplement password creation screen and navigation","baseTimestamp":1754374979725,"deltas":[{"timestamp":1754511022250,"changes":[{"type":"DELETE","lineNumber":51,"oldContent":""},{"type":"DELETE","lineNumber":52,"oldContent":"## Current Goal"},{"type":"DELETE","lineNumber":54,"oldContent":""},{"type":"INSERT","lineNumber":53,"content":"  - Incomplete or incorrect DI registrations (e.g., missing firebaseAuth param)"},{"type":"INSERT","lineNumber":54,"content":"  - Incorrect usage of Timer, Completer, and other core Dart classes (likely missing imports)"},{"type":"INSERT","lineNumber":55,"content":"  - Usage of NotFoundException not defined"},{"type":"INSERT","lineNumber":56,"content":"  - Incorrect usage of List<String> comparison in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":57,"content":"- Updated SuccessScreen constructor and build method for buttonText/onButtonPressed usage."},{"type":"INSERT","lineNumber":58,"content":"## Current Goal"},{"type":"INSERT","lineNumber":59,"content":"Resolve latest build errors: widget params, imports, types, DI, syntax"},{"type":"INSERT","lineNumber":60,"content":""},{"type":"DELETE","lineNumber":58,"oldContent":"  - Incomplete or incorrect DI registrations (e.g., missing firebaseAuth param)"},{"type":"DELETE","lineNumber":61,"oldContent":"  - Incorrect usage of Timer, Completer, and other core Dart classes (likely missing imports)"},{"type":"DELETE","lineNumber":64,"oldContent":"  - Usage of NotFoundException not defined"},{"type":"DELETE","lineNumber":67,"oldContent":"  - Incorrect usage of List<String> comparison in shared_prefs_manager.dart"},{"type":"DELETE","lineNumber":71,"oldContent":"Resolve latest build errors: widget params, imports, types, DI, syntax"},{"type":"MODIFY","lineNumber":78,"content":"    - [x] Refactor family feature to MVVM (FamilyViewModel, update screens)","oldContent":"    - [x] Refactor family feature to MVVM (FamilyViewModel, update screens)"},{"type":"MODIFY","lineNumber":83,"content":"- [ ] Remove unused/legacy code and files","oldContent":"- [x] Debug and resolve all remaining syntax/logic errors in main.dart, navigation_service.dart, join_or_create_family_screen.dart, post_widget.dart, and other affected files"},{"type":"MODIFY","lineNumber":93,"content":"- [ ] Analyze verbose logs and investigate Dart compiler crash","oldContent":"- [ ] Analyze verbose logs and investigate Dart compiler crash"},{"type":"MODIFY","lineNumber":115,"content":"  - [ ] Implement or fix missing methods in FamilyViewModel and other ViewModels","oldContent":"  - [ ] Implement or fix missing methods in FamilyViewModel and other ViewModels"},{"type":"INSERT","lineNumber":118,"content":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"DELETE","lineNumber":119,"oldContent":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files"},{"type":"INSERT","lineNumber":121,"content":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files"},{"type":"DELETE","lineNumber":123,"oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"INSERT","lineNumber":125,"content":"  - [x] Fix widget constructor parameter errors (SuccessScreen, MaterialPageRoute, etc.)"},{"type":"DELETE","lineNumber":137,"oldContent":"  - [ ] Fix widget constructor parameter errors (SuccessScreen, MaterialPageRoute, etc.)"}]},{"timestamp":1754511062365,"changes":[{"type":"INSERT","lineNumber":10,"content":"- Use MVVM architecture for state management and code organization (BLoC fully removed)."},{"type":"DELETE","lineNumber":11,"oldContent":""},{"type":"MODIFY","lineNumber":13,"content":"- Family BLoC, events, states, and use cases implemented for join/create family (now removed).","oldContent":"- [x] Implement splash screen"},{"type":"DELETE","lineNumber":16,"oldContent":"- [ ] Implement password creation screen"},{"type":"DELETE","lineNumber":17,"oldContent":"- [x] Implement OTP send/verify flow"},{"type":"DELETE","lineNumber":18,"oldContent":"- [ ] Implement successful registration screen"},{"type":"DELETE","lineNumber":19,"oldContent":"- [ ] Implement home screen (Instagram-like UI for posts/stories)"},{"type":"DELETE","lineNumber":20,"oldContent":"- [ ] Implement join family screen (with invite code)"},{"type":"DELETE","lineNumber":21,"oldContent":"- [ ] Implement create family screen (generate unique code per user)"},{"type":"DELETE","lineNumber":22,"oldContent":"- [ ] Ensure invite codes are unique for each user"},{"type":"INSERT","lineNumber":16,"content":"- Dependency injection set up with get_it and Provider for ViewModels in main.dart."},{"type":"INSERT","lineNumber":17,"content":"- All family, auth, and splash screens now use ViewModels (MVVM pattern)."},{"type":"INSERT","lineNumber":18,"content":"- All BLoC-related code, dependencies, and providers have been removed from the project and pubspec.yaml."},{"type":"INSERT","lineNumber":19,"content":"- Project analysis phase in progress: examining core, features, and presentation layers for structure and code quality."},{"type":"INSERT","lineNumber":20,"content":"- User requested: Fix all issues, remove unwanted code/files, and ensure the app runs properly."},{"type":"INSERT","lineNumber":21,"content":"- All family, auth, and splash screens verified to use ViewModels; MVVM migration for these features is complete."},{"type":"INSERT","lineNumber":22,"content":"- App failed to build/run in Chrome; currently debugging home screen and ViewModel implementations for errors."},{"type":"MODIFY","lineNumber":32,"content":"- Removed duplicate NoParams class (kept only in usecase.dart); all imports/usages updated to reference the single definition in core/usecases/usecase.dart. Type errors related to NoParams will be resolved as part of this update.","oldContent":"- Removed duplicate NoParams class (kept only in usecase.dart); next: update all imports/usages to reference the single definition and resolve related type errors."},{"type":"DELETE","lineNumber":51,"oldContent":"  - Incomplete or incorrect DI registrations (e.g., missing firebaseAuth param)"},{"type":"INSERT","lineNumber":52,"content":"  - Syntax errors and unexpected tokens in join_or_create_family_screen.dart"},{"type":"INSERT","lineNumber":53,"content":"  - Incomplete or incorrect DI registrations (e.g., missing firebaseAuth param)"},{"type":"DELETE","lineNumber":55,"oldContent":"  - Syntax errors and unexpected tokens in join_or_create_family_screen.dart"},{"type":"DELETE","lineNumber":57,"oldContent":"## Tasks"},{"type":"DELETE","lineNumber":59,"oldContent":"- [x] Implement AuthRepository with Firebase data source in authentication data layer"},{"type":"DELETE","lineNumber":62,"oldContent":"- [x] Create AuthEvent and AuthState classes for authentication BLoC"},{"type":"INSERT","lineNumber":61,"content":"## Tasks"},{"type":"INSERT","lineNumber":62,"content":"- [x] Implement AuthRepository with Firebase data source in authentication data layer"},{"type":"INSERT","lineNumber":63,"content":"- [x] Create AuthEvent and AuthState classes for authentication BLoC"},{"type":"INSERT","lineNumber":77,"content":"    - [x] Refactor authentication feature to MVVM (AuthViewModel, update screens)"},{"type":"DELETE","lineNumber":78,"oldContent":"    - [x] Refactor family feature to MVVM (FamilyViewModel, update screens)"},{"type":"MODIFY","lineNumber":80,"content":"    - [x] Remove remaining BLoC imports and usages","oldContent":"- [x] Debug and resolve all remaining syntax/logic errors in main.dart, navigation_service.dart, join_or_create_family_screen.dart, post_widget.dart, and other affected files"},{"type":"INSERT","lineNumber":92,"content":"- [ ] Run and verify app builds and runs correctly"},{"type":"DELETE","lineNumber":93,"oldContent":"- [ ] Analyze verbose logs and investigate Dart compiler crash"},{"type":"MODIFY","lineNumber":95,"content":"- [x] Restore all missing files (network_info, home_viewmodel, delete_account, send_password_reset_email, family_remote_data_source_impl, check_family_membership, etc.)","oldContent":"- [x] Debug and resolve null safety/type issues in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":114,"content":"  - [ ] Fix type mismatches and constructor parameter issues in all ViewModels and screens"},{"type":"DELETE","lineNumber":115,"oldContent":"  - [ ] Implement or fix missing methods in FamilyViewModel and other ViewModels"},{"type":"MODIFY","lineNumber":127,"content":"  - [x] Standardize NoParams usage across all files","oldContent":"  - [ ] Fix NoParams usage and import issues across all files"}]},{"timestamp":1754511322128,"changes":[{"type":"MODIFY","lineNumber":23,"content":"- Added missing hasError and errorMessage properties to HomeViewModel to resolve build error in HomeScreen.","oldContent":"- [ ] Set up folder structure for MVVM + BLoC"},{"type":"MODIFY","lineNumber":52,"content":"  - Syntax errors and unexpected tokens in join_or_create_family_screen.dart","oldContent":"  - Syntax errors and unexpected tokens in join_or_create_family_screen.dart"},{"type":"INSERT","lineNumber":58,"content":"- Updated: New build errors for missing imports/types (Timer from dart:async, Unit from dartz, NoParams from core/usecases/usecase.dart) in use cases and OTP screen. Next step: systematically fix all missing/incorrect imports for these types in relevant files."},{"type":"DELETE","lineNumber":59,"oldContent":"## Tasks"},{"type":"INSERT","lineNumber":61,"content":""},{"type":"INSERT","lineNumber":62,"content":"## Tasks"},{"type":"DELETE","lineNumber":63,"oldContent":""},{"type":"INSERT","lineNumber":118,"content":"  - [x] Fix type mismatch between List<Story> and List<StoryModel> in HomeViewModel by mapping domain entities to UI models"},{"type":"INSERT","lineNumber":120,"content":"  - [x] Provide all required parameters for LikePostParams and AddCommentParams in HomeViewModel (e.g., userId, userName, content)"},{"type":"DELETE","lineNumber":120,"oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"DELETE","lineNumber":121,"oldContent":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files"},{"type":"DELETE","lineNumber":124,"oldContent":"  - [ ] Fix List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":125,"content":"  - [x] Implement checkFamilyMembership in FamilyRepositoryImpl"},{"type":"INSERT","lineNumber":139,"content":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"}]},{"timestamp":1754511394229,"changes":[{"type":"MODIFY","lineNumber":24,"content":"- Critical build errors: missing files (core/base/base_viewmodel.dart, core/base/base_view.dart, core/theme/app_theme.dart, core/utils/navigation_service.dart, core/utils/shared_prefs_manager.dart, features/home/presentation/viewmodels/home_viewmodel.dart, features/auth/domain/usecases/sign_up_with_email_and_password.dart, features/auth/domain/usecases/send_password_reset_email.dart, features/auth/domain/usecases/delete_account.dart, features/family/data/datasources/family_remote_data_source_impl.dart, features/family/domain/usecases/check_family_membership.dart), missing dependencies (google_fonts, shared_preferences, injectable, google_sign_in, sign_in_with_apple), and code errors (type/argument mismatches, duplicate method names, missing/incorrect method calls, syntax errors in auth and family screens).","oldContent":"- [ ] Implement navigation between all screens"},{"type":"INSERT","lineNumber":51,"content":"  - Type errors (e.g., assigning Unit to UserEntity?)"},{"type":"DELETE","lineNumber":52,"oldContent":"  - Syntax errors and unexpected tokens in join_or_create_family_screen.dart"},{"type":"MODIFY","lineNumber":63,"content":"- [x] Implement AuthRepository with Firebase data source in authentication data layer","oldContent":"- [x] Implement AuthRepository with Firebase data source in authentication data layer"},{"type":"MODIFY","lineNumber":80,"content":"    - [x] Refactor splash screen to MVVM (SplashViewModel, provider, DI)","oldContent":"- [x] Debug and resolve all remaining build errors in main.dart, navigation_service.dart, join_or_create_family_screen.dart, post_widget.dart, and other affected files"},{"type":"MODIFY","lineNumber":83,"content":"- [ ] Complete detailed analysis of each feature's structure and code","oldContent":"- [ ] Analyze verbose logs and investigate Dart compiler crash"},{"type":"MODIFY","lineNumber":85,"content":"- [ ] Clean up and document codebase","oldContent":"- [ ] Debug and resolve DI/constructor/parameter issues in main.dart, injection_container.dart, and feature DI files"},{"type":"DELETE","lineNumber":111,"oldContent":"  - [ ] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"DELETE","lineNumber":112,"oldContent":"  - [ ] Provide all required parameters for LikePostParams and AddCommentParams in HomeViewModel (e.g., userId, userName, content)"},{"type":"DELETE","lineNumber":113,"oldContent":"  - [ ] Fix type mismatch between List<Story> and List<StoryModel> in HomeViewModel by mapping domain entities to UI models"},{"type":"INSERT","lineNumber":111,"content":"    - [x] Remove duplicate loadInitialData method in HomeViewModel"},{"type":"INSERT","lineNumber":112,"content":"    - [x] Update HomeScreen to use the correct loadInitialData method"},{"type":"INSERT","lineNumber":113,"content":"  - [x] Add missing imports for Failure and subclasses where needed"},{"type":"DELETE","lineNumber":117,"oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"DELETE","lineNumber":118,"oldContent":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files"},{"type":"INSERT","lineNumber":117,"content":"  - [ ] Address unresolved imports and ambiguous/deprecated imports"},{"type":"MODIFY","lineNumber":121,"content":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model","oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"INSERT","lineNumber":122,"content":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files"},{"type":"MODIFY","lineNumber":139,"content":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)","oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"}]},{"timestamp":1754511431837,"changes":[{"type":"DELETE","lineNumber":25,"oldContent":"- [ ] Integrate Firebase/Auth backend for OTP, login, and registration"},{"type":"DELETE","lineNumber":26,"oldContent":""},{"type":"INSERT","lineNumber":25,"content":"- Restored missing core files (base_viewmodel, base_view, app_theme, navigation_service, shared_prefs_manager) and updated HomeViewModel to MVVM-compliant implementation."},{"type":"INSERT","lineNumber":26,"content":"- Reviewed and updated NavigationService and HomeViewModel for type safety and correct implementation."},{"type":"INSERT","lineNumber":59,"content":"- [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"INSERT","lineNumber":63,"content":"## Tasks"},{"type":"DELETE","lineNumber":63,"oldContent":"- [x] Implement AuthRepository with Firebase data source in authentication data layer"},{"type":"DELETE","lineNumber":95,"oldContent":"- [x] Fix NavigationService singleton and SharedPrefsManager type/null safety"},{"type":"INSERT","lineNumber":96,"content":"- [x] Fix errors in family_viewmodel.dart (missing/incorrect arguments, duplicate definitions, invalid overrides, undefined methods)"},{"type":"DELETE","lineNumber":110,"oldContent":"  - [ ] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"INSERT","lineNumber":111,"content":"  - [x] Remove duplicate method definitions (e.g. loadInitialData in HomeViewModel)"},{"type":"DELETE","lineNumber":116,"oldContent":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files"},{"type":"INSERT","lineNumber":117,"content":"  - [ ] Implement or fix missing methods in FamilyViewModel and other ViewModels"},{"type":"INSERT","lineNumber":121,"content":"  - [x] Provide all required parameters for LikePostParams and AddCommentParams in HomeViewModel (e.g., userId, userName, content)"},{"type":"DELETE","lineNumber":122,"oldContent":"  - [x] Provide all required parameters for LikePostParams and AddCommentParams in HomeViewModel (e.g., userId, userName, content)"},{"type":"DELETE","lineNumber":124,"oldContent":"  - [ ] Fix List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":125,"content":"  - [x] Add checkFamilyMembership method to FamilyRepository interface and implement it"},{"type":"DELETE","lineNumber":137,"oldContent":"  - [ ] Fix NotFoundException usage or define it"},{"type":"MODIFY","lineNumber":138,"content":"  - [x] Fix NotFoundException usage or define it","oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"INSERT","lineNumber":139,"content":"  - [ ] Fix List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":140,"content":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"}]},{"timestamp":1754511508048,"changes":[{"type":"INSERT","lineNumber":6,"content":"- Mock data and UI for home screen (posts/stories) implemented."},{"type":"DELETE","lineNumber":9,"oldContent":"- Use MVVM + BLoC architecture for state management and code organization."},{"type":"DELETE","lineNumber":27,"oldContent":"## Current Goal"},{"type":"DELETE","lineNumber":28,"oldContent":"Implement password creation screen and navigation"},{"type":"INSERT","lineNumber":27,"content":"- Fixed NavigationService singleton pattern and constructor implementation to resolve build errors."},{"type":"INSERT","lineNumber":28,"content":"- Updated SharedPrefsManager to handle type and null safety issues."},{"type":"MODIFY","lineNumber":64,"content":"- [x] Implement AuthRepository with Firebase data source in authentication data layer","oldContent":"- [x] Implement AuthRepository with Firebase data source in authentication data layer"},{"type":"MODIFY","lineNumber":75,"content":"  - [x] Add provider dependencies and base ViewModel/View classes","oldContent":"- [x] Restore all missing files (network_info, home_viewmodel, delete_account, send_password_reset_email, family_remote_data_source_impl, check_family_membership, etc.)"},{"type":"MODIFY","lineNumber":83,"content":"  - [x] Remove unused dependencies from pubspec.yaml (change_notifier_provider)","oldContent":"  - [ ] Add missing imports for Failure and subclasses where needed"},{"type":"DELETE","lineNumber":108,"oldContent":"  - [ ] Address unresolved imports and ambiguous/deprecated imports"},{"type":"MODIFY","lineNumber":108,"content":"  - [x] Update all NoParams imports/usages to use usecase.dart version","oldContent":"    - [ ] Update NoParams imports in other affected files"},{"type":"INSERT","lineNumber":109,"content":"    - [x] Update NoParams imports in HomeViewModel"},{"type":"MODIFY","lineNumber":122,"content":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model","oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"MODIFY","lineNumber":124,"content":"  - [x] Fix ServerException constructor calls to use positional message argument in family_remote_data_source_impl.dart","oldContent":"  - [ ] Fix missing/incorrect usage of core Dart classes (Timer, Completer)"},{"type":"INSERT","lineNumber":140,"content":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"INSERT","lineNumber":141,"content":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files."}]},{"timestamp":1754511572889,"changes":[{"type":"MODIFY","lineNumber":12,"content":"- Family entity and repository interface created for family feature.","oldContent":"## Task List"},{"type":"MODIFY","lineNumber":31,"content":"- Ran `flutter analyze` and found numerous type/argument mismatches, missing required arguments, undefined methods/classes, and unresolved imports, especially in HomeViewModel, HomeScreen, and main.dart. Next steps must prioritize systematically fixing these errors in the reported files, starting with missing required arguments and type mismatches, then undefined methods/classes, and cleaning up unused imports.","oldContent":"- [x] Debug and resolve null safety/type issues in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":63,"content":"## Tasks"},{"type":"DELETE","lineNumber":64,"oldContent":"- [x] Implement AuthRepository with Firebase data source in authentication data layer"},{"type":"MODIFY","lineNumber":78,"content":"  - [x] Refactor other features (auth, family, splash) to MVVM and remove BLoC","oldContent":"- [ ] Analyze verbose logs and investigate Dart compiler crash"},{"type":"MODIFY","lineNumber":95,"content":"- [ ] Analyze verbose logs and investigate Dart compiler crash","oldContent":"  - [x] Update all NoParams imports/usages to use usecase.dart version"},{"type":"MODIFY","lineNumber":99,"content":"- [x] Restore missing home/domain use case files (get_posts.dart, get_stories.dart, like_post.dart, add_comment.dart)","oldContent":"- [x] Create StoryRemoteDataSource interface and implementation for home feature"},{"type":"DELETE","lineNumber":102,"oldContent":"  - [ ] Address unresolved imports and ambiguous/deprecated imports"},{"type":"DELETE","lineNumber":103,"oldContent":"    - [ ] Update NoParams imports in other affected files"},{"type":"INSERT","lineNumber":102,"content":"- [x] Create PostRemoteDataSource interface and implementation for home feature"},{"type":"INSERT","lineNumber":103,"content":"- [x] Create PostRepositoryImpl for home feature"},{"type":"INSERT","lineNumber":104,"content":"- [x] Create StoryRemoteDataSource interface and implementation for home feature"},{"type":"DELETE","lineNumber":105,"oldContent":"- [x] Create StoryRepositoryImpl for home feature"},{"type":"DELETE","lineNumber":106,"oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"MODIFY","lineNumber":106,"content":"- [ ] Systematically address latest build errors (type mismatches, missing params, unresolved imports, constructor/signature issues, etc.)","oldContent":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files"},{"type":"INSERT","lineNumber":107,"content":"  - [x] Fix missing required arguments and type mismatches in HomeViewModel and HomeScreen"},{"type":"DELETE","lineNumber":109,"oldContent":"  - [ ] Fix type mismatches and constructor parameter issues in all ViewModels and screens"},{"type":"DELETE","lineNumber":110,"oldContent":"- [x] Create Post, Comment, Story, and StoryMedia entity classes for home feature"},{"type":"INSERT","lineNumber":109,"content":"    - [x] Update NoParams imports in HomeViewModel"},{"type":"INSERT","lineNumber":110,"content":"    - [x] Update NoParams imports in other affected files"},{"type":"INSERT","lineNumber":121,"content":"  - [x] Provide all required parameters for LikePostParams and AddCommentParams in HomeViewModel (e.g., userId, userName, content)"},{"type":"DELETE","lineNumber":122,"oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"MODIFY","lineNumber":136,"content":"  - [ ] Fix DI registration errors (missing firebaseAuth param, ambiguous providers, etc.)","oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"INSERT","lineNumber":137,"content":"  - [ ] Fix missing/incorrect usage of core Dart classes (Timer, Completer)"},{"type":"INSERT","lineNumber":138,"content":"  - [x] Fix NotFoundException usage or define it"},{"type":"INSERT","lineNumber":139,"content":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving List<String> comparison logic in shared_prefs_manager.dart"},{"type":"DELETE","lineNumber":138,"oldContent":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files."},{"type":"DELETE","lineNumber":139,"oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"}]},{"timestamp":1754511692361,"changes":[{"type":"MODIFY","lineNumber":100,"content":"- [x] Create PostRepository and StoryRepository interfaces for home feature","oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"MODIFY","lineNumber":107,"content":"  - [x] Fix missing required arguments and type mismatches in HomeViewModel and HomeScreen","oldContent":"  - [ ] Fix type mismatches and constructor parameter issues in all ViewModels and screens"},{"type":"DELETE","lineNumber":135,"oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":136,"oldContent":"  - [ ] Fix DI registration errors (missing firebaseAuth param, ambiguous providers, etc.)"},{"type":"INSERT","lineNumber":135,"content":"  - [ ] Fix syntax errors and unexpected tokens (e.g., join_or_create_family_screen.dart)"},{"type":"INSERT","lineNumber":136,"content":"  - [x] Fix DI registration and initialization for SharedPrefsManager"},{"type":"DELETE","lineNumber":138,"oldContent":"  - [ ] Fix List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":140,"content":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"}]},{"timestamp":1754511804517,"changes":[{"type":"MODIFY","lineNumber":15,"content":"- Firebase backend (repository, remote data source, model, exceptions) implemented for family feature.","oldContent":"- [x] Implement registration screen (name, email, phone)"},{"type":"MODIFY","lineNumber":77,"content":"  - [x] Update PostWidget and PostModel for MVVM compatibility","oldContent":"  - [x] Add missing imports for Failure and subclasses where needed"},{"type":"MODIFY","lineNumber":89,"content":"- [x] Restore missing feature files and dependencies (features/auth/domain/usecases, features/family/data/datasources, features/family/domain/usecases, etc.)","oldContent":"  - [ ] Address unresolved imports and ambiguous/deprecated imports"},{"type":"MODIFY","lineNumber":91,"content":"- [x] Fix OTP verification screen issues","oldContent":"- [x] Create StoryRepositoryImpl for home feature"},{"type":"MODIFY","lineNumber":98,"content":"- [x] Fix type/argument mismatches, method signature errors, and missing class/method definitions in all reported files (AuthViewModel)","oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"MODIFY","lineNumber":105,"content":"- [x] Create StoryRepositoryImpl for home feature","oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"DELETE","lineNumber":132,"oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":133,"oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":134,"oldContent":"  - [ ] Fix List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":132,"content":"  - [ ] Fix getter/setter/field usage errors (e.g., commentCount, inviteCode)"},{"type":"INSERT","lineNumber":133,"content":"  - [ ] Implement or fix missing methods in FamilyViewModel, HomeViewModel, PostWidget, etc."},{"type":"INSERT","lineNumber":134,"content":"  - [ ] Fix type errors (e.g., assigning Unit to UserEntity?)"},{"type":"INSERT","lineNumber":139,"content":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":141,"content":"  - [x] Fix NetworkFailure constructor usage in network_info_impl.dart"},{"type":"INSERT","lineNumber":142,"content":"  - [x] Mark NetworkFailure constructor usage as fixed in network_info_impl.dart: Corrected NetworkFailure constructor call to provide required positional argument."}]},{"timestamp":1754511860342,"changes":[{"type":"DELETE","lineNumber":33,"oldContent":"- [x] Debug and resolve all remaining syntax/logic errors in main.dart, navigation_service.dart, join_or_create_family_screen.dart, post_widget.dart, and other affected files"},{"type":"DELETE","lineNumber":34,"oldContent":"- [ ] Debug and resolve DI/constructor/parameter issues in main.dart, injection_container.dart, and feature DI files"},{"type":"INSERT","lineNumber":33,"content":"- Main build errors: duplicate NoParams usage, duplicate methods (e.g. loadInitialData), missing imports for Failure and subclasses, navigation/shared prefs issues, type mismatches in ViewModels, constructor parameter mismatches, missing/incorrect methods in FamilyViewModel, and unresolved imports. These must be addressed systematically, starting with the most critical (compilation blockers, e.g. missing/incorrect imports and duplicate definitions)."},{"type":"INSERT","lineNumber":34,"content":"- Next steps: systematically fix type/argument mismatches, missing required arguments, undefined methods/classes, and unresolved imports in reported files, starting with NoParams import updates, duplicate method resolution, and missing import fixes."},{"type":"MODIFY","lineNumber":87,"content":"- [x] Debug build failure and fix home screen/ViewModel errors","oldContent":"  - [ ] Fix type mismatches and constructor parameter issues in all ViewModels and screens"},{"type":"MODIFY","lineNumber":90,"content":"- [x] Fix code errors in main.dart, auth screens, family screens, and ViewModels","oldContent":"    - [x] Refactor authentication feature to MVVM (AuthViewModel, update screens)"},{"type":"DELETE","lineNumber":129,"oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":130,"oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":131,"oldContent":"  - [ ] Fix List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":129,"content":"  - [x] Standardize NoParams usage across all files"},{"type":"INSERT","lineNumber":130,"content":"  - [ ] Resolve all conflicting/duplicate imports (e.g., CommentModel, FamilyRemoteDataSourceImpl, SignInWithApple)"},{"type":"INSERT","lineNumber":131,"content":"  - [ ] Fix method signature/type mismatches in use cases and ViewModels (e.g., checkAuthStatus, signInWithGoogle, signInWithApple, sendPasswordResetEmail, deleteAccount)"},{"type":"DELETE","lineNumber":137,"oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":138,"oldContent":"  - [x] Mark NetworkFailure constructor usage as fixed in network_info_impl.dart: Corrected NetworkFailure constructor call to provide required positional argument."},{"type":"INSERT","lineNumber":137,"content":"  - [ ] Fix missing/incorrect usage of core Dart classes (Timer, Completer)"},{"type":"INSERT","lineNumber":138,"content":"  - [x] Fix NotFoundException usage or define it"},{"type":"INSERT","lineNumber":140,"content":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"INSERT","lineNumber":142,"content":"  - [x] Mark NetworkFailure constructor usage as fixed in network_info_impl.dart: Corrected NetworkFailure constructor call to provide required positional argument."},{"type":"INSERT","lineNumber":143,"content":"  - [ ] Fix List<String> comparison logic in SharedPrefsManager"},{"type":"INSERT","lineNumber":144,"content":"{{ ... }}"}]},{"timestamp":1754511969110,"changes":[{"type":"MODIFY","lineNumber":14,"content":"- Error handling classes (failures) and base usecase class added to core layer.","oldContent":"- [x] Implement login screen"},{"type":"MODIFY","lineNumber":80,"content":"    - [x] Refactor family feature to MVVM (FamilyViewModel, update screens)","oldContent":"- [x] Create Post, Comment, Story, and StoryMedia entity classes for home feature"},{"type":"MODIFY","lineNumber":101,"content":"- [x] Create Post, Comment, Story, and StoryMedia entity classes for home feature","oldContent":"  - [ ] Fix type errors (e.g., assigning Unit to UserEntity?)"},{"type":"MODIFY","lineNumber":128,"content":"  - [x] Fix NavigationService usage and navigatorKey issues","oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":141,"oldContent":"{{ ... }}"},{"type":"MODIFY","lineNumber":141,"content":"  - [x] Fix NetworkFailure constructor usage in network_info_impl.dart","oldContent":"  - [ ] Fix List<String> comparison logic in SharedPrefsManager"},{"type":"INSERT","lineNumber":143,"content":"  - [x] Fix List<String> comparison logic in SharedPrefsManager"},{"type":"INSERT","lineNumber":144,"content":"{{ ... }}"}]},{"timestamp":1754512070133,"changes":[{"type":"DELETE","lineNumber":126,"oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":127,"oldContent":"  - [ ] Fix List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":126,"content":"  - [x] Implement checkFamilyMembership in FamilyRepositoryImpl"},{"type":"INSERT","lineNumber":127,"content":"  - [x] Fix widget constructor parameter errors (SuccessScreen, MaterialPageRoute, etc.)"},{"type":"MODIFY","lineNumber":136,"content":"  - [x] Fix DI registration and initialization for SharedPrefsManager","oldContent":"  - [x] Mark NetworkFailure constructor usage as fixed in network_info_impl.dart: Corrected NetworkFailure constructor call to provide required positional argument."},{"type":"DELETE","lineNumber":139,"oldContent":"{{ ... }}"},{"type":"DELETE","lineNumber":140,"oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":141,"oldContent":"  - [x] Fix NetworkFailure constructor usage in network_info_impl.dart"},{"type":"INSERT","lineNumber":139,"content":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":141,"content":"  - [x] Fix optionOf usage in AuthRepositoryImpl (handle nullable user/entity conversion)"},{"type":"INSERT","lineNumber":142,"content":"  - [ ] Next step: Fix optionOf usage in AuthRepositoryImpl (handle nullable user/entity conversion)"}]},{"timestamp":1754512156202,"changes":[{"type":"MODIFY","lineNumber":135,"content":"  - [ ] Fix syntax errors and unexpected tokens (e.g., join_or_create_family_screen.dart)","oldContent":"  - [x] Fix NetworkFailure constructor usage in network_info_impl.dart"},{"type":"INSERT","lineNumber":140,"content":"  - [x] Fix List<String> comparison logic in SharedPrefsManager"},{"type":"DELETE","lineNumber":141,"oldContent":"  - [ ] Next step: Fix optionOf usage in AuthRepositoryImpl (handle nullable user/entity conversion)"},{"type":"INSERT","lineNumber":142,"content":"{{ ... }}"}]},{"timestamp":1754512294776,"changes":[{"type":"MODIFY","lineNumber":120,"content":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model","oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"INSERT","lineNumber":142,"content":"  - [x] Fix fold usage in check_auth_status.dart"},{"type":"INSERT","lineNumber":143,"content":"  - [ ] Fix remaining issues in check_auth_status.dart"}]},{"timestamp":1754512398233,"changes":[{"type":"MODIFY","lineNumber":29,"content":"- Several files (main.dart, shared_prefs_manager.dart, navigation_service.dart, join_or_create_family_screen.dart, etc.) have critical errors or missing dependencies.","oldContent":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model"},{"type":"MODIFY","lineNumber":35,"content":"- Unresolved Comment type in HomeViewModel addressed: now mapping domain Comment to CommentModel and updating imports.","oldContent":"- Created missing comment_model.dart file and fixed LikePostParams usage in HomeViewModel."},{"type":"MODIFY","lineNumber":115,"content":"  - [x] Fix NavigationService and SharedPrefsManager usage and constructor issues","oldContent":"  - [x] Fix widget constructor parameter errors (SuccessScreen, MaterialPageRoute, etc.)"},{"type":"MODIFY","lineNumber":123,"content":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files","oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"MODIFY","lineNumber":125,"content":"  - [x] Add checkFamilyMembership method to FamilyRepository interface and implement it","oldContent":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files."},{"type":"MODIFY","lineNumber":143,"content":"  - [x] Fix remaining issues in check_auth_status.dart","oldContent":"  - [ ] Fix remaining issues in check_auth_status.dart"}]},{"timestamp":1754512643936,"changes":[{"type":"MODIFY","lineNumber":116,"content":"  - [ ] Fix type mismatches and constructor parameter issues in all ViewModels and screens","oldContent":"  - [x] Implement checkFamilyMembership in FamilyRepositoryImpl"},{"type":"MODIFY","lineNumber":119,"content":"  - [x] Fix type mismatch between List<Story> and List<StoryModel> in HomeViewModel by mapping domain entities to UI models","oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"MODIFY","lineNumber":122,"content":"  - [x] Fix unresolved Comment type in HomeViewModel by importing and/or mapping to the correct model","oldContent":"  - [x] Add checkFamilyMembership method to FamilyRepository interface and implement it"},{"type":"INSERT","lineNumber":144,"content":"  - [ ] Fix setError usage and error clearing in login_screen.dart"}]},{"timestamp":1754512697912,"changes":[{"type":"DELETE","lineNumber":37,"oldContent":"    - [x] Refactor authentication feature to MVVM (AuthViewModel, update screens)"},{"type":"DELETE","lineNumber":38,"oldContent":"- New: Build error - checkFamilyMembership method missing in FamilyRepository interface. Must add method and implement in repository/data source."},{"type":"INSERT","lineNumber":37,"content":"- Created missing comment_model.dart file and fixed LikePostParams usage in HomeViewModel."},{"type":"INSERT","lineNumber":38,"content":"- All critical HomeViewModel issues (type mismatches, required params, missing model) resolved."},{"type":"MODIFY","lineNumber":76,"content":"  - [x] Implement HomeViewModel and refactor HomeScreen to MVVM","oldContent":"  - [ ] Fix NoParams usage and import issues across all files"},{"type":"MODIFY","lineNumber":114,"content":"  - [x] Add missing imports for Failure and subclasses where needed","oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"MODIFY","lineNumber":118,"content":"  - [ ] Address unresolved imports and ambiguous/deprecated imports","oldContent":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files."},{"type":"MODIFY","lineNumber":124,"content":"  - [x] Fix ServerException constructor calls to use positional message argument in family_remote_data_source_impl.dart","oldContent":"  - [x] Fix DI registration and initialization for SharedPrefsManager"},{"type":"DELETE","lineNumber":132,"oldContent":"{{ ... }}"},{"type":"DELETE","lineNumber":133,"oldContent":"  - [ ] Fix List<String> comparison logic in SharedPrefsManager"},{"type":"DELETE","lineNumber":134,"oldContent":"  - [x] Mark NetworkFailure constructor usage as fixed in network_info_impl.dart: Corrected NetworkFailure constructor call to provide required positional argument."},{"type":"INSERT","lineNumber":132,"content":"  - [ ] Fix getter/setter/field usage errors (e.g., commentCount, inviteCode)"},{"type":"INSERT","lineNumber":133,"content":"  - [ ] Implement or fix missing methods in FamilyViewModel, HomeViewModel, PostWidget, etc."},{"type":"INSERT","lineNumber":134,"content":"  - [ ] Fix type errors (e.g., assigning Unit to UserEntity?)"},{"type":"MODIFY","lineNumber":138,"content":"  - [x] Fix NotFoundException usage or define it","oldContent":"{{ ... }}"},{"type":"MODIFY","lineNumber":144,"content":"  - [x] Fix setError usage and error clearing in login_screen.dart","oldContent":"  - [ ] Fix setError usage and error clearing in login_screen.dart"}]},{"timestamp":1754512815715,"changes":[{"type":"MODIFY","lineNumber":39,"content":"- New: Build error - ServerException constructor calls missing required positional argument (message) in family_remote_data_source_impl.dart. Must provide message as positional argument, not named.","oldContent":"- checkFamilyMembership method added to FamilyRepository interface; implementation still required."},{"type":"DELETE","lineNumber":41,"oldContent":"  - [ ] Fix List<String> comparison logic in shared_prefs_manager.dart"},{"type":"DELETE","lineNumber":42,"oldContent":"  - [ ] Fix missing/incorrect usage of core Dart classes (Timer, Completer)"},{"type":"INSERT","lineNumber":41,"content":"- checkFamilyMembership method added to FamilyRepository interface; implementation still required."},{"type":"INSERT","lineNumber":42,"content":"- Next steps: systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files (main.dart, FamilyViewModel, AuthViewModel, DI, etc.)."},{"type":"DELETE","lineNumber":112,"oldContent":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files."},{"type":"DELETE","lineNumber":113,"oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"INSERT","lineNumber":112,"content":"    - [x] Remove duplicate loadInitialData method in HomeViewModel"},{"type":"INSERT","lineNumber":113,"content":"    - [x] Update HomeScreen to use the correct loadInitialData method"},{"type":"MODIFY","lineNumber":117,"content":"  - [ ] Implement or fix missing methods in FamilyViewModel and other ViewModels","oldContent":"  - [x] Provide all required parameters for LikePostParams and AddCommentParams in HomeViewModel (e.g., userId, userName, content)"},{"type":"MODIFY","lineNumber":121,"content":"  - [x] Provide all required parameters for LikePostParams and AddCommentParams in HomeViewModel (e.g., userId, userName, content)","oldContent":"  - [x] Mark NetworkFailure constructor usage as fixed in network_info_impl.dart: Corrected NetworkFailure constructor call to provide required positional argument."},{"type":"MODIFY","lineNumber":137,"content":"  - [ ] Fix missing/incorrect usage of core Dart classes (Timer, Completer)","oldContent":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":139,"content":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving List<String> comparison logic in shared_prefs_manager.dart"},{"type":"DELETE","lineNumber":140,"oldContent":"  - [ ] Fix remaining issues in check_auth_status.dart"},{"type":"INSERT","lineNumber":141,"content":"  - [x] Fix optionOf usage in AuthRepositoryImpl (handle nullable user/entity conversion)"},{"type":"MODIFY","lineNumber":143,"content":"  - [x] Fix remaining issues in check_auth_status.dart","oldContent":"  - [ ] Fix setError usage and error clearing in login_screen.dart"},{"type":"INSERT","lineNumber":144,"content":"  - [x] Fix setError usage and error clearing in login_screen.dart"},{"type":"INSERT","lineNumber":145,"content":"  - [x] Fix error handling and state management in AuthViewModel"}]},{"timestamp":1754512923126,"changes":[{"type":"MODIFY","lineNumber":36,"content":"- addComment method in HomeViewModel now maps Comment to CommentModel.","oldContent":"  - [ ] Fix getter/setter/field usage errors (e.g., commentCount, inviteCode)"},{"type":"MODIFY","lineNumber":88,"content":"- [x] Restore missing files and dependencies (core/base, core/theme, core/utils, features/home/presentation/viewmodels, etc.)","oldContent":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files"},{"type":"DELETE","lineNumber":92,"oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":93,"oldContent":"  - [x] Implement checkFamilyMembership in FamilyRepositoryImpl"},{"type":"DELETE","lineNumber":94,"oldContent":"  - [x] Provide all required parameters for LikePostParams and AddCommentParams in HomeViewModel (e.g., userId, userName, content)"},{"type":"INSERT","lineNumber":92,"content":"- [x] Fix type/argument mismatches and duplicate method names (complete: auth screens)"},{"type":"INSERT","lineNumber":93,"content":"- [x] Fix syntax errors in auth and family screens"},{"type":"INSERT","lineNumber":94,"content":"- [ ] Run and verify app builds and runs correctly"},{"type":"MODIFY","lineNumber":97,"content":"- [x] Restore all missing files (network_info, home_viewmodel, delete_account, send_password_reset_email, family_remote_data_source_impl, check_family_membership, etc.)","oldContent":"  - [ ] Address unresolved imports and ambiguous/deprecated imports"},{"type":"MODIFY","lineNumber":111,"content":"  - [x] Remove duplicate method definitions (e.g. loadInitialData in HomeViewModel)","oldContent":"  - [ ] Fix missing/incorrect usage of core Dart classes (Timer, Completer)"},{"type":"DELETE","lineNumber":130,"oldContent":"{{ ... }}"},{"type":"DELETE","lineNumber":131,"oldContent":"  - [x] Fix List<String> comparison logic in SharedPrefsManager"},{"type":"INSERT","lineNumber":130,"content":"  - [ ] Resolve all conflicting/duplicate imports (e.g., CommentModel, FamilyRemoteDataSourceImpl, SignInWithApple)"},{"type":"INSERT","lineNumber":131,"content":"  - [ ] Fix method signature/type mismatches in use cases and ViewModels (e.g., checkAuthStatus, signInWithGoogle, signInWithApple, sendPasswordResetEmail, deleteAccount)"},{"type":"MODIFY","lineNumber":136,"content":"  - [x] Fix DI registration and initialization for SharedPrefsManager","oldContent":"  - [x] Fix List<String> comparison logic in SharedPrefsManager"},{"type":"MODIFY","lineNumber":140,"content":"  - [x] Fix List<String> comparison logic in SharedPrefsManager","oldContent":"  - [ ] Fix setError usage and error clearing in login_screen.dart"},{"type":"INSERT","lineNumber":142,"content":"  - [x] Fix fold usage in check_auth_status.dart"},{"type":"INSERT","lineNumber":143,"content":"  - [x] Fix remaining issues in check_auth_status.dart"},{"type":"INSERT","lineNumber":145,"content":"  - [x] Fix error handling and state management in AuthViewModel"},{"type":"INSERT","lineNumber":146,"content":"  - [ ] Improve error handling and state consistency in all AuthViewModel authentication methods"}]},{"timestamp":1754513328870,"changes":[{"type":"MODIFY","lineNumber":30,"content":"- New critical build errors: missing home/domain use cases (get_posts, get_stories, like_post, add_comment), type/argument mismatches, unresolved imports, constructor/parameter issues, and logic/syntax errors in main.dart, home_viewmodel.dart, auth/family screens, and DI files.","oldContent":"  - [ ] Fix NotFoundException usage or define it"},{"type":"DELETE","lineNumber":43,"oldContent":"  - [ ] Fix type mismatches and constructor parameter issues in all ViewModels and screens"},{"type":"DELETE","lineNumber":44,"oldContent":"- [ ] Run and verify app builds and runs correctly"},{"type":"DELETE","lineNumber":45,"oldContent":"- [x] Restore missing files and dependencies (core/base, core/theme, core/utils, features/home/presentation/viewmodels, etc.)"},{"type":"DELETE","lineNumber":46,"oldContent":"    - [x] Refactor authentication feature to MVVM (AuthViewModel, update screens)"},{"type":"DELETE","lineNumber":47,"oldContent":"- [x] Create DialogUtils utility class for dialogs and snackbars"},{"type":"DELETE","lineNumber":48,"oldContent":"- [x] Create SharedPrefsManager utility class for shared preferences"},{"type":"DELETE","lineNumber":49,"oldContent":"- [x] Integrate AuthBloc into main.dart and app flow"},{"type":"DELETE","lineNumber":50,"oldContent":"- [x] Implement authentication use cases: sign in, registration, OTP send/verify, sign out, CheckAuthStatus, SignInWithGoogle, SignInWithApple"},{"type":"INSERT","lineNumber":43,"content":"- New: Build errors in main.dart, home_viewmodel.dart, auth screens, splash, join_or_create_family_screen.dart, post_widget.dart, shared_prefs_manager.dart, navigation_service.dart, injection_container.dart, and family_repository_impl.dart. Issues include:"},{"type":"INSERT","lineNumber":44,"content":"  - Incorrect or missing parameters for widget constructors (e.g., SuccessScreen, MaterialPageRoute)"},{"type":"INSERT","lineNumber":45,"content":"  - Incorrect usage of navigatorKey and NavigationService"},{"type":"INSERT","lineNumber":46,"content":"  - NoParams usage where not defined or imported"},{"type":"INSERT","lineNumber":47,"content":"  - Conflicting imports (e.g., CommentModel, FamilyRemoteDataSourceImpl, SignInWithApple)"},{"type":"INSERT","lineNumber":48,"content":"  - Method signature mismatches (e.g., checkAuthStatus, signInWithGoogle, signInWithApple, sendPasswordResetEmail, deleteAccount)"},{"type":"INSERT","lineNumber":49,"content":"  - Incorrect getter/setter/field usage (e.g., commentCount, inviteCode)"},{"type":"INSERT","lineNumber":50,"content":"  - Missing/incorrect methods (e.g., _buildCommentSheet, checkFamilyStatus, validateCode, joinExistingFamily)"},{"type":"MODIFY","lineNumber":61,"content":"Fix and refactor FamilyRemoteDataSourceImpl for family flows","oldContent":"Resolve latest build errors: widget params, imports, types, DI, syntax"},{"type":"DELETE","lineNumber":66,"oldContent":"- [ ] Run and verify app builds and runs correctly"},{"type":"DELETE","lineNumber":67,"oldContent":"    - [x] Refactor authentication feature to MVVM (AuthViewModel, update screens)"},{"type":"DELETE","lineNumber":68,"oldContent":"  - [ ] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":69,"oldContent":"  - [x] Implement checkFamilyMembership in FamilyRepositoryImpl"},{"type":"DELETE","lineNumber":70,"oldContent":"  - [x] Provide all required parameters for LikePostParams and AddCommentParams in HomeViewModel (e.g., userId, userName, content)"},{"type":"DELETE","lineNumber":71,"oldContent":"  - [x] Fix type mismatch between List<Story> and List<StoryModel> in HomeViewModel by mapping domain entities to UI models"},{"type":"DELETE","lineNumber":72,"oldContent":"  - [ ] Systematically resolve remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files"},{"type":"DELETE","lineNumber":73,"oldContent":"  - [ ] Address unresolved imports and ambiguous/deprecated imports"},{"type":"DELETE","lineNumber":74,"oldContent":"  - [x] Add missing imports for Failure and subclasses where needed"},{"type":"INSERT","lineNumber":66,"content":"- [x] Implement AuthBloc for authentication state management"},{"type":"INSERT","lineNumber":67,"content":"- [x] Implement authentication use cases: sign in, registration, OTP send/verify, sign out, CheckAuthStatus, SignInWithGoogle, SignInWithApple"},{"type":"INSERT","lineNumber":68,"content":"- [x] Set up dependency injection for authentication feature"},{"type":"INSERT","lineNumber":69,"content":"- [x] Integrate AuthBloc into main.dart and app flow"},{"type":"INSERT","lineNumber":70,"content":"- [x] Create Validators utility class for form validation"},{"type":"INSERT","lineNumber":71,"content":"- [x] Create SharedPrefsManager utility class for shared preferences"},{"type":"INSERT","lineNumber":72,"content":"- [x] Create NavigationService utility class for type-safe navigation"},{"type":"INSERT","lineNumber":73,"content":"- [x] Create DialogUtils utility class for dialogs and snackbars"},{"type":"INSERT","lineNumber":74,"content":"- [ ] Refactor project to MVVM architecture (replace BLoC with ViewModel, update UI, etc.)"},{"type":"MODIFY","lineNumber":79,"content":"    - [x] Refactor authentication feature to MVVM (AuthViewModel, update screens)","oldContent":"  - [x] Add checkFamilyMembership method to FamilyRepository interface and implement it"},{"type":"DELETE","lineNumber":81,"oldContent":"  - [ ] Implement or fix missing methods in FamilyViewModel and other ViewModels"},{"type":"DELETE","lineNumber":82,"oldContent":"  - [x] Remove duplicate method definitions (e.g. loadInitialData in HomeViewModel)"},{"type":"INSERT","lineNumber":81,"content":"    - [x] Refactor splash screen to MVVM (SplashViewModel, provider, DI)"},{"type":"INSERT","lineNumber":82,"content":"    - [x] Remove remaining BLoC imports and usages"},{"type":"DELETE","lineNumber":84,"oldContent":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving remaining type/argument mismatches, missing/incorrect method usages, and unresolved imports as per latest build log in other files."},{"type":"DELETE","lineNumber":85,"oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":86,"oldContent":"    - [x] Update NoParams imports in HomeViewModel"},{"type":"INSERT","lineNumber":84,"content":"- [ ] Complete detailed analysis of each feature's structure and code"},{"type":"INSERT","lineNumber":85,"content":"- [ ] Remove unused/legacy code and files"},{"type":"INSERT","lineNumber":86,"content":"- [ ] Clean up and document codebase"},{"type":"MODIFY","lineNumber":96,"content":"- [x] Fix errors in family_viewmodel.dart (missing/incorrect arguments, duplicate definitions, invalid overrides, undefined methods)","oldContent":"- [x] Create PostRemoteDataSource interface and implementation for home feature"},{"type":"DELETE","lineNumber":99,"oldContent":"  - [ ] Fix syntax errors and unexpected tokens (e.g., join_or_create_family_screen.dart)"},{"type":"MODIFY","lineNumber":99,"content":"- [x] Restore missing home/domain use case files (get_posts.dart, get_stories.dart, like_post.dart, add_comment.dart)","oldContent":"  - [x] Mark NetworkFailure constructor usage as fixed in network_info_impl.dart: Corrected NetworkFailure constructor call to provide required positional argument."},{"type":"INSERT","lineNumber":100,"content":"- [x] Create PostRepository and StoryRepository interfaces for home feature"},{"type":"DELETE","lineNumber":102,"oldContent":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving List<String> comparison logic in shared_prefs_manager.dart"},{"type":"DELETE","lineNumber":103,"oldContent":"  - [ ] Fix type errors (e.g., assigning Unit to UserEntity?)"},{"type":"DELETE","lineNumber":104,"oldContent":"  - [ ] Implement or fix missing methods in FamilyViewModel, HomeViewModel, PostWidget, etc."},{"type":"INSERT","lineNumber":102,"content":"- [x] Create PostRemoteDataSource interface and implementation for home feature"},{"type":"INSERT","lineNumber":103,"content":"- [x] Create PostRepositoryImpl for home feature"},{"type":"INSERT","lineNumber":104,"content":"- [x] Create StoryRemoteDataSource interface and implementation for home feature"},{"type":"DELETE","lineNumber":106,"oldContent":"{{ ... }}"},{"type":"DELETE","lineNumber":107,"oldContent":"  - [ ] Fix List<String> comparison logic in SharedPrefsManager"},{"type":"DELETE","lineNumber":108,"oldContent":"  - [x] Mark NetworkFailure constructor usage as fixed in network_info_impl.dart: Corrected NetworkFailure constructor call to provide required positional argument."},{"type":"DELETE","lineNumber":109,"oldContent":"  - [x] Fix missing/incorrect imports for Timer (dart:async), Unit (dartz), and NoParams (core/usecases/usecase.dart) in all affected files (use cases, OTP screen, etc.)"},{"type":"DELETE","lineNumber":110,"oldContent":"  - [x] Fix NotFoundException usage or define it"},{"type":"INSERT","lineNumber":106,"content":"- [ ] Systematically address latest build errors (type mismatches, missing params, unresolved imports, constructor/signature issues, etc.)"},{"type":"INSERT","lineNumber":107,"content":"  - [x] Fix missing required arguments and type mismatches in HomeViewModel and HomeScreen"},{"type":"INSERT","lineNumber":108,"content":"  - [x] Update all NoParams imports/usages to use usecase.dart version"},{"type":"INSERT","lineNumber":109,"content":"    - [x] Update NoParams imports in HomeViewModel"},{"type":"INSERT","lineNumber":110,"content":"    - [x] Update NoParams imports in other affected files"},{"type":"DELETE","lineNumber":126,"oldContent":"  - [ ] Fix setError usage and error clearing in login_screen.dart"},{"type":"DELETE","lineNumber":127,"oldContent":"  - [ ] Fix type errors (e.g., assigning Unit to UserEntity?)"},{"type":"DELETE","lineNumber":128,"oldContent":"  - [ ] Implement or fix missing methods in FamilyViewModel, HomeViewModel, PostWidget, etc."},{"type":"DELETE","lineNumber":129,"oldContent":"  - [ ] Fix getter/setter/field usage errors (e.g., commentCount, inviteCode)"},{"type":"INSERT","lineNumber":126,"content":"  - [x] Implement checkFamilyMembership in FamilyRepositoryImpl"},{"type":"INSERT","lineNumber":127,"content":"  - [x] Fix widget constructor parameter errors (SuccessScreen, MaterialPageRoute, etc.)"},{"type":"INSERT","lineNumber":128,"content":"  - [x] Fix NavigationService usage and navigatorKey issues"},{"type":"INSERT","lineNumber":129,"content":"  - [x] Standardize NoParams usage across all files"},{"type":"DELETE","lineNumber":132,"oldContent":"  - [x] Fix optionOf usage in AuthRepositoryImpl (handle nullable user/entity conversion)"},{"type":"DELETE","lineNumber":133,"oldContent":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving List<String> comparison logic in shared_prefs_manager.dart"},{"type":"DELETE","lineNumber":134,"oldContent":"  - [ ] Improve error handling and state consistency in all AuthViewModel authentication methods"},{"type":"DELETE","lineNumber":135,"oldContent":"  - [x] Fix error handling and state management in AuthViewModel"},{"type":"INSERT","lineNumber":132,"content":"  - [ ] Fix getter/setter/field usage errors (e.g., commentCount, inviteCode)"},{"type":"INSERT","lineNumber":133,"content":"  - [ ] Implement or fix missing methods in FamilyViewModel, HomeViewModel, PostWidget, etc."},{"type":"INSERT","lineNumber":134,"content":"  - [ ] Fix type errors (e.g., assigning Unit to UserEntity?)"},{"type":"INSERT","lineNumber":135,"content":"  - [ ] Fix syntax errors and unexpected tokens (e.g., join_or_create_family_screen.dart)"},{"type":"INSERT","lineNumber":137,"content":"  - [ ] Fix missing/incorrect usage of core Dart classes (Timer, Completer)"},{"type":"INSERT","lineNumber":138,"content":"  - [x] Fix NotFoundException usage or define it"},{"type":"INSERT","lineNumber":139,"content":"  - [x] Mark NotFoundException usage as fixed and clarify next steps: Next steps include resolving List<String> comparison logic in shared_prefs_manager.dart"},{"type":"INSERT","lineNumber":140,"content":"  - [x] Fix List<String> comparison logic in SharedPrefsManager"},{"type":"INSERT","lineNumber":141,"content":"  - [x] Fix optionOf usage in AuthRepositoryImpl (handle nullable user/entity conversion)"},{"type":"INSERT","lineNumber":143,"content":"  - [x] Fix remaining issues in check_auth_status.dart"},{"type":"INSERT","lineNumber":144,"content":"  - [x] Fix setError usage and error clearing in login_screen.dart"},{"type":"INSERT","lineNumber":145,"content":"  - [x] Fix error handling and state management in AuthViewModel"},{"type":"INSERT","lineNumber":146,"content":"  - [ ] Improve error handling and state consistency in all AuthViewModel authentication methods"},{"type":"INSERT","lineNumber":147,"content":"- [ ] Fix and refactor FamilyRemoteDataSourceImpl (constructor/parameter mismatches, model/data consistency)"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/constants/app_constants.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/constants/app_constants.dart","baseContent":"class AppConstants {\n  static const String appName = 'Family Connect';\n  static const String appVersion = '1.0.0';\n  \n  // Routes\n  static const String splashRoute = '/';\n  static const String loginRoute = '/login';\n  static const String registerRoute = '/register';\n  static const String otpRoute = '/otp-verification';\n  static const String setupPasswordRoute = '/setup-password';\n  static const String successRoute = '/success';\n  static const String joinOrCreateFamilyRoute = '/join-or-create-family';\n  static const String joinFamilyRoute = '/join-family';\n  static const String createFamilyRoute = '/create-family';\n  static const String homeRoute = '/home';\n  \n  // Assets\n  static const String logoPath = 'assets/images/logo.png';\n  \n  // Animations\n  static const String splashAnimation = 'assets/animations/splash_animation.json';\n  static const String loadingAnimation = 'assets/animations/loading_animation.json';\n  static const String successAnimation = 'assets/animations/success_animation.json';\n  \n  // Default padding\n  static const double defaultPadding = 16.0;\n  static const double defaultBorderRadius = 12.0;\n}\n","baseTimestamp":1754375560195,"deltas":[{"timestamp":1754458722689,"changes":[{"type":"INSERT","lineNumber":1,"content":"  // App Info"},{"type":"INSERT","lineNumber":19,"content":"  static const String googleLogoPath = 'assets/images/google.svg';"},{"type":"INSERT","lineNumber":20,"content":"  static const String appleLogoPath = 'assets/images/apple.svg';"},{"type":"INSERT","lineNumber":22,"content":"  // Animation Durations"},{"type":"INSERT","lineNumber":23,"content":"  static const Duration animationDuration = Duration(milliseconds: 300);"},{"type":"INSERT","lineNumber":24,"content":"  static const Duration splashAnimationDuration = Duration(seconds: 2);"},{"type":"INSERT","lineNumber":25,"content":"  "},{"type":"INSERT","lineNumber":26,"content":"  // Form Validation"},{"type":"INSERT","lineNumber":27,"content":"  static const int minPasswordLength = 8;"},{"type":"INSERT","lineNumber":28,"content":"  static const int maxPasswordLength = 32;"},{"type":"INSERT","lineNumber":29,"content":"  static const int minNameLength = 2;"},{"type":"INSERT","lineNumber":30,"content":"  static const int maxNameLength = 50;"},{"type":"INSERT","lineNumber":31,"content":"  "},{"type":"INSERT","lineNumber":32,"content":"  // Firebase Collections"},{"type":"INSERT","lineNumber":33,"content":"  static const String usersCollection = 'users';"},{"type":"INSERT","lineNumber":34,"content":"  static const String familiesCollection = 'families';"},{"type":"INSERT","lineNumber":35,"content":"  "},{"type":"INSERT","lineNumber":36,"content":"  // Shared Preferences Keys"},{"type":"INSERT","lineNumber":37,"content":"  static const String authTokenKey = 'auth_token';"},{"type":"INSERT","lineNumber":38,"content":"  static const String userDataKey = 'user_data';"},{"type":"INSERT","lineNumber":39,"content":"  static const String isFirstLaunchKey = 'is_first_launch';"},{"type":"INSERT","lineNumber":40,"content":"  "},{"type":"INSERT","lineNumber":41,"content":"  // Error Messages"},{"type":"INSERT","lineNumber":42,"content":"  static const String networkErrorMessage = 'Please check your internet connection and try again';"},{"type":"INSERT","lineNumber":43,"content":"  static const String serverErrorMessage = 'Something went wrong. Please try again later';"},{"type":"INSERT","lineNumber":44,"content":"  static const String unexpectedErrorMessage = 'An unexpected error occurred';"},{"type":"INSERT","lineNumber":45,"content":"  "},{"type":"INSERT","lineNumber":46,"content":"  // Success Messages"},{"type":"INSERT","lineNumber":47,"content":"  static const String loginSuccessMessage = 'Logged in successfully';"},{"type":"INSERT","lineNumber":48,"content":"  static const String registerSuccessMessage = 'Account created successfully';"},{"type":"INSERT","lineNumber":49,"content":"  static const String passwordResetSentMessage = 'Password reset email sent';"},{"type":"INSERT","lineNumber":50,"content":"  static const String otpSentMessage = 'OTP sent to your phone number';"},{"type":"INSERT","lineNumber":51,"content":"  static const String otpVerifiedMessage = 'Phone number verified successfully';"},{"type":"INSERT","lineNumber":52,"content":"  "}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/screens/otp_verification_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/screens/otp_verification_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:family_tree_firebase/core/constants/app_constants.dart';\n\nclass OtpVerificationScreen extends StatefulWidget {\n  final String verificationId;\n  final String phoneNumber;\n\n  const OtpVerificationScreen({\n    super.key,\n    required this.verificationId,\n    required this.phoneNumber,\n  });\n\n  @override\n  State<OtpVerificationScreen> createState() => _OtpVerificationScreenState();\n}\n\nclass _OtpVerificationScreenState extends State<OtpVerificationScreen> {\n  final List<TextEditingController> _otpControllers =\n      List.generate(6, (index) => TextEditingController());\n  final List<FocusNode> _focusNodes = List.generate(6, (index) => FocusNode());\n  bool _isLoading = false;\n  bool _isResendLoading = false;\n  int _resendCodeIn = 30;\n  late Timer _resendTimer;\n\n  @override\n  void initState() {\n    super.initState();\n    _startResendTimer();\n  }\n\n  @override\n  void dispose() {\n    for (var controller in _otpControllers) {\n      controller.dispose();\n    }\n    for (var node in _focusNodes) {\n      node.dispose();\n    }\n    _resendTimer.cancel();\n    super.dispose();\n  }\n\n  void _startResendTimer() {\n    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {\n      if (_resendCodeIn > 0) {\n        setState(() => _resendCodeIn--);\n      } else {\n        _resendTimer.cancel();\n      }\n    });\n  }\n\n  Future<void> _verifyOtp() async {\n    final otp = _otpControllers.map((e) => e.text).join();\n    if (otp.length != 6) {\n      if (mounted) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          const SnackBar(content: Text('Please enter a valid OTP')),\n        );\n      }\n      return;\n    }\n\n    setState(() => _isLoading = true);\n\n    try {\n      // TODO: Implement OTP verification logic\n      await Future.delayed(const Duration(seconds: 2)); // Simulate API call\n\n      if (mounted) {\n        Navigator.pushReplacementNamed(\n          context,\n          AppConstants.setupPasswordRoute,\n          arguments: {\n            'email': 'user@example.com', // Replace with actual email\n            'name': 'User Name', // Replace with actual name\n            'phone': widget.phoneNumber,\n          },\n        );\n      }\n    } catch (e) {\n      if (mounted) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          SnackBar(content: Text(e.toString())),\n        );\n      }\n    } finally {\n      if (mounted) {\n        setState(() => _isLoading = false);\n      }\n    }\n  }\n\n  Future<void> _resendCode() async {\n    setState(() => _isResendLoading = true);\n\n    try {\n      // TODO: Implement resend OTP logic\n      await Future.delayed(const Duration(seconds: 1)); // Simulate API call\n      \n      setState(() => _resendCodeIn = 30);\n      _startResendTimer();\n      \n      if (mounted) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          const SnackBar(content: Text('OTP resent successfully')),\n        );\n      }\n    } catch (e) {\n      if (mounted) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          SnackBar(content: Text('Failed to resend OTP: ${e.toString()}')),\n        );\n      }\n    } finally {\n      if (mounted) {\n        setState(() => _isResendLoading = false);\n      }\n    }\n  }\n\n  void _onOtpChanged(String value, int index) {\n    if (value.length == 1 && index < 5) {\n      _focusNodes[index + 1].requestFocus();\n    } else if (value.isEmpty && index > 0) {\n      _focusNodes[index - 1].requestFocus();\n    }\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        leading: IconButton(\n          icon: const Icon(Icons.arrow_back_ios, size: 20),\n          onPressed: () => Navigator.pop(context),\n        ),\n      ),\n      body: SingleChildScrollView(\n        padding: const EdgeInsets.all(24.0),\n        child: Column(\n          crossAxisAlignment: CrossAxisAlignment.start,\n          children: [\n            const Text(\n              'Verify OTP',\n              style: TextStyle(\n                fontSize: 28,\n                fontWeight: FontWeight.bold,\n              ),\n            ),\n            const SizedBox(height: 8),\n            RichText(\n              text: TextSpan(\n                style: TextStyle(\n                  fontSize: 16,\n                  color: Colors.grey[600],\n                ),\n                children: [\n                  const TextSpan(text: 'Enter the OTP sent to '),\n                  TextSpan(\n                    text: widget.phoneNumber,\n                    style: const TextStyle(\n                      fontWeight: FontWeight.bold,\n                      color: Colors.black87,\n                    ),\n                  ),\n                ],\n              ),\n            ),\n            \n            const SizedBox(height: 40),\n            \n            // OTP Input Fields\n            Row(\n              mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n              children: List.generate(\n                6,\n                (index) => SizedBox(\n                  width: 45,\n                  child: TextFormField(\n                    controller: _otpControllers[index],\n                    focusNode: _focusNodes[index],\n                    keyboardType: TextInputType.number,\n                    textAlign: TextAlign.center,\n                    maxLength: 1,\n                    style: const TextStyle(fontSize: 20),\n                    decoration: InputDecoration(\n                      counterText: '',\n                      contentPadding: const EdgeInsets.symmetric(vertical: 12),\n                      border: OutlineInputBorder(\n                        borderRadius: BorderRadius.circular(8),\n                        borderSide: BorderSide(\n                          color: Colors.grey[300]!,\n                        ),\n                      ),\n                      enabledBorder: OutlineInputBorder(\n                        borderRadius: BorderRadius.circular(8),\n                        borderSide: BorderSide(\n                          color: Colors.grey[300]!,\n                        ),\n                      ),\n                      focusedBorder: OutlineInputBorder(\n                        borderRadius: BorderRadius.circular(8),\n                        borderSide: const BorderSide(\n                          color: Colors.blue,\n                          width: 2,\n                        ),\n                      ),\n                    ),\n                    onChanged: (value) => _onOtpChanged(value, index),\n                  ),\n                ),\n              ),\n            ),\n            \n            const SizedBox(height: 32),\n            \n            // Verify Button\n            SizedBox(\n              width: double.infinity,\n              child: ElevatedButton(\n                onPressed: _isLoading ? null : _verifyOtp,\n                style: ElevatedButton.styleFrom(\n                  padding: const EdgeInsets.symmetric(vertical: 16),\n                  shape: RoundedRectangleBorder(\n                    borderRadius: BorderRadius.circular(12),\n                  ),\n                ),\n                child: _isLoading\n                    ? const SizedBox(\n                        width: 24,\n                        height: 24,\n                        child: CircularProgressIndicator(\n                          color: Colors.white,\n                          strokeWidth: 2,\n                        ),\n                      )\n                    : const Text(\n                        'Verify OTP',\n                        style: TextStyle(fontSize: 16),\n                      ),\n              ),\n            ),\n            \n            const SizedBox(height: 24),\n            \n            // Resend Code\n            Row(\n              mainAxisAlignment: MainAxisAlignment.center,\n              children: [\n                Text(\n                  \"Didn't receive the code? \",\n                  style: TextStyle(\n                    color: Colors.grey[600],\n                  ),\n                ),\n                TextButton(\n                  onPressed: _resendCodeIn > 0 || _isResendLoading\n                      ? null\n                      : _resendCode,\n                  child: _isResendLoading\n                      ? const SizedBox(\n                          width: 16,\n                          height: 16,\n                          child: CircularProgressIndicator(\n                            strokeWidth: 2,\n                          ),\n                        )\n                      : Text(\n                          _resendCodeIn > 0\n                              ? 'Resend in $_resendCodeIn s'\n                              : 'Resend Code',\n                          style: TextStyle(\n                            color: _resendCodeIn > 0\n                                ? Colors.grey\n                                : Theme.of(context).primaryColor,\n                          ),\n                        ),\n                ),\n              ],\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n\nclass Timer {\n  Timer.periodic(Duration duration, Function(Timer) callback) {\n    // Implementation for timer\n  }\n  \n  void cancel() {\n    // Implementation to cancel timer\n  }\n}\n","baseTimestamp":1754375878750,"deltas":[{"timestamp":1754611129824,"changes":[{"type":"MODIFY","lineNumber":3,"content":"import 'package:provider/provider.dart';","oldContent":"import 'package:family_tree_firebase/core/constants/app_constants.dart';"},{"type":"MODIFY","lineNumber":5,"content":"import 'package:family_tree_firebase/core/constants/app_constants.dart';","oldContent":""},{"type":"INSERT","lineNumber":7,"content":""},{"type":"INSERT","lineNumber":8,"content":"class OtpVerificationScreen extends StatefulWidget {"},{"type":"INSERT","lineNumber":11,"content":""},{"type":"DELETE","lineNumber":23,"oldContent":"  bool _isLoading = false;"},{"type":"INSERT","lineNumber":26,"content":"  late AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":26,"oldContent":"  late AuthViewModel _viewModel;"},{"type":"INSERT","lineNumber":31,"content":"  @override"},{"type":"DELETE","lineNumber":31,"oldContent":"    _startResendTimer();"},{"type":"DELETE","lineNumber":32,"oldContent":"  }"},{"type":"DELETE","lineNumber":33,"oldContent":""},{"type":"MODIFY","lineNumber":36,"content":"    _startResendTimer();","oldContent":"  @override"},{"type":"INSERT","lineNumber":39,"content":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"DELETE","lineNumber":40,"oldContent":"      if (mounted && _focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":42,"oldContent":"    });"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"INSERT","lineNumber":43,"content":"    });"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"MODIFY","lineNumber":65,"content":"            behavior: SnackBarBehavior.floating,","oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":67,"oldContent":"  Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":69,"oldContent":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"INSERT","lineNumber":70,"content":"    }"},{"type":"INSERT","lineNumber":71,"content":"  }"},{"type":"INSERT","lineNumber":73,"content":"  void _startResendTimer() {"},{"type":"INSERT","lineNumber":74,"content":"    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"INSERT","lineNumber":75,"content":"      if (_resendCodeIn > 0) {"},{"type":"INSERT","lineNumber":76,"content":"        setState(() => _resendCodeIn--);"},{"type":"INSERT","lineNumber":77,"content":"      } else {"},{"type":"INSERT","lineNumber":78,"content":"        _resendTimer.cancel();"},{"type":"INSERT","lineNumber":79,"content":"      }"},{"type":"INSERT","lineNumber":80,"content":"    });"},{"type":"INSERT","lineNumber":81,"content":"  }"},{"type":"INSERT","lineNumber":82,"content":""},{"type":"INSERT","lineNumber":83,"content":"  Future<void> _handleOtpVerificationSuccess(User? user) async {"},{"type":"INSERT","lineNumber":84,"content":"    if (user != null && mounted) {"},{"type":"INSERT","lineNumber":85,"content":"      // Handle successful verification"},{"type":"INSERT","lineNumber":86,"content":"      Navigator.of(context).pushReplacementNamed('/home');"},{"type":"INSERT","lineNumber":88,"content":"  }"},{"type":"INSERT","lineNumber":89,"content":""},{"type":"INSERT","lineNumber":90,"content":"  Future<void> _verifyOtp() async {"},{"type":"INSERT","lineNumber":91,"content":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"INSERT","lineNumber":92,"content":"    if (otp.length != 6) {"},{"type":"INSERT","lineNumber":93,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":94,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":95,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":96,"content":"            content: Text('Please enter a valid 6-digit OTP'),"},{"type":"INSERT","lineNumber":97,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":98,"content":"          ),"},{"type":"INSERT","lineNumber":99,"content":"        );"},{"type":"INSERT","lineNumber":100,"content":"      }"},{"type":"INSERT","lineNumber":101,"content":"      return;"},{"type":"INSERT","lineNumber":102,"content":"    }"},{"type":"INSERT","lineNumber":103,"content":""},{"type":"INSERT","lineNumber":104,"content":"    try {"},{"type":"INSERT","lineNumber":105,"content":"      final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":106,"content":"        verificationId: widget.verificationId,"},{"type":"INSERT","lineNumber":107,"content":"        smsCode: otp,"},{"type":"INSERT","lineNumber":108,"content":"      );"},{"type":"INSERT","lineNumber":109,"content":"      "},{"type":"INSERT","lineNumber":110,"content":"      final userCredential = await FirebaseAuth.instance.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":111,"content":"      await _handleOtpVerificationSuccess(userCredential.user);"},{"type":"INSERT","lineNumber":112,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":113,"content":"      String message = 'Verification failed. Please try again.';"},{"type":"INSERT","lineNumber":114,"content":"      if (e.code == 'invalid-verification-code') {"},{"type":"INSERT","lineNumber":115,"content":"        message = 'Invalid OTP. Please try again.';"},{"type":"INSERT","lineNumber":116,"content":"      } else if (e.code == 'session-expired') {"},{"type":"INSERT","lineNumber":117,"content":"        message = 'Session expired. Please request a new OTP.';"},{"type":"INSERT","lineNumber":118,"content":"      }"},{"type":"INSERT","lineNumber":119,"content":"      "},{"type":"INSERT","lineNumber":120,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":121,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":122,"content":"          SnackBar("},{"type":"INSERT","lineNumber":123,"content":"            content: Text(message),"},{"type":"INSERT","lineNumber":124,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":125,"content":"          ),"},{"type":"INSERT","lineNumber":126,"content":"        );"},{"type":"INSERT","lineNumber":127,"content":"      }"},{"type":"INSERT","lineNumber":128,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":129,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":130,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":131,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":132,"content":"            content: Text('An error occurred. Please try again.'),"},{"type":"INSERT","lineNumber":133,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":134,"content":"          ),"},{"type":"INSERT","lineNumber":135,"content":"        );"},{"type":"INSERT","lineNumber":136,"content":"      }"},{"type":"INSERT","lineNumber":137,"content":"    }"},{"type":"INSERT","lineNumber":138,"content":"  }"},{"type":"INSERT","lineNumber":139,"content":""},{"type":"INSERT","lineNumber":140,"content":"  Future<void> _resendOtp() async {"},{"type":"INSERT","lineNumber":141,"content":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"INSERT","lineNumber":142,"content":""},{"type":"INSERT","lineNumber":144,"content":""},{"type":"INSERT","lineNumber":145,"content":"    try {"},{"type":"INSERT","lineNumber":146,"content":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"INSERT","lineNumber":147,"content":"      "},{"type":"INSERT","lineNumber":148,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":149,"content":"        // Clear OTP fields"},{"type":"INSERT","lineNumber":150,"content":"        for (var controller in _otpControllers) {"},{"type":"INSERT","lineNumber":151,"content":"          controller.clear();"},{"type":"INSERT","lineNumber":152,"content":"        }"},{"type":"INSERT","lineNumber":153,"content":"        "},{"type":"INSERT","lineNumber":154,"content":"        // Focus first field"},{"type":"INSERT","lineNumber":155,"content":"        if (_focusNodes[0].canRequestFocus) {"},{"type":"INSERT","lineNumber":156,"content":"          _focusNodes[0].requestFocus();"},{"type":"INSERT","lineNumber":157,"content":"        }"},{"type":"INSERT","lineNumber":158,"content":""},{"type":"INSERT","lineNumber":159,"content":"        if (success) {"},{"type":"INSERT","lineNumber":160,"content":"          // Reset timer"},{"type":"INSERT","lineNumber":161,"content":"          setState(() => _resendCodeIn = 30);"},{"type":"INSERT","lineNumber":162,"content":"          _startResendTimer();"},{"type":"INSERT","lineNumber":163,"content":"          "},{"type":"INSERT","lineNumber":164,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":165,"content":"            const SnackBar("},{"type":"INSERT","lineNumber":166,"content":"              content: Text('OTP has been resent successfully'),"},{"type":"INSERT","lineNumber":167,"content":"              behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":168,"content":"            ),"},{"type":"INSERT","lineNumber":169,"content":"          );"},{"type":"INSERT","lineNumber":170,"content":"        } else if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"INSERT","lineNumber":171,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":172,"content":"            SnackBar("},{"type":"INSERT","lineNumber":173,"content":"              content: Text(_viewModel.errorMessage!),"},{"type":"INSERT","lineNumber":174,"content":"              behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":175,"content":"            ),"},{"type":"INSERT","lineNumber":176,"content":"          );"},{"type":"INSERT","lineNumber":177,"content":"        }"},{"type":"INSERT","lineNumber":178,"content":"      }"},{"type":"INSERT","lineNumber":179,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":180,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":181,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":182,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":183,"content":"            content: Text('Failed to resend OTP. Please try again.'),"},{"type":"INSERT","lineNumber":184,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":185,"content":"          ),"},{"type":"INSERT","lineNumber":186,"content":"        );"},{"type":"INSERT","lineNumber":187,"content":"      }"},{"type":"INSERT","lineNumber":188,"content":"    } finally {"},{"type":"INSERT","lineNumber":189,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":190,"content":"        setState(() => _isResendLoading = false);"},{"type":"INSERT","lineNumber":191,"content":"      }"},{"type":"INSERT","lineNumber":192,"content":"    }"},{"type":"INSERT","lineNumber":195,"content":"  void _onOtpChanged(String value, int index) {"},{"type":"INSERT","lineNumber":196,"content":"    if (value.length == 1 && index < _otpControllers.length - 1) {"},{"type":"INSERT","lineNumber":197,"content":"      _focusNodes[index + 1].requestFocus();"},{"type":"INSERT","lineNumber":198,"content":"    } else if (value.isEmpty && index > 0) {"},{"type":"INSERT","lineNumber":199,"content":"      _focusNodes[index - 1].requestFocus();"},{"type":"INSERT","lineNumber":200,"content":"    }"},{"type":"INSERT","lineNumber":201,"content":"  }"},{"type":"INSERT","lineNumber":203,"content":"  Future<bool> _onWillPop() async {"},{"type":"INSERT","lineNumber":204,"content":"    if (_viewModel.isLoading) return false;"},{"type":"INSERT","lineNumber":205,"content":"    "},{"type":"INSERT","lineNumber":206,"content":"    final shouldPop = await showDialog<bool>("},{"type":"INSERT","lineNumber":207,"content":"      context: context,"},{"type":"INSERT","lineNumber":208,"content":"      builder: (context) => AlertDialog("},{"type":"INSERT","lineNumber":209,"content":"        title: const Text('Are you sure?'),"},{"type":"INSERT","lineNumber":210,"content":"        content: const Text('Do you want to cancel OTP verification?'),"},{"type":"INSERT","lineNumber":211,"content":"        actions: ["},{"type":"INSERT","lineNumber":212,"content":"          TextButton("},{"type":"INSERT","lineNumber":213,"content":"            onPressed: () => Navigator.of(context).pop(false),"},{"type":"INSERT","lineNumber":214,"content":"            child: const Text('No'),"},{"type":"INSERT","lineNumber":215,"content":"          ),"},{"type":"INSERT","lineNumber":216,"content":"          TextButton("},{"type":"INSERT","lineNumber":217,"content":"            onPressed: () {"},{"type":"INSERT","lineNumber":218,"content":"              _viewModel.setErrorSilently();"},{"type":"INSERT","lineNumber":219,"content":"              Navigator.of(context).pop(true);"},{"type":"INSERT","lineNumber":220,"content":"            },"},{"type":"INSERT","lineNumber":221,"content":"            child: const Text('Yes'),"},{"type":"INSERT","lineNumber":222,"content":"          ),"},{"type":"INSERT","lineNumber":223,"content":"        ],"},{"type":"INSERT","lineNumber":224,"content":"      ),"},{"type":"INSERT","lineNumber":225,"content":"    );"},{"type":"INSERT","lineNumber":226,"content":"    "},{"type":"INSERT","lineNumber":227,"content":"    return shouldPop ?? false;"},{"type":"INSERT","lineNumber":228,"content":"  }"},{"type":"INSERT","lineNumber":229,"content":""},{"type":"INSERT","lineNumber":230,"content":"  @override"},{"type":"INSERT","lineNumber":231,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":232,"content":"    return WillPopScope("},{"type":"INSERT","lineNumber":233,"content":"      onWillPop: _onWillPop,"},{"type":"INSERT","lineNumber":234,"content":"      child: Scaffold("},{"type":"INSERT","lineNumber":235,"content":"        appBar: AppBar("},{"type":"INSERT","lineNumber":236,"content":"          title: const Text('Verify OTP'),"},{"type":"INSERT","lineNumber":237,"content":"          leading: IconButton("},{"type":"INSERT","lineNumber":238,"content":"            icon: const Icon(Icons.arrow_back),"},{"type":"INSERT","lineNumber":239,"content":"            onPressed: () => _onWillPop().then((value) {"},{"type":"INSERT","lineNumber":240,"content":"              if (value) {"},{"type":"INSERT","lineNumber":241,"content":"                Navigator.of(context).pop();"},{"type":"INSERT","lineNumber":242,"content":"              }"},{"type":"INSERT","lineNumber":243,"content":"            }),"},{"type":"INSERT","lineNumber":244,"content":"          ),"},{"type":"INSERT","lineNumber":245,"content":"        ),"},{"type":"INSERT","lineNumber":246,"content":"        body: SingleChildScrollView("},{"type":"INSERT","lineNumber":247,"content":"          padding: const EdgeInsets.all(16.0),"},{"type":"INSERT","lineNumber":248,"content":"          child: Column("},{"type":"INSERT","lineNumber":249,"content":"            children: ["},{"type":"INSERT","lineNumber":250,"content":"              const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":251,"content":"              const Text("},{"type":"INSERT","lineNumber":252,"content":"                'Enter OTP',"},{"type":"INSERT","lineNumber":253,"content":"                style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),"},{"type":"INSERT","lineNumber":254,"content":"              ),"},{"type":"INSERT","lineNumber":255,"content":"              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":256,"content":"              Text("},{"type":"INSERT","lineNumber":257,"content":"                'We have sent an OTP to +91 ${widget.phoneNumber}',"},{"type":"INSERT","lineNumber":258,"content":"                textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":259,"content":"                style: const TextStyle(fontSize: 16, color: Colors.grey),"},{"type":"INSERT","lineNumber":260,"content":"              ),"},{"type":"INSERT","lineNumber":261,"content":"              const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":262,"content":"              Row("},{"type":"INSERT","lineNumber":263,"content":"                mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"INSERT","lineNumber":264,"content":"                children: List.generate("},{"type":"INSERT","lineNumber":265,"content":"                  6,"},{"type":"INSERT","lineNumber":266,"content":"                  (index) => SizedBox("},{"type":"INSERT","lineNumber":267,"content":"                    width: 50,"},{"type":"INSERT","lineNumber":268,"content":"                    child: TextField("},{"type":"INSERT","lineNumber":269,"content":"                      controller: _otpControllers[index],"},{"type":"INSERT","lineNumber":270,"content":"                      focusNode: _focusNodes[index],"},{"type":"INSERT","lineNumber":271,"content":"                      keyboardType: TextInputType.number,"},{"type":"INSERT","lineNumber":272,"content":"                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":273,"content":"                      maxLength: 1,"},{"type":"INSERT","lineNumber":274,"content":"                      onChanged: (value) => _onOtpChanged(value, index),"},{"type":"INSERT","lineNumber":275,"content":"                      decoration: const InputDecoration("},{"type":"INSERT","lineNumber":276,"content":"                        counterText: '',"},{"type":"INSERT","lineNumber":277,"content":"                        border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":278,"content":"                      ),"},{"type":"INSERT","lineNumber":279,"content":"                    ),"},{"type":"INSERT","lineNumber":280,"content":"                  ),"},{"type":"INSERT","lineNumber":281,"content":"                ),"},{"type":"INSERT","lineNumber":282,"content":"              ),"},{"type":"INSERT","lineNumber":283,"content":"              const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":284,"content":"              ElevatedButton("},{"type":"INSERT","lineNumber":285,"content":"                onPressed: _viewModel.isLoading ? null : _verifyOtp,"},{"type":"INSERT","lineNumber":286,"content":"                child: _viewModel.isLoading"},{"type":"INSERT","lineNumber":287,"content":"                    ? const CircularProgressIndicator()"},{"type":"INSERT","lineNumber":288,"content":"                    : const Text('Verify OTP'),"},{"type":"INSERT","lineNumber":289,"content":"              ),"},{"type":"INSERT","lineNumber":290,"content":"              const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":291,"content":"              TextButton("},{"type":"INSERT","lineNumber":292,"content":"                onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"INSERT","lineNumber":293,"content":"                child: _isResendLoading"},{"type":"INSERT","lineNumber":294,"content":"                    ? const CircularProgressIndicator()"},{"type":"INSERT","lineNumber":295,"content":"                    : Text("},{"type":"INSERT","lineNumber":296,"content":"                        _resendCodeIn > 0"},{"type":"INSERT","lineNumber":297,"content":"                            ? 'Resend code in $_resendCodeIn seconds'"},{"type":"INSERT","lineNumber":298,"content":"                            : 'Resend OTP',"},{"type":"INSERT","lineNumber":299,"content":"                        style: TextStyle("},{"type":"INSERT","lineNumber":300,"content":"                          color: _resendCodeIn == 0"},{"type":"INSERT","lineNumber":301,"content":"                              ? Theme.of(context).primaryColor"},{"type":"INSERT","lineNumber":302,"content":"                              : Colors.grey,"},{"type":"INSERT","lineNumber":303,"content":"                        ),"},{"type":"INSERT","lineNumber":304,"content":"                      ),"},{"type":"INSERT","lineNumber":305,"content":"              ),"},{"type":"INSERT","lineNumber":306,"content":"            ],"},{"type":"INSERT","lineNumber":307,"content":"          ),"},{"type":"INSERT","lineNumber":308,"content":"        ),"},{"type":"INSERT","lineNumber":309,"content":"      ),"},{"type":"INSERT","lineNumber":310,"content":"    );"},{"type":"INSERT","lineNumber":311,"content":"  }"},{"type":"INSERT","lineNumber":312,"content":"}"},{"type":"INSERT","lineNumber":313,"content":""},{"type":"INSERT","lineNumber":314,"content":"class _OtpVerificationScreenState extends State<OtpVerificationScreen> {"},{"type":"INSERT","lineNumber":315,"content":"  final List<TextEditingController> _otpControllers ="},{"type":"INSERT","lineNumber":316,"content":"      List.generate(6, (index) => TextEditingController());"},{"type":"INSERT","lineNumber":317,"content":"  final List<FocusNode> _focusNodes = List.generate(6, (index) => FocusNode());"},{"type":"INSERT","lineNumber":318,"content":"  late AuthViewModel _viewModel;"},{"type":"INSERT","lineNumber":319,"content":"  bool _isResendLoading = false;"},{"type":"INSERT","lineNumber":320,"content":"  int _resendCodeIn = 30;"},{"type":"INSERT","lineNumber":321,"content":"  late Timer _resendTimer;"},{"type":"INSERT","lineNumber":322,"content":""},{"type":"INSERT","lineNumber":323,"content":"  @override"},{"type":"INSERT","lineNumber":324,"content":"  void initState() {"},{"type":"INSERT","lineNumber":325,"content":"    super.initState();"},{"type":"INSERT","lineNumber":326,"content":"    _viewModel = context.read<AuthViewModel>();"},{"type":"INSERT","lineNumber":327,"content":"    _viewModel.addListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":328,"content":"    _startResendTimer();"},{"type":"INSERT","lineNumber":329,"content":"    "},{"type":"INSERT","lineNumber":330,"content":"    // Auto-focus the first OTP field"},{"type":"INSERT","lineNumber":331,"content":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"INSERT","lineNumber":332,"content":"      if (mounted && _focusNodes[0].canRequestFocus) {"},{"type":"INSERT","lineNumber":333,"content":"        _focusNodes[0].requestFocus();"},{"type":"INSERT","lineNumber":334,"content":"      }"},{"type":"INSERT","lineNumber":335,"content":"    });"},{"type":"INSERT","lineNumber":336,"content":"  }"},{"type":"INSERT","lineNumber":337,"content":""},{"type":"INSERT","lineNumber":338,"content":"  @override"},{"type":"INSERT","lineNumber":339,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":340,"content":"    for (var controller in _otpControllers) {"},{"type":"INSERT","lineNumber":341,"content":"      controller.dispose();"},{"type":"INSERT","lineNumber":342,"content":"    }"},{"type":"INSERT","lineNumber":343,"content":"    for (var node in _focusNodes) {"},{"type":"INSERT","lineNumber":344,"content":"      node.dispose();"},{"type":"INSERT","lineNumber":345,"content":"    }"},{"type":"INSERT","lineNumber":346,"content":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":347,"content":"    _resendTimer.cancel();"},{"type":"INSERT","lineNumber":348,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":349,"content":"  }"},{"type":"INSERT","lineNumber":350,"content":""},{"type":"INSERT","lineNumber":351,"content":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":352,"content":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"INSERT","lineNumber":353,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":354,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":355,"content":"          SnackBar("},{"type":"INSERT","lineNumber":356,"content":"            content: Text(_viewModel.errorMessage!),"},{"type":"INSERT","lineNumber":357,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":358,"content":"          ),"},{"type":"INSERT","lineNumber":359,"content":"        );"},{"type":"INSERT","lineNumber":360,"content":"        _viewModel.setError();"},{"type":"INSERT","lineNumber":361,"content":"      }"},{"type":"INSERT","lineNumber":362,"content":"    }"},{"type":"INSERT","lineNumber":363,"content":"  }"},{"type":"INSERT","lineNumber":364,"content":""},{"type":"DELETE","lineNumber":80,"oldContent":"    try {"},{"type":"DELETE","lineNumber":82,"oldContent":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":85,"oldContent":"      "},{"type":"DELETE","lineNumber":87,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":90,"oldContent":"        // Clear OTP fields"},{"type":"DELETE","lineNumber":92,"oldContent":"        for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":95,"oldContent":"          controller.clear();"},{"type":"DELETE","lineNumber":97,"oldContent":"        }"},{"type":"DELETE","lineNumber":100,"oldContent":"        "},{"type":"DELETE","lineNumber":102,"oldContent":"        // Focus first field"},{"type":"DELETE","lineNumber":105,"oldContent":"        if (_focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":107,"oldContent":"          _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":110,"oldContent":"        }"},{"type":"DELETE","lineNumber":112,"oldContent":""},{"type":"DELETE","lineNumber":115,"oldContent":"        if (success) {"},{"type":"DELETE","lineNumber":117,"oldContent":"          // Reset timer"},{"type":"DELETE","lineNumber":120,"oldContent":"          setState(() => _resendCodeIn = 30);"},{"type":"DELETE","lineNumber":122,"oldContent":"          _startResendTimer();"},{"type":"DELETE","lineNumber":125,"oldContent":"          "},{"type":"DELETE","lineNumber":127,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":130,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":132,"oldContent":"              content: Text('OTP has been resent successfully'),"},{"type":"DELETE","lineNumber":135,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":137,"oldContent":"            ),"},{"type":"DELETE","lineNumber":140,"oldContent":"          );"},{"type":"DELETE","lineNumber":142,"oldContent":"        } else if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"DELETE","lineNumber":145,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":148,"oldContent":"            SnackBar("},{"type":"DELETE","lineNumber":151,"oldContent":"              content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":154,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":157,"oldContent":"            ),"},{"type":"DELETE","lineNumber":160,"oldContent":"          );"},{"type":"DELETE","lineNumber":163,"oldContent":"        }"},{"type":"DELETE","lineNumber":167,"oldContent":"      }"},{"type":"DELETE","lineNumber":169,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":171,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":173,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":176,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":179,"oldContent":"            content: Text('Failed to resend OTP. Please try again.'),"},{"type":"DELETE","lineNumber":181,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":183,"oldContent":"          ),"},{"type":"DELETE","lineNumber":186,"oldContent":"        );"},{"type":"INSERT","lineNumber":433,"content":"  Future<void> _resendOtp() async {"},{"type":"INSERT","lineNumber":434,"content":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"INSERT","lineNumber":435,"content":""},{"type":"INSERT","lineNumber":436,"content":"    setState(() => _isResendLoading = true);"},{"type":"INSERT","lineNumber":437,"content":""},{"type":"INSERT","lineNumber":438,"content":"    try {"},{"type":"INSERT","lineNumber":439,"content":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"INSERT","lineNumber":440,"content":"      "},{"type":"INSERT","lineNumber":441,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":442,"content":"        // Clear OTP fields"},{"type":"INSERT","lineNumber":443,"content":"        for (var controller in _otpControllers) {"},{"type":"INSERT","lineNumber":444,"content":"          controller.clear();"},{"type":"INSERT","lineNumber":445,"content":"        }"},{"type":"INSERT","lineNumber":446,"content":"        "},{"type":"INSERT","lineNumber":447,"content":"        // Focus first field"},{"type":"INSERT","lineNumber":448,"content":"        if (_focusNodes[0].canRequestFocus) {"},{"type":"INSERT","lineNumber":449,"content":"          _focusNodes[0].requestFocus();"},{"type":"INSERT","lineNumber":450,"content":"        }"},{"type":"INSERT","lineNumber":451,"content":""},{"type":"INSERT","lineNumber":452,"content":"        if (success) {"},{"type":"INSERT","lineNumber":453,"content":"          // Reset timer"},{"type":"INSERT","lineNumber":454,"content":"          setState(() => _resendCodeIn = 30);"},{"type":"INSERT","lineNumber":455,"content":"          _startResendTimer();"},{"type":"INSERT","lineNumber":456,"content":"          "},{"type":"INSERT","lineNumber":457,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":458,"content":"            const SnackBar("},{"type":"INSERT","lineNumber":459,"content":"              content: Text('OTP has been resent successfully'),"},{"type":"INSERT","lineNumber":460,"content":"              behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":461,"content":"            ),"},{"type":"INSERT","lineNumber":462,"content":"          );"},{"type":"INSERT","lineNumber":463,"content":"        } else if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"INSERT","lineNumber":464,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":465,"content":"            SnackBar("},{"type":"INSERT","lineNumber":466,"content":"              content: Text(_viewModel.errorMessage!),"},{"type":"INSERT","lineNumber":467,"content":"              behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":468,"content":"            ),"},{"type":"INSERT","lineNumber":469,"content":"          );"},{"type":"INSERT","lineNumber":470,"content":"        }"},{"type":"INSERT","lineNumber":472,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":473,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":474,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":475,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":476,"content":"            content: Text('Failed to resend OTP. Please try again.'),"},{"type":"INSERT","lineNumber":477,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":478,"content":"          ),"},{"type":"INSERT","lineNumber":479,"content":"        );"},{"type":"INSERT","lineNumber":480,"content":"      }"},{"type":"INSERT","lineNumber":486,"content":"  }"},{"type":"INSERT","lineNumber":487,"content":""},{"type":"DELETE","lineNumber":220,"oldContent":"  }"},{"type":"DELETE","lineNumber":221,"oldContent":""},{"type":"DELETE","lineNumber":281,"oldContent":"}"},{"type":"INSERT","lineNumber":574,"content":"                ),"},{"type":"INSERT","lineNumber":575,"content":"              ),"},{"type":"INSERT","lineNumber":576,"content":"              const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":577,"content":"              ElevatedButton("},{"type":"INSERT","lineNumber":578,"content":"                onPressed: _viewModel.isLoading ? null : _verifyOtp,"},{"type":"INSERT","lineNumber":579,"content":"                child: _viewModel.isLoading"},{"type":"INSERT","lineNumber":580,"content":"                    ? const CircularProgressIndicator()"},{"type":"INSERT","lineNumber":581,"content":"                    : const Text('Verify OTP'),"},{"type":"INSERT","lineNumber":582,"content":"              ),"},{"type":"INSERT","lineNumber":583,"content":"              const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":584,"content":"              TextButton("},{"type":"INSERT","lineNumber":585,"content":"                onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"INSERT","lineNumber":586,"content":"                child: _isResendLoading"},{"type":"INSERT","lineNumber":587,"content":"                    ? const CircularProgressIndicator()"},{"type":"INSERT","lineNumber":588,"content":"                    : Text("},{"type":"INSERT","lineNumber":589,"content":"                        _resendCodeIn > 0"},{"type":"INSERT","lineNumber":590,"content":"                            ? 'Resend code in $_resendCodeIn seconds'"},{"type":"INSERT","lineNumber":591,"content":"                            : 'Resend OTP',"},{"type":"INSERT","lineNumber":592,"content":"                        style: TextStyle("},{"type":"INSERT","lineNumber":593,"content":"                          color: _resendCodeIn == 0"},{"type":"INSERT","lineNumber":594,"content":"                              ? Theme.of(context).primaryColor"},{"type":"INSERT","lineNumber":595,"content":"                              : Colors.grey,"},{"type":"INSERT","lineNumber":596,"content":"                        ),"},{"type":"INSERT","lineNumber":597,"content":"                      ),"},{"type":"INSERT","lineNumber":598,"content":"              ),"},{"type":"INSERT","lineNumber":599,"content":"            ],"},{"type":"INSERT","lineNumber":600,"content":"          ),"},{"type":"INSERT","lineNumber":601,"content":"        ),"},{"type":"INSERT","lineNumber":602,"content":"      ),"},{"type":"INSERT","lineNumber":603,"content":"    );"},{"type":"INSERT","lineNumber":604,"content":"  }"},{"type":"INSERT","lineNumber":605,"content":"}"},{"type":"DELETE","lineNumber":285,"oldContent":"                ),"},{"type":"DELETE","lineNumber":288,"oldContent":"              ),"},{"type":"DELETE","lineNumber":291,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":294,"oldContent":"              ElevatedButton("},{"type":"DELETE","lineNumber":296,"oldContent":"                onPressed: _viewModel.isLoading ? null : _verifyOtp,"},{"type":"DELETE","lineNumber":299,"oldContent":"                child: _viewModel.isLoading"},{"type":"DELETE","lineNumber":301,"oldContent":"                    ? const CircularProgressIndicator()"},{"type":"DELETE","lineNumber":304,"oldContent":"                    : const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":307,"oldContent":"              ),"},{"type":"DELETE","lineNumber":310,"oldContent":"              const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":313,"oldContent":"              TextButton("},{"type":"DELETE","lineNumber":316,"oldContent":"                onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"DELETE","lineNumber":318,"oldContent":"                child: _isResendLoading"},{"type":"INSERT","lineNumber":629,"content":"  }"},{"type":"INSERT","lineNumber":630,"content":""},{"type":"DELETE","lineNumber":320,"oldContent":"                    ? const CircularProgressIndicator()"},{"type":"DELETE","lineNumber":322,"oldContent":"                    : Text("},{"type":"DELETE","lineNumber":325,"oldContent":"                        _resendCodeIn > 0"},{"type":"DELETE","lineNumber":328,"oldContent":"                            ? 'Resend code in $_resendCodeIn seconds'"},{"type":"DELETE","lineNumber":331,"oldContent":"                            : 'Resend OTP',"},{"type":"DELETE","lineNumber":334,"oldContent":"                        style: TextStyle("},{"type":"DELETE","lineNumber":337,"oldContent":"                          color: _resendCodeIn == 0"},{"type":"DELETE","lineNumber":339,"oldContent":"                              ? Theme.of(context).primaryColor"},{"type":"DELETE","lineNumber":342,"oldContent":"                              : Colors.grey,"},{"type":"DELETE","lineNumber":344,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":347,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":350,"oldContent":"              ),"},{"type":"DELETE","lineNumber":353,"oldContent":"            ],"},{"type":"DELETE","lineNumber":356,"oldContent":"          ),"},{"type":"DELETE","lineNumber":359,"oldContent":"        ),"},{"type":"DELETE","lineNumber":361,"oldContent":"      ),"},{"type":"DELETE","lineNumber":364,"oldContent":"    );"},{"type":"DELETE","lineNumber":366,"oldContent":"  }"},{"type":"DELETE","lineNumber":368,"oldContent":"  }"},{"type":"DELETE","lineNumber":370,"oldContent":""},{"type":"DELETE","lineNumber":372,"oldContent":"  Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":374,"oldContent":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":376,"oldContent":""},{"type":"DELETE","lineNumber":378,"oldContent":"    try {"},{"type":"DELETE","lineNumber":380,"oldContent":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":381,"oldContent":"      "},{"type":"INSERT","lineNumber":668,"content":"  Future<void> _resendOtp() async {"},{"type":"INSERT","lineNumber":669,"content":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":383,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":385,"oldContent":"  @override"},{"type":"DELETE","lineNumber":387,"oldContent":"        if (success) {"},{"type":"DELETE","lineNumber":388,"oldContent":"          // Clear all OTP fields"},{"type":"DELETE","lineNumber":389,"oldContent":"          for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":390,"oldContent":"            controller.clear();"},{"type":"INSERT","lineNumber":673,"content":"    try {"},{"type":"INSERT","lineNumber":674,"content":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"INSERT","lineNumber":675,"content":"      "},{"type":"DELETE","lineNumber":392,"oldContent":"          }"},{"type":"DELETE","lineNumber":394,"oldContent":"          // Focus the first OTP field"},{"type":"DELETE","lineNumber":396,"oldContent":"          if (_focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":398,"oldContent":"            _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":400,"oldContent":"          }"},{"type":"DELETE","lineNumber":402,"oldContent":"          "},{"type":"DELETE","lineNumber":404,"oldContent":"          // Show success message"},{"type":"DELETE","lineNumber":406,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":408,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":410,"oldContent":"              content: Text('A new OTP has been sent to your phone number.'),"},{"type":"DELETE","lineNumber":411,"oldContent":"              backgroundColor: Colors.green,"},{"type":"INSERT","lineNumber":686,"content":""},{"type":"DELETE","lineNumber":413,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":416,"oldContent":"            ),"},{"type":"DELETE","lineNumber":419,"oldContent":"          );"},{"type":"DELETE","lineNumber":422,"oldContent":"          "},{"type":"DELETE","lineNumber":425,"oldContent":"          // Reset the resend timer"},{"type":"DELETE","lineNumber":428,"oldContent":"          setState(() {"},{"type":"DELETE","lineNumber":431,"oldContent":"            _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":434,"oldContent":"            _startResendTimer();"},{"type":"DELETE","lineNumber":437,"oldContent":"          });"},{"type":"DELETE","lineNumber":440,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":443,"oldContent":"          if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"INSERT","lineNumber":708,"content":"      if (mounted) {"},{"type":"DELETE","lineNumber":446,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":449,"oldContent":"              SnackBar("},{"type":"DELETE","lineNumber":452,"oldContent":"                content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":455,"oldContent":"                backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":458,"oldContent":"                behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":461,"oldContent":"              ),"},{"type":"DELETE","lineNumber":464,"oldContent":"            );"},{"type":"DELETE","lineNumber":467,"oldContent":"          }"},{"type":"DELETE","lineNumber":470,"oldContent":"        }"},{"type":"DELETE","lineNumber":473,"oldContent":"      }"},{"type":"DELETE","lineNumber":476,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":480,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":484,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":487,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":490,"oldContent":"            content: Text('Failed to resend OTP: ${e.toString()}'),"},{"type":"DELETE","lineNumber":493,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":496,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":499,"oldContent":"          ),"},{"type":"DELETE","lineNumber":502,"oldContent":"        );"},{"type":"DELETE","lineNumber":505,"oldContent":"      }"},{"type":"DELETE","lineNumber":508,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":511,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":514,"oldContent":"        setState(() => _isResendLoading = false);"},{"type":"DELETE","lineNumber":516,"oldContent":"      }"},{"type":"INSERT","lineNumber":758,"content":"  @override"},{"type":"DELETE","lineNumber":519,"oldContent":"    }"},{"type":"DELETE","lineNumber":522,"oldContent":"  }"},{"type":"DELETE","lineNumber":525,"oldContent":""},{"type":"DELETE","lineNumber":528,"oldContent":"  void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":531,"oldContent":"    if (value.length == 1 && index < 5) {"},{"type":"DELETE","lineNumber":534,"oldContent":"      _focusNodes[index + 1].requestFocus();"},{"type":"DELETE","lineNumber":536,"oldContent":"    } else if (value.isEmpty && index > 0) {"},{"type":"DELETE","lineNumber":538,"oldContent":"      builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":541,"oldContent":"        title: const Text('Cancel Verification?'),"},{"type":"DELETE","lineNumber":544,"oldContent":"        content: const Text('Are you sure you want to cancel the verification process?'),"},{"type":"DELETE","lineNumber":547,"oldContent":"        actions: ["},{"type":"DELETE","lineNumber":550,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":553,"oldContent":"            onPressed: () => Navigator.of(context).pop(false),"},{"type":"DELETE","lineNumber":556,"oldContent":"            child: const Text('No'),"},{"type":"DELETE","lineNumber":558,"oldContent":"          ),"},{"type":"DELETE","lineNumber":560,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":562,"oldContent":"            onPressed: () {"},{"type":"DELETE","lineNumber":564,"oldContent":"              // Clear any existing verification state"},{"type":"DELETE","lineNumber":566,"oldContent":"              _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":568,"oldContent":"              Navigator.of(context).pop(true);"},{"type":"DELETE","lineNumber":570,"oldContent":"            },"},{"type":"DELETE","lineNumber":572,"oldContent":"            child: const Text('Yes'),"},{"type":"DELETE","lineNumber":574,"oldContent":"          ),"},{"type":"DELETE","lineNumber":576,"oldContent":"        ],"},{"type":"DELETE","lineNumber":578,"oldContent":"      ),"},{"type":"DELETE","lineNumber":580,"oldContent":"    );"},{"type":"DELETE","lineNumber":582,"oldContent":"    "},{"type":"DELETE","lineNumber":584,"oldContent":"              ),"},{"type":"DELETE","lineNumber":586,"oldContent":"            );"},{"type":"DELETE","lineNumber":588,"oldContent":"          }"},{"type":"DELETE","lineNumber":590,"oldContent":"        } catch (e) {"},{"type":"DELETE","lineNumber":592,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":594,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":596,"oldContent":"              SnackBar("},{"type":"DELETE","lineNumber":598,"oldContent":"                content: Text('An error occurred: ${e.toString()}'),"},{"type":"DELETE","lineNumber":600,"oldContent":"                backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":602,"oldContent":"                behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":606,"oldContent":"              ),"},{"type":"DELETE","lineNumber":608,"oldContent":"            );"},{"type":"DELETE","lineNumber":610,"oldContent":"          }"},{"type":"DELETE","lineNumber":612,"oldContent":"        } finally {"},{"type":"DELETE","lineNumber":614,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":616,"oldContent":"            setState(() {});"},{"type":"DELETE","lineNumber":618,"oldContent":"          }"},{"type":"DELETE","lineNumber":620,"oldContent":"        }"},{"type":"DELETE","lineNumber":623,"oldContent":"      }"},{"type":"DELETE","lineNumber":625,"oldContent":"      Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":627,"oldContent":"        if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":629,"oldContent":"        "},{"type":"DELETE","lineNumber":631,"oldContent":"        setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":634,"oldContent":""},{"type":"DELETE","lineNumber":637,"oldContent":"        try {"},{"type":"DELETE","lineNumber":639,"oldContent":"          final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":641,"oldContent":"          "},{"type":"DELETE","lineNumber":643,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":645,"oldContent":"            if (success) {"},{"type":"DELETE","lineNumber":648,"oldContent":"              // Clear all OTP fields"},{"type":"DELETE","lineNumber":651,"oldContent":"              for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":653,"oldContent":"                controller.clear();"},{"type":"DELETE","lineNumber":655,"oldContent":"              }"},{"type":"DELETE","lineNumber":657,"oldContent":"              // Focus the first OTP field"},{"type":"DELETE","lineNumber":659,"oldContent":"              if (_focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":661,"oldContent":"                _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":663,"oldContent":"              }"},{"type":"DELETE","lineNumber":665,"oldContent":"              "},{"type":"DELETE","lineNumber":667,"oldContent":"              // Show success message"},{"type":"DELETE","lineNumber":669,"oldContent":"              ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":671,"oldContent":"                const SnackBar("},{"type":"DELETE","lineNumber":673,"oldContent":"                  content: Text('A new OTP has been sent to your phone number.'),"},{"type":"DELETE","lineNumber":675,"oldContent":"                  backgroundColor: Colors.green,"},{"type":"DELETE","lineNumber":677,"oldContent":"                  behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":679,"oldContent":"                ),"},{"type":"DELETE","lineNumber":681,"oldContent":"              );"},{"type":"DELETE","lineNumber":683,"oldContent":"              "},{"type":"DELETE","lineNumber":685,"oldContent":"              // Reset the resend timer"},{"type":"DELETE","lineNumber":687,"oldContent":"              setState(() {"},{"type":"DELETE","lineNumber":689,"oldContent":"                _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":691,"oldContent":"                _startResendTimer();"},{"type":"DELETE","lineNumber":693,"oldContent":"              });"},{"type":"DELETE","lineNumber":695,"oldContent":"            } else {"},{"type":"DELETE","lineNumber":697,"oldContent":"              // Show error message from view model"},{"type":"DELETE","lineNumber":699,"oldContent":"              if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"DELETE","lineNumber":701,"oldContent":"                ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":703,"oldContent":"                  SnackBar("},{"type":"DELETE","lineNumber":705,"oldContent":"                    content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":707,"oldContent":"                    backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":709,"oldContent":"                    behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":711,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":713,"oldContent":"                );"},{"type":"DELETE","lineNumber":715,"oldContent":"              }"},{"type":"DELETE","lineNumber":717,"oldContent":"            }"},{"type":"DELETE","lineNumber":720,"oldContent":"          }"},{"type":"DELETE","lineNumber":722,"oldContent":"        } catch (e) {"},{"type":"DELETE","lineNumber":724,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":726,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":728,"oldContent":"              SnackBar("},{"type":"DELETE","lineNumber":730,"oldContent":"                content: Text('Failed to resend OTP: ${e.toString()}'),"},{"type":"DELETE","lineNumber":732,"oldContent":"                backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":734,"oldContent":"                behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":736,"oldContent":"              ),"},{"type":"DELETE","lineNumber":738,"oldContent":"          }"},{"type":"DELETE","lineNumber":740,"oldContent":"        } finally {"},{"type":"DELETE","lineNumber":742,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":745,"oldContent":"            setState(() => _isResendLoading = false);"},{"type":"DELETE","lineNumber":748,"oldContent":"          }"},{"type":"DELETE","lineNumber":750,"oldContent":"        }"},{"type":"DELETE","lineNumber":752,"oldContent":"      }"},{"type":"DELETE","lineNumber":754,"oldContent":""},{"type":"DELETE","lineNumber":756,"oldContent":"      void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":758,"oldContent":"        if (value.length == 1 && index < 5) {"},{"type":"DELETE","lineNumber":760,"oldContent":"          _focusNodes[index + 1].requestFocus();"},{"type":"DELETE","lineNumber":762,"oldContent":"        } else if (value.isEmpty && index > 0) {"},{"type":"DELETE","lineNumber":764,"oldContent":"          _focusNodes[index - 1].requestFocus();"},{"type":"DELETE","lineNumber":766,"oldContent":"        }"},{"type":"DELETE","lineNumber":768,"oldContent":"      }"},{"type":"DELETE","lineNumber":770,"oldContent":""},{"type":"DELETE","lineNumber":772,"oldContent":"      Future<bool> _onWillPop() async {"},{"type":"DELETE","lineNumber":774,"oldContent":"        // Prevent back navigation if OTP verification is in progress"},{"type":"DELETE","lineNumber":776,"oldContent":"        if (_viewModel.isLoading) return false;"},{"type":"DELETE","lineNumber":778,"oldContent":"        "},{"type":"DELETE","lineNumber":780,"oldContent":"        // Show confirmation dialog when trying to go back"},{"type":"DELETE","lineNumber":782,"oldContent":"        final shouldPop = await showDialog<bool>("},{"type":"DELETE","lineNumber":784,"oldContent":"          context: context,"},{"type":"DELETE","lineNumber":786,"oldContent":"          builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":788,"oldContent":"            title: const Text('Cancel Verification?'),"},{"type":"DELETE","lineNumber":790,"oldContent":"            content: const Text('Are you sure you want to cancel the verification process?'),"},{"type":"DELETE","lineNumber":792,"oldContent":"            actions: ["},{"type":"DELETE","lineNumber":794,"oldContent":"              TextButton("},{"type":"DELETE","lineNumber":796,"oldContent":"                onPressed: () => Navigator.of(context).pop(false),"},{"type":"DELETE","lineNumber":798,"oldContent":"                child: const Text('No'),"},{"type":"DELETE","lineNumber":800,"oldContent":"              ),"},{"type":"DELETE","lineNumber":802,"oldContent":"              TextButton("},{"type":"DELETE","lineNumber":804,"oldContent":"                onPressed: () {"},{"type":"DELETE","lineNumber":806,"oldContent":"                  // Clear any existing verification state"},{"type":"DELETE","lineNumber":808,"oldContent":"                  _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":811,"oldContent":"                  Navigator.of(context).pop(true);"},{"type":"DELETE","lineNumber":813,"oldContent":"                },"},{"type":"DELETE","lineNumber":815,"oldContent":"                child: const Text('Yes'),"},{"type":"DELETE","lineNumber":817,"oldContent":"              ),"},{"type":"DELETE","lineNumber":819,"oldContent":"            ],"},{"type":"DELETE","lineNumber":821,"oldContent":"          ),"},{"type":"DELETE","lineNumber":823,"oldContent":"        );"},{"type":"DELETE","lineNumber":825,"oldContent":"        "},{"type":"DELETE","lineNumber":827,"oldContent":"        return shouldPop ?? false;"},{"type":"DELETE","lineNumber":829,"oldContent":"      }"},{"type":"DELETE","lineNumber":831,"oldContent":""},{"type":"DELETE","lineNumber":833,"oldContent":"      @override"},{"type":"DELETE","lineNumber":835,"oldContent":"      Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":837,"oldContent":"        final theme = Theme.of(context);"},{"type":"DELETE","lineNumber":839,"oldContent":"        final colorScheme = theme.colorScheme;"},{"type":"DELETE","lineNumber":841,"oldContent":"        "},{"type":"DELETE","lineNumber":843,"oldContent":"        return BaseView<AuthViewModel>("},{"type":"DELETE","lineNumber":845,"oldContent":"          onModelReady: (model) {},"},{"type":"DELETE","lineNumber":847,"oldContent":"          builder: (context, viewModel, child) {"},{"type":"DELETE","lineNumber":849,"oldContent":"            return Scaffold("},{"type":"DELETE","lineNumber":851,"oldContent":"              appBar: AppBar("},{"type":"DELETE","lineNumber":853,"oldContent":"                title: const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":855,"oldContent":"                elevation: 0,"},{"type":"DELETE","lineNumber":857,"oldContent":"                backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":859,"oldContent":"                foregroundColor: theme.brightness == Brightness.dark "},{"type":"DELETE","lineNumber":861,"oldContent":"                    ? Colors.white "},{"type":"DELETE","lineNumber":863,"oldContent":"                    : Colors.black,"},{"type":"DELETE","lineNumber":865,"oldContent":"                centerTitle: true,"},{"type":"DELETE","lineNumber":867,"oldContent":"              ),"},{"type":"DELETE","lineNumber":869,"oldContent":"              body: SafeArea("},{"type":"DELETE","lineNumber":871,"oldContent":"                child: SingleChildScrollView("},{"type":"DELETE","lineNumber":873,"oldContent":"                  padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":876,"oldContent":"                  child: Column("},{"type":"DELETE","lineNumber":879,"oldContent":"                    crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":882,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":885,"oldContent":"                      const Text("},{"type":"DELETE","lineNumber":888,"oldContent":"                        'Verify OTP',"},{"type":"DELETE","lineNumber":891,"oldContent":"                        style: TextStyle("},{"type":"DELETE","lineNumber":894,"oldContent":"                          fontSize: 28,"},{"type":"DELETE","lineNumber":897,"oldContent":"                          fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":900,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":903,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":906,"oldContent":"                      const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":908,"oldContent":"                      Text("},{"type":"DELETE","lineNumber":910,"oldContent":"                        'Enter the 6-digit code sent to',"},{"type":"DELETE","lineNumber":912,"oldContent":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"DELETE","lineNumber":914,"oldContent":"                          color: Colors.grey[600],"},{"type":"DELETE","lineNumber":916,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":918,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":920,"oldContent":"                      const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":922,"oldContent":"                      Text("},{"type":"DELETE","lineNumber":924,"oldContent":"                        widget.phoneNumber,"},{"type":"DELETE","lineNumber":926,"oldContent":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"DELETE","lineNumber":928,"oldContent":"                          fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":930,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":932,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":934,"oldContent":"                      Center("},{"type":"DELETE","lineNumber":936,"oldContent":"                        child: Column("},{"type":"DELETE","lineNumber":938,"oldContent":"                          children: ["},{"type":"DELETE","lineNumber":940,"oldContent":"                            const Icon("},{"type":"DELETE","lineNumber":942,"oldContent":"                              Icons.info_outline,"},{"type":"DELETE","lineNumber":944,"oldContent":"                              size: 20,"},{"type":"DELETE","lineNumber":946,"oldContent":"                              color: Colors.grey,"},{"type":"DELETE","lineNumber":948,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":950,"oldContent":"                            Text("},{"type":"DELETE","lineNumber":952,"oldContent":"                              'Having trouble receiving the code?',"},{"type":"DELETE","lineNumber":954,"oldContent":"                              style: theme.textTheme.bodyMedium?.copyWith("},{"type":"DELETE","lineNumber":956,"oldContent":"                                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":958,"oldContent":"                                fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":960,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":962,"oldContent":"                            const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":964,"oldContent":"                            Text("},{"type":"DELETE","lineNumber":966,"oldContent":"                              'Check your spam folder or request a new code',"},{"type":"DELETE","lineNumber":968,"oldContent":"                              textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":970,"oldContent":"                              style: theme.textTheme.bodySmall?.copyWith("},{"type":"DELETE","lineNumber":972,"oldContent":"                                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":974,"oldContent":"                          ],"},{"type":"DELETE","lineNumber":976,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":978,"oldContent":"                      const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":980,"oldContent":"                      Row("},{"type":"DELETE","lineNumber":982,"oldContent":"                        mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":984,"oldContent":"                        children: List.generate("},{"type":"DELETE","lineNumber":987,"oldContent":"                          6,"},{"type":"DELETE","lineNumber":989,"oldContent":"                          (index) => SizedBox("},{"type":"DELETE","lineNumber":991,"oldContent":"                            width: 48,"},{"type":"DELETE","lineNumber":993,"oldContent":"                            height: 56,"},{"type":"DELETE","lineNumber":995,"oldContent":"                            child: TextFormField("},{"type":"DELETE","lineNumber":997,"oldContent":"                              controller: _otpControllers[index],"},{"type":"DELETE","lineNumber":999,"oldContent":"                              focusNode: _focusNodes[index],"},{"type":"DELETE","lineNumber":1001,"oldContent":"                              keyboardType: TextInputType.number,"},{"type":"DELETE","lineNumber":1003,"oldContent":"                              textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":1005,"oldContent":"                              maxLength: 1,"},{"type":"DELETE","lineNumber":1007,"oldContent":"                              style: theme.textTheme.headlineSmall?.copyWith("},{"type":"DELETE","lineNumber":1009,"oldContent":"                                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":1024,"content":"        if (success) {"},{"type":"INSERT","lineNumber":1025,"content":"          // Clear all OTP fields"},{"type":"INSERT","lineNumber":1026,"content":"          for (var controller in _otpControllers) {"},{"type":"INSERT","lineNumber":1027,"content":"            controller.clear();"},{"type":"INSERT","lineNumber":1028,"content":"          }"},{"type":"INSERT","lineNumber":1029,"content":"          // Focus the first OTP field"},{"type":"INSERT","lineNumber":1030,"content":"          if (_focusNodes[0].canRequestFocus) {"},{"type":"INSERT","lineNumber":1031,"content":"            _focusNodes[0].requestFocus();"},{"type":"INSERT","lineNumber":1032,"content":"          }"},{"type":"INSERT","lineNumber":1033,"content":"          "},{"type":"INSERT","lineNumber":1034,"content":"          // Show success message"},{"type":"INSERT","lineNumber":1035,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":1036,"content":"            const SnackBar("},{"type":"INSERT","lineNumber":1037,"content":"              content: Text('A new OTP has been sent to your phone number.'),"},{"type":"INSERT","lineNumber":1038,"content":"              backgroundColor: Colors.green,"},{"type":"INSERT","lineNumber":1039,"content":"              behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":1040,"content":"            ),"},{"type":"INSERT","lineNumber":1041,"content":"          );"},{"type":"INSERT","lineNumber":1042,"content":"          "},{"type":"INSERT","lineNumber":1043,"content":"          // Reset the resend timer"},{"type":"INSERT","lineNumber":1044,"content":"          setState(() {"},{"type":"INSERT","lineNumber":1045,"content":"            _resendCodeIn = 30;"},{"type":"INSERT","lineNumber":1046,"content":"            _startResendTimer();"},{"type":"INSERT","lineNumber":1047,"content":"          });"},{"type":"INSERT","lineNumber":1048,"content":"        } else {"},{"type":"INSERT","lineNumber":1049,"content":"          // Show error message from view model"},{"type":"INSERT","lineNumber":1050,"content":"          if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"INSERT","lineNumber":1051,"content":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":1052,"content":"              SnackBar("},{"type":"INSERT","lineNumber":1053,"content":"                content: Text(_viewModel.errorMessage!),"},{"type":"INSERT","lineNumber":1054,"content":"                backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":1055,"content":"                behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":1056,"content":"              ),"},{"type":"INSERT","lineNumber":1057,"content":"            );"},{"type":"INSERT","lineNumber":1058,"content":"          }"},{"type":"INSERT","lineNumber":1059,"content":"        }"},{"type":"INSERT","lineNumber":1060,"content":"      }"},{"type":"INSERT","lineNumber":1061,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":1062,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":1063,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":1064,"content":"          SnackBar("},{"type":"INSERT","lineNumber":1065,"content":"            content: Text('Failed to resend OTP: ${e.toString()}'),"},{"type":"INSERT","lineNumber":1066,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":1067,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":1068,"content":"          ),"},{"type":"INSERT","lineNumber":1069,"content":"        );"},{"type":"INSERT","lineNumber":1070,"content":"      }"},{"type":"INSERT","lineNumber":1071,"content":"    } finally {"},{"type":"INSERT","lineNumber":1072,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":1073,"content":"        setState(() => _isResendLoading = false);"},{"type":"INSERT","lineNumber":1074,"content":"      }"},{"type":"INSERT","lineNumber":1075,"content":"    }"},{"type":"INSERT","lineNumber":1076,"content":"  }"},{"type":"INSERT","lineNumber":1077,"content":""},{"type":"INSERT","lineNumber":1078,"content":"  void _onOtpChanged(String value, int index) {"},{"type":"INSERT","lineNumber":1079,"content":"    if (value.length == 1 && index < 5) {"},{"type":"INSERT","lineNumber":1080,"content":"      _focusNodes[index + 1].requestFocus();"},{"type":"INSERT","lineNumber":1081,"content":"    } else if (value.isEmpty && index > 0) {"},{"type":"INSERT","lineNumber":1082,"content":"      _focusNodes[index - 1].requestFocus();"},{"type":"INSERT","lineNumber":1083,"content":"    }"},{"type":"INSERT","lineNumber":1084,"content":"  }"},{"type":"INSERT","lineNumber":1085,"content":""},{"type":"INSERT","lineNumber":1086,"content":"  Future<bool> _onWillPop() async {"},{"type":"INSERT","lineNumber":1087,"content":"    // Prevent back navigation if OTP verification is in progress"},{"type":"INSERT","lineNumber":1088,"content":"    if (_viewModel.isLoading) return false;"},{"type":"INSERT","lineNumber":1089,"content":"    "},{"type":"INSERT","lineNumber":1090,"content":"    // Show confirmation dialog when trying to go back"},{"type":"INSERT","lineNumber":1091,"content":"    final shouldPop = await showDialog<bool>("},{"type":"INSERT","lineNumber":1092,"content":"      context: context,"},{"type":"INSERT","lineNumber":1093,"content":"      builder: (context) => AlertDialog("},{"type":"INSERT","lineNumber":1094,"content":"        title: const Text('Cancel Verification?'),"},{"type":"INSERT","lineNumber":1095,"content":"        content: const Text('Are you sure you want to cancel the verification process?'),"},{"type":"INSERT","lineNumber":1096,"content":"        actions: ["},{"type":"INSERT","lineNumber":1097,"content":"          TextButton("},{"type":"INSERT","lineNumber":1098,"content":"            onPressed: () => Navigator.of(context).pop(false),"},{"type":"INSERT","lineNumber":1099,"content":"            child: const Text('No'),"},{"type":"INSERT","lineNumber":1100,"content":"          ),"},{"type":"INSERT","lineNumber":1101,"content":"          TextButton("},{"type":"INSERT","lineNumber":1102,"content":"            onPressed: () {"},{"type":"INSERT","lineNumber":1103,"content":"              // Clear any existing verification state"},{"type":"INSERT","lineNumber":1104,"content":"              _viewModel.setErrorSilently();"},{"type":"INSERT","lineNumber":1105,"content":"              Navigator.of(context).pop(true);"},{"type":"INSERT","lineNumber":1106,"content":"            },"},{"type":"INSERT","lineNumber":1107,"content":"            child: const Text('Yes'),"},{"type":"INSERT","lineNumber":1108,"content":"          ),"},{"type":"INSERT","lineNumber":1109,"content":"        ],"},{"type":"INSERT","lineNumber":1110,"content":"      ),"},{"type":"INSERT","lineNumber":1111,"content":"    );"},{"type":"INSERT","lineNumber":1112,"content":"    "},{"type":"INSERT","lineNumber":1113,"content":"              ),"},{"type":"INSERT","lineNumber":1114,"content":"            );"},{"type":"INSERT","lineNumber":1115,"content":"          }"},{"type":"INSERT","lineNumber":1116,"content":"        } catch (e) {"},{"type":"INSERT","lineNumber":1117,"content":"          if (mounted) {"},{"type":"INSERT","lineNumber":1118,"content":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":1119,"content":"              SnackBar("},{"type":"INSERT","lineNumber":1120,"content":"                content: Text('An error occurred: ${e.toString()}'),"},{"type":"INSERT","lineNumber":1121,"content":"                backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":1122,"content":"                behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":1123,"content":"              ),"},{"type":"INSERT","lineNumber":1124,"content":"            );"},{"type":"INSERT","lineNumber":1125,"content":"          }"},{"type":"INSERT","lineNumber":1126,"content":"        } finally {"},{"type":"INSERT","lineNumber":1127,"content":"          if (mounted) {"},{"type":"INSERT","lineNumber":1128,"content":"            setState(() {});"},{"type":"INSERT","lineNumber":1129,"content":"          }"},{"type":"INSERT","lineNumber":1130,"content":"        }"},{"type":"INSERT","lineNumber":1131,"content":"      }"},{"type":"INSERT","lineNumber":1132,"content":""},{"type":"INSERT","lineNumber":1133,"content":"      Future<void> _resendOtp() async {"},{"type":"INSERT","lineNumber":1134,"content":"        if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"INSERT","lineNumber":1135,"content":"        "},{"type":"INSERT","lineNumber":1136,"content":"        setState(() => _isResendLoading = true);"},{"type":"INSERT","lineNumber":1137,"content":""},{"type":"INSERT","lineNumber":1138,"content":"        try {"},{"type":"INSERT","lineNumber":1139,"content":"          final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"INSERT","lineNumber":1140,"content":"          "},{"type":"INSERT","lineNumber":1141,"content":"          if (mounted) {"},{"type":"INSERT","lineNumber":1142,"content":"            if (success) {"},{"type":"INSERT","lineNumber":1143,"content":"              // Clear all OTP fields"},{"type":"INSERT","lineNumber":1144,"content":"              for (var controller in _otpControllers) {"},{"type":"INSERT","lineNumber":1145,"content":"                controller.clear();"},{"type":"INSERT","lineNumber":1146,"content":"              }"},{"type":"INSERT","lineNumber":1147,"content":"              // Focus the first OTP field"},{"type":"INSERT","lineNumber":1148,"content":"              if (_focusNodes[0].canRequestFocus) {"},{"type":"INSERT","lineNumber":1149,"content":"                _focusNodes[0].requestFocus();"},{"type":"INSERT","lineNumber":1150,"content":"              }"},{"type":"INSERT","lineNumber":1151,"content":"              "},{"type":"INSERT","lineNumber":1152,"content":"              // Show success message"},{"type":"INSERT","lineNumber":1153,"content":"              ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":1154,"content":"                const SnackBar("},{"type":"INSERT","lineNumber":1155,"content":"                  content: Text('A new OTP has been sent to your phone number.'),"},{"type":"INSERT","lineNumber":1156,"content":"                  backgroundColor: Colors.green,"},{"type":"INSERT","lineNumber":1157,"content":"                  behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":1158,"content":"                ),"},{"type":"INSERT","lineNumber":1159,"content":"              );"},{"type":"INSERT","lineNumber":1160,"content":"              "},{"type":"INSERT","lineNumber":1161,"content":"              // Reset the resend timer"},{"type":"INSERT","lineNumber":1162,"content":"              setState(() {"},{"type":"INSERT","lineNumber":1163,"content":"                _resendCodeIn = 30;"},{"type":"INSERT","lineNumber":1164,"content":"                _startResendTimer();"},{"type":"INSERT","lineNumber":1165,"content":"              });"},{"type":"INSERT","lineNumber":1166,"content":"            } else {"},{"type":"INSERT","lineNumber":1167,"content":"              // Show error message from view model"},{"type":"INSERT","lineNumber":1168,"content":"              if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"INSERT","lineNumber":1169,"content":"                ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":1170,"content":"                  SnackBar("},{"type":"INSERT","lineNumber":1171,"content":"                    content: Text(_viewModel.errorMessage!),"},{"type":"INSERT","lineNumber":1172,"content":"                    backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":1173,"content":"                    behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":1174,"content":"                  ),"},{"type":"INSERT","lineNumber":1175,"content":"                );"},{"type":"INSERT","lineNumber":1176,"content":"              }"},{"type":"INSERT","lineNumber":1177,"content":"            }"},{"type":"INSERT","lineNumber":1178,"content":"          }"},{"type":"INSERT","lineNumber":1179,"content":"        } catch (e) {"},{"type":"INSERT","lineNumber":1180,"content":"          if (mounted) {"},{"type":"INSERT","lineNumber":1181,"content":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":1182,"content":"              SnackBar("},{"type":"INSERT","lineNumber":1183,"content":"                content: Text('Failed to resend OTP: ${e.toString()}'),"},{"type":"INSERT","lineNumber":1184,"content":"                backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":1185,"content":"                behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":1186,"content":"              ),"},{"type":"INSERT","lineNumber":1187,"content":"            );"},{"type":"INSERT","lineNumber":1188,"content":"          }"},{"type":"INSERT","lineNumber":1189,"content":"        } finally {"},{"type":"INSERT","lineNumber":1190,"content":"          if (mounted) {"},{"type":"INSERT","lineNumber":1191,"content":"            setState(() => _isResendLoading = false);"},{"type":"INSERT","lineNumber":1192,"content":"          }"},{"type":"INSERT","lineNumber":1193,"content":"        }"},{"type":"INSERT","lineNumber":1194,"content":"      }"},{"type":"INSERT","lineNumber":1195,"content":""},{"type":"INSERT","lineNumber":1196,"content":"      void _onOtpChanged(String value, int index) {"},{"type":"INSERT","lineNumber":1197,"content":"        if (value.length == 1 && index < 5) {"},{"type":"INSERT","lineNumber":1198,"content":"          _focusNodes[index + 1].requestFocus();"},{"type":"INSERT","lineNumber":1199,"content":"        } else if (value.isEmpty && index > 0) {"},{"type":"INSERT","lineNumber":1200,"content":"          _focusNodes[index - 1].requestFocus();"},{"type":"INSERT","lineNumber":1201,"content":"        }"},{"type":"INSERT","lineNumber":1202,"content":"      }"},{"type":"INSERT","lineNumber":1203,"content":""},{"type":"INSERT","lineNumber":1204,"content":"      Future<bool> _onWillPop() async {"},{"type":"INSERT","lineNumber":1205,"content":"        // Prevent back navigation if OTP verification is in progress"},{"type":"INSERT","lineNumber":1206,"content":"        if (_viewModel.isLoading) return false;"},{"type":"INSERT","lineNumber":1207,"content":"        "},{"type":"INSERT","lineNumber":1208,"content":"        // Show confirmation dialog when trying to go back"},{"type":"INSERT","lineNumber":1209,"content":"        final shouldPop = await showDialog<bool>("},{"type":"INSERT","lineNumber":1210,"content":"          context: context,"},{"type":"INSERT","lineNumber":1211,"content":"          builder: (context) => AlertDialog("},{"type":"INSERT","lineNumber":1212,"content":"            title: const Text('Cancel Verification?'),"},{"type":"INSERT","lineNumber":1213,"content":"            content: const Text('Are you sure you want to cancel the verification process?'),"},{"type":"INSERT","lineNumber":1214,"content":"            actions: ["},{"type":"INSERT","lineNumber":1215,"content":"              TextButton("},{"type":"INSERT","lineNumber":1216,"content":"                onPressed: () => Navigator.of(context).pop(false),"},{"type":"INSERT","lineNumber":1217,"content":"                child: const Text('No'),"},{"type":"INSERT","lineNumber":1218,"content":"              ),"},{"type":"INSERT","lineNumber":1219,"content":"              TextButton("},{"type":"INSERT","lineNumber":1220,"content":"                onPressed: () {"},{"type":"INSERT","lineNumber":1221,"content":"                  // Clear any existing verification state"},{"type":"INSERT","lineNumber":1222,"content":"                  _viewModel.setErrorSilently();"},{"type":"INSERT","lineNumber":1223,"content":"                  Navigator.of(context).pop(true);"},{"type":"INSERT","lineNumber":1224,"content":"                },"},{"type":"INSERT","lineNumber":1225,"content":"                child: const Text('Yes'),"},{"type":"INSERT","lineNumber":1226,"content":"              ),"},{"type":"INSERT","lineNumber":1227,"content":"            ],"},{"type":"INSERT","lineNumber":1228,"content":"          ),"},{"type":"INSERT","lineNumber":1229,"content":"        );"},{"type":"INSERT","lineNumber":1230,"content":"        "},{"type":"INSERT","lineNumber":1231,"content":"        return shouldPop ?? false;"},{"type":"INSERT","lineNumber":1232,"content":"      }"},{"type":"INSERT","lineNumber":1233,"content":""},{"type":"INSERT","lineNumber":1234,"content":"      @override"},{"type":"INSERT","lineNumber":1235,"content":"      Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":1236,"content":"        final theme = Theme.of(context);"},{"type":"INSERT","lineNumber":1237,"content":"        final colorScheme = theme.colorScheme;"},{"type":"INSERT","lineNumber":1238,"content":"        "},{"type":"INSERT","lineNumber":1239,"content":"        return BaseView<AuthViewModel>("},{"type":"INSERT","lineNumber":1240,"content":"          onModelReady: (model) {},"},{"type":"INSERT","lineNumber":1241,"content":"          builder: (context, viewModel, child) {"},{"type":"INSERT","lineNumber":1242,"content":"            return Scaffold("},{"type":"INSERT","lineNumber":1243,"content":"              appBar: AppBar("},{"type":"INSERT","lineNumber":1244,"content":"                title: const Text('Verify OTP'),"},{"type":"INSERT","lineNumber":1245,"content":"                elevation: 0,"},{"type":"INSERT","lineNumber":1246,"content":"                backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":1247,"content":"                foregroundColor: theme.brightness == Brightness.dark "},{"type":"INSERT","lineNumber":1248,"content":"                    ? Colors.white "},{"type":"INSERT","lineNumber":1249,"content":"                    : Colors.black,"},{"type":"INSERT","lineNumber":1250,"content":"                centerTitle: true,"},{"type":"INSERT","lineNumber":1251,"content":"              ),"},{"type":"INSERT","lineNumber":1252,"content":"              body: SafeArea("},{"type":"INSERT","lineNumber":1253,"content":"                child: SingleChildScrollView("},{"type":"INSERT","lineNumber":1254,"content":"                  padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":1255,"content":"                  child: Column("},{"type":"INSERT","lineNumber":1256,"content":"                    crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":1257,"content":"                    children: ["},{"type":"INSERT","lineNumber":1258,"content":"                      const Text("},{"type":"INSERT","lineNumber":1259,"content":"                        'Verify OTP',"},{"type":"INSERT","lineNumber":1260,"content":"                        style: TextStyle("},{"type":"INSERT","lineNumber":1261,"content":"                          fontSize: 28,"},{"type":"INSERT","lineNumber":1262,"content":"                          fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":1263,"content":"                        ),"},{"type":"INSERT","lineNumber":1264,"content":"                      ),"},{"type":"INSERT","lineNumber":1265,"content":"                      const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":1266,"content":"                      Text("},{"type":"INSERT","lineNumber":1267,"content":"                        'Enter the 6-digit code sent to',"},{"type":"INSERT","lineNumber":1268,"content":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"INSERT","lineNumber":1269,"content":"                          color: Colors.grey[600],"},{"type":"INSERT","lineNumber":1270,"content":"                        ),"},{"type":"INSERT","lineNumber":1271,"content":"                      ),"},{"type":"INSERT","lineNumber":1272,"content":"                      const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":1273,"content":"                      Text("},{"type":"INSERT","lineNumber":1274,"content":"                        widget.phoneNumber,"},{"type":"INSERT","lineNumber":1275,"content":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"INSERT","lineNumber":1276,"content":"                          fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":1277,"content":"                        ),"},{"type":"INSERT","lineNumber":1278,"content":"                      ),"},{"type":"INSERT","lineNumber":1279,"content":"                      const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":1280,"content":"                      Center("},{"type":"INSERT","lineNumber":1281,"content":"                        child: Column("},{"type":"INSERT","lineNumber":1282,"content":"                          children: ["},{"type":"INSERT","lineNumber":1283,"content":"                            const Icon("},{"type":"INSERT","lineNumber":1284,"content":"                              Icons.info_outline,"},{"type":"INSERT","lineNumber":1285,"content":"                              size: 20,"},{"type":"INSERT","lineNumber":1286,"content":"                              color: Colors.grey,"},{"type":"INSERT","lineNumber":1287,"content":"                            ),"},{"type":"INSERT","lineNumber":1288,"content":"                            const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":1289,"content":"                            Text("},{"type":"INSERT","lineNumber":1290,"content":"                              'Having trouble receiving the code?',"},{"type":"INSERT","lineNumber":1291,"content":"                              style: theme.textTheme.bodyMedium?.copyWith("},{"type":"INSERT","lineNumber":1292,"content":"                                color: Colors.grey[600],"},{"type":"INSERT","lineNumber":1293,"content":"                                fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":1295,"content":"                            ),"},{"type":"INSERT","lineNumber":1296,"content":"                            const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":1297,"content":"                            Text("},{"type":"INSERT","lineNumber":1298,"content":"                              'Check your spam folder or request a new code',"},{"type":"INSERT","lineNumber":1299,"content":"                              textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":1300,"content":"                              style: theme.textTheme.bodySmall?.copyWith("},{"type":"INSERT","lineNumber":1301,"content":"                                color: Colors.grey[600],"},{"type":"INSERT","lineNumber":1302,"content":"                              ),"},{"type":"INSERT","lineNumber":1303,"content":"                            ),"},{"type":"INSERT","lineNumber":1304,"content":"                          ],"},{"type":"INSERT","lineNumber":1305,"content":"                        ),"},{"type":"INSERT","lineNumber":1306,"content":"                      ),"},{"type":"INSERT","lineNumber":1307,"content":"                      const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":1308,"content":"                      Row("},{"type":"INSERT","lineNumber":1309,"content":"                        mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":1310,"content":"                        children: List.generate("},{"type":"INSERT","lineNumber":1311,"content":"                          6,"},{"type":"INSERT","lineNumber":1312,"content":"                          (index) => SizedBox("},{"type":"INSERT","lineNumber":1313,"content":"                            width: 48,"},{"type":"INSERT","lineNumber":1314,"content":"                            height: 56,"},{"type":"INSERT","lineNumber":1315,"content":"                            child: TextFormField("},{"type":"INSERT","lineNumber":1316,"content":"                              controller: _otpControllers[index],"},{"type":"INSERT","lineNumber":1317,"content":"                              focusNode: _focusNodes[index],"},{"type":"INSERT","lineNumber":1318,"content":"                              keyboardType: TextInputType.number,"},{"type":"INSERT","lineNumber":1319,"content":"                              textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":1320,"content":"                              maxLength: 1,"},{"type":"INSERT","lineNumber":1321,"content":"                              style: theme.textTheme.headlineSmall?.copyWith("},{"type":"INSERT","lineNumber":1322,"content":"                                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":1323,"content":"                              ),"},{"type":"DELETE","lineNumber":1037,"oldContent":"          // Show error message from view model"},{"type":"INSERT","lineNumber":1363,"content":"                            ),"},{"type":"INSERT","lineNumber":1365,"content":"                        ),"},{"type":"INSERT","lineNumber":1366,"content":"                      ),"},{"type":"INSERT","lineNumber":1367,"content":"                      const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":1368,"content":"                      SizedBox("},{"type":"INSERT","lineNumber":1369,"content":"                        width: double.infinity,"},{"type":"INSERT","lineNumber":1370,"content":"                        height: 56,"},{"type":"INSERT","lineNumber":1371,"content":"                        child: ElevatedButton("},{"type":"INSERT","lineNumber":1372,"content":"                          onPressed: viewModel.isLoading ? null : _verifyOtp,"},{"type":"INSERT","lineNumber":1373,"content":"                          style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":1374,"content":"                            backgroundColor: colorScheme.primary,"},{"type":"INSERT","lineNumber":1375,"content":"                            foregroundColor: colorScheme.onPrimary,"},{"type":"INSERT","lineNumber":1376,"content":"                            elevation: 0,"},{"type":"INSERT","lineNumber":1377,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":1378,"content":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":1380,"content":"                            padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":1382,"content":"                          child: viewModel.isLoading"},{"type":"INSERT","lineNumber":1385,"content":"                                  height: 24,"},{"type":"INSERT","lineNumber":1386,"content":"                                  child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":1387,"content":"                                    color: Colors.white,"},{"type":"INSERT","lineNumber":1388,"content":"                                    strokeWidth: 2,"},{"type":"INSERT","lineNumber":1389,"content":"                                  ),"},{"type":"INSERT","lineNumber":1390,"content":"                                )"},{"type":"INSERT","lineNumber":1391,"content":"                              : const Text("},{"type":"INSERT","lineNumber":1392,"content":"                                  'Verify',"},{"type":"INSERT","lineNumber":1393,"content":"                                  style: TextStyle("},{"type":"INSERT","lineNumber":1394,"content":"                                    fontSize: 16,"},{"type":"INSERT","lineNumber":1395,"content":"                                    fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":1396,"content":"                                  ),"},{"type":"INSERT","lineNumber":1397,"content":"                                ),"},{"type":"INSERT","lineNumber":1398,"content":"                        ),"},{"type":"INSERT","lineNumber":1400,"content":"                      const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":1401,"content":"                      Center("},{"type":"INSERT","lineNumber":1402,"content":"                        child: TextButton("},{"type":"INSERT","lineNumber":1403,"content":"                          onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"INSERT","lineNumber":1404,"content":"                          style: TextButton.styleFrom("},{"type":"INSERT","lineNumber":1405,"content":"                            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":1406,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":1407,"content":"                              borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":1408,"content":"                            ),"},{"type":"INSERT","lineNumber":1409,"content":"                          ),"},{"type":"INSERT","lineNumber":1410,"content":"                          child: _isResendLoading"},{"type":"INSERT","lineNumber":1411,"content":"                              ? const SizedBox("},{"type":"INSERT","lineNumber":1412,"content":"                                  width: 24,"},{"type":"DELETE","lineNumber":1070,"oldContent":"      _focusNodes[index - 1].requestFocus();"},{"type":"DELETE","lineNumber":1072,"oldContent":"    }"},{"type":"DELETE","lineNumber":1074,"oldContent":"  }"},{"type":"DELETE","lineNumber":1076,"oldContent":""},{"type":"DELETE","lineNumber":1078,"oldContent":"  Future<bool> _onWillPop() async {"},{"type":"DELETE","lineNumber":1080,"oldContent":"    // Prevent back navigation if OTP verification is in progress"},{"type":"DELETE","lineNumber":1082,"oldContent":"    if (_viewModel.isLoading) return false;"},{"type":"DELETE","lineNumber":1084,"oldContent":"    "},{"type":"DELETE","lineNumber":1086,"oldContent":"    // Show confirmation dialog when trying to go back"},{"type":"DELETE","lineNumber":1088,"oldContent":"    final shouldPop = await showDialog<bool>("},{"type":"DELETE","lineNumber":1090,"oldContent":"      context: context,"},{"type":"DELETE","lineNumber":1114,"oldContent":""},{"type":"DELETE","lineNumber":1115,"oldContent":"                                  width: 24,"},{"type":"DELETE","lineNumber":1116,"oldContent":"                              ? const SizedBox("},{"type":"DELETE","lineNumber":1117,"oldContent":"                          child: _isResendLoading"},{"type":"DELETE","lineNumber":1118,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":1119,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1120,"oldContent":"                              borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1121,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":1122,"oldContent":"                            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"DELETE","lineNumber":1123,"oldContent":"                          style: TextButton.styleFrom("},{"type":"DELETE","lineNumber":1124,"oldContent":"                          onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"DELETE","lineNumber":1125,"oldContent":"                        child: TextButton("},{"type":"DELETE","lineNumber":1126,"oldContent":"                      Center("},{"type":"DELETE","lineNumber":1127,"oldContent":"                      const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":1128,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1129,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1130,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1131,"oldContent":"                                    fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":1132,"oldContent":"                                    fontSize: 16,"},{"type":"DELETE","lineNumber":1133,"oldContent":"                                  style: TextStyle("},{"type":"DELETE","lineNumber":1134,"oldContent":"                                  'Verify',"},{"type":"DELETE","lineNumber":1135,"oldContent":"                              : const Text("},{"type":"DELETE","lineNumber":1136,"oldContent":"                                )"},{"type":"DELETE","lineNumber":1137,"oldContent":"            );"},{"type":"DELETE","lineNumber":1138,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1139,"oldContent":"                                    strokeWidth: 2,"},{"type":"DELETE","lineNumber":1140,"oldContent":"                                    color: Colors.white,"},{"type":"DELETE","lineNumber":1141,"oldContent":"                                  child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":1142,"oldContent":"                                  height: 24,"},{"type":"DELETE","lineNumber":1143,"oldContent":"                          child: viewModel.isLoading"},{"type":"DELETE","lineNumber":1144,"oldContent":"                            padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":1145,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":1146,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":1147,"oldContent":"                            elevation: 0,"},{"type":"DELETE","lineNumber":1148,"oldContent":"                            foregroundColor: colorScheme.onPrimary,"},{"type":"DELETE","lineNumber":1149,"oldContent":"                            backgroundColor: colorScheme.primary,"},{"type":"DELETE","lineNumber":1150,"oldContent":"                          style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":1151,"oldContent":"                          onPressed: viewModel.isLoading ? null : _verifyOtp,"},{"type":"DELETE","lineNumber":1152,"oldContent":"                        child: ElevatedButton("},{"type":"DELETE","lineNumber":1153,"oldContent":"                        height: 56,"},{"type":"DELETE","lineNumber":1154,"oldContent":"                        width: double.infinity,"},{"type":"DELETE","lineNumber":1155,"oldContent":"                      SizedBox("},{"type":"DELETE","lineNumber":1156,"oldContent":"                      const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":1157,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1158,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1159,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1160,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1161,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1162,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1163,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1164,"oldContent":"                            const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":1165,"oldContent":"                      const SizedBox(height: 40),"}]},{"timestamp":1754611144909,"changes":[{"type":"MODIFY","lineNumber":6,"content":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';","oldContent":"  final String verificationId;"},{"type":"MODIFY","lineNumber":9,"content":"  final String verificationId;","oldContent":"  final String phoneNumber;"},{"type":"INSERT","lineNumber":10,"content":"  final String phoneNumber;"},{"type":"DELETE","lineNumber":13,"oldContent":""},{"type":"INSERT","lineNumber":26,"content":"  late AuthViewModel _viewModel;"},{"type":"MODIFY","lineNumber":29,"content":"  late Timer _resendTimer;","oldContent":"  late AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":33,"oldContent":"  @override"},{"type":"MODIFY","lineNumber":34,"content":"    _viewModel = context.read<AuthViewModel>();","oldContent":"  @override"},{"type":"DELETE","lineNumber":42,"oldContent":"    });"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"INSERT","lineNumber":43,"content":"    });"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"INSERT","lineNumber":64,"content":"            content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":65,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":68,"oldContent":"    }"},{"type":"MODIFY","lineNumber":70,"content":"    }","oldContent":"  }"},{"type":"INSERT","lineNumber":71,"content":"  }"},{"type":"DELETE","lineNumber":74,"oldContent":"    }"},{"type":"DELETE","lineNumber":76,"oldContent":"    setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":78,"oldContent":"  }"},{"type":"DELETE","lineNumber":80,"oldContent":""},{"type":"DELETE","lineNumber":82,"oldContent":""},{"type":"DELETE","lineNumber":84,"oldContent":"  void _startResendTimer() {"},{"type":"DELETE","lineNumber":86,"oldContent":"    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"DELETE","lineNumber":89,"oldContent":"      if (_resendCodeIn > 0) {"},{"type":"DELETE","lineNumber":92,"oldContent":"        setState(() => _resendCodeIn--);"},{"type":"DELETE","lineNumber":94,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":97,"oldContent":"        _resendTimer.cancel();"},{"type":"INSERT","lineNumber":87,"content":"    }"},{"type":"DELETE","lineNumber":99,"oldContent":"      }"},{"type":"DELETE","lineNumber":101,"oldContent":"    });"},{"type":"DELETE","lineNumber":104,"oldContent":"  }"},{"type":"DELETE","lineNumber":107,"oldContent":""},{"type":"DELETE","lineNumber":109,"oldContent":"  Future<void> _handleOtpVerificationSuccess(User? user) async {"},{"type":"DELETE","lineNumber":112,"oldContent":"    if (user != null) {"},{"type":"DELETE","lineNumber":115,"oldContent":"      // Handle successful verification"},{"type":"DELETE","lineNumber":117,"oldContent":"      // You can navigate to the home screen or next screen here"},{"type":"DELETE","lineNumber":120,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":123,"oldContent":"        Navigator.of(context).pushReplacementNamed('/home');"},{"type":"DELETE","lineNumber":125,"oldContent":"      }"},{"type":"DELETE","lineNumber":128,"oldContent":"    }"},{"type":"DELETE","lineNumber":131,"oldContent":"  }"},{"type":"DELETE","lineNumber":133,"oldContent":""},{"type":"DELETE","lineNumber":136,"oldContent":"  Future<void> _verifyOtp() async {"},{"type":"DELETE","lineNumber":139,"oldContent":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"DELETE","lineNumber":141,"oldContent":"    if (otp.length != 6) {"},{"type":"DELETE","lineNumber":144,"oldContent":"      ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":147,"oldContent":"        const SnackBar("},{"type":"DELETE","lineNumber":149,"oldContent":"          content: Text('Please enter a valid 6-digit OTP'),"},{"type":"DELETE","lineNumber":152,"oldContent":"          behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":155,"oldContent":"        ),"},{"type":"DELETE","lineNumber":157,"oldContent":"      );"},{"type":"DELETE","lineNumber":160,"oldContent":"      return;"},{"type":"DELETE","lineNumber":163,"oldContent":"    }"},{"type":"DELETE","lineNumber":165,"oldContent":""},{"type":"DELETE","lineNumber":168,"oldContent":"    try {"},{"type":"DELETE","lineNumber":171,"oldContent":"      final credential = PhoneAuthProvider.credential("},{"type":"DELETE","lineNumber":173,"oldContent":"        verificationId: widget.verificationId,"},{"type":"DELETE","lineNumber":176,"oldContent":"        smsCode: otp,"},{"type":"DELETE","lineNumber":179,"oldContent":"      );"},{"type":"DELETE","lineNumber":181,"oldContent":"      "},{"type":"DELETE","lineNumber":184,"oldContent":"      final userCredential = await FirebaseAuth.instance.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":186,"oldContent":"      await _handleOtpVerificationSuccess(userCredential.user);"},{"type":"INSERT","lineNumber":143,"content":"    setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":188,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":191,"oldContent":"      String message = 'Verification failed. Please try again.';"},{"type":"DELETE","lineNumber":193,"oldContent":"      if (e.code == 'invalid-verification-code') {"},{"type":"DELETE","lineNumber":196,"oldContent":"        message = 'Invalid OTP. Please try again.';"},{"type":"DELETE","lineNumber":198,"oldContent":"      } else if (e.code == 'session-expired') {"},{"type":"DELETE","lineNumber":201,"oldContent":"        message = 'Session expired. Please request a new OTP.';"},{"type":"DELETE","lineNumber":203,"oldContent":"      }"},{"type":"DELETE","lineNumber":206,"oldContent":"      "},{"type":"DELETE","lineNumber":208,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":211,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":213,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":216,"oldContent":"            content: Text(message),"},{"type":"DELETE","lineNumber":218,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":221,"oldContent":"          ),"},{"type":"DELETE","lineNumber":223,"oldContent":"        );"},{"type":"DELETE","lineNumber":225,"oldContent":"      }"},{"type":"DELETE","lineNumber":228,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":231,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":234,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":237,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":239,"oldContent":"            content: Text('An error occurred. Please try again.'),"},{"type":"DELETE","lineNumber":242,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":244,"oldContent":"          ),"},{"type":"DELETE","lineNumber":247,"oldContent":"        );"},{"type":"DELETE","lineNumber":250,"oldContent":"      }"},{"type":"DELETE","lineNumber":253,"oldContent":"    }"},{"type":"DELETE","lineNumber":255,"oldContent":"  }"},{"type":"DELETE","lineNumber":258,"oldContent":""},{"type":"DELETE","lineNumber":260,"oldContent":"      }"},{"type":"DELETE","lineNumber":262,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":264,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":266,"oldContent":"        setState(() => _isResendLoading = false);"},{"type":"DELETE","lineNumber":268,"oldContent":"      }"},{"type":"DELETE","lineNumber":269,"oldContent":"    }"},{"type":"INSERT","lineNumber":193,"content":"  }"},{"type":"INSERT","lineNumber":194,"content":""},{"type":"DELETE","lineNumber":271,"oldContent":"  void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":273,"oldContent":"    if (value.length == 1 && index < _otpControllers.length - 1) {"},{"type":"DELETE","lineNumber":275,"oldContent":"      _focusNodes[index + 1].requestFocus();"},{"type":"DELETE","lineNumber":277,"oldContent":"    } else if (value.isEmpty && index > 0) {"},{"type":"DELETE","lineNumber":279,"oldContent":"      _focusNodes[index - 1].requestFocus();"},{"type":"DELETE","lineNumber":281,"oldContent":"    }"},{"type":"DELETE","lineNumber":283,"oldContent":"  }"},{"type":"DELETE","lineNumber":286,"oldContent":"  Future<bool> _onWillPop() async {"},{"type":"DELETE","lineNumber":288,"oldContent":"    if (_viewModel.isLoading) return false;"},{"type":"DELETE","lineNumber":290,"oldContent":"    "},{"type":"DELETE","lineNumber":292,"oldContent":"    final shouldPop = await showDialog<bool>("},{"type":"DELETE","lineNumber":294,"oldContent":"      context: context,"},{"type":"DELETE","lineNumber":296,"oldContent":"      builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":298,"oldContent":"        title: const Text('Are you sure?'),"},{"type":"DELETE","lineNumber":300,"oldContent":"        content: const Text('Do you want to cancel OTP verification?'),"},{"type":"DELETE","lineNumber":302,"oldContent":"        actions: ["},{"type":"DELETE","lineNumber":304,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":306,"oldContent":"            onPressed: () => Navigator.of(context).pop(false),"},{"type":"DELETE","lineNumber":308,"oldContent":"            child: const Text('No'),"},{"type":"DELETE","lineNumber":310,"oldContent":"          ),"},{"type":"DELETE","lineNumber":312,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":314,"oldContent":"            onPressed: () {"},{"type":"DELETE","lineNumber":316,"oldContent":"              _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":318,"oldContent":"              Navigator.of(context).pop(true);"},{"type":"DELETE","lineNumber":320,"oldContent":"            },"},{"type":"DELETE","lineNumber":323,"oldContent":"            child: const Text('Yes'),"},{"type":"DELETE","lineNumber":325,"oldContent":"          ),"},{"type":"DELETE","lineNumber":327,"oldContent":"        ],"},{"type":"DELETE","lineNumber":329,"oldContent":"      ),"},{"type":"DELETE","lineNumber":331,"oldContent":"    );"},{"type":"DELETE","lineNumber":333,"oldContent":"    "},{"type":"DELETE","lineNumber":335,"oldContent":"    return shouldPop ?? false;"},{"type":"DELETE","lineNumber":337,"oldContent":"  }"},{"type":"DELETE","lineNumber":339,"oldContent":""},{"type":"DELETE","lineNumber":341,"oldContent":"  @override"},{"type":"DELETE","lineNumber":343,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":345,"oldContent":"    return WillPopScope("},{"type":"DELETE","lineNumber":347,"oldContent":"      onWillPop: _onWillPop,"},{"type":"DELETE","lineNumber":349,"oldContent":"      child: Scaffold("},{"type":"DELETE","lineNumber":351,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":353,"oldContent":"          title: const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":355,"oldContent":"          leading: IconButton("},{"type":"DELETE","lineNumber":357,"oldContent":"            icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":359,"oldContent":"            onPressed: () => _onWillPop().then((value) {"},{"type":"DELETE","lineNumber":361,"oldContent":"              if (value) {"},{"type":"DELETE","lineNumber":363,"oldContent":"                Navigator.of(context).pop();"},{"type":"DELETE","lineNumber":365,"oldContent":"              }"},{"type":"DELETE","lineNumber":367,"oldContent":"            }),"},{"type":"DELETE","lineNumber":369,"oldContent":"          ),"},{"type":"DELETE","lineNumber":371,"oldContent":"        ),"},{"type":"DELETE","lineNumber":373,"oldContent":"        body: SingleChildScrollView("},{"type":"DELETE","lineNumber":375,"oldContent":"          padding: const EdgeInsets.all(16.0),"},{"type":"DELETE","lineNumber":377,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":379,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":381,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":383,"oldContent":"              const Text("},{"type":"DELETE","lineNumber":385,"oldContent":"                'Enter OTP',"},{"type":"DELETE","lineNumber":387,"oldContent":"                style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),"},{"type":"DELETE","lineNumber":389,"oldContent":"              ),"},{"type":"DELETE","lineNumber":391,"oldContent":"              const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":393,"oldContent":"              Text("},{"type":"DELETE","lineNumber":395,"oldContent":"                'We have sent an OTP to +91 ${widget.phoneNumber}',"},{"type":"DELETE","lineNumber":397,"oldContent":"                textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":399,"oldContent":"                style: const TextStyle(fontSize: 16, color: Colors.grey),"},{"type":"DELETE","lineNumber":401,"oldContent":"              ),"},{"type":"DELETE","lineNumber":403,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":405,"oldContent":"              Row("},{"type":"DELETE","lineNumber":407,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"DELETE","lineNumber":409,"oldContent":"                children: List.generate("},{"type":"DELETE","lineNumber":411,"oldContent":"                  6,"},{"type":"DELETE","lineNumber":413,"oldContent":"                  (index) => SizedBox("},{"type":"DELETE","lineNumber":415,"oldContent":"                    width: 50,"},{"type":"DELETE","lineNumber":417,"oldContent":"                    child: TextField("},{"type":"DELETE","lineNumber":419,"oldContent":"                      controller: _otpControllers[index],"},{"type":"DELETE","lineNumber":421,"oldContent":"                      focusNode: _focusNodes[index],"},{"type":"DELETE","lineNumber":423,"oldContent":"                      keyboardType: TextInputType.number,"},{"type":"DELETE","lineNumber":425,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":427,"oldContent":"                      maxLength: 1,"},{"type":"DELETE","lineNumber":429,"oldContent":"                      onChanged: (value) => _onOtpChanged(value, index),"},{"type":"DELETE","lineNumber":431,"oldContent":"                      decoration: const InputDecoration("},{"type":"DELETE","lineNumber":433,"oldContent":"                        counterText: '',"},{"type":"DELETE","lineNumber":435,"oldContent":"                        border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":437,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":439,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":442,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":444,"oldContent":""},{"type":"DELETE","lineNumber":446,"oldContent":"class _OtpVerificationScreenState extends State<OtpVerificationScreen> {"},{"type":"DELETE","lineNumber":449,"oldContent":"  final List<TextEditingController> _otpControllers ="},{"type":"DELETE","lineNumber":451,"oldContent":"      List.generate(6, (index) => TextEditingController());"},{"type":"DELETE","lineNumber":454,"oldContent":"  final List<FocusNode> _focusNodes = List.generate(6, (index) => FocusNode());"},{"type":"DELETE","lineNumber":456,"oldContent":"  late AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":459,"oldContent":"  bool _isResendLoading = false;"},{"type":"DELETE","lineNumber":461,"oldContent":"  int _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":464,"oldContent":"  late Timer _resendTimer;"},{"type":"DELETE","lineNumber":467,"oldContent":""},{"type":"DELETE","lineNumber":469,"oldContent":"  @override"},{"type":"DELETE","lineNumber":472,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":475,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":477,"oldContent":"    _viewModel = context.read<AuthViewModel>();"},{"type":"DELETE","lineNumber":480,"oldContent":"    _viewModel.addListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":482,"oldContent":"    _startResendTimer();"},{"type":"DELETE","lineNumber":485,"oldContent":"    "},{"type":"DELETE","lineNumber":487,"oldContent":"    // Auto-focus the first OTP field"},{"type":"DELETE","lineNumber":490,"oldContent":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"DELETE","lineNumber":492,"oldContent":"      if (mounted && _focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":495,"oldContent":"        _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":497,"oldContent":"      }"},{"type":"DELETE","lineNumber":500,"oldContent":"    });"},{"type":"DELETE","lineNumber":503,"oldContent":"  @override"},{"type":"DELETE","lineNumber":506,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":509,"oldContent":"    for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":511,"oldContent":"      controller.dispose();"},{"type":"DELETE","lineNumber":514,"oldContent":"    }"},{"type":"DELETE","lineNumber":516,"oldContent":"    for (var node in _focusNodes) {"},{"type":"DELETE","lineNumber":519,"oldContent":"      node.dispose();"},{"type":"DELETE","lineNumber":521,"oldContent":"    }"},{"type":"DELETE","lineNumber":524,"oldContent":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":526,"oldContent":"    _resendTimer.cancel();"},{"type":"DELETE","lineNumber":529,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":531,"oldContent":"  }"},{"type":"DELETE","lineNumber":534,"oldContent":""},{"type":"DELETE","lineNumber":537,"oldContent":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":539,"oldContent":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"DELETE","lineNumber":542,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":545,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":547,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":550,"oldContent":"            content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":552,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":555,"oldContent":"          ),"},{"type":"DELETE","lineNumber":557,"oldContent":"        );"},{"type":"DELETE","lineNumber":560,"oldContent":"        _viewModel.setError();"},{"type":"DELETE","lineNumber":562,"oldContent":"      }"},{"type":"DELETE","lineNumber":565,"oldContent":"    }"},{"type":"DELETE","lineNumber":567,"oldContent":"  }"},{"type":"DELETE","lineNumber":570,"oldContent":""},{"type":"DELETE","lineNumber":573,"oldContent":"  void _startResendTimer() {"},{"type":"DELETE","lineNumber":575,"oldContent":"    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"INSERT","lineNumber":365,"content":"  void _startResendTimer() {"},{"type":"INSERT","lineNumber":366,"content":"    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"INSERT","lineNumber":375,"content":"  Future<void> _handleOtpVerificationSuccess(User? user) async {"},{"type":"INSERT","lineNumber":376,"content":"    if (user != null) {"},{"type":"INSERT","lineNumber":377,"content":"      // Handle successful verification"},{"type":"INSERT","lineNumber":378,"content":"      // You can navigate to the home screen or next screen here"},{"type":"INSERT","lineNumber":379,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":380,"content":"        Navigator.of(context).pushReplacementNamed('/home');"},{"type":"INSERT","lineNumber":381,"content":"      }"},{"type":"INSERT","lineNumber":382,"content":"    }"},{"type":"INSERT","lineNumber":383,"content":"  }"},{"type":"INSERT","lineNumber":385,"content":"  Future<void> _verifyOtp() async {"},{"type":"INSERT","lineNumber":386,"content":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"INSERT","lineNumber":387,"content":"    if (otp.length != 6) {"},{"type":"INSERT","lineNumber":388,"content":"      ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":389,"content":"        const SnackBar("},{"type":"INSERT","lineNumber":390,"content":"          content: Text('Please enter a valid 6-digit OTP'),"},{"type":"INSERT","lineNumber":391,"content":"          behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":392,"content":"        ),"},{"type":"INSERT","lineNumber":393,"content":"      );"},{"type":"INSERT","lineNumber":394,"content":"      return;"},{"type":"INSERT","lineNumber":395,"content":"    }"},{"type":"INSERT","lineNumber":396,"content":""},{"type":"INSERT","lineNumber":397,"content":"    try {"},{"type":"INSERT","lineNumber":398,"content":"      final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":399,"content":"        verificationId: widget.verificationId,"},{"type":"INSERT","lineNumber":400,"content":"        smsCode: otp,"},{"type":"INSERT","lineNumber":401,"content":"      );"},{"type":"INSERT","lineNumber":402,"content":"      "},{"type":"INSERT","lineNumber":403,"content":"      final userCredential = await FirebaseAuth.instance.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":404,"content":"      await _handleOtpVerificationSuccess(userCredential.user);"},{"type":"INSERT","lineNumber":405,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":406,"content":"      String message = 'Verification failed. Please try again.';"},{"type":"INSERT","lineNumber":407,"content":"      if (e.code == 'invalid-verification-code') {"},{"type":"INSERT","lineNumber":408,"content":"        message = 'Invalid OTP. Please try again.';"},{"type":"INSERT","lineNumber":409,"content":"      } else if (e.code == 'session-expired') {"},{"type":"INSERT","lineNumber":410,"content":"        message = 'Session expired. Please request a new OTP.';"},{"type":"INSERT","lineNumber":411,"content":"      }"},{"type":"INSERT","lineNumber":412,"content":"      "},{"type":"INSERT","lineNumber":413,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":414,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":415,"content":"          SnackBar("},{"type":"INSERT","lineNumber":416,"content":"            content: Text(message),"},{"type":"INSERT","lineNumber":417,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":418,"content":"          ),"},{"type":"INSERT","lineNumber":419,"content":"        );"},{"type":"INSERT","lineNumber":420,"content":"      }"},{"type":"INSERT","lineNumber":421,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":422,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":423,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":424,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":425,"content":"            content: Text('An error occurred. Please try again.'),"},{"type":"INSERT","lineNumber":426,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":427,"content":"          ),"},{"type":"INSERT","lineNumber":428,"content":"        );"},{"type":"INSERT","lineNumber":429,"content":"      }"},{"type":"INSERT","lineNumber":430,"content":"    }"},{"type":"INSERT","lineNumber":431,"content":"  }"},{"type":"INSERT","lineNumber":432,"content":""},{"type":"INSERT","lineNumber":433,"content":"  Future<void> _resendOtp() async {"},{"type":"INSERT","lineNumber":434,"content":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"INSERT","lineNumber":435,"content":""},{"type":"INSERT","lineNumber":438,"content":"    try {"},{"type":"INSERT","lineNumber":439,"content":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"INSERT","lineNumber":440,"content":"      "},{"type":"INSERT","lineNumber":451,"content":""},{"type":"DELETE","lineNumber":612,"oldContent":"  Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":614,"oldContent":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":615,"oldContent":""},{"type":"DELETE","lineNumber":617,"oldContent":"    setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":619,"oldContent":""},{"type":"DELETE","lineNumber":620,"oldContent":"    try {"},{"type":"DELETE","lineNumber":622,"oldContent":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":624,"oldContent":"      "},{"type":"DELETE","lineNumber":625,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":627,"oldContent":"        // Clear OTP fields"},{"type":"DELETE","lineNumber":629,"oldContent":"        for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":630,"oldContent":"          controller.clear();"},{"type":"INSERT","lineNumber":473,"content":"      if (mounted) {"},{"type":"DELETE","lineNumber":632,"oldContent":"        }"},{"type":"DELETE","lineNumber":634,"oldContent":"        "},{"type":"DELETE","lineNumber":635,"oldContent":"        // Focus first field"},{"type":"DELETE","lineNumber":637,"oldContent":"        if (_focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":639,"oldContent":"          _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":640,"oldContent":"        }"},{"type":"DELETE","lineNumber":642,"oldContent":""},{"type":"DELETE","lineNumber":644,"oldContent":"        if (success) {"},{"type":"DELETE","lineNumber":645,"oldContent":"          // Reset timer"},{"type":"DELETE","lineNumber":647,"oldContent":"          setState(() => _resendCodeIn = 30);"},{"type":"DELETE","lineNumber":649,"oldContent":"          _startResendTimer();"},{"type":"DELETE","lineNumber":650,"oldContent":"          "},{"type":"DELETE","lineNumber":652,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":654,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":655,"oldContent":"              content: Text('OTP has been resent successfully'),"},{"type":"DELETE","lineNumber":657,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":659,"oldContent":"            ),"},{"type":"DELETE","lineNumber":660,"oldContent":"          );"},{"type":"DELETE","lineNumber":662,"oldContent":"        } else if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"DELETE","lineNumber":664,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":665,"oldContent":"            SnackBar("},{"type":"DELETE","lineNumber":667,"oldContent":"              content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":669,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":670,"oldContent":"            ),"},{"type":"DELETE","lineNumber":672,"oldContent":"          );"},{"type":"DELETE","lineNumber":674,"oldContent":"        }"},{"type":"DELETE","lineNumber":676,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":678,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":679,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":681,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":683,"oldContent":"            content: Text('Failed to resend OTP. Please try again.'),"},{"type":"DELETE","lineNumber":684,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":686,"oldContent":"          ),"},{"type":"DELETE","lineNumber":688,"oldContent":"        );"},{"type":"DELETE","lineNumber":690,"oldContent":"      }"},{"type":"DELETE","lineNumber":695,"oldContent":"  }"},{"type":"DELETE","lineNumber":697,"oldContent":""},{"type":"INSERT","lineNumber":523,"content":"  @override"},{"type":"INSERT","lineNumber":559,"content":"                  (index) => SizedBox("},{"type":"INSERT","lineNumber":560,"content":"                    width: 50,"},{"type":"INSERT","lineNumber":561,"content":"                    child: TextField("},{"type":"INSERT","lineNumber":562,"content":"                      controller: _otpControllers[index],"},{"type":"INSERT","lineNumber":563,"content":"                      focusNode: _focusNodes[index],"},{"type":"INSERT","lineNumber":564,"content":"                      keyboardType: TextInputType.number,"},{"type":"INSERT","lineNumber":565,"content":"                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":566,"content":"                      maxLength: 1,"},{"type":"INSERT","lineNumber":567,"content":"                      onChanged: (value) => _onOtpChanged(value, index),"},{"type":"INSERT","lineNumber":568,"content":"                      decoration: const InputDecoration("},{"type":"INSERT","lineNumber":569,"content":"                        counterText: '',"},{"type":"INSERT","lineNumber":570,"content":"                        border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":571,"content":"                      ),"},{"type":"INSERT","lineNumber":572,"content":"                    ),"},{"type":"INSERT","lineNumber":573,"content":"                  ),"},{"type":"DELETE","lineNumber":754,"oldContent":"                  (index) => SizedBox("},{"type":"DELETE","lineNumber":757,"oldContent":"                    width: 50,"},{"type":"DELETE","lineNumber":760,"oldContent":"                    child: TextField("},{"type":"DELETE","lineNumber":763,"oldContent":"                      controller: _otpControllers[index],"},{"type":"DELETE","lineNumber":766,"oldContent":"                      focusNode: _focusNodes[index],"},{"type":"DELETE","lineNumber":769,"oldContent":"                      keyboardType: TextInputType.number,"},{"type":"DELETE","lineNumber":772,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":775,"oldContent":"                      maxLength: 1,"},{"type":"DELETE","lineNumber":778,"oldContent":"                      onChanged: (value) => _onOtpChanged(value, index),"},{"type":"DELETE","lineNumber":781,"oldContent":"                      decoration: const InputDecoration("},{"type":"DELETE","lineNumber":784,"oldContent":"                        counterText: '',"},{"type":"DELETE","lineNumber":787,"oldContent":"                        border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":790,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":793,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":796,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":798,"oldContent":"                ),"},{"type":"INSERT","lineNumber":606,"content":""},{"type":"INSERT","lineNumber":607,"content":"class _OtpVerificationScreenState extends State<OtpVerificationScreen> {"},{"type":"INSERT","lineNumber":608,"content":"  final List<TextEditingController> _otpControllers ="},{"type":"INSERT","lineNumber":609,"content":"      List.generate(6, (index) => TextEditingController());"},{"type":"INSERT","lineNumber":610,"content":"  final List<FocusNode> _focusNodes = List.generate(6, (index) => FocusNode());"},{"type":"INSERT","lineNumber":611,"content":"  late AuthViewModel _viewModel;"},{"type":"INSERT","lineNumber":612,"content":"  bool _isResendLoading = false;"},{"type":"INSERT","lineNumber":613,"content":"  int _resendCodeIn = 30;"},{"type":"INSERT","lineNumber":614,"content":"  late Timer _resendTimer;"},{"type":"INSERT","lineNumber":615,"content":""},{"type":"INSERT","lineNumber":616,"content":"  @override"},{"type":"INSERT","lineNumber":617,"content":"  void initState() {"},{"type":"INSERT","lineNumber":618,"content":"    super.initState();"},{"type":"INSERT","lineNumber":619,"content":"    _viewModel = context.read<AuthViewModel>();"},{"type":"INSERT","lineNumber":620,"content":"    _viewModel.addListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":621,"content":"    _startResendTimer();"},{"type":"INSERT","lineNumber":622,"content":"    "},{"type":"INSERT","lineNumber":623,"content":"    // Auto-focus the first OTP field"},{"type":"INSERT","lineNumber":624,"content":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"INSERT","lineNumber":625,"content":"      if (mounted && _focusNodes[0].canRequestFocus) {"},{"type":"INSERT","lineNumber":626,"content":"        _focusNodes[0].requestFocus();"},{"type":"INSERT","lineNumber":627,"content":"      }"},{"type":"INSERT","lineNumber":628,"content":"    });"},{"type":"INSERT","lineNumber":629,"content":"  }"},{"type":"INSERT","lineNumber":630,"content":""},{"type":"INSERT","lineNumber":631,"content":"  @override"},{"type":"INSERT","lineNumber":632,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":633,"content":"    for (var controller in _otpControllers) {"},{"type":"INSERT","lineNumber":634,"content":"      controller.dispose();"},{"type":"INSERT","lineNumber":635,"content":"    }"},{"type":"INSERT","lineNumber":636,"content":"    for (var node in _focusNodes) {"},{"type":"INSERT","lineNumber":637,"content":"      node.dispose();"},{"type":"INSERT","lineNumber":638,"content":"    }"},{"type":"INSERT","lineNumber":639,"content":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":640,"content":"    _resendTimer.cancel();"},{"type":"INSERT","lineNumber":641,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":642,"content":"  }"},{"type":"INSERT","lineNumber":643,"content":""},{"type":"INSERT","lineNumber":644,"content":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":645,"content":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"INSERT","lineNumber":646,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":647,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":648,"content":"          SnackBar("},{"type":"INSERT","lineNumber":649,"content":"            content: Text(_viewModel.errorMessage!),"},{"type":"INSERT","lineNumber":650,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":651,"content":"          ),"},{"type":"INSERT","lineNumber":652,"content":"        );"},{"type":"INSERT","lineNumber":653,"content":"        _viewModel.setError();"},{"type":"INSERT","lineNumber":654,"content":"      }"},{"type":"INSERT","lineNumber":655,"content":"    }"},{"type":"INSERT","lineNumber":656,"content":"  }"},{"type":"INSERT","lineNumber":657,"content":""},{"type":"INSERT","lineNumber":658,"content":"  void _startResendTimer() {"},{"type":"INSERT","lineNumber":659,"content":"    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"INSERT","lineNumber":660,"content":"      if (_resendCodeIn > 0) {"},{"type":"INSERT","lineNumber":661,"content":"        setState(() => _resendCodeIn--);"},{"type":"INSERT","lineNumber":662,"content":"      } else {"},{"type":"INSERT","lineNumber":663,"content":"        _resendTimer.cancel();"},{"type":"INSERT","lineNumber":664,"content":"      }"},{"type":"INSERT","lineNumber":665,"content":"    });"},{"type":"INSERT","lineNumber":666,"content":"  }"},{"type":"INSERT","lineNumber":667,"content":""},{"type":"INSERT","lineNumber":668,"content":"  Future<void> _resendOtp() async {"},{"type":"INSERT","lineNumber":669,"content":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"INSERT","lineNumber":670,"content":""},{"type":"INSERT","lineNumber":671,"content":"    setState(() => _isResendLoading = true);"},{"type":"INSERT","lineNumber":672,"content":""},{"type":"INSERT","lineNumber":673,"content":"    try {"},{"type":"INSERT","lineNumber":674,"content":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"INSERT","lineNumber":675,"content":"      "},{"type":"INSERT","lineNumber":676,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":677,"content":"        // Clear OTP fields"},{"type":"INSERT","lineNumber":678,"content":"        for (var controller in _otpControllers) {"},{"type":"INSERT","lineNumber":679,"content":"          controller.clear();"},{"type":"INSERT","lineNumber":680,"content":"        }"},{"type":"INSERT","lineNumber":681,"content":"        "},{"type":"INSERT","lineNumber":682,"content":"        // Focus first field"},{"type":"INSERT","lineNumber":683,"content":"        if (_focusNodes[0].canRequestFocus) {"},{"type":"INSERT","lineNumber":684,"content":"          _focusNodes[0].requestFocus();"},{"type":"INSERT","lineNumber":685,"content":"        }"},{"type":"INSERT","lineNumber":686,"content":""},{"type":"INSERT","lineNumber":687,"content":"        if (success) {"},{"type":"INSERT","lineNumber":688,"content":"          // Reset timer"},{"type":"INSERT","lineNumber":689,"content":"          setState(() => _resendCodeIn = 30);"},{"type":"INSERT","lineNumber":690,"content":"          _startResendTimer();"},{"type":"INSERT","lineNumber":691,"content":"          "},{"type":"INSERT","lineNumber":692,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":693,"content":"            const SnackBar("},{"type":"INSERT","lineNumber":694,"content":"              content: Text('OTP has been resent successfully'),"},{"type":"INSERT","lineNumber":695,"content":"              behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":696,"content":"            ),"},{"type":"INSERT","lineNumber":697,"content":"          );"},{"type":"INSERT","lineNumber":698,"content":"        } else if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"INSERT","lineNumber":699,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":700,"content":"            SnackBar("},{"type":"INSERT","lineNumber":701,"content":"              content: Text(_viewModel.errorMessage!),"},{"type":"INSERT","lineNumber":702,"content":"              behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":703,"content":"            ),"},{"type":"INSERT","lineNumber":704,"content":"          );"},{"type":"INSERT","lineNumber":705,"content":"        }"},{"type":"INSERT","lineNumber":706,"content":"      }"},{"type":"INSERT","lineNumber":707,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":708,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":709,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":710,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":711,"content":"            content: Text('Failed to resend OTP. Please try again.'),"},{"type":"INSERT","lineNumber":712,"content":"            behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":713,"content":"          ),"},{"type":"INSERT","lineNumber":714,"content":"        );"},{"type":"INSERT","lineNumber":715,"content":"      }"},{"type":"INSERT","lineNumber":716,"content":"    } finally {"},{"type":"INSERT","lineNumber":717,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":718,"content":"        setState(() => _isResendLoading = false);"},{"type":"INSERT","lineNumber":719,"content":"      }"},{"type":"INSERT","lineNumber":720,"content":"    }"},{"type":"INSERT","lineNumber":721,"content":"  }"},{"type":"INSERT","lineNumber":722,"content":""},{"type":"INSERT","lineNumber":723,"content":"  void _onOtpChanged(String value, int index) {"},{"type":"INSERT","lineNumber":724,"content":"    if (value.length == 1 && index < _otpControllers.length - 1) {"},{"type":"INSERT","lineNumber":725,"content":"      _focusNodes[index + 1].requestFocus();"},{"type":"INSERT","lineNumber":726,"content":"    } else if (value.isEmpty && index > 0) {"},{"type":"INSERT","lineNumber":727,"content":"      _focusNodes[index - 1].requestFocus();"},{"type":"INSERT","lineNumber":728,"content":"    }"},{"type":"INSERT","lineNumber":729,"content":"  }"},{"type":"INSERT","lineNumber":730,"content":""},{"type":"INSERT","lineNumber":731,"content":"  Future<bool> _onWillPop() async {"},{"type":"INSERT","lineNumber":732,"content":"    if (_viewModel.isLoading) return false;"},{"type":"INSERT","lineNumber":733,"content":"    "},{"type":"INSERT","lineNumber":734,"content":"    final shouldPop = await showDialog<bool>("},{"type":"INSERT","lineNumber":735,"content":"      context: context,"},{"type":"INSERT","lineNumber":736,"content":"      builder: (context) => AlertDialog("},{"type":"INSERT","lineNumber":737,"content":"        title: const Text('Are you sure?'),"},{"type":"INSERT","lineNumber":738,"content":"        content: const Text('Do you want to cancel OTP verification?'),"},{"type":"INSERT","lineNumber":739,"content":"        actions: ["},{"type":"INSERT","lineNumber":740,"content":"          TextButton("},{"type":"INSERT","lineNumber":741,"content":"            onPressed: () => Navigator.of(context).pop(false),"},{"type":"INSERT","lineNumber":742,"content":"            child: const Text('No'),"},{"type":"INSERT","lineNumber":743,"content":"          ),"},{"type":"INSERT","lineNumber":744,"content":"          TextButton("},{"type":"INSERT","lineNumber":745,"content":"            onPressed: () {"},{"type":"INSERT","lineNumber":746,"content":"              _viewModel.setErrorSilently();"},{"type":"INSERT","lineNumber":747,"content":"              Navigator.of(context).pop(true);"},{"type":"INSERT","lineNumber":748,"content":"            },"},{"type":"INSERT","lineNumber":749,"content":"            child: const Text('Yes'),"},{"type":"INSERT","lineNumber":750,"content":"          ),"},{"type":"INSERT","lineNumber":751,"content":"        ],"},{"type":"INSERT","lineNumber":752,"content":"      ),"},{"type":"INSERT","lineNumber":753,"content":"    );"},{"type":"INSERT","lineNumber":754,"content":"    "},{"type":"INSERT","lineNumber":755,"content":"    return shouldPop ?? false;"},{"type":"INSERT","lineNumber":756,"content":"  }"},{"type":"INSERT","lineNumber":757,"content":""},{"type":"INSERT","lineNumber":758,"content":"  @override"},{"type":"INSERT","lineNumber":759,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":760,"content":"    return WillPopScope("},{"type":"INSERT","lineNumber":761,"content":"      onWillPop: _onWillPop,"},{"type":"INSERT","lineNumber":762,"content":"      child: Scaffold("},{"type":"INSERT","lineNumber":763,"content":"        appBar: AppBar("},{"type":"INSERT","lineNumber":764,"content":"          title: const Text('Verify OTP'),"},{"type":"INSERT","lineNumber":765,"content":"          leading: IconButton("},{"type":"INSERT","lineNumber":766,"content":"            icon: const Icon(Icons.arrow_back),"},{"type":"INSERT","lineNumber":767,"content":"            onPressed: () => _onWillPop().then((value) {"},{"type":"INSERT","lineNumber":768,"content":"              if (value) {"},{"type":"INSERT","lineNumber":769,"content":"                Navigator.of(context).pop();"},{"type":"INSERT","lineNumber":770,"content":"              }"},{"type":"INSERT","lineNumber":771,"content":"            }),"},{"type":"INSERT","lineNumber":772,"content":"          ),"},{"type":"INSERT","lineNumber":773,"content":"        ),"},{"type":"INSERT","lineNumber":774,"content":"        body: SingleChildScrollView("},{"type":"INSERT","lineNumber":775,"content":"          padding: const EdgeInsets.all(16.0),"},{"type":"INSERT","lineNumber":776,"content":"          child: Column("},{"type":"INSERT","lineNumber":777,"content":"            children: ["},{"type":"INSERT","lineNumber":778,"content":"              const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":779,"content":"              const Text("},{"type":"INSERT","lineNumber":780,"content":"                'Enter OTP',"},{"type":"INSERT","lineNumber":781,"content":"                style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),"},{"type":"INSERT","lineNumber":783,"content":"              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":784,"content":"              Text("},{"type":"INSERT","lineNumber":785,"content":"                'We have sent an OTP to +91 ${widget.phoneNumber}',"},{"type":"INSERT","lineNumber":786,"content":"                textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":787,"content":"                style: const TextStyle(fontSize: 16, color: Colors.grey),"},{"type":"INSERT","lineNumber":788,"content":"              ),"},{"type":"INSERT","lineNumber":790,"content":"              Row("},{"type":"INSERT","lineNumber":791,"content":"                mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"INSERT","lineNumber":792,"content":"                children: List.generate("},{"type":"INSERT","lineNumber":793,"content":"                  6,"},{"type":"INSERT","lineNumber":794,"content":"                  (index) => SizedBox("},{"type":"INSERT","lineNumber":795,"content":"                    width: 50,"},{"type":"INSERT","lineNumber":796,"content":"                    child: TextField("},{"type":"INSERT","lineNumber":797,"content":"                      controller: _otpControllers[index],"},{"type":"INSERT","lineNumber":798,"content":"                      focusNode: _focusNodes[index],"},{"type":"INSERT","lineNumber":799,"content":"                      keyboardType: TextInputType.number,"},{"type":"INSERT","lineNumber":800,"content":"                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":801,"content":"                      maxLength: 1,"},{"type":"INSERT","lineNumber":802,"content":"                      onChanged: (value) => _onOtpChanged(value, index),"},{"type":"INSERT","lineNumber":803,"content":"                      decoration: const InputDecoration("},{"type":"INSERT","lineNumber":804,"content":"                        counterText: '',"},{"type":"INSERT","lineNumber":805,"content":"                        border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":806,"content":"                      ),"},{"type":"INSERT","lineNumber":807,"content":"                    ),"},{"type":"INSERT","lineNumber":808,"content":"                  ),"},{"type":"INSERT","lineNumber":809,"content":"                ),"},{"type":"INSERT","lineNumber":810,"content":"              ),"},{"type":"INSERT","lineNumber":811,"content":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":813,"oldContent":"  }"},{"type":"DELETE","lineNumber":814,"oldContent":""},{"type":"DELETE","lineNumber":836,"oldContent":"  Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":838,"oldContent":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":841,"oldContent":"    try {"},{"type":"DELETE","lineNumber":842,"oldContent":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":844,"oldContent":"      "},{"type":"DELETE","lineNumber":850,"oldContent":""},{"type":"DELETE","lineNumber":862,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":890,"oldContent":"  @override"},{"type":"DELETE","lineNumber":1024,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1025,"oldContent":"                              onChanged: (value) => _onOtpChanged(value, index),"},{"type":"DELETE","lineNumber":1026,"oldContent":"                              onTap: () {"},{"type":"DELETE","lineNumber":1027,"oldContent":"                                // Move cursor to end of text when field is tapped"},{"type":"DELETE","lineNumber":1028,"oldContent":"                                _otpControllers[index].selection = TextSelection.fromPosition("},{"type":"DELETE","lineNumber":1029,"oldContent":"                                  TextPosition(offset: _otpControllers[index].text.length),"},{"type":"DELETE","lineNumber":1030,"oldContent":"                                );"},{"type":"DELETE","lineNumber":1031,"oldContent":"                              },"},{"type":"DELETE","lineNumber":1032,"oldContent":"                              decoration: InputDecoration("},{"type":"DELETE","lineNumber":1033,"oldContent":"                                counterText: '',"},{"type":"DELETE","lineNumber":1034,"oldContent":"                                contentPadding: EdgeInsets.zero,"},{"type":"DELETE","lineNumber":1035,"oldContent":"                                enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":1036,"oldContent":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1038,"oldContent":"                                  borderSide: BorderSide("},{"type":"DELETE","lineNumber":1040,"oldContent":"                                    color: Colors.grey[300]!,"},{"type":"DELETE","lineNumber":1042,"oldContent":"                                    width: 1.5,"},{"type":"DELETE","lineNumber":1044,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1046,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1048,"oldContent":"                                focusedBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":1050,"oldContent":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1052,"oldContent":"                                  borderSide: BorderSide("},{"type":"DELETE","lineNumber":1054,"oldContent":"                                    color: theme.primaryColor,"},{"type":"DELETE","lineNumber":1056,"oldContent":"                                    width: 2,"},{"type":"DELETE","lineNumber":1058,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1060,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1062,"oldContent":"                                errorBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":1065,"oldContent":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1067,"oldContent":"                                  borderSide: const BorderSide("},{"type":"DELETE","lineNumber":1069,"oldContent":"                                    color: Colors.red,"},{"type":"DELETE","lineNumber":1071,"oldContent":"                                    width: 1.5,"},{"type":"DELETE","lineNumber":1073,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1075,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1077,"oldContent":"                                focusedErrorBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":1079,"oldContent":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1081,"oldContent":"                                  borderSide: const BorderSide("},{"type":"DELETE","lineNumber":1083,"oldContent":"                                    color: Colors.red,"},{"type":"DELETE","lineNumber":1085,"oldContent":"                                    width: 2,"},{"type":"DELETE","lineNumber":1087,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1089,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1091,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1093,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":1095,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1097,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":1099,"oldContent":"                              ? const SizedBox("},{"type":"DELETE","lineNumber":1101,"oldContent":"                                  width: 24,"},{"type":"DELETE","lineNumber":1103,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1105,"oldContent":"                                  height: 24,"},{"type":"DELETE","lineNumber":1107,"oldContent":"                                  child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":1109,"oldContent":"                                    strokeWidth: 2,"},{"type":"DELETE","lineNumber":1111,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1113,"oldContent":"                                )"},{"type":"DELETE","lineNumber":1115,"oldContent":"                              : Row("},{"type":"DELETE","lineNumber":1117,"oldContent":"                                  mainAxisSize: MainAxisSize.min,"},{"type":"DELETE","lineNumber":1119,"oldContent":"                                  children: ["},{"type":"DELETE","lineNumber":1121,"oldContent":"                                    Icon("},{"type":"DELETE","lineNumber":1123,"oldContent":"                                      Icons.refresh,"},{"type":"DELETE","lineNumber":1125,"oldContent":"                                      size: 18,"},{"type":"DELETE","lineNumber":1127,"oldContent":"                                      color: _resendCodeIn == 0 "},{"type":"DELETE","lineNumber":1130,"oldContent":"                                          ? colorScheme.primary "},{"type":"DELETE","lineNumber":1133,"oldContent":"                                          : Colors.grey,"},{"type":"DELETE","lineNumber":1136,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":1139,"oldContent":"                                    const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":1142,"oldContent":"                                    Text("},{"type":"DELETE","lineNumber":1145,"oldContent":"                                      _resendCodeIn > 0"},{"type":"DELETE","lineNumber":1148,"oldContent":"                                          ? 'Resend code in $_resendCodeIn seconds'"},{"type":"DELETE","lineNumber":1151,"oldContent":"                                          : 'Resend code',"},{"type":"DELETE","lineNumber":1154,"oldContent":"                                      style: TextStyle("},{"type":"DELETE","lineNumber":1157,"oldContent":"                                        color: _resendCodeIn == 0"},{"type":"DELETE","lineNumber":1160,"oldContent":"                                            ? colorScheme.primary"},{"type":"DELETE","lineNumber":1162,"oldContent":"                                            : Colors.grey,"},{"type":"DELETE","lineNumber":1164,"oldContent":"                                        fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":1166,"oldContent":"                                      ),"},{"type":"DELETE","lineNumber":1168,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":1170,"oldContent":"                                  ],"},{"type":"DELETE","lineNumber":1172,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1174,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1176,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1178,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":1180,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":1182,"oldContent":"                ),"},{"type":"DELETE","lineNumber":1184,"oldContent":"              ),"},{"type":"DELETE","lineNumber":1186,"oldContent":"            );"},{"type":"DELETE","lineNumber":1188,"oldContent":"          },"},{"type":"DELETE","lineNumber":1190,"oldContent":"        );"},{"type":"DELETE","lineNumber":1192,"oldContent":"      }"},{"type":"DELETE","lineNumber":1194,"oldContent":"    }"},{"type":"DELETE","lineNumber":1197,"oldContent":"      ),"},{"type":"DELETE","lineNumber":1199,"oldContent":"    );"},{"type":"DELETE","lineNumber":1200,"oldContent":"  }"},{"type":"DELETE","lineNumber":1202,"oldContent":"}"},{"type":"DELETE","lineNumber":1204,"oldContent":""},{"type":"DELETE","lineNumber":1258,"oldContent":"                                  width: 24,"},{"type":"DELETE","lineNumber":1260,"oldContent":"                              ? const SizedBox("},{"type":"DELETE","lineNumber":1262,"oldContent":"                          child: _isResendLoading"},{"type":"DELETE","lineNumber":1264,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":1266,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1268,"oldContent":"                              borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1270,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":1272,"oldContent":"                            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"DELETE","lineNumber":1274,"oldContent":"                          style: TextButton.styleFrom("},{"type":"DELETE","lineNumber":1276,"oldContent":"                          onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"DELETE","lineNumber":1278,"oldContent":"                        child: TextButton("},{"type":"DELETE","lineNumber":1280,"oldContent":"                      Center("},{"type":"DELETE","lineNumber":1282,"oldContent":"                      const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":1284,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1286,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1288,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1290,"oldContent":"                                    fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":1292,"oldContent":"                                    fontSize: 16,"},{"type":"DELETE","lineNumber":1294,"oldContent":"                                  style: TextStyle("},{"type":"DELETE","lineNumber":1296,"oldContent":"                                  'Verify',"},{"type":"DELETE","lineNumber":1298,"oldContent":"                              : const Text("},{"type":"DELETE","lineNumber":1300,"oldContent":"                                )"},{"type":"DELETE","lineNumber":1302,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1304,"oldContent":"                                    strokeWidth: 2,"},{"type":"DELETE","lineNumber":1306,"oldContent":"                                    color: Colors.white,"},{"type":"DELETE","lineNumber":1308,"oldContent":"                                  child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":1310,"oldContent":"                                  height: 24,"},{"type":"DELETE","lineNumber":1312,"oldContent":"                          child: viewModel.isLoading"},{"type":"DELETE","lineNumber":1314,"oldContent":"                            padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":1316,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":1318,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":1320,"oldContent":"                            elevation: 0,"},{"type":"DELETE","lineNumber":1322,"oldContent":"                            foregroundColor: colorScheme.onPrimary,"},{"type":"DELETE","lineNumber":1324,"oldContent":"                            backgroundColor: colorScheme.primary,"},{"type":"DELETE","lineNumber":1326,"oldContent":"                          style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":1328,"oldContent":"                          onPressed: viewModel.isLoading ? null : _verifyOtp,"},{"type":"DELETE","lineNumber":1330,"oldContent":"                        child: ElevatedButton("},{"type":"DELETE","lineNumber":1332,"oldContent":"                        height: 56,"},{"type":"DELETE","lineNumber":1334,"oldContent":"                        width: double.infinity,"},{"type":"DELETE","lineNumber":1336,"oldContent":"                      SizedBox("},{"type":"DELETE","lineNumber":1338,"oldContent":"                      const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":1340,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1342,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1344,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1346,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1348,"oldContent":"                                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":1350,"oldContent":"                              style: theme.textTheme.headlineSmall?.copyWith("},{"type":"DELETE","lineNumber":1352,"oldContent":"                              maxLength: 1,"},{"type":"DELETE","lineNumber":1354,"oldContent":"                              textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":1356,"oldContent":"                              keyboardType: TextInputType.number,"},{"type":"DELETE","lineNumber":1358,"oldContent":"                              focusNode: _focusNodes[index],"},{"type":"DELETE","lineNumber":1360,"oldContent":"                              controller: _otpControllers[index],"},{"type":"DELETE","lineNumber":1362,"oldContent":"                            child: TextFormField("},{"type":"DELETE","lineNumber":1364,"oldContent":"                            height: 56,"},{"type":"DELETE","lineNumber":1366,"oldContent":"                            width: 48,"},{"type":"DELETE","lineNumber":1368,"oldContent":"                          (index) => SizedBox("},{"type":"DELETE","lineNumber":1370,"oldContent":"                          6,"},{"type":"DELETE","lineNumber":1372,"oldContent":"                        children: List.generate("},{"type":"DELETE","lineNumber":1374,"oldContent":"                        mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":1376,"oldContent":"                      Row("},{"type":"DELETE","lineNumber":1378,"oldContent":"                      const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":1380,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1382,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1384,"oldContent":"                          ],"},{"type":"DELETE","lineNumber":1386,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1388,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1390,"oldContent":"                                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":1392,"oldContent":"                              style: theme.textTheme.bodySmall?.copyWith("},{"type":"DELETE","lineNumber":1394,"oldContent":"                              textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":1396,"oldContent":"                              'Check your spam folder or request a new code',"},{"type":"DELETE","lineNumber":1398,"oldContent":"                            Text("},{"type":"DELETE","lineNumber":1400,"oldContent":"                            const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":1402,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1404,"oldContent":"                                fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":1406,"oldContent":"                                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":1408,"oldContent":"                              style: theme.textTheme.bodyMedium?.copyWith("},{"type":"DELETE","lineNumber":1410,"oldContent":"                              'Having trouble receiving the code?',"},{"type":"DELETE","lineNumber":1412,"oldContent":"                            Text("},{"type":"DELETE","lineNumber":1414,"oldContent":"                            const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":1416,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1418,"oldContent":"                              color: Colors.grey,"},{"type":"DELETE","lineNumber":1420,"oldContent":"                              size: 20,"},{"type":"DELETE","lineNumber":1422,"oldContent":"                              Icons.info_outline,"},{"type":"DELETE","lineNumber":1424,"oldContent":"                            const Icon("},{"type":"DELETE","lineNumber":1426,"oldContent":"                          children: ["},{"type":"DELETE","lineNumber":1428,"oldContent":"                        child: Column("},{"type":"DELETE","lineNumber":1430,"oldContent":"                      Center("},{"type":"DELETE","lineNumber":1432,"oldContent":"                      const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":1434,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1436,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1438,"oldContent":"                          fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":1440,"oldContent":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"DELETE","lineNumber":1442,"oldContent":"                        widget.phoneNumber,"},{"type":"DELETE","lineNumber":1444,"oldContent":"                      Text("},{"type":"DELETE","lineNumber":1446,"oldContent":"                      const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":1448,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1451,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1452,"oldContent":"                          color: Colors.grey[600],"},{"type":"DELETE","lineNumber":1454,"oldContent":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"INSERT","lineNumber":1266,"content":"                      Text("},{"type":"INSERT","lineNumber":1268,"content":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"INSERT","lineNumber":1269,"content":"                          color: Colors.grey[600],"},{"type":"INSERT","lineNumber":1270,"content":"                        ),"},{"type":"INSERT","lineNumber":1271,"content":"                      ),"},{"type":"INSERT","lineNumber":1272,"content":"                      const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":1274,"content":"                        widget.phoneNumber,"},{"type":"INSERT","lineNumber":1275,"content":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"INSERT","lineNumber":1276,"content":"                          fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":1277,"content":"                        ),"},{"type":"INSERT","lineNumber":1278,"content":"                      ),"},{"type":"INSERT","lineNumber":1279,"content":"                      const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":1280,"content":"                      Center("},{"type":"INSERT","lineNumber":1281,"content":"                        child: Column("},{"type":"INSERT","lineNumber":1282,"content":"                          children: ["},{"type":"INSERT","lineNumber":1283,"content":"                            const Icon("},{"type":"INSERT","lineNumber":1284,"content":"                              Icons.info_outline,"},{"type":"INSERT","lineNumber":1285,"content":"                              size: 20,"},{"type":"INSERT","lineNumber":1286,"content":"                              color: Colors.grey,"},{"type":"INSERT","lineNumber":1287,"content":"                            ),"},{"type":"INSERT","lineNumber":1288,"content":"                            const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":1289,"content":"                            Text("},{"type":"INSERT","lineNumber":1290,"content":"                              'Having trouble receiving the code?',"},{"type":"INSERT","lineNumber":1291,"content":"                              style: theme.textTheme.bodyMedium?.copyWith("},{"type":"INSERT","lineNumber":1292,"content":"                                color: Colors.grey[600],"},{"type":"INSERT","lineNumber":1293,"content":"                                fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":1294,"content":"                              ),"},{"type":"INSERT","lineNumber":1295,"content":"                            ),"},{"type":"INSERT","lineNumber":1296,"content":"                            const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":1297,"content":"                            Text("},{"type":"INSERT","lineNumber":1298,"content":"                              'Check your spam folder or request a new code',"},{"type":"INSERT","lineNumber":1299,"content":"                              textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":1300,"content":"                              style: theme.textTheme.bodySmall?.copyWith("},{"type":"INSERT","lineNumber":1301,"content":"                                color: Colors.grey[600],"},{"type":"INSERT","lineNumber":1302,"content":"                              ),"},{"type":"INSERT","lineNumber":1303,"content":"                            ),"},{"type":"INSERT","lineNumber":1304,"content":"                          ],"},{"type":"INSERT","lineNumber":1305,"content":"                        ),"},{"type":"INSERT","lineNumber":1306,"content":"                      ),"},{"type":"INSERT","lineNumber":1307,"content":"                      const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":1308,"content":"                      Row("},{"type":"INSERT","lineNumber":1309,"content":"                        mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":1310,"content":"                        children: List.generate("},{"type":"INSERT","lineNumber":1311,"content":"                          6,"},{"type":"INSERT","lineNumber":1312,"content":"                          (index) => SizedBox("},{"type":"INSERT","lineNumber":1313,"content":"                            width: 48,"},{"type":"INSERT","lineNumber":1314,"content":"                            height: 56,"},{"type":"INSERT","lineNumber":1315,"content":"                            child: TextFormField("},{"type":"INSERT","lineNumber":1316,"content":"                              controller: _otpControllers[index],"},{"type":"INSERT","lineNumber":1317,"content":"                              focusNode: _focusNodes[index],"},{"type":"INSERT","lineNumber":1318,"content":"                              keyboardType: TextInputType.number,"},{"type":"INSERT","lineNumber":1319,"content":"                              textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":1320,"content":"                              maxLength: 1,"},{"type":"INSERT","lineNumber":1321,"content":"                              style: theme.textTheme.headlineSmall?.copyWith("},{"type":"INSERT","lineNumber":1322,"content":"                                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":1323,"content":"                              ),"},{"type":"INSERT","lineNumber":1324,"content":"                              onChanged: (value) => _onOtpChanged(value, index),"},{"type":"INSERT","lineNumber":1325,"content":"                              onTap: () {"},{"type":"INSERT","lineNumber":1326,"content":"                                // Move cursor to end of text when field is tapped"},{"type":"INSERT","lineNumber":1327,"content":"                                _otpControllers[index].selection = TextSelection.fromPosition("},{"type":"INSERT","lineNumber":1328,"content":"                                  TextPosition(offset: _otpControllers[index].text.length),"},{"type":"INSERT","lineNumber":1329,"content":"                                );"},{"type":"INSERT","lineNumber":1330,"content":"                              },"},{"type":"INSERT","lineNumber":1331,"content":"                              decoration: InputDecoration("},{"type":"INSERT","lineNumber":1332,"content":"                                counterText: '',"},{"type":"INSERT","lineNumber":1333,"content":"                                contentPadding: EdgeInsets.zero,"},{"type":"INSERT","lineNumber":1334,"content":"                                enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":1335,"content":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":1336,"content":"                                  borderSide: BorderSide("},{"type":"INSERT","lineNumber":1337,"content":"                                    color: Colors.grey[300]!,"},{"type":"INSERT","lineNumber":1338,"content":"                                    width: 1.5,"},{"type":"INSERT","lineNumber":1339,"content":"                                  ),"},{"type":"INSERT","lineNumber":1340,"content":"                                ),"},{"type":"INSERT","lineNumber":1341,"content":"                                focusedBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":1342,"content":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":1343,"content":"                                  borderSide: BorderSide("},{"type":"INSERT","lineNumber":1344,"content":"                                    color: theme.primaryColor,"},{"type":"INSERT","lineNumber":1345,"content":"                                    width: 2,"},{"type":"INSERT","lineNumber":1346,"content":"                                  ),"},{"type":"INSERT","lineNumber":1347,"content":"                                ),"},{"type":"INSERT","lineNumber":1348,"content":"                                errorBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":1349,"content":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":1350,"content":"                                  borderSide: const BorderSide("},{"type":"INSERT","lineNumber":1351,"content":"                                    color: Colors.red,"},{"type":"INSERT","lineNumber":1352,"content":"                                    width: 1.5,"},{"type":"INSERT","lineNumber":1353,"content":"                                  ),"},{"type":"INSERT","lineNumber":1354,"content":"                                ),"},{"type":"INSERT","lineNumber":1355,"content":"                                focusedErrorBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":1356,"content":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":1357,"content":"                                  borderSide: const BorderSide("},{"type":"INSERT","lineNumber":1358,"content":"                                    color: Colors.red,"},{"type":"INSERT","lineNumber":1359,"content":"                                    width: 2,"},{"type":"INSERT","lineNumber":1360,"content":"                                  ),"},{"type":"INSERT","lineNumber":1361,"content":"                                ),"},{"type":"INSERT","lineNumber":1362,"content":"                              ),"},{"type":"INSERT","lineNumber":1363,"content":"                            ),"},{"type":"INSERT","lineNumber":1364,"content":"                          ),"},{"type":"INSERT","lineNumber":1365,"content":"                        ),"},{"type":"INSERT","lineNumber":1366,"content":"                      ),"},{"type":"INSERT","lineNumber":1367,"content":"                      const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":1368,"content":"                      SizedBox("},{"type":"INSERT","lineNumber":1369,"content":"                        width: double.infinity,"},{"type":"INSERT","lineNumber":1370,"content":"                        height: 56,"},{"type":"INSERT","lineNumber":1371,"content":"                        child: ElevatedButton("},{"type":"INSERT","lineNumber":1372,"content":"                          onPressed: viewModel.isLoading ? null : _verifyOtp,"},{"type":"INSERT","lineNumber":1373,"content":"                          style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":1374,"content":"                            backgroundColor: colorScheme.primary,"},{"type":"INSERT","lineNumber":1375,"content":"                            foregroundColor: colorScheme.onPrimary,"},{"type":"INSERT","lineNumber":1376,"content":"                            elevation: 0,"},{"type":"INSERT","lineNumber":1377,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":1378,"content":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":1379,"content":"                            ),"},{"type":"INSERT","lineNumber":1380,"content":"                            padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":1381,"content":"                          ),"},{"type":"INSERT","lineNumber":1382,"content":"                          child: viewModel.isLoading"},{"type":"INSERT","lineNumber":1383,"content":"                              ? const SizedBox("},{"type":"INSERT","lineNumber":1384,"content":"                                  width: 24,"},{"type":"INSERT","lineNumber":1385,"content":"                                  height: 24,"},{"type":"INSERT","lineNumber":1386,"content":"                                  child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":1387,"content":"                                    color: Colors.white,"},{"type":"INSERT","lineNumber":1388,"content":"                                    strokeWidth: 2,"},{"type":"INSERT","lineNumber":1389,"content":"                                  ),"},{"type":"INSERT","lineNumber":1390,"content":"                                )"},{"type":"INSERT","lineNumber":1391,"content":"                              : const Text("},{"type":"INSERT","lineNumber":1392,"content":"                                  'Verify',"},{"type":"INSERT","lineNumber":1393,"content":"                                  style: TextStyle("},{"type":"INSERT","lineNumber":1394,"content":"                                    fontSize: 16,"},{"type":"INSERT","lineNumber":1395,"content":"                                    fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":1396,"content":"                                  ),"},{"type":"INSERT","lineNumber":1397,"content":"                                ),"},{"type":"INSERT","lineNumber":1398,"content":"                        ),"},{"type":"INSERT","lineNumber":1399,"content":"                      ),"},{"type":"INSERT","lineNumber":1400,"content":"                      const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":1401,"content":"                      Center("},{"type":"INSERT","lineNumber":1402,"content":"                        child: TextButton("},{"type":"INSERT","lineNumber":1403,"content":"                          onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"INSERT","lineNumber":1404,"content":"                          style: TextButton.styleFrom("},{"type":"INSERT","lineNumber":1405,"content":"                            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":1406,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":1407,"content":"                              borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":1408,"content":"                            ),"},{"type":"INSERT","lineNumber":1409,"content":"                          ),"},{"type":"INSERT","lineNumber":1410,"content":"                          child: _isResendLoading"},{"type":"INSERT","lineNumber":1411,"content":"                              ? const SizedBox("},{"type":"INSERT","lineNumber":1412,"content":"                                  width: 24,"},{"type":"INSERT","lineNumber":1413,"content":"                                  height: 24,"},{"type":"INSERT","lineNumber":1414,"content":"                                  child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":1415,"content":"                                    strokeWidth: 2,"},{"type":"INSERT","lineNumber":1416,"content":"                                  ),"},{"type":"INSERT","lineNumber":1417,"content":"                                )"},{"type":"INSERT","lineNumber":1418,"content":"                              : Row("},{"type":"INSERT","lineNumber":1419,"content":"                                  mainAxisSize: MainAxisSize.min,"},{"type":"INSERT","lineNumber":1420,"content":"                                  children: ["},{"type":"INSERT","lineNumber":1421,"content":"                                    Icon("},{"type":"INSERT","lineNumber":1422,"content":"                                      Icons.refresh,"},{"type":"INSERT","lineNumber":1423,"content":"                                      size: 18,"},{"type":"INSERT","lineNumber":1424,"content":"                                      color: _resendCodeIn == 0 "},{"type":"INSERT","lineNumber":1425,"content":"                                          ? colorScheme.primary "},{"type":"INSERT","lineNumber":1426,"content":"                                          : Colors.grey,"},{"type":"INSERT","lineNumber":1427,"content":"                                    ),"},{"type":"INSERT","lineNumber":1428,"content":"                                    const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":1429,"content":"                                    Text("},{"type":"INSERT","lineNumber":1430,"content":"                                      _resendCodeIn > 0"},{"type":"INSERT","lineNumber":1431,"content":"                                          ? 'Resend code in $_resendCodeIn seconds'"},{"type":"INSERT","lineNumber":1432,"content":"                                          : 'Resend code',"},{"type":"INSERT","lineNumber":1433,"content":"                                      style: TextStyle("},{"type":"INSERT","lineNumber":1434,"content":"                                        color: _resendCodeIn == 0"},{"type":"INSERT","lineNumber":1435,"content":"                                            ? colorScheme.primary"},{"type":"INSERT","lineNumber":1436,"content":"                                            : Colors.grey,"},{"type":"INSERT","lineNumber":1437,"content":"                                        fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":1438,"content":"                                      ),"},{"type":"INSERT","lineNumber":1439,"content":"                                    ),"},{"type":"INSERT","lineNumber":1440,"content":"                                  ],"},{"type":"INSERT","lineNumber":1441,"content":"                                ),"},{"type":"INSERT","lineNumber":1442,"content":"                        ),"},{"type":"INSERT","lineNumber":1443,"content":"                      ),"},{"type":"INSERT","lineNumber":1444,"content":"                    ],"},{"type":"INSERT","lineNumber":1445,"content":"                  ),"},{"type":"INSERT","lineNumber":1446,"content":"                ),"},{"type":"INSERT","lineNumber":1447,"content":"              ),"},{"type":"INSERT","lineNumber":1448,"content":"            );"},{"type":"INSERT","lineNumber":1449,"content":"          },"},{"type":"INSERT","lineNumber":1450,"content":"        );"},{"type":"INSERT","lineNumber":1451,"content":"      }"},{"type":"INSERT","lineNumber":1452,"content":"    }"},{"type":"INSERT","lineNumber":1453,"content":"      ),"},{"type":"INSERT","lineNumber":1454,"content":"    );"},{"type":"INSERT","lineNumber":1455,"content":"  }"},{"type":"INSERT","lineNumber":1456,"content":"}"},{"type":"INSERT","lineNumber":1457,"content":""}]},{"timestamp":1754611250268,"changes":[{"type":"MODIFY","lineNumber":8,"content":"class OtpVerificationScreen extends StatefulWidget {","oldContent":"  final String phoneNumber;"},{"type":"DELETE","lineNumber":29,"oldContent":"  late AuthViewModel _viewModel;"},{"type":"INSERT","lineNumber":30,"content":""},{"type":"DELETE","lineNumber":42,"oldContent":"    });"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"INSERT","lineNumber":43,"content":"    });"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"INSERT","lineNumber":69,"content":"      }"},{"type":"DELETE","lineNumber":71,"oldContent":"      }"},{"type":"DELETE","lineNumber":80,"oldContent":"    }"},{"type":"MODIFY","lineNumber":86,"content":"    }","oldContent":"      // Handle successful verification"},{"type":"DELETE","lineNumber":116,"oldContent":"    setState(() => _isResendLoading = true);"},{"type":"INSERT","lineNumber":142,"content":"    setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":148,"oldContent":"  }"},{"type":"DELETE","lineNumber":149,"oldContent":""},{"type":"INSERT","lineNumber":192,"content":"  }"},{"type":"INSERT","lineNumber":193,"content":""},{"type":"DELETE","lineNumber":244,"oldContent":"  void _startResendTimer() {"},{"type":"DELETE","lineNumber":245,"oldContent":"    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"DELETE","lineNumber":251,"oldContent":"  Future<void> _handleOtpVerificationSuccess(User? user) async {"},{"type":"DELETE","lineNumber":252,"oldContent":"    if (user != null) {"},{"type":"DELETE","lineNumber":254,"oldContent":"      // Handle successful verification"},{"type":"DELETE","lineNumber":255,"oldContent":"      // You can navigate to the home screen or next screen here"},{"type":"DELETE","lineNumber":257,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":258,"oldContent":"        Navigator.of(context).pushReplacementNamed('/home');"},{"type":"DELETE","lineNumber":260,"oldContent":"      }"},{"type":"DELETE","lineNumber":261,"oldContent":"    }"},{"type":"DELETE","lineNumber":263,"oldContent":"  }"},{"type":"DELETE","lineNumber":265,"oldContent":"  Future<void> _verifyOtp() async {"},{"type":"DELETE","lineNumber":266,"oldContent":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"DELETE","lineNumber":268,"oldContent":"    if (otp.length != 6) {"},{"type":"DELETE","lineNumber":269,"oldContent":"      ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":271,"oldContent":"        const SnackBar("},{"type":"DELETE","lineNumber":272,"oldContent":"          content: Text('Please enter a valid 6-digit OTP'),"},{"type":"DELETE","lineNumber":274,"oldContent":"          behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":275,"oldContent":"        ),"},{"type":"DELETE","lineNumber":277,"oldContent":"      );"},{"type":"DELETE","lineNumber":278,"oldContent":"      return;"},{"type":"DELETE","lineNumber":280,"oldContent":"    }"},{"type":"DELETE","lineNumber":281,"oldContent":""},{"type":"DELETE","lineNumber":283,"oldContent":"    try {"},{"type":"DELETE","lineNumber":284,"oldContent":"      final credential = PhoneAuthProvider.credential("},{"type":"DELETE","lineNumber":286,"oldContent":"        verificationId: widget.verificationId,"},{"type":"DELETE","lineNumber":287,"oldContent":"        smsCode: otp,"},{"type":"DELETE","lineNumber":289,"oldContent":"      );"},{"type":"DELETE","lineNumber":290,"oldContent":"      "},{"type":"DELETE","lineNumber":292,"oldContent":"      final userCredential = await FirebaseAuth.instance.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":293,"oldContent":"      await _handleOtpVerificationSuccess(userCredential.user);"},{"type":"DELETE","lineNumber":295,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":296,"oldContent":"      String message = 'Verification failed. Please try again.';"},{"type":"DELETE","lineNumber":298,"oldContent":"      if (e.code == 'invalid-verification-code') {"},{"type":"DELETE","lineNumber":299,"oldContent":"        message = 'Invalid OTP. Please try again.';"},{"type":"DELETE","lineNumber":301,"oldContent":"      } else if (e.code == 'session-expired') {"},{"type":"DELETE","lineNumber":302,"oldContent":"        message = 'Session expired. Please request a new OTP.';"},{"type":"DELETE","lineNumber":304,"oldContent":"      }"},{"type":"DELETE","lineNumber":305,"oldContent":"      "},{"type":"DELETE","lineNumber":307,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":308,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":310,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":311,"oldContent":"            content: Text(message),"},{"type":"DELETE","lineNumber":313,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":314,"oldContent":"          ),"},{"type":"DELETE","lineNumber":316,"oldContent":"        );"},{"type":"DELETE","lineNumber":317,"oldContent":"      }"},{"type":"DELETE","lineNumber":319,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":320,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":322,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":323,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":325,"oldContent":"            content: Text('An error occurred. Please try again.'),"},{"type":"DELETE","lineNumber":326,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":328,"oldContent":"          ),"},{"type":"DELETE","lineNumber":329,"oldContent":"        );"},{"type":"DELETE","lineNumber":331,"oldContent":"      }"},{"type":"DELETE","lineNumber":332,"oldContent":"    }"},{"type":"DELETE","lineNumber":334,"oldContent":"  }"},{"type":"DELETE","lineNumber":335,"oldContent":""},{"type":"DELETE","lineNumber":337,"oldContent":"  Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":338,"oldContent":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":340,"oldContent":""},{"type":"DELETE","lineNumber":342,"oldContent":"    try {"},{"type":"DELETE","lineNumber":344,"oldContent":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":345,"oldContent":"      "},{"type":"DELETE","lineNumber":353,"oldContent":""},{"type":"DELETE","lineNumber":367,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":381,"oldContent":"class _OtpVerificationScreenState extends State<OtpVerificationScreen> {"},{"type":"DELETE","lineNumber":382,"oldContent":"  final List<TextEditingController> _otpControllers ="},{"type":"DELETE","lineNumber":383,"oldContent":"      List.generate(6, (index) => TextEditingController());"},{"type":"DELETE","lineNumber":384,"oldContent":"  final List<FocusNode> _focusNodes = List.generate(6, (index) => FocusNode());"},{"type":"DELETE","lineNumber":385,"oldContent":"  late AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":386,"oldContent":"  bool _isResendLoading = false;"},{"type":"DELETE","lineNumber":387,"oldContent":"  int _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":388,"oldContent":"  late Timer _resendTimer;"},{"type":"DELETE","lineNumber":389,"oldContent":""},{"type":"DELETE","lineNumber":390,"oldContent":"  @override"},{"type":"DELETE","lineNumber":391,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":392,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":393,"oldContent":"    _viewModel = context.read<AuthViewModel>();"},{"type":"DELETE","lineNumber":394,"oldContent":"    _viewModel.addListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":395,"oldContent":"    _startResendTimer();"},{"type":"DELETE","lineNumber":396,"oldContent":"    "},{"type":"DELETE","lineNumber":397,"oldContent":"    // Auto-focus the first OTP field"},{"type":"DELETE","lineNumber":398,"oldContent":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"DELETE","lineNumber":399,"oldContent":"  @override"},{"type":"DELETE","lineNumber":400,"oldContent":"      if (mounted && _focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":401,"oldContent":"        _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":402,"oldContent":"      }"},{"type":"DELETE","lineNumber":403,"oldContent":"    });"},{"type":"DELETE","lineNumber":404,"oldContent":"  }"},{"type":"DELETE","lineNumber":405,"oldContent":""},{"type":"DELETE","lineNumber":406,"oldContent":"  @override"},{"type":"DELETE","lineNumber":407,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":408,"oldContent":"    for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":409,"oldContent":"      controller.dispose();"},{"type":"DELETE","lineNumber":410,"oldContent":"    }"},{"type":"DELETE","lineNumber":411,"oldContent":"    for (var node in _focusNodes) {"},{"type":"DELETE","lineNumber":412,"oldContent":"      node.dispose();"},{"type":"DELETE","lineNumber":413,"oldContent":"    }"},{"type":"DELETE","lineNumber":414,"oldContent":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":415,"oldContent":"    _resendTimer.cancel();"},{"type":"DELETE","lineNumber":416,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":417,"oldContent":"  }"},{"type":"DELETE","lineNumber":418,"oldContent":""},{"type":"DELETE","lineNumber":419,"oldContent":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":420,"oldContent":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"DELETE","lineNumber":421,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":422,"oldContent":"                  (index) => SizedBox("},{"type":"DELETE","lineNumber":423,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":424,"oldContent":"                    width: 50,"},{"type":"DELETE","lineNumber":425,"oldContent":"                    child: TextField("},{"type":"DELETE","lineNumber":426,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":427,"oldContent":"                      controller: _otpControllers[index],"},{"type":"DELETE","lineNumber":428,"oldContent":"                      focusNode: _focusNodes[index],"},{"type":"DELETE","lineNumber":429,"oldContent":"            content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":430,"oldContent":"                      keyboardType: TextInputType.number,"},{"type":"DELETE","lineNumber":431,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":432,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":433,"oldContent":"                      maxLength: 1,"},{"type":"DELETE","lineNumber":434,"oldContent":"          ),"},{"type":"DELETE","lineNumber":435,"oldContent":"                      onChanged: (value) => _onOtpChanged(value, index),"},{"type":"DELETE","lineNumber":436,"oldContent":"                      decoration: const InputDecoration("},{"type":"DELETE","lineNumber":437,"oldContent":"        );"},{"type":"DELETE","lineNumber":438,"oldContent":"                        counterText: '',"},{"type":"DELETE","lineNumber":439,"oldContent":"        _viewModel.setError();"},{"type":"DELETE","lineNumber":440,"oldContent":"                        border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":441,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":442,"oldContent":"      }"},{"type":"DELETE","lineNumber":443,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":444,"oldContent":"    }"},{"type":"DELETE","lineNumber":445,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":446,"oldContent":"  }"},{"type":"DELETE","lineNumber":447,"oldContent":""},{"type":"DELETE","lineNumber":448,"oldContent":"      if (_resendCodeIn > 0) {"},{"type":"DELETE","lineNumber":449,"oldContent":"        setState(() => _resendCodeIn--);"},{"type":"DELETE","lineNumber":450,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":451,"oldContent":"        _resendTimer.cancel();"},{"type":"DELETE","lineNumber":452,"oldContent":"      }"},{"type":"DELETE","lineNumber":453,"oldContent":"    });"},{"type":"DELETE","lineNumber":454,"oldContent":"  }"},{"type":"DELETE","lineNumber":455,"oldContent":""},{"type":"DELETE","lineNumber":456,"oldContent":""},{"type":"DELETE","lineNumber":457,"oldContent":"    setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":458,"oldContent":""},{"type":"DELETE","lineNumber":459,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":460,"oldContent":"        // Clear OTP fields"},{"type":"DELETE","lineNumber":461,"oldContent":"        for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":462,"oldContent":"          controller.clear();"},{"type":"DELETE","lineNumber":463,"oldContent":"        }"},{"type":"DELETE","lineNumber":464,"oldContent":"        "},{"type":"DELETE","lineNumber":465,"oldContent":"        // Focus first field"},{"type":"DELETE","lineNumber":466,"oldContent":"        if (_focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":467,"oldContent":"          _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":468,"oldContent":"        }"},{"type":"DELETE","lineNumber":469,"oldContent":"        if (success) {"},{"type":"DELETE","lineNumber":470,"oldContent":"          // Reset timer"},{"type":"DELETE","lineNumber":471,"oldContent":"          setState(() => _resendCodeIn = 30);"},{"type":"DELETE","lineNumber":472,"oldContent":"          _startResendTimer();"},{"type":"DELETE","lineNumber":473,"oldContent":"          "},{"type":"DELETE","lineNumber":474,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":475,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":476,"oldContent":"              content: Text('OTP has been resent successfully'),"},{"type":"DELETE","lineNumber":477,"oldContent":""},{"type":"DELETE","lineNumber":478,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":479,"oldContent":"class _OtpVerificationScreenState extends State<OtpVerificationScreen> {"},{"type":"DELETE","lineNumber":480,"oldContent":"            ),"},{"type":"DELETE","lineNumber":481,"oldContent":"  final List<TextEditingController> _otpControllers ="},{"type":"DELETE","lineNumber":482,"oldContent":"          );"},{"type":"DELETE","lineNumber":483,"oldContent":"      List.generate(6, (index) => TextEditingController());"},{"type":"DELETE","lineNumber":484,"oldContent":"        } else if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"DELETE","lineNumber":485,"oldContent":"  final List<FocusNode> _focusNodes = List.generate(6, (index) => FocusNode());"},{"type":"DELETE","lineNumber":486,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":487,"oldContent":"  late AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":488,"oldContent":"            SnackBar("},{"type":"DELETE","lineNumber":489,"oldContent":"  bool _isResendLoading = false;"},{"type":"DELETE","lineNumber":490,"oldContent":"  int _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":491,"oldContent":"              content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":492,"oldContent":"  late Timer _resendTimer;"},{"type":"DELETE","lineNumber":493,"oldContent":""},{"type":"DELETE","lineNumber":494,"oldContent":"  @override"},{"type":"DELETE","lineNumber":495,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":496,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":497,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":498,"oldContent":"            ),"},{"type":"DELETE","lineNumber":499,"oldContent":"    _viewModel = context.read<AuthViewModel>();"},{"type":"DELETE","lineNumber":500,"oldContent":"    _viewModel.addListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":501,"oldContent":"    _startResendTimer();"},{"type":"DELETE","lineNumber":502,"oldContent":"          );"},{"type":"DELETE","lineNumber":503,"oldContent":"    "},{"type":"DELETE","lineNumber":504,"oldContent":"    // Auto-focus the first OTP field"},{"type":"DELETE","lineNumber":505,"oldContent":"        }"},{"type":"DELETE","lineNumber":506,"oldContent":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"DELETE","lineNumber":507,"oldContent":"      if (mounted && _focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":508,"oldContent":"        _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":509,"oldContent":"      }"},{"type":"DELETE","lineNumber":510,"oldContent":"      }"},{"type":"DELETE","lineNumber":511,"oldContent":"    });"},{"type":"DELETE","lineNumber":512,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":513,"oldContent":"  }"},{"type":"DELETE","lineNumber":514,"oldContent":""},{"type":"DELETE","lineNumber":515,"oldContent":"  @override"},{"type":"DELETE","lineNumber":516,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":517,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":518,"oldContent":"    for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":519,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":520,"oldContent":"      controller.dispose();"},{"type":"DELETE","lineNumber":521,"oldContent":"    }"},{"type":"DELETE","lineNumber":522,"oldContent":"    for (var node in _focusNodes) {"},{"type":"DELETE","lineNumber":523,"oldContent":"            content: Text('Failed to resend OTP. Please try again.'),"},{"type":"DELETE","lineNumber":524,"oldContent":"      node.dispose();"},{"type":"DELETE","lineNumber":525,"oldContent":"    }"},{"type":"DELETE","lineNumber":526,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":527,"oldContent":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":528,"oldContent":"    _resendTimer.cancel();"},{"type":"DELETE","lineNumber":529,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":530,"oldContent":"          ),"},{"type":"DELETE","lineNumber":531,"oldContent":"  }"},{"type":"DELETE","lineNumber":532,"oldContent":""},{"type":"DELETE","lineNumber":533,"oldContent":"        );"},{"type":"DELETE","lineNumber":534,"oldContent":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":535,"oldContent":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"DELETE","lineNumber":536,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":537,"oldContent":"      }"},{"type":"DELETE","lineNumber":538,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":539,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":540,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":541,"oldContent":"            content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":542,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":543,"oldContent":"          ),"},{"type":"DELETE","lineNumber":544,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":545,"oldContent":"        );"},{"type":"DELETE","lineNumber":546,"oldContent":"        _viewModel.setError();"},{"type":"DELETE","lineNumber":547,"oldContent":"        setState(() => _isResendLoading = false);"},{"type":"DELETE","lineNumber":548,"oldContent":"      }"},{"type":"DELETE","lineNumber":549,"oldContent":"    }"},{"type":"DELETE","lineNumber":550,"oldContent":"  }"},{"type":"DELETE","lineNumber":551,"oldContent":"      }"},{"type":"DELETE","lineNumber":552,"oldContent":""},{"type":"DELETE","lineNumber":553,"oldContent":"  void _startResendTimer() {"},{"type":"DELETE","lineNumber":554,"oldContent":"    }"},{"type":"DELETE","lineNumber":555,"oldContent":"    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"DELETE","lineNumber":556,"oldContent":"      if (_resendCodeIn > 0) {"},{"type":"DELETE","lineNumber":557,"oldContent":"        setState(() => _resendCodeIn--);"},{"type":"DELETE","lineNumber":558,"oldContent":"  }"},{"type":"DELETE","lineNumber":559,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":560,"oldContent":"        _resendTimer.cancel();"},{"type":"DELETE","lineNumber":561,"oldContent":""},{"type":"DELETE","lineNumber":562,"oldContent":"      }"},{"type":"DELETE","lineNumber":563,"oldContent":"    });"},{"type":"DELETE","lineNumber":564,"oldContent":"  }"},{"type":"DELETE","lineNumber":565,"oldContent":"  void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":566,"oldContent":""},{"type":"DELETE","lineNumber":567,"oldContent":"  Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":568,"oldContent":"    if (value.length == 1 && index < _otpControllers.length - 1) {"},{"type":"DELETE","lineNumber":569,"oldContent":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":570,"oldContent":""},{"type":"DELETE","lineNumber":571,"oldContent":"    setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":572,"oldContent":"      _focusNodes[index + 1].requestFocus();"},{"type":"DELETE","lineNumber":573,"oldContent":""},{"type":"DELETE","lineNumber":574,"oldContent":"    try {"},{"type":"DELETE","lineNumber":575,"oldContent":"    } else if (value.isEmpty && index > 0) {"},{"type":"DELETE","lineNumber":576,"oldContent":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":577,"oldContent":"      "},{"type":"DELETE","lineNumber":578,"oldContent":"      _focusNodes[index - 1].requestFocus();"},{"type":"DELETE","lineNumber":579,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":580,"oldContent":"        // Clear OTP fields"},{"type":"DELETE","lineNumber":581,"oldContent":"    }"},{"type":"DELETE","lineNumber":582,"oldContent":"        for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":583,"oldContent":"          controller.clear();"},{"type":"DELETE","lineNumber":584,"oldContent":"        }"},{"type":"DELETE","lineNumber":585,"oldContent":"  }"},{"type":"DELETE","lineNumber":586,"oldContent":"        "},{"type":"DELETE","lineNumber":587,"oldContent":"        // Focus first field"},{"type":"DELETE","lineNumber":588,"oldContent":""},{"type":"DELETE","lineNumber":589,"oldContent":"        if (_focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":590,"oldContent":"          _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":591,"oldContent":"        }"},{"type":"DELETE","lineNumber":592,"oldContent":"  Future<bool> _onWillPop() async {"},{"type":"DELETE","lineNumber":593,"oldContent":""},{"type":"DELETE","lineNumber":594,"oldContent":"        if (success) {"},{"type":"DELETE","lineNumber":595,"oldContent":"    if (_viewModel.isLoading) return false;"},{"type":"DELETE","lineNumber":596,"oldContent":"          // Reset timer"},{"type":"DELETE","lineNumber":597,"oldContent":"          setState(() => _resendCodeIn = 30);"},{"type":"DELETE","lineNumber":598,"oldContent":"    "},{"type":"DELETE","lineNumber":599,"oldContent":"          _startResendTimer();"},{"type":"DELETE","lineNumber":600,"oldContent":"          "},{"type":"DELETE","lineNumber":601,"oldContent":"    final shouldPop = await showDialog<bool>("},{"type":"DELETE","lineNumber":602,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":603,"oldContent":"      context: context,"},{"type":"DELETE","lineNumber":604,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":605,"oldContent":"      builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":606,"oldContent":"              content: Text('OTP has been resent successfully'),"},{"type":"DELETE","lineNumber":607,"oldContent":"        title: const Text('Are you sure?'),"},{"type":"DELETE","lineNumber":608,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":609,"oldContent":"            ),"},{"type":"DELETE","lineNumber":610,"oldContent":"        content: const Text('Do you want to cancel OTP verification?'),"},{"type":"DELETE","lineNumber":611,"oldContent":"          );"},{"type":"DELETE","lineNumber":612,"oldContent":"        } else if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"DELETE","lineNumber":613,"oldContent":"        actions: ["},{"type":"DELETE","lineNumber":614,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":615,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":616,"oldContent":"            SnackBar("},{"type":"DELETE","lineNumber":617,"oldContent":"            onPressed: () => Navigator.of(context).pop(false),"},{"type":"DELETE","lineNumber":618,"oldContent":"              content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":619,"oldContent":"            child: const Text('No'),"},{"type":"DELETE","lineNumber":620,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":621,"oldContent":"          ),"},{"type":"DELETE","lineNumber":622,"oldContent":"            ),"},{"type":"DELETE","lineNumber":623,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":624,"oldContent":"          );"},{"type":"DELETE","lineNumber":625,"oldContent":"            onPressed: () {"},{"type":"DELETE","lineNumber":626,"oldContent":"        }"},{"type":"DELETE","lineNumber":627,"oldContent":"              _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":628,"oldContent":"      }"},{"type":"DELETE","lineNumber":629,"oldContent":"              Navigator.of(context).pop(true);"},{"type":"DELETE","lineNumber":630,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":631,"oldContent":"            },"},{"type":"DELETE","lineNumber":632,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":633,"oldContent":"            child: const Text('Yes'),"},{"type":"DELETE","lineNumber":634,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":635,"oldContent":"          ),"},{"type":"DELETE","lineNumber":636,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":637,"oldContent":"        ],"},{"type":"DELETE","lineNumber":638,"oldContent":"            content: Text('Failed to resend OTP. Please try again.'),"},{"type":"DELETE","lineNumber":639,"oldContent":"      ),"},{"type":"DELETE","lineNumber":640,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":641,"oldContent":"    );"},{"type":"DELETE","lineNumber":642,"oldContent":"          ),"},{"type":"DELETE","lineNumber":643,"oldContent":"    "},{"type":"DELETE","lineNumber":644,"oldContent":"        );"},{"type":"DELETE","lineNumber":645,"oldContent":"    return shouldPop ?? false;"},{"type":"DELETE","lineNumber":646,"oldContent":"      }"},{"type":"DELETE","lineNumber":647,"oldContent":"  }"},{"type":"DELETE","lineNumber":648,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":649,"oldContent":""},{"type":"DELETE","lineNumber":650,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":651,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":652,"oldContent":"        setState(() => _isResendLoading = false);"},{"type":"DELETE","lineNumber":653,"oldContent":"    return WillPopScope("},{"type":"DELETE","lineNumber":654,"oldContent":"      }"},{"type":"DELETE","lineNumber":655,"oldContent":"      onWillPop: _onWillPop,"},{"type":"DELETE","lineNumber":656,"oldContent":"    }"},{"type":"DELETE","lineNumber":657,"oldContent":"      child: Scaffold("},{"type":"DELETE","lineNumber":658,"oldContent":"  }"},{"type":"DELETE","lineNumber":659,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":660,"oldContent":""},{"type":"DELETE","lineNumber":661,"oldContent":"          title: const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":662,"oldContent":"  void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":663,"oldContent":"          leading: IconButton("},{"type":"DELETE","lineNumber":664,"oldContent":"    if (value.length == 1 && index < _otpControllers.length - 1) {"},{"type":"DELETE","lineNumber":665,"oldContent":"            icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":666,"oldContent":"      _focusNodes[index + 1].requestFocus();"},{"type":"DELETE","lineNumber":667,"oldContent":"            onPressed: () => _onWillPop().then((value) {"},{"type":"DELETE","lineNumber":668,"oldContent":"    } else if (value.isEmpty && index > 0) {"},{"type":"DELETE","lineNumber":669,"oldContent":"              if (value) {"},{"type":"DELETE","lineNumber":670,"oldContent":"      _focusNodes[index - 1].requestFocus();"},{"type":"DELETE","lineNumber":671,"oldContent":"                Navigator.of(context).pop();"},{"type":"DELETE","lineNumber":672,"oldContent":"    }"},{"type":"DELETE","lineNumber":673,"oldContent":"              }"},{"type":"DELETE","lineNumber":674,"oldContent":"  }"},{"type":"DELETE","lineNumber":675,"oldContent":"            }),"},{"type":"DELETE","lineNumber":676,"oldContent":""},{"type":"DELETE","lineNumber":677,"oldContent":"          ),"},{"type":"DELETE","lineNumber":678,"oldContent":"  Future<bool> _onWillPop() async {"},{"type":"DELETE","lineNumber":679,"oldContent":"        ),"},{"type":"DELETE","lineNumber":680,"oldContent":"    if (_viewModel.isLoading) return false;"},{"type":"DELETE","lineNumber":681,"oldContent":"        body: SingleChildScrollView("},{"type":"DELETE","lineNumber":682,"oldContent":"    "},{"type":"DELETE","lineNumber":683,"oldContent":"          padding: const EdgeInsets.all(16.0),"},{"type":"DELETE","lineNumber":684,"oldContent":"    final shouldPop = await showDialog<bool>("},{"type":"DELETE","lineNumber":685,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":686,"oldContent":"      context: context,"},{"type":"DELETE","lineNumber":687,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":688,"oldContent":"      builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":689,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":690,"oldContent":"        title: const Text('Are you sure?'),"},{"type":"DELETE","lineNumber":691,"oldContent":"              const Text("},{"type":"DELETE","lineNumber":692,"oldContent":"        content: const Text('Do you want to cancel OTP verification?'),"},{"type":"DELETE","lineNumber":693,"oldContent":"                'Enter OTP',"},{"type":"DELETE","lineNumber":694,"oldContent":"        actions: ["},{"type":"DELETE","lineNumber":695,"oldContent":"                style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),"},{"type":"DELETE","lineNumber":696,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":697,"oldContent":"              ),"},{"type":"DELETE","lineNumber":698,"oldContent":"            onPressed: () => Navigator.of(context).pop(false),"},{"type":"DELETE","lineNumber":699,"oldContent":"              const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":700,"oldContent":"            child: const Text('No'),"},{"type":"DELETE","lineNumber":701,"oldContent":"              Text("},{"type":"DELETE","lineNumber":702,"oldContent":"          ),"},{"type":"DELETE","lineNumber":703,"oldContent":"                'We have sent an OTP to +91 ${widget.phoneNumber}',"},{"type":"DELETE","lineNumber":704,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":705,"oldContent":"                textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":706,"oldContent":"            onPressed: () {"},{"type":"DELETE","lineNumber":707,"oldContent":"                style: const TextStyle(fontSize: 16, color: Colors.grey),"},{"type":"DELETE","lineNumber":708,"oldContent":"              _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":709,"oldContent":"              ),"},{"type":"DELETE","lineNumber":710,"oldContent":"              Navigator.of(context).pop(true);"},{"type":"DELETE","lineNumber":711,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":712,"oldContent":"            },"},{"type":"DELETE","lineNumber":713,"oldContent":"              Row("},{"type":"DELETE","lineNumber":714,"oldContent":"            child: const Text('Yes'),"},{"type":"DELETE","lineNumber":715,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"DELETE","lineNumber":716,"oldContent":"          ),"},{"type":"DELETE","lineNumber":717,"oldContent":"                children: List.generate("},{"type":"DELETE","lineNumber":718,"oldContent":"        ],"},{"type":"DELETE","lineNumber":719,"oldContent":"                  6,"},{"type":"DELETE","lineNumber":720,"oldContent":"      ),"},{"type":"DELETE","lineNumber":721,"oldContent":"                ),"},{"type":"DELETE","lineNumber":722,"oldContent":"    );"},{"type":"DELETE","lineNumber":723,"oldContent":"              ),"},{"type":"DELETE","lineNumber":724,"oldContent":"    "},{"type":"DELETE","lineNumber":725,"oldContent":"    return shouldPop ?? false;"},{"type":"DELETE","lineNumber":726,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":727,"oldContent":"  }"},{"type":"DELETE","lineNumber":728,"oldContent":"              ElevatedButton("},{"type":"DELETE","lineNumber":729,"oldContent":""},{"type":"DELETE","lineNumber":730,"oldContent":"  @override"},{"type":"DELETE","lineNumber":731,"oldContent":"                onPressed: _viewModel.isLoading ? null : _verifyOtp,"},{"type":"DELETE","lineNumber":732,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":733,"oldContent":"                child: _viewModel.isLoading"},{"type":"DELETE","lineNumber":734,"oldContent":"    return WillPopScope("},{"type":"DELETE","lineNumber":735,"oldContent":"      onWillPop: _onWillPop,"},{"type":"DELETE","lineNumber":736,"oldContent":"                    ? const CircularProgressIndicator()"},{"type":"DELETE","lineNumber":737,"oldContent":"      child: Scaffold("},{"type":"DELETE","lineNumber":738,"oldContent":"                    : const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":739,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":740,"oldContent":"          title: const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":741,"oldContent":"              ),"},{"type":"DELETE","lineNumber":742,"oldContent":"          leading: IconButton("},{"type":"DELETE","lineNumber":743,"oldContent":"              const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":744,"oldContent":"            icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":745,"oldContent":"            onPressed: () => _onWillPop().then((value) {"},{"type":"DELETE","lineNumber":746,"oldContent":"              TextButton("},{"type":"DELETE","lineNumber":747,"oldContent":"              if (value) {"},{"type":"DELETE","lineNumber":748,"oldContent":"                onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"DELETE","lineNumber":749,"oldContent":"                Navigator.of(context).pop();"},{"type":"DELETE","lineNumber":750,"oldContent":"              }"},{"type":"DELETE","lineNumber":751,"oldContent":"                child: _isResendLoading"},{"type":"DELETE","lineNumber":752,"oldContent":"            }),"},{"type":"DELETE","lineNumber":753,"oldContent":"                    ? const CircularProgressIndicator()"},{"type":"DELETE","lineNumber":754,"oldContent":"          ),"},{"type":"DELETE","lineNumber":755,"oldContent":"        ),"},{"type":"DELETE","lineNumber":756,"oldContent":"                    : Text("},{"type":"DELETE","lineNumber":757,"oldContent":"        body: SingleChildScrollView("},{"type":"DELETE","lineNumber":758,"oldContent":"                        _resendCodeIn > 0"},{"type":"DELETE","lineNumber":759,"oldContent":"          padding: const EdgeInsets.all(16.0),"},{"type":"DELETE","lineNumber":760,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":761,"oldContent":"                            ? 'Resend code in $_resendCodeIn seconds'"},{"type":"DELETE","lineNumber":762,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":763,"oldContent":"                            : 'Resend OTP',"},{"type":"DELETE","lineNumber":764,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":765,"oldContent":"              const Text("},{"type":"DELETE","lineNumber":766,"oldContent":"                        style: TextStyle("},{"type":"DELETE","lineNumber":767,"oldContent":"                'Enter OTP',"},{"type":"DELETE","lineNumber":768,"oldContent":"                          color: _resendCodeIn == 0"},{"type":"DELETE","lineNumber":769,"oldContent":"                style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),"},{"type":"DELETE","lineNumber":770,"oldContent":"                              ? Theme.of(context).primaryColor"},{"type":"DELETE","lineNumber":771,"oldContent":"              const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":772,"oldContent":"                              : Colors.grey,"},{"type":"DELETE","lineNumber":773,"oldContent":"              Text("},{"type":"DELETE","lineNumber":774,"oldContent":"                'We have sent an OTP to +91 ${widget.phoneNumber}',"},{"type":"DELETE","lineNumber":775,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":776,"oldContent":"                textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":777,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":778,"oldContent":"                style: const TextStyle(fontSize: 16, color: Colors.grey),"},{"type":"DELETE","lineNumber":779,"oldContent":"              ),"},{"type":"DELETE","lineNumber":780,"oldContent":"              ),"},{"type":"DELETE","lineNumber":781,"oldContent":"            ],"},{"type":"DELETE","lineNumber":782,"oldContent":"              Row("},{"type":"DELETE","lineNumber":783,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"DELETE","lineNumber":784,"oldContent":"          ),"},{"type":"DELETE","lineNumber":785,"oldContent":"                children: List.generate("},{"type":"DELETE","lineNumber":786,"oldContent":"        ),"},{"type":"DELETE","lineNumber":787,"oldContent":"                  6,"},{"type":"DELETE","lineNumber":788,"oldContent":"                  (index) => SizedBox("},{"type":"DELETE","lineNumber":789,"oldContent":"      ),"},{"type":"DELETE","lineNumber":790,"oldContent":"                    width: 50,"},{"type":"DELETE","lineNumber":791,"oldContent":"    );"},{"type":"DELETE","lineNumber":792,"oldContent":"                    child: TextField("},{"type":"DELETE","lineNumber":793,"oldContent":"                      controller: _otpControllers[index],"},{"type":"DELETE","lineNumber":794,"oldContent":"  }"},{"type":"DELETE","lineNumber":795,"oldContent":"                      focusNode: _focusNodes[index],"},{"type":"DELETE","lineNumber":796,"oldContent":"                      keyboardType: TextInputType.number,"},{"type":"DELETE","lineNumber":797,"oldContent":"}"},{"type":"DELETE","lineNumber":798,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":799,"oldContent":"              ),"},{"type":"DELETE","lineNumber":800,"oldContent":"                      maxLength: 1,"},{"type":"DELETE","lineNumber":801,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":802,"oldContent":"                      onChanged: (value) => _onOtpChanged(value, index),"},{"type":"DELETE","lineNumber":803,"oldContent":"              ElevatedButton("},{"type":"DELETE","lineNumber":804,"oldContent":"                      decoration: const InputDecoration("},{"type":"DELETE","lineNumber":805,"oldContent":"                onPressed: _viewModel.isLoading ? null : _verifyOtp,"},{"type":"DELETE","lineNumber":806,"oldContent":"                        counterText: '',"},{"type":"DELETE","lineNumber":807,"oldContent":"                child: _viewModel.isLoading"},{"type":"DELETE","lineNumber":808,"oldContent":"                        border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":809,"oldContent":"                    ? const CircularProgressIndicator()"},{"type":"DELETE","lineNumber":810,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":811,"oldContent":"                    : const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":812,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":813,"oldContent":"              ),"},{"type":"DELETE","lineNumber":814,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":815,"oldContent":"              const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":816,"oldContent":"                ),"},{"type":"DELETE","lineNumber":817,"oldContent":"              TextButton("},{"type":"DELETE","lineNumber":818,"oldContent":"              ),"},{"type":"DELETE","lineNumber":819,"oldContent":"                onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"DELETE","lineNumber":820,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":821,"oldContent":"                child: _isResendLoading"},{"type":"DELETE","lineNumber":822,"oldContent":"                    ? const CircularProgressIndicator()"},{"type":"DELETE","lineNumber":823,"oldContent":"                    : Text("},{"type":"DELETE","lineNumber":824,"oldContent":"                        _resendCodeIn > 0"},{"type":"DELETE","lineNumber":825,"oldContent":"                            ? 'Resend code in $_resendCodeIn seconds'"},{"type":"DELETE","lineNumber":826,"oldContent":"                            : 'Resend OTP',"},{"type":"DELETE","lineNumber":827,"oldContent":"                        style: TextStyle("},{"type":"DELETE","lineNumber":828,"oldContent":"                          color: _resendCodeIn == 0"},{"type":"DELETE","lineNumber":829,"oldContent":"                              ? Theme.of(context).primaryColor"},{"type":"DELETE","lineNumber":830,"oldContent":"                              : Colors.grey,"},{"type":"DELETE","lineNumber":831,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":832,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":833,"oldContent":"              ),"},{"type":"DELETE","lineNumber":834,"oldContent":"            ],"},{"type":"DELETE","lineNumber":835,"oldContent":"          ),"},{"type":"DELETE","lineNumber":836,"oldContent":"        ),"},{"type":"DELETE","lineNumber":837,"oldContent":"      ),"},{"type":"DELETE","lineNumber":838,"oldContent":"    );"},{"type":"DELETE","lineNumber":839,"oldContent":"  }"},{"type":"DELETE","lineNumber":840,"oldContent":"  final List<TextEditingController> _otpControllers ="},{"type":"DELETE","lineNumber":841,"oldContent":"      List.generate(6, (index) => TextEditingController());"},{"type":"DELETE","lineNumber":842,"oldContent":"  final List<FocusNode> _focusNodes = List.generate(6, (index) => FocusNode());"},{"type":"DELETE","lineNumber":843,"oldContent":"  late AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":844,"oldContent":"  bool _isResendLoading = false;"},{"type":"DELETE","lineNumber":845,"oldContent":"  int _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":846,"oldContent":"  late Timer _resendTimer;"},{"type":"DELETE","lineNumber":847,"oldContent":""},{"type":"DELETE","lineNumber":848,"oldContent":"  @override"},{"type":"DELETE","lineNumber":849,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":850,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":851,"oldContent":"    _viewModel = context.read<AuthViewModel>();"},{"type":"DELETE","lineNumber":852,"oldContent":"    _viewModel.addListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":853,"oldContent":"    _startResendTimer();"},{"type":"DELETE","lineNumber":854,"oldContent":"    "},{"type":"DELETE","lineNumber":855,"oldContent":"    // Auto-focus the first OTP field"},{"type":"DELETE","lineNumber":856,"oldContent":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"DELETE","lineNumber":857,"oldContent":"      if (mounted && _focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":858,"oldContent":"        _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":859,"oldContent":"      }"},{"type":"DELETE","lineNumber":860,"oldContent":"    });"},{"type":"DELETE","lineNumber":861,"oldContent":"  }"},{"type":"DELETE","lineNumber":862,"oldContent":""},{"type":"DELETE","lineNumber":863,"oldContent":"  @override"},{"type":"DELETE","lineNumber":864,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":865,"oldContent":"    for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":866,"oldContent":"      controller.dispose();"},{"type":"DELETE","lineNumber":867,"oldContent":"    }"},{"type":"DELETE","lineNumber":868,"oldContent":"    for (var node in _focusNodes) {"},{"type":"DELETE","lineNumber":869,"oldContent":"      node.dispose();"},{"type":"DELETE","lineNumber":870,"oldContent":"    }"},{"type":"DELETE","lineNumber":871,"oldContent":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":872,"oldContent":"    _resendTimer.cancel();"},{"type":"DELETE","lineNumber":873,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":874,"oldContent":"  }"},{"type":"DELETE","lineNumber":875,"oldContent":""},{"type":"DELETE","lineNumber":876,"oldContent":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":877,"oldContent":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"DELETE","lineNumber":878,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":879,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":880,"oldContent":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"DELETE","lineNumber":881,"oldContent":"        );"},{"type":"DELETE","lineNumber":882,"oldContent":"        _viewModel.setError();"},{"type":"DELETE","lineNumber":883,"oldContent":"      }"},{"type":"DELETE","lineNumber":884,"oldContent":"    }"},{"type":"DELETE","lineNumber":885,"oldContent":"  }"},{"type":"DELETE","lineNumber":886,"oldContent":""},{"type":"DELETE","lineNumber":887,"oldContent":"  void _startResendTimer() {"},{"type":"DELETE","lineNumber":888,"oldContent":"    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"DELETE","lineNumber":889,"oldContent":"      if (_resendCodeIn > 0) {"},{"type":"DELETE","lineNumber":890,"oldContent":"        setState(() => _resendCodeIn--);"},{"type":"DELETE","lineNumber":891,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":892,"oldContent":"        _resendTimer.cancel();"},{"type":"DELETE","lineNumber":893,"oldContent":"      }"},{"type":"DELETE","lineNumber":894,"oldContent":"    });"},{"type":"DELETE","lineNumber":895,"oldContent":"  }"},{"type":"DELETE","lineNumber":896,"oldContent":""},{"type":"DELETE","lineNumber":897,"oldContent":"  void _handleOtpVerificationSuccess(User? user) {"},{"type":"DELETE","lineNumber":898,"oldContent":"    if (!mounted) return;"},{"type":"DELETE","lineNumber":899,"oldContent":"    "},{"type":"DELETE","lineNumber":900,"oldContent":"    // Check if the user has a display name (indicates successful registration)"},{"type":"DELETE","lineNumber":901,"oldContent":"    if (user?.displayName?.isNotEmpty ?? false) {"},{"type":"DELETE","lineNumber":902,"oldContent":"      // Navigate to home or family setup based on user's family status"},{"type":"DELETE","lineNumber":903,"oldContent":"      final hasJoinedFamily = true; // TODO: Replace with actual check from user data"},{"type":"DELETE","lineNumber":904,"oldContent":"      "},{"type":"DELETE","lineNumber":905,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":906,"oldContent":"        if (hasJoinedFamily) {"},{"type":"DELETE","lineNumber":907,"oldContent":"          Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":908,"oldContent":"            context,"},{"type":"DELETE","lineNumber":909,"oldContent":"            AppConstants.homeRoute,"},{"type":"DELETE","lineNumber":910,"oldContent":"            (route) => false,"},{"type":"DELETE","lineNumber":911,"oldContent":"          );"},{"type":"DELETE","lineNumber":912,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":913,"oldContent":"          Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":914,"oldContent":"            context,"},{"type":"DELETE","lineNumber":915,"oldContent":"            AppConstants.joinOrCreateFamilyRoute,"},{"type":"DELETE","lineNumber":916,"oldContent":"            (route) => false,"},{"type":"DELETE","lineNumber":917,"oldContent":"          );"},{"type":"DELETE","lineNumber":918,"oldContent":"        }"},{"type":"DELETE","lineNumber":919,"oldContent":"      }"},{"type":"DELETE","lineNumber":920,"oldContent":"    } else {"},{"type":"DELETE","lineNumber":921,"oldContent":"      // If user doesn't have display name, registration might not be complete"},{"type":"DELETE","lineNumber":922,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":923,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":924,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":925,"oldContent":"            content: Text('Registration incomplete. Please try again.'),"},{"type":"DELETE","lineNumber":926,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":927,"oldContent":"          ),"},{"type":"DELETE","lineNumber":928,"oldContent":"        );"},{"type":"DELETE","lineNumber":929,"oldContent":"        // Redirect to registration screen"},{"type":"DELETE","lineNumber":930,"oldContent":"        Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":931,"oldContent":"          context,"},{"type":"DELETE","lineNumber":932,"oldContent":"          AppConstants.registerRoute,"},{"type":"DELETE","lineNumber":933,"oldContent":"          (route) => false,"},{"type":"DELETE","lineNumber":934,"oldContent":"        );"},{"type":"DELETE","lineNumber":935,"oldContent":"      }"},{"type":"DELETE","lineNumber":936,"oldContent":"    }"},{"type":"DELETE","lineNumber":937,"oldContent":"  }"},{"type":"DELETE","lineNumber":938,"oldContent":""},{"type":"DELETE","lineNumber":939,"oldContent":"  Future<void> _verifyOtp() async {"},{"type":"DELETE","lineNumber":940,"oldContent":"    if (_viewModel.isLoading) return;"},{"type":"DELETE","lineNumber":941,"oldContent":"    "},{"type":"DELETE","lineNumber":942,"oldContent":"    try {"},{"type":"DELETE","lineNumber":943,"oldContent":"      final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"DELETE","lineNumber":944,"oldContent":"      "},{"type":"DELETE","lineNumber":945,"oldContent":"      // Validate OTP format"},{"type":"DELETE","lineNumber":946,"oldContent":"      if (otp.length != 6 || !RegExp(r'^\\d{6}$').hasMatch(otp)) {"},{"type":"DELETE","lineNumber":947,"oldContent":"        if (mounted) {"},{"type":"DELETE","lineNumber":948,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":949,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":950,"oldContent":"              content: Text('Please enter a valid 6-digit OTP'),"},{"type":"DELETE","lineNumber":951,"oldContent":"              backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":952,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":953,"oldContent":"            ),"},{"type":"DELETE","lineNumber":954,"oldContent":"          );"},{"type":"DELETE","lineNumber":955,"oldContent":"        }"},{"type":"DELETE","lineNumber":956,"oldContent":"        return;"},{"type":"DELETE","lineNumber":957,"oldContent":"      }"},{"type":"DELETE","lineNumber":958,"oldContent":""},{"type":"DELETE","lineNumber":959,"oldContent":"      setState(() {});"},{"type":"DELETE","lineNumber":960,"oldContent":"      "},{"type":"DELETE","lineNumber":961,"oldContent":"      final success = await _viewModel.verifyOtpCode(otp);"},{"type":"DELETE","lineNumber":962,"oldContent":"      "},{"type":"DELETE","lineNumber":963,"oldContent":"      if (!mounted) return;"},{"type":"DELETE","lineNumber":964,"oldContent":"      "},{"type":"DELETE","lineNumber":965,"oldContent":"      if (success) {"},{"type":"DELETE","lineNumber":966,"oldContent":"        // Get the current user from Firebase Auth"},{"type":"DELETE","lineNumber":967,"oldContent":"        final currentUser = FirebaseAuth.instance.currentUser;"},{"type":"DELETE","lineNumber":968,"oldContent":"        "},{"type":"DELETE","lineNumber":969,"oldContent":"        if (currentUser != null) {"},{"type":"DELETE","lineNumber":970,"oldContent":"          _handleOtpVerificationSuccess(currentUser);"},{"type":"DELETE","lineNumber":971,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":972,"oldContent":"          // If no user is found, redirect to login"},{"type":"DELETE","lineNumber":973,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":974,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":975,"oldContent":"              const SnackBar("},{"type":"DELETE","lineNumber":976,"oldContent":"                content: Text('Session expired. Please login again.'),"},{"type":"DELETE","lineNumber":977,"oldContent":"                backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":978,"oldContent":"                behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":979,"oldContent":"              ),"},{"type":"DELETE","lineNumber":980,"oldContent":"            );"},{"type":"DELETE","lineNumber":981,"oldContent":"            Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":982,"oldContent":"              context,"},{"type":"DELETE","lineNumber":983,"oldContent":"              AppConstants.loginRoute,"},{"type":"DELETE","lineNumber":984,"oldContent":"              (route) => false,"},{"type":"DELETE","lineNumber":985,"oldContent":"            );"},{"type":"DELETE","lineNumber":986,"oldContent":"          }"},{"type":"DELETE","lineNumber":987,"oldContent":"        }"},{"type":"DELETE","lineNumber":988,"oldContent":"      } else if (mounted) {"},{"type":"DELETE","lineNumber":989,"oldContent":"        // Show error message if OTP verification fails"},{"type":"DELETE","lineNumber":990,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":991,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":992,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Invalid OTP. Please try again.'),"},{"type":"DELETE","lineNumber":993,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":994,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":995,"oldContent":"          ),"},{"type":"DELETE","lineNumber":996,"oldContent":"        );"},{"type":"DELETE","lineNumber":997,"oldContent":"      }"},{"type":"DELETE","lineNumber":998,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":999,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":1000,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":1001,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":1002,"oldContent":"            content: Text('An error occurred: ${e.toString()}'),"},{"type":"DELETE","lineNumber":1003,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":1004,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":1005,"oldContent":"          ),"},{"type":"DELETE","lineNumber":1006,"oldContent":"        );"},{"type":"DELETE","lineNumber":1007,"oldContent":"      }"},{"type":"DELETE","lineNumber":1008,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":1009,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":1010,"oldContent":"        setState(() {});"},{"type":"DELETE","lineNumber":1011,"oldContent":"      }"},{"type":"DELETE","lineNumber":1012,"oldContent":"    }"},{"type":"DELETE","lineNumber":1013,"oldContent":"  }"},{"type":"DELETE","lineNumber":1014,"oldContent":""},{"type":"DELETE","lineNumber":1015,"oldContent":"  Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":1016,"oldContent":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":1017,"oldContent":"    "},{"type":"DELETE","lineNumber":1018,"oldContent":"    setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":1019,"oldContent":""},{"type":"DELETE","lineNumber":1020,"oldContent":"    try {"},{"type":"DELETE","lineNumber":1021,"oldContent":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":1022,"oldContent":"      "},{"type":"DELETE","lineNumber":1023,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":1024,"oldContent":"        if (success) {"},{"type":"DELETE","lineNumber":1025,"oldContent":"          // Clear all OTP fields"},{"type":"DELETE","lineNumber":1026,"oldContent":"          for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":1027,"oldContent":"            controller.clear();"},{"type":"DELETE","lineNumber":1028,"oldContent":"          }"},{"type":"DELETE","lineNumber":1029,"oldContent":"          // Focus the first OTP field"},{"type":"DELETE","lineNumber":1030,"oldContent":"          if (_focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":1031,"oldContent":"            _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":1032,"oldContent":"          }"},{"type":"DELETE","lineNumber":1033,"oldContent":"          "},{"type":"DELETE","lineNumber":1034,"oldContent":"          // Show success message"},{"type":"DELETE","lineNumber":1035,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":1036,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":1037,"oldContent":"              content: Text('A new OTP has been sent to your phone number.'),"},{"type":"DELETE","lineNumber":1038,"oldContent":"              backgroundColor: Colors.green,"},{"type":"DELETE","lineNumber":1039,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":1040,"oldContent":"            ),"},{"type":"DELETE","lineNumber":1041,"oldContent":"          );"},{"type":"DELETE","lineNumber":1042,"oldContent":"          "},{"type":"DELETE","lineNumber":1043,"oldContent":"          // Reset the resend timer"},{"type":"DELETE","lineNumber":1044,"oldContent":"          setState(() {"},{"type":"DELETE","lineNumber":1045,"oldContent":"            _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":1046,"oldContent":"            _startResendTimer();"},{"type":"DELETE","lineNumber":1047,"oldContent":"          });"},{"type":"DELETE","lineNumber":1048,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":1049,"oldContent":"          // Show error message from view model"},{"type":"DELETE","lineNumber":1050,"oldContent":"          if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"DELETE","lineNumber":1051,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":1052,"oldContent":"              SnackBar("},{"type":"DELETE","lineNumber":1053,"oldContent":"                content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":1054,"oldContent":"                backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":1055,"oldContent":"                behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":1056,"oldContent":"              ),"},{"type":"DELETE","lineNumber":1057,"oldContent":"            );"},{"type":"DELETE","lineNumber":1058,"oldContent":"          }"},{"type":"DELETE","lineNumber":1059,"oldContent":"        }"},{"type":"DELETE","lineNumber":1060,"oldContent":"      }"},{"type":"DELETE","lineNumber":1061,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":1062,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":1063,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":1064,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":1065,"oldContent":"            content: Text('Failed to resend OTP: ${e.toString()}'),"},{"type":"DELETE","lineNumber":1066,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":1067,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":1068,"oldContent":"          ),"},{"type":"DELETE","lineNumber":1069,"oldContent":"        );"},{"type":"DELETE","lineNumber":1070,"oldContent":"      }"},{"type":"DELETE","lineNumber":1071,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":1072,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":1073,"oldContent":"        setState(() => _isResendLoading = false);"},{"type":"DELETE","lineNumber":1074,"oldContent":"      }"},{"type":"DELETE","lineNumber":1075,"oldContent":"    }"},{"type":"DELETE","lineNumber":1076,"oldContent":"  }"},{"type":"DELETE","lineNumber":1077,"oldContent":""},{"type":"DELETE","lineNumber":1078,"oldContent":"  void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":1079,"oldContent":"    if (value.length == 1 && index < 5) {"},{"type":"DELETE","lineNumber":1080,"oldContent":"      _focusNodes[index + 1].requestFocus();"},{"type":"DELETE","lineNumber":1081,"oldContent":"    } else if (value.isEmpty && index > 0) {"},{"type":"DELETE","lineNumber":1082,"oldContent":"      _focusNodes[index - 1].requestFocus();"},{"type":"DELETE","lineNumber":1083,"oldContent":"    }"},{"type":"DELETE","lineNumber":1084,"oldContent":"  }"},{"type":"DELETE","lineNumber":1085,"oldContent":""},{"type":"DELETE","lineNumber":1086,"oldContent":"  Future<bool> _onWillPop() async {"},{"type":"DELETE","lineNumber":1087,"oldContent":"    // Prevent back navigation if OTP verification is in progress"},{"type":"DELETE","lineNumber":1088,"oldContent":"    if (_viewModel.isLoading) return false;"},{"type":"DELETE","lineNumber":1089,"oldContent":"    "},{"type":"DELETE","lineNumber":1090,"oldContent":"    // Show confirmation dialog when trying to go back"},{"type":"DELETE","lineNumber":1091,"oldContent":"    final shouldPop = await showDialog<bool>("},{"type":"DELETE","lineNumber":1092,"oldContent":"      context: context,"},{"type":"DELETE","lineNumber":1093,"oldContent":"      builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":1094,"oldContent":"        title: const Text('Cancel Verification?'),"},{"type":"DELETE","lineNumber":1095,"oldContent":"        content: const Text('Are you sure you want to cancel the verification process?'),"},{"type":"DELETE","lineNumber":1096,"oldContent":"        actions: ["},{"type":"DELETE","lineNumber":1097,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":1098,"oldContent":"            onPressed: () => Navigator.of(context).pop(false),"},{"type":"DELETE","lineNumber":1099,"oldContent":"            child: const Text('No'),"},{"type":"DELETE","lineNumber":1100,"oldContent":"          ),"},{"type":"DELETE","lineNumber":1101,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":1102,"oldContent":"            onPressed: () {"},{"type":"DELETE","lineNumber":1103,"oldContent":"              // Clear any existing verification state"},{"type":"DELETE","lineNumber":1104,"oldContent":"              _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":1105,"oldContent":"              Navigator.of(context).pop(true);"},{"type":"DELETE","lineNumber":1106,"oldContent":"            },"},{"type":"DELETE","lineNumber":1107,"oldContent":"            child: const Text('Yes'),"},{"type":"DELETE","lineNumber":1108,"oldContent":"          ),"},{"type":"DELETE","lineNumber":1109,"oldContent":"        ],"},{"type":"DELETE","lineNumber":1110,"oldContent":"      ),"},{"type":"DELETE","lineNumber":1111,"oldContent":"    );"},{"type":"DELETE","lineNumber":1112,"oldContent":"    "},{"type":"DELETE","lineNumber":1113,"oldContent":"              ),"},{"type":"DELETE","lineNumber":1114,"oldContent":"            );"},{"type":"DELETE","lineNumber":1115,"oldContent":"          }"},{"type":"DELETE","lineNumber":1116,"oldContent":"        } catch (e) {"},{"type":"DELETE","lineNumber":1117,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":1118,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":1119,"oldContent":"              SnackBar("},{"type":"DELETE","lineNumber":1120,"oldContent":"                content: Text('An error occurred: ${e.toString()}'),"},{"type":"DELETE","lineNumber":1121,"oldContent":"                backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":1122,"oldContent":"                behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":1123,"oldContent":"              ),"},{"type":"DELETE","lineNumber":1124,"oldContent":"            );"},{"type":"DELETE","lineNumber":1125,"oldContent":"          }"},{"type":"DELETE","lineNumber":1126,"oldContent":"        } finally {"},{"type":"DELETE","lineNumber":1127,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":1128,"oldContent":"            setState(() {});"},{"type":"DELETE","lineNumber":1129,"oldContent":"          }"},{"type":"DELETE","lineNumber":1130,"oldContent":"        }"},{"type":"DELETE","lineNumber":1131,"oldContent":"      }"},{"type":"DELETE","lineNumber":1132,"oldContent":""},{"type":"DELETE","lineNumber":1133,"oldContent":"      Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":1134,"oldContent":"        if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":1135,"oldContent":"        "},{"type":"DELETE","lineNumber":1136,"oldContent":"        setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":1137,"oldContent":""},{"type":"DELETE","lineNumber":1138,"oldContent":"        try {"},{"type":"DELETE","lineNumber":1139,"oldContent":"          final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":1140,"oldContent":"          "},{"type":"DELETE","lineNumber":1141,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":1142,"oldContent":"            if (success) {"},{"type":"DELETE","lineNumber":1143,"oldContent":"              // Clear all OTP fields"},{"type":"DELETE","lineNumber":1144,"oldContent":"              for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":1145,"oldContent":"                controller.clear();"},{"type":"DELETE","lineNumber":1146,"oldContent":"              }"},{"type":"DELETE","lineNumber":1147,"oldContent":"              // Focus the first OTP field"},{"type":"DELETE","lineNumber":1148,"oldContent":"              if (_focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":1149,"oldContent":"                _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":1150,"oldContent":"              }"},{"type":"DELETE","lineNumber":1151,"oldContent":"              "},{"type":"DELETE","lineNumber":1152,"oldContent":"              // Show success message"},{"type":"DELETE","lineNumber":1153,"oldContent":"              ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":1154,"oldContent":"                const SnackBar("},{"type":"DELETE","lineNumber":1155,"oldContent":"                  content: Text('A new OTP has been sent to your phone number.'),"},{"type":"DELETE","lineNumber":1156,"oldContent":"                  backgroundColor: Colors.green,"},{"type":"DELETE","lineNumber":1157,"oldContent":"                  behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":1158,"oldContent":"                ),"},{"type":"DELETE","lineNumber":1159,"oldContent":"              );"},{"type":"DELETE","lineNumber":1160,"oldContent":"              "},{"type":"DELETE","lineNumber":1161,"oldContent":"              // Reset the resend timer"},{"type":"DELETE","lineNumber":1162,"oldContent":"              setState(() {"},{"type":"DELETE","lineNumber":1163,"oldContent":"                _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":1164,"oldContent":"                _startResendTimer();"},{"type":"DELETE","lineNumber":1165,"oldContent":"              });"},{"type":"DELETE","lineNumber":1166,"oldContent":"            } else {"},{"type":"DELETE","lineNumber":1167,"oldContent":"              // Show error message from view model"},{"type":"DELETE","lineNumber":1168,"oldContent":"              if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"DELETE","lineNumber":1169,"oldContent":"                ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":1170,"oldContent":"                  SnackBar("},{"type":"DELETE","lineNumber":1171,"oldContent":"                      Text("},{"type":"DELETE","lineNumber":1172,"oldContent":"                    content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":1173,"oldContent":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"DELETE","lineNumber":1174,"oldContent":"                          color: Colors.grey[600],"},{"type":"DELETE","lineNumber":1175,"oldContent":"                    backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":1176,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1177,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1178,"oldContent":"                    behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":1179,"oldContent":"                      const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":1180,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":1181,"oldContent":"                        widget.phoneNumber,"},{"type":"DELETE","lineNumber":1182,"oldContent":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"DELETE","lineNumber":1183,"oldContent":"                );"},{"type":"DELETE","lineNumber":1184,"oldContent":"                          fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":1185,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1186,"oldContent":"              }"},{"type":"DELETE","lineNumber":1187,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1188,"oldContent":"                      const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":1189,"oldContent":"            }"},{"type":"DELETE","lineNumber":1190,"oldContent":"                      Center("},{"type":"DELETE","lineNumber":1191,"oldContent":"                        child: Column("},{"type":"DELETE","lineNumber":1192,"oldContent":"          }"},{"type":"DELETE","lineNumber":1193,"oldContent":"                          children: ["},{"type":"DELETE","lineNumber":1194,"oldContent":"                            const Icon("},{"type":"DELETE","lineNumber":1195,"oldContent":"        } catch (e) {"},{"type":"DELETE","lineNumber":1196,"oldContent":"                              Icons.info_outline,"},{"type":"DELETE","lineNumber":1197,"oldContent":"                              size: 20,"},{"type":"DELETE","lineNumber":1198,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":1199,"oldContent":"                              color: Colors.grey,"},{"type":"DELETE","lineNumber":1200,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1201,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":1202,"oldContent":"                            const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":1203,"oldContent":"                            Text("},{"type":"DELETE","lineNumber":1204,"oldContent":"              SnackBar("},{"type":"DELETE","lineNumber":1205,"oldContent":"                              'Having trouble receiving the code?',"},{"type":"DELETE","lineNumber":1206,"oldContent":"                              style: theme.textTheme.bodyMedium?.copyWith("},{"type":"DELETE","lineNumber":1207,"oldContent":"                content: Text('Failed to resend OTP: ${e.toString()}'),"},{"type":"DELETE","lineNumber":1208,"oldContent":"                                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":1209,"oldContent":"                                fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":1210,"oldContent":"                backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":1211,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1212,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1213,"oldContent":"                behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":1214,"oldContent":"                            const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":1215,"oldContent":"                            Text("},{"type":"DELETE","lineNumber":1216,"oldContent":"              ),"},{"type":"DELETE","lineNumber":1217,"oldContent":"                              'Check your spam folder or request a new code',"},{"type":"DELETE","lineNumber":1218,"oldContent":"                              textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":1219,"oldContent":"            );"},{"type":"DELETE","lineNumber":1220,"oldContent":"                              style: theme.textTheme.bodySmall?.copyWith("},{"type":"DELETE","lineNumber":1221,"oldContent":"                                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":1222,"oldContent":"          }"},{"type":"DELETE","lineNumber":1223,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1224,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1225,"oldContent":"        } finally {"},{"type":"DELETE","lineNumber":1226,"oldContent":"                          ],"},{"type":"DELETE","lineNumber":1227,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1228,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":1229,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1230,"oldContent":"                      const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":1231,"oldContent":"            setState(() => _isResendLoading = false);"},{"type":"DELETE","lineNumber":1232,"oldContent":"                      Row("},{"type":"DELETE","lineNumber":1233,"oldContent":"                        mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":1234,"oldContent":"          }"},{"type":"DELETE","lineNumber":1235,"oldContent":"                        children: List.generate("},{"type":"DELETE","lineNumber":1236,"oldContent":"                          6,"},{"type":"DELETE","lineNumber":1237,"oldContent":"        }"},{"type":"DELETE","lineNumber":1238,"oldContent":"                          (index) => SizedBox("},{"type":"DELETE","lineNumber":1239,"oldContent":"                            width: 48,"},{"type":"DELETE","lineNumber":1240,"oldContent":"      }"},{"type":"DELETE","lineNumber":1241,"oldContent":"                            height: 56,"},{"type":"DELETE","lineNumber":1242,"oldContent":"                            child: TextFormField("},{"type":"DELETE","lineNumber":1243,"oldContent":""},{"type":"DELETE","lineNumber":1244,"oldContent":"                              controller: _otpControllers[index],"},{"type":"DELETE","lineNumber":1245,"oldContent":"                              focusNode: _focusNodes[index],"},{"type":"DELETE","lineNumber":1246,"oldContent":"      void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":1247,"oldContent":"                              keyboardType: TextInputType.number,"},{"type":"DELETE","lineNumber":1248,"oldContent":"                              textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":1249,"oldContent":"        if (value.length == 1 && index < 5) {"},{"type":"DELETE","lineNumber":1250,"oldContent":"                              maxLength: 1,"},{"type":"DELETE","lineNumber":1251,"oldContent":"                              style: theme.textTheme.headlineSmall?.copyWith("},{"type":"DELETE","lineNumber":1252,"oldContent":"          _focusNodes[index + 1].requestFocus();"},{"type":"DELETE","lineNumber":1253,"oldContent":"                                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":1254,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1255,"oldContent":"        } else if (value.isEmpty && index > 0) {"},{"type":"DELETE","lineNumber":1256,"oldContent":"                              onChanged: (value) => _onOtpChanged(value, index),"},{"type":"DELETE","lineNumber":1257,"oldContent":"                              onTap: () {"},{"type":"DELETE","lineNumber":1258,"oldContent":"          _focusNodes[index - 1].requestFocus();"},{"type":"DELETE","lineNumber":1259,"oldContent":"                                // Move cursor to end of text when field is tapped"},{"type":"DELETE","lineNumber":1260,"oldContent":"                                _otpControllers[index].selection = TextSelection.fromPosition("},{"type":"DELETE","lineNumber":1261,"oldContent":"        }"},{"type":"DELETE","lineNumber":1262,"oldContent":"                                  TextPosition(offset: _otpControllers[index].text.length),"},{"type":"DELETE","lineNumber":1263,"oldContent":"                                );"},{"type":"DELETE","lineNumber":1264,"oldContent":"      }"},{"type":"DELETE","lineNumber":1265,"oldContent":"                              },"},{"type":"DELETE","lineNumber":1266,"oldContent":"                              decoration: InputDecoration("},{"type":"DELETE","lineNumber":1267,"oldContent":""},{"type":"DELETE","lineNumber":1268,"oldContent":"                                counterText: '',"},{"type":"DELETE","lineNumber":1269,"oldContent":"                                contentPadding: EdgeInsets.zero,"},{"type":"DELETE","lineNumber":1270,"oldContent":"      Future<bool> _onWillPop() async {"},{"type":"DELETE","lineNumber":1271,"oldContent":"                                enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":1272,"oldContent":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1273,"oldContent":"        // Prevent back navigation if OTP verification is in progress"},{"type":"DELETE","lineNumber":1274,"oldContent":"                                  borderSide: BorderSide("},{"type":"DELETE","lineNumber":1275,"oldContent":"                                    color: Colors.grey[300]!,"},{"type":"DELETE","lineNumber":1276,"oldContent":"        if (_viewModel.isLoading) return false;"},{"type":"DELETE","lineNumber":1277,"oldContent":"                                    width: 1.5,"},{"type":"DELETE","lineNumber":1278,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1279,"oldContent":"        "},{"type":"DELETE","lineNumber":1280,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1281,"oldContent":"                                focusedBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":1282,"oldContent":"        // Show confirmation dialog when trying to go back"},{"type":"DELETE","lineNumber":1283,"oldContent":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1284,"oldContent":"                                  borderSide: BorderSide("},{"type":"DELETE","lineNumber":1285,"oldContent":"        final shouldPop = await showDialog<bool>("},{"type":"DELETE","lineNumber":1286,"oldContent":"                                    color: theme.primaryColor,"},{"type":"DELETE","lineNumber":1287,"oldContent":"                                    width: 2,"},{"type":"DELETE","lineNumber":1288,"oldContent":"          context: context,"},{"type":"DELETE","lineNumber":1289,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1290,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1291,"oldContent":"          builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":1292,"oldContent":"                                errorBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":1293,"oldContent":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1294,"oldContent":"            title: const Text('Cancel Verification?'),"},{"type":"DELETE","lineNumber":1295,"oldContent":"                                  borderSide: const BorderSide("},{"type":"DELETE","lineNumber":1296,"oldContent":"                                    color: Colors.red,"},{"type":"DELETE","lineNumber":1297,"oldContent":"            content: const Text('Are you sure you want to cancel the verification process?'),"},{"type":"DELETE","lineNumber":1298,"oldContent":"                                    width: 1.5,"},{"type":"DELETE","lineNumber":1299,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1300,"oldContent":"            actions: ["},{"type":"DELETE","lineNumber":1301,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1302,"oldContent":"                                focusedErrorBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":1303,"oldContent":"              TextButton("},{"type":"DELETE","lineNumber":1304,"oldContent":"                                  borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1305,"oldContent":"                                  borderSide: const BorderSide("},{"type":"DELETE","lineNumber":1306,"oldContent":"                onPressed: () => Navigator.of(context).pop(false),"},{"type":"DELETE","lineNumber":1307,"oldContent":"                                    color: Colors.red,"},{"type":"DELETE","lineNumber":1308,"oldContent":"                                    width: 2,"},{"type":"DELETE","lineNumber":1309,"oldContent":"                child: const Text('No'),"},{"type":"DELETE","lineNumber":1310,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1311,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1312,"oldContent":"              ),"},{"type":"DELETE","lineNumber":1313,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":1314,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1315,"oldContent":"              TextButton("},{"type":"DELETE","lineNumber":1316,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":1317,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1318,"oldContent":"                onPressed: () {"},{"type":"DELETE","lineNumber":1319,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1320,"oldContent":"                      const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":1321,"oldContent":"                  // Clear any existing verification state"},{"type":"DELETE","lineNumber":1322,"oldContent":"                      SizedBox("},{"type":"DELETE","lineNumber":1323,"oldContent":"                        width: double.infinity,"},{"type":"DELETE","lineNumber":1324,"oldContent":"                  _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":1325,"oldContent":"                        height: 56,"},{"type":"DELETE","lineNumber":1326,"oldContent":"                        child: ElevatedButton("},{"type":"DELETE","lineNumber":1327,"oldContent":"                  Navigator.of(context).pop(true);"},{"type":"DELETE","lineNumber":1328,"oldContent":"                          onPressed: viewModel.isLoading ? null : _verifyOtp,"},{"type":"DELETE","lineNumber":1329,"oldContent":"                          style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":1330,"oldContent":"                },"},{"type":"DELETE","lineNumber":1331,"oldContent":"                            backgroundColor: colorScheme.primary,"},{"type":"DELETE","lineNumber":1332,"oldContent":"                            foregroundColor: colorScheme.onPrimary,"},{"type":"DELETE","lineNumber":1333,"oldContent":"                child: const Text('Yes'),"},{"type":"DELETE","lineNumber":1334,"oldContent":"                            elevation: 0,"},{"type":"DELETE","lineNumber":1335,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":1336,"oldContent":"              ),"},{"type":"DELETE","lineNumber":1337,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":1338,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1339,"oldContent":"            ],"},{"type":"DELETE","lineNumber":1340,"oldContent":"                            padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":1341,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":1342,"oldContent":"          ),"},{"type":"DELETE","lineNumber":1343,"oldContent":"                          child: viewModel.isLoading"},{"type":"DELETE","lineNumber":1344,"oldContent":"                              ? const SizedBox("},{"type":"DELETE","lineNumber":1345,"oldContent":"        );"},{"type":"DELETE","lineNumber":1346,"oldContent":"                                  width: 24,"},{"type":"DELETE","lineNumber":1347,"oldContent":"                                  height: 24,"},{"type":"DELETE","lineNumber":1348,"oldContent":"        "},{"type":"DELETE","lineNumber":1349,"oldContent":"                                  child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":1350,"oldContent":"                                    color: Colors.white,"},{"type":"DELETE","lineNumber":1351,"oldContent":"        return shouldPop ?? false;"},{"type":"DELETE","lineNumber":1352,"oldContent":"                                    strokeWidth: 2,"},{"type":"DELETE","lineNumber":1353,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1354,"oldContent":"      }"},{"type":"DELETE","lineNumber":1355,"oldContent":"                                )"},{"type":"DELETE","lineNumber":1356,"oldContent":"                              : const Text("},{"type":"DELETE","lineNumber":1357,"oldContent":""},{"type":"DELETE","lineNumber":1358,"oldContent":"                                  'Verify',"},{"type":"DELETE","lineNumber":1359,"oldContent":"                                  style: TextStyle("},{"type":"DELETE","lineNumber":1360,"oldContent":"      @override"},{"type":"DELETE","lineNumber":1361,"oldContent":"                                    fontSize: 16,"},{"type":"DELETE","lineNumber":1362,"oldContent":"                                    fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":1363,"oldContent":"      Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":1364,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1365,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1366,"oldContent":"        final theme = Theme.of(context);"},{"type":"DELETE","lineNumber":1367,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1368,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1369,"oldContent":"        final colorScheme = theme.colorScheme;"},{"type":"DELETE","lineNumber":1370,"oldContent":"                      const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":1371,"oldContent":"                      Center("},{"type":"DELETE","lineNumber":1372,"oldContent":"        "},{"type":"DELETE","lineNumber":1373,"oldContent":"                        child: TextButton("},{"type":"DELETE","lineNumber":1374,"oldContent":"                          onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"DELETE","lineNumber":1375,"oldContent":"        return BaseView<AuthViewModel>("},{"type":"DELETE","lineNumber":1376,"oldContent":"                          style: TextButton.styleFrom("},{"type":"DELETE","lineNumber":1377,"oldContent":"                            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"DELETE","lineNumber":1378,"oldContent":"          onModelReady: (model) {},"},{"type":"DELETE","lineNumber":1379,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":1380,"oldContent":"                              borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":1381,"oldContent":"          builder: (context, viewModel, child) {"},{"type":"DELETE","lineNumber":1382,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":1383,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":1384,"oldContent":"            return Scaffold("},{"type":"DELETE","lineNumber":1385,"oldContent":"                          child: _isResendLoading"},{"type":"DELETE","lineNumber":1386,"oldContent":"                              ? const SizedBox("},{"type":"DELETE","lineNumber":1387,"oldContent":"              appBar: AppBar("},{"type":"DELETE","lineNumber":1388,"oldContent":"                                  width: 24,"},{"type":"DELETE","lineNumber":1389,"oldContent":"                                  height: 24,"},{"type":"DELETE","lineNumber":1390,"oldContent":"                title: const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":1391,"oldContent":"                                  child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":1392,"oldContent":"                                    strokeWidth: 2,"},{"type":"DELETE","lineNumber":1393,"oldContent":"                elevation: 0,"},{"type":"DELETE","lineNumber":1394,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":1395,"oldContent":"                                )"},{"type":"DELETE","lineNumber":1396,"oldContent":"                backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":1397,"oldContent":"                              : Row("},{"type":"DELETE","lineNumber":1398,"oldContent":"                                  mainAxisSize: MainAxisSize.min,"},{"type":"DELETE","lineNumber":1399,"oldContent":"                foregroundColor: theme.brightness == Brightness.dark "},{"type":"DELETE","lineNumber":1400,"oldContent":"                                  children: ["},{"type":"DELETE","lineNumber":1401,"oldContent":"                                    Icon("},{"type":"DELETE","lineNumber":1402,"oldContent":"                    ? Colors.white "},{"type":"DELETE","lineNumber":1403,"oldContent":"                                      Icons.refresh,"},{"type":"DELETE","lineNumber":1404,"oldContent":"                                      size: 18,"},{"type":"DELETE","lineNumber":1405,"oldContent":"                    : Colors.black,"},{"type":"DELETE","lineNumber":1406,"oldContent":"                                      color: _resendCodeIn == 0 "},{"type":"DELETE","lineNumber":1407,"oldContent":"                                          ? colorScheme.primary "},{"type":"DELETE","lineNumber":1408,"oldContent":"                centerTitle: true,"},{"type":"DELETE","lineNumber":1409,"oldContent":"                                          : Colors.grey,"},{"type":"DELETE","lineNumber":1410,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":1411,"oldContent":"              ),"},{"type":"DELETE","lineNumber":1412,"oldContent":"                                    const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":1413,"oldContent":"                                    Text("},{"type":"DELETE","lineNumber":1414,"oldContent":"              body: SafeArea("},{"type":"DELETE","lineNumber":1415,"oldContent":"                                      _resendCodeIn > 0"},{"type":"DELETE","lineNumber":1416,"oldContent":"                                          ? 'Resend code in $_resendCodeIn seconds'"},{"type":"DELETE","lineNumber":1417,"oldContent":"                child: SingleChildScrollView("},{"type":"DELETE","lineNumber":1418,"oldContent":"                                          : 'Resend code',"},{"type":"DELETE","lineNumber":1419,"oldContent":"                                      style: TextStyle("},{"type":"DELETE","lineNumber":1420,"oldContent":"                  padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":1421,"oldContent":"                                        color: _resendCodeIn == 0"},{"type":"DELETE","lineNumber":1422,"oldContent":"                                            ? colorScheme.primary"},{"type":"DELETE","lineNumber":1423,"oldContent":"                  child: Column("},{"type":"DELETE","lineNumber":1424,"oldContent":"                                            : Colors.grey,"},{"type":"DELETE","lineNumber":1425,"oldContent":"                                        fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":1426,"oldContent":"                    crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":1427,"oldContent":"                                      ),"},{"type":"DELETE","lineNumber":1428,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":1429,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":1430,"oldContent":"                                  ],"},{"type":"DELETE","lineNumber":1431,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":1432,"oldContent":"                      const Text("},{"type":"DELETE","lineNumber":1433,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1434,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1435,"oldContent":"                        'Verify OTP',"},{"type":"DELETE","lineNumber":1436,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":1437,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":1438,"oldContent":"                        style: TextStyle("},{"type":"DELETE","lineNumber":1439,"oldContent":"                ),"},{"type":"DELETE","lineNumber":1440,"oldContent":"              ),"},{"type":"DELETE","lineNumber":1441,"oldContent":"                          fontSize: 28,"},{"type":"DELETE","lineNumber":1442,"oldContent":"            );"},{"type":"DELETE","lineNumber":1443,"oldContent":"          },"},{"type":"DELETE","lineNumber":1444,"oldContent":"                          fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":1445,"oldContent":"        );"},{"type":"DELETE","lineNumber":1446,"oldContent":"                      const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":1447,"oldContent":"      }"},{"type":"DELETE","lineNumber":1448,"oldContent":"    }"},{"type":"DELETE","lineNumber":1449,"oldContent":"      ),"},{"type":"DELETE","lineNumber":1450,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":1451,"oldContent":"    );"},{"type":"DELETE","lineNumber":1452,"oldContent":"  }"},{"type":"DELETE","lineNumber":1453,"oldContent":"                      const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":1454,"oldContent":"}"},{"type":"DELETE","lineNumber":1455,"oldContent":"                          fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":1456,"oldContent":""},{"type":"DELETE","lineNumber":1457,"oldContent":"                      Text("},{"type":"DELETE","lineNumber":1458,"oldContent":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"DELETE","lineNumber":1459,"oldContent":"                        'Enter the 6-digit code sent to',"},{"type":"DELETE","lineNumber":1460,"oldContent":"                        widget.phoneNumber,"},{"type":"DELETE","lineNumber":1461,"oldContent":"                        style: theme.textTheme.bodyLarge?.copyWith("},{"type":"DELETE","lineNumber":1462,"oldContent":"                      Text("},{"type":"DELETE","lineNumber":1463,"oldContent":"                          color: Colors.grey[600],"},{"type":"DELETE","lineNumber":1464,"oldContent":"                      const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":1465,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":1466,"oldContent":"                      ),"}]},{"timestamp":1754611672248,"changes":[{"type":"MODIFY","lineNumber":0,"content":"import 'dart:async';","oldContent":"import 'package:flutter/material.dart';"},{"type":"MODIFY","lineNumber":2,"content":"import 'package:flutter/material.dart';","oldContent":"import 'package:family_tree_firebase/core/constants/app_constants.dart';"},{"type":"INSERT","lineNumber":11,"content":""},{"type":"INSERT","lineNumber":12,"content":"  const OtpVerificationScreen({"},{"type":"DELETE","lineNumber":24,"oldContent":"  bool _isLoading = false;"},{"type":"DELETE","lineNumber":25,"oldContent":"  bool _isResendLoading = false;"},{"type":"INSERT","lineNumber":27,"content":"  bool _isResendLoading = false;"},{"type":"INSERT","lineNumber":28,"content":"  int _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":29,"oldContent":""},{"type":"DELETE","lineNumber":30,"oldContent":"  late Timer _resendTimer;"},{"type":"INSERT","lineNumber":31,"content":"  @override"},{"type":"INSERT","lineNumber":32,"content":"  void initState() {"},{"type":"DELETE","lineNumber":32,"oldContent":"    _startResendTimer();"},{"type":"DELETE","lineNumber":33,"oldContent":"  }"},{"type":"DELETE","lineNumber":42,"oldContent":"    });"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"INSERT","lineNumber":43,"content":"    });"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"INSERT","lineNumber":85,"content":"      Navigator.of(context).pushReplacementNamed('/join-or-create-family');"},{"type":"DELETE","lineNumber":86,"oldContent":"      Navigator.of(context).pushReplacementNamed('/home');"},{"type":"DELETE","lineNumber":140,"oldContent":"    setState(() => _isResendLoading = true);"},{"type":"INSERT","lineNumber":142,"content":"    setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":189,"oldContent":"  }"},{"type":"DELETE","lineNumber":191,"oldContent":""},{"type":"INSERT","lineNumber":192,"content":"  }"},{"type":"INSERT","lineNumber":193,"content":""}]},{"timestamp":1754611732395,"changes":[{"type":"MODIFY","lineNumber":13,"content":"    super.key,","oldContent":"    super.key,"},{"type":"MODIFY","lineNumber":29,"content":"  late Timer _resendTimer;","oldContent":"  late Timer _resendTimer;"},{"type":"MODIFY","lineNumber":33,"content":"    super.initState();","oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":42,"oldContent":"    });"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"INSERT","lineNumber":43,"content":"    });"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"MODIFY","lineNumber":85,"content":"      Navigator.of(context).pushReplacementNamed(AppConstants.joinOrCreateFamilyRoute);","oldContent":"      Navigator.of(context).pushReplacementNamed('/join-or-create-family');"},{"type":"INSERT","lineNumber":141,"content":""},{"type":"DELETE","lineNumber":143,"oldContent":""},{"type":"DELETE","lineNumber":190,"oldContent":"  }"},{"type":"MODIFY","lineNumber":192,"content":"  }","oldContent":""},{"type":"INSERT","lineNumber":193,"content":""}]},{"timestamp":1754611747475,"changes":[{"type":"MODIFY","lineNumber":1,"content":"","oldContent":"import 'package:family_tree_firebase/core/constants/app_constants.dart';"},{"type":"INSERT","lineNumber":12,"content":"  const OtpVerificationScreen({"},{"type":"DELETE","lineNumber":13,"oldContent":"    super.key,"},{"type":"INSERT","lineNumber":28,"content":"  int _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":29,"oldContent":"  late Timer _resendTimer;"},{"type":"INSERT","lineNumber":32,"content":"  void initState() {"},{"type":"DELETE","lineNumber":33,"oldContent":"    super.initState();"},{"type":"MODIFY","lineNumber":35,"content":"    _viewModel.addListener(_onViewModelChange);","oldContent":"      controller.dispose();"},{"type":"DELETE","lineNumber":42,"oldContent":"    });"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"INSERT","lineNumber":43,"content":"    });"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"INSERT","lineNumber":191,"content":"    }"},{"type":"DELETE","lineNumber":193,"oldContent":"    }"}]},{"timestamp":1754613740337,"changes":[{"type":"MODIFY","lineNumber":4,"content":"import 'package:firebase_auth/firebase_auth.dart';","oldContent":"  final String verificationId;"},{"type":"INSERT","lineNumber":11,"content":"  final String? email;"},{"type":"INSERT","lineNumber":12,"content":"  final bool isRegistration;"},{"type":"INSERT","lineNumber":15,"content":"    super.key,"},{"type":"INSERT","lineNumber":18,"content":"    this.email,"},{"type":"INSERT","lineNumber":19,"content":"    this.isRegistration = false,"},{"type":"DELETE","lineNumber":25,"oldContent":"  bool _isLoading = false;"},{"type":"INSERT","lineNumber":33,"content":"  late Timer _resendTimer;"},{"type":"DELETE","lineNumber":31,"oldContent":"  @override"},{"type":"DELETE","lineNumber":33,"oldContent":"    _startResendTimer();"},{"type":"INSERT","lineNumber":37,"content":"    super.initState();"},{"type":"DELETE","lineNumber":42,"oldContent":"    });"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"INSERT","lineNumber":47,"content":"    });"},{"type":"INSERT","lineNumber":49,"content":""},{"type":"DELETE","lineNumber":60,"oldContent":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"DELETE","lineNumber":61,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":62,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":63,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":64,"oldContent":"            content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":65,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":66,"oldContent":"          ),"},{"type":"INSERT","lineNumber":64,"content":"    if (_viewModel.isLoading) return;"},{"type":"INSERT","lineNumber":65,"content":"    "},{"type":"INSERT","lineNumber":66,"content":"    if (_viewModel.errorMessage != null) {"},{"type":"INSERT","lineNumber":67,"content":"      ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":68,"content":"        SnackBar(content: Text(_viewModel.errorMessage!), backgroundColor: Colors.red),"},{"type":"INSERT","lineNumber":69,"content":"      );"},{"type":"INSERT","lineNumber":70,"content":"      _viewModel.clearError();"},{"type":"INSERT","lineNumber":71,"content":"      return;"},{"type":"INSERT","lineNumber":72,"content":"    }"},{"type":"INSERT","lineNumber":73,"content":"    "},{"type":"INSERT","lineNumber":74,"content":"    if (_viewModel.isOtpVerified) {"},{"type":"INSERT","lineNumber":75,"content":"      // Handle post-verification flow based on the context"},{"type":"INSERT","lineNumber":76,"content":"      if (widget.isRegistration) {"},{"type":"INSERT","lineNumber":77,"content":"        // If this was part of registration, navigate to home screen"},{"type":"INSERT","lineNumber":78,"content":"        Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":79,"content":"          context,"},{"type":"INSERT","lineNumber":80,"content":"          AppConstants.homeRoute,"},{"type":"INSERT","lineNumber":81,"content":"          (route) => false, // Remove all previous routes"},{"type":"DELETE","lineNumber":68,"oldContent":"        _viewModel.setError();"},{"type":"INSERT","lineNumber":83,"content":"      } else if (widget.email != null && widget.email!.isNotEmpty) {"},{"type":"INSERT","lineNumber":84,"content":"        // If email is provided, navigate to setup password screen"},{"type":"INSERT","lineNumber":85,"content":"        Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":86,"content":"          context,"},{"type":"INSERT","lineNumber":87,"content":"          AppConstants.setupPasswordRoute,"},{"type":"INSERT","lineNumber":88,"content":"          arguments: {"},{"type":"INSERT","lineNumber":89,"content":"            'email': widget.email,"},{"type":"INSERT","lineNumber":90,"content":"            'phone': widget.phoneNumber,"},{"type":"INSERT","lineNumber":91,"content":"          },"},{"type":"INSERT","lineNumber":92,"content":"        );"},{"type":"INSERT","lineNumber":93,"content":"      } else {"},{"type":"INSERT","lineNumber":94,"content":"        // Default navigation to home screen"},{"type":"INSERT","lineNumber":95,"content":"        Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":96,"content":"          context,"},{"type":"INSERT","lineNumber":97,"content":"          AppConstants.homeRoute,"},{"type":"INSERT","lineNumber":98,"content":"          (route) => false, // Remove all previous routes"},{"type":"INSERT","lineNumber":99,"content":"        );"},{"type":"DELETE","lineNumber":83,"oldContent":"  Future<void> _handleOtpVerificationSuccess(User? user) async {"},{"type":"DELETE","lineNumber":84,"oldContent":"    if (user != null && mounted) {"},{"type":"DELETE","lineNumber":85,"oldContent":"      Navigator.of(context).pushReplacementNamed(AppConstants.joinOrCreateFamilyRoute);"},{"type":"DELETE","lineNumber":86,"oldContent":"    }"},{"type":"DELETE","lineNumber":87,"oldContent":"  }"},{"type":"DELETE","lineNumber":88,"oldContent":""},{"type":"DELETE","lineNumber":92,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":93,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":94,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":95,"oldContent":"            content: Text('Please enter a valid 6-digit OTP'),"},{"type":"DELETE","lineNumber":96,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":97,"oldContent":"          ),"},{"type":"DELETE","lineNumber":98,"oldContent":"        );"},{"type":"DELETE","lineNumber":99,"oldContent":"      }"},{"type":"INSERT","lineNumber":117,"content":"      ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":118,"content":"        const SnackBar(content: Text('Please enter a valid 6-digit OTP')),"},{"type":"INSERT","lineNumber":119,"content":"      );"},{"type":"DELETE","lineNumber":102,"oldContent":""},{"type":"INSERT","lineNumber":122,"content":"    "},{"type":"DELETE","lineNumber":104,"oldContent":"      final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":124,"content":"      await _viewModel.verifyOtp("}]},{"timestamp":1754613830891,"changes":[{"type":"MODIFY","lineNumber":13,"content":"","oldContent":""},{"type":"INSERT","lineNumber":15,"content":"    super.key,"},{"type":"DELETE","lineNumber":17,"oldContent":"    super.key,"},{"type":"INSERT","lineNumber":18,"content":"    this.email,"},{"type":"INSERT","lineNumber":19,"content":"    this.isRegistration = false,"},{"type":"DELETE","lineNumber":21,"oldContent":"    this.email,"},{"type":"DELETE","lineNumber":23,"oldContent":"    this.isRegistration = false,"},{"type":"INSERT","lineNumber":33,"content":"  late Timer _resendTimer;"},{"type":"DELETE","lineNumber":36,"oldContent":"  late Timer _resendTimer;"},{"type":"INSERT","lineNumber":37,"content":"    super.initState();"},{"type":"DELETE","lineNumber":40,"oldContent":"    super.initState();"},{"type":"INSERT","lineNumber":47,"content":"    });"},{"type":"INSERT","lineNumber":49,"content":""},{"type":"DELETE","lineNumber":49,"oldContent":"    });"},{"type":"DELETE","lineNumber":52,"oldContent":""},{"type":"INSERT","lineNumber":66,"content":"    // Clear any previous error messages"},{"type":"DELETE","lineNumber":67,"oldContent":"      ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":68,"oldContent":"        );"},{"type":"DELETE","lineNumber":69,"oldContent":"        SnackBar(content: Text(_viewModel.errorMessage!), backgroundColor: Colors.red),"},{"type":"DELETE","lineNumber":70,"oldContent":"      );"},{"type":"DELETE","lineNumber":71,"oldContent":"      }"},{"type":"DELETE","lineNumber":74,"oldContent":"      return;"},{"type":"DELETE","lineNumber":76,"oldContent":"    }"},{"type":"DELETE","lineNumber":78,"oldContent":"    "},{"type":"DELETE","lineNumber":80,"oldContent":"    if (_viewModel.isOtpVerified) {"},{"type":"DELETE","lineNumber":82,"oldContent":"      // Handle post-verification flow based on the context"},{"type":"DELETE","lineNumber":84,"oldContent":"      if (widget.isRegistration) {"},{"type":"DELETE","lineNumber":86,"oldContent":"        // If this was part of registration, navigate to home screen"},{"type":"DELETE","lineNumber":88,"oldContent":"        Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":90,"oldContent":"          context,"},{"type":"DELETE","lineNumber":92,"oldContent":"          AppConstants.homeRoute,"},{"type":"DELETE","lineNumber":94,"oldContent":"          (route) => false, // Remove all previous routes"},{"type":"DELETE","lineNumber":97,"oldContent":"      } else if (widget.email != null && widget.email!.isNotEmpty) {"},{"type":"DELETE","lineNumber":98,"oldContent":"        // If email is provided, navigate to setup password screen"},{"type":"DELETE","lineNumber":99,"oldContent":"        Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":100,"oldContent":"          context,"},{"type":"DELETE","lineNumber":101,"oldContent":"          AppConstants.setupPasswordRoute,"},{"type":"DELETE","lineNumber":102,"oldContent":"          arguments: {"},{"type":"DELETE","lineNumber":103,"oldContent":"            'email': widget.email,"},{"type":"DELETE","lineNumber":105,"oldContent":"            'phone': widget.phoneNumber,"},{"type":"DELETE","lineNumber":107,"oldContent":"          },"},{"type":"INSERT","lineNumber":85,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":86,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":87,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":88,"content":"            content: Text('Please enter a valid 6-digit OTP'),"},{"type":"INSERT","lineNumber":89,"content":"            backgroundColor: Colors.orange,"},{"type":"INSERT","lineNumber":90,"content":"          ),"},{"type":"DELETE","lineNumber":110,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":111,"oldContent":"        // Default navigation to home screen"},{"type":"DELETE","lineNumber":112,"oldContent":"        Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":113,"oldContent":"          context,"},{"type":"DELETE","lineNumber":114,"oldContent":"          AppConstants.homeRoute,"},{"type":"DELETE","lineNumber":115,"oldContent":"          (route) => false, // Remove all previous routes"},{"type":"DELETE","lineNumber":116,"oldContent":"        );"},{"type":"INSERT","lineNumber":92,"content":"      }"},{"type":"INSERT","lineNumber":95,"content":"    "},{"type":"INSERT","lineNumber":97,"content":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":98,"content":"      "},{"type":"INSERT","lineNumber":99,"content":"      // Call the verifyOtp method from AuthViewModel"},{"type":"INSERT","lineNumber":100,"content":"      final success = await _viewModel.verifyOtpCode("},{"type":"DELETE","lineNumber":124,"oldContent":"      final userCredential = await FirebaseAuth.instance.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":125,"oldContent":"      await _handleOtpVerificationSuccess(userCredential.user);"},{"type":"DELETE","lineNumber":126,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":127,"oldContent":"      String message = 'Verification failed. Please try again.';"},{"type":"DELETE","lineNumber":128,"oldContent":"      if (e.code == 'invalid-verification-code') {"},{"type":"DELETE","lineNumber":129,"oldContent":"        message = 'Invalid OTP. Please try again.';"},{"type":"DELETE","lineNumber":130,"oldContent":"      } else if (e.code == 'session-expired') {"},{"type":"DELETE","lineNumber":131,"oldContent":"        message = 'Session expired. Please request a new OTP.';"},{"type":"DELETE","lineNumber":132,"oldContent":"      ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":133,"oldContent":"      }"},{"type":"DELETE","lineNumber":134,"oldContent":"        const SnackBar(content: Text('Please enter a valid 6-digit OTP')),"},{"type":"INSERT","lineNumber":105,"content":"      if (!mounted) return;"},{"type":"DELETE","lineNumber":136,"oldContent":"      );"},{"type":"DELETE","lineNumber":137,"oldContent":"      if (mounted) {"},{"type":"INSERT","lineNumber":107,"content":"      if (success) {"},{"type":"INSERT","lineNumber":108,"content":"        // If this is part of registration, update the phone number"},{"type":"INSERT","lineNumber":109,"content":"        if (widget.isRegistration && widget.phoneNumber.isNotEmpty) {"},{"type":"INSERT","lineNumber":110,"content":"          await _viewModel.updateUserPhoneNumber(widget.phoneNumber);"},{"type":"INSERT","lineNumber":111,"content":"        }"},{"type":"INSERT","lineNumber":112,"content":"        "},{"type":"INSERT","lineNumber":113,"content":"        // Show success message"},{"type":"INSERT","lineNumber":114,"content":"        if (mounted) {"},{"type":"INSERT","lineNumber":115,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":116,"content":"            const SnackBar("},{"type":"INSERT","lineNumber":117,"content":"              content: Text('Phone number verified successfully!'),"},{"type":"INSERT","lineNumber":118,"content":"              backgroundColor: Colors.green,"},{"type":"INSERT","lineNumber":119,"content":"            ),"},{"type":"INSERT","lineNumber":120,"content":"          );"},{"type":"INSERT","lineNumber":121,"content":"          "},{"type":"INSERT","lineNumber":122,"content":"          // Navigate based on the context"},{"type":"INSERT","lineNumber":123,"content":"          if (widget.isRegistration) {"},{"type":"INSERT","lineNumber":124,"content":"            // For registration, go to home screen"},{"type":"INSERT","lineNumber":125,"content":"            Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":126,"content":"              context,"},{"type":"INSERT","lineNumber":127,"content":"              AppConstants.homeRoute,"},{"type":"INSERT","lineNumber":128,"content":"              (route) => false,"},{"type":"INSERT","lineNumber":129,"content":"            );"},{"type":"INSERT","lineNumber":130,"content":"          } else if (widget.email != null && widget.email!.isNotEmpty) {"},{"type":"INSERT","lineNumber":131,"content":"            // For password reset, go to setup password screen"},{"type":"INSERT","lineNumber":132,"content":"            Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":133,"content":"              context,"},{"type":"INSERT","lineNumber":134,"content":"              AppConstants.setupPasswordRoute,"},{"type":"INSERT","lineNumber":135,"content":"              arguments: {"},{"type":"INSERT","lineNumber":136,"content":"                'email': widget.email,"},{"type":"INSERT","lineNumber":137,"content":"                'phone': widget.phoneNumber,"},{"type":"INSERT","lineNumber":138,"content":"              },"},{"type":"INSERT","lineNumber":139,"content":"            );"},{"type":"INSERT","lineNumber":140,"content":"          } else {"},{"type":"INSERT","lineNumber":141,"content":"            // Default navigation to home screen"},{"type":"INSERT","lineNumber":142,"content":"            Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":143,"content":"              context,"},{"type":"INSERT","lineNumber":144,"content":"              AppConstants.homeRoute,"},{"type":"INSERT","lineNumber":145,"content":"              (route) => false,"},{"type":"INSERT","lineNumber":146,"content":"            );"},{"type":"INSERT","lineNumber":147,"content":"          }"},{"type":"INSERT","lineNumber":148,"content":"        }"},{"type":"INSERT","lineNumber":149,"content":"      } else if (mounted) {"},{"type":"INSERT","lineNumber":150,"content":"        // Show error message from view model"},{"type":"DELETE","lineNumber":140,"oldContent":"    "},{"type":"INSERT","lineNumber":153,"content":"            content: Text(_viewModel.errorMessage ?? 'Verification failed'),"},{"type":"INSERT","lineNumber":154,"content":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":143,"oldContent":"      await _viewModel.verifyOtp("}]},{"timestamp":1754613861051,"changes":[{"type":"INSERT","lineNumber":12,"content":"  final bool isRegistration;"},{"type":"DELETE","lineNumber":13,"oldContent":""},{"type":"MODIFY","lineNumber":20,"content":"  });","oldContent":"  });"},{"type":"INSERT","lineNumber":32,"content":"  bool _isLoading = false;"},{"type":"DELETE","lineNumber":49,"oldContent":"  @override"},{"type":"INSERT","lineNumber":51,"content":"  @override"},{"type":"DELETE","lineNumber":75,"oldContent":"      if (mounted) {"},{"type":"INSERT","lineNumber":77,"content":"      } else {"},{"type":"INSERT","lineNumber":78,"content":"        _resendTimer.cancel();"},{"type":"INSERT","lineNumber":79,"content":"      }"},{"type":"INSERT","lineNumber":80,"content":"    });"},{"type":"INSERT","lineNumber":81,"content":"  }"},{"type":"INSERT","lineNumber":82,"content":""},{"type":"INSERT","lineNumber":83,"content":"  Future<void> _verifyOtp() async {"},{"type":"INSERT","lineNumber":84,"content":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"INSERT","lineNumber":85,"content":"    if (otp.length != 6) {"},{"type":"INSERT","lineNumber":86,"content":"      if (mounted) {"},{"type":"DELETE","lineNumber":79,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":82,"oldContent":"        _resendTimer.cancel();"},{"type":"INSERT","lineNumber":92,"content":"        );"},{"type":"DELETE","lineNumber":85,"oldContent":"      }"},{"type":"DELETE","lineNumber":86,"oldContent":"    });"},{"type":"INSERT","lineNumber":94,"content":"      return;"},{"type":"INSERT","lineNumber":95,"content":"    }"},{"type":"DELETE","lineNumber":88,"oldContent":"  }"},{"type":"DELETE","lineNumber":89,"oldContent":""},{"type":"INSERT","lineNumber":97,"content":"    try {"},{"type":"DELETE","lineNumber":93,"oldContent":"      final success = await _viewModel.verifyOtpCode("},{"type":"DELETE","lineNumber":94,"oldContent":"  Future<void> _verifyOtp() async {"},{"type":"INSERT","lineNumber":101,"content":"      final success = await _viewModel.verifyOtp("},{"type":"INSERT","lineNumber":102,"content":"        VerifyOtpParams("},{"type":"INSERT","lineNumber":103,"content":"          verificationId: widget.verificationId,"},{"type":"INSERT","lineNumber":104,"content":"          smsCode: otp,"},{"type":"INSERT","lineNumber":105,"content":"        ),"},{"type":"INSERT","lineNumber":106,"content":"      );"},{"type":"INSERT","lineNumber":107,"content":"      "},{"type":"DELETE","lineNumber":96,"oldContent":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"INSERT","lineNumber":109,"content":"      "},{"type":"DELETE","lineNumber":99,"oldContent":"    if (otp.length != 6) {"},{"type":"DELETE","lineNumber":101,"oldContent":"        );"},{"type":"DELETE","lineNumber":110,"oldContent":"      return;"},{"type":"DELETE","lineNumber":112,"oldContent":"    }"},{"type":"DELETE","lineNumber":114,"oldContent":"    try {"},{"type":"DELETE","lineNumber":116,"oldContent":"        verificationId: widget.verificationId,"},{"type":"DELETE","lineNumber":118,"oldContent":"        smsCode: otp,"},{"type":"DELETE","lineNumber":120,"oldContent":"      );"},{"type":"DELETE","lineNumber":122,"oldContent":"      "},{"type":"DELETE","lineNumber":135,"oldContent":"      "},{"type":"DELETE","lineNumber":139,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":141,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":144,"oldContent":"            content: Text(message),"},{"type":"DELETE","lineNumber":146,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":149,"oldContent":"          ),"},{"type":"DELETE","lineNumber":151,"oldContent":"        );"},{"type":"DELETE","lineNumber":153,"oldContent":"      }"},{"type":"DELETE","lineNumber":155,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":157,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":159,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":154,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":155,"content":"          SnackBar("},{"type":"INSERT","lineNumber":156,"content":"            content: Text(_viewModel.errorMessage ?? 'Verification failed'),"},{"type":"INSERT","lineNumber":157,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":158,"content":"          ),"},{"type":"INSERT","lineNumber":159,"content":"        );"},{"type":"INSERT","lineNumber":160,"content":"      }"},{"type":"INSERT","lineNumber":161,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":162,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":163,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":164,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Verification failed'),"},{"type":"DELETE","lineNumber":166,"oldContent":"            backgroundColor: Colors.red,"}]},{"timestamp":1754613984035,"changes":[{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:firebase_auth/firebase_auth.dart';"},{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/auth/domain/usecases/verify_otp.dart';"},{"type":"INSERT","lineNumber":19,"content":"    this.isRegistration = false,"},{"type":"DELETE","lineNumber":20,"oldContent":"  });"},{"type":"DELETE","lineNumber":78,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":80,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":83,"oldContent":"            content: Text('Please enter a valid 6-digit OTP'),"},{"type":"DELETE","lineNumber":85,"oldContent":"            backgroundColor: Colors.orange,"},{"type":"DELETE","lineNumber":88,"oldContent":"          ),"},{"type":"DELETE","lineNumber":90,"oldContent":"      }"},{"type":"DELETE","lineNumber":93,"oldContent":"    "},{"type":"DELETE","lineNumber":94,"oldContent":"      setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":95,"oldContent":"      "},{"type":"INSERT","lineNumber":87,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":88,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":89,"content":"            content: Text('Please enter a valid 6-digit OTP'),"},{"type":"INSERT","lineNumber":90,"content":"            backgroundColor: Colors.orange,"},{"type":"INSERT","lineNumber":91,"content":"          ),"},{"type":"DELETE","lineNumber":97,"oldContent":"      // Call the verifyOtp method from AuthViewModel"},{"type":"INSERT","lineNumber":93,"content":"      }"},{"type":"DELETE","lineNumber":100,"oldContent":"      if (!mounted) return;"},{"type":"INSERT","lineNumber":96,"content":"    "},{"type":"INSERT","lineNumber":98,"content":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":99,"content":"      "},{"type":"INSERT","lineNumber":100,"content":"      // Call the verifyOtpCode method from AuthViewModel"},{"type":"INSERT","lineNumber":101,"content":"      final success = await _viewModel.verifyOtpCode("},{"type":"INSERT","lineNumber":102,"content":"        verificationId: widget.verificationId,"},{"type":"INSERT","lineNumber":103,"content":"        smsCode: otp,"},{"type":"INSERT","lineNumber":104,"content":"      );"},{"type":"INSERT","lineNumber":105,"content":"      "},{"type":"INSERT","lineNumber":106,"content":"      if (!mounted) return;"},{"type":"INSERT","lineNumber":107,"content":"      "},{"type":"DELETE","lineNumber":105,"oldContent":"      final success = await _viewModel.verifyOtp("},{"type":"DELETE","lineNumber":106,"oldContent":"        VerifyOtpParams("},{"type":"DELETE","lineNumber":108,"oldContent":"          verificationId: widget.verificationId,"},{"type":"DELETE","lineNumber":110,"oldContent":"          smsCode: otp,"},{"type":"DELETE","lineNumber":112,"oldContent":"        ),"},{"type":"DELETE","lineNumber":114,"oldContent":"      );"},{"type":"DELETE","lineNumber":116,"oldContent":"      "},{"type":"DELETE","lineNumber":119,"oldContent":"      "},{"type":"DELETE","lineNumber":150,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":149,"content":"        }"},{"type":"INSERT","lineNumber":150,"content":"      } else if (mounted) {"},{"type":"INSERT","lineNumber":151,"content":"        // Show error message from view model"},{"type":"INSERT","lineNumber":152,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":154,"oldContent":"        }"},{"type":"DELETE","lineNumber":157,"oldContent":"      } else if (mounted) {"},{"type":"DELETE","lineNumber":160,"oldContent":"        // Show error message from view model"},{"type":"DELETE","lineNumber":162,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":164,"oldContent":"            content: Text('An error occurred. Please try again.'),"},{"type":"INSERT","lineNumber":162,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":163,"content":"            content: Text('An error occurred. Please try again.'),"},{"type":"INSERT","lineNumber":168,"content":"    } finally {"},{"type":"INSERT","lineNumber":169,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":170,"content":"        setState(() => _isLoading = false);"},{"type":"INSERT","lineNumber":171,"content":"      }"},{"type":"DELETE","lineNumber":265,"oldContent":"    return WillPopScope("},{"type":"DELETE","lineNumber":266,"oldContent":"      onWillPop: _onWillPop,"},{"type":"DELETE","lineNumber":267,"oldContent":"      child: Scaffold("},{"type":"DELETE","lineNumber":268,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":269,"oldContent":"          title: const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":270,"oldContent":"          leading: IconButton("},{"type":"DELETE","lineNumber":271,"oldContent":"            icon: const Icon(Icons.arrow_back),"},{"type":"INSERT","lineNumber":267,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":268,"content":"      body: WillPopScope("},{"type":"INSERT","lineNumber":269,"content":"        onWillPop: _onWillPop,"},{"type":"INSERT","lineNumber":270,"content":"        child: Scaffold("},{"type":"INSERT","lineNumber":271,"content":"          appBar: AppBar("},{"type":"INSERT","lineNumber":272,"content":"            title: const Text('Verify OTP'),"},{"type":"INSERT","lineNumber":273,"content":"            leading: IconButton("},{"type":"INSERT","lineNumber":274,"content":"              icon: const Icon(Icons.arrow_back),"},{"type":"INSERT","lineNumber":275,"content":"              onPressed: () => _onWillPop().then((value) {"},{"type":"INSERT","lineNumber":276,"content":"                if (value) {"},{"type":"INSERT","lineNumber":277,"content":"                  Navigator.of(context).pop();"},{"type":"INSERT","lineNumber":278,"content":"                }"},{"type":"INSERT","lineNumber":279,"content":"              }),"},{"type":"INSERT","lineNumber":280,"content":"            ),"}]},{"timestamp":1754614014298,"changes":[{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/auth/domain/usecases/verify_otp.dart';"},{"type":"MODIFY","lineNumber":83,"content":"    final otp = _otpControllers.map((controller) => controller.text).join();","oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":84,"content":"    if (otp.length != 6) {"},{"type":"INSERT","lineNumber":85,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":86,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":87,"oldContent":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"DELETE","lineNumber":90,"oldContent":"    if (otp.length != 6) {"},{"type":"DELETE","lineNumber":91,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":92,"oldContent":"      }"},{"type":"DELETE","lineNumber":93,"oldContent":"    "},{"type":"DELETE","lineNumber":95,"oldContent":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":92,"content":"      }"},{"type":"DELETE","lineNumber":97,"oldContent":"      "},{"type":"DELETE","lineNumber":99,"oldContent":"      // Call the verifyOtpCode method from AuthViewModel"},{"type":"DELETE","lineNumber":100,"oldContent":"      final success = await _viewModel.verifyOtpCode("},{"type":"INSERT","lineNumber":95,"content":"    "},{"type":"DELETE","lineNumber":102,"oldContent":"        verificationId: widget.verificationId,"},{"type":"DELETE","lineNumber":103,"oldContent":"      if (success) {"},{"type":"DELETE","lineNumber":104,"oldContent":"        smsCode: otp,"},{"type":"DELETE","lineNumber":105,"oldContent":"        // If this is part of registration, update the phone number"},{"type":"INSERT","lineNumber":97,"content":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":98,"content":"      "},{"type":"INSERT","lineNumber":99,"content":"      // Call the verifyOtp method from AuthViewModel"},{"type":"INSERT","lineNumber":100,"content":"      final result = await _viewModel.verifyOtp("},{"type":"INSERT","lineNumber":101,"content":"        VerifyOtpParams("},{"type":"INSERT","lineNumber":102,"content":"          verificationId: widget.verificationId,"},{"type":"INSERT","lineNumber":103,"content":"          smsCode: otp,"},{"type":"INSERT","lineNumber":104,"content":"        ),"},{"type":"DELETE","lineNumber":107,"oldContent":"        if (widget.isRegistration && widget.phoneNumber.isNotEmpty) {"},{"type":"INSERT","lineNumber":109,"content":"      final success = result.fold("},{"type":"INSERT","lineNumber":110,"content":"        (failure) {"},{"type":"INSERT","lineNumber":111,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":112,"content":"            SnackBar("},{"type":"INSERT","lineNumber":113,"content":"              content: Text(failure.message),"},{"type":"INSERT","lineNumber":114,"content":"              backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":115,"content":"            ),"},{"type":"INSERT","lineNumber":116,"content":"          );"},{"type":"INSERT","lineNumber":117,"content":"          return false;"},{"type":"INSERT","lineNumber":118,"content":"        },"},{"type":"INSERT","lineNumber":119,"content":"        (_) => true,"},{"type":"INSERT","lineNumber":120,"content":"      );"},{"type":"INSERT","lineNumber":121,"content":"      "},{"type":"INSERT","lineNumber":122,"content":"      if (success) {"},{"type":"INSERT","lineNumber":123,"content":"        // If this is part of registration, update the phone number"},{"type":"INSERT","lineNumber":124,"content":"        if (widget.isRegistration && widget.phoneNumber.isNotEmpty) {"},{"type":"DELETE","lineNumber":147,"oldContent":"        }"},{"type":"DELETE","lineNumber":149,"oldContent":"      } else if (mounted) {"},{"type":"DELETE","lineNumber":150,"oldContent":"        // Show error message from view model"},{"type":"DELETE","lineNumber":152,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":153,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":154,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Verification failed'),"},{"type":"DELETE","lineNumber":155,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":156,"oldContent":"          ),"},{"type":"DELETE","lineNumber":157,"oldContent":"        );"},{"type":"INSERT","lineNumber":163,"content":"        }"},{"type":"DELETE","lineNumber":160,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":161,"oldContent":"            content: Text('An error occurred. Please try again.'),"},{"type":"INSERT","lineNumber":168,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":169,"content":"            content: Text('An error occurred. Please try again.'),"},{"type":"DELETE","lineNumber":166,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":168,"oldContent":"      if (mounted) {"},{"type":"INSERT","lineNumber":174,"content":"    } finally {"},{"type":"INSERT","lineNumber":175,"content":"      if (mounted) {"},{"type":"DELETE","lineNumber":171,"oldContent":"    }"},{"type":"INSERT","lineNumber":178,"content":"    }"},{"type":"DELETE","lineNumber":267,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":268,"oldContent":"      body: WillPopScope("},{"type":"DELETE","lineNumber":269,"oldContent":"        onWillPop: _onWillPop,"},{"type":"DELETE","lineNumber":270,"oldContent":"        child: Scaffold("},{"type":"DELETE","lineNumber":271,"oldContent":"          appBar: AppBar("},{"type":"DELETE","lineNumber":272,"oldContent":"            title: const Text('Verify OTP'),"},{"type":"INSERT","lineNumber":273,"content":"    return WillPopScope("},{"type":"INSERT","lineNumber":274,"content":"      onWillPop: _onWillPop,"},{"type":"INSERT","lineNumber":275,"content":"      child: Scaffold("},{"type":"INSERT","lineNumber":276,"content":"        appBar: AppBar("},{"type":"INSERT","lineNumber":277,"content":"          title: const Text('Verify OTP'),"},{"type":"INSERT","lineNumber":278,"content":"          leading: IconButton("},{"type":"INSERT","lineNumber":279,"content":"            icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":274,"oldContent":"            leading: IconButton("},{"type":"DELETE","lineNumber":276,"oldContent":"              icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":278,"oldContent":"              onPressed: () => _onWillPop().then((value) {"},{"type":"DELETE","lineNumber":280,"oldContent":"                if (value) {"},{"type":"DELETE","lineNumber":282,"oldContent":"                  Navigator.of(context).pop();"},{"type":"DELETE","lineNumber":284,"oldContent":"                }"},{"type":"INSERT","lineNumber":286,"content":"          ),"},{"type":"DELETE","lineNumber":286,"oldContent":"              }),"},{"type":"DELETE","lineNumber":288,"oldContent":"            ),"}]},{"timestamp":1754614044421,"changes":[{"type":"INSERT","lineNumber":5,"content":"import 'package:family_tree_firebase/features/auth/domain/usecases/verify_otp.dart';"},{"type":"INSERT","lineNumber":16,"content":"    required this.verificationId,"},{"type":"DELETE","lineNumber":16,"oldContent":"  });"},{"type":"INSERT","lineNumber":20,"content":"  });"},{"type":"DELETE","lineNumber":28,"oldContent":"  bool _isLoading = false;"},{"type":"INSERT","lineNumber":35,"content":""},{"type":"DELETE","lineNumber":36,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":41,"oldContent":"    _resendTimer.cancel();"},{"type":"INSERT","lineNumber":42,"content":"    "},{"type":"INSERT","lineNumber":83,"content":"  Future<void> _verifyOtp() async {"},{"type":"DELETE","lineNumber":84,"oldContent":"  Future<void> _verifyOtp() async {"},{"type":"DELETE","lineNumber":86,"oldContent":"          const SnackBar("},{"type":"INSERT","lineNumber":88,"content":"          const SnackBar("},{"type":"DELETE","lineNumber":91,"oldContent":"      }"},{"type":"MODIFY","lineNumber":93,"content":"      }","oldContent":"    "},{"type":"INSERT","lineNumber":95,"content":"    }"},{"type":"INSERT","lineNumber":96,"content":"    "},{"type":"INSERT","lineNumber":97,"content":"    try {"},{"type":"DELETE","lineNumber":97,"oldContent":"    }"},{"type":"DELETE","lineNumber":101,"oldContent":"    try {"},{"type":"DELETE","lineNumber":107,"oldContent":"      final success = result.fold("},{"type":"DELETE","lineNumber":109,"oldContent":"        (failure) {"},{"type":"INSERT","lineNumber":110,"content":"      final success = result.fold("},{"type":"INSERT","lineNumber":111,"content":"        (failure) {"},{"type":"DELETE","lineNumber":112,"oldContent":"          await _viewModel.updateUserPhoneNumber(widget.phoneNumber);"},{"type":"DELETE","lineNumber":114,"oldContent":"        }"},{"type":"DELETE","lineNumber":116,"oldContent":"        "},{"type":"DELETE","lineNumber":118,"oldContent":"        // Show success message"},{"type":"DELETE","lineNumber":120,"oldContent":"        if (mounted) {"},{"type":"DELETE","lineNumber":122,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":124,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":126,"oldContent":"              content: Text('Phone number verified successfully!'),"},{"type":"DELETE","lineNumber":128,"oldContent":"              backgroundColor: Colors.green,"},{"type":"DELETE","lineNumber":130,"oldContent":"            ),"},{"type":"DELETE","lineNumber":132,"oldContent":"          );"},{"type":"DELETE","lineNumber":134,"oldContent":"          "},{"type":"DELETE","lineNumber":136,"oldContent":"          // Navigate based on the context"},{"type":"INSERT","lineNumber":126,"content":"          await _viewModel.updateUserPhoneNumber(widget.phoneNumber);"},{"type":"INSERT","lineNumber":127,"content":"        }"},{"type":"INSERT","lineNumber":128,"content":"        "},{"type":"INSERT","lineNumber":129,"content":"        // Show success message"},{"type":"INSERT","lineNumber":130,"content":"        if (mounted) {"},{"type":"INSERT","lineNumber":131,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":132,"content":"            const SnackBar("},{"type":"INSERT","lineNumber":133,"content":"              content: Text('Phone number verified successfully!'),"},{"type":"INSERT","lineNumber":134,"content":"              backgroundColor: Colors.green,"},{"type":"INSERT","lineNumber":135,"content":"            ),"},{"type":"INSERT","lineNumber":136,"content":"          );"},{"type":"INSERT","lineNumber":137,"content":"          "},{"type":"INSERT","lineNumber":138,"content":"          // Navigate based on the context"},{"type":"INSERT","lineNumber":164,"content":"        }"},{"type":"DELETE","lineNumber":166,"oldContent":"        }"},{"type":"INSERT","lineNumber":169,"content":"          const SnackBar("},{"type":"INSERT","lineNumber":170,"content":"            content: Text('An error occurred. Please try again.'),"},{"type":"DELETE","lineNumber":171,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":172,"oldContent":"            content: Text('An error occurred. Please try again.'),"},{"type":"INSERT","lineNumber":175,"content":"    } finally {"},{"type":"INSERT","lineNumber":176,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":179,"content":"    }"},{"type":"DELETE","lineNumber":177,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":179,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":183,"oldContent":"    }"},{"type":"DELETE","lineNumber":274,"oldContent":"            onPressed: () => _onWillPop().then((value) {"},{"type":"DELETE","lineNumber":277,"oldContent":"              if (value) {"},{"type":"DELETE","lineNumber":280,"oldContent":"                Navigator.of(context).pop();"},{"type":"INSERT","lineNumber":281,"content":"            onPressed: () => _onWillPop().then((value) {"},{"type":"INSERT","lineNumber":282,"content":"              if (value) {"},{"type":"INSERT","lineNumber":283,"content":"                Navigator.of(context).pop();"},{"type":"DELETE","lineNumber":287,"oldContent":"          ),"}]},{"timestamp":1754614059525,"changes":[{"type":"MODIFY","lineNumber":17,"content":"    required this.phoneNumber,","oldContent":"    required this.phoneNumber,"},{"type":"MODIFY","lineNumber":21,"content":"","oldContent":""},{"type":"MODIFY","lineNumber":36,"content":"  @override","oldContent":"  @override"},{"type":"MODIFY","lineNumber":84,"content":"    final otp = _otpControllers.map((controller) => controller.text).join();","oldContent":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"DELETE","lineNumber":96,"oldContent":"      setState(() => _isLoading = true);"},{"type":"MODIFY","lineNumber":98,"content":"      setState(() => _isLoading = true);","oldContent":"      "},{"type":"INSERT","lineNumber":99,"content":"      "},{"type":"MODIFY","lineNumber":110,"content":"      final success = result.fold(","oldContent":"      final success = result.fold("},{"type":"INSERT","lineNumber":120,"content":"        (_) => true,"},{"type":"INSERT","lineNumber":121,"content":"      );"},{"type":"INSERT","lineNumber":122,"content":"      "},{"type":"INSERT","lineNumber":123,"content":"      if (success) {"},{"type":"INSERT","lineNumber":124,"content":"        // If this is part of registration, update the phone number"},{"type":"INSERT","lineNumber":125,"content":"        if (widget.isRegistration && widget.phoneNumber.isNotEmpty) {"},{"type":"DELETE","lineNumber":122,"oldContent":"        (_) => true,"},{"type":"DELETE","lineNumber":125,"oldContent":"      );"},{"type":"DELETE","lineNumber":128,"oldContent":"      "},{"type":"DELETE","lineNumber":131,"oldContent":"      if (success) {"},{"type":"DELETE","lineNumber":134,"oldContent":"        // If this is part of registration, update the phone number"},{"type":"DELETE","lineNumber":137,"oldContent":"        if (widget.isRegistration && widget.phoneNumber.isNotEmpty) {"},{"type":"MODIFY","lineNumber":165,"content":"      }","oldContent":"      }"},{"type":"DELETE","lineNumber":169,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"MODIFY","lineNumber":171,"content":"            behavior: SnackBarBehavior.floating,","oldContent":"          ),"},{"type":"INSERT","lineNumber":172,"content":"          ),"},{"type":"DELETE","lineNumber":175,"oldContent":"        setState(() => _isLoading = false);"},{"type":"MODIFY","lineNumber":177,"content":"        setState(() => _isLoading = false);","oldContent":"      }"},{"type":"INSERT","lineNumber":178,"content":"      }"},{"type":"INSERT","lineNumber":179,"content":"    }"},{"type":"DELETE","lineNumber":181,"oldContent":"    }"},{"type":"DELETE","lineNumber":276,"oldContent":"      child: Scaffold("},{"type":"DELETE","lineNumber":277,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":278,"oldContent":"          title: const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":279,"oldContent":"            onPressed: () => _onWillPop().then((value) {"},{"type":"DELETE","lineNumber":280,"oldContent":"          leading: IconButton("},{"type":"DELETE","lineNumber":281,"oldContent":"              if (value) {"},{"type":"DELETE","lineNumber":282,"oldContent":"            icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":283,"oldContent":"                Navigator.of(context).pop();"},{"type":"DELETE","lineNumber":284,"oldContent":"              }"},{"type":"DELETE","lineNumber":285,"oldContent":"            }),"},{"type":"DELETE","lineNumber":286,"oldContent":"          ),"},{"type":"DELETE","lineNumber":287,"oldContent":"        ),"},{"type":"DELETE","lineNumber":288,"oldContent":"        body: SingleChildScrollView("},{"type":"INSERT","lineNumber":276,"content":"      child: Stack("},{"type":"INSERT","lineNumber":277,"content":"        children: ["},{"type":"INSERT","lineNumber":278,"content":"          Scaffold("},{"type":"INSERT","lineNumber":279,"content":"            appBar: AppBar("},{"type":"INSERT","lineNumber":280,"content":"              title: const Text('Verify OTP'),"},{"type":"INSERT","lineNumber":281,"content":"              leading: IconButton("},{"type":"INSERT","lineNumber":282,"content":"                icon: const Icon(Icons.arrow_back),"},{"type":"INSERT","lineNumber":283,"content":"                onPressed: _isLoading"},{"type":"INSERT","lineNumber":284,"content":"                    ? null"},{"type":"INSERT","lineNumber":285,"content":"                    : () => _onWillPop().then((value) {"},{"type":"INSERT","lineNumber":286,"content":"                          if (value) {"},{"type":"INSERT","lineNumber":287,"content":"                            Navigator.of(context).pop();"},{"type":"INSERT","lineNumber":288,"content":"                          }"},{"type":"INSERT","lineNumber":289,"content":"                        }),"},{"type":"INSERT","lineNumber":290,"content":"              ),"},{"type":"INSERT","lineNumber":291,"content":"            ),"},{"type":"INSERT","lineNumber":292,"content":"            body: SingleChildScrollView("},{"type":"INSERT","lineNumber":353,"content":"              ),"},{"type":"INSERT","lineNumber":354,"content":"            ),"},{"type":"DELETE","lineNumber":350,"oldContent":"        ),"},{"type":"INSERT","lineNumber":356,"content":"          if (_isLoading)"},{"type":"INSERT","lineNumber":357,"content":"            const Center("},{"type":"INSERT","lineNumber":358,"content":"              child: CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":359,"content":"            ),"},{"type":"INSERT","lineNumber":360,"content":"        ],"}]},{"timestamp":1754628865157,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/success_screen.dart';","oldContent":""},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:provider/provider.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:family_tree_firebase/core/constants/app_constants.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/auth/domain/usecases/verify_otp.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"INSERT","lineNumber":4,"content":"import 'package:google_fonts/google_fonts.dart';"},{"type":"INSERT","lineNumber":5,"content":"import '../bloc/auth_bloc.dart';"},{"type":"DELETE","lineNumber":11,"oldContent":"  final String? email;"},{"type":"DELETE","lineNumber":15,"oldContent":"    super.key,"},{"type":"INSERT","lineNumber":13,"content":"    Key? key,"},{"type":"INSERT","lineNumber":14,"content":"    required this.verificationId,"},{"type":"DELETE","lineNumber":17,"oldContent":"    required this.phoneNumber,"},{"type":"DELETE","lineNumber":18,"oldContent":"    this.email,"},{"type":"INSERT","lineNumber":17,"content":"  }) : super(key: key);"},{"type":"DELETE","lineNumber":21,"oldContent":""},{"type":"DELETE","lineNumber":23,"oldContent":"  State<OtpVerificationScreen> createState() => _OtpVerificationScreenState();"},{"type":"INSERT","lineNumber":20,"content":"  _OtpVerificationScreenState createState() => _OtpVerificationScreenState();"},{"type":"DELETE","lineNumber":27,"oldContent":"  final List<TextEditingController> _otpControllers ="},{"type":"DELETE","lineNumber":28,"oldContent":"      List.generate(6, (index) => TextEditingController());"},{"type":"INSERT","lineNumber":24,"content":"  final List<TextEditingController> _otpControllers = List.generate(6, (index) => TextEditingController());"},{"type":"DELETE","lineNumber":30,"oldContent":"  late AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":31,"oldContent":"  bool _isResendLoading = false;"},{"type":"DELETE","lineNumber":32,"oldContent":"  bool _isLoading = false;"},{"type":"DELETE","lineNumber":33,"oldContent":"  int _resendCodeIn = 30;"},{"type":"DELETE","lineNumber":34,"oldContent":"  late Timer _resendTimer;"},{"type":"INSERT","lineNumber":26,"content":"  int _resendTimer = 30;"},{"type":"INSERT","lineNumber":27,"content":"  bool _canResend = false;"},{"type":"INSERT","lineNumber":28,"content":"  Timer? _timer;"},{"type":"INSERT","lineNumber":29,"content":""},{"type":"DELETE","lineNumber":36,"oldContent":"  @override"},{"type":"DELETE","lineNumber":39,"oldContent":"    _viewModel = context.read<AuthViewModel>();"},{"type":"DELETE","lineNumber":40,"oldContent":"    _viewModel.addListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":42,"oldContent":"    "},{"type":"DELETE","lineNumber":44,"oldContent":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"DELETE","lineNumber":45,"oldContent":"      if (mounted && _focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":46,"oldContent":"  }"},{"type":"DELETE","lineNumber":47,"oldContent":"  void _startResendTimer() {"},{"type":"INSERT","lineNumber":35,"content":"    Future.delayed(Duration.zero, () {"},{"type":"INSERT","lineNumber":36,"content":"      FocusScope.of(context).requestFocus(_focusNodes[0]);"},{"type":"DELETE","lineNumber":59,"oldContent":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":60,"oldContent":"    _resendTimer.cancel();"},{"type":"INSERT","lineNumber":48,"content":"    _timer?.cancel();"},{"type":"DELETE","lineNumber":64,"oldContent":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":65,"oldContent":"    if (_viewModel.isLoading) return;"},{"type":"DELETE","lineNumber":66,"oldContent":"    "},{"type":"DELETE","lineNumber":67,"oldContent":"    // Clear any previous error messages"},{"type":"DELETE","lineNumber":68,"oldContent":"    if (_viewModel.errorMessage != null) {"},{"type":"DELETE","lineNumber":69,"oldContent":"      _viewModel.clearError();"},{"type":"DELETE","lineNumber":70,"oldContent":"    }"},{"type":"DELETE","lineNumber":71,"oldContent":"  }"},{"type":"DELETE","lineNumber":72,"oldContent":""},{"type":"DELETE","lineNumber":74,"oldContent":"    _resendTimer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"DELETE","lineNumber":75,"oldContent":"      if (_resendCodeIn > 0) {"},{"type":"DELETE","lineNumber":76,"oldContent":"        setState(() => _resendCodeIn--);"},{"type":"INSERT","lineNumber":53,"content":"    setState(() {"},{"type":"INSERT","lineNumber":54,"content":"      _resendTimer = 30;"},{"type":"INSERT","lineNumber":55,"content":"      _canResend = false;"},{"type":"INSERT","lineNumber":56,"content":"    });"},{"type":"INSERT","lineNumber":57,"content":""},{"type":"INSERT","lineNumber":58,"content":"    _timer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"INSERT","lineNumber":59,"content":"      if (_resendTimer > 0) {"},{"type":"INSERT","lineNumber":60,"content":"        setState(() {"},{"type":"INSERT","lineNumber":61,"content":"          _resendTimer--;"},{"type":"INSERT","lineNumber":62,"content":"        });"},{"type":"DELETE","lineNumber":78,"oldContent":"        _resendTimer.cancel();"},{"type":"INSERT","lineNumber":64,"content":"        setState(() {"},{"type":"INSERT","lineNumber":65,"content":"          _canResend = true;"},{"type":"INSERT","lineNumber":66,"content":"        });"},{"type":"INSERT","lineNumber":67,"content":"        timer.cancel();"},{"type":"DELETE","lineNumber":83,"oldContent":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"DELETE","lineNumber":84,"oldContent":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"DELETE","lineNumber":85,"oldContent":"    if (otp.length != 6) {"},{"type":"DELETE","lineNumber":86,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":87,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":88,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":89,"oldContent":"            content: Text('Please enter a valid 6-digit OTP'),"},{"type":"DELETE","lineNumber":90,"oldContent":"            backgroundColor: Colors.orange,"},{"type":"DELETE","lineNumber":91,"oldContent":"          ),"},{"type":"DELETE","lineNumber":92,"oldContent":"        );"},{"type":"DELETE","lineNumber":93,"oldContent":"      }"},{"type":"DELETE","lineNumber":94,"oldContent":"      return;"},{"type":"INSERT","lineNumber":72,"content":"  void _onOtpChanged(String value, int index) {"},{"type":"INSERT","lineNumber":73,"content":"    if (value.length == 1 && index < 5) {"},{"type":"INSERT","lineNumber":74,"content":"      FocusScope.of(context).requestFocus(_focusNodes[index + 1]);"},{"type":"INSERT","lineNumber":75,"content":"    } else if (value.isEmpty && index > 0) {"},{"type":"INSERT","lineNumber":76,"content":"      FocusScope.of(context).requestFocus(_focusNodes[index - 1]);"},{"type":"DELETE","lineNumber":96,"oldContent":"    "},{"type":"DELETE","lineNumber":97,"oldContent":"      setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":98,"oldContent":"      "},{"type":"DELETE","lineNumber":99,"oldContent":"    try {"},{"type":"DELETE","lineNumber":100,"oldContent":"      // Call the verifyOtp method from AuthViewModel"},{"type":"DELETE","lineNumber":101,"oldContent":"      final result = await _viewModel.verifyOtp("},{"type":"DELETE","lineNumber":102,"oldContent":"        VerifyOtpParams("},{"type":"DELETE","lineNumber":103,"oldContent":"          verificationId: widget.verificationId,"},{"type":"DELETE","lineNumber":104,"oldContent":"          smsCode: otp,"},{"type":"DELETE","lineNumber":105,"oldContent":"        ),"},{"type":"DELETE","lineNumber":106,"oldContent":"      );"},{"type":"DELETE","lineNumber":107,"oldContent":"      "},{"type":"DELETE","lineNumber":108,"oldContent":"      if (!mounted) return;"},{"type":"DELETE","lineNumber":109,"oldContent":"      final success = result.fold("},{"type":"DELETE","lineNumber":110,"oldContent":"      final success = result.fold("},{"type":"DELETE","lineNumber":111,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":112,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":113,"oldContent":"            SnackBar("},{"type":"DELETE","lineNumber":114,"oldContent":"              content: Text(failure.message),"},{"type":"DELETE","lineNumber":115,"oldContent":"              backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":116,"oldContent":"            ),"},{"type":"DELETE","lineNumber":117,"oldContent":"          );"},{"type":"DELETE","lineNumber":118,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":119,"oldContent":"        },"},{"type":"DELETE","lineNumber":120,"oldContent":"        (_) => true,"},{"type":"DELETE","lineNumber":121,"oldContent":"          await _viewModel.updateUserPhoneNumber(widget.phoneNumber);"},{"type":"DELETE","lineNumber":122,"oldContent":"      );"},{"type":"DELETE","lineNumber":123,"oldContent":"        }"},{"type":"DELETE","lineNumber":124,"oldContent":"      "},{"type":"DELETE","lineNumber":125,"oldContent":"      if (success) {"},{"type":"DELETE","lineNumber":126,"oldContent":"        "},{"type":"DELETE","lineNumber":127,"oldContent":"        // If this is part of registration, update the phone number"},{"type":"DELETE","lineNumber":128,"oldContent":"        // Show success message"},{"type":"DELETE","lineNumber":129,"oldContent":"        if (widget.isRegistration && widget.phoneNumber.isNotEmpty) {"},{"type":"DELETE","lineNumber":130,"oldContent":"        if (mounted) {"},{"type":"DELETE","lineNumber":131,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":132,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":133,"oldContent":"              content: Text('Phone number verified successfully!'),"},{"type":"DELETE","lineNumber":134,"oldContent":"              backgroundColor: Colors.green,"},{"type":"DELETE","lineNumber":135,"oldContent":"            ),"},{"type":"DELETE","lineNumber":136,"oldContent":"          );"},{"type":"DELETE","lineNumber":137,"oldContent":"          "},{"type":"DELETE","lineNumber":138,"oldContent":"          // Navigate based on the context"},{"type":"DELETE","lineNumber":139,"oldContent":"          if (widget.isRegistration) {"},{"type":"DELETE","lineNumber":140,"oldContent":"            // For registration, go to home screen"},{"type":"DELETE","lineNumber":141,"oldContent":"            Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":142,"oldContent":"              context,"},{"type":"DELETE","lineNumber":143,"oldContent":"              AppConstants.homeRoute,"},{"type":"DELETE","lineNumber":144,"oldContent":"              (route) => false,"},{"type":"DELETE","lineNumber":145,"oldContent":"            );"},{"type":"DELETE","lineNumber":146,"oldContent":"          } else if (widget.email != null && widget.email!.isNotEmpty) {"},{"type":"DELETE","lineNumber":147,"oldContent":"            // For password reset, go to setup password screen"},{"type":"DELETE","lineNumber":148,"oldContent":"            Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":149,"oldContent":"              context,"},{"type":"DELETE","lineNumber":150,"oldContent":"              AppConstants.setupPasswordRoute,"},{"type":"DELETE","lineNumber":151,"oldContent":"              arguments: {"},{"type":"DELETE","lineNumber":152,"oldContent":"                'email': widget.email,"},{"type":"DELETE","lineNumber":153,"oldContent":"                'phone': widget.phoneNumber,"},{"type":"DELETE","lineNumber":154,"oldContent":"              },"},{"type":"DELETE","lineNumber":155,"oldContent":"            );"},{"type":"DELETE","lineNumber":156,"oldContent":"          } else {"},{"type":"DELETE","lineNumber":157,"oldContent":"            // Default navigation to home screen"},{"type":"DELETE","lineNumber":158,"oldContent":"            Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":159,"oldContent":"              context,"},{"type":"DELETE","lineNumber":160,"oldContent":"              AppConstants.homeRoute,"},{"type":"DELETE","lineNumber":161,"oldContent":"              (route) => false,"},{"type":"DELETE","lineNumber":162,"oldContent":"            );"},{"type":"DELETE","lineNumber":163,"oldContent":"          }"},{"type":"DELETE","lineNumber":164,"oldContent":"      }"},{"type":"DELETE","lineNumber":165,"oldContent":"      }"},{"type":"DELETE","lineNumber":166,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":167,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":168,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":169,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":170,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":171,"oldContent":"          ),"},{"type":"DELETE","lineNumber":172,"oldContent":"            content: Text('An error occurred. Please try again.'),"},{"type":"DELETE","lineNumber":173,"oldContent":"        );"},{"type":"DELETE","lineNumber":174,"oldContent":"      }"},{"type":"DELETE","lineNumber":175,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":176,"oldContent":"        setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":177,"oldContent":"      }"},{"type":"DELETE","lineNumber":178,"oldContent":"      if (mounted) {"},{"type":"INSERT","lineNumber":78,"content":""},{"type":"INSERT","lineNumber":79,"content":"    // Auto-verify if all fields are filled"},{"type":"INSERT","lineNumber":80,"content":"    bool allFilled = _otpControllers.every((controller) => controller.text.isNotEmpty);"},{"type":"INSERT","lineNumber":81,"content":"    if (allFilled) {"},{"type":"INSERT","lineNumber":82,"content":"      _verifyOtp();"},{"type":"DELETE","lineNumber":182,"oldContent":"  Future<void> _resendOtp() async {"},{"type":"DELETE","lineNumber":183,"oldContent":"    if (_isResendLoading || _resendCodeIn > 0) return;"},{"type":"DELETE","lineNumber":184,"oldContent":""},{"type":"DELETE","lineNumber":185,"oldContent":"    setState(() => _isResendLoading = true);"},{"type":"DELETE","lineNumber":186,"oldContent":""},{"type":"DELETE","lineNumber":187,"oldContent":"    try {"},{"type":"DELETE","lineNumber":188,"oldContent":"      final success = await _viewModel.sendOtp(widget.phoneNumber);"},{"type":"DELETE","lineNumber":189,"oldContent":"      "},{"type":"DELETE","lineNumber":190,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":191,"oldContent":"        // Clear OTP fields"},{"type":"DELETE","lineNumber":192,"oldContent":"        for (var controller in _otpControllers) {"},{"type":"DELETE","lineNumber":193,"oldContent":"          controller.clear();"},{"type":"DELETE","lineNumber":194,"oldContent":"        }"},{"type":"DELETE","lineNumber":195,"oldContent":"        "},{"type":"DELETE","lineNumber":196,"oldContent":"        // Focus first field"},{"type":"DELETE","lineNumber":197,"oldContent":"        if (_focusNodes[0].canRequestFocus) {"},{"type":"DELETE","lineNumber":198,"oldContent":"          _focusNodes[0].requestFocus();"},{"type":"DELETE","lineNumber":199,"oldContent":"        }"},{"type":"DELETE","lineNumber":200,"oldContent":""},{"type":"DELETE","lineNumber":201,"oldContent":"        if (success) {"},{"type":"DELETE","lineNumber":202,"oldContent":"          // Reset timer"},{"type":"DELETE","lineNumber":203,"oldContent":"          setState(() => _resendCodeIn = 30);"},{"type":"DELETE","lineNumber":204,"oldContent":"          _startResendTimer();"},{"type":"DELETE","lineNumber":205,"oldContent":"          "},{"type":"DELETE","lineNumber":206,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":207,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":208,"oldContent":"              content: Text('OTP has been resent successfully'),"},{"type":"DELETE","lineNumber":209,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":86,"content":"  void _verifyOtp() {"},{"type":"INSERT","lineNumber":87,"content":"    final otp = _otpControllers.map((controller) => controller.text).join();"},{"type":"INSERT","lineNumber":88,"content":"    if (otp.length == 6) {"},{"type":"INSERT","lineNumber":89,"content":"      context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":90,"content":"            VerifyOtpRequested("},{"type":"INSERT","lineNumber":91,"content":"              verificationId: widget.verificationId,"},{"type":"INSERT","lineNumber":92,"content":"              smsCode: otp,"},{"type":"DELETE","lineNumber":212,"oldContent":"        } else if (_viewModel.errorMessage?.isNotEmpty ?? false) {"},{"type":"DELETE","lineNumber":213,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":214,"oldContent":"            SnackBar("},{"type":"DELETE","lineNumber":215,"oldContent":"              content: Text(_viewModel.errorMessage!),"},{"type":"DELETE","lineNumber":216,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":217,"oldContent":"            ),"},{"type":"DELETE","lineNumber":218,"oldContent":"          );"},{"type":"DELETE","lineNumber":219,"oldContent":"        }"},{"type":"DELETE","lineNumber":220,"oldContent":"      }"},{"type":"DELETE","lineNumber":221,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":222,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":223,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":224,"oldContent":"          const SnackBar("},{"type":"DELETE","lineNumber":225,"oldContent":"            content: Text('Failed to resend OTP. Please try again.'),"},{"type":"DELETE","lineNumber":226,"oldContent":"            behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":227,"oldContent":"          ),"},{"type":"DELETE","lineNumber":228,"oldContent":"        );"},{"type":"DELETE","lineNumber":229,"oldContent":"      }"},{"type":"DELETE","lineNumber":230,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":231,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":232,"oldContent":"        setState(() => _isResendLoading = false);"},{"type":"DELETE","lineNumber":233,"oldContent":"      }"},{"type":"DELETE","lineNumber":237,"oldContent":"  void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":238,"oldContent":"    if (value.length == 1 && index < _otpControllers.length - 1) {"},{"type":"DELETE","lineNumber":239,"oldContent":"      _focusNodes[index + 1].requestFocus();"},{"type":"DELETE","lineNumber":240,"oldContent":"    } else if (value.isEmpty && index > 0) {"},{"type":"DELETE","lineNumber":241,"oldContent":"      _focusNodes[index - 1].requestFocus();"},{"type":"INSERT","lineNumber":98,"content":"  void _resendOtp() {"},{"type":"INSERT","lineNumber":99,"content":"    if (_canResend) {"},{"type":"INSERT","lineNumber":100,"content":"      context.read<AuthBloc>().add(SendOtpRequested(widget.phoneNumber));"},{"type":"INSERT","lineNumber":101,"content":"      _startResendTimer();"},{"type":"DELETE","lineNumber":245,"oldContent":"  Future<bool> _onWillPop() async {"},{"type":"DELETE","lineNumber":246,"oldContent":"    if (_viewModel.isLoading) return false;"},{"type":"DELETE","lineNumber":247,"oldContent":"    "},{"type":"DELETE","lineNumber":248,"oldContent":"    final shouldPop = await showDialog<bool>("},{"type":"DELETE","lineNumber":249,"oldContent":"      context: context,"},{"type":"DELETE","lineNumber":250,"oldContent":"      builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":251,"oldContent":"        title: const Text('Are you sure?'),"},{"type":"DELETE","lineNumber":252,"oldContent":"        content: const Text('Do you want to cancel OTP verification?'),"},{"type":"DELETE","lineNumber":253,"oldContent":"        actions: ["},{"type":"DELETE","lineNumber":254,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":255,"oldContent":"            onPressed: () => Navigator.of(context).pop(false),"},{"type":"DELETE","lineNumber":256,"oldContent":"            child: const Text('No'),"},{"type":"DELETE","lineNumber":257,"oldContent":"          ),"},{"type":"DELETE","lineNumber":258,"oldContent":"          TextButton("},{"type":"DELETE","lineNumber":259,"oldContent":"            onPressed: () {"},{"type":"DELETE","lineNumber":260,"oldContent":"              _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":261,"oldContent":"              Navigator.of(context).pop(true);"},{"type":"DELETE","lineNumber":262,"oldContent":"            },"},{"type":"DELETE","lineNumber":263,"oldContent":"            child: const Text('Yes'),"},{"type":"DELETE","lineNumber":264,"oldContent":"          ),"},{"type":"DELETE","lineNumber":265,"oldContent":"        ],"},{"type":"DELETE","lineNumber":266,"oldContent":"      ),"},{"type":"DELETE","lineNumber":267,"oldContent":"    );"},{"type":"DELETE","lineNumber":268,"oldContent":"    "},{"type":"DELETE","lineNumber":269,"oldContent":"    return shouldPop ?? false;"},{"type":"DELETE","lineNumber":270,"oldContent":"  }"},{"type":"DELETE","lineNumber":271,"oldContent":""},{"type":"DELETE","lineNumber":274,"oldContent":"    return WillPopScope("},{"type":"DELETE","lineNumber":275,"oldContent":"      onWillPop: _onWillPop,"},{"type":"DELETE","lineNumber":276,"oldContent":"      child: Stack("},{"type":"DELETE","lineNumber":277,"oldContent":"        children: ["},{"type":"DELETE","lineNumber":278,"oldContent":"          Scaffold("},{"type":"DELETE","lineNumber":279,"oldContent":"            appBar: AppBar("},{"type":"DELETE","lineNumber":280,"oldContent":"              title: const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":281,"oldContent":"              leading: IconButton("},{"type":"DELETE","lineNumber":282,"oldContent":"                icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":283,"oldContent":"                onPressed: _isLoading"},{"type":"DELETE","lineNumber":284,"oldContent":"                    ? null"},{"type":"DELETE","lineNumber":285,"oldContent":"                    : () => _onWillPop().then((value) {"},{"type":"DELETE","lineNumber":286,"oldContent":"                          if (value) {"},{"type":"DELETE","lineNumber":287,"oldContent":"                            Navigator.of(context).pop();"},{"type":"DELETE","lineNumber":288,"oldContent":"                          }"},{"type":"DELETE","lineNumber":289,"oldContent":"                        }),"},{"type":"DELETE","lineNumber":290,"oldContent":"          padding: const EdgeInsets.all(16.0),"},{"type":"INSERT","lineNumber":107,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":108,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":109,"content":"        leading: IconButton("},{"type":"INSERT","lineNumber":110,"content":"          icon: const Icon(Icons.arrow_back_ios, color: Color(0xFF333333)),"},{"type":"INSERT","lineNumber":111,"content":"          onPressed: () => Navigator.pop(context),"},{"type":"INSERT","lineNumber":112,"content":"        ),"},{"type":"INSERT","lineNumber":113,"content":"        title: Text("},{"type":"INSERT","lineNumber":114,"content":"          'Verification',"},{"type":"INSERT","lineNumber":115,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":116,"content":"            color: const Color(0xFF333333),"},{"type":"INSERT","lineNumber":117,"content":"            fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":118,"content":"          ),"},{"type":"INSERT","lineNumber":119,"content":"        ),"},{"type":"INSERT","lineNumber":120,"content":"        backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":121,"content":"        elevation: 0,"},{"type":"INSERT","lineNumber":122,"content":"      ),"},{"type":"INSERT","lineNumber":123,"content":"      body: BlocConsumer<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":124,"content":"        listener: (context, state) {"},{"type":"INSERT","lineNumber":125,"content":"          if (state.status == AuthStatus.verificationSuccessful) {"},{"type":"INSERT","lineNumber":126,"content":"            // Navigate to success screen or home screen"},{"type":"INSERT","lineNumber":127,"content":"            Navigator.pushReplacement("},{"type":"INSERT","lineNumber":128,"content":"              context,"},{"type":"INSERT","lineNumber":129,"content":"              MaterialPageRoute("},{"type":"INSERT","lineNumber":130,"content":"                builder: (context) => const SuccessScreen("},{"type":"INSERT","lineNumber":131,"content":"                  title: 'Verification Successful!',"},{"type":"INSERT","lineNumber":132,"content":"                  message: 'Your account has been successfully verified.',"},{"type":"INSERT","lineNumber":133,"content":"                  isRegistration: true,"},{"type":"INSERT","lineNumber":134,"content":"                ),"},{"type":"DELETE","lineNumber":292,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":293,"oldContent":"            ),"},{"type":"DELETE","lineNumber":294,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":295,"oldContent":"            body: SingleChildScrollView("},{"type":"DELETE","lineNumber":296,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":297,"oldContent":"              const Text("},{"type":"DELETE","lineNumber":298,"oldContent":"                'Enter OTP',"},{"type":"DELETE","lineNumber":299,"oldContent":"                style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),"},{"type":"DELETE","lineNumber":300,"oldContent":"              ),"},{"type":"DELETE","lineNumber":301,"oldContent":"              const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":302,"oldContent":"              Text("},{"type":"DELETE","lineNumber":303,"oldContent":"                'We have sent an OTP to +91 ${widget.phoneNumber}',"},{"type":"DELETE","lineNumber":304,"oldContent":"                textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":305,"oldContent":"                style: const TextStyle(fontSize: 16, color: Colors.grey),"},{"type":"DELETE","lineNumber":306,"oldContent":"              ),"},{"type":"DELETE","lineNumber":307,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":308,"oldContent":"              Row("},{"type":"DELETE","lineNumber":309,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"DELETE","lineNumber":310,"oldContent":"                children: List.generate("},{"type":"DELETE","lineNumber":311,"oldContent":"                  6,"},{"type":"DELETE","lineNumber":312,"oldContent":"                  (index) => SizedBox("},{"type":"DELETE","lineNumber":313,"oldContent":"                    width: 50,"},{"type":"DELETE","lineNumber":314,"oldContent":"                    child: TextField("},{"type":"DELETE","lineNumber":315,"oldContent":"                      controller: _otpControllers[index],"},{"type":"DELETE","lineNumber":316,"oldContent":"                      focusNode: _focusNodes[index],"},{"type":"DELETE","lineNumber":317,"oldContent":"                      keyboardType: TextInputType.number,"},{"type":"DELETE","lineNumber":318,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":319,"oldContent":"                      maxLength: 1,"},{"type":"DELETE","lineNumber":320,"oldContent":"                      onChanged: (value) => _onOtpChanged(value, index),"},{"type":"DELETE","lineNumber":321,"oldContent":"                      decoration: const InputDecoration("},{"type":"DELETE","lineNumber":322,"oldContent":"                        counterText: '',"},{"type":"DELETE","lineNumber":323,"oldContent":"                        border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":136,"content":"            );"},{"type":"INSERT","lineNumber":137,"content":"          } else if (state.status == AuthStatus.error) {"},{"type":"INSERT","lineNumber":138,"content":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":139,"content":"              SnackBar(content: Text(state.error ?? 'Verification failed')),"},{"type":"INSERT","lineNumber":140,"content":"            );"},{"type":"INSERT","lineNumber":141,"content":"          }"},{"type":"INSERT","lineNumber":142,"content":"        },"},{"type":"INSERT","lineNumber":143,"content":"        builder: (context, state) {"},{"type":"INSERT","lineNumber":144,"content":"          return SingleChildScrollView("},{"type":"INSERT","lineNumber":145,"content":"            padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":146,"content":"            child: Column("},{"type":"INSERT","lineNumber":147,"content":"              crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":148,"content":"              children: ["},{"type":"INSERT","lineNumber":149,"content":"                const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":150,"content":"                "},{"type":"INSERT","lineNumber":151,"content":"                // Title"},{"type":"INSERT","lineNumber":152,"content":"                Text("},{"type":"INSERT","lineNumber":153,"content":"                  'ENTER VERIFICATION CODE',"},{"type":"INSERT","lineNumber":154,"content":"                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":155,"content":"                    fontSize: 20,"},{"type":"INSERT","lineNumber":156,"content":"                    fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":157,"content":"                    color: const Color(0xFF333333),"},{"type":"INSERT","lineNumber":158,"content":"                  ),"},{"type":"INSERT","lineNumber":159,"content":"                ),"},{"type":"INSERT","lineNumber":160,"content":"                "},{"type":"INSERT","lineNumber":161,"content":"                const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":162,"content":"                "},{"type":"INSERT","lineNumber":163,"content":"                // Subtitle"},{"type":"INSERT","lineNumber":164,"content":"                Text("},{"type":"INSERT","lineNumber":165,"content":"                  'We have sent the verification code to',"},{"type":"INSERT","lineNumber":166,"content":"                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":167,"content":"                    fontSize: 14,"},{"type":"INSERT","lineNumber":168,"content":"                    color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":169,"content":"                  ),"},{"type":"INSERT","lineNumber":170,"content":"                ),"},{"type":"INSERT","lineNumber":171,"content":"                "},{"type":"INSERT","lineNumber":172,"content":"                const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":173,"content":"                "},{"type":"INSERT","lineNumber":174,"content":"                // Phone Number"},{"type":"INSERT","lineNumber":175,"content":"                Text("},{"type":"INSERT","lineNumber":176,"content":"                  widget.phoneNumber,"},{"type":"INSERT","lineNumber":177,"content":"                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":178,"content":"                    fontSize: 14,"},{"type":"INSERT","lineNumber":179,"content":"                    fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":180,"content":"                    color: const Color(0xFF333333),"},{"type":"INSERT","lineNumber":181,"content":"                  ),"},{"type":"INSERT","lineNumber":182,"content":"                ),"},{"type":"INSERT","lineNumber":183,"content":"                "},{"type":"INSERT","lineNumber":184,"content":"                const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":185,"content":"                "},{"type":"INSERT","lineNumber":186,"content":"                // OTP Input Fields"},{"type":"INSERT","lineNumber":187,"content":"                Row("},{"type":"INSERT","lineNumber":188,"content":"                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"INSERT","lineNumber":189,"content":"                  children: List.generate(6, (index) {"},{"type":"INSERT","lineNumber":190,"content":"                    return SizedBox("},{"type":"INSERT","lineNumber":191,"content":"                      width: 45,"},{"type":"INSERT","lineNumber":192,"content":"                      child: TextFormField("},{"type":"INSERT","lineNumber":193,"content":"                        controller: _otpControllers[index],"},{"type":"INSERT","lineNumber":194,"content":"                        focusNode: _focusNodes[index],"},{"type":"INSERT","lineNumber":195,"content":"                        textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":196,"content":"                        keyboardType: TextInputType.number,"},{"type":"INSERT","lineNumber":197,"content":"                        maxLength: 1,"},{"type":"INSERT","lineNumber":198,"content":"                        style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":199,"content":"                          fontSize: 20,"},{"type":"INSERT","lineNumber":200,"content":"                          fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":201,"content":"                          color: const Color(0xFF333333),"},{"type":"INSERT","lineNumber":202,"content":"                        ),"},{"type":"INSERT","lineNumber":203,"content":"                        decoration: InputDecoration("},{"type":"INSERT","lineNumber":204,"content":"                          counterText: '',"},{"type":"INSERT","lineNumber":205,"content":"                          contentPadding: EdgeInsets.zero,"},{"type":"INSERT","lineNumber":206,"content":"                          enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":207,"content":"                            borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":208,"content":"                            borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":209,"content":"                          ),"},{"type":"INSERT","lineNumber":210,"content":"                          focusedBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":211,"content":"                            borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":212,"content":"                            borderSide: const BorderSide(color: Color(0xFFFF6B35)),"},{"type":"INSERT","lineNumber":213,"content":"                          ),"},{"type":"INSERT","lineNumber":214,"content":"                          filled: true,"},{"type":"INSERT","lineNumber":215,"content":"                          fillColor: Colors.white,"},{"type":"INSERT","lineNumber":216,"content":"                        ),"},{"type":"INSERT","lineNumber":217,"content":"                        onChanged: (value) => _onOtpChanged(value, index),"},{"type":"INSERT","lineNumber":219,"content":"                    );"},{"type":"INSERT","lineNumber":220,"content":"                  }),"},{"type":"INSERT","lineNumber":221,"content":"                ),"},{"type":"INSERT","lineNumber":222,"content":"                "},{"type":"INSERT","lineNumber":223,"content":"                const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":224,"content":"                "},{"type":"INSERT","lineNumber":225,"content":"                // Resend OTP"},{"type":"INSERT","lineNumber":226,"content":"                Center("},{"type":"INSERT","lineNumber":227,"content":"                  child: _canResend"},{"type":"INSERT","lineNumber":228,"content":"                      ? TextButton("},{"type":"INSERT","lineNumber":229,"content":"                          onPressed: _resendOtp,"},{"type":"INSERT","lineNumber":230,"content":"                          child: Text("},{"type":"INSERT","lineNumber":231,"content":"                            'Resend OTP',"},{"type":"INSERT","lineNumber":232,"content":"                            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":233,"content":"                              color: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":234,"content":"                              fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":235,"content":"                              fontSize: 14,"},{"type":"INSERT","lineNumber":236,"content":"                            ),"},{"type":"INSERT","lineNumber":237,"content":"                          ),"},{"type":"INSERT","lineNumber":238,"content":"                        )"},{"type":"INSERT","lineNumber":239,"content":"                      : Text("},{"type":"INSERT","lineNumber":240,"content":"                          'Resend OTP in 00:${_resendTimer.toString().padLeft(2, '0')}',"},{"type":"INSERT","lineNumber":241,"content":"                          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":242,"content":"                            color: const Color(0xFF999999),"},{"type":"INSERT","lineNumber":243,"content":"                            fontSize: 14,"},{"type":"INSERT","lineNumber":244,"content":"                          ),"},{"type":"INSERT","lineNumber":245,"content":"                        ),"},{"type":"INSERT","lineNumber":246,"content":"                ),"},{"type":"INSERT","lineNumber":247,"content":"                "},{"type":"INSERT","lineNumber":248,"content":"                const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":249,"content":"                "},{"type":"INSERT","lineNumber":250,"content":"                // Verify Button"},{"type":"INSERT","lineNumber":251,"content":"                SizedBox("},{"type":"INSERT","lineNumber":252,"content":"                  width: double.infinity,"},{"type":"INSERT","lineNumber":253,"content":"                  height: 56,"},{"type":"INSERT","lineNumber":254,"content":"                  child: ElevatedButton("},{"type":"INSERT","lineNumber":255,"content":"                    onPressed: state.status == AuthStatus.verificationInProgress ? null : _verifyOtp,"},{"type":"INSERT","lineNumber":256,"content":"                    style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":257,"content":"                      backgroundColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":258,"content":"                      shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":259,"content":"                        borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":260,"content":"                      ),"},{"type":"INSERT","lineNumber":261,"content":"                      elevation: 0,"},{"type":"INSERT","lineNumber":263,"content":"                    child: state.status == AuthStatus.verificationInProgress"},{"type":"INSERT","lineNumber":264,"content":"                        ? const SizedBox("},{"type":"INSERT","lineNumber":265,"content":"                            width: 24,"},{"type":"INSERT","lineNumber":266,"content":"                            height: 24,"},{"type":"INSERT","lineNumber":267,"content":"                            child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":268,"content":"                              color: Colors.white,"},{"type":"INSERT","lineNumber":269,"content":"                              strokeWidth: 2,"},{"type":"INSERT","lineNumber":270,"content":"                            ),"},{"type":"INSERT","lineNumber":271,"content":"                          )"},{"type":"INSERT","lineNumber":272,"content":"                        : Text("},{"type":"INSERT","lineNumber":273,"content":"                            'VERIFY',"},{"type":"INSERT","lineNumber":274,"content":"                            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":275,"content":"                              fontSize: 16,"},{"type":"INSERT","lineNumber":276,"content":"                              fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":277,"content":"                              color: Colors.white,"},{"type":"INSERT","lineNumber":278,"content":"                            ),"},{"type":"INSERT","lineNumber":279,"content":"                          ),"},{"type":"DELETE","lineNumber":328,"oldContent":"              ),"},{"type":"DELETE","lineNumber":329,"oldContent":"              const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":330,"oldContent":"              ElevatedButton("},{"type":"DELETE","lineNumber":331,"oldContent":"                onPressed: _viewModel.isLoading ? null : _verifyOtp,"},{"type":"DELETE","lineNumber":332,"oldContent":"                child: _viewModel.isLoading"},{"type":"DELETE","lineNumber":333,"oldContent":"                    ? const CircularProgressIndicator()"},{"type":"DELETE","lineNumber":334,"oldContent":"                    : const Text('Verify OTP'),"},{"type":"DELETE","lineNumber":335,"oldContent":"              ),"},{"type":"DELETE","lineNumber":336,"oldContent":"              const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":337,"oldContent":"              TextButton("},{"type":"DELETE","lineNumber":338,"oldContent":"                onPressed: _resendCodeIn == 0 && !_isResendLoading ? _resendOtp : null,"},{"type":"DELETE","lineNumber":339,"oldContent":"                child: _isResendLoading"},{"type":"DELETE","lineNumber":340,"oldContent":"                    ? const CircularProgressIndicator()"},{"type":"DELETE","lineNumber":341,"oldContent":"                    : Text("},{"type":"DELETE","lineNumber":342,"oldContent":"                        _resendCodeIn > 0"},{"type":"DELETE","lineNumber":343,"oldContent":"                            ? 'Resend code in $_resendCodeIn seconds'"},{"type":"DELETE","lineNumber":344,"oldContent":"                            : 'Resend OTP',"},{"type":"DELETE","lineNumber":345,"oldContent":"                        style: TextStyle("},{"type":"DELETE","lineNumber":346,"oldContent":"                          color: _resendCodeIn == 0"},{"type":"DELETE","lineNumber":347,"oldContent":"                              ? Theme.of(context).primaryColor"},{"type":"DELETE","lineNumber":348,"oldContent":"                              : Colors.grey,"},{"type":"DELETE","lineNumber":349,"oldContent":"                        ),"},{"type":"INSERT","lineNumber":282,"content":"                "},{"type":"INSERT","lineNumber":283,"content":"                const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":284,"content":"                "},{"type":"INSERT","lineNumber":285,"content":"                // Back Button"},{"type":"INSERT","lineNumber":286,"content":"                SizedBox("},{"type":"INSERT","lineNumber":287,"content":"                  width: double.infinity,"},{"type":"INSERT","lineNumber":288,"content":"                  height: 56,"},{"type":"INSERT","lineNumber":289,"content":"                  child: OutlinedButton("},{"type":"INSERT","lineNumber":290,"content":"                    onPressed: () => Navigator.pop(context),"},{"type":"INSERT","lineNumber":291,"content":"                    style: OutlinedButton.styleFrom("},{"type":"INSERT","lineNumber":292,"content":"                      side: const BorderSide(color: Color(0xFFFF6B35)),"},{"type":"INSERT","lineNumber":293,"content":"                      shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":294,"content":"                        borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":351,"oldContent":"              ),"},{"type":"DELETE","lineNumber":352,"oldContent":"            ],"},{"type":"DELETE","lineNumber":353,"oldContent":"          ),"},{"type":"INSERT","lineNumber":296,"content":"                    ),"},{"type":"INSERT","lineNumber":297,"content":"                    child: Text("},{"type":"INSERT","lineNumber":298,"content":"                      'BACK',"},{"type":"INSERT","lineNumber":299,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":300,"content":"                        fontSize: 16,"},{"type":"INSERT","lineNumber":301,"content":"                        fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":302,"content":"                        color: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":303,"content":"                      ),"},{"type":"INSERT","lineNumber":304,"content":"                    ),"},{"type":"INSERT","lineNumber":305,"content":"                  ),"},{"type":"INSERT","lineNumber":306,"content":"                ),"},{"type":"INSERT","lineNumber":307,"content":"              ],"},{"type":"INSERT","lineNumber":308,"content":"            ),"},{"type":"INSERT","lineNumber":309,"content":"          );"},{"type":"INSERT","lineNumber":310,"content":"        },"},{"type":"DELETE","lineNumber":356,"oldContent":"              ),"},{"type":"DELETE","lineNumber":358,"oldContent":"            ),"},{"type":"DELETE","lineNumber":361,"oldContent":"          if (_isLoading)"},{"type":"DELETE","lineNumber":362,"oldContent":"        ],"},{"type":"DELETE","lineNumber":363,"oldContent":"            const Center("},{"type":"DELETE","lineNumber":364,"oldContent":"            ),"},{"type":"DELETE","lineNumber":365,"oldContent":"              child: CircularProgressIndicator(),"}]},{"timestamp":1754628873069,"changes":[{"type":"DELETE","lineNumber":11,"oldContent":"    Key? key,"},{"type":"MODIFY","lineNumber":13,"content":"    Key? key,","oldContent":"    required this.verificationId,"},{"type":"INSERT","lineNumber":14,"content":"    required this.verificationId,"},{"type":"DELETE","lineNumber":16,"oldContent":"  }) : super(key: key);"},{"type":"DELETE","lineNumber":18,"oldContent":"  _OtpVerificationScreenState createState() => _OtpVerificationScreenState();"},{"type":"INSERT","lineNumber":17,"content":"  }) : super(key: key);"},{"type":"DELETE","lineNumber":21,"oldContent":"  final List<TextEditingController> _otpControllers = List.generate(6, (index) => TextEditingController());"},{"type":"INSERT","lineNumber":20,"content":"  _OtpVerificationScreenState createState() => _OtpVerificationScreenState();"},{"type":"MODIFY","lineNumber":24,"content":"  final List<TextEditingController> _otpControllers = List.generate(6, (index) => TextEditingController());","oldContent":"  int _resendTimer = 30;"},{"type":"INSERT","lineNumber":25,"content":"  final List<FocusNode> _focusNodes = List.generate(6, (index) => FocusNode());"},{"type":"INSERT","lineNumber":26,"content":"  int _resendTimer = 30;"},{"type":"DELETE","lineNumber":29,"oldContent":"  final List<FocusNode> _focusNodes = List.generate(6, (index) => FocusNode());"},{"type":"DELETE","lineNumber":30,"oldContent":"    Future.delayed(Duration.zero, () {"},{"type":"DELETE","lineNumber":32,"oldContent":"      FocusScope.of(context).requestFocus(_focusNodes[0]);"},{"type":"DELETE","lineNumber":37,"oldContent":"    _timer?.cancel();"},{"type":"INSERT","lineNumber":35,"content":"    Future.delayed(Duration.zero, () {"},{"type":"INSERT","lineNumber":36,"content":"      FocusScope.of(context).requestFocus(_focusNodes[0]);"},{"type":"DELETE","lineNumber":43,"oldContent":"    setState(() {"},{"type":"DELETE","lineNumber":45,"oldContent":"      _resendTimer = 30;"},{"type":"DELETE","lineNumber":47,"oldContent":"      _canResend = false;"},{"type":"DELETE","lineNumber":49,"oldContent":"    });"},{"type":"DELETE","lineNumber":51,"oldContent":""},{"type":"DELETE","lineNumber":53,"oldContent":"    _timer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"INSERT","lineNumber":48,"content":"    _timer?.cancel();"},{"type":"INSERT","lineNumber":49,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":50,"content":"  }"},{"type":"INSERT","lineNumber":51,"content":""},{"type":"INSERT","lineNumber":52,"content":"  void _startResendTimer() {"},{"type":"INSERT","lineNumber":53,"content":"    setState(() {"},{"type":"INSERT","lineNumber":54,"content":"      _resendTimer = 30;"},{"type":"INSERT","lineNumber":55,"content":"      _canResend = false;"},{"type":"INSERT","lineNumber":56,"content":"    });"},{"type":"INSERT","lineNumber":57,"content":""},{"type":"INSERT","lineNumber":58,"content":"    _timer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"DELETE","lineNumber":58,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":60,"oldContent":"  }"},{"type":"DELETE","lineNumber":61,"oldContent":""},{"type":"INSERT","lineNumber":63,"content":"      } else {"},{"type":"INSERT","lineNumber":68,"content":"      }"},{"type":"INSERT","lineNumber":69,"content":"    });"},{"type":"INSERT","lineNumber":70,"content":"  }"},{"type":"INSERT","lineNumber":71,"content":""},{"type":"DELETE","lineNumber":68,"oldContent":"  void _startResendTimer() {"},{"type":"DELETE","lineNumber":72,"oldContent":"      } else {"},{"type":"INSERT","lineNumber":77,"content":"    }"},{"type":"DELETE","lineNumber":75,"oldContent":"      }"},{"type":"DELETE","lineNumber":77,"oldContent":"    });"},{"type":"DELETE","lineNumber":79,"oldContent":"  }"},{"type":"INSERT","lineNumber":83,"content":"    }"},{"type":"INSERT","lineNumber":84,"content":"  }"},{"type":"INSERT","lineNumber":93,"content":"            ),"},{"type":"INSERT","lineNumber":94,"content":"          );"},{"type":"INSERT","lineNumber":96,"content":"  }"},{"type":"INSERT","lineNumber":97,"content":""},{"type":"DELETE","lineNumber":92,"oldContent":"      context.read<AuthBloc>().add(SendOtpRequested(widget.phoneNumber));"},{"type":"INSERT","lineNumber":100,"content":"      context.read<AuthBloc>().add(SendOtpRequested(widget.phoneNumber, phoneNumber: ''));"},{"type":"INSERT","lineNumber":102,"content":"    }"},{"type":"INSERT","lineNumber":103,"content":"  }"},{"type":"INSERT","lineNumber":104,"content":""},{"type":"INSERT","lineNumber":105,"content":"  @override"},{"type":"INSERT","lineNumber":106,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":135,"content":"              ),"},{"type":"DELETE","lineNumber":166,"oldContent":"    }"},{"type":"DELETE","lineNumber":168,"oldContent":"  }"},{"type":"DELETE","lineNumber":170,"oldContent":""},{"type":"DELETE","lineNumber":200,"oldContent":"            ),"},{"type":"DELETE","lineNumber":202,"oldContent":"          );"},{"type":"INSERT","lineNumber":218,"content":"                      ),"},{"type":"DELETE","lineNumber":225,"oldContent":"    }"},{"type":"DELETE","lineNumber":227,"oldContent":"  }"},{"type":"DELETE","lineNumber":229,"oldContent":""},{"type":"DELETE","lineNumber":236,"oldContent":"    }"},{"type":"DELETE","lineNumber":238,"oldContent":"  }"},{"type":"DELETE","lineNumber":240,"oldContent":""},{"type":"INSERT","lineNumber":262,"content":"                    ),"},{"type":"DELETE","lineNumber":268,"oldContent":"  @override"},{"type":"DELETE","lineNumber":270,"oldContent":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":280,"content":"                  ),"},{"type":"INSERT","lineNumber":281,"content":"                ),"},{"type":"DELETE","lineNumber":287,"oldContent":"              ),"},{"type":"INSERT","lineNumber":295,"content":"                      ),"},{"type":"DELETE","lineNumber":306,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":307,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":308,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":309,"oldContent":"                ),"},{"type":"DELETE","lineNumber":310,"oldContent":"                      ),"}]},{"timestamp":1754628935061,"changes":[{"type":"INSERT","lineNumber":12,"content":"  const OtpVerificationScreen({"},{"type":"DELETE","lineNumber":14,"oldContent":"  const OtpVerificationScreen({"},{"type":"DELETE","lineNumber":15,"oldContent":"    required this.verificationId,"},{"type":"DELETE","lineNumber":16,"oldContent":"  }) : super(key: key);"},{"type":"INSERT","lineNumber":15,"content":"    required this.phoneNumber,"},{"type":"DELETE","lineNumber":18,"oldContent":"  });"},{"type":"DELETE","lineNumber":19,"oldContent":"  _OtpVerificationScreenState createState() => _OtpVerificationScreenState();"},{"type":"INSERT","lineNumber":17,"content":"  }) : super(key: key);"},{"type":"DELETE","lineNumber":21,"oldContent":"  State<OtpVerificationScreen> createState() => _OtpVerificationScreenState();"},{"type":"INSERT","lineNumber":19,"content":"  @override"},{"type":"INSERT","lineNumber":20,"content":"  _OtpVerificationScreenState createState() => _OtpVerificationScreenState();"},{"type":"INSERT","lineNumber":22,"content":""},{"type":"INSERT","lineNumber":23,"content":"class _OtpVerificationScreenState extends State<OtpVerificationScreen> {"},{"type":"DELETE","lineNumber":25,"oldContent":""},{"type":"DELETE","lineNumber":30,"oldContent":""},{"type":"INSERT","lineNumber":31,"content":"  void initState() {"},{"type":"DELETE","lineNumber":33,"oldContent":"    Future.delayed(Duration.zero, () {"},{"type":"MODIFY","lineNumber":35,"content":"    Future.delayed(Duration.zero, () {","oldContent":"      FocusScope.of(context).requestFocus(_focusNodes[0]);"},{"type":"INSERT","lineNumber":36,"content":"      FocusScope.of(context).requestFocus(_focusNodes[0]);"},{"type":"MODIFY","lineNumber":38,"content":"  }","oldContent":"  void _startResendTimer() {"},{"type":"DELETE","lineNumber":44,"oldContent":"    _timer?.cancel();"},{"type":"INSERT","lineNumber":45,"content":"    for (var node in _focusNodes) {"},{"type":"INSERT","lineNumber":46,"content":"      node.dispose();"},{"type":"INSERT","lineNumber":47,"content":"    }"},{"type":"INSERT","lineNumber":48,"content":"    _timer?.cancel();"},{"type":"DELETE","lineNumber":48,"oldContent":"    for (var node in _focusNodes) {"},{"type":"DELETE","lineNumber":51,"oldContent":"      node.dispose();"},{"type":"DELETE","lineNumber":54,"oldContent":"  Future<void> _verifyOtp() async {"},{"type":"DELETE","lineNumber":56,"oldContent":"      if (_resendTimer > 0) {"},{"type":"DELETE","lineNumber":58,"oldContent":"        setState(() {"},{"type":"DELETE","lineNumber":60,"oldContent":"          _resendTimer--;"},{"type":"DELETE","lineNumber":62,"oldContent":"        });"},{"type":"INSERT","lineNumber":59,"content":"      if (_resendTimer > 0) {"},{"type":"INSERT","lineNumber":61,"content":"          _resendTimer--;"},{"type":"INSERT","lineNumber":62,"content":"        });"},{"type":"INSERT","lineNumber":64,"content":"        setState(() {"},{"type":"DELETE","lineNumber":68,"oldContent":"  void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":69,"oldContent":"    if (value.length == 1 && index < 5) {"},{"type":"DELETE","lineNumber":72,"oldContent":"      FocusScope.of(context).requestFocus(_focusNodes[index + 1]);"},{"type":"DELETE","lineNumber":74,"oldContent":"    } else if (value.isEmpty && index > 0) {"},{"type":"INSERT","lineNumber":72,"content":"  void _onOtpChanged(String value, int index) {"},{"type":"INSERT","lineNumber":73,"content":"    if (value.length == 1 && index < 5) {"},{"type":"INSERT","lineNumber":74,"content":"      FocusScope.of(context).requestFocus(_focusNodes[index + 1]);"},{"type":"INSERT","lineNumber":75,"content":"    } else if (value.isEmpty && index > 0) {"},{"type":"INSERT","lineNumber":77,"content":"    }"},{"type":"DELETE","lineNumber":80,"oldContent":"    }"},{"type":"INSERT","lineNumber":83,"content":"    }"},{"type":"INSERT","lineNumber":84,"content":"  }"},{"type":"DELETE","lineNumber":85,"oldContent":"    }"},{"type":"DELETE","lineNumber":87,"oldContent":"  }"},{"type":"INSERT","lineNumber":93,"content":"            ),"},{"type":"INSERT","lineNumber":94,"content":"          );"},{"type":"INSERT","lineNumber":96,"content":"  }"},{"type":"INSERT","lineNumber":97,"content":""},{"type":"DELETE","lineNumber":96,"oldContent":"            ),"},{"type":"INSERT","lineNumber":100,"content":"      context.read<AuthBloc>().add(SendOtpRequested(widget.phoneNumber));"},{"type":"DELETE","lineNumber":98,"oldContent":"          );"},{"type":"INSERT","lineNumber":102,"content":"    }"},{"type":"INSERT","lineNumber":103,"content":"  }"},{"type":"INSERT","lineNumber":104,"content":""},{"type":"INSERT","lineNumber":105,"content":"  @override"},{"type":"INSERT","lineNumber":106,"content":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":101,"oldContent":"  }"},{"type":"DELETE","lineNumber":103,"oldContent":""},{"type":"DELETE","lineNumber":107,"oldContent":"      context.read<AuthBloc>().add(SendOtpRequested(widget.phoneNumber, phoneNumber: ''));"},{"type":"DELETE","lineNumber":110,"oldContent":"    }"},{"type":"DELETE","lineNumber":112,"oldContent":"  }"},{"type":"DELETE","lineNumber":114,"oldContent":""},{"type":"DELETE","lineNumber":116,"oldContent":"  @override"},{"type":"DELETE","lineNumber":118,"oldContent":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":135,"content":"              ),"},{"type":"DELETE","lineNumber":148,"oldContent":"              ),"},{"type":"INSERT","lineNumber":218,"content":"                      ),"},{"type":"DELETE","lineNumber":227,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":262,"content":"                    ),"},{"type":"DELETE","lineNumber":266,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":280,"content":"                  ),"},{"type":"INSERT","lineNumber":281,"content":"                ),"},{"type":"DELETE","lineNumber":283,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":285,"oldContent":"                ),"},{"type":"INSERT","lineNumber":295,"content":"                      ),"},{"type":"DELETE","lineNumber":299,"oldContent":"                      ),"}]},{"timestamp":1754632067260,"changes":[{"type":"MODIFY","lineNumber":17,"content":"  }) : super(key: key);","oldContent":"  }) : super(key: key);"},{"type":"INSERT","lineNumber":18,"content":""},{"type":"DELETE","lineNumber":20,"oldContent":""},{"type":"MODIFY","lineNumber":22,"content":"","oldContent":""},{"type":"MODIFY","lineNumber":31,"content":"  void initState() {","oldContent":"  void initState() {"},{"type":"INSERT","lineNumber":34,"content":"    // Auto-focus the first OTP field"},{"type":"DELETE","lineNumber":36,"oldContent":"    // Auto-focus the first OTP field"},{"type":"MODIFY","lineNumber":45,"content":"    for (var node in _focusNodes) {","oldContent":"    for (var node in _focusNodes) {"},{"type":"DELETE","lineNumber":47,"oldContent":"    super.dispose();"},{"type":"MODIFY","lineNumber":49,"content":"    super.dispose();","oldContent":"  }"},{"type":"INSERT","lineNumber":50,"content":"  }"},{"type":"DELETE","lineNumber":57,"oldContent":"      if (_resendTimer > 0) {"},{"type":"DELETE","lineNumber":59,"oldContent":"          _resendTimer--;"},{"type":"DELETE","lineNumber":61,"oldContent":"        });"},{"type":"INSERT","lineNumber":59,"content":"      if (_resendTimer > 0) {"},{"type":"DELETE","lineNumber":63,"oldContent":"        setState(() {"},{"type":"INSERT","lineNumber":61,"content":"          _resendTimer--;"},{"type":"INSERT","lineNumber":62,"content":"        });"},{"type":"INSERT","lineNumber":64,"content":"        setState(() {"},{"type":"INSERT","lineNumber":70,"content":"  }"},{"type":"INSERT","lineNumber":71,"content":""},{"type":"DELETE","lineNumber":72,"oldContent":"  }"},{"type":"DELETE","lineNumber":75,"oldContent":""},{"type":"MODIFY","lineNumber":85,"content":"","oldContent":""},{"type":"MODIFY","lineNumber":95,"content":"    }","oldContent":"    }"},{"type":"INSERT","lineNumber":96,"content":"  }"},{"type":"INSERT","lineNumber":97,"content":""},{"type":"INSERT","lineNumber":100,"content":"      context.read<AuthBloc>().add(SendOtpRequested(widget.phoneNumber));"},{"type":"INSERT","lineNumber":101,"content":"      _startResendTimer();"},{"type":"INSERT","lineNumber":102,"content":"    }"},{"type":"DELETE","lineNumber":100,"oldContent":"      _startResendTimer();"},{"type":"INSERT","lineNumber":105,"content":"  @override"},{"type":"INSERT","lineNumber":106,"content":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":102,"oldContent":"      context.read<AuthBloc>().add(SendOtpRequested(widget.phoneNumber));"},{"type":"DELETE","lineNumber":104,"oldContent":"    }"},{"type":"DELETE","lineNumber":106,"oldContent":"  }"},{"type":"DELETE","lineNumber":107,"oldContent":""},{"type":"DELETE","lineNumber":109,"oldContent":"  @override"},{"type":"DELETE","lineNumber":111,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":125,"oldContent":"          if (state.status == AuthStatus.verificationSuccessful) {"},{"type":"DELETE","lineNumber":126,"oldContent":"            // Navigate to success screen or home screen"},{"type":"INSERT","lineNumber":125,"content":"          if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":126,"content":"            // Navigate to home screen after successful authentication"},{"type":"DELETE","lineNumber":137,"oldContent":"          } else if (state.status == AuthStatus.error) {"},{"type":"DELETE","lineNumber":138,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":139,"oldContent":"              SnackBar(content: Text(state.error ?? 'Verification failed')),"},{"type":"DELETE","lineNumber":140,"oldContent":"            );"},{"type":"INSERT","lineNumber":137,"content":"          } else if (state.status == AuthStatus.verificationFailed || "},{"type":"INSERT","lineNumber":138,"content":"                    state.status == AuthStatus.error) {"},{"type":"INSERT","lineNumber":139,"content":"            // Show error message if verification fails"},{"type":"INSERT","lineNumber":140,"content":"            if (state.error != null) {"},{"type":"INSERT","lineNumber":141,"content":"              ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":142,"content":"                SnackBar(content: Text(state.error!)),"},{"type":"INSERT","lineNumber":143,"content":"              );"},{"type":"INSERT","lineNumber":144,"content":"            }"},{"type":"DELETE","lineNumber":281,"oldContent":"                "},{"type":"INSERT","lineNumber":286,"content":"                "}]},{"timestamp":1754643846288,"changes":[{"type":"INSERT","lineNumber":16,"content":"    this.isRegistration = false,"},{"type":"DELETE","lineNumber":17,"oldContent":"  }) : super(key: key);"},{"type":"INSERT","lineNumber":21,"content":"}"},{"type":"DELETE","lineNumber":22,"oldContent":""},{"type":"INSERT","lineNumber":30,"content":"  @override"},{"type":"DELETE","lineNumber":31,"oldContent":"  void initState() {"},{"type":"INSERT","lineNumber":44,"content":"    }"},{"type":"DELETE","lineNumber":45,"oldContent":"    for (var node in _focusNodes) {"},{"type":"INSERT","lineNumber":48,"content":"    _timer?.cancel();"},{"type":"DELETE","lineNumber":50,"oldContent":"    _timer?.cancel();"},{"type":"MODIFY","lineNumber":59,"content":"      if (_resendTimer > 0) {","oldContent":"      if (_resendTimer > 0) {"},{"type":"INSERT","lineNumber":60,"content":"        setState(() {"},{"type":"DELETE","lineNumber":62,"oldContent":"        setState(() {"},{"type":"MODIFY","lineNumber":64,"content":"        setState(() {","oldContent":"        setState(() {"},{"type":"MODIFY","lineNumber":72,"content":"  void _onOtpChanged(String value, int index) {","oldContent":"  void _onOtpChanged(String value, int index) {"},{"type":"INSERT","lineNumber":84,"content":"  }"},{"type":"DELETE","lineNumber":85,"oldContent":""},{"type":"INSERT","lineNumber":94,"content":"          );"},{"type":"DELETE","lineNumber":95,"oldContent":"    }"},{"type":"MODIFY","lineNumber":98,"content":"  void _resendOtp() {","oldContent":"  void _resendOtp() {"},{"type":"DELETE","lineNumber":100,"oldContent":"  }"},{"type":"DELETE","lineNumber":101,"oldContent":""},{"type":"DELETE","lineNumber":104,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":106,"oldContent":"      appBar: AppBar("},{"type":"INSERT","lineNumber":103,"content":"  }"},{"type":"INSERT","lineNumber":104,"content":""},{"type":"DELETE","lineNumber":108,"oldContent":"        leading: IconButton("},{"type":"INSERT","lineNumber":107,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":108,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":109,"content":"        leading: IconButton("},{"type":"MODIFY","lineNumber":126,"content":"            // Navigate to success screen which will then handle going to home","oldContent":"            // Navigate to home screen after successful authentication"},{"type":"MODIFY","lineNumber":130,"content":"                builder: (context) => SuccessScreen(","oldContent":"                builder: (context) => const SuccessScreen("},{"type":"INSERT","lineNumber":134,"content":"                  buttonText: 'CONTINUE TO APP',"},{"type":"DELETE","lineNumber":142,"oldContent":"          }"},{"type":"DELETE","lineNumber":144,"oldContent":"        },"},{"type":"MODIFY","lineNumber":146,"content":"          }","oldContent":"        builder: (context, state) {"},{"type":"INSERT","lineNumber":147,"content":"        },"},{"type":"INSERT","lineNumber":148,"content":"        builder: (context, state) {"},{"type":"INSERT","lineNumber":287,"content":"                "},{"type":"DELETE","lineNumber":289,"oldContent":"                "}]},{"timestamp":1754644261732,"changes":[{"type":"DELETE","lineNumber":41,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":42,"oldContent":"      }"},{"type":"DELETE","lineNumber":43,"oldContent":"  }"},{"type":"INSERT","lineNumber":41,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":42,"content":"    for (var controller in _otpControllers) {"},{"type":"INSERT","lineNumber":43,"content":"      controller.dispose();"},{"type":"INSERT","lineNumber":58,"content":"    _timer = Timer.periodic(const Duration(seconds: 1), (timer) {"},{"type":"DELETE","lineNumber":59,"oldContent":"      if (_resendTimer > 0) {"},{"type":"INSERT","lineNumber":63,"content":"      } else {"},{"type":"DELETE","lineNumber":64,"oldContent":"        setState(() {"},{"type":"INSERT","lineNumber":71,"content":""},{"type":"DELETE","lineNumber":72,"oldContent":"  void _onOtpChanged(String value, int index) {"},{"type":"DELETE","lineNumber":89,"oldContent":"      context.read<AuthBloc>().add("},{"type":"DELETE","lineNumber":90,"oldContent":"            VerifyOtpRequested("},{"type":"DELETE","lineNumber":91,"oldContent":"              verificationId: widget.verificationId,"},{"type":"DELETE","lineNumber":92,"oldContent":"              smsCode: otp,"},{"type":"DELETE","lineNumber":93,"oldContent":"            ),"},{"type":"DELETE","lineNumber":94,"oldContent":"          );"},{"type":"INSERT","lineNumber":89,"content":"      // For testing: Auto-verify if OTP is 000000"},{"type":"INSERT","lineNumber":90,"content":"      if (otp == '000000') {"},{"type":"INSERT","lineNumber":91,"content":"        context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":92,"content":"          const OtpVerificationSucceeded("},{"type":"INSERT","lineNumber":93,"content":"            authUser: null, // Or provide a test user if needed"},{"type":"INSERT","lineNumber":94,"content":"          ),"},{"type":"INSERT","lineNumber":95,"content":"        );"},{"type":"INSERT","lineNumber":96,"content":"      } else {"},{"type":"INSERT","lineNumber":97,"content":"        context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":98,"content":"          VerifyOtpRequested("},{"type":"INSERT","lineNumber":99,"content":"            verificationId: widget.verificationId,"},{"type":"INSERT","lineNumber":100,"content":"            smsCode: otp,"},{"type":"INSERT","lineNumber":101,"content":"          ),"},{"type":"INSERT","lineNumber":102,"content":"        );"},{"type":"INSERT","lineNumber":103,"content":"      }"},{"type":"INSERT","lineNumber":106,"content":""},{"type":"DELETE","lineNumber":98,"oldContent":"  void _resendOtp() {"},{"type":"DELETE","lineNumber":101,"oldContent":"  }"},{"type":"DELETE","lineNumber":103,"oldContent":""},{"type":"DELETE","lineNumber":105,"oldContent":"    return Scaffold("},{"type":"INSERT","lineNumber":112,"content":"  }"},{"type":"INSERT","lineNumber":113,"content":""},{"type":"INSERT","lineNumber":115,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":116,"content":"    return Scaffold("},{"type":"DELETE","lineNumber":109,"oldContent":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":154,"content":"            }"},{"type":"DELETE","lineNumber":147,"oldContent":"            }"},{"type":"INSERT","lineNumber":296,"content":"                "},{"type":"DELETE","lineNumber":289,"oldContent":"                "}]},{"timestamp":1754644337215,"changes":[{"type":"DELETE","lineNumber":89,"oldContent":"      // For testing: Auto-verify if OTP is 000000"},{"type":"DELETE","lineNumber":90,"oldContent":"      if (otp == '000000') {"},{"type":"DELETE","lineNumber":91,"oldContent":"        context.read<AuthBloc>().add("},{"type":"DELETE","lineNumber":92,"oldContent":"          const OtpVerificationSucceeded("},{"type":"DELETE","lineNumber":93,"oldContent":"            authUser: null, // Or provide a test user if needed"},{"type":"DELETE","lineNumber":94,"oldContent":"          ),"},{"type":"DELETE","lineNumber":95,"oldContent":"        );"},{"type":"INSERT","lineNumber":89,"content":"      context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":90,"content":"        VerifyOtpRequested("},{"type":"INSERT","lineNumber":91,"content":"          verificationId: widget.verificationId,"},{"type":"INSERT","lineNumber":92,"content":"          smsCode: otp,"},{"type":"INSERT","lineNumber":93,"content":"        ),"},{"type":"INSERT","lineNumber":94,"content":"      );"},{"type":"DELETE","lineNumber":97,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":99,"oldContent":"        context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":97,"content":""},{"type":"DELETE","lineNumber":101,"oldContent":"          VerifyOtpRequested("},{"type":"DELETE","lineNumber":102,"oldContent":"            verificationId: widget.verificationId,"},{"type":"DELETE","lineNumber":104,"oldContent":"            smsCode: otp,"},{"type":"DELETE","lineNumber":106,"oldContent":"          ),"},{"type":"DELETE","lineNumber":107,"oldContent":"        );"},{"type":"DELETE","lineNumber":109,"oldContent":"      }"},{"type":"INSERT","lineNumber":103,"content":"  }"},{"type":"INSERT","lineNumber":106,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":107,"content":"    return Scaffold("},{"type":"DELETE","lineNumber":117,"oldContent":"  }"},{"type":"DELETE","lineNumber":119,"oldContent":""},{"type":"DELETE","lineNumber":122,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":124,"oldContent":"    return Scaffold("},{"type":"INSERT","lineNumber":145,"content":"            }"},{"type":"DELETE","lineNumber":162,"oldContent":"            }"},{"type":"INSERT","lineNumber":287,"content":"                "},{"type":"DELETE","lineNumber":304,"oldContent":"                "}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/screens/register_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/screens/register_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:family_tree_firebase/core/constants/app_constants.dart';\n\nclass RegisterScreen extends StatefulWidget {\n  const RegisterScreen({super.key});\n\n  @override\n  State<RegisterScreen> createState() => _RegisterScreenState();\n}\n\nclass _RegisterScreenState extends State<RegisterScreen> {\n  final _formKey = GlobalKey<FormState>();\n  final _nameController = TextEditingController();\n  final _emailController = TextEditingController();\n  final _phoneController = TextEditingController();\n  bool _isLoading = false;\n\n  Future<void> _register() async {\n    if (!_formKey.currentState!.validate()) return;\n    \n    setState(() => _isLoading = true);\n    \n    try {\n      // TODO: Implement registration logic\n      await Future.delayed(const Duration(seconds: 2)); // Simulate API call\n      \n      if (mounted) {\n        // In a real app, you would get the verification ID from Firebase\n        final verificationId = 'simulated_verification_id_123456';\n        \n        Navigator.pushReplacementNamed(\n          context,\n          AppConstants.otpRoute,\n          arguments: {\n            'verificationId': verificationId,\n            'phoneNumber': _phoneController.text,\n          },\n        );\n      }\n    } catch (e) {\n      if (mounted) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          SnackBar(content: Text(e.toString())),\n        );\n      }\n    } finally {\n      if (mounted) {\n        setState(() => _isLoading = false);\n      }\n    }\n  }\n\n  @override\n  void dispose() {\n    _nameController.dispose();\n    _emailController.dispose();\n    _phoneController.dispose();\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      body: SafeArea(\n        child: SingleChildScrollView(\n          padding: const EdgeInsets.all(24.0),\n          child: Form(\n            key: _formKey,\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.stretch,\n              children: [\n                // Back button and title\n                Row(\n                  children: [\n                    IconButton(\n                      icon: const Icon(Icons.arrow_back_ios, size: 20),\n                      onPressed: () => Navigator.pop(context),\n                    ),\n                    const SizedBox(width: 8),\n                    const Text(\n                      'Create Account',\n                      style: TextStyle(\n                        fontSize: 24,\n                        fontWeight: FontWeight.bold,\n                      ),\n                    ),\n                  ],\n                ),\n                \n                const SizedBox(height: 40),\n                \n                // Welcome text\n                const Text(\n                  'Create an Account',\n                  style: TextStyle(\n                    fontSize: 28,\n                    fontWeight: FontWeight.bold,\n                  ),\n                ),\n                const SizedBox(height: 8),\n                Text(\n                  'Fill in your details to get started',\n                  style: TextStyle(\n                    fontSize: 16,\n                    color: Colors.grey[600],\n                  ),\n                ),\n                \n                const SizedBox(height: 40),\n                \n                // Name field\n                TextFormField(\n                  controller: _nameController,\n                  decoration: InputDecoration(\n                    labelText: 'Full Name',\n                    prefixIcon: const Icon(Icons.person_outline),\n                    border: OutlineInputBorder(\n                      borderRadius: BorderRadius.circular(12),\n                    ),\n                  ),\n                  validator: (value) {\n                    if (value == null || value.isEmpty) {\n                      return 'Please enter your name';\n                    }\n                    return null;\n                  },\n                ),\n                \n                const SizedBox(height: 20),\n                \n                // Email field\n                TextFormField(\n                  controller: _emailController,\n                  keyboardType: TextInputType.emailAddress,\n                  decoration: InputDecoration(\n                    labelText: 'Email',\n                    prefixIcon: const Icon(Icons.email_outlined),\n                    border: OutlineInputBorder(\n                      borderRadius: BorderRadius.circular(12),\n                    ),\n                  ),\n                  validator: (value) {\n                    if (value == null || value.isEmpty) {\n                      return 'Please enter your email';\n                    }\n                    if (!RegExp(r'^[^@]+@[^\\s]+\\.[^\\s]+').hasMatch(value)) {\n                      return 'Please enter a valid email';\n                    }\n                    return null;\n                  },\n                ),\n                \n                const SizedBox(height: 20),\n                \n                // Phone field\n                TextFormField(\n                  controller: _phoneController,\n                  keyboardType: TextInputType.phone,\n                  decoration: InputDecoration(\n                    labelText: 'Phone Number',\n                    prefixIcon: const Icon(Icons.phone_outlined),\n                    border: OutlineInputBorder(\n                      borderRadius: BorderRadius.circular(12),\n                    ),\n                  ),\n                  validator: (value) {\n                    if (value == null || value.isEmpty) {\n                      return 'Please enter your phone number';\n                    }\n                    // Simple phone number validation (can be enhanced)\n                    if (value.length < 10) {\n                      return 'Please enter a valid phone number';\n                    }\n                    return null;\n                  },\n                ),\n                \n                const SizedBox(height: 40),\n                \n                // Register button\n                ElevatedButton(\n                  onPressed: _isLoading ? null : _register,\n                  style: ElevatedButton.styleFrom(\n                    padding: const EdgeInsets.symmetric(vertical: 16),\n                    shape: RoundedRectangleBorder(\n                      borderRadius: BorderRadius.circular(12),\n                    ),\n                  ),\n                  child: _isLoading\n                      ? const SizedBox(\n                          width: 24,\n                          height: 24,\n                          child: CircularProgressIndicator(\n                            color: Colors.white,\n                            strokeWidth: 2,\n                          ),\n                        )\n                      : const Text(\n                          'Continue',\n                          style: TextStyle(fontSize: 16),\n                        ),\n                ),\n                \n                const SizedBox(height: 24),\n                \n                // Divider with \"or\" text\n                Row(\n                  children: [\n                    const Expanded(child: Divider()),\n                    Padding(\n                      padding: const EdgeInsets.symmetric(horizontal: 16),\n                      child: Text(\n                        'or sign up with',\n                        style: TextStyle(\n                          color: Colors.grey[600],\n                        ),\n                      ),\n                    ),\n                    const Expanded(child: Divider()),\n                  ],\n                ),\n                \n                const SizedBox(height: 24),\n                \n                // Social sign up buttons\n                Row(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    // Google\n                    IconButton(\n                      onPressed: () {\n                        // TODO: Implement Google sign up\n                      },\n                      style: IconButton.styleFrom(\n                        backgroundColor: Colors.grey[100],\n                        padding: const EdgeInsets.all(16),\n                        shape: RoundedRectangleBorder(\n                          borderRadius: BorderRadius.circular(12),\n                        ),\n                      ),\n                      icon: Image.asset(\n                        'assets/images/google.png',\n                        width: 24,\n                        height: 24,\n                      ),\n                    ),\n                    \n                    const SizedBox(width: 16),\n                    \n                    // Apple\n                    IconButton(\n                      onPressed: () {\n                        // TODO: Implement Apple sign up\n                      },\n                      style: IconButton.styleFrom(\n                        backgroundColor: Colors.grey[100],\n                        padding: const EdgeInsets.all(16),\n                        shape: RoundedRectangleBorder(\n                          borderRadius: BorderRadius.circular(12),\n                        ),\n                      ),\n                      icon: const Icon(\n                        Icons.apple,\n                        size: 24,\n                        color: Colors.black,\n                      ),\n                    ),\n                  ],\n                ),\n                \n                const SizedBox(height: 24),\n                \n                // Login link\n                Row(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    const Text(\"Already have an account?\"),\n                    TextButton(\n                      onPressed: () {\n                        Navigator.pushReplacementNamed(\n                          context,\n                          AppConstants.loginRoute,\n                        );\n                      },\n                      child: const Text('Login'),\n                    ),\n                  ],\n                ),\n              ],\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n}\n","baseTimestamp":1754375891728,"deltas":[{"timestamp":1754614548207,"changes":[{"type":"INSERT","lineNumber":22,"content":"  bool _obscureConfirmPassword = true;"},{"type":"DELETE","lineNumber":23,"oldContent":"  bool _isLoading = false;"},{"type":"MODIFY","lineNumber":37,"content":"    _phoneController.dispose();","oldContent":"    _phoneController.dispose();"},{"type":"MODIFY","lineNumber":56,"content":"  String _formatPhoneNumber(String phone) {","oldContent":"  String _formatPhoneNumber(String phoneNumber) {"},{"type":"MODIFY","lineNumber":58,"content":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');","oldContent":"    String digits = phoneNumber.replaceAll(RegExp(r'[^0-9]'), '');"},{"type":"MODIFY","lineNumber":60,"content":"    // Add country code if missing","oldContent":"    // If the number starts with '0', replace with country code (e.g., '91' for India)"},{"type":"MODIFY","lineNumber":62,"content":"      digits = '91${digits.substring(1)}'; // Assuming India as default country","oldContent":"      digits = digits.substring(1);"},{"type":"INSERT","lineNumber":63,"content":"    } else if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":64,"content":"      digits = '91$digits'; // Add default country code if no country code provided"},{"type":"DELETE","lineNumber":65,"oldContent":"    // If number doesn't start with '+', add the default country code (India +91)"},{"type":"INSERT","lineNumber":67,"content":"    // Add + prefix if missing"},{"type":"DELETE","lineNumber":67,"oldContent":"    }"},{"type":"DELETE","lineNumber":68,"oldContent":"      // Default to India (+91) if no country code is provided"},{"type":"DELETE","lineNumber":69,"oldContent":"      digits = '91$digits';"},{"type":"DELETE","lineNumber":70,"oldContent":"    // Ensure the number starts with a '+' for E.164 format"},{"type":"DELETE","lineNumber":71,"oldContent":"    "},{"type":"DELETE","lineNumber":72,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":78,"oldContent":"    "},{"type":"DELETE","lineNumber":81,"oldContent":"      setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":83,"oldContent":"      "},{"type":"INSERT","lineNumber":77,"content":"    "},{"type":"INSERT","lineNumber":79,"content":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":80,"content":"      "},{"type":"DELETE","lineNumber":98,"oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"INSERT","lineNumber":95,"content":"          final shouldContinue = await showDialog<bool>("},{"type":"DELETE","lineNumber":114,"oldContent":"          "},{"type":"DELETE","lineNumber":115,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":119,"oldContent":"      }"},{"type":"INSERT","lineNumber":113,"content":"          "},{"type":"INSERT","lineNumber":114,"content":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":121,"oldContent":"      "},{"type":"DELETE","lineNumber":123,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":125,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":119,"content":"      }"},{"type":"INSERT","lineNumber":120,"content":"      "},{"type":"INSERT","lineNumber":121,"content":"      // Register the user"},{"type":"INSERT","lineNumber":122,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":154,"oldContent":"        }"},{"type":"INSERT","lineNumber":151,"content":"        }"},{"type":"INSERT","lineNumber":156,"content":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"INSERT","lineNumber":157,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":158,"content":"          ),"},{"type":"INSERT","lineNumber":159,"content":"        );"},{"type":"INSERT","lineNumber":160,"content":"      }"},{"type":"INSERT","lineNumber":161,"content":"      }"},{"type":"DELETE","lineNumber":163,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"DELETE","lineNumber":165,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":167,"oldContent":"          ),"},{"type":"DELETE","lineNumber":169,"oldContent":"        );"},{"type":"DELETE","lineNumber":171,"oldContent":"      }"},{"type":"DELETE","lineNumber":173,"oldContent":"      }"},{"type":"DELETE","lineNumber":178,"oldContent":"  }"},{"type":"DELETE","lineNumber":181,"oldContent":"    if (_isLoading) {"},{"type":"DELETE","lineNumber":183,"oldContent":"      return const Scaffold("},{"type":"INSERT","lineNumber":177,"content":"  }"},{"type":"DELETE","lineNumber":185,"oldContent":"        body: Center(child: CircularProgressIndicator()),"},{"type":"DELETE","lineNumber":187,"oldContent":"      );"},{"type":"DELETE","lineNumber":189,"oldContent":"    }"},{"type":"INSERT","lineNumber":181,"content":"    return Consumer<AuthViewModel>("},{"type":"DELETE","lineNumber":191,"oldContent":"    "},{"type":"INSERT","lineNumber":183,"content":"        if (_isLoading) {"},{"type":"INSERT","lineNumber":184,"content":"          return const Scaffold("},{"type":"INSERT","lineNumber":185,"content":"            body: Center(child: CircularProgressIndicator()),"},{"type":"INSERT","lineNumber":186,"content":"          );"},{"type":"INSERT","lineNumber":187,"content":"        }"},{"type":"INSERT","lineNumber":188,"content":"        "},{"type":"DELETE","lineNumber":193,"oldContent":"    return Consumer<AuthViewModel>("},{"type":"DELETE","lineNumber":211,"oldContent":"                        fontSize: 24,"},{"type":"INSERT","lineNumber":209,"content":"                        fontSize: 24,"},{"type":"INSERT","lineNumber":216,"content":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":222,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":370,"oldContent":"                    }"},{"type":"DELETE","lineNumber":372,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":368,"content":"                    }"},{"type":"INSERT","lineNumber":369,"content":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":383,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":385,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":387,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":389,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":383,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":384,"content":"                      borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":385,"content":"                    ),"},{"type":"INSERT","lineNumber":386,"content":"                  ),"},{"type":"DELETE","lineNumber":392,"oldContent":"                          height: 24,"},{"type":"DELETE","lineNumber":394,"oldContent":"                          child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":390,"content":"                          height: 24,"},{"type":"INSERT","lineNumber":391,"content":"                          child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":401,"content":"                "},{"type":"DELETE","lineNumber":407,"oldContent":"                "},{"type":"DELETE","lineNumber":440,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":442,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":438,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":439,"content":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":448,"content":"                      ),"},{"type":"DELETE","lineNumber":454,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":469,"oldContent":"                            Icons.apple,"},{"type":"INSERT","lineNumber":466,"content":"                            Icons.apple,"},{"type":"DELETE","lineNumber":477,"oldContent":"                "},{"type":"DELETE","lineNumber":479,"oldContent":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":476,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":477,"content":"                "}]},{"timestamp":1754614578529,"changes":[{"type":"DELETE","lineNumber":16,"oldContent":"  final TextEditingController _nameController = TextEditingController();"},{"type":"DELETE","lineNumber":17,"oldContent":"  final TextEditingController _emailController = TextEditingController();"},{"type":"DELETE","lineNumber":18,"oldContent":"  final TextEditingController _phoneController = TextEditingController();"},{"type":"DELETE","lineNumber":19,"oldContent":"  final TextEditingController _passwordController = TextEditingController();"},{"type":"DELETE","lineNumber":20,"oldContent":"  final TextEditingController _confirmPasswordController = TextEditingController();"},{"type":"INSERT","lineNumber":16,"content":"  late final TextEditingController _nameController;"},{"type":"INSERT","lineNumber":17,"content":"  late final TextEditingController _emailController;"},{"type":"INSERT","lineNumber":18,"content":"  late final TextEditingController _phoneController;"},{"type":"INSERT","lineNumber":19,"content":"  late final TextEditingController _passwordController;"},{"type":"INSERT","lineNumber":20,"content":"  late final TextEditingController _confirmPasswordController;"},{"type":"MODIFY","lineNumber":24,"content":"  late final AuthViewModel _viewModel;","oldContent":"  late AuthViewModel _viewModel;"},{"type":"INSERT","lineNumber":25,"content":"  "},{"type":"INSERT","lineNumber":26,"content":"  @override"},{"type":"INSERT","lineNumber":27,"content":"  void initState() {"},{"type":"INSERT","lineNumber":28,"content":"    super.initState();"},{"type":"INSERT","lineNumber":29,"content":"    _nameController = TextEditingController();"},{"type":"INSERT","lineNumber":30,"content":"    _emailController = TextEditingController();"},{"type":"INSERT","lineNumber":31,"content":"    _phoneController = TextEditingController();"},{"type":"INSERT","lineNumber":32,"content":"    _passwordController = TextEditingController();"},{"type":"INSERT","lineNumber":33,"content":"    _confirmPasswordController = TextEditingController();"},{"type":"INSERT","lineNumber":34,"content":"    _viewModel = context.read<AuthViewModel>();"},{"type":"INSERT","lineNumber":35,"content":"    _viewModel.addListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":36,"content":"  }"},{"type":"INSERT","lineNumber":37,"content":"  "},{"type":"INSERT","lineNumber":38,"content":"  @override"},{"type":"INSERT","lineNumber":39,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":40,"content":"    _nameController.dispose();"},{"type":"INSERT","lineNumber":41,"content":"    _emailController.dispose();"},{"type":"INSERT","lineNumber":42,"content":"    _phoneController.dispose();"},{"type":"INSERT","lineNumber":43,"content":"    _passwordController.dispose();"},{"type":"INSERT","lineNumber":44,"content":"    _confirmPasswordController.dispose();"},{"type":"INSERT","lineNumber":45,"content":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":46,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":47,"content":"  }"},{"type":"INSERT","lineNumber":48,"content":"  "},{"type":"INSERT","lineNumber":49,"content":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":50,"content":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"INSERT","lineNumber":51,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":52,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":53,"content":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"INSERT","lineNumber":54,"content":"        );"},{"type":"INSERT","lineNumber":55,"content":"        _viewModel.clearError();"},{"type":"INSERT","lineNumber":56,"content":"      }"},{"type":"INSERT","lineNumber":57,"content":"    }"},{"type":"INSERT","lineNumber":58,"content":"  }"},{"type":"INSERT","lineNumber":70,"content":"    _emailController.dispose();"},{"type":"DELETE","lineNumber":37,"oldContent":"    _phoneController.dispose();"},{"type":"DELETE","lineNumber":64,"oldContent":"    }"},{"type":"INSERT","lineNumber":99,"content":"    }"},{"type":"DELETE","lineNumber":67,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":102,"content":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":73,"oldContent":"    "},{"type":"DELETE","lineNumber":75,"oldContent":"      setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":77,"oldContent":"      "},{"type":"INSERT","lineNumber":111,"content":"    "},{"type":"INSERT","lineNumber":113,"content":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":114,"content":"      "},{"type":"DELETE","lineNumber":91,"oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"INSERT","lineNumber":129,"content":"          final shouldContinue = await showDialog<bool>("},{"type":"DELETE","lineNumber":109,"oldContent":"          "},{"type":"DELETE","lineNumber":111,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":115,"oldContent":"      }"},{"type":"DELETE","lineNumber":116,"oldContent":"      "},{"type":"INSERT","lineNumber":147,"content":"          "},{"type":"INSERT","lineNumber":148,"content":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":118,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":119,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":153,"content":"      }"},{"type":"INSERT","lineNumber":154,"content":"      "},{"type":"INSERT","lineNumber":155,"content":"      // Register the user"},{"type":"INSERT","lineNumber":156,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":147,"oldContent":"        }"},{"type":"DELETE","lineNumber":152,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"INSERT","lineNumber":185,"content":"        }"},{"type":"DELETE","lineNumber":154,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":156,"oldContent":"          ),"},{"type":"DELETE","lineNumber":158,"oldContent":"        );"},{"type":"INSERT","lineNumber":190,"content":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"INSERT","lineNumber":191,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":192,"content":"          ),"},{"type":"INSERT","lineNumber":193,"content":"        );"},{"type":"DELETE","lineNumber":161,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":196,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":173,"oldContent":"  }"},{"type":"DELETE","lineNumber":177,"oldContent":"    return Consumer<AuthViewModel>("},{"type":"INSERT","lineNumber":211,"content":"  }"},{"type":"INSERT","lineNumber":212,"content":""},{"type":"INSERT","lineNumber":213,"content":"  @override"},{"type":"INSERT","lineNumber":214,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":215,"content":"    return Consumer<AuthViewModel>("},{"type":"INSERT","lineNumber":216,"content":"      builder: (context, viewModel, _) {"},{"type":"DELETE","lineNumber":181,"oldContent":""},{"type":"DELETE","lineNumber":184,"oldContent":"  @override"},{"type":"DELETE","lineNumber":187,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":188,"oldContent":"      builder: (context, viewModel, _) {"},{"type":"DELETE","lineNumber":205,"oldContent":"                        fontSize: 24,"},{"type":"INSERT","lineNumber":243,"content":"                        fontSize: 24,"},{"type":"DELETE","lineNumber":212,"oldContent":"                const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":250,"content":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":364,"oldContent":"                    }"},{"type":"DELETE","lineNumber":366,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":402,"content":"                    }"},{"type":"INSERT","lineNumber":403,"content":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":379,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":380,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":382,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":383,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":386,"oldContent":"                          height: 24,"},{"type":"DELETE","lineNumber":388,"oldContent":"                          child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":417,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":418,"content":"                      borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":419,"content":"                    ),"},{"type":"INSERT","lineNumber":420,"content":"                  ),"},{"type":"INSERT","lineNumber":424,"content":"                          height: 24,"},{"type":"INSERT","lineNumber":425,"content":"                          child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":397,"oldContent":"                "},{"type":"INSERT","lineNumber":435,"content":"                "},{"type":"DELETE","lineNumber":434,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":436,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":472,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":473,"content":"                              borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":444,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":482,"content":"                      ),"},{"type":"DELETE","lineNumber":462,"oldContent":"                            Icons.apple,"},{"type":"INSERT","lineNumber":500,"content":"                            Icons.apple,"},{"type":"DELETE","lineNumber":472,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":474,"oldContent":"                "},{"type":"INSERT","lineNumber":510,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":511,"content":"                "}]},{"timestamp":1754614593674,"changes":[{"type":"DELETE","lineNumber":26,"oldContent":""},{"type":"DELETE","lineNumber":28,"oldContent":"  @override"},{"type":"DELETE","lineNumber":30,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":32,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":34,"oldContent":"    _viewModel = context.read<AuthViewModel>();"},{"type":"DELETE","lineNumber":36,"oldContent":"    _viewModel.addListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":38,"oldContent":"  }"},{"type":"DELETE","lineNumber":40,"oldContent":""},{"type":"DELETE","lineNumber":42,"oldContent":"  @override"},{"type":"DELETE","lineNumber":44,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":46,"oldContent":"    _nameController.dispose();"},{"type":"DELETE","lineNumber":48,"oldContent":"    _phoneController.dispose();"},{"type":"DELETE","lineNumber":51,"oldContent":"    _passwordController.dispose();"},{"type":"DELETE","lineNumber":53,"oldContent":"    _confirmPasswordController.dispose();"},{"type":"DELETE","lineNumber":55,"oldContent":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":57,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":59,"oldContent":"  }"},{"type":"DELETE","lineNumber":61,"oldContent":""},{"type":"DELETE","lineNumber":63,"oldContent":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":65,"oldContent":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"DELETE","lineNumber":67,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":69,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":71,"oldContent":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"DELETE","lineNumber":73,"oldContent":"        );"},{"type":"DELETE","lineNumber":75,"oldContent":"        _viewModel.clearError();"},{"type":"DELETE","lineNumber":77,"oldContent":"      }"},{"type":"DELETE","lineNumber":79,"oldContent":"    }"},{"type":"DELETE","lineNumber":81,"oldContent":"  }"},{"type":"INSERT","lineNumber":55,"content":"        _viewModel.clearError();"},{"type":"INSERT","lineNumber":56,"content":"      }"},{"type":"INSERT","lineNumber":57,"content":"    }"},{"type":"INSERT","lineNumber":58,"content":"  }"},{"type":"INSERT","lineNumber":60,"content":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"INSERT","lineNumber":61,"content":"        );"},{"type":"DELETE","lineNumber":85,"oldContent":"  // Format phone number to E.164 standard"},{"type":"DELETE","lineNumber":87,"oldContent":"  String _formatPhoneNumber(String phone) {"},{"type":"DELETE","lineNumber":89,"oldContent":"    // Remove all non-digit characters"},{"type":"INSERT","lineNumber":66,"content":""},{"type":"INSERT","lineNumber":67,"content":"  // Format phone number to E.164 standard"},{"type":"INSERT","lineNumber":68,"content":"  String _formatPhoneNumber(String phone) {"},{"type":"INSERT","lineNumber":69,"content":"    // Remove all non-digit characters"},{"type":"INSERT","lineNumber":77,"content":"    }"},{"type":"INSERT","lineNumber":80,"content":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":101,"oldContent":"    _emailController.dispose();"},{"type":"INSERT","lineNumber":89,"content":"    "},{"type":"INSERT","lineNumber":91,"content":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":92,"content":"      "},{"type":"INSERT","lineNumber":107,"content":"          final shouldContinue = await showDialog<bool>("},{"type":"DELETE","lineNumber":127,"oldContent":"    }"},{"type":"DELETE","lineNumber":131,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":140,"oldContent":"    "},{"type":"DELETE","lineNumber":142,"oldContent":"      setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":144,"oldContent":"      "},{"type":"INSERT","lineNumber":125,"content":"          "},{"type":"INSERT","lineNumber":126,"content":"          if (!shouldContinue) {"},{"type":"INSERT","lineNumber":131,"content":"      }"},{"type":"INSERT","lineNumber":132,"content":"      "},{"type":"INSERT","lineNumber":133,"content":"      // Register the user"},{"type":"INSERT","lineNumber":134,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":156,"oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"DELETE","lineNumber":175,"oldContent":"          "},{"type":"DELETE","lineNumber":176,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":181,"oldContent":"      }"},{"type":"INSERT","lineNumber":163,"content":"        }"},{"type":"DELETE","lineNumber":183,"oldContent":"      "},{"type":"DELETE","lineNumber":184,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":186,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":168,"content":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"INSERT","lineNumber":169,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":170,"content":"          ),"},{"type":"INSERT","lineNumber":171,"content":"        );"},{"type":"INSERT","lineNumber":174,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":189,"content":"  }"},{"type":"INSERT","lineNumber":190,"content":""},{"type":"INSERT","lineNumber":191,"content":"  @override"},{"type":"INSERT","lineNumber":192,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":193,"content":"    return Consumer<AuthViewModel>("},{"type":"INSERT","lineNumber":194,"content":"      builder: (context, viewModel, _) {"},{"type":"DELETE","lineNumber":210,"oldContent":"        }"},{"type":"DELETE","lineNumber":213,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"DELETE","lineNumber":215,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":217,"oldContent":"          ),"},{"type":"DELETE","lineNumber":219,"oldContent":"        );"},{"type":"DELETE","lineNumber":223,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":221,"content":"                        fontSize: 24,"},{"type":"DELETE","lineNumber":238,"oldContent":"  }"},{"type":"DELETE","lineNumber":240,"oldContent":""},{"type":"DELETE","lineNumber":241,"oldContent":"  @override"},{"type":"DELETE","lineNumber":243,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":245,"oldContent":"    return Consumer<AuthViewModel>("},{"type":"DELETE","lineNumber":247,"oldContent":"      builder: (context, viewModel, _) {"},{"type":"INSERT","lineNumber":228,"content":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":275,"oldContent":"                        fontSize: 24,"},{"type":"DELETE","lineNumber":283,"oldContent":"                const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":380,"content":"                    }"},{"type":"INSERT","lineNumber":381,"content":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":395,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":396,"content":"                      borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":397,"content":"                    ),"},{"type":"INSERT","lineNumber":398,"content":"                  ),"},{"type":"INSERT","lineNumber":402,"content":"                          height: 24,"},{"type":"INSERT","lineNumber":403,"content":"                          child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":427,"oldContent":"                    }"},{"type":"INSERT","lineNumber":413,"content":"                "},{"type":"DELETE","lineNumber":429,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":444,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":446,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":448,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":450,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":455,"oldContent":"                          height: 24,"},{"type":"DELETE","lineNumber":457,"oldContent":"                          child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":467,"oldContent":"                "},{"type":"INSERT","lineNumber":450,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":451,"content":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":460,"content":"                      ),"},{"type":"INSERT","lineNumber":478,"content":"                            Icons.apple,"},{"type":"DELETE","lineNumber":502,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":503,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":488,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":489,"content":"                "},{"type":"DELETE","lineNumber":512,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":531,"oldContent":"                            Icons.apple,"},{"type":"DELETE","lineNumber":537,"oldContent":"                "},{"type":"DELETE","lineNumber":538,"oldContent":"                const SizedBox(height: 24),"}]},{"timestamp":1754614668919,"changes":[{"type":"DELETE","lineNumber":41,"oldContent":"        _viewModel.clearError();"},{"type":"DELETE","lineNumber":42,"oldContent":"      }"},{"type":"DELETE","lineNumber":44,"oldContent":"    }"},{"type":"DELETE","lineNumber":45,"oldContent":"  }"},{"type":"DELETE","lineNumber":47,"oldContent":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"DELETE","lineNumber":49,"oldContent":"        );"},{"type":"DELETE","lineNumber":52,"oldContent":""},{"type":"DELETE","lineNumber":54,"oldContent":"  // Format phone number to E.164 standard"},{"type":"DELETE","lineNumber":55,"oldContent":"  String _formatPhoneNumber(String phone) {"},{"type":"DELETE","lineNumber":57,"oldContent":"    // Remove all non-digit characters"},{"type":"DELETE","lineNumber":62,"oldContent":"    }"},{"type":"DELETE","lineNumber":64,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":55,"content":"        _viewModel.clearError();"},{"type":"INSERT","lineNumber":56,"content":"      }"},{"type":"INSERT","lineNumber":57,"content":"    }"},{"type":"INSERT","lineNumber":58,"content":"  }"},{"type":"INSERT","lineNumber":60,"content":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"INSERT","lineNumber":61,"content":"        );"},{"type":"DELETE","lineNumber":71,"oldContent":"    "},{"type":"DELETE","lineNumber":73,"oldContent":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":66,"content":""},{"type":"INSERT","lineNumber":67,"content":"  // Format phone number to E.164 standard"},{"type":"INSERT","lineNumber":68,"content":"  String _formatPhoneNumber(String phone) {"},{"type":"INSERT","lineNumber":69,"content":"    // Remove all non-digit characters"},{"type":"DELETE","lineNumber":75,"oldContent":"      "},{"type":"INSERT","lineNumber":77,"content":"    }"},{"type":"INSERT","lineNumber":80,"content":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":90,"oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"INSERT","lineNumber":89,"content":"    "},{"type":"INSERT","lineNumber":91,"content":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":92,"content":"      "},{"type":"INSERT","lineNumber":107,"content":"          final shouldContinue = await showDialog<bool>("},{"type":"DELETE","lineNumber":109,"oldContent":"          "},{"type":"DELETE","lineNumber":111,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":116,"oldContent":"      }"},{"type":"DELETE","lineNumber":117,"oldContent":"      "},{"type":"DELETE","lineNumber":119,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":121,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":125,"content":"          "},{"type":"INSERT","lineNumber":126,"content":"          if (!shouldContinue) {"},{"type":"INSERT","lineNumber":131,"content":"      }"},{"type":"INSERT","lineNumber":132,"content":"      "},{"type":"INSERT","lineNumber":133,"content":"      // Register the user"},{"type":"INSERT","lineNumber":134,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":147,"oldContent":"        }"},{"type":"DELETE","lineNumber":153,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"DELETE","lineNumber":155,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":157,"oldContent":"          ),"},{"type":"DELETE","lineNumber":159,"oldContent":"        );"},{"type":"MODIFY","lineNumber":163,"content":"        }","oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":173,"oldContent":"  }"},{"type":"INSERT","lineNumber":168,"content":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"INSERT","lineNumber":169,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":170,"content":"          ),"},{"type":"INSERT","lineNumber":171,"content":"        );"},{"type":"DELETE","lineNumber":175,"oldContent":""},{"type":"DELETE","lineNumber":177,"oldContent":"  @override"},{"type":"INSERT","lineNumber":174,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":179,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":181,"oldContent":"    return Consumer<AuthViewModel>("},{"type":"DELETE","lineNumber":183,"oldContent":"      builder: (context, viewModel, _) {"},{"type":"INSERT","lineNumber":189,"content":"  }"},{"type":"INSERT","lineNumber":190,"content":""},{"type":"INSERT","lineNumber":191,"content":"  @override"},{"type":"INSERT","lineNumber":192,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":193,"content":"    return Consumer<AuthViewModel>("},{"type":"INSERT","lineNumber":194,"content":"      builder: (context, viewModel, _) {"},{"type":"DELETE","lineNumber":206,"oldContent":"                        fontSize: 24,"},{"type":"DELETE","lineNumber":211,"oldContent":"                // Back button and title"},{"type":"DELETE","lineNumber":212,"oldContent":"                Row("},{"type":"DELETE","lineNumber":214,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":215,"oldContent":"                    IconButton("},{"type":"DELETE","lineNumber":216,"oldContent":"                      icon: const Icon(Icons.arrow_back_ios, size: 20),"},{"type":"DELETE","lineNumber":217,"oldContent":"                      onPressed: () => Navigator.pop(context),"},{"type":"DELETE","lineNumber":218,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":219,"oldContent":"                    const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":220,"oldContent":"                    const Text("},{"type":"DELETE","lineNumber":221,"oldContent":"                      'Create Account',"},{"type":"DELETE","lineNumber":222,"oldContent":"                      style: TextStyle("},{"type":"DELETE","lineNumber":223,"oldContent":"                        fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":211,"content":"                // Logo and welcome text"},{"type":"INSERT","lineNumber":212,"content":"                Center("},{"type":"INSERT","lineNumber":213,"content":"                  child: Column("},{"type":"INSERT","lineNumber":214,"content":"                    children: ["},{"type":"INSERT","lineNumber":215,"content":"                      SvgPicture.asset("},{"type":"INSERT","lineNumber":216,"content":"                        'assets/images/logo.svg',"},{"type":"INSERT","lineNumber":217,"content":"                        height: 100,"},{"type":"INSERT","lineNumber":218,"content":"                        width: 100,"},{"type":"DELETE","lineNumber":225,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":226,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":227,"oldContent":"                ),"},{"type":"DELETE","lineNumber":228,"oldContent":"                "},{"type":"DELETE","lineNumber":229,"oldContent":"                "},{"type":"DELETE","lineNumber":230,"oldContent":"                // Welcome text"},{"type":"DELETE","lineNumber":231,"oldContent":"                const Text("},{"type":"DELETE","lineNumber":232,"oldContent":"                  'Create an Account',"},{"type":"DELETE","lineNumber":233,"oldContent":"                  style: TextStyle("},{"type":"DELETE","lineNumber":234,"oldContent":"                    fontSize: 28,"},{"type":"DELETE","lineNumber":235,"oldContent":"                    fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":220,"content":"                      const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":221,"content":"                      Text("},{"type":"INSERT","lineNumber":222,"content":"                        'Create Account',"},{"type":"INSERT","lineNumber":223,"content":"                        style: Theme.of(context).textTheme.headlineMedium?.copyWith("},{"type":"INSERT","lineNumber":224,"content":"                              fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":225,"content":"                            ),"},{"type":"INSERT","lineNumber":226,"content":"                      ),"},{"type":"INSERT","lineNumber":227,"content":"                      const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":228,"content":"                      Text("},{"type":"INSERT","lineNumber":229,"content":"                        'Fill in your details to create an account',"},{"type":"INSERT","lineNumber":230,"content":"                        style: Theme.of(context).textTheme.bodyMedium?.copyWith("},{"type":"INSERT","lineNumber":231,"content":"                              color: Colors.grey[600],"},{"type":"INSERT","lineNumber":232,"content":"                            ),"},{"type":"INSERT","lineNumber":233,"content":"                      ),"},{"type":"INSERT","lineNumber":234,"content":"                    ],"},{"type":"DELETE","lineNumber":238,"oldContent":"                const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":239,"oldContent":"                Text("},{"type":"DELETE","lineNumber":240,"oldContent":"                  'Fill in your details to get started',"},{"type":"DELETE","lineNumber":241,"oldContent":"                  style: TextStyle("},{"type":"DELETE","lineNumber":242,"oldContent":"                    fontSize: 16,"},{"type":"DELETE","lineNumber":243,"oldContent":"                    color: Colors.grey[600],"},{"type":"DELETE","lineNumber":244,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":245,"oldContent":"                ),"},{"type":"DELETE","lineNumber":246,"oldContent":"                "},{"type":"DELETE","lineNumber":247,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":248,"oldContent":"                "},{"type":"INSERT","lineNumber":237,"content":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":252,"oldContent":"                  decoration: InputDecoration("},{"type":"INSERT","lineNumber":241,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":254,"oldContent":"                    prefixIcon: const Icon(Icons.person_outline),"},{"type":"DELETE","lineNumber":255,"oldContent":"                    border: OutlineInputBorder("},{"type":"DELETE","lineNumber":256,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":257,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":243,"content":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"INSERT","lineNumber":244,"content":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":266,"oldContent":"                "},{"type":"DELETE","lineNumber":267,"oldContent":"                const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":268,"oldContent":"                "},{"type":"INSERT","lineNumber":253,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":273,"oldContent":"                  decoration: InputDecoration("},{"type":"INSERT","lineNumber":258,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":275,"oldContent":"                    prefixIcon: const Icon(Icons.email_outlined),"},{"type":"DELETE","lineNumber":276,"oldContent":"                    border: OutlineInputBorder("},{"type":"DELETE","lineNumber":277,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":278,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":260,"content":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"INSERT","lineNumber":261,"content":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":284,"oldContent":"                    if (!RegExp(r'^[^@]+@[^\\s]+\\.[^\\s]+').hasMatch(value)) {"},{"type":"INSERT","lineNumber":267,"content":"                    if (!value.contains('@')) {"},{"type":"DELETE","lineNumber":290,"oldContent":"                "},{"type":"DELETE","lineNumber":291,"oldContent":"                const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":292,"oldContent":"                "},{"type":"DELETE","lineNumber":293,"oldContent":"                // Phone field"},{"type":"INSERT","lineNumber":273,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":274,"content":"                // Phone field (optional)"},{"type":"DELETE","lineNumber":297,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":298,"oldContent":"                    labelText: 'Phone Number',"},{"type":"DELETE","lineNumber":299,"oldContent":"                    prefixIcon: const Icon(Icons.phone_outlined),"},{"type":"DELETE","lineNumber":300,"oldContent":"                    border: OutlineInputBorder("},{"type":"DELETE","lineNumber":301,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":302,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":278,"content":"                  decoration: const InputDecoration("},{"type":"INSERT","lineNumber":279,"content":"                    labelText: 'Phone Number (Optional)',"},{"type":"INSERT","lineNumber":280,"content":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"INSERT","lineNumber":281,"content":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":282,"content":"                    hintText: '+1 (123) 456-7890',"},{"type":"DELETE","lineNumber":304,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":305,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":306,"oldContent":"                      return 'Please enter your phone number';"},{"type":"INSERT","lineNumber":284,"content":"                  onChanged: (value) {"},{"type":"INSERT","lineNumber":285,"content":"                    // Format phone number as user types"},{"type":"INSERT","lineNumber":286,"content":"                    if (value.length == 1 && value != '+') {"},{"type":"INSERT","lineNumber":287,"content":"                      _phoneController.text = '+$value';"},{"type":"INSERT","lineNumber":288,"content":"                      _phoneController.selection = TextSelection.fromPosition("},{"type":"INSERT","lineNumber":289,"content":"                        TextPosition(offset: _phoneController.text.length),"},{"type":"INSERT","lineNumber":290,"content":"                      );"},{"type":"DELETE","lineNumber":308,"oldContent":"                    // Simple phone number validation (can be enhanced)"},{"type":"DELETE","lineNumber":309,"oldContent":"                    if (value.length < 10) {"},{"type":"DELETE","lineNumber":310,"oldContent":"                      return 'Please enter a valid phone number';"},{"type":"DELETE","lineNumber":311,"oldContent":"                    }"},{"type":"DELETE","lineNumber":312,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":315,"oldContent":"                "},{"type":"DELETE","lineNumber":316,"oldContent":"                const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":317,"oldContent":"                "},{"type":"INSERT","lineNumber":294,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":327,"oldContent":"                        _obscurePassword "},{"type":"DELETE","lineNumber":328,"oldContent":"                            ? Icons.visibility_outlined "},{"type":"INSERT","lineNumber":304,"content":"                        _obscurePassword"},{"type":"INSERT","lineNumber":305,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":337,"oldContent":"                    border: OutlineInputBorder("},{"type":"DELETE","lineNumber":338,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":339,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":314,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":351,"oldContent":"                "},{"type":"DELETE","lineNumber":352,"oldContent":"                const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":353,"oldContent":"                "},{"type":"INSERT","lineNumber":326,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":358,"oldContent":"                    }"},{"type":"DELETE","lineNumber":360,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":365,"oldContent":"                        _obscureConfirmPassword "},{"type":"DELETE","lineNumber":366,"oldContent":"                            ? Icons.visibility_outlined "},{"type":"INSERT","lineNumber":336,"content":"                        _obscureConfirmPassword"},{"type":"INSERT","lineNumber":337,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":375,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":376,"oldContent":"                    border: OutlineInputBorder("},{"type":"DELETE","lineNumber":377,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":378,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":379,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":380,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":346,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":382,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":386,"oldContent":"                          height: 24,"},{"type":"INSERT","lineNumber":351,"content":"                    }"},{"type":"INSERT","lineNumber":352,"content":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":388,"oldContent":"                          child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":393,"oldContent":"                "},{"type":"DELETE","lineNumber":394,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":395,"oldContent":"                "},{"type":"INSERT","lineNumber":358,"content":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":398,"oldContent":"                  onPressed: viewModel.isLoading ? null : _register,"},{"type":"DELETE","lineNumber":399,"oldContent":"                "},{"type":"INSERT","lineNumber":361,"content":"                  onPressed: _isLoading ? null : _register,"},{"type":"DELETE","lineNumber":402,"oldContent":"                  child: viewModel.isLoading"},{"type":"INSERT","lineNumber":364,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":365,"content":"                      borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":366,"content":"                    ),"},{"type":"INSERT","lineNumber":367,"content":"                  ),"},{"type":"INSERT","lineNumber":368,"content":"                  child: _isLoading"},{"type":"DELETE","lineNumber":404,"oldContent":"                          width: 24,"},{"type":"DELETE","lineNumber":405,"oldContent":"                            color: Colors.white,"},{"type":"INSERT","lineNumber":370,"content":"                          height: 20,"},{"type":"INSERT","lineNumber":371,"content":"                          width: 20,"},{"type":"INSERT","lineNumber":372,"content":"                          child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":374,"content":"                            valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"DELETE","lineNumber":409,"oldContent":"                      : const Text("},{"type":"DELETE","lineNumber":410,"oldContent":"                          'Continue',"},{"type":"DELETE","lineNumber":411,"oldContent":"                          style: TextStyle(fontSize: 16),"},{"type":"DELETE","lineNumber":412,"oldContent":"                        ),"},{"type":"INSERT","lineNumber":377,"content":"                      : const Text('Create Account'),"},{"type":"DELETE","lineNumber":414,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":415,"oldContent":"                "},{"type":"DELETE","lineNumber":416,"oldContent":"                // Divider with \"or\" text"},{"type":"DELETE","lineNumber":417,"oldContent":"                Row("},{"type":"DELETE","lineNumber":418,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":419,"oldContent":"                    const Expanded(child: Divider()),"},{"type":"DELETE","lineNumber":420,"oldContent":"                    Padding("},{"type":"DELETE","lineNumber":421,"oldContent":"                      padding: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"DELETE","lineNumber":422,"oldContent":"                      child: Text("},{"type":"DELETE","lineNumber":423,"oldContent":"                        'or sign up with',"},{"type":"DELETE","lineNumber":424,"oldContent":"                        style: TextStyle("},{"type":"DELETE","lineNumber":425,"oldContent":"                          color: Colors.grey[600],"},{"type":"DELETE","lineNumber":426,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":427,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":428,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":429,"oldContent":"                    const Expanded(child: Divider()),"},{"type":"DELETE","lineNumber":430,"oldContent":"                  ],"},{"type":"INSERT","lineNumber":379,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":432,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":433,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":441,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":399,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":400,"content":"                              borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":459,"oldContent":"                            Icons.apple,"},{"type":"INSERT","lineNumber":409,"content":"                      ),"},{"type":"DELETE","lineNumber":470,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":472,"oldContent":"                "},{"type":"INSERT","lineNumber":427,"content":"                            Icons.apple,"},{"type":"INSERT","lineNumber":437,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":438,"content":"                "}]},{"timestamp":1754614729111,"changes":[{"type":"DELETE","lineNumber":47,"oldContent":"        _viewModel.clearError();"},{"type":"DELETE","lineNumber":48,"oldContent":"      }"},{"type":"DELETE","lineNumber":50,"oldContent":"    }"},{"type":"DELETE","lineNumber":51,"oldContent":"  }"},{"type":"DELETE","lineNumber":54,"oldContent":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"DELETE","lineNumber":56,"oldContent":"        );"},{"type":"DELETE","lineNumber":60,"oldContent":""},{"type":"DELETE","lineNumber":62,"oldContent":"  // Format phone number to E.164 standard"},{"type":"DELETE","lineNumber":63,"oldContent":""},{"type":"DELETE","lineNumber":64,"oldContent":"  String _formatPhoneNumber(String phone) {"},{"type":"DELETE","lineNumber":66,"oldContent":"    // Remove all non-digit characters"},{"type":"INSERT","lineNumber":59,"content":""},{"type":"INSERT","lineNumber":60,"content":"  // Format phone number to E.164 standard"},{"type":"INSERT","lineNumber":61,"content":"  String _formatPhoneNumber(String phone) {"},{"type":"INSERT","lineNumber":62,"content":"    // Remove all non-digit characters"},{"type":"DELETE","lineNumber":72,"oldContent":"    }"},{"type":"DELETE","lineNumber":76,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":70,"content":"    }"},{"type":"INSERT","lineNumber":73,"content":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":86,"oldContent":"    "},{"type":"DELETE","lineNumber":88,"oldContent":"      setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":90,"oldContent":"      "},{"type":"INSERT","lineNumber":82,"content":"    "},{"type":"INSERT","lineNumber":84,"content":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":85,"content":"      "},{"type":"DELETE","lineNumber":106,"oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"INSERT","lineNumber":100,"content":"          final shouldContinue = await showDialog<bool>("},{"type":"DELETE","lineNumber":119,"oldContent":"          "},{"type":"DELETE","lineNumber":121,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":127,"oldContent":"      }"},{"type":"INSERT","lineNumber":118,"content":"          "},{"type":"INSERT","lineNumber":119,"content":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":129,"oldContent":"      "},{"type":"DELETE","lineNumber":131,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":133,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":124,"content":"      }"},{"type":"INSERT","lineNumber":125,"content":"      "},{"type":"INSERT","lineNumber":126,"content":"      // Register the user"},{"type":"INSERT","lineNumber":127,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":158,"oldContent":"        }"},{"type":"DELETE","lineNumber":163,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"DELETE","lineNumber":165,"oldContent":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":156,"content":"        }"},{"type":"DELETE","lineNumber":167,"oldContent":"          ),"},{"type":"DELETE","lineNumber":169,"oldContent":"        );"},{"type":"DELETE","lineNumber":172,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":161,"content":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"INSERT","lineNumber":162,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":163,"content":"          ),"},{"type":"INSERT","lineNumber":164,"content":"        );"},{"type":"INSERT","lineNumber":167,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":183,"oldContent":"  }"},{"type":"DELETE","lineNumber":185,"oldContent":""},{"type":"DELETE","lineNumber":187,"oldContent":"  @override"},{"type":"DELETE","lineNumber":189,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":191,"oldContent":"    return Consumer<AuthViewModel>("},{"type":"DELETE","lineNumber":193,"oldContent":"      builder: (context, viewModel, _) {"},{"type":"DELETE","lineNumber":195,"oldContent":"        if (_isLoading) {"},{"type":"DELETE","lineNumber":196,"oldContent":"          return const Scaffold("},{"type":"DELETE","lineNumber":197,"oldContent":"            body: Center(child: CircularProgressIndicator()),"},{"type":"DELETE","lineNumber":198,"oldContent":"          );"},{"type":"DELETE","lineNumber":199,"oldContent":"        }"},{"type":"DELETE","lineNumber":200,"oldContent":"        "},{"type":"DELETE","lineNumber":201,"oldContent":"        return Scaffold("},{"type":"DELETE","lineNumber":202,"oldContent":"          body: SafeArea("},{"type":"DELETE","lineNumber":203,"oldContent":"        child: SingleChildScrollView("},{"type":"DELETE","lineNumber":204,"oldContent":"          padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":182,"content":"  }"},{"type":"INSERT","lineNumber":183,"content":""},{"type":"INSERT","lineNumber":184,"content":"  @override"},{"type":"INSERT","lineNumber":185,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":186,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":187,"content":"      body: SingleChildScrollView("},{"type":"INSERT","lineNumber":188,"content":"        child: Padding("},{"type":"INSERT","lineNumber":189,"content":"          padding: const EdgeInsets.all(16.0),"},{"type":"INSERT","lineNumber":195,"content":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":213,"oldContent":"                const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":204,"content":"                      ),"},{"type":"DELETE","lineNumber":224,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":236,"oldContent":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":238,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":239,"oldContent":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"DELETE","lineNumber":240,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":222,"content":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":244,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":245,"oldContent":"                    labelText: 'Full Name',"},{"type":"INSERT","lineNumber":227,"content":"                    labelText: 'Full Name',"},{"type":"INSERT","lineNumber":228,"content":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"INSERT","lineNumber":229,"content":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":249,"oldContent":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"DELETE","lineNumber":251,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":257,"oldContent":"                    if (!value.contains('@')) {"},{"type":"INSERT","lineNumber":238,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":262,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":263,"oldContent":"                // Phone field (optional)"},{"type":"DELETE","lineNumber":264,"oldContent":"                    labelText: 'Email',"},{"type":"DELETE","lineNumber":266,"oldContent":"                    labelText: 'Phone Number (Optional)',"},{"type":"INSERT","lineNumber":244,"content":"                    labelText: 'Email',"},{"type":"INSERT","lineNumber":245,"content":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"INSERT","lineNumber":246,"content":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":268,"oldContent":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"DELETE","lineNumber":270,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":272,"oldContent":"                    hintText: '+1 (123) 456-7890',"},{"type":"DELETE","lineNumber":275,"oldContent":"                  onChanged: (value) {"},{"type":"DELETE","lineNumber":276,"oldContent":"                    // Format phone number as user types"},{"type":"INSERT","lineNumber":252,"content":"                    if (!value.contains('@')) {"},{"type":"DELETE","lineNumber":278,"oldContent":"                    if (value.length == 1 && value != '+') {"},{"type":"DELETE","lineNumber":280,"oldContent":"                      _phoneController.text = '+$value';"},{"type":"DELETE","lineNumber":282,"oldContent":"                      _phoneController.selection = TextSelection.fromPosition("},{"type":"DELETE","lineNumber":284,"oldContent":"                        TextPosition(offset: _phoneController.text.length),"},{"type":"DELETE","lineNumber":286,"oldContent":"                      );"},{"type":"INSERT","lineNumber":259,"content":"                // Phone field (optional)"},{"type":"INSERT","lineNumber":263,"content":"                  decoration: const InputDecoration("},{"type":"INSERT","lineNumber":264,"content":"                    labelText: 'Phone Number (Optional)',"},{"type":"INSERT","lineNumber":265,"content":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"INSERT","lineNumber":266,"content":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":267,"content":"                    hintText: '+1 (123) 456-7890',"},{"type":"DELETE","lineNumber":292,"oldContent":"                        _obscurePassword"},{"type":"DELETE","lineNumber":293,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"INSERT","lineNumber":269,"content":"                  onChanged: (value) {"},{"type":"INSERT","lineNumber":270,"content":"                    // Format phone number as user types"},{"type":"INSERT","lineNumber":271,"content":"                    if (value.length == 1 && value != '+') {"},{"type":"INSERT","lineNumber":272,"content":"                      _phoneController.text = '+$value';"},{"type":"INSERT","lineNumber":273,"content":"                      _phoneController.selection = TextSelection.fromPosition("},{"type":"INSERT","lineNumber":274,"content":"                        TextPosition(offset: _phoneController.text.length),"},{"type":"INSERT","lineNumber":275,"content":"                      );"},{"type":"DELETE","lineNumber":296,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":279,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":306,"oldContent":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":289,"content":"                        _obscurePassword"},{"type":"INSERT","lineNumber":290,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":315,"oldContent":"                        _obscureConfirmPassword"},{"type":"DELETE","lineNumber":317,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"INSERT","lineNumber":299,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":324,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":330,"oldContent":"                    }"},{"type":"DELETE","lineNumber":331,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":311,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":336,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":338,"oldContent":"                  onPressed: _isLoading ? null : _register,"},{"type":"DELETE","lineNumber":342,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":344,"oldContent":"                      borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":345,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":346,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":321,"content":"                        _obscureConfirmPassword"},{"type":"INSERT","lineNumber":322,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":348,"oldContent":"                  child: _isLoading"},{"type":"DELETE","lineNumber":351,"oldContent":"                          height: 20,"},{"type":"DELETE","lineNumber":353,"oldContent":"                          width: 20,"},{"type":"DELETE","lineNumber":355,"oldContent":"                          child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":358,"oldContent":"                            valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"DELETE","lineNumber":360,"oldContent":"                      : const Text('Create Account'),"},{"type":"DELETE","lineNumber":361,"oldContent":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":331,"content":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":336,"content":"                    }"},{"type":"INSERT","lineNumber":337,"content":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":343,"content":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":373,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":374,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":346,"content":"                  onPressed: _isLoading ? null : _register,"},{"type":"INSERT","lineNumber":349,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":350,"content":"                      borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":351,"content":"                    ),"},{"type":"INSERT","lineNumber":352,"content":"                  ),"},{"type":"INSERT","lineNumber":353,"content":"                  child: _isLoading"},{"type":"INSERT","lineNumber":355,"content":"                          height: 20,"},{"type":"INSERT","lineNumber":356,"content":"                          width: 20,"},{"type":"INSERT","lineNumber":357,"content":"                          child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":359,"content":"                            valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"DELETE","lineNumber":381,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":362,"content":"                      : const Text('Create Account'),"},{"type":"DELETE","lineNumber":383,"oldContent":"                            Icons.apple,"},{"type":"DELETE","lineNumber":384,"oldContent":"                ),"},{"type":"DELETE","lineNumber":385,"oldContent":"                "},{"type":"DELETE","lineNumber":386,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":387,"oldContent":"                "},{"type":"DELETE","lineNumber":388,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":389,"oldContent":"                // Social sign up buttons"},{"type":"DELETE","lineNumber":390,"oldContent":"                "},{"type":"DELETE","lineNumber":391,"oldContent":"                ConstrainedBox("},{"type":"DELETE","lineNumber":392,"oldContent":"                  constraints: const BoxConstraints(maxWidth: 300),"},{"type":"DELETE","lineNumber":393,"oldContent":"                  child: Row("},{"type":"DELETE","lineNumber":394,"oldContent":"                    mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":395,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":396,"oldContent":"                      // Google"},{"type":"DELETE","lineNumber":397,"oldContent":"                      Expanded("},{"type":"DELETE","lineNumber":398,"oldContent":"                        child: IconButton("},{"type":"DELETE","lineNumber":399,"oldContent":"                          onPressed: () {"},{"type":"DELETE","lineNumber":400,"oldContent":"                            // TODO: Implement Google sign up"},{"type":"DELETE","lineNumber":401,"oldContent":"                          },"},{"type":"DELETE","lineNumber":402,"oldContent":"                          style: IconButton.styleFrom("},{"type":"DELETE","lineNumber":403,"oldContent":"                            backgroundColor: Colors.grey[100],"},{"type":"DELETE","lineNumber":404,"oldContent":"                            padding: const EdgeInsets.symmetric(vertical: 12, horizontal: 16),"},{"type":"INSERT","lineNumber":364,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":365,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":366,"content":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":375,"content":"                      ),"},{"type":"INSERT","lineNumber":393,"content":"                            Icons.apple,"},{"type":"INSERT","lineNumber":403,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":404,"content":"                "}]},{"timestamp":1754614774308,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:flutter_svg/flutter_svg.dart';","oldContent":"import 'package:family_tree_firebase/core/constants/app_constants.dart';"},{"type":"MODIFY","lineNumber":4,"content":"import 'package:family_tree_firebase/core/constants/app_constants.dart';","oldContent":""},{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"INSERT","lineNumber":7,"content":""},{"type":"DELETE","lineNumber":15,"oldContent":"  final _nameController = TextEditingController();"},{"type":"MODIFY","lineNumber":26,"content":"","oldContent":"  "},{"type":"MODIFY","lineNumber":38,"content":"","oldContent":"  "},{"type":"MODIFY","lineNumber":49,"content":"","oldContent":"  "},{"type":"DELETE","lineNumber":53,"oldContent":""},{"type":"DELETE","lineNumber":55,"oldContent":"  // Format phone number to E.164 standard"},{"type":"DELETE","lineNumber":56,"oldContent":"  String _formatPhoneNumber(String phone) {"},{"type":"DELETE","lineNumber":58,"oldContent":"    // Remove all non-digit characters"},{"type":"DELETE","lineNumber":63,"oldContent":"    }"},{"type":"INSERT","lineNumber":60,"content":""},{"type":"INSERT","lineNumber":61,"content":"  // Format phone number to E.164 standard"},{"type":"INSERT","lineNumber":62,"content":"  String _formatPhoneNumber(String phone) {"},{"type":"INSERT","lineNumber":63,"content":"    if (phone.isEmpty) return '';"},{"type":"INSERT","lineNumber":64,"content":""},{"type":"INSERT","lineNumber":65,"content":"    // Remove all non-digit characters"},{"type":"DELETE","lineNumber":65,"oldContent":"    "},{"type":"DELETE","lineNumber":66,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":67,"content":""},{"type":"DELETE","lineNumber":72,"oldContent":"    "},{"type":"INSERT","lineNumber":73,"content":"    }"},{"type":"INSERT","lineNumber":74,"content":""},{"type":"INSERT","lineNumber":76,"content":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":75,"oldContent":"    "},{"type":"DELETE","lineNumber":77,"oldContent":"    "},{"type":"DELETE","lineNumber":78,"oldContent":"      setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":79,"content":""},{"type":"DELETE","lineNumber":80,"oldContent":"      "},{"type":"INSERT","lineNumber":85,"content":""},{"type":"DELETE","lineNumber":86,"oldContent":"      // Format phone number to E.164 standard"},{"type":"MODIFY","lineNumber":87,"content":"      setState(() => _isLoading = true);","oldContent":"      final phoneNumber = _formatPhoneNumber(_phoneController.text.trim());"},{"type":"INSERT","lineNumber":88,"content":""},{"type":"DELETE","lineNumber":91,"oldContent":"      "},{"type":"DELETE","lineNumber":92,"oldContent":"      // First, try to send OTP if phone number is provided"},{"type":"DELETE","lineNumber":93,"oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"INSERT","lineNumber":92,"content":"      final phoneNumber = _phoneController.text.trim().isNotEmpty"},{"type":"INSERT","lineNumber":93,"content":"          ? _formatPhoneNumber(_phoneController.text.trim())"},{"type":"INSERT","lineNumber":94,"content":"          : null;"},{"type":"INSERT","lineNumber":95,"content":""},{"type":"INSERT","lineNumber":96,"content":"      // Register the user"},{"type":"INSERT","lineNumber":97,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":98,"content":"        email: email,"},{"type":"INSERT","lineNumber":99,"content":"        password: password,"},{"type":"INSERT","lineNumber":100,"content":"        name: name,"},{"type":"INSERT","lineNumber":101,"content":"        phone: phoneNumber,"},{"type":"INSERT","lineNumber":102,"content":"      );"},{"type":"INSERT","lineNumber":103,"content":""},{"type":"INSERT","lineNumber":104,"content":"      if (success && mounted) {"},{"type":"INSERT","lineNumber":105,"content":"        // Navigate to home screen on success"},{"type":"INSERT","lineNumber":106,"content":"        Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":107,"content":"          context,"},{"type":"INSERT","lineNumber":108,"content":"          '/home',"},{"type":"INSERT","lineNumber":109,"content":"          (route) => false,"},{"type":"INSERT","lineNumber":110,"content":"        );"},{"type":"INSERT","lineNumber":111,"content":"      }"},{"type":"DELETE","lineNumber":96,"oldContent":"        "},{"type":"INSERT","lineNumber":114,"content":""},{"type":"DELETE","lineNumber":98,"oldContent":"        "},{"type":"INSERT","lineNumber":116,"content":""},{"type":"INSERT","lineNumber":119,"content":"          final shouldContinue = await showDialog<bool>("},{"type":"DELETE","lineNumber":111,"oldContent":"          "},{"type":"DELETE","lineNumber":113,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":117,"oldContent":"      }"},{"type":"DELETE","lineNumber":119,"oldContent":"      "},{"type":"DELETE","lineNumber":121,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":123,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":137,"content":""},{"type":"INSERT","lineNumber":138,"content":"          if (!shouldContinue) {"},{"type":"INSERT","lineNumber":143,"content":"      }"},{"type":"INSERT","lineNumber":144,"content":""},{"type":"INSERT","lineNumber":145,"content":"      // Register the user"},{"type":"INSERT","lineNumber":146,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":133,"oldContent":"      "},{"type":"INSERT","lineNumber":152,"content":""},{"type":"DELETE","lineNumber":135,"oldContent":"      "},{"type":"INSERT","lineNumber":154,"content":""},{"type":"DELETE","lineNumber":149,"oldContent":"        }"},{"type":"DELETE","lineNumber":154,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"DELETE","lineNumber":156,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":158,"oldContent":"          ),"},{"type":"DELETE","lineNumber":159,"oldContent":"        );"},{"type":"INSERT","lineNumber":175,"content":"        }"},{"type":"DELETE","lineNumber":162,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":180,"content":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"INSERT","lineNumber":181,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":182,"content":"          ),"},{"type":"INSERT","lineNumber":183,"content":"        );"},{"type":"DELETE","lineNumber":167,"oldContent":"      }"},{"type":"INSERT","lineNumber":185,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":175,"oldContent":"  }"},{"type":"INSERT","lineNumber":194,"content":"      }"},{"type":"INSERT","lineNumber":195,"content":"    } finally {"},{"type":"INSERT","lineNumber":196,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":197,"content":"        setState(() {});"},{"type":"INSERT","lineNumber":198,"content":"      }"},{"type":"INSERT","lineNumber":199,"content":"    }"},{"type":"INSERT","lineNumber":200,"content":"  }"},{"type":"DELETE","lineNumber":179,"oldContent":"      }"},{"type":"DELETE","lineNumber":182,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":205,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":206,"content":"        title: const Text('Create Account'),"},{"type":"INSERT","lineNumber":207,"content":"        leading: IconButton("},{"type":"INSERT","lineNumber":208,"content":"          icon: const Icon(Icons.arrow_back),"},{"type":"INSERT","lineNumber":209,"content":"          onPressed: () => Navigator.pop(context),"},{"type":"INSERT","lineNumber":210,"content":"        ),"},{"type":"INSERT","lineNumber":211,"content":"      ),"},{"type":"DELETE","lineNumber":185,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":187,"oldContent":"        setState(() {});"},{"type":"DELETE","lineNumber":188,"oldContent":"      }"},{"type":"DELETE","lineNumber":189,"oldContent":"    }"},{"type":"DELETE","lineNumber":190,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":191,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":220,"content":"                const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":229,"content":"                      ),"},{"type":"DELETE","lineNumber":208,"oldContent":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":213,"oldContent":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":215,"oldContent":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"DELETE","lineNumber":217,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":245,"content":"                  ),"},{"type":"DELETE","lineNumber":225,"oldContent":"                const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":226,"oldContent":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":247,"content":"                const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":248,"content":"                // Name field"},{"type":"DELETE","lineNumber":229,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":230,"oldContent":"                    labelText: 'Email',"},{"type":"DELETE","lineNumber":231,"oldContent":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"DELETE","lineNumber":232,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":252,"content":"                    labelText: 'Full Name',"},{"type":"INSERT","lineNumber":253,"content":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"INSERT","lineNumber":254,"content":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":255,"content":"                  ),"},{"type":"DELETE","lineNumber":237,"oldContent":"                    if (!value.contains('@')) {"},{"type":"DELETE","lineNumber":242,"oldContent":"                "},{"type":"INSERT","lineNumber":263,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":264,"content":"                // Email field"},{"type":"DELETE","lineNumber":244,"oldContent":"                // Phone field (optional)"},{"type":"DELETE","lineNumber":247,"oldContent":"                  decoration: InputDecoration("},{"type":"INSERT","lineNumber":269,"content":"                    labelText: 'Email',"},{"type":"INSERT","lineNumber":270,"content":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"INSERT","lineNumber":271,"content":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":272,"content":"                  ),"},{"type":"INSERT","lineNumber":273,"content":"                  validator: (value) {"},{"type":"INSERT","lineNumber":274,"content":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":275,"content":"                      return 'Please enter your email';"},{"type":"INSERT","lineNumber":276,"content":"                    }"},{"type":"INSERT","lineNumber":277,"content":"                    if (!value.contains('@')) {"},{"type":"INSERT","lineNumber":278,"content":"                      return 'Please enter a valid email';"},{"type":"INSERT","lineNumber":279,"content":"                    }"},{"type":"INSERT","lineNumber":280,"content":"                    return null;"},{"type":"INSERT","lineNumber":281,"content":"                  },"},{"type":"INSERT","lineNumber":282,"content":"                ),"},{"type":"INSERT","lineNumber":283,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":284,"content":"                // Phone field (optional)"},{"type":"INSERT","lineNumber":285,"content":"                TextFormField("},{"type":"INSERT","lineNumber":286,"content":"                  controller: _phoneController,"},{"type":"INSERT","lineNumber":287,"content":"                  keyboardType: TextInputType.phone,"},{"type":"INSERT","lineNumber":288,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":251,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":254,"oldContent":"                  validator: (value) {"},{"type":"INSERT","lineNumber":293,"content":"                  ),"},{"type":"DELETE","lineNumber":256,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":259,"oldContent":"                      return 'Please enter your email';"},{"type":"DELETE","lineNumber":262,"oldContent":"                    }"},{"type":"DELETE","lineNumber":264,"oldContent":"                    if (!RegExp(r'^[^@]+@[^\\s]+\\.[^\\s]+').hasMatch(value)) {"},{"type":"DELETE","lineNumber":267,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":268,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":271,"oldContent":"                "},{"type":"DELETE","lineNumber":273,"oldContent":"                  controller: _phoneController,"},{"type":"DELETE","lineNumber":274,"oldContent":"                        _obscurePassword"},{"type":"DELETE","lineNumber":275,"oldContent":"                  keyboardType: TextInputType.phone,"},{"type":"DELETE","lineNumber":276,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":277,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":278,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":279,"oldContent":"                    // Simple phone number validation (can be enhanced)"},{"type":"DELETE","lineNumber":280,"oldContent":"                ),"},{"type":"DELETE","lineNumber":281,"oldContent":"                "},{"type":"DELETE","lineNumber":283,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":314,"content":"                        _obscurePassword"},{"type":"INSERT","lineNumber":315,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":295,"oldContent":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":324,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":304,"oldContent":"                        _obscureConfirmPassword"},{"type":"DELETE","lineNumber":306,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":314,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":336,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":319,"oldContent":"                    }"},{"type":"DELETE","lineNumber":320,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":325,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":327,"oldContent":"                  onPressed: _isLoading ? null : _register,"},{"type":"INSERT","lineNumber":346,"content":"                        _obscureConfirmPassword"},{"type":"INSERT","lineNumber":347,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":329,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":331,"oldContent":"                      borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":333,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":334,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":336,"oldContent":"                  child: _isLoading"},{"type":"DELETE","lineNumber":338,"oldContent":"                          height: 20,"},{"type":"DELETE","lineNumber":339,"oldContent":"                          width: 20,"},{"type":"DELETE","lineNumber":341,"oldContent":"                          child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":343,"oldContent":"                            valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"DELETE","lineNumber":345,"oldContent":"                      : const Text('Create Account'),"},{"type":"INSERT","lineNumber":356,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":348,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":350,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":352,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":361,"content":"                    }"},{"type":"INSERT","lineNumber":362,"content":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":368,"content":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":359,"oldContent":"                ElevatedButton("},{"type":"INSERT","lineNumber":370,"content":"                SizedBox("},{"type":"INSERT","lineNumber":371,"content":"                  width: double.infinity,"},{"type":"INSERT","lineNumber":372,"content":"                  child: ElevatedButton("},{"type":"INSERT","lineNumber":373,"content":"                    onPressed: _isLoading ? null : _register,"},{"type":"INSERT","lineNumber":374,"content":"                    style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":375,"content":"                      padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":376,"content":"                      shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":377,"content":"                        borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":361,"oldContent":"                  style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":362,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":363,"oldContent":"                      ? const SizedBox("},{"type":"DELETE","lineNumber":364,"oldContent":"                            strokeWidth: 2,"},{"type":"DELETE","lineNumber":365,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":366,"oldContent":"                        )"},{"type":"DELETE","lineNumber":367,"oldContent":"                ),"},{"type":"DELETE","lineNumber":368,"oldContent":"                            Icons.apple,"},{"type":"DELETE","lineNumber":369,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":370,"oldContent":"                "},{"type":"DELETE","lineNumber":371,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":372,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":373,"oldContent":"                          icon: SvgPicture.asset("},{"type":"DELETE","lineNumber":374,"oldContent":"                            'assets/images/google.svg',"},{"type":"DELETE","lineNumber":375,"oldContent":"                            width: 24,"},{"type":"DELETE","lineNumber":376,"oldContent":"                            height: 24,"},{"type":"DELETE","lineNumber":377,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":378,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":379,"oldContent":"                      "},{"type":"DELETE","lineNumber":380,"oldContent":"                      const SizedBox(width: 16),"},{"type":"DELETE","lineNumber":381,"oldContent":"                      "},{"type":"INSERT","lineNumber":379,"content":"                    ),"},{"type":"INSERT","lineNumber":380,"content":"                    child: _isLoading"},{"type":"INSERT","lineNumber":381,"content":"                        ? const SizedBox("},{"type":"INSERT","lineNumber":382,"content":"                            height: 20,"},{"type":"INSERT","lineNumber":383,"content":"                            width: 20,"},{"type":"INSERT","lineNumber":384,"content":"                            child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":385,"content":"                              strokeWidth: 2,"},{"type":"INSERT","lineNumber":386,"content":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"INSERT","lineNumber":401,"content":"                            Icons.apple,"},{"type":"INSERT","lineNumber":411,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":412,"content":"                "},{"type":"INSERT","lineNumber":418,"content":"                    TextButton("},{"type":"DELETE","lineNumber":424,"oldContent":"      ),"},{"type":"INSERT","lineNumber":436,"content":"    );"},{"type":"DELETE","lineNumber":431,"oldContent":"      },"}]},{"timestamp":1754614804431,"changes":[{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:family_tree_firebase/core/base/base_view.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"MODIFY","lineNumber":6,"content":"class RegisterScreen extends StatefulWidget {","oldContent":"class RegisterScreen extends StatefulWidget {"},{"type":"DELETE","lineNumber":26,"oldContent":"  "},{"type":"INSERT","lineNumber":25,"content":"  @override"},{"type":"DELETE","lineNumber":38,"oldContent":"  "},{"type":"INSERT","lineNumber":37,"content":"  @override"},{"type":"DELETE","lineNumber":49,"oldContent":"  "},{"type":"INSERT","lineNumber":48,"content":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":57,"oldContent":""},{"type":"DELETE","lineNumber":59,"oldContent":"  // Format phone number to E.164 standard"},{"type":"DELETE","lineNumber":61,"oldContent":"  String _formatPhoneNumber(String phone) {"},{"type":"INSERT","lineNumber":58,"content":""},{"type":"INSERT","lineNumber":59,"content":"  // Format phone number to E.164 standard"},{"type":"INSERT","lineNumber":60,"content":"  String _formatPhoneNumber(String phone) {"},{"type":"MODIFY","lineNumber":64,"content":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');","oldContent":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');"},{"type":"DELETE","lineNumber":74,"oldContent":"    // Add + prefix if missing"},{"type":"DELETE","lineNumber":76,"oldContent":"      digits = '+$digits';"},{"type":"INSERT","lineNumber":73,"content":"    // Add + prefix if missing"},{"type":"INSERT","lineNumber":75,"content":"      digits = '+$digits';"},{"type":"DELETE","lineNumber":95,"oldContent":"      if (phoneNumber.isNotEmpty) {"},{"type":"DELETE","lineNumber":97,"oldContent":"        final otpSent = await _viewModel.sendOtp(phoneNumber);"},{"type":"DELETE","lineNumber":98,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":99,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":94,"content":"      bool shouldVerifyPhone = phoneNumber != null && phoneNumber.isNotEmpty;"},{"type":"INSERT","lineNumber":95,"content":"      bool otpSent = false;"},{"type":"INSERT","lineNumber":96,"content":""},{"type":"INSERT","lineNumber":97,"content":"      // Try to send OTP if phone number is provided"},{"type":"INSERT","lineNumber":98,"content":"      if (shouldVerifyPhone) {"},{"type":"INSERT","lineNumber":99,"content":"        otpSent = await _viewModel.sendOtp(phoneNumber);"},{"type":"INSERT","lineNumber":100,"content":""},{"type":"DELETE","lineNumber":101,"oldContent":"        email: email,"},{"type":"MODIFY","lineNumber":102,"content":"","oldContent":"        password: password,"},{"type":"DELETE","lineNumber":104,"oldContent":"        name: name,"},{"type":"DELETE","lineNumber":106,"oldContent":"        phone: phoneNumber,"},{"type":"INSERT","lineNumber":105,"content":"          final shouldContinue = await showDialog<bool>("},{"type":"DELETE","lineNumber":108,"oldContent":"      );"},{"type":"DELETE","lineNumber":110,"oldContent":""},{"type":"DELETE","lineNumber":111,"oldContent":"              title: const Text('Phone Verification'),"},{"type":"DELETE","lineNumber":112,"oldContent":"      if (success && mounted) {"},{"type":"INSERT","lineNumber":108,"content":"              title: const Text('Phone Verification Failed'),"},{"type":"DELETE","lineNumber":114,"oldContent":"        // Navigate to home screen on success"},{"type":"DELETE","lineNumber":115,"oldContent":"                  'Unable to send OTP. Would you like to continue without phone verification?'),"},{"type":"DELETE","lineNumber":116,"oldContent":"        Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":110,"content":"                'We couldn\\'t send an OTP to your phone. Would you like to continue without phone verification?',"},{"type":"INSERT","lineNumber":111,"content":"              ),"},{"type":"DELETE","lineNumber":118,"oldContent":"          context,"},{"type":"DELETE","lineNumber":120,"oldContent":"          '/home',"},{"type":"DELETE","lineNumber":122,"oldContent":"          (route) => false,"},{"type":"DELETE","lineNumber":124,"oldContent":"        );"},{"type":"DELETE","lineNumber":126,"oldContent":"      }"},{"type":"DELETE","lineNumber":128,"oldContent":""},{"type":"DELETE","lineNumber":131,"oldContent":""},{"type":"DELETE","lineNumber":134,"oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"INSERT","lineNumber":124,"content":""},{"type":"INSERT","lineNumber":125,"content":"          if (!shouldContinue) {"},{"type":"INSERT","lineNumber":129,"content":"          shouldVerifyPhone = false; // Skip phone verification"},{"type":"INSERT","lineNumber":131,"content":"      }"},{"type":"INSERT","lineNumber":132,"content":""},{"type":"INSERT","lineNumber":133,"content":"      // Register the user"},{"type":"INSERT","lineNumber":134,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":140,"content":""},{"type":"DELETE","lineNumber":147,"oldContent":"      if (success) {"},{"type":"DELETE","lineNumber":149,"oldContent":"        if (phoneNumber.isNotEmpty && _viewModel.verificationId != null && _viewModel.verificationId!.isNotEmpty) {"},{"type":"DELETE","lineNumber":150,"oldContent":"          if (!shouldContinue) {"},{"type":"INSERT","lineNumber":143,"content":"      if (success) {"},{"type":"INSERT","lineNumber":144,"content":"        if (shouldVerifyPhone && _viewModel.verificationId != null && _viewModel.verificationId!.isNotEmpty) {"},{"type":"DELETE","lineNumber":152,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":153,"oldContent":"            Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":154,"oldContent":"              context,"},{"type":"DELETE","lineNumber":155,"oldContent":"              AppConstants.otpRoute,"},{"type":"DELETE","lineNumber":156,"oldContent":"      }"},{"type":"DELETE","lineNumber":157,"oldContent":"              arguments: {"},{"type":"DELETE","lineNumber":158,"oldContent":""},{"type":"DELETE","lineNumber":159,"oldContent":"                'verificationId': _viewModel.verificationId!,"},{"type":"DELETE","lineNumber":160,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":161,"oldContent":"                'phoneNumber': phoneNumber,"},{"type":"DELETE","lineNumber":162,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":163,"oldContent":"                'email': email,"},{"type":"DELETE","lineNumber":164,"oldContent":"                'isRegistration': true,"},{"type":"DELETE","lineNumber":165,"oldContent":"              },"},{"type":"DELETE","lineNumber":166,"oldContent":"            );"},{"type":"DELETE","lineNumber":167,"oldContent":"          }"},{"type":"DELETE","lineNumber":168,"oldContent":""},{"type":"INSERT","lineNumber":146,"content":"          Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":147,"content":"            context,"},{"type":"INSERT","lineNumber":148,"content":"            '/verify-otp',"},{"type":"INSERT","lineNumber":149,"content":"            arguments: {"},{"type":"INSERT","lineNumber":150,"content":"              'verificationId': _viewModel.verificationId!,"},{"type":"INSERT","lineNumber":151,"content":"              'phoneNumber': phoneNumber!,"},{"type":"INSERT","lineNumber":152,"content":"              'email': email,"},{"type":"INSERT","lineNumber":153,"content":"              'isRegistration': true,"},{"type":"INSERT","lineNumber":154,"content":"            },"},{"type":"INSERT","lineNumber":155,"content":"          );"},{"type":"DELETE","lineNumber":170,"oldContent":"          // If no phone verification needed, go to home screen"},{"type":"DELETE","lineNumber":171,"oldContent":""},{"type":"DELETE","lineNumber":172,"oldContent":"          if (mounted) {"},{"type":"DELETE","lineNumber":173,"oldContent":"            Navigator.pushReplacementNamed(context, AppConstants.homeRoute);"},{"type":"DELETE","lineNumber":174,"oldContent":"          }"},{"type":"DELETE","lineNumber":175,"oldContent":"      } else if (mounted) {"},{"type":"DELETE","lineNumber":176,"oldContent":"        // Show error if registration failed"},{"type":"INSERT","lineNumber":157,"content":"          // If no phone verification needed, go to home"},{"type":"INSERT","lineNumber":158,"content":"          Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":159,"content":"            context,"},{"type":"INSERT","lineNumber":160,"content":"            '/home',"},{"type":"INSERT","lineNumber":161,"content":"            (route) => false,"},{"type":"INSERT","lineNumber":162,"content":"          );"},{"type":"INSERT","lineNumber":163,"content":"        }"},{"type":"INSERT","lineNumber":164,"content":"      } else {"},{"type":"INSERT","lineNumber":165,"content":"        // Show error message from view model"},{"type":"INSERT","lineNumber":168,"content":"            content: Text(_viewModel.errorMessage ?? 'Registration failed'),"},{"type":"INSERT","lineNumber":169,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":170,"content":"          ),"},{"type":"INSERT","lineNumber":171,"content":"        );"},{"type":"INSERT","lineNumber":173,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":187,"oldContent":"        }"},{"type":"INSERT","lineNumber":182,"content":"      }"},{"type":"INSERT","lineNumber":183,"content":"    } finally {"},{"type":"INSERT","lineNumber":184,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":185,"content":"        setState(() {});"},{"type":"INSERT","lineNumber":186,"content":"      }"},{"type":"INSERT","lineNumber":187,"content":"    }"},{"type":"INSERT","lineNumber":188,"content":"  }"},{"type":"DELETE","lineNumber":191,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed. Please try again.'),"},{"type":"DELETE","lineNumber":193,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":195,"oldContent":"          ),"},{"type":"DELETE","lineNumber":196,"oldContent":"        );"},{"type":"INSERT","lineNumber":193,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":194,"content":"        title: const Text('Create Account'),"},{"type":"INSERT","lineNumber":195,"content":"        leading: IconButton("},{"type":"INSERT","lineNumber":196,"content":"          icon: const Icon(Icons.arrow_back),"},{"type":"INSERT","lineNumber":197,"content":"          onPressed: () => Navigator.pop(context),"},{"type":"INSERT","lineNumber":198,"content":"        ),"},{"type":"INSERT","lineNumber":199,"content":"      ),"},{"type":"DELETE","lineNumber":199,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":203,"oldContent":"      }"},{"type":"DELETE","lineNumber":205,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":207,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":209,"oldContent":"        setState(() {});"},{"type":"INSERT","lineNumber":208,"content":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":211,"oldContent":"      }"},{"type":"DELETE","lineNumber":213,"oldContent":"    }"},{"type":"DELETE","lineNumber":215,"oldContent":"  }"},{"type":"DELETE","lineNumber":221,"oldContent":"      appBar: AppBar("},{"type":"INSERT","lineNumber":217,"content":"                      ),"},{"type":"DELETE","lineNumber":223,"oldContent":"        title: const Text('Create Account'),"},{"type":"DELETE","lineNumber":225,"oldContent":"        leading: IconButton("},{"type":"DELETE","lineNumber":227,"oldContent":"          icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":228,"oldContent":"          onPressed: () => Navigator.pop(context),"},{"type":"DELETE","lineNumber":230,"oldContent":"        ),"},{"type":"DELETE","lineNumber":232,"oldContent":"      ),"},{"type":"DELETE","lineNumber":239,"oldContent":"                const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":233,"content":"                  ),"},{"type":"INSERT","lineNumber":235,"content":"                const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":236,"content":"                // Name field"},{"type":"DELETE","lineNumber":247,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":240,"content":"                    labelText: 'Full Name',"},{"type":"INSERT","lineNumber":241,"content":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"INSERT","lineNumber":242,"content":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":243,"content":"                  ),"},{"type":"INSERT","lineNumber":251,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":252,"content":"                // Email field"},{"type":"DELETE","lineNumber":257,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":260,"oldContent":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":261,"oldContent":"                // Name field"},{"type":"INSERT","lineNumber":257,"content":"                    labelText: 'Email',"},{"type":"INSERT","lineNumber":258,"content":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"INSERT","lineNumber":259,"content":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":260,"content":"                  ),"},{"type":"INSERT","lineNumber":261,"content":"                  validator: (value) {"},{"type":"INSERT","lineNumber":262,"content":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":263,"content":"                      return 'Please enter your email';"},{"type":"INSERT","lineNumber":264,"content":"                    }"},{"type":"INSERT","lineNumber":265,"content":"                    if (!value.contains('@')) {"},{"type":"INSERT","lineNumber":266,"content":"                      return 'Please enter a valid email';"},{"type":"INSERT","lineNumber":267,"content":"                    }"},{"type":"INSERT","lineNumber":268,"content":"                    return null;"},{"type":"INSERT","lineNumber":269,"content":"                  },"},{"type":"INSERT","lineNumber":270,"content":"                ),"},{"type":"INSERT","lineNumber":271,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":272,"content":"                // Phone field (optional)"},{"type":"INSERT","lineNumber":273,"content":"                TextFormField("},{"type":"INSERT","lineNumber":274,"content":"                  controller: _phoneController,"},{"type":"INSERT","lineNumber":275,"content":"                  keyboardType: TextInputType.phone,"},{"type":"INSERT","lineNumber":276,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":265,"oldContent":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":267,"oldContent":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"DELETE","lineNumber":269,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":276,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":278,"oldContent":"                // Email field"},{"type":"DELETE","lineNumber":281,"oldContent":"                    labelText: 'Email',"},{"type":"DELETE","lineNumber":283,"oldContent":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"DELETE","lineNumber":285,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":286,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":288,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":289,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":290,"oldContent":"                      return 'Please enter your email';"},{"type":"DELETE","lineNumber":291,"oldContent":"                    }"},{"type":"DELETE","lineNumber":292,"oldContent":"                    if (!value.contains('@')) {"},{"type":"DELETE","lineNumber":293,"oldContent":"                      return 'Please enter a valid email';"},{"type":"DELETE","lineNumber":294,"oldContent":"                    }"},{"type":"DELETE","lineNumber":295,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":296,"oldContent":"                  },"},{"type":"DELETE","lineNumber":297,"oldContent":"                ),"},{"type":"DELETE","lineNumber":299,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":300,"oldContent":"                // Phone field (optional)"},{"type":"DELETE","lineNumber":302,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":304,"oldContent":"                  controller: _phoneController,"},{"type":"DELETE","lineNumber":306,"oldContent":"                  keyboardType: TextInputType.phone,"},{"type":"DELETE","lineNumber":308,"oldContent":"                  decoration: const InputDecoration("},{"type":"INSERT","lineNumber":302,"content":"                        _obscurePassword"},{"type":"INSERT","lineNumber":303,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":314,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":312,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":333,"oldContent":"                        _obscurePassword"},{"type":"DELETE","lineNumber":334,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"INSERT","lineNumber":324,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":342,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":334,"content":"                        _obscureConfirmPassword"},{"type":"INSERT","lineNumber":335,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":349,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":354,"oldContent":"                        _obscureConfirmPassword"},{"type":"INSERT","lineNumber":344,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":356,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"INSERT","lineNumber":349,"content":"                    }"},{"type":"INSERT","lineNumber":350,"content":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":363,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":366,"oldContent":"                // Register button"},{"type":"DELETE","lineNumber":367,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":368,"oldContent":"                    }"},{"type":"DELETE","lineNumber":369,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":357,"content":"                // Register button"},{"type":"INSERT","lineNumber":366,"content":"                      ),"},{"type":"DELETE","lineNumber":383,"oldContent":"                      // Apple"},{"type":"DELETE","lineNumber":385,"oldContent":"                      Expanded("},{"type":"DELETE","lineNumber":387,"oldContent":"                        child: IconButton("},{"type":"DELETE","lineNumber":389,"oldContent":"                          onPressed: () {"},{"type":"DELETE","lineNumber":391,"oldContent":"                            // TODO: Implement Apple sign up"},{"type":"DELETE","lineNumber":392,"oldContent":"                          },"},{"type":"DELETE","lineNumber":393,"oldContent":"                          style: IconButton.styleFrom("},{"type":"DELETE","lineNumber":394,"oldContent":"                            backgroundColor: Colors.grey[100],"},{"type":"DELETE","lineNumber":395,"oldContent":"                            padding: const EdgeInsets.symmetric(vertical: 12, horizontal: 16),"},{"type":"DELETE","lineNumber":396,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":397,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":378,"content":"                            Icons.apple,"},{"type":"DELETE","lineNumber":406,"oldContent":"                            Icons.apple,"},{"type":"INSERT","lineNumber":388,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":389,"content":"                "},{"type":"INSERT","lineNumber":395,"content":"                    TextButton("},{"type":"INSERT","lineNumber":396,"content":"                      onPressed: () {"},{"type":"INSERT","lineNumber":397,"content":"                        Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":398,"content":"                          context,"},{"type":"INSERT","lineNumber":399,"content":"                          AppConstants.loginRoute,"},{"type":"INSERT","lineNumber":400,"content":"                        );"},{"type":"INSERT","lineNumber":401,"content":"                      },"},{"type":"INSERT","lineNumber":402,"content":"                      child: const Text('Login'),"},{"type":"DELETE","lineNumber":417,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":419,"oldContent":"                "},{"type":"DELETE","lineNumber":425,"oldContent":"      ),"},{"type":"DELETE","lineNumber":426,"oldContent":"                    TextButton("},{"type":"DELETE","lineNumber":427,"oldContent":"    );"},{"type":"DELETE","lineNumber":428,"oldContent":"  }"},{"type":"DELETE","lineNumber":429,"oldContent":"}"},{"type":"DELETE","lineNumber":430,"oldContent":""},{"type":"DELETE","lineNumber":431,"oldContent":"      },"},{"type":"DELETE","lineNumber":432,"oldContent":"        );"},{"type":"DELETE","lineNumber":436,"oldContent":"                ),"},{"type":"DELETE","lineNumber":437,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":438,"oldContent":"                ),"},{"type":"INSERT","lineNumber":414,"content":"  }"},{"type":"INSERT","lineNumber":415,"content":"}"},{"type":"INSERT","lineNumber":416,"content":""}]},{"timestamp":1754614819539,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:provider/provider.dart';","oldContent":""},{"type":"INSERT","lineNumber":5,"content":""},{"type":"INSERT","lineNumber":7,"content":"  const RegisterScreen({super.key});"},{"type":"INSERT","lineNumber":10,"content":"  State<RegisterScreen> createState() => _RegisterScreenState();"},{"type":"DELETE","lineNumber":12,"oldContent":"  final _nameController = TextEditingController();"},{"type":"DELETE","lineNumber":13,"oldContent":"  final _emailController = TextEditingController();"},{"type":"DELETE","lineNumber":14,"oldContent":"  final _phoneController = TextEditingController();"},{"type":"MODIFY","lineNumber":20,"content":"  bool _obscurePassword = true;","oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":23,"oldContent":"  @override"},{"type":"INSERT","lineNumber":25,"content":"  @override"},{"type":"DELETE","lineNumber":35,"oldContent":"  @override"},{"type":"INSERT","lineNumber":37,"content":"  @override"},{"type":"DELETE","lineNumber":46,"oldContent":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":48,"content":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":55,"oldContent":""},{"type":"DELETE","lineNumber":57,"oldContent":"  // Format phone number to E.164 standard"},{"type":"MODIFY","lineNumber":58,"content":"","oldContent":"  String _formatPhoneNumber(String phone) {"},{"type":"INSERT","lineNumber":59,"content":"  // Format phone number to E.164 standard"},{"type":"INSERT","lineNumber":60,"content":"  String _formatPhoneNumber(String phone) {"},{"type":"DELETE","lineNumber":62,"oldContent":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');"},{"type":"DELETE","lineNumber":63,"oldContent":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');"},{"type":"INSERT","lineNumber":62,"content":""},{"type":"INSERT","lineNumber":64,"content":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');"},{"type":"DELETE","lineNumber":71,"oldContent":"    // Add + prefix if missing"},{"type":"MODIFY","lineNumber":73,"content":"    // Add + prefix if missing","oldContent":"      digits = '+$digits';"},{"type":"INSERT","lineNumber":75,"content":"      digits = '+$digits';"},{"type":"DELETE","lineNumber":92,"oldContent":"      bool shouldVerifyPhone = phoneNumber != null && phoneNumber.isNotEmpty;"},{"type":"INSERT","lineNumber":93,"content":""},{"type":"INSERT","lineNumber":94,"content":"      bool shouldVerifyPhone = phoneNumber != null && phoneNumber.isNotEmpty;"},{"type":"DELETE","lineNumber":96,"oldContent":""},{"type":"MODIFY","lineNumber":105,"content":"          final shouldContinue = await showDialog<bool>(","oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"MODIFY","lineNumber":108,"content":"              title: const Text('Phone Verification Failed'),","oldContent":"              title: const Text('Phone Verification Failed'),"},{"type":"INSERT","lineNumber":109,"content":"              content: const Text("},{"type":"DELETE","lineNumber":111,"oldContent":"              content: const Text("},{"type":"DELETE","lineNumber":116,"oldContent":""},{"type":"DELETE","lineNumber":117,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":120,"oldContent":"          shouldVerifyPhone = false; // Skip phone verification"},{"type":"DELETE","lineNumber":123,"oldContent":"      }"},{"type":"DELETE","lineNumber":124,"oldContent":""},{"type":"DELETE","lineNumber":126,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":128,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":124,"content":""},{"type":"INSERT","lineNumber":125,"content":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":134,"oldContent":""},{"type":"INSERT","lineNumber":129,"content":"          shouldVerifyPhone = false; // Skip phone verification"},{"type":"INSERT","lineNumber":131,"content":"      }"},{"type":"INSERT","lineNumber":132,"content":""},{"type":"INSERT","lineNumber":133,"content":"      // Register the user"},{"type":"INSERT","lineNumber":134,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":138,"oldContent":"      if (success) {"},{"type":"DELETE","lineNumber":140,"oldContent":"        if (shouldVerifyPhone && _viewModel.verificationId != null && _viewModel.verificationId!.isNotEmpty) {"},{"type":"DELETE","lineNumber":143,"oldContent":"          Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":140,"content":""},{"type":"INSERT","lineNumber":142,"content":""},{"type":"INSERT","lineNumber":143,"content":"      if (success) {"},{"type":"INSERT","lineNumber":144,"content":"        if (shouldVerifyPhone && _viewModel.verificationId != null && _viewModel.verificationId!.isNotEmpty) {"},{"type":"INSERT","lineNumber":145,"content":"          // Navigate to OTP screen with verification ID"},{"type":"INSERT","lineNumber":146,"content":"          Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":147,"oldContent":""},{"type":"DELETE","lineNumber":151,"oldContent":"          // Navigate to OTP screen with verification ID"},{"type":"INSERT","lineNumber":156,"content":"        } else {"},{"type":"INSERT","lineNumber":166,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":167,"content":"          SnackBar("},{"type":"DELETE","lineNumber":167,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":170,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":171,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":172,"oldContent":"          SnackBar("},{"type":"INSERT","lineNumber":173,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":176,"oldContent":"      }"},{"type":"DELETE","lineNumber":178,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":180,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":182,"oldContent":"        setState(() {});"},{"type":"DELETE","lineNumber":184,"oldContent":"      }"},{"type":"INSERT","lineNumber":181,"content":"        );"},{"type":"INSERT","lineNumber":182,"content":"      }"},{"type":"INSERT","lineNumber":183,"content":"    } finally {"},{"type":"INSERT","lineNumber":184,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":185,"content":"        setState(() {});"},{"type":"INSERT","lineNumber":186,"content":"      }"},{"type":"DELETE","lineNumber":188,"oldContent":"        );"},{"type":"INSERT","lineNumber":192,"content":"    return Scaffold("},{"type":"DELETE","lineNumber":194,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":198,"oldContent":"      body: SingleChildScrollView("},{"type":"MODIFY","lineNumber":200,"content":"      body: SingleChildScrollView(","oldContent":"        child: Padding("},{"type":"INSERT","lineNumber":201,"content":"        child: Padding("},{"type":"MODIFY","lineNumber":208,"content":"                const SizedBox(height: 40),","oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":213,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":217,"content":"                      ),"},{"type":"DELETE","lineNumber":223,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":226,"oldContent":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":228,"oldContent":"                // Name field"},{"type":"DELETE","lineNumber":232,"oldContent":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":234,"oldContent":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"DELETE","lineNumber":236,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":238,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":240,"oldContent":"                ),"},{"type":"DELETE","lineNumber":241,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":234,"content":"                ),"},{"type":"INSERT","lineNumber":235,"content":"                const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":236,"content":"                // Name field"},{"type":"INSERT","lineNumber":237,"content":"                TextFormField("},{"type":"INSERT","lineNumber":238,"content":"                  controller: _nameController,"},{"type":"INSERT","lineNumber":240,"content":"                    labelText: 'Full Name',"},{"type":"INSERT","lineNumber":241,"content":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"INSERT","lineNumber":242,"content":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":243,"content":"                  ),"},{"type":"INSERT","lineNumber":244,"content":"                  validator: (value) {"},{"type":"INSERT","lineNumber":245,"content":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":246,"content":"                      return 'Please enter your name';"},{"type":"INSERT","lineNumber":247,"content":"                    }"},{"type":"DELETE","lineNumber":246,"oldContent":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":251,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":249,"oldContent":"                "},{"type":"DELETE","lineNumber":250,"oldContent":"                const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":251,"oldContent":"                "},{"type":"DELETE","lineNumber":252,"oldContent":"                // Phone field"},{"type":"MODIFY","lineNumber":253,"content":"                TextFormField(","oldContent":"                    labelText: 'Phone Number',"},{"type":"INSERT","lineNumber":254,"content":"                  controller: _emailController,"},{"type":"INSERT","lineNumber":255,"content":"                  keyboardType: TextInputType.emailAddress,"},{"type":"INSERT","lineNumber":256,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":256,"oldContent":"                    prefixIcon: const Icon(Icons.phone_outlined),"},{"type":"DELETE","lineNumber":258,"oldContent":"                    border: OutlineInputBorder("},{"type":"DELETE","lineNumber":262,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":264,"oldContent":"                    labelText: 'Phone Number (Optional)',"},{"type":"DELETE","lineNumber":266,"oldContent":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"DELETE","lineNumber":269,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":272,"oldContent":"                    hintText: '+1 (123) 456-7890',"},{"type":"DELETE","lineNumber":275,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":277,"oldContent":"                  onChanged: (value) {"},{"type":"DELETE","lineNumber":279,"oldContent":"                    // Format phone number as user types"},{"type":"DELETE","lineNumber":281,"oldContent":"                    if (value.length == 1 && value != '+') {"},{"type":"DELETE","lineNumber":283,"oldContent":"                      _phoneController.text = '+$value';"},{"type":"DELETE","lineNumber":285,"oldContent":"                      _phoneController.selection = TextSelection.fromPosition("},{"type":"INSERT","lineNumber":277,"content":"                    labelText: 'Phone Number (Optional)',"},{"type":"INSERT","lineNumber":278,"content":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"INSERT","lineNumber":279,"content":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":280,"content":"                    hintText: '+1 (123) 456-7890',"},{"type":"INSERT","lineNumber":281,"content":"                  ),"},{"type":"INSERT","lineNumber":282,"content":"                  onChanged: (value) {"},{"type":"INSERT","lineNumber":283,"content":"                    // Format phone number as user types"},{"type":"INSERT","lineNumber":284,"content":"                    if (value.length == 1 && value != '+') {"},{"type":"INSERT","lineNumber":285,"content":"                      _phoneController.text = '+$value';"},{"type":"INSERT","lineNumber":286,"content":"                      _phoneController.selection = TextSelection.fromPosition("},{"type":"INSERT","lineNumber":289,"content":"                    }"},{"type":"INSERT","lineNumber":290,"content":"                  },"},{"type":"DELETE","lineNumber":290,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":291,"oldContent":"                "},{"type":"DELETE","lineNumber":295,"oldContent":"                        _obscurePassword"},{"type":"DELETE","lineNumber":296,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":303,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":302,"content":"                        _obscurePassword"},{"type":"INSERT","lineNumber":303,"content":"                            ? Icons.visibility_outlined"},{"type":"INSERT","lineNumber":312,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":315,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":325,"oldContent":"                        _obscureConfirmPassword"},{"type":"DELETE","lineNumber":326,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"INSERT","lineNumber":324,"content":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":335,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":334,"content":"                        _obscureConfirmPassword"},{"type":"INSERT","lineNumber":335,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":341,"oldContent":"                    }"},{"type":"DELETE","lineNumber":342,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":344,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":348,"oldContent":"                // Register button"},{"type":"INSERT","lineNumber":349,"content":"                    }"},{"type":"INSERT","lineNumber":350,"content":"                    if (value != _passwordController.text) {"},{"type":"MODIFY","lineNumber":357,"content":"                // Register button","oldContent":"                      ),"},{"type":"MODIFY","lineNumber":366,"content":"                      ),","oldContent":"                            Icons.apple,"},{"type":"DELETE","lineNumber":374,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":376,"oldContent":"                "},{"type":"INSERT","lineNumber":375,"content":"                            ),"},{"type":"INSERT","lineNumber":376,"content":"                          )"},{"type":"INSERT","lineNumber":377,"content":"                        : const Text('Create Account'),"},{"type":"INSERT","lineNumber":378,"content":"                  ),"},{"type":"INSERT","lineNumber":379,"content":"                ),"},{"type":"INSERT","lineNumber":380,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":381,"content":"                "},{"type":"INSERT","lineNumber":382,"content":"                // Login link"},{"type":"INSERT","lineNumber":383,"content":"                Row("},{"type":"INSERT","lineNumber":384,"content":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":385,"content":"                  children: ["},{"type":"INSERT","lineNumber":386,"content":"                    const Text(\"Already have an account?\"),"},{"type":"DELETE","lineNumber":382,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":384,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":386,"oldContent":"                          icon: const Icon("},{"type":"DELETE","lineNumber":388,"oldContent":"                            size: 24,"},{"type":"DELETE","lineNumber":390,"oldContent":"                            color: Colors.black,"},{"type":"DELETE","lineNumber":391,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":392,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":393,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":394,"oldContent":"                    ],"},{"type":"MODIFY","lineNumber":395,"content":"                    ),","oldContent":"                  ),"},{"type":"INSERT","lineNumber":396,"content":"                  ],"},{"type":"DELETE","lineNumber":397,"oldContent":"                "},{"type":"DELETE","lineNumber":398,"oldContent":"                // Login link"},{"type":"DELETE","lineNumber":399,"oldContent":"                Row("},{"type":"DELETE","lineNumber":400,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":398,"content":"              ],"},{"type":"INSERT","lineNumber":399,"content":"            ),"},{"type":"INSERT","lineNumber":400,"content":"          ),"},{"type":"INSERT","lineNumber":401,"content":"        ),"},{"type":"INSERT","lineNumber":402,"content":"          ),"},{"type":"INSERT","lineNumber":403,"content":"        );"},{"type":"INSERT","lineNumber":404,"content":"      },"},{"type":"INSERT","lineNumber":405,"content":"    );"},{"type":"DELETE","lineNumber":402,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":404,"oldContent":"                    const Text(\"Already have an account?\"),"},{"type":"DELETE","lineNumber":406,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":407,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":408,"oldContent":"                ),"},{"type":"DELETE","lineNumber":409,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":410,"oldContent":"                ),"},{"type":"DELETE","lineNumber":411,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":412,"oldContent":"                    ],"}]},{"timestamp":1754614834675,"changes":[{"type":"INSERT","lineNumber":4,"content":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":""},{"type":"MODIFY","lineNumber":8,"content":"","oldContent":""},{"type":"INSERT","lineNumber":9,"content":"  @override"},{"type":"DELETE","lineNumber":12,"oldContent":"  State<RegisterScreen> createState() => _RegisterScreenState();"},{"type":"MODIFY","lineNumber":25,"content":"  @override","oldContent":"  @override"},{"type":"MODIFY","lineNumber":37,"content":"  @override","oldContent":"  @override"},{"type":"MODIFY","lineNumber":48,"content":"  void _onViewModelChange() {","oldContent":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":56,"content":"    }"},{"type":"INSERT","lineNumber":57,"content":"  }"},{"type":"DELETE","lineNumber":58,"oldContent":"    }"},{"type":"DELETE","lineNumber":60,"oldContent":"  }"},{"type":"MODIFY","lineNumber":64,"content":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');","oldContent":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');"},{"type":"DELETE","lineNumber":72,"oldContent":"    // Add + prefix if missing"},{"type":"DELETE","lineNumber":74,"oldContent":"      digits = '+$digits';"},{"type":"INSERT","lineNumber":73,"content":"    // Add + prefix if missing"},{"type":"INSERT","lineNumber":75,"content":"      digits = '+$digits';"},{"type":"MODIFY","lineNumber":93,"content":"","oldContent":""},{"type":"INSERT","lineNumber":104,"content":"          // If OTP sending fails, ask user if they want to proceed without phone verification"},{"type":"DELETE","lineNumber":105,"oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"INSERT","lineNumber":107,"content":"            builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":108,"oldContent":"              title: const Text('Phone Verification Failed'),"},{"type":"DELETE","lineNumber":120,"oldContent":""},{"type":"DELETE","lineNumber":121,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":124,"oldContent":"          shouldVerifyPhone = false; // Skip phone verification"},{"type":"DELETE","lineNumber":127,"oldContent":"      }"},{"type":"DELETE","lineNumber":128,"oldContent":"            setState(() => _isLoading = false);"},{"type":"INSERT","lineNumber":125,"content":"          if (!shouldContinue) {"},{"type":"INSERT","lineNumber":126,"content":"            setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":131,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":133,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":129,"content":"          shouldVerifyPhone = false; // Skip phone verification"},{"type":"INSERT","lineNumber":131,"content":"      }"},{"type":"INSERT","lineNumber":132,"content":""},{"type":"INSERT","lineNumber":133,"content":"      // Register the user"},{"type":"INSERT","lineNumber":134,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":138,"oldContent":""},{"type":"MODIFY","lineNumber":140,"content":"","oldContent":""},{"type":"INSERT","lineNumber":141,"content":"      if (!mounted) return;"},{"type":"INSERT","lineNumber":142,"content":""},{"type":"DELETE","lineNumber":144,"oldContent":"      if (!mounted) return;"},{"type":"MODIFY","lineNumber":147,"content":"            context,","oldContent":"            context,"},{"type":"DELETE","lineNumber":166,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed'),"},{"type":"MODIFY","lineNumber":168,"content":"            content: Text(_viewModel.errorMessage ?? 'Registration failed'),","oldContent":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":169,"content":"            backgroundColor: Colors.red,"},{"type":"MODIFY","lineNumber":173,"content":"    } catch (e) {","oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":178,"oldContent":"        );"},{"type":"INSERT","lineNumber":179,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":180,"content":"          ),"},{"type":"INSERT","lineNumber":181,"content":"        );"},{"type":"DELETE","lineNumber":182,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":185,"oldContent":"          ),"},{"type":"INSERT","lineNumber":199,"content":"      ),"},{"type":"DELETE","lineNumber":201,"oldContent":"      ),"},{"type":"INSERT","lineNumber":207,"content":"              children: ["},{"type":"DELETE","lineNumber":208,"oldContent":"                const SizedBox(height: 40),"},{"type":"MODIFY","lineNumber":217,"content":"                      ),","oldContent":"                      ),"},{"type":"INSERT","lineNumber":230,"content":"                            ),"},{"type":"INSERT","lineNumber":231,"content":"                      ),"},{"type":"INSERT","lineNumber":232,"content":"                    ],"},{"type":"INSERT","lineNumber":233,"content":"                  ),"},{"type":"DELETE","lineNumber":232,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":235,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":237,"oldContent":"                    ],"},{"type":"INSERT","lineNumber":239,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":241,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":243,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":246,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":247,"oldContent":"                      return 'Please enter your email';"},{"type":"DELETE","lineNumber":250,"oldContent":"                    }"},{"type":"DELETE","lineNumber":251,"oldContent":"                // Email field"},{"type":"INSERT","lineNumber":248,"content":"                    return null;"},{"type":"INSERT","lineNumber":249,"content":"                  },"},{"type":"INSERT","lineNumber":250,"content":"                ),"},{"type":"INSERT","lineNumber":252,"content":"                // Email field"},{"type":"DELETE","lineNumber":255,"oldContent":"                    labelText: 'Email',"},{"type":"MODIFY","lineNumber":257,"content":"                    labelText: 'Email',","oldContent":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"INSERT","lineNumber":258,"content":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"INSERT","lineNumber":272,"content":"                // Phone field (optional)"},{"type":"INSERT","lineNumber":273,"content":"                TextFormField("},{"type":"INSERT","lineNumber":274,"content":"                  controller: _phoneController,"},{"type":"INSERT","lineNumber":275,"content":"                  keyboardType: TextInputType.phone,"},{"type":"INSERT","lineNumber":276,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":274,"oldContent":"                // Phone field (optional)"},{"type":"DELETE","lineNumber":277,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":280,"oldContent":"                  controller: _phoneController,"},{"type":"DELETE","lineNumber":283,"oldContent":"                  keyboardType: TextInputType.phone,"},{"type":"DELETE","lineNumber":286,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":290,"oldContent":"                    // Simple phone number validation (can be enhanced)"},{"type":"INSERT","lineNumber":291,"content":"                ),"},{"type":"DELETE","lineNumber":300,"oldContent":"                        _obscurePassword"},{"type":"MODIFY","lineNumber":302,"content":"                        _obscurePassword","oldContent":"                            ? Icons.visibility_outlined"},{"type":"INSERT","lineNumber":303,"content":"                            ? Icons.visibility_outlined"},{"type":"MODIFY","lineNumber":312,"content":"                    border: const OutlineInputBorder(),","oldContent":"                    border: const OutlineInputBorder(),"},{"type":"MODIFY","lineNumber":324,"content":"                const SizedBox(height: 16),","oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":332,"oldContent":"                        _obscureConfirmPassword"},{"type":"MODIFY","lineNumber":334,"content":"                        _obscureConfirmPassword","oldContent":"                            ? Icons.visibility_outlined"},{"type":"INSERT","lineNumber":335,"content":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":341,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":344,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":346,"oldContent":"                    }"},{"type":"DELETE","lineNumber":348,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":349,"content":"                    }"},{"type":"INSERT","lineNumber":350,"content":"                    if (value != _passwordController.text) {"},{"type":"MODIFY","lineNumber":357,"content":"                // Register button","oldContent":"                // Register button"},{"type":"MODIFY","lineNumber":366,"content":"                      ),","oldContent":"                      ),"},{"type":"DELETE","lineNumber":373,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":374,"content":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"INSERT","lineNumber":375,"content":"                            ),"},{"type":"DELETE","lineNumber":377,"oldContent":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"DELETE","lineNumber":379,"oldContent":"                    TextButton("},{"type":"DELETE","lineNumber":381,"oldContent":"                      onPressed: () {"},{"type":"DELETE","lineNumber":383,"oldContent":"                        Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":385,"oldContent":"                          context,"},{"type":"DELETE","lineNumber":388,"oldContent":"                          AppConstants.loginRoute,"},{"type":"DELETE","lineNumber":391,"oldContent":"                        );"},{"type":"INSERT","lineNumber":387,"content":"                    TextButton("},{"type":"INSERT","lineNumber":388,"content":"                      onPressed: () {"},{"type":"INSERT","lineNumber":389,"content":"                        Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":390,"content":"                          context,"},{"type":"INSERT","lineNumber":391,"content":"                          AppConstants.loginRoute,"},{"type":"INSERT","lineNumber":392,"content":"                        );"},{"type":"INSERT","lineNumber":402,"content":"      ),"},{"type":"INSERT","lineNumber":403,"content":"    );"},{"type":"DELETE","lineNumber":403,"oldContent":"          ),"},{"type":"DELETE","lineNumber":404,"oldContent":"        );"},{"type":"DELETE","lineNumber":406,"oldContent":"      },"},{"type":"DELETE","lineNumber":407,"oldContent":"    );"}]},{"timestamp":1754615450162,"changes":[{"type":"INSERT","lineNumber":7,"content":"  const RegisterScreen({super.key});"},{"type":"DELETE","lineNumber":8,"oldContent":""},{"type":"INSERT","lineNumber":24,"content":""},{"type":"DELETE","lineNumber":25,"oldContent":"  @override"},{"type":"INSERT","lineNumber":36,"content":""},{"type":"DELETE","lineNumber":37,"oldContent":"  @override"},{"type":"INSERT","lineNumber":47,"content":""},{"type":"DELETE","lineNumber":48,"oldContent":"  void _onViewModelChange() {"},{"type":"MODIFY","lineNumber":58,"content":"","oldContent":""},{"type":"INSERT","lineNumber":63,"content":"    // Remove all non-digit characters"},{"type":"DELETE","lineNumber":64,"oldContent":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');"},{"type":"DELETE","lineNumber":72,"oldContent":"    // Add + prefix if missing"},{"type":"DELETE","lineNumber":74,"oldContent":"      digits = '+$digits';"},{"type":"INSERT","lineNumber":73,"content":"    // Add + prefix if missing"},{"type":"INSERT","lineNumber":75,"content":"      digits = '+$digits';"},{"type":"INSERT","lineNumber":92,"content":"          : null;"},{"type":"DELETE","lineNumber":93,"oldContent":""},{"type":"DELETE","lineNumber":95,"oldContent":"      bool otpSent = false;"},{"type":"DELETE","lineNumber":97,"oldContent":"      // Try to send OTP if phone number is provided"},{"type":"INSERT","lineNumber":96,"content":"      // If phone number is provided, send OTP first"},{"type":"MODIFY","lineNumber":98,"content":"        final otpSent = await _viewModel.sendOtp(phoneNumber);","oldContent":"        otpSent = await _viewModel.sendOtp(phoneNumber);"},{"type":"DELETE","lineNumber":122,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":124,"oldContent":"            setState(() => _isLoading = false);"},{"type":"INSERT","lineNumber":123,"content":""},{"type":"INSERT","lineNumber":124,"content":"          if (!shouldContinue) {"},{"type":"INSERT","lineNumber":125,"content":"            setState(() => _isLoading = false);"},{"type":"INSERT","lineNumber":126,"content":"            return;"},{"type":"INSERT","lineNumber":127,"content":"          }"},{"type":"INSERT","lineNumber":129,"content":"        } else {"},{"type":"INSERT","lineNumber":130,"content":"          // OTP sent successfully, navigate to OTP screen"},{"type":"INSERT","lineNumber":131,"content":"          if (!mounted) return;"},{"type":"INSERT","lineNumber":132,"content":"          "},{"type":"INSERT","lineNumber":133,"content":"          // First register the user"},{"type":"INSERT","lineNumber":134,"content":"          final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":135,"content":"            email: email,"},{"type":"INSERT","lineNumber":136,"content":"            password: password,"},{"type":"INSERT","lineNumber":137,"content":"            name: name,"},{"type":"INSERT","lineNumber":138,"content":"            phone: phoneNumber,"},{"type":"INSERT","lineNumber":139,"content":"          );"},{"type":"INSERT","lineNumber":141,"content":"          if (!mounted) return;"},{"type":"INSERT","lineNumber":142,"content":""},{"type":"INSERT","lineNumber":143,"content":"          if (success) {"},{"type":"INSERT","lineNumber":144,"content":"            // Navigate to OTP verification screen"},{"type":"INSERT","lineNumber":145,"content":"            if (mounted) {"},{"type":"INSERT","lineNumber":146,"content":"              Navigator.pushReplacement("},{"type":"INSERT","lineNumber":147,"content":"                context,"},{"type":"INSERT","lineNumber":148,"content":"                MaterialPageRoute("},{"type":"INSERT","lineNumber":149,"content":"                  builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":150,"content":"                    verificationId: _viewModel.verificationId!,"},{"type":"INSERT","lineNumber":151,"content":"                    phoneNumber: phoneNumber!,"},{"type":"INSERT","lineNumber":152,"content":"                    email: email,"},{"type":"INSERT","lineNumber":153,"content":"                    isRegistration: true,"},{"type":"INSERT","lineNumber":154,"content":"                  ),"},{"type":"INSERT","lineNumber":155,"content":"                ),"},{"type":"INSERT","lineNumber":156,"content":"              );"},{"type":"INSERT","lineNumber":157,"content":"            }"},{"type":"INSERT","lineNumber":159,"content":"          } else {"},{"type":"INSERT","lineNumber":160,"content":"            // Show error message from view model"},{"type":"INSERT","lineNumber":161,"content":"            if (mounted) {"},{"type":"INSERT","lineNumber":162,"content":"              ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":163,"content":"                SnackBar("},{"type":"INSERT","lineNumber":164,"content":"                  content: Text(_viewModel.errorMessage ?? 'Registration failed'),"},{"type":"INSERT","lineNumber":165,"content":"                  backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":166,"content":"                ),"},{"type":"INSERT","lineNumber":167,"content":"              );"},{"type":"INSERT","lineNumber":168,"content":"            }"},{"type":"INSERT","lineNumber":169,"content":"            return;"},{"type":"INSERT","lineNumber":170,"content":"          }"},{"type":"INSERT","lineNumber":171,"content":"        }"},{"type":"DELETE","lineNumber":131,"oldContent":"          }"},{"type":"DELETE","lineNumber":132,"oldContent":"      // Register the user"},{"type":"INSERT","lineNumber":174,"content":"      // If we reach here, either no phone number was provided or user chose to skip verification"},{"type":"DELETE","lineNumber":134,"oldContent":"        }"},{"type":"INSERT","lineNumber":180,"content":"      );"},{"type":"DELETE","lineNumber":141,"oldContent":"      );"},{"type":"DELETE","lineNumber":144,"oldContent":"        if (shouldVerifyPhone && _viewModel.verificationId != null && _viewModel.verificationId!.isNotEmpty) {"},{"type":"DELETE","lineNumber":145,"oldContent":"          // Navigate to OTP screen with verification ID"},{"type":"DELETE","lineNumber":146,"oldContent":"            context,"},{"type":"DELETE","lineNumber":147,"oldContent":"            context,"},{"type":"DELETE","lineNumber":148,"oldContent":"            '/verify-otp',"},{"type":"DELETE","lineNumber":149,"oldContent":"            arguments: {"},{"type":"DELETE","lineNumber":150,"oldContent":"              'verificationId': _viewModel.verificationId!,"},{"type":"DELETE","lineNumber":151,"oldContent":"              'phoneNumber': phoneNumber!,"},{"type":"DELETE","lineNumber":152,"oldContent":"              'email': email,"},{"type":"DELETE","lineNumber":153,"oldContent":"              'isRegistration': true,"},{"type":"DELETE","lineNumber":154,"oldContent":"            },"},{"type":"DELETE","lineNumber":155,"oldContent":"          );"},{"type":"DELETE","lineNumber":156,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":157,"oldContent":"          // If no phone verification needed, go to home"},{"type":"DELETE","lineNumber":158,"oldContent":"          Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":159,"oldContent":"            context,"},{"type":"DELETE","lineNumber":160,"oldContent":"            '/home',"},{"type":"DELETE","lineNumber":161,"oldContent":"            (route) => false,"},{"type":"DELETE","lineNumber":162,"oldContent":"          );"},{"type":"DELETE","lineNumber":163,"oldContent":"        }"},{"type":"INSERT","lineNumber":185,"content":"        // Navigate to home screen"},{"type":"INSERT","lineNumber":186,"content":"        Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":187,"content":"          context,"},{"type":"INSERT","lineNumber":188,"content":"          '/home',"},{"type":"INSERT","lineNumber":189,"content":"          (route) => false,"},{"type":"INSERT","lineNumber":190,"content":"        );"},{"type":"INSERT","lineNumber":194,"content":"          SnackBar("},{"type":"DELETE","lineNumber":169,"oldContent":"          SnackBar("},{"type":"INSERT","lineNumber":199,"content":"      }"},{"type":"DELETE","lineNumber":173,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":178,"oldContent":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":206,"content":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":181,"oldContent":"      }"},{"type":"INSERT","lineNumber":209,"content":"      }"},{"type":"INSERT","lineNumber":243,"content":"                        width: 100,"},{"type":"DELETE","lineNumber":217,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":231,"oldContent":"                ),"},{"type":"DELETE","lineNumber":233,"oldContent":"                const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":261,"content":"                ),"},{"type":"INSERT","lineNumber":262,"content":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":239,"oldContent":"                    labelText: 'Full Name',"},{"type":"INSERT","lineNumber":267,"content":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":246,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":248,"oldContent":"                  },"},{"type":"INSERT","lineNumber":275,"content":"                    return null;"},{"type":"INSERT","lineNumber":276,"content":"                  },"},{"type":"DELETE","lineNumber":251,"oldContent":"                // Email field"},{"type":"INSERT","lineNumber":279,"content":"                // Email field"},{"type":"INSERT","lineNumber":283,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":258,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":273,"oldContent":"                    labelText: 'Phone Number (Optional)',"},{"type":"DELETE","lineNumber":275,"oldContent":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"DELETE","lineNumber":278,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":304,"content":"                    labelText: 'Phone Number (Optional)',"},{"type":"INSERT","lineNumber":305,"content":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"INSERT","lineNumber":306,"content":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":290,"oldContent":"                ),"},{"type":"INSERT","lineNumber":318,"content":"                ),"},{"type":"INSERT","lineNumber":328,"content":"                      icon: Icon("},{"type":"DELETE","lineNumber":303,"oldContent":"                      icon: Icon("},{"type":"INSERT","lineNumber":338,"content":"                    ),"},{"type":"DELETE","lineNumber":312,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":350,"content":"                ),"},{"type":"DELETE","lineNumber":324,"oldContent":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":360,"content":"                      icon: Icon("},{"type":"DELETE","lineNumber":335,"oldContent":"                      icon: Icon("},{"type":"DELETE","lineNumber":343,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":371,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":347,"oldContent":"                    }"},{"type":"DELETE","lineNumber":349,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":376,"content":"                    }"},{"type":"INSERT","lineNumber":377,"content":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":383,"content":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":357,"oldContent":"                // Register button"},{"type":"INSERT","lineNumber":392,"content":"                        borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":366,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":373,"oldContent":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"INSERT","lineNumber":401,"content":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"DELETE","lineNumber":383,"oldContent":"                    TextButton("},{"type":"INSERT","lineNumber":411,"content":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":412,"content":"                  children: ["},{"type":"INSERT","lineNumber":413,"content":"                    const Text(\"Already have an account?\"),"},{"type":"INSERT","lineNumber":414,"content":"                    TextButton("},{"type":"DELETE","lineNumber":387,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":389,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":392,"oldContent":"                    const Text(\"Already have an account?\"),"},{"type":"DELETE","lineNumber":403,"oldContent":"  }"},{"type":"INSERT","lineNumber":431,"content":"  }"}]},{"timestamp":1754615465578,"changes":[{"type":"INSERT","lineNumber":5,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/otp_verification_screen.dart';"},{"type":"INSERT","lineNumber":58,"content":"  }"},{"type":"DELETE","lineNumber":58,"oldContent":""},{"type":"DELETE","lineNumber":72,"oldContent":"    // Add + prefix if missing"},{"type":"MODIFY","lineNumber":74,"content":"    // Add + prefix if missing","oldContent":"      digits = '+$digits';"},{"type":"INSERT","lineNumber":76,"content":"      digits = '+$digits';"},{"type":"DELETE","lineNumber":95,"oldContent":"      // If phone number is provided, send OTP first"},{"type":"INSERT","lineNumber":97,"content":"      // If phone number is provided, send OTP first"},{"type":"INSERT","lineNumber":98,"content":"      if (shouldVerifyPhone) {"},{"type":"DELETE","lineNumber":98,"oldContent":"        otpSent = await _viewModel.sendOtp(phoneNumber);"},{"type":"DELETE","lineNumber":121,"oldContent":""},{"type":"INSERT","lineNumber":123,"content":"          ) ?? false;"},{"type":"INSERT","lineNumber":124,"content":""},{"type":"DELETE","lineNumber":125,"oldContent":"          ) ?? false;"},{"type":"DELETE","lineNumber":127,"oldContent":"          shouldVerifyPhone = false; // Skip phone verification"},{"type":"DELETE","lineNumber":129,"oldContent":""},{"type":"DELETE","lineNumber":130,"oldContent":"            return;"},{"type":"INSERT","lineNumber":129,"content":"          shouldVerifyPhone = false; // Skip phone verification"},{"type":"DELETE","lineNumber":132,"oldContent":"      }"},{"type":"DELETE","lineNumber":134,"oldContent":""},{"type":"DELETE","lineNumber":138,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":141,"oldContent":"        email: email,"},{"type":"DELETE","lineNumber":143,"oldContent":"        password: password,"},{"type":"DELETE","lineNumber":145,"oldContent":"        name: name,"},{"type":"DELETE","lineNumber":147,"oldContent":"        phone: phoneNumber,"},{"type":"DELETE","lineNumber":150,"oldContent":"      if (!mounted) return;"},{"type":"DELETE","lineNumber":153,"oldContent":""},{"type":"DELETE","lineNumber":155,"oldContent":"      if (success) {"},{"type":"DELETE","lineNumber":163,"oldContent":"                    phoneNumber: phoneNumber!,"},{"type":"INSERT","lineNumber":152,"content":"                    phoneNumber: phoneNumber,"},{"type":"INSERT","lineNumber":159,"content":"            return;"},{"type":"DELETE","lineNumber":176,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":178,"oldContent":"        // Show error message from view model"},{"type":"DELETE","lineNumber":180,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":182,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed'),"},{"type":"DELETE","lineNumber":184,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":187,"oldContent":"          ),"},{"type":"INSERT","lineNumber":173,"content":"      }"},{"type":"INSERT","lineNumber":174,"content":""},{"type":"INSERT","lineNumber":175,"content":"      // If we reach here, either no phone number was provided or user chose to skip verification"},{"type":"INSERT","lineNumber":176,"content":"      final success = await _viewModel.registerWithEmail("},{"type":"INSERT","lineNumber":177,"content":"        email: email,"},{"type":"INSERT","lineNumber":178,"content":"        password: password,"},{"type":"INSERT","lineNumber":179,"content":"        name: name,"},{"type":"INSERT","lineNumber":180,"content":"        phone: phoneNumber,"},{"type":"INSERT","lineNumber":181,"content":"      );"},{"type":"INSERT","lineNumber":182,"content":""},{"type":"INSERT","lineNumber":183,"content":"      if (!mounted) return;"},{"type":"INSERT","lineNumber":184,"content":""},{"type":"INSERT","lineNumber":185,"content":"      if (success) {"},{"type":"INSERT","lineNumber":186,"content":"        // Navigate to home screen"},{"type":"INSERT","lineNumber":187,"content":"        Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":188,"content":"          context,"},{"type":"INSERT","lineNumber":189,"content":"          '/home',"},{"type":"INSERT","lineNumber":190,"content":"          (route) => false,"},{"type":"INSERT","lineNumber":192,"content":"      } else {"},{"type":"INSERT","lineNumber":193,"content":"        // Show error message from view model"},{"type":"INSERT","lineNumber":194,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":195,"content":"          SnackBar("},{"type":"INSERT","lineNumber":196,"content":"            content: Text(_viewModel.errorMessage ?? 'Registration failed'),"},{"type":"INSERT","lineNumber":197,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":198,"content":"          ),"},{"type":"INSERT","lineNumber":199,"content":"        );"},{"type":"INSERT","lineNumber":200,"content":"      }"},{"type":"DELETE","lineNumber":191,"oldContent":"      // If we reach here, either no phone number was provided or user chose to skip verification"},{"type":"DELETE","lineNumber":197,"oldContent":"      );"},{"type":"INSERT","lineNumber":207,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":210,"content":"      }"},{"type":"DELETE","lineNumber":202,"oldContent":"        // Navigate to home screen"},{"type":"DELETE","lineNumber":204,"oldContent":"        Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":206,"oldContent":"          context,"},{"type":"DELETE","lineNumber":208,"oldContent":"          '/home',"},{"type":"DELETE","lineNumber":210,"oldContent":"          (route) => false,"},{"type":"DELETE","lineNumber":212,"oldContent":"        );"},{"type":"DELETE","lineNumber":217,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":223,"oldContent":"      }"},{"type":"DELETE","lineNumber":231,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":235,"oldContent":"      }"},{"type":"INSERT","lineNumber":244,"content":"                        width: 100,"},{"type":"INSERT","lineNumber":262,"content":"                ),"},{"type":"INSERT","lineNumber":263,"content":"                const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":268,"content":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":266,"oldContent":"                        width: 100,"},{"type":"DELETE","lineNumber":269,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":273,"content":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":276,"content":"                    return null;"},{"type":"INSERT","lineNumber":277,"content":"                  },"},{"type":"INSERT","lineNumber":280,"content":"                // Email field"},{"type":"INSERT","lineNumber":284,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":281,"oldContent":"                ),"},{"type":"DELETE","lineNumber":283,"oldContent":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":289,"oldContent":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":297,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":298,"oldContent":"                  },"},{"type":"DELETE","lineNumber":301,"oldContent":"                // Email field"},{"type":"INSERT","lineNumber":305,"content":"                    labelText: 'Phone Number (Optional)',"},{"type":"INSERT","lineNumber":306,"content":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"INSERT","lineNumber":307,"content":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":306,"oldContent":"                  decoration: const InputDecoration("},{"type":"INSERT","lineNumber":319,"content":"                ),"},{"type":"INSERT","lineNumber":329,"content":"                      icon: Icon("},{"type":"DELETE","lineNumber":326,"oldContent":"                    labelText: 'Phone Number (Optional)',"},{"type":"DELETE","lineNumber":328,"oldContent":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"DELETE","lineNumber":330,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":339,"content":"                    ),"},{"type":"DELETE","lineNumber":342,"oldContent":"                ),"},{"type":"INSERT","lineNumber":351,"content":"                ),"},{"type":"DELETE","lineNumber":352,"oldContent":"                      icon: Icon("},{"type":"INSERT","lineNumber":361,"content":"                      icon: Icon("},{"type":"DELETE","lineNumber":362,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":372,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":372,"oldContent":"                ),"},{"type":"INSERT","lineNumber":377,"content":"                    }"},{"type":"INSERT","lineNumber":378,"content":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":384,"content":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":382,"oldContent":"                      icon: Icon("},{"type":"INSERT","lineNumber":393,"content":"                        borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":393,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":402,"content":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"DELETE","lineNumber":398,"oldContent":"                    }"},{"type":"DELETE","lineNumber":400,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":407,"oldContent":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":412,"content":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":413,"content":"                  children: ["},{"type":"INSERT","lineNumber":414,"content":"                    const Text(\"Already have an account?\"),"},{"type":"INSERT","lineNumber":415,"content":"                    TextButton("},{"type":"DELETE","lineNumber":414,"oldContent":"                        borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":423,"oldContent":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"INSERT","lineNumber":432,"content":"  }"},{"type":"DELETE","lineNumber":429,"oldContent":"  }"},{"type":"DELETE","lineNumber":430,"oldContent":"                    TextButton("},{"type":"DELETE","lineNumber":431,"oldContent":"                    const Text(\"Already have an account?\"),"},{"type":"DELETE","lineNumber":432,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":433,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"}]},{"timestamp":1754615720222,"changes":[{"type":"MODIFY","lineNumber":59,"content":"","oldContent":""},{"type":"DELETE","lineNumber":95,"oldContent":"      bool shouldVerifyPhone = phoneNumber != null && phoneNumber.isNotEmpty;"},{"type":"DELETE","lineNumber":96,"oldContent":""},{"type":"DELETE","lineNumber":97,"oldContent":"      // If phone number is provided, send OTP first"},{"type":"DELETE","lineNumber":98,"oldContent":"        final otpSent = await _viewModel.sendOtp(phoneNumber);"},{"type":"DELETE","lineNumber":99,"oldContent":"      if (shouldVerifyPhone) {"},{"type":"DELETE","lineNumber":100,"oldContent":""},{"type":"DELETE","lineNumber":101,"oldContent":"        if (!mounted) return;"},{"type":"DELETE","lineNumber":102,"oldContent":""},{"type":"DELETE","lineNumber":103,"oldContent":"        if (!otpSent || _viewModel.verificationId == null) {"},{"type":"DELETE","lineNumber":104,"oldContent":"          // If OTP sending fails, ask user if they want to proceed without phone verification"},{"type":"DELETE","lineNumber":105,"oldContent":"          final shouldContinue = await showDialog<bool>("},{"type":"DELETE","lineNumber":106,"oldContent":"            context: context,"},{"type":"DELETE","lineNumber":107,"oldContent":"            builder: (context) => AlertDialog("},{"type":"DELETE","lineNumber":108,"oldContent":"              title: const Text('Phone Verification Failed'),"},{"type":"DELETE","lineNumber":109,"oldContent":"              content: const Text("},{"type":"DELETE","lineNumber":110,"oldContent":"                'We couldn\\'t send an OTP to your phone. Would you like to continue without phone verification?',"},{"type":"DELETE","lineNumber":111,"oldContent":"              ),"},{"type":"DELETE","lineNumber":112,"oldContent":"              actions: ["},{"type":"DELETE","lineNumber":113,"oldContent":"                TextButton("},{"type":"DELETE","lineNumber":114,"oldContent":"                  onPressed: () => Navigator.pop(context, false),"},{"type":"DELETE","lineNumber":115,"oldContent":"                  child: const Text('Cancel'),"},{"type":"DELETE","lineNumber":116,"oldContent":"                ),"},{"type":"DELETE","lineNumber":117,"oldContent":"                TextButton("},{"type":"DELETE","lineNumber":118,"oldContent":"                  onPressed: () => Navigator.pop(context, true),"},{"type":"DELETE","lineNumber":119,"oldContent":"                  child: const Text('Continue'),"},{"type":"DELETE","lineNumber":120,"oldContent":"                ),"},{"type":"DELETE","lineNumber":121,"oldContent":"              ],"},{"type":"DELETE","lineNumber":122,"oldContent":"            ),"},{"type":"DELETE","lineNumber":123,"oldContent":"          ) ?? false;"},{"type":"DELETE","lineNumber":124,"oldContent":"          if (!shouldContinue) {"},{"type":"DELETE","lineNumber":125,"oldContent":""},{"type":"DELETE","lineNumber":126,"oldContent":"            setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":127,"oldContent":"            return;"},{"type":"DELETE","lineNumber":128,"oldContent":"          }"},{"type":"DELETE","lineNumber":129,"oldContent":"          shouldVerifyPhone = false; // Skip phone verification"},{"type":"DELETE","lineNumber":130,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":131,"oldContent":"          // OTP sent successfully, navigate to OTP screen"},{"type":"DELETE","lineNumber":132,"oldContent":"          if (!mounted) return;"},{"type":"DELETE","lineNumber":133,"oldContent":"          "},{"type":"DELETE","lineNumber":134,"oldContent":"          // First register the user"},{"type":"DELETE","lineNumber":135,"oldContent":"          final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":136,"oldContent":"            email: email,"},{"type":"DELETE","lineNumber":137,"oldContent":"            password: password,"},{"type":"DELETE","lineNumber":138,"oldContent":"            name: name,"},{"type":"DELETE","lineNumber":139,"oldContent":"            phone: phoneNumber,"},{"type":"DELETE","lineNumber":140,"oldContent":"          );"},{"type":"DELETE","lineNumber":141,"oldContent":""},{"type":"DELETE","lineNumber":142,"oldContent":"          if (!mounted) return;"},{"type":"DELETE","lineNumber":143,"oldContent":"                    phoneNumber: phoneNumber,"},{"type":"DELETE","lineNumber":144,"oldContent":""},{"type":"DELETE","lineNumber":145,"oldContent":"          if (success) {"},{"type":"DELETE","lineNumber":146,"oldContent":"            // Navigate to OTP verification screen"},{"type":"DELETE","lineNumber":147,"oldContent":"            if (mounted) {"},{"type":"DELETE","lineNumber":148,"oldContent":"              Navigator.pushReplacement("},{"type":"DELETE","lineNumber":149,"oldContent":"            return;"},{"type":"DELETE","lineNumber":150,"oldContent":"                context,"},{"type":"DELETE","lineNumber":151,"oldContent":"                MaterialPageRoute("},{"type":"DELETE","lineNumber":152,"oldContent":"                  builder: (context) => OtpVerificationScreen("},{"type":"DELETE","lineNumber":153,"oldContent":"                    verificationId: _viewModel.verificationId!,"},{"type":"DELETE","lineNumber":154,"oldContent":"                    email: email,"},{"type":"DELETE","lineNumber":155,"oldContent":"                    isRegistration: true,"},{"type":"DELETE","lineNumber":156,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":157,"oldContent":"                ),"},{"type":"DELETE","lineNumber":158,"oldContent":"              );"},{"type":"DELETE","lineNumber":159,"oldContent":"            }"},{"type":"DELETE","lineNumber":160,"oldContent":"          } else {"},{"type":"DELETE","lineNumber":161,"oldContent":"            // Show error message from view model"},{"type":"DELETE","lineNumber":162,"oldContent":"            if (mounted) {"},{"type":"DELETE","lineNumber":163,"oldContent":"      }"},{"type":"DELETE","lineNumber":164,"oldContent":"              ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":165,"oldContent":""},{"type":"DELETE","lineNumber":166,"oldContent":"                SnackBar("},{"type":"DELETE","lineNumber":167,"oldContent":"      // If we reach here, either no phone number was provided or user chose to skip verification"},{"type":"DELETE","lineNumber":168,"oldContent":"                  content: Text(_viewModel.errorMessage ?? 'Registration failed'),"},{"type":"INSERT","lineNumber":95,"content":"      // Register the user"},{"type":"DELETE","lineNumber":171,"oldContent":"                  backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":174,"oldContent":"                ),"},{"type":"DELETE","lineNumber":177,"oldContent":"              );"},{"type":"DELETE","lineNumber":180,"oldContent":"            }"},{"type":"DELETE","lineNumber":183,"oldContent":"            return;"},{"type":"DELETE","lineNumber":184,"oldContent":"        // Navigate to home screen"},{"type":"DELETE","lineNumber":185,"oldContent":"          }"},{"type":"INSERT","lineNumber":106,"content":"        // Navigate to home screen on successful registration"},{"type":"DELETE","lineNumber":188,"oldContent":"        }"},{"type":"DELETE","lineNumber":190,"oldContent":"        );"},{"type":"DELETE","lineNumber":192,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":111,"content":"        );"},{"type":"DELETE","lineNumber":194,"oldContent":"      print('Error in _register: $e');"},{"type":"DELETE","lineNumber":196,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":198,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":200,"oldContent":"          SnackBar("},{"type":"INSERT","lineNumber":117,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":118,"content":"          ),"},{"type":"INSERT","lineNumber":119,"content":"        );"},{"type":"INSERT","lineNumber":120,"content":"      }"},{"type":"INSERT","lineNumber":121,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":122,"content":"      print('Error in _register: $e');"},{"type":"INSERT","lineNumber":123,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":124,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":125,"content":"          SnackBar("},{"type":"DELETE","lineNumber":205,"oldContent":"          ),"},{"type":"DELETE","lineNumber":207,"oldContent":"        );"},{"type":"DELETE","lineNumber":213,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":216,"oldContent":"      }"},{"type":"DELETE","lineNumber":231,"oldContent":"                "},{"type":"DELETE","lineNumber":232,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":233,"oldContent":"                  keyboardType: TextInputType.emailAddress,"},{"type":"DELETE","lineNumber":234,"oldContent":"                    labelText: 'Email',"},{"type":"INSERT","lineNumber":151,"content":"          child: Form("},{"type":"INSERT","lineNumber":152,"content":"            key: _formKey,"},{"type":"INSERT","lineNumber":153,"content":"            child: Column("},{"type":"INSERT","lineNumber":154,"content":"              crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"DELETE","lineNumber":244,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":165,"content":"                      ),"},{"type":"INSERT","lineNumber":182,"content":"                ),"},{"type":"INSERT","lineNumber":183,"content":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":264,"oldContent":"                ),"},{"type":"DELETE","lineNumber":266,"oldContent":"                const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":188,"content":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":271,"oldContent":"                    labelText: 'Full Name',"},{"type":"INSERT","lineNumber":193,"content":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":196,"content":"                    return null;"},{"type":"INSERT","lineNumber":197,"content":"                  },"},{"type":"DELETE","lineNumber":276,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":200,"content":"                // Email field"},{"type":"DELETE","lineNumber":280,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":282,"oldContent":"                  },"},{"type":"INSERT","lineNumber":204,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":286,"oldContent":"                // Email field"},{"type":"DELETE","lineNumber":289,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":305,"oldContent":"                    hintText: '+1 (123) 456-7890',"},{"type":"DELETE","lineNumber":306,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":308,"oldContent":"                  onChanged: (value) {"},{"type":"INSERT","lineNumber":228,"content":"                    hintText: '+1 (123) 456-7890',"},{"type":"INSERT","lineNumber":229,"content":"                  ),"},{"type":"INSERT","lineNumber":230,"content":"                  onChanged: (value) {"},{"type":"DELETE","lineNumber":319,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":320,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":321,"oldContent":"                    const SizedBox(width: 16),"},{"type":"DELETE","lineNumber":322,"oldContent":"                    // Apple"},{"type":"DELETE","lineNumber":324,"oldContent":"                      onPressed: () {"},{"type":"DELETE","lineNumber":325,"oldContent":"                      },"},{"type":"DELETE","lineNumber":326,"oldContent":"                        backgroundColor: Colors.grey[100],"},{"type":"DELETE","lineNumber":327,"oldContent":"                        shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":328,"oldContent":"                        ),"},{"type":"INSERT","lineNumber":240,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":241,"content":"                // Password field"},{"type":"INSERT","lineNumber":242,"content":"                TextFormField("},{"type":"INSERT","lineNumber":243,"content":"                  controller: _passwordController,"},{"type":"INSERT","lineNumber":244,"content":"                  obscureText: _obscurePassword,"},{"type":"INSERT","lineNumber":245,"content":"                  decoration: InputDecoration("},{"type":"INSERT","lineNumber":246,"content":"                    labelText: 'Password',"},{"type":"INSERT","lineNumber":247,"content":"                    prefixIcon: const Icon(Icons.lock_outline),"},{"type":"INSERT","lineNumber":248,"content":"                    suffixIcon: IconButton("},{"type":"INSERT","lineNumber":249,"content":"                      icon: Icon("},{"type":"DELETE","lineNumber":331,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":332,"oldContent":"                      icon: Icon("},{"type":"DELETE","lineNumber":333,"oldContent":"                "},{"type":"DELETE","lineNumber":334,"oldContent":"                "},{"type":"DELETE","lineNumber":335,"oldContent":"                Row("},{"type":"DELETE","lineNumber":336,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":337,"oldContent":"                    TextButton("},{"type":"DELETE","lineNumber":338,"oldContent":"                        Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":339,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":340,"oldContent":"            ),"},{"type":"DELETE","lineNumber":341,"oldContent":"        ),"},{"type":"INSERT","lineNumber":252,"content":"                            : Icons.visibility_off_outlined,"},{"type":"INSERT","lineNumber":253,"content":"                      ),"},{"type":"INSERT","lineNumber":254,"content":"                      onPressed: () {"},{"type":"INSERT","lineNumber":255,"content":"                        setState(() {"},{"type":"INSERT","lineNumber":256,"content":"                          _obscurePassword = !_obscurePassword;"},{"type":"INSERT","lineNumber":257,"content":"                        });"},{"type":"INSERT","lineNumber":258,"content":"                      },"},{"type":"DELETE","lineNumber":343,"oldContent":"    );"},{"type":"DELETE","lineNumber":344,"oldContent":"}"},{"type":"INSERT","lineNumber":260,"content":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":261,"content":"                  ),"},{"type":"INSERT","lineNumber":262,"content":"                  validator: (value) {"},{"type":"INSERT","lineNumber":263,"content":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":264,"content":"                      return 'Please enter a password';"},{"type":"INSERT","lineNumber":265,"content":"                    }"},{"type":"INSERT","lineNumber":266,"content":"                    if (value.length < 6) {"},{"type":"INSERT","lineNumber":267,"content":"                      return 'Password must be at least 6 characters';"},{"type":"INSERT","lineNumber":268,"content":"                    }"},{"type":"INSERT","lineNumber":269,"content":"                    return null;"},{"type":"INSERT","lineNumber":270,"content":"                  },"},{"type":"DELETE","lineNumber":346,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":347,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":348,"oldContent":"                            width: 24,"},{"type":"DELETE","lineNumber":349,"oldContent":"                          icon: SvgPicture.asset("},{"type":"DELETE","lineNumber":350,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":352,"oldContent":"                      Expanded("},{"type":"DELETE","lineNumber":353,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":354,"oldContent":"                ),"},{"type":"DELETE","lineNumber":355,"oldContent":"                  child: Row("},{"type":"DELETE","lineNumber":356,"oldContent":"                ConstrainedBox("},{"type":"DELETE","lineNumber":357,"oldContent":"                "},{"type":"DELETE","lineNumber":358,"oldContent":"                "},{"type":"DELETE","lineNumber":359,"oldContent":"                ),"},{"type":"DELETE","lineNumber":360,"oldContent":"                    const Expanded(child: Divider()),"},{"type":"INSERT","lineNumber":273,"content":"                // Confirm Password field"},{"type":"INSERT","lineNumber":274,"content":"                TextFormField("},{"type":"INSERT","lineNumber":275,"content":"                  controller: _confirmPasswordController,"},{"type":"INSERT","lineNumber":276,"content":"                  obscureText: _obscureConfirmPassword,"},{"type":"INSERT","lineNumber":277,"content":"                  decoration: InputDecoration("},{"type":"INSERT","lineNumber":278,"content":"                    labelText: 'Confirm Password',"},{"type":"INSERT","lineNumber":279,"content":"                    prefixIcon: const Icon(Icons.lock_outline),"},{"type":"INSERT","lineNumber":280,"content":"                    suffixIcon: IconButton("},{"type":"INSERT","lineNumber":281,"content":"                      icon: Icon("},{"type":"DELETE","lineNumber":363,"oldContent":"                      padding: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"DELETE","lineNumber":364,"oldContent":"                      icon: Icon("},{"type":"INSERT","lineNumber":284,"content":"                            : Icons.visibility_off_outlined,"},{"type":"INSERT","lineNumber":292,"content":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":375,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":297,"content":"                    }"},{"type":"INSERT","lineNumber":298,"content":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":380,"oldContent":"                    }"},{"type":"DELETE","lineNumber":382,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":304,"content":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":388,"oldContent":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":313,"content":"                        borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":398,"oldContent":"                        borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":322,"content":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"DELETE","lineNumber":405,"oldContent":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"INSERT","lineNumber":332,"content":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":333,"content":"                  children: ["},{"type":"INSERT","lineNumber":334,"content":"                    const Text(\"Already have an account?\"),"},{"type":"INSERT","lineNumber":335,"content":"                    TextButton("},{"type":"DELETE","lineNumber":415,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":417,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":419,"oldContent":"                    const Text(\"Already have an account?\"),"},{"type":"DELETE","lineNumber":420,"oldContent":"                    TextButton("},{"type":"DELETE","lineNumber":425,"oldContent":"                    TextButton("},{"type":"INSERT","lineNumber":345,"content":"                ),"},{"type":"DELETE","lineNumber":432,"oldContent":"      },"},{"type":"DELETE","lineNumber":434,"oldContent":"  }"},{"type":"INSERT","lineNumber":353,"content":"}"},{"type":"INSERT","lineNumber":354,"content":""}]},{"timestamp":1754615735368,"changes":[{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/otp_verification_screen.dart';"},{"type":"INSERT","lineNumber":57,"content":"  }"},{"type":"DELETE","lineNumber":59,"oldContent":""},{"type":"DELETE","lineNumber":68,"oldContent":"          child: Form("},{"type":"INSERT","lineNumber":67,"content":"    if (digits.startsWith('0')) {"},{"type":"DELETE","lineNumber":77,"oldContent":"                      style: TextStyle("},{"type":"INSERT","lineNumber":76,"content":"    }"},{"type":"DELETE","lineNumber":96,"oldContent":"        // Navigate to home screen on successful registration"},{"type":"DELETE","lineNumber":97,"oldContent":"        );"},{"type":"DELETE","lineNumber":98,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":99,"oldContent":"          ),"},{"type":"DELETE","lineNumber":100,"oldContent":"        );"},{"type":"DELETE","lineNumber":101,"oldContent":"      }"},{"type":"DELETE","lineNumber":102,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":103,"oldContent":"      print('Error in _register: $e');"},{"type":"DELETE","lineNumber":104,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":105,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":106,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":107,"oldContent":"          child: Form("},{"type":"DELETE","lineNumber":108,"oldContent":"            key: _formKey,"},{"type":"DELETE","lineNumber":109,"oldContent":"            child: Column("},{"type":"DELETE","lineNumber":110,"oldContent":"              crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"DELETE","lineNumber":111,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":121,"oldContent":"                ),"},{"type":"DELETE","lineNumber":123,"oldContent":"                const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":105,"content":"        // Navigate to home screen on successful registration"},{"type":"DELETE","lineNumber":126,"oldContent":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":129,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":110,"content":"        );"},{"type":"DELETE","lineNumber":132,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":133,"oldContent":"                  },"},{"type":"DELETE","lineNumber":136,"oldContent":"                // Email field"},{"type":"INSERT","lineNumber":116,"content":"            backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":117,"content":"          ),"},{"type":"INSERT","lineNumber":118,"content":"        );"},{"type":"INSERT","lineNumber":119,"content":"      }"},{"type":"INSERT","lineNumber":120,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":121,"content":"      print('Error in _register: $e');"},{"type":"INSERT","lineNumber":122,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":123,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":124,"content":"          SnackBar("},{"type":"DELETE","lineNumber":140,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":161,"oldContent":"                    hintText: '+1 (123) 456-7890',"},{"type":"DELETE","lineNumber":163,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":165,"oldContent":"                  onChanged: (value) {"},{"type":"INSERT","lineNumber":150,"content":"          child: Form("},{"type":"INSERT","lineNumber":151,"content":"            key: _formKey,"},{"type":"INSERT","lineNumber":152,"content":"            child: Column("},{"type":"INSERT","lineNumber":153,"content":"              crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"DELETE","lineNumber":172,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":174,"oldContent":"                // Password field"},{"type":"DELETE","lineNumber":176,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":178,"oldContent":"                  controller: _passwordController,"},{"type":"DELETE","lineNumber":180,"oldContent":"                  obscureText: _obscurePassword,"},{"type":"DELETE","lineNumber":181,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":183,"oldContent":"                    labelText: 'Password',"},{"type":"INSERT","lineNumber":164,"content":"                      ),"},{"type":"DELETE","lineNumber":185,"oldContent":"                    prefixIcon: const Icon(Icons.lock_outline),"},{"type":"DELETE","lineNumber":187,"oldContent":"                    suffixIcon: IconButton("},{"type":"DELETE","lineNumber":189,"oldContent":"                      icon: Icon("},{"type":"DELETE","lineNumber":193,"oldContent":"                            : Icons.visibility_off_outlined,"},{"type":"DELETE","lineNumber":195,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":197,"oldContent":"                      onPressed: () {"},{"type":"DELETE","lineNumber":199,"oldContent":"                        setState(() {"},{"type":"DELETE","lineNumber":201,"oldContent":"                          _obscurePassword = !_obscurePassword;"},{"type":"DELETE","lineNumber":203,"oldContent":"                        });"},{"type":"DELETE","lineNumber":205,"oldContent":"                      },"},{"type":"DELETE","lineNumber":208,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":211,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":212,"oldContent":"                  validator: (value) {"},{"type":"INSERT","lineNumber":181,"content":"                ),"},{"type":"INSERT","lineNumber":182,"content":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":214,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":216,"oldContent":"                      return 'Please enter a password';"},{"type":"DELETE","lineNumber":217,"oldContent":"                    }"},{"type":"DELETE","lineNumber":219,"oldContent":"                    if (value.length < 6) {"},{"type":"DELETE","lineNumber":220,"oldContent":"                      return 'Password must be at least 6 characters';"},{"type":"DELETE","lineNumber":222,"oldContent":"                    }"},{"type":"INSERT","lineNumber":187,"content":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":224,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":226,"oldContent":"                  },"},{"type":"DELETE","lineNumber":229,"oldContent":"                // Confirm Password field"},{"type":"INSERT","lineNumber":192,"content":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":231,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":233,"oldContent":"                  controller: _confirmPasswordController,"},{"type":"INSERT","lineNumber":195,"content":"                    return null;"},{"type":"INSERT","lineNumber":196,"content":"                  },"},{"type":"DELETE","lineNumber":235,"oldContent":"                  obscureText: _obscureConfirmPassword,"},{"type":"DELETE","lineNumber":236,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":238,"oldContent":"                    labelText: 'Confirm Password',"},{"type":"INSERT","lineNumber":199,"content":"                // Email field"},{"type":"DELETE","lineNumber":240,"oldContent":"                    prefixIcon: const Icon(Icons.lock_outline),"},{"type":"DELETE","lineNumber":242,"oldContent":"                    suffixIcon: IconButton("},{"type":"DELETE","lineNumber":243,"oldContent":"                      icon: Icon("},{"type":"INSERT","lineNumber":203,"content":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":246,"oldContent":"                            : Icons.visibility_off_outlined,"},{"type":"DELETE","lineNumber":253,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":259,"oldContent":"                    }"},{"type":"DELETE","lineNumber":261,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":268,"oldContent":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":227,"content":"                    hintText: '+1 (123) 456-7890',"},{"type":"INSERT","lineNumber":228,"content":"                  ),"},{"type":"INSERT","lineNumber":229,"content":"                  onChanged: (value) {"},{"type":"DELETE","lineNumber":275,"oldContent":"                        borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":282,"oldContent":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"INSERT","lineNumber":239,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":240,"content":"                // Password field"},{"type":"INSERT","lineNumber":241,"content":"                TextFormField("},{"type":"INSERT","lineNumber":242,"content":"                  controller: _passwordController,"},{"type":"INSERT","lineNumber":243,"content":"                  obscureText: _obscurePassword,"},{"type":"INSERT","lineNumber":244,"content":"                  decoration: InputDecoration("},{"type":"INSERT","lineNumber":245,"content":"                    labelText: 'Password',"},{"type":"INSERT","lineNumber":246,"content":"                    prefixIcon: const Icon(Icons.lock_outline),"},{"type":"INSERT","lineNumber":247,"content":"                    suffixIcon: IconButton("},{"type":"INSERT","lineNumber":248,"content":"                      icon: Icon("},{"type":"DELETE","lineNumber":286,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":287,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":288,"oldContent":"                    const Text(\"Already have an account?\"),"},{"type":"DELETE","lineNumber":289,"oldContent":"                    TextButton("},{"type":"INSERT","lineNumber":251,"content":"                            : Icons.visibility_off_outlined,"},{"type":"INSERT","lineNumber":252,"content":"                      ),"},{"type":"INSERT","lineNumber":253,"content":"                      onPressed: () {"},{"type":"INSERT","lineNumber":254,"content":"                        setState(() {"},{"type":"INSERT","lineNumber":255,"content":"                          _obscurePassword = !_obscurePassword;"},{"type":"INSERT","lineNumber":256,"content":"                        });"},{"type":"INSERT","lineNumber":257,"content":"                      },"},{"type":"INSERT","lineNumber":259,"content":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":260,"content":"                  ),"},{"type":"INSERT","lineNumber":261,"content":"                  validator: (value) {"},{"type":"INSERT","lineNumber":262,"content":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":263,"content":"                      return 'Please enter a password';"},{"type":"INSERT","lineNumber":264,"content":"                    }"},{"type":"INSERT","lineNumber":265,"content":"                    if (value.length < 6) {"},{"type":"INSERT","lineNumber":266,"content":"                      return 'Password must be at least 6 characters';"},{"type":"INSERT","lineNumber":267,"content":"                    }"},{"type":"INSERT","lineNumber":268,"content":"                    return null;"},{"type":"INSERT","lineNumber":269,"content":"                  },"},{"type":"DELETE","lineNumber":292,"oldContent":""},{"type":"DELETE","lineNumber":294,"oldContent":"}"},{"type":"DELETE","lineNumber":295,"oldContent":""},{"type":"INSERT","lineNumber":272,"content":"                // Confirm Password field"},{"type":"INSERT","lineNumber":273,"content":"                TextFormField("},{"type":"INSERT","lineNumber":274,"content":"                  controller: _confirmPasswordController,"},{"type":"INSERT","lineNumber":275,"content":"                  obscureText: _obscureConfirmPassword,"},{"type":"INSERT","lineNumber":276,"content":"                  decoration: InputDecoration("},{"type":"INSERT","lineNumber":277,"content":"                    labelText: 'Confirm Password',"},{"type":"INSERT","lineNumber":278,"content":"                    prefixIcon: const Icon(Icons.lock_outline),"},{"type":"INSERT","lineNumber":279,"content":"                    suffixIcon: IconButton("},{"type":"INSERT","lineNumber":280,"content":"                      icon: Icon("},{"type":"INSERT","lineNumber":283,"content":"                            : Icons.visibility_off_outlined,"},{"type":"INSERT","lineNumber":291,"content":"                    border: const OutlineInputBorder(),"},{"type":"INSERT","lineNumber":296,"content":"                    }"},{"type":"INSERT","lineNumber":297,"content":"                    if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":303,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":312,"content":"                        borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":321,"content":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"INSERT","lineNumber":331,"content":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":332,"content":"                  children: ["},{"type":"INSERT","lineNumber":333,"content":"                    const Text(\"Already have an account?\"),"},{"type":"INSERT","lineNumber":334,"content":"                    TextButton("},{"type":"INSERT","lineNumber":344,"content":"                ),"},{"type":"DELETE","lineNumber":350,"oldContent":"    );"},{"type":"INSERT","lineNumber":347,"content":"          ),"},{"type":"INSERT","lineNumber":348,"content":"        ),"},{"type":"INSERT","lineNumber":350,"content":"    );"},{"type":"DELETE","lineNumber":353,"oldContent":"                    const Text(\"Already have an account?\"),"},{"type":"DELETE","lineNumber":354,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":352,"content":"}"},{"type":"INSERT","lineNumber":353,"content":""}]},{"timestamp":1754628546699,"changes":[{"type":"DELETE","lineNumber":1,"oldContent":"import 'package:flutter_svg/flutter_svg.dart';"},{"type":"DELETE","lineNumber":2,"oldContent":"import 'package:provider/provider.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:family_tree_firebase/core/constants/app_constants.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"INSERT","lineNumber":1,"content":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"INSERT","lineNumber":2,"content":"import 'package:google_fonts/google_fonts.dart';"},{"type":"INSERT","lineNumber":3,"content":"import '../bloc/auth_bloc.dart';"},{"type":"MODIFY","lineNumber":6,"content":"  const RegisterScreen({Key? key}) : super(key: key);","oldContent":"  const RegisterScreen({super.key});"},{"type":"MODIFY","lineNumber":9,"content":"  _RegisterScreenState createState() => _RegisterScreenState();","oldContent":"  State<RegisterScreen> createState() => _RegisterScreenState();"},{"type":"DELETE","lineNumber":15,"oldContent":"  late final TextEditingController _nameController;"},{"type":"DELETE","lineNumber":16,"oldContent":"  late final TextEditingController _emailController;"},{"type":"DELETE","lineNumber":17,"oldContent":"  late final TextEditingController _phoneController;"},{"type":"DELETE","lineNumber":18,"oldContent":"  late final TextEditingController _passwordController;"},{"type":"DELETE","lineNumber":19,"oldContent":"  late final TextEditingController _confirmPasswordController;"},{"type":"INSERT","lineNumber":14,"content":"  final _nameController = TextEditingController();"},{"type":"INSERT","lineNumber":15,"content":"  final _emailController = TextEditingController();"},{"type":"INSERT","lineNumber":16,"content":"  final _phoneController = TextEditingController();"},{"type":"INSERT","lineNumber":17,"content":"  final _passwordController = TextEditingController();"},{"type":"INSERT","lineNumber":18,"content":"  final _confirmPasswordController = TextEditingController();"},{"type":"INSERT","lineNumber":19,"content":"  "},{"type":"INSERT","lineNumber":20,"content":"  int _currentStep = 0;"},{"type":"DELETE","lineNumber":22,"oldContent":"  bool _isLoading = false;"},{"type":"DELETE","lineNumber":23,"oldContent":"  late final AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":26,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":27,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":28,"oldContent":"    _nameController = TextEditingController();"},{"type":"DELETE","lineNumber":29,"oldContent":"    _emailController = TextEditingController();"},{"type":"DELETE","lineNumber":30,"oldContent":"    _phoneController = TextEditingController();"},{"type":"DELETE","lineNumber":31,"oldContent":"    _passwordController = TextEditingController();"},{"type":"DELETE","lineNumber":32,"oldContent":"    _confirmPasswordController = TextEditingController();"},{"type":"DELETE","lineNumber":33,"oldContent":"    _viewModel = context.read<AuthViewModel>();"},{"type":"DELETE","lineNumber":34,"oldContent":"    _viewModel.addListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":35,"oldContent":"  }"},{"type":"DELETE","lineNumber":36,"oldContent":""},{"type":"DELETE","lineNumber":37,"oldContent":"  @override"},{"type":"DELETE","lineNumber":44,"oldContent":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":48,"oldContent":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":49,"oldContent":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"DELETE","lineNumber":50,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":51,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":52,"oldContent":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"DELETE","lineNumber":53,"oldContent":"        );"},{"type":"DELETE","lineNumber":54,"oldContent":"        _viewModel.clearError();"},{"type":"INSERT","lineNumber":34,"content":"  void _onNextStep() {"},{"type":"INSERT","lineNumber":35,"content":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"INSERT","lineNumber":36,"content":"      if (_currentStep < 1) {"},{"type":"INSERT","lineNumber":37,"content":"        setState(() {"},{"type":"INSERT","lineNumber":38,"content":"          _currentStep++;"},{"type":"INSERT","lineNumber":39,"content":"        });"},{"type":"DELETE","lineNumber":56,"oldContent":"  }"},{"type":"INSERT","lineNumber":42,"content":"  }"},{"type":"DELETE","lineNumber":59,"oldContent":"  // Format phone number to E.164 standard"},{"type":"DELETE","lineNumber":60,"oldContent":"  String _formatPhoneNumber(String phone) {"},{"type":"DELETE","lineNumber":61,"oldContent":"    if (phone.isEmpty) return '';"},{"type":"DELETE","lineNumber":62,"oldContent":""},{"type":"DELETE","lineNumber":63,"oldContent":"    // Remove all non-digit characters"},{"type":"DELETE","lineNumber":64,"oldContent":"    String digits = phone.replaceAll(RegExp(r'[^0-9]'), '');"},{"type":"DELETE","lineNumber":65,"oldContent":""},{"type":"DELETE","lineNumber":66,"oldContent":"    if (digits.startsWith('0')) {"},{"type":"DELETE","lineNumber":67,"oldContent":"    // Add country code if missing"},{"type":"DELETE","lineNumber":68,"oldContent":"      digits = '91${digits.substring(1)}'; // Assuming India as default country"},{"type":"DELETE","lineNumber":69,"oldContent":"    } else if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":70,"oldContent":"      digits = '91$digits'; // Add default country code if no country code provided"},{"type":"INSERT","lineNumber":44,"content":"  void _onPreviousStep() {"},{"type":"INSERT","lineNumber":45,"content":"    if (_currentStep > 0) {"},{"type":"INSERT","lineNumber":46,"content":"      setState(() {"},{"type":"INSERT","lineNumber":47,"content":"        _currentStep--;"},{"type":"INSERT","lineNumber":48,"content":"      });"},{"type":"INSERT","lineNumber":49,"content":"    } else {"},{"type":"INSERT","lineNumber":50,"content":"      Navigator.pop(context);"},{"type":"DELETE","lineNumber":72,"oldContent":""},{"type":"DELETE","lineNumber":73,"oldContent":"    // Add + prefix if missing"},{"type":"DELETE","lineNumber":74,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":75,"oldContent":"    }"},{"type":"DELETE","lineNumber":76,"oldContent":"      digits = '+$digits';"},{"type":"DELETE","lineNumber":77,"oldContent":""},{"type":"DELETE","lineNumber":78,"oldContent":"    return digits;"},{"type":"DELETE","lineNumber":81,"oldContent":"  Future<void> _register() async {"},{"type":"DELETE","lineNumber":82,"oldContent":"    if (!_formKey.currentState!.validate()) return;"},{"type":"DELETE","lineNumber":83,"oldContent":""},{"type":"DELETE","lineNumber":84,"oldContent":"    try {"},{"type":"DELETE","lineNumber":85,"oldContent":"      setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":86,"oldContent":""},{"type":"DELETE","lineNumber":87,"oldContent":"      final email = _emailController.text.trim();"},{"type":"DELETE","lineNumber":88,"oldContent":"      final name = _nameController.text.trim();"},{"type":"DELETE","lineNumber":89,"oldContent":"      final password = _passwordController.text;"},{"type":"DELETE","lineNumber":90,"oldContent":"      final phoneNumber = _phoneController.text.trim().isNotEmpty"},{"type":"DELETE","lineNumber":91,"oldContent":"          ? _formatPhoneNumber(_phoneController.text.trim())"},{"type":"DELETE","lineNumber":92,"oldContent":"          : null;"},{"type":"DELETE","lineNumber":93,"oldContent":""},{"type":"DELETE","lineNumber":94,"oldContent":"      // Register the user"},{"type":"DELETE","lineNumber":95,"oldContent":"        // Navigate to home screen on successful registration"},{"type":"DELETE","lineNumber":96,"oldContent":"        );"},{"type":"DELETE","lineNumber":97,"oldContent":"      final success = await _viewModel.registerWithEmail("},{"type":"DELETE","lineNumber":98,"oldContent":"        email: email,"},{"type":"DELETE","lineNumber":99,"oldContent":"        password: password,"},{"type":"DELETE","lineNumber":100,"oldContent":"        name: name,"},{"type":"DELETE","lineNumber":101,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":102,"oldContent":"        phone: phoneNumber,"},{"type":"DELETE","lineNumber":103,"oldContent":"          ),"},{"type":"DELETE","lineNumber":104,"oldContent":"      );"},{"type":"DELETE","lineNumber":105,"oldContent":"        );"},{"type":"DELETE","lineNumber":106,"oldContent":""},{"type":"DELETE","lineNumber":107,"oldContent":"      }"},{"type":"DELETE","lineNumber":108,"oldContent":"      if (!mounted) return;"},{"type":"DELETE","lineNumber":109,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":110,"oldContent":""},{"type":"DELETE","lineNumber":111,"oldContent":"      print('Error in _register: $e');"},{"type":"DELETE","lineNumber":112,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":113,"oldContent":"      if (success) {"},{"type":"DELETE","lineNumber":114,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":115,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":116,"oldContent":"        Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":117,"oldContent":"          context,"},{"type":"DELETE","lineNumber":118,"oldContent":"          '/home',"},{"type":"DELETE","lineNumber":119,"oldContent":"          (route) => false,"},{"type":"DELETE","lineNumber":120,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":121,"oldContent":"        // Show error message from view model"},{"type":"DELETE","lineNumber":122,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":123,"oldContent":"          SnackBar("},{"type":"DELETE","lineNumber":124,"oldContent":"            content: Text(_viewModel.errorMessage ?? 'Registration failed'),"},{"type":"DELETE","lineNumber":125,"oldContent":"            content: Text('An error occurred: ${e.toString()}'),"},{"type":"DELETE","lineNumber":126,"oldContent":"            backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":127,"oldContent":"          ),"},{"type":"DELETE","lineNumber":128,"oldContent":"        );"},{"type":"DELETE","lineNumber":129,"oldContent":"      }"},{"type":"DELETE","lineNumber":130,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":131,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":132,"oldContent":"        setState(() {});"},{"type":"DELETE","lineNumber":133,"oldContent":"      }"},{"type":"INSERT","lineNumber":54,"content":"  void _onRegister() {"},{"type":"INSERT","lineNumber":55,"content":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"INSERT","lineNumber":56,"content":"      context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":57,"content":"            RegisterRequested("},{"type":"INSERT","lineNumber":58,"content":"              name: _nameController.text.trim(),"},{"type":"INSERT","lineNumber":59,"content":"              email: _emailController.text.trim(),"},{"type":"INSERT","lineNumber":60,"content":"              phoneNumber: _phoneController.text.trim(),"},{"type":"INSERT","lineNumber":61,"content":"              password: _passwordController.text.trim(),"},{"type":"INSERT","lineNumber":62,"content":"            ),"},{"type":"INSERT","lineNumber":63,"content":"          );"},{"type":"DELETE","lineNumber":136,"oldContent":"          child: Form("},{"type":"DELETE","lineNumber":138,"oldContent":"            key: _formKey,"},{"type":"DELETE","lineNumber":140,"oldContent":"            child: Column("},{"type":"DELETE","lineNumber":142,"oldContent":"              crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"DELETE","lineNumber":145,"oldContent":"        title: const Text('Create Account'),"},{"type":"DELETE","lineNumber":147,"oldContent":"          icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":148,"oldContent":"          onPressed: () => Navigator.pop(context),"},{"type":"INSERT","lineNumber":72,"content":"          icon: const Icon(Icons.arrow_back_ios, color: Color(0xFF333333)),"},{"type":"INSERT","lineNumber":73,"content":"          onPressed: _onPreviousStep,"},{"type":"INSERT","lineNumber":75,"content":"        title: Text("},{"type":"INSERT","lineNumber":76,"content":"          'Create Account',"},{"type":"INSERT","lineNumber":77,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":78,"content":"            color: const Color(0xFF333333),"},{"type":"INSERT","lineNumber":79,"content":"            fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":80,"content":"          ),"},{"type":"INSERT","lineNumber":81,"content":"        ),"},{"type":"INSERT","lineNumber":82,"content":"        backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":83,"content":"        elevation: 0,"},{"type":"DELETE","lineNumber":151,"oldContent":"      body: SingleChildScrollView("},{"type":"INSERT","lineNumber":85,"content":"      body: BlocListener<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":86,"content":"        listener: (context, state) {"},{"type":"INSERT","lineNumber":87,"content":"          if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":88,"content":"            // Navigate to home screen or verification screen"},{"type":"INSERT","lineNumber":89,"content":"          } else if (state.status == AuthStatus.error) {"},{"type":"INSERT","lineNumber":90,"content":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":91,"content":"              SnackBar(content: Text(state.error ?? 'An error occurred')),"},{"type":"INSERT","lineNumber":92,"content":"            );"},{"type":"INSERT","lineNumber":93,"content":"          }"},{"type":"INSERT","lineNumber":94,"content":"        },"},{"type":"INSERT","lineNumber":95,"content":"        child: SingleChildScrollView("},{"type":"INSERT","lineNumber":96,"content":"          child: Column("},{"type":"INSERT","lineNumber":97,"content":"            children: ["},{"type":"INSERT","lineNumber":98,"content":"              // Progress Indicator"},{"type":"INSERT","lineNumber":99,"content":"              Padding("},{"type":"INSERT","lineNumber":100,"content":"                padding: const EdgeInsets.symmetric(horizontal: 32.0, vertical: 16.0),"},{"type":"INSERT","lineNumber":101,"content":"                child: Row("},{"type":"INSERT","lineNumber":102,"content":"                  mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":103,"content":"                  children: ["},{"type":"INSERT","lineNumber":104,"content":"                    _buildStep(1, 'Details', _currentStep >= 0),"},{"type":"INSERT","lineNumber":105,"content":"                    Expanded("},{"type":"INSERT","lineNumber":106,"content":"                      child: Container("},{"type":"INSERT","lineNumber":107,"content":"                        height: 2,"},{"type":"INSERT","lineNumber":108,"content":"                        color: _currentStep >= 1"},{"type":"INSERT","lineNumber":109,"content":"                            ? const Color(0xFFFF6B35)"},{"type":"INSERT","lineNumber":110,"content":"                            : const Color(0xFFE0E0E0),"},{"type":"INSERT","lineNumber":111,"content":"                        margin: const EdgeInsets.symmetric(horizontal: 8),"},{"type":"DELETE","lineNumber":153,"oldContent":"        child: Padding("},{"type":"DELETE","lineNumber":154,"oldContent":"          padding: const EdgeInsets.all(16.0),"},{"type":"DELETE","lineNumber":155,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":156,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":157,"oldContent":"                // Logo and welcome text"},{"type":"DELETE","lineNumber":158,"oldContent":"                Center("},{"type":"INSERT","lineNumber":113,"content":"                    ),"},{"type":"INSERT","lineNumber":114,"content":"                    _buildStep(2, 'Password', _currentStep >= 1),"},{"type":"INSERT","lineNumber":115,"content":"                  ],"},{"type":"INSERT","lineNumber":116,"content":"                ),"},{"type":"INSERT","lineNumber":117,"content":"              ),"},{"type":"INSERT","lineNumber":118,"content":"              "},{"type":"INSERT","lineNumber":119,"content":"              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":120,"content":"              "},{"type":"INSERT","lineNumber":121,"content":"              // Form"},{"type":"INSERT","lineNumber":122,"content":"              Padding("},{"type":"INSERT","lineNumber":123,"content":"                padding: const EdgeInsets.symmetric(horizontal: 24.0),"},{"type":"INSERT","lineNumber":124,"content":"                child: Form("},{"type":"INSERT","lineNumber":125,"content":"                  key: _formKey,"},{"type":"DELETE","lineNumber":161,"oldContent":"                      SvgPicture.asset("},{"type":"DELETE","lineNumber":162,"oldContent":"                        'assets/images/logo.svg',"},{"type":"DELETE","lineNumber":163,"oldContent":"                        height: 100,"},{"type":"DELETE","lineNumber":164,"oldContent":"                ),"},{"type":"DELETE","lineNumber":165,"oldContent":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":166,"oldContent":"                        width: 100,"},{"type":"DELETE","lineNumber":167,"oldContent":"                      const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":168,"oldContent":"                      Text("},{"type":"DELETE","lineNumber":169,"oldContent":"                    labelText: 'Full Name',"},{"type":"DELETE","lineNumber":170,"oldContent":"                        'Create Account',"},{"type":"DELETE","lineNumber":171,"oldContent":"                        style: Theme.of(context).textTheme.headlineMedium?.copyWith("},{"type":"DELETE","lineNumber":172,"oldContent":"                              fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":173,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":128,"content":"                      if (_currentStep == 0) _buildStepOne(),"},{"type":"INSERT","lineNumber":129,"content":"                      if (_currentStep == 1) _buildStepTwo(),"},{"type":"INSERT","lineNumber":130,"content":"                      "},{"type":"INSERT","lineNumber":131,"content":"                      const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":132,"content":"                      "},{"type":"INSERT","lineNumber":133,"content":"                      // Next/Register Button"},{"type":"INSERT","lineNumber":134,"content":"                      BlocBuilder<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":135,"content":"                        builder: (context, state) {"},{"type":"INSERT","lineNumber":136,"content":"                          return SizedBox("},{"type":"INSERT","lineNumber":137,"content":"                            width: double.infinity,"},{"type":"INSERT","lineNumber":138,"content":"                            height: 56,"},{"type":"INSERT","lineNumber":139,"content":"                            child: ElevatedButton("},{"type":"INSERT","lineNumber":140,"content":"                              onPressed: state.status == AuthStatus.loading"},{"type":"INSERT","lineNumber":141,"content":"                                  ? null"},{"type":"INSERT","lineNumber":142,"content":"                                  : _currentStep == 0 ? _onNextStep : _onRegister,"},{"type":"INSERT","lineNumber":143,"content":"                              style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":144,"content":"                                backgroundColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":145,"content":"                                shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":146,"content":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":147,"content":"                                ),"},{"type":"INSERT","lineNumber":148,"content":"                                elevation: 0,"},{"type":"INSERT","lineNumber":149,"content":"                              ),"},{"type":"INSERT","lineNumber":150,"content":"                              child: state.status == AuthStatus.loading"},{"type":"INSERT","lineNumber":151,"content":"                                  ? const SizedBox("},{"type":"INSERT","lineNumber":152,"content":"                                      width: 24,"},{"type":"INSERT","lineNumber":153,"content":"                                      height: 24,"},{"type":"INSERT","lineNumber":154,"content":"                                      child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":155,"content":"                                        color: Colors.white,"},{"type":"INSERT","lineNumber":156,"content":"                                        strokeWidth: 2,"},{"type":"INSERT","lineNumber":157,"content":"                                      ),"},{"type":"INSERT","lineNumber":158,"content":"                                    )"},{"type":"INSERT","lineNumber":159,"content":"                                  : Text("},{"type":"INSERT","lineNumber":160,"content":"                                      _currentStep == 0 ? 'NEXT' : 'REGISTER',"},{"type":"INSERT","lineNumber":161,"content":"                                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":162,"content":"                                        fontSize: 16,"},{"type":"INSERT","lineNumber":163,"content":"                                        fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":164,"content":"                                        color: Colors.white,"},{"type":"INSERT","lineNumber":165,"content":"                                      ),"},{"type":"INSERT","lineNumber":166,"content":"                                    ),"},{"type":"INSERT","lineNumber":168,"content":"                          );"},{"type":"INSERT","lineNumber":169,"content":"                        },"},{"type":"DELETE","lineNumber":176,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":177,"oldContent":"                  },"},{"type":"DELETE","lineNumber":178,"oldContent":"                      const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":179,"oldContent":"                      Text("},{"type":"DELETE","lineNumber":180,"oldContent":"                // Email field"},{"type":"DELETE","lineNumber":181,"oldContent":"                        'Fill in your details to create an account',"},{"type":"DELETE","lineNumber":182,"oldContent":"                        style: Theme.of(context).textTheme.bodyMedium?.copyWith("},{"type":"DELETE","lineNumber":183,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":184,"oldContent":"                              color: Colors.grey[600],"},{"type":"INSERT","lineNumber":171,"content":"                      "},{"type":"INSERT","lineNumber":172,"content":"                      const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":173,"content":"                      "},{"type":"INSERT","lineNumber":174,"content":"                      // Already have account"},{"type":"INSERT","lineNumber":175,"content":"                      Row("},{"type":"INSERT","lineNumber":176,"content":"                        mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":177,"content":"                        children: ["},{"type":"INSERT","lineNumber":178,"content":"                          Text("},{"type":"INSERT","lineNumber":179,"content":"                            'Already have an account? ',"},{"type":"INSERT","lineNumber":180,"content":"                            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":181,"content":"                              color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":182,"content":"                              fontSize: 14,"},{"type":"INSERT","lineNumber":184,"content":"                          ),"},{"type":"INSERT","lineNumber":185,"content":"                          TextButton("},{"type":"INSERT","lineNumber":186,"content":"                            onPressed: () {"},{"type":"INSERT","lineNumber":187,"content":"                              Navigator.pop(context);"},{"type":"INSERT","lineNumber":188,"content":"                            },"},{"type":"INSERT","lineNumber":189,"content":"                            style: TextButton.styleFrom("},{"type":"INSERT","lineNumber":190,"content":"                              padding: EdgeInsets.zero,"},{"type":"INSERT","lineNumber":191,"content":"                              minimumSize: Size.zero,"},{"type":"INSERT","lineNumber":192,"content":"                              tapTargetSize: MaterialTapTargetSize.shrinkWrap,"},{"type":"INSERT","lineNumber":193,"content":"                            ),"},{"type":"INSERT","lineNumber":194,"content":"                            child: Text("},{"type":"INSERT","lineNumber":195,"content":"                              'Login',"},{"type":"INSERT","lineNumber":196,"content":"                              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":197,"content":"                                color: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":198,"content":"                                fontSize: 14,"},{"type":"INSERT","lineNumber":199,"content":"                                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":200,"content":"                              ),"},{"type":"INSERT","lineNumber":201,"content":"                            ),"},{"type":"INSERT","lineNumber":202,"content":"                          ),"},{"type":"INSERT","lineNumber":203,"content":"                        ],"},{"type":"INSERT","lineNumber":205,"content":"                      "},{"type":"INSERT","lineNumber":206,"content":"                      const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":189,"oldContent":"                // Name field"},{"type":"DELETE","lineNumber":190,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":191,"oldContent":"                  controller: _nameController,"},{"type":"DELETE","lineNumber":192,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":193,"oldContent":"                    prefixIcon: Icon(Icons.person_outline),"},{"type":"DELETE","lineNumber":194,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":195,"oldContent":"                    hintText: '+1 (123) 456-7890',"},{"type":"DELETE","lineNumber":196,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":197,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":198,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":199,"oldContent":"                  onChanged: (value) {"},{"type":"DELETE","lineNumber":200,"oldContent":"                      return 'Please enter your name';"},{"type":"DELETE","lineNumber":201,"oldContent":"                    }"},{"type":"DELETE","lineNumber":203,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":204,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":205,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":206,"oldContent":"                // Password field"},{"type":"DELETE","lineNumber":207,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":208,"oldContent":"                  controller: _emailController,"},{"type":"DELETE","lineNumber":209,"oldContent":"                  controller: _passwordController,"},{"type":"DELETE","lineNumber":210,"oldContent":"                  obscureText: _obscurePassword,"},{"type":"DELETE","lineNumber":211,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":212,"oldContent":"                  keyboardType: TextInputType.emailAddress,"},{"type":"DELETE","lineNumber":213,"oldContent":"                    labelText: 'Password',"},{"type":"DELETE","lineNumber":214,"oldContent":"                    labelText: 'Email',"},{"type":"DELETE","lineNumber":215,"oldContent":"                    prefixIcon: const Icon(Icons.lock_outline),"},{"type":"DELETE","lineNumber":216,"oldContent":"                    suffixIcon: IconButton("},{"type":"DELETE","lineNumber":217,"oldContent":"                    prefixIcon: Icon(Icons.email_outlined),"},{"type":"DELETE","lineNumber":218,"oldContent":"                      icon: Icon("},{"type":"DELETE","lineNumber":219,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":220,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":221,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":222,"oldContent":"                            : Icons.visibility_off_outlined,"},{"type":"DELETE","lineNumber":223,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":224,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":225,"oldContent":"                      return 'Please enter your email';"},{"type":"DELETE","lineNumber":226,"oldContent":"                      onPressed: () {"},{"type":"DELETE","lineNumber":227,"oldContent":"                        setState(() {"},{"type":"DELETE","lineNumber":228,"oldContent":"                    }"},{"type":"DELETE","lineNumber":229,"oldContent":"                          _obscurePassword = !_obscurePassword;"},{"type":"DELETE","lineNumber":230,"oldContent":"                    if (!value.contains('@')) {"},{"type":"DELETE","lineNumber":231,"oldContent":"                        });"},{"type":"DELETE","lineNumber":232,"oldContent":"                      return 'Please enter a valid email';"},{"type":"DELETE","lineNumber":233,"oldContent":"                      },"},{"type":"DELETE","lineNumber":234,"oldContent":"                    }"},{"type":"DELETE","lineNumber":235,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":236,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":237,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":238,"oldContent":"                  },"},{"type":"DELETE","lineNumber":239,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":240,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":241,"oldContent":"                ),"},{"type":"DELETE","lineNumber":242,"oldContent":"                      return 'Please enter a password';"},{"type":"DELETE","lineNumber":243,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":244,"oldContent":"                    }"},{"type":"DELETE","lineNumber":245,"oldContent":"                // Phone field (optional)"},{"type":"DELETE","lineNumber":246,"oldContent":"                    if (value.length < 6) {"},{"type":"DELETE","lineNumber":247,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":248,"oldContent":"                      return 'Password must be at least 6 characters';"},{"type":"DELETE","lineNumber":249,"oldContent":"                  controller: _phoneController,"},{"type":"DELETE","lineNumber":250,"oldContent":"                    }"},{"type":"DELETE","lineNumber":251,"oldContent":"                  keyboardType: TextInputType.phone,"},{"type":"DELETE","lineNumber":252,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":253,"oldContent":"                  },"},{"type":"DELETE","lineNumber":254,"oldContent":"                  decoration: const InputDecoration("},{"type":"DELETE","lineNumber":255,"oldContent":"                    labelText: 'Phone Number (Optional)',"},{"type":"DELETE","lineNumber":256,"oldContent":"                    prefixIcon: Icon(Icons.phone_outlined),"},{"type":"DELETE","lineNumber":257,"oldContent":"                // Confirm Password field"},{"type":"DELETE","lineNumber":258,"oldContent":"                    border: OutlineInputBorder(),"},{"type":"DELETE","lineNumber":259,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":260,"oldContent":"                    // Format phone number as user types"},{"type":"DELETE","lineNumber":261,"oldContent":"                  controller: _confirmPasswordController,"},{"type":"DELETE","lineNumber":262,"oldContent":"                    if (value.length == 1 && value != '+') {"},{"type":"DELETE","lineNumber":263,"oldContent":"                  obscureText: _obscureConfirmPassword,"},{"type":"DELETE","lineNumber":264,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":265,"oldContent":"                      _phoneController.text = '+$value';"},{"type":"DELETE","lineNumber":266,"oldContent":"                    labelText: 'Confirm Password',"},{"type":"DELETE","lineNumber":267,"oldContent":"                      _phoneController.selection = TextSelection.fromPosition("},{"type":"DELETE","lineNumber":268,"oldContent":"                    prefixIcon: const Icon(Icons.lock_outline),"},{"type":"DELETE","lineNumber":269,"oldContent":"                        TextPosition(offset: _phoneController.text.length),"},{"type":"DELETE","lineNumber":270,"oldContent":"                    suffixIcon: IconButton("},{"type":"DELETE","lineNumber":271,"oldContent":"                      );"},{"type":"DELETE","lineNumber":272,"oldContent":"                      icon: Icon("},{"type":"DELETE","lineNumber":273,"oldContent":"                    }"},{"type":"DELETE","lineNumber":274,"oldContent":"                  },"},{"type":"DELETE","lineNumber":275,"oldContent":"                            : Icons.visibility_off_outlined,"},{"type":"DELETE","lineNumber":276,"oldContent":"                ),"},{"type":"DELETE","lineNumber":277,"oldContent":"                        _obscurePassword"},{"type":"DELETE","lineNumber":278,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":279,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":280,"oldContent":"                    border: const OutlineInputBorder(),"},{"type":"DELETE","lineNumber":281,"oldContent":"                ),"},{"type":"DELETE","lineNumber":282,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":283,"oldContent":"                    }"},{"type":"DELETE","lineNumber":284,"oldContent":"                        _obscureConfirmPassword"},{"type":"DELETE","lineNumber":285,"oldContent":"                    if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":286,"oldContent":"                            ? Icons.visibility_outlined"},{"type":"DELETE","lineNumber":287,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":288,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":289,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":290,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":291,"oldContent":"                            color: Colors.black,"},{"type":"DELETE","lineNumber":292,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":293,"oldContent":"                            size: 24,"},{"type":"DELETE","lineNumber":294,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":295,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":296,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":297,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":298,"oldContent":"                      return 'Please confirm your password';"},{"type":"DELETE","lineNumber":299,"oldContent":"                      return 'Passwords do not match';"},{"type":"DELETE","lineNumber":300,"oldContent":"                    }"},{"type":"DELETE","lineNumber":301,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":302,"oldContent":"                        borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":303,"oldContent":"                  },"},{"type":"DELETE","lineNumber":304,"oldContent":"                ),"},{"type":"DELETE","lineNumber":305,"oldContent":"                // Register button"},{"type":"DELETE","lineNumber":306,"oldContent":"                SizedBox("},{"type":"DELETE","lineNumber":307,"oldContent":"                  width: double.infinity,"},{"type":"DELETE","lineNumber":308,"oldContent":"                  child: ElevatedButton("},{"type":"DELETE","lineNumber":309,"oldContent":"                    onPressed: _isLoading ? null : _register,"},{"type":"DELETE","lineNumber":310,"oldContent":"                    style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":311,"oldContent":"                      padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":312,"oldContent":"                              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),"},{"type":"DELETE","lineNumber":313,"oldContent":"                      shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":314,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":315,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":316,"oldContent":"                    child: _isLoading"},{"type":"DELETE","lineNumber":317,"oldContent":"                        ? const SizedBox("},{"type":"DELETE","lineNumber":318,"oldContent":"                            height: 20,"},{"type":"DELETE","lineNumber":319,"oldContent":"                            width: 20,"},{"type":"DELETE","lineNumber":320,"oldContent":""},{"type":"INSERT","lineNumber":210,"content":"              ),"},{"type":"INSERT","lineNumber":211,"content":"            ],"},{"type":"INSERT","lineNumber":212,"content":"          ),"},{"type":"INSERT","lineNumber":213,"content":"        ),"},{"type":"INSERT","lineNumber":214,"content":"      ),"},{"type":"INSERT","lineNumber":215,"content":"    );"},{"type":"DELETE","lineNumber":322,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":323,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":324,"oldContent":"                          )"},{"type":"DELETE","lineNumber":325,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":326,"oldContent":"                        : const Text('Create Account'),"},{"type":"DELETE","lineNumber":327,"oldContent":"                    const Text(\"Already have an account?\"),"},{"type":"DELETE","lineNumber":328,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":329,"oldContent":"                    TextButton("},{"type":"DELETE","lineNumber":330,"oldContent":"                ),"},{"type":"DELETE","lineNumber":331,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":332,"oldContent":"                "},{"type":"DELETE","lineNumber":333,"oldContent":"                // Login link"},{"type":"DELETE","lineNumber":334,"oldContent":"                Row("},{"type":"DELETE","lineNumber":335,"oldContent":"                      onPressed: () {"},{"type":"DELETE","lineNumber":336,"oldContent":"                        Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":337,"oldContent":"                          context,"},{"type":"DELETE","lineNumber":338,"oldContent":"                          AppConstants.loginRoute,"},{"type":"DELETE","lineNumber":339,"oldContent":"                        );"},{"type":"DELETE","lineNumber":340,"oldContent":"                ),"},{"type":"DELETE","lineNumber":341,"oldContent":"                  ],"},{"type":"INSERT","lineNumber":217,"content":""},{"type":"INSERT","lineNumber":218,"content":"  Widget _buildStep(int number, String title, bool isActive) {"},{"type":"INSERT","lineNumber":219,"content":"    return Column("},{"type":"INSERT","lineNumber":220,"content":"      children: ["},{"type":"INSERT","lineNumber":221,"content":"        Container("},{"type":"INSERT","lineNumber":222,"content":"          width: 32,"},{"type":"INSERT","lineNumber":223,"content":"          height: 32,"},{"type":"INSERT","lineNumber":224,"content":"          decoration: BoxDecoration("},{"type":"INSERT","lineNumber":225,"content":"            color: isActive ? const Color(0xFFFF6B35) : const Color(0xFFE0E0E0),"},{"type":"INSERT","lineNumber":226,"content":"            shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":227,"content":"          ),"},{"type":"INSERT","lineNumber":228,"content":"          child: Center("},{"type":"INSERT","lineNumber":229,"content":"            child: Text("},{"type":"INSERT","lineNumber":230,"content":"              '$number',"},{"type":"INSERT","lineNumber":231,"content":"              style: const TextStyle("},{"type":"INSERT","lineNumber":232,"content":"                color: Colors.white,"},{"type":"INSERT","lineNumber":233,"content":"                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":234,"content":"              ),"},{"type":"INSERT","lineNumber":235,"content":"            ),"},{"type":"INSERT","lineNumber":236,"content":"          ),"},{"type":"INSERT","lineNumber":237,"content":"        ),"},{"type":"INSERT","lineNumber":238,"content":"        const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":239,"content":"        Text("},{"type":"INSERT","lineNumber":240,"content":"          title,"},{"type":"INSERT","lineNumber":241,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":242,"content":"            color: isActive ? const Color(0xFFFF6B35) : const Color(0xFF999999),"},{"type":"INSERT","lineNumber":243,"content":"            fontSize: 12,"},{"type":"INSERT","lineNumber":244,"content":"            fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":245,"content":"          ),"},{"type":"INSERT","lineNumber":246,"content":"        ),"},{"type":"INSERT","lineNumber":247,"content":"      ],"},{"type":"DELETE","lineNumber":343,"oldContent":"      ),"},{"type":"INSERT","lineNumber":249,"content":"  }"},{"type":"INSERT","lineNumber":250,"content":""},{"type":"INSERT","lineNumber":251,"content":"  Widget _buildStepOne() {"},{"type":"INSERT","lineNumber":252,"content":"    return Column("},{"type":"INSERT","lineNumber":253,"content":"      children: ["},{"type":"INSERT","lineNumber":254,"content":"        // Name Field"},{"type":"INSERT","lineNumber":255,"content":"        TextFormField("},{"type":"INSERT","lineNumber":256,"content":"          controller: _nameController,"},{"type":"INSERT","lineNumber":257,"content":"          decoration: InputDecoration("},{"type":"INSERT","lineNumber":258,"content":"            labelText: 'Name',"},{"type":"INSERT","lineNumber":259,"content":"            prefixIcon: const Icon(Icons.person_outline, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":260,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":261,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":262,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":263,"content":"            ),"},{"type":"INSERT","lineNumber":264,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":265,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":266,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":267,"content":"            ),"},{"type":"INSERT","lineNumber":268,"content":"            filled: true,"},{"type":"INSERT","lineNumber":269,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":271,"content":"          validator: (value) {"},{"type":"INSERT","lineNumber":272,"content":"            if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":273,"content":"              return 'Please enter your name';"},{"type":"INSERT","lineNumber":274,"content":"            }"},{"type":"INSERT","lineNumber":275,"content":"            return null;"},{"type":"INSERT","lineNumber":276,"content":"          },"},{"type":"INSERT","lineNumber":277,"content":"        ),"},{"type":"INSERT","lineNumber":278,"content":"        "},{"type":"INSERT","lineNumber":279,"content":"        const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":280,"content":"        "},{"type":"INSERT","lineNumber":281,"content":"        // Email Field"},{"type":"INSERT","lineNumber":282,"content":"        TextFormField("},{"type":"INSERT","lineNumber":283,"content":"          controller: _emailController,"},{"type":"INSERT","lineNumber":284,"content":"          decoration: InputDecoration("},{"type":"INSERT","lineNumber":285,"content":"            labelText: 'Email Address',"},{"type":"INSERT","lineNumber":286,"content":"            prefixIcon: const Icon(Icons.email_outlined, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":287,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":288,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":289,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":290,"content":"            ),"},{"type":"INSERT","lineNumber":291,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":292,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":293,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":294,"content":"            ),"},{"type":"INSERT","lineNumber":295,"content":"            filled: true,"},{"type":"INSERT","lineNumber":296,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":297,"content":"          ),"},{"type":"INSERT","lineNumber":298,"content":"          keyboardType: TextInputType.emailAddress,"},{"type":"INSERT","lineNumber":299,"content":"          validator: (value) {"},{"type":"INSERT","lineNumber":300,"content":"            if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":301,"content":"              return 'Please enter your email';"},{"type":"INSERT","lineNumber":302,"content":"            }"},{"type":"INSERT","lineNumber":303,"content":"            if (!RegExp(r'^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$').hasMatch(value)) {"},{"type":"INSERT","lineNumber":304,"content":"              return 'Please enter a valid email';"},{"type":"INSERT","lineNumber":305,"content":"            }"},{"type":"INSERT","lineNumber":306,"content":"            return null;"},{"type":"INSERT","lineNumber":307,"content":"          },"},{"type":"INSERT","lineNumber":308,"content":"        ),"},{"type":"INSERT","lineNumber":309,"content":"        "},{"type":"INSERT","lineNumber":310,"content":"        const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":311,"content":"        "},{"type":"INSERT","lineNumber":312,"content":"        // Phone Number Field"},{"type":"INSERT","lineNumber":313,"content":"        TextFormField("},{"type":"INSERT","lineNumber":314,"content":"          controller: _phoneController,"},{"type":"INSERT","lineNumber":315,"content":"          decoration: InputDecoration("},{"type":"INSERT","lineNumber":316,"content":"            labelText: 'Mobile Number',"},{"type":"INSERT","lineNumber":317,"content":"            prefixIcon: const Icon(Icons.phone_android_outlined, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":318,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":319,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":320,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":321,"content":"            ),"},{"type":"INSERT","lineNumber":322,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":323,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":324,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":325,"content":"            ),"},{"type":"INSERT","lineNumber":326,"content":"            filled: true,"},{"type":"INSERT","lineNumber":327,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":328,"content":"          ),"},{"type":"INSERT","lineNumber":329,"content":"          keyboardType: TextInputType.phone,"},{"type":"INSERT","lineNumber":330,"content":"          validator: (value) {"},{"type":"INSERT","lineNumber":331,"content":"            if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":332,"content":"              return 'Please enter your mobile number';"},{"type":"INSERT","lineNumber":333,"content":"            }"},{"type":"INSERT","lineNumber":334,"content":"            if (!RegExp(r'^[0-9]{10,15}$').hasMatch(value)) {"},{"type":"INSERT","lineNumber":335,"content":"              return 'Please enter a valid mobile number';"},{"type":"INSERT","lineNumber":336,"content":"            }"},{"type":"INSERT","lineNumber":337,"content":"            return null;"},{"type":"INSERT","lineNumber":338,"content":"          },"},{"type":"INSERT","lineNumber":339,"content":"        ),"},{"type":"INSERT","lineNumber":340,"content":"      ],"},{"type":"INSERT","lineNumber":341,"content":"    );"},{"type":"INSERT","lineNumber":343,"content":""},{"type":"INSERT","lineNumber":344,"content":"  Widget _buildStepTwo() {"},{"type":"INSERT","lineNumber":345,"content":"    return Column("},{"type":"INSERT","lineNumber":346,"content":"      children: ["},{"type":"INSERT","lineNumber":347,"content":"        // Password Field"},{"type":"INSERT","lineNumber":348,"content":"        TextFormField("},{"type":"INSERT","lineNumber":349,"content":"          controller: _passwordController,"},{"type":"INSERT","lineNumber":350,"content":"          obscureText: _obscurePassword,"},{"type":"INSERT","lineNumber":351,"content":"          decoration: InputDecoration("},{"type":"INSERT","lineNumber":352,"content":"            labelText: 'Password',"},{"type":"INSERT","lineNumber":353,"content":"            prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":354,"content":"            suffixIcon: IconButton("},{"type":"INSERT","lineNumber":355,"content":"              icon: Icon("},{"type":"INSERT","lineNumber":356,"content":"                _obscurePassword ? Icons.visibility_off : Icons.visibility,"},{"type":"INSERT","lineNumber":357,"content":"                color: const Color(0xFF757575),"},{"type":"INSERT","lineNumber":358,"content":"              ),"},{"type":"INSERT","lineNumber":359,"content":"              onPressed: () {"},{"type":"INSERT","lineNumber":360,"content":"                setState(() {"},{"type":"INSERT","lineNumber":361,"content":"                  _obscurePassword = !_obscurePassword;"},{"type":"INSERT","lineNumber":362,"content":"                });"},{"type":"INSERT","lineNumber":363,"content":"              },"},{"type":"INSERT","lineNumber":364,"content":"            ),"},{"type":"INSERT","lineNumber":365,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":366,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":367,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":368,"content":"            ),"},{"type":"INSERT","lineNumber":369,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":370,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":371,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":372,"content":"            ),"},{"type":"INSERT","lineNumber":373,"content":"            filled: true,"},{"type":"INSERT","lineNumber":374,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":375,"content":"          ),"},{"type":"INSERT","lineNumber":376,"content":"          validator: (value) {"},{"type":"INSERT","lineNumber":377,"content":"            if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":378,"content":"              return 'Please enter a password';"},{"type":"INSERT","lineNumber":379,"content":"            }"},{"type":"INSERT","lineNumber":380,"content":"            if (value.length < 6) {"},{"type":"INSERT","lineNumber":381,"content":"              return 'Password must be at least 6 characters';"},{"type":"INSERT","lineNumber":382,"content":"            }"},{"type":"INSERT","lineNumber":383,"content":"            return null;"},{"type":"INSERT","lineNumber":384,"content":"          },"},{"type":"DELETE","lineNumber":347,"oldContent":"                    const Text(\"Already have an account?\"),"},{"type":"DELETE","lineNumber":348,"oldContent":"                  children: ["},{"type":"INSERT","lineNumber":386,"content":"        "},{"type":"INSERT","lineNumber":387,"content":"        const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":388,"content":"        "},{"type":"INSERT","lineNumber":389,"content":"        // Confirm Password Field"},{"type":"INSERT","lineNumber":390,"content":"        TextFormField("},{"type":"INSERT","lineNumber":391,"content":"          controller: _confirmPasswordController,"},{"type":"INSERT","lineNumber":392,"content":"          obscureText: _obscureConfirmPassword,"},{"type":"INSERT","lineNumber":393,"content":"          decoration: InputDecoration("},{"type":"INSERT","lineNumber":394,"content":"            labelText: 'Confirm Password',"},{"type":"INSERT","lineNumber":395,"content":"            prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":396,"content":"            suffixIcon: IconButton("},{"type":"INSERT","lineNumber":397,"content":"              icon: Icon("},{"type":"INSERT","lineNumber":398,"content":"                _obscureConfirmPassword ? Icons.visibility_off : Icons.visibility,"},{"type":"INSERT","lineNumber":399,"content":"                color: const Color(0xFF757575),"},{"type":"INSERT","lineNumber":400,"content":"              ),"},{"type":"INSERT","lineNumber":401,"content":"              onPressed: () {"},{"type":"INSERT","lineNumber":402,"content":"                setState(() {"},{"type":"INSERT","lineNumber":403,"content":"                  _obscureConfirmPassword = !_obscureConfirmPassword;"},{"type":"INSERT","lineNumber":404,"content":"                });"},{"type":"INSERT","lineNumber":405,"content":"              },"},{"type":"INSERT","lineNumber":406,"content":"            ),"},{"type":"INSERT","lineNumber":407,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":408,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":409,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":410,"content":"            ),"},{"type":"INSERT","lineNumber":411,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":412,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":413,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":414,"content":"            ),"},{"type":"INSERT","lineNumber":415,"content":"            filled: true,"},{"type":"INSERT","lineNumber":416,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":417,"content":"          ),"},{"type":"INSERT","lineNumber":418,"content":"          validator: (value) {"},{"type":"INSERT","lineNumber":419,"content":"            if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":420,"content":"              return 'Please confirm your password';"},{"type":"INSERT","lineNumber":421,"content":"            }"},{"type":"INSERT","lineNumber":422,"content":"            if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":423,"content":"              return 'Passwords do not match';"},{"type":"INSERT","lineNumber":424,"content":"            }"},{"type":"INSERT","lineNumber":425,"content":"            return null;"},{"type":"INSERT","lineNumber":426,"content":"          },"},{"type":"INSERT","lineNumber":427,"content":"        ),"},{"type":"INSERT","lineNumber":428,"content":"        "},{"type":"INSERT","lineNumber":429,"content":"        const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":430,"content":"        "},{"type":"INSERT","lineNumber":431,"content":"        // Password Requirements"},{"type":"INSERT","lineNumber":432,"content":"        Column("},{"type":"INSERT","lineNumber":433,"content":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":434,"content":"          children: ["},{"type":"INSERT","lineNumber":435,"content":"            Text("},{"type":"INSERT","lineNumber":436,"content":"              'Password must contain:',"},{"type":"INSERT","lineNumber":437,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":438,"content":"                color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":439,"content":"                fontSize: 12,"},{"type":"INSERT","lineNumber":440,"content":"              ),"},{"type":"INSERT","lineNumber":441,"content":"            ),"},{"type":"INSERT","lineNumber":442,"content":"            const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":443,"content":"            _buildRequirement('At least 6 characters', _passwordController.text.length >= 6),"},{"type":"INSERT","lineNumber":444,"content":"            _buildRequirement('At least one uppercase letter', _passwordController.text.contains(RegExp(r'[A-Z]'))),"},{"type":"INSERT","lineNumber":445,"content":"            _buildRequirement('At least one number', _passwordController.text.contains(RegExp(r'[0-9]'))),"},{"type":"INSERT","lineNumber":446,"content":"          ],"},{"type":"INSERT","lineNumber":447,"content":"        ),"},{"type":"INSERT","lineNumber":448,"content":"      ],"},{"type":"INSERT","lineNumber":451,"content":""},{"type":"INSERT","lineNumber":452,"content":"  Widget _buildRequirement(String text, bool isMet) {"},{"type":"INSERT","lineNumber":453,"content":"    return Padding("},{"type":"INSERT","lineNumber":454,"content":"      padding: const EdgeInsets.symmetric(vertical: 2.0),"},{"type":"INSERT","lineNumber":455,"content":"      child: Row("},{"type":"INSERT","lineNumber":456,"content":"        children: ["},{"type":"INSERT","lineNumber":457,"content":"          Icon("},{"type":"INSERT","lineNumber":458,"content":"            isMet ? Icons.check_circle : Icons.radio_button_unchecked,"},{"type":"INSERT","lineNumber":459,"content":"            size: 16,"},{"type":"INSERT","lineNumber":460,"content":"            color: isMet ? const Color(0xFF4CAF50) : const Color(0xFF9E9E9E),"},{"type":"INSERT","lineNumber":461,"content":"          ),"},{"type":"INSERT","lineNumber":462,"content":"          const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":463,"content":"          Text("},{"type":"INSERT","lineNumber":464,"content":"            text,"},{"type":"INSERT","lineNumber":465,"content":"            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":466,"content":"              color: isMet ? const Color(0xFF4CAF50) : const Color(0xFF9E9E9E),"},{"type":"INSERT","lineNumber":467,"content":"              fontSize: 12,"},{"type":"INSERT","lineNumber":468,"content":"            ),"},{"type":"INSERT","lineNumber":469,"content":"          ),"},{"type":"INSERT","lineNumber":470,"content":"        ],"},{"type":"INSERT","lineNumber":471,"content":"      ),"},{"type":"INSERT","lineNumber":472,"content":"    );"},{"type":"INSERT","lineNumber":473,"content":"  }"}]},{"timestamp":1754638502608,"changes":[{"type":"INSERT","lineNumber":4,"content":"import 'login_screen.dart';"},{"type":"INSERT","lineNumber":6,"content":"class RegisterScreen extends StatefulWidget {"},{"type":"DELETE","lineNumber":6,"oldContent":"  const RegisterScreen({super.key});"},{"type":"INSERT","lineNumber":9,"content":"  @override"},{"type":"DELETE","lineNumber":9,"oldContent":"  State<RegisterScreen> createState() => _RegisterScreenState();"},{"type":"DELETE","lineNumber":13,"oldContent":"  final _nameController = TextEditingController();"},{"type":"INSERT","lineNumber":15,"content":"  final _nameController = TextEditingController();"},{"type":"INSERT","lineNumber":26,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":27,"content":"    _nameController.dispose();"},{"type":"INSERT","lineNumber":28,"content":"    _emailController.dispose();"},{"type":"INSERT","lineNumber":29,"content":"    _phoneController.dispose();"},{"type":"INSERT","lineNumber":30,"content":"    _passwordController.dispose();"},{"type":"INSERT","lineNumber":31,"content":"    _confirmPasswordController.dispose();"},{"type":"INSERT","lineNumber":32,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":33,"content":"  }"},{"type":"INSERT","lineNumber":34,"content":""},{"type":"DELETE","lineNumber":30,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":32,"oldContent":"    _nameController.dispose();"},{"type":"DELETE","lineNumber":33,"oldContent":"    _emailController.dispose();"},{"type":"DELETE","lineNumber":34,"oldContent":"    _phoneController.dispose();"},{"type":"INSERT","lineNumber":41,"content":"      }"},{"type":"INSERT","lineNumber":42,"content":"    }"},{"type":"DELETE","lineNumber":36,"oldContent":"    _passwordController.dispose();"},{"type":"DELETE","lineNumber":37,"oldContent":"    _confirmPasswordController.dispose();"},{"type":"INSERT","lineNumber":44,"content":""},{"type":"DELETE","lineNumber":40,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":42,"oldContent":"  }"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"DELETE","lineNumber":47,"oldContent":"      Navigator.pop(context);"},{"type":"INSERT","lineNumber":51,"content":"      // If it's the first time (no arguments), just pop"},{"type":"INSERT","lineNumber":52,"content":"      // Otherwise, navigate back to login with flag"},{"type":"INSERT","lineNumber":53,"content":"      final isFirstTime = ModalRoute.of(context)?.settings.arguments as bool? ?? true;"},{"type":"INSERT","lineNumber":54,"content":"      if (isFirstTime) {"},{"type":"INSERT","lineNumber":55,"content":"        Navigator.pop(context);"},{"type":"INSERT","lineNumber":56,"content":"      } else {"},{"type":"INSERT","lineNumber":57,"content":"        Navigator.pushReplacement("},{"type":"INSERT","lineNumber":58,"content":"          context,"},{"type":"INSERT","lineNumber":59,"content":"          MaterialPageRoute("},{"type":"INSERT","lineNumber":60,"content":"            builder: (context) => const LoginScreen(),"},{"type":"INSERT","lineNumber":61,"content":"          ),"},{"type":"INSERT","lineNumber":62,"content":"        );"},{"type":"INSERT","lineNumber":63,"content":"      }"},{"type":"INSERT","lineNumber":64,"content":"    }"},{"type":"INSERT","lineNumber":65,"content":"  }"},{"type":"INSERT","lineNumber":66,"content":""},{"type":"DELETE","lineNumber":50,"oldContent":"      }"},{"type":"DELETE","lineNumber":53,"oldContent":"    }"},{"type":"DELETE","lineNumber":55,"oldContent":""},{"type":"INSERT","lineNumber":78,"content":"  }"},{"type":"INSERT","lineNumber":79,"content":""},{"type":"INSERT","lineNumber":80,"content":"  @override"},{"type":"INSERT","lineNumber":81,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":82,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":83,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":84,"content":"        leading: IconButton("},{"type":"INSERT","lineNumber":87,"content":"        ),"},{"type":"DELETE","lineNumber":69,"oldContent":"                      onPressed: () => Navigator.pop(context),"},{"type":"DELETE","lineNumber":71,"oldContent":"                    const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":97,"content":"      ),"},{"type":"INSERT","lineNumber":125,"content":"                      ),"},{"type":"INSERT","lineNumber":139,"content":"                  child: Column("},{"type":"INSERT","lineNumber":140,"content":"                    children: ["},{"type":"DELETE","lineNumber":122,"oldContent":"    }"},{"type":"DELETE","lineNumber":124,"oldContent":"  }"},{"type":"DELETE","lineNumber":127,"oldContent":""},{"type":"DELETE","lineNumber":130,"oldContent":"  @override"},{"type":"DELETE","lineNumber":133,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":136,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":138,"oldContent":"      appBar: AppBar("},{"type":"DELETE","lineNumber":141,"oldContent":"        leading: IconButton("},{"type":"DELETE","lineNumber":145,"oldContent":"        ),"},{"type":"DELETE","lineNumber":147,"oldContent":"      ),"},{"type":"DELETE","lineNumber":150,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":158,"oldContent":"                  child: Column("},{"type":"DELETE","lineNumber":160,"oldContent":"                    children: ["},{"type":"INSERT","lineNumber":180,"content":"                            ),"},{"type":"INSERT","lineNumber":183,"content":"                      ),"},{"type":"DELETE","lineNumber":173,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":175,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":196,"content":"                            ),"},{"type":"DELETE","lineNumber":185,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":187,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":189,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":191,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":206,"oldContent":"                ),"},{"type":"INSERT","lineNumber":217,"content":"                      ),"},{"type":"INSERT","lineNumber":220,"content":"                    ],"},{"type":"INSERT","lineNumber":221,"content":"                  ),"},{"type":"INSERT","lineNumber":222,"content":"                ),"},{"type":"INSERT","lineNumber":229,"content":"  }"},{"type":"INSERT","lineNumber":261,"content":"    );"},{"type":"INSERT","lineNumber":283,"content":"          ),"},{"type":"DELETE","lineNumber":319,"oldContent":"                          context,"},{"type":"DELETE","lineNumber":340,"oldContent":"      ),"},{"type":"INSERT","lineNumber":355,"content":"  }"},{"type":"DELETE","lineNumber":343,"oldContent":"          ),"},{"type":"DELETE","lineNumber":345,"oldContent":"                    TextButton("},{"type":"DELETE","lineNumber":347,"oldContent":"        ),"},{"type":"DELETE","lineNumber":351,"oldContent":"    );"},{"type":"DELETE","lineNumber":353,"oldContent":""},{"type":"DELETE","lineNumber":355,"oldContent":"}"},{"type":"DELETE","lineNumber":357,"oldContent":"  }"},{"type":"DELETE","lineNumber":359,"oldContent":"    );"},{"type":"DELETE","lineNumber":361,"oldContent":"      ),"},{"type":"DELETE","lineNumber":363,"oldContent":"        ],"},{"type":"DELETE","lineNumber":365,"oldContent":"          ),"},{"type":"DELETE","lineNumber":367,"oldContent":"            ),"},{"type":"DELETE","lineNumber":369,"oldContent":"              fontSize: 12,"},{"type":"DELETE","lineNumber":371,"oldContent":"              color: isMet ? const Color(0xFF4CAF50) : const Color(0xFF9E9E9E),"},{"type":"DELETE","lineNumber":373,"oldContent":"            style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":375,"oldContent":"            text,"},{"type":"DELETE","lineNumber":377,"oldContent":"          Text("},{"type":"DELETE","lineNumber":379,"oldContent":"          const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":381,"oldContent":"          ),"},{"type":"DELETE","lineNumber":383,"oldContent":"            color: isMet ? const Color(0xFF4CAF50) : const Color(0xFF9E9E9E),"},{"type":"DELETE","lineNumber":385,"oldContent":"            size: 16,"},{"type":"DELETE","lineNumber":387,"oldContent":"            isMet ? Icons.check_circle : Icons.radio_button_unchecked,"},{"type":"DELETE","lineNumber":389,"oldContent":"          Icon("},{"type":"DELETE","lineNumber":391,"oldContent":"        children: ["},{"type":"DELETE","lineNumber":393,"oldContent":"      child: Row("},{"type":"DELETE","lineNumber":395,"oldContent":"      padding: const EdgeInsets.symmetric(vertical: 2.0),"},{"type":"DELETE","lineNumber":397,"oldContent":"    return Padding("},{"type":"DELETE","lineNumber":399,"oldContent":"  Widget _buildRequirement(String text, bool isMet) {"},{"type":"DELETE","lineNumber":401,"oldContent":""},{"type":"DELETE","lineNumber":403,"oldContent":"      ],"},{"type":"DELETE","lineNumber":405,"oldContent":"        ),"},{"type":"DELETE","lineNumber":407,"oldContent":"          ],"},{"type":"DELETE","lineNumber":409,"oldContent":"            _buildRequirement('At least one number', _passwordController.text.contains(RegExp(r'[0-9]'))),"},{"type":"DELETE","lineNumber":411,"oldContent":"            _buildRequirement('At least one uppercase letter', _passwordController.text.contains(RegExp(r'[A-Z]'))),"},{"type":"DELETE","lineNumber":413,"oldContent":"            _buildRequirement('At least 6 characters', _passwordController.text.length >= 6),"},{"type":"DELETE","lineNumber":415,"oldContent":"            const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":417,"oldContent":"            ),"},{"type":"DELETE","lineNumber":419,"oldContent":"              ),"},{"type":"DELETE","lineNumber":421,"oldContent":"                fontSize: 12,"},{"type":"DELETE","lineNumber":422,"oldContent":"                color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":398,"content":"        ),"},{"type":"DELETE","lineNumber":424,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":426,"oldContent":"              'Password must contain:',"},{"type":"DELETE","lineNumber":428,"oldContent":"            Text("},{"type":"DELETE","lineNumber":430,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":432,"oldContent":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":434,"oldContent":"        Column("},{"type":"DELETE","lineNumber":436,"oldContent":"        // Password Requirements"},{"type":"DELETE","lineNumber":438,"oldContent":"        "},{"type":"DELETE","lineNumber":440,"oldContent":"        const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":442,"oldContent":"        "},{"type":"DELETE","lineNumber":444,"oldContent":"        ),"},{"type":"DELETE","lineNumber":446,"oldContent":"          },"},{"type":"DELETE","lineNumber":448,"oldContent":"            return null;"},{"type":"DELETE","lineNumber":450,"oldContent":"            }"},{"type":"DELETE","lineNumber":452,"oldContent":"              return 'Passwords do not match';"},{"type":"DELETE","lineNumber":454,"oldContent":"            if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":456,"oldContent":"            }"},{"type":"DELETE","lineNumber":458,"oldContent":"              return 'Please confirm your password';"},{"type":"DELETE","lineNumber":460,"oldContent":"            if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":462,"oldContent":"          validator: (value) {"},{"type":"DELETE","lineNumber":464,"oldContent":"          ),"},{"type":"DELETE","lineNumber":466,"oldContent":"            fillColor: Colors.white,"},{"type":"DELETE","lineNumber":468,"oldContent":"            filled: true,"},{"type":"DELETE","lineNumber":471,"oldContent":"            ),"},{"type":"DELETE","lineNumber":472,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":426,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":427,"content":"            ),"},{"type":"INSERT","lineNumber":428,"content":"            filled: true,"},{"type":"INSERT","lineNumber":429,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":430,"content":"          ),"},{"type":"INSERT","lineNumber":431,"content":"          validator: (value) {"},{"type":"INSERT","lineNumber":432,"content":"            if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":433,"content":"              return 'Please confirm your password';"},{"type":"INSERT","lineNumber":434,"content":"            }"},{"type":"INSERT","lineNumber":435,"content":"            if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":436,"content":"              return 'Passwords do not match';"},{"type":"INSERT","lineNumber":437,"content":"            }"},{"type":"INSERT","lineNumber":438,"content":"            return null;"},{"type":"INSERT","lineNumber":439,"content":"          },"},{"type":"INSERT","lineNumber":440,"content":"        ),"},{"type":"INSERT","lineNumber":441,"content":"        "},{"type":"INSERT","lineNumber":442,"content":"        const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":443,"content":"        "},{"type":"INSERT","lineNumber":444,"content":"        // Password Requirements"},{"type":"INSERT","lineNumber":445,"content":"        Column("},{"type":"INSERT","lineNumber":446,"content":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":447,"content":"          children: ["},{"type":"INSERT","lineNumber":448,"content":"            Text("},{"type":"INSERT","lineNumber":449,"content":"              'Password must contain:',"},{"type":"INSERT","lineNumber":450,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":451,"content":"                color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":452,"content":"                fontSize: 12,"},{"type":"INSERT","lineNumber":453,"content":"              ),"},{"type":"INSERT","lineNumber":454,"content":"            ),"},{"type":"INSERT","lineNumber":455,"content":"            const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":456,"content":"            _buildRequirement('At least 6 characters', _passwordController.text.length >= 6),"},{"type":"INSERT","lineNumber":457,"content":"            _buildRequirement('At least one uppercase letter', _passwordController.text.contains(RegExp(r'[A-Z]'))),"},{"type":"INSERT","lineNumber":458,"content":"            _buildRequirement('At least one number', _passwordController.text.contains(RegExp(r'[0-9]'))),"},{"type":"INSERT","lineNumber":459,"content":"          ],"},{"type":"INSERT","lineNumber":460,"content":"        ),"},{"type":"INSERT","lineNumber":461,"content":"      ],"},{"type":"INSERT","lineNumber":462,"content":"    );"},{"type":"INSERT","lineNumber":463,"content":"  }"},{"type":"INSERT","lineNumber":464,"content":""},{"type":"INSERT","lineNumber":465,"content":"  Widget _buildRequirement(String text, bool isMet) {"},{"type":"INSERT","lineNumber":466,"content":"    return Padding("},{"type":"INSERT","lineNumber":467,"content":"      padding: const EdgeInsets.symmetric(vertical: 2.0),"},{"type":"INSERT","lineNumber":468,"content":"      child: Row("},{"type":"INSERT","lineNumber":469,"content":"        children: ["},{"type":"INSERT","lineNumber":470,"content":"          Icon("},{"type":"INSERT","lineNumber":471,"content":"            isMet ? Icons.check_circle : Icons.radio_button_unchecked,"},{"type":"INSERT","lineNumber":472,"content":"            size: 16,"},{"type":"INSERT","lineNumber":473,"content":"            color: isMet ? const Color(0xFF4CAF50) : const Color(0xFF9E9E9E),"},{"type":"INSERT","lineNumber":474,"content":"          ),"},{"type":"INSERT","lineNumber":475,"content":"          const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":476,"content":"          Text("},{"type":"INSERT","lineNumber":477,"content":"            text,"},{"type":"INSERT","lineNumber":478,"content":"            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":479,"content":"              color: isMet ? const Color(0xFF4CAF50) : const Color(0xFF9E9E9E),"},{"type":"INSERT","lineNumber":480,"content":"              fontSize: 12,"},{"type":"INSERT","lineNumber":481,"content":"            ),"},{"type":"INSERT","lineNumber":482,"content":"          ),"},{"type":"INSERT","lineNumber":483,"content":"        ],"},{"type":"INSERT","lineNumber":484,"content":"      ),"},{"type":"INSERT","lineNumber":485,"content":"    );"},{"type":"INSERT","lineNumber":486,"content":"  }"},{"type":"INSERT","lineNumber":487,"content":"}"},{"type":"INSERT","lineNumber":488,"content":""}]},{"timestamp":1754639135907,"changes":[{"type":"MODIFY","lineNumber":7,"content":"  const RegisterScreen({Key? key}) : super(key: key);","oldContent":"  const RegisterScreen({Key? key}) : super(key: key);"},{"type":"MODIFY","lineNumber":10,"content":"  _RegisterScreenState createState() => _RegisterScreenState();","oldContent":"  _RegisterScreenState createState() => _RegisterScreenState();"},{"type":"DELETE","lineNumber":26,"oldContent":"  void _onNextStep() {"},{"type":"DELETE","lineNumber":28,"oldContent":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"DELETE","lineNumber":30,"oldContent":"      if (_currentStep < 1) {"},{"type":"DELETE","lineNumber":32,"oldContent":"        setState(() {"},{"type":"DELETE","lineNumber":34,"oldContent":"          _currentStep++;"},{"type":"DELETE","lineNumber":37,"oldContent":"        });"},{"type":"INSERT","lineNumber":35,"content":"  void _onNextStep() {"},{"type":"INSERT","lineNumber":36,"content":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"INSERT","lineNumber":37,"content":"      if (_currentStep < 1) {"},{"type":"INSERT","lineNumber":38,"content":"        setState(() {"},{"type":"INSERT","lineNumber":39,"content":"          _currentStep++;"},{"type":"INSERT","lineNumber":40,"content":"        });"},{"type":"INSERT","lineNumber":41,"content":"      }"},{"type":"INSERT","lineNumber":42,"content":"    }"},{"type":"INSERT","lineNumber":44,"content":""},{"type":"DELETE","lineNumber":44,"oldContent":"      }"},{"type":"DELETE","lineNumber":46,"oldContent":"    }"},{"type":"DELETE","lineNumber":48,"oldContent":""},{"type":"DELETE","lineNumber":51,"oldContent":"  void _onRegister() {"},{"type":"DELETE","lineNumber":52,"oldContent":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"DELETE","lineNumber":54,"oldContent":"      context.read<AuthBloc>().add("},{"type":"DELETE","lineNumber":56,"oldContent":"            RegisterRequested("},{"type":"DELETE","lineNumber":59,"oldContent":"              name: _nameController.text.trim(),"},{"type":"DELETE","lineNumber":62,"oldContent":"              email: _emailController.text.trim(),"},{"type":"DELETE","lineNumber":64,"oldContent":"              phoneNumber: _phoneController.text.trim(),"},{"type":"DELETE","lineNumber":66,"oldContent":"              password: _passwordController.text.trim(),"},{"type":"DELETE","lineNumber":68,"oldContent":"            ),"},{"type":"DELETE","lineNumber":70,"oldContent":"          );"},{"type":"INSERT","lineNumber":62,"content":"        );"},{"type":"INSERT","lineNumber":63,"content":"      }"},{"type":"INSERT","lineNumber":65,"content":"  }"},{"type":"INSERT","lineNumber":66,"content":""},{"type":"INSERT","lineNumber":67,"content":"  void _onRegister() {"},{"type":"INSERT","lineNumber":68,"content":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"INSERT","lineNumber":69,"content":"      // Validate password requirements"},{"type":"INSERT","lineNumber":70,"content":"      final password = _passwordController.text.trim();"},{"type":"INSERT","lineNumber":71,"content":"      if (password.length < 6 || "},{"type":"INSERT","lineNumber":72,"content":"          !password.contains(RegExp(r'[A-Z]')) || "},{"type":"INSERT","lineNumber":73,"content":"          !password.contains(RegExp(r'[0-9]'))) {"},{"type":"INSERT","lineNumber":74,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":75,"content":"          const SnackBar(content: Text('Please ensure your password meets all requirements')),"},{"type":"DELETE","lineNumber":74,"oldContent":"          icon: const Icon(Icons.arrow_back_ios, color: Color(0xFF333333)),"},{"type":"INSERT","lineNumber":77,"content":"        return;"},{"type":"DELETE","lineNumber":76,"oldContent":"          onPressed: _onPreviousStep,"},{"type":"INSERT","lineNumber":79,"content":""},{"type":"INSERT","lineNumber":80,"content":"      // Validate password match"},{"type":"INSERT","lineNumber":81,"content":"      if (password != _confirmPasswordController.text.trim()) {"},{"type":"INSERT","lineNumber":82,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":83,"content":"          const SnackBar(content: Text('Passwords do not match')),"},{"type":"INSERT","lineNumber":84,"content":"        );"},{"type":"INSERT","lineNumber":85,"content":"        return;"},{"type":"INSERT","lineNumber":86,"content":"      }"},{"type":"INSERT","lineNumber":87,"content":""},{"type":"INSERT","lineNumber":88,"content":"      // All validations passed, proceed with registration"},{"type":"INSERT","lineNumber":89,"content":"      context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":90,"content":"            RegisterRequested("},{"type":"INSERT","lineNumber":91,"content":"              name: _nameController.text.trim(),"},{"type":"INSERT","lineNumber":92,"content":"              email: _emailController.text.trim(),"},{"type":"INSERT","lineNumber":93,"content":"              phoneNumber: _phoneController.text.trim(),"},{"type":"INSERT","lineNumber":94,"content":"              password: password,"},{"type":"INSERT","lineNumber":95,"content":"            ),"},{"type":"INSERT","lineNumber":96,"content":"          );"},{"type":"DELETE","lineNumber":78,"oldContent":"        title: Text("},{"type":"DELETE","lineNumber":80,"oldContent":"          'Create Account',"},{"type":"INSERT","lineNumber":100,"content":"  @override"},{"type":"INSERT","lineNumber":101,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":102,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":103,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":104,"content":"        leading: IconButton("},{"type":"INSERT","lineNumber":105,"content":"          icon: const Icon(Icons.arrow_back_ios, color: Color(0xFF333333)),"},{"type":"INSERT","lineNumber":106,"content":"          onPressed: _onPreviousStep,"},{"type":"INSERT","lineNumber":107,"content":"        ),"},{"type":"INSERT","lineNumber":108,"content":"        title: Text("},{"type":"INSERT","lineNumber":109,"content":"          'Create Account',"},{"type":"INSERT","lineNumber":117,"content":"      ),"},{"type":"DELETE","lineNumber":92,"oldContent":"  }"},{"type":"DELETE","lineNumber":93,"oldContent":"            // Navigate to home screen or verification screen"},{"type":"DELETE","lineNumber":94,"oldContent":""},{"type":"INSERT","lineNumber":121,"content":"            // Navigate to OTP verification screen"},{"type":"INSERT","lineNumber":122,"content":"            Navigator.pushReplacement("},{"type":"INSERT","lineNumber":123,"content":"              context,"},{"type":"INSERT","lineNumber":124,"content":"              MaterialPageRoute("},{"type":"INSERT","lineNumber":125,"content":"                builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":126,"content":"                  phoneNumber: _phoneController.text.trim(),"},{"type":"INSERT","lineNumber":127,"content":"                  verificationId: state.verificationId ?? '',"},{"type":"INSERT","lineNumber":128,"content":"                ),"},{"type":"INSERT","lineNumber":129,"content":"              ),"},{"type":"INSERT","lineNumber":130,"content":"            );"},{"type":"DELETE","lineNumber":96,"oldContent":"  @override"},{"type":"INSERT","lineNumber":132,"content":"            // Show error message"},{"type":"DELETE","lineNumber":98,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":99,"oldContent":"              SnackBar(content: Text(state.error ?? 'An error occurred')),"},{"type":"DELETE","lineNumber":100,"oldContent":"    return Scaffold("},{"type":"INSERT","lineNumber":134,"content":"              SnackBar("},{"type":"INSERT","lineNumber":135,"content":"                content: Text(state.error ?? 'Registration failed. Please try again.'),"},{"type":"INSERT","lineNumber":136,"content":"                duration: const Duration(seconds: 3),"},{"type":"INSERT","lineNumber":137,"content":"              ),"},{"type":"DELETE","lineNumber":102,"oldContent":"      appBar: AppBar("},{"type":"DELETE","lineNumber":104,"oldContent":"        leading: IconButton("},{"type":"DELETE","lineNumber":108,"oldContent":"        ),"},{"type":"DELETE","lineNumber":119,"oldContent":"      ),"},{"type":"INSERT","lineNumber":158,"content":"                      ),"},{"type":"INSERT","lineNumber":172,"content":"                  child: Column("},{"type":"INSERT","lineNumber":173,"content":"                    children: ["},{"type":"DELETE","lineNumber":146,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":156,"oldContent":"                  child: Column("},{"type":"DELETE","lineNumber":158,"oldContent":"                    children: ["},{"type":"INSERT","lineNumber":213,"content":"                            ),"},{"type":"INSERT","lineNumber":216,"content":"                      ),"},{"type":"DELETE","lineNumber":191,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":195,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":229,"content":"                            ),"},{"type":"DELETE","lineNumber":206,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":250,"content":"                      ),"},{"type":"INSERT","lineNumber":253,"content":"                    ],"},{"type":"INSERT","lineNumber":254,"content":"                  ),"},{"type":"INSERT","lineNumber":255,"content":"                ),"},{"type":"INSERT","lineNumber":262,"content":"  }"},{"type":"DELETE","lineNumber":226,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":230,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":232,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":234,"oldContent":"                ),"},{"type":"DELETE","lineNumber":242,"oldContent":"  }"},{"type":"INSERT","lineNumber":294,"content":"    );"},{"type":"DELETE","lineNumber":275,"oldContent":"    );"},{"type":"INSERT","lineNumber":316,"content":"          ),"},{"type":"DELETE","lineNumber":298,"oldContent":"          ),"},{"type":"INSERT","lineNumber":388,"content":"  }"},{"type":"DELETE","lineNumber":364,"oldContent":"  }"},{"type":"DELETE","lineNumber":386,"oldContent":"        ),"},{"type":"INSERT","lineNumber":429,"content":"            if (!value.contains(RegExp(r'[A-Z]'))) {"},{"type":"INSERT","lineNumber":430,"content":"              return 'Password must contain at least one uppercase letter';"},{"type":"INSERT","lineNumber":431,"content":"            }"},{"type":"INSERT","lineNumber":432,"content":"            if (!value.contains(RegExp(r'[0-9]'))) {"},{"type":"INSERT","lineNumber":433,"content":"              return 'Password must contain at least one number';"},{"type":"INSERT","lineNumber":434,"content":"            }"},{"type":"INSERT","lineNumber":437,"content":"        ),"},{"type":"INSERT","lineNumber":440,"content":"        "},{"type":"INSERT","lineNumber":441,"content":"        // Confirm Password Field"},{"type":"INSERT","lineNumber":442,"content":"        TextFormField("},{"type":"INSERT","lineNumber":443,"content":"          controller: _confirmPasswordController,"},{"type":"INSERT","lineNumber":444,"content":"          obscureText: _obscureConfirmPassword,"},{"type":"INSERT","lineNumber":445,"content":"          decoration: InputDecoration("},{"type":"INSERT","lineNumber":446,"content":"            labelText: 'Confirm Password',"},{"type":"INSERT","lineNumber":447,"content":"            prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":448,"content":"            suffixIcon: IconButton("},{"type":"INSERT","lineNumber":449,"content":"              icon: Icon("},{"type":"INSERT","lineNumber":450,"content":"                _obscureConfirmPassword ? Icons.visibility_off : Icons.visibility,"},{"type":"INSERT","lineNumber":451,"content":"                color: const Color(0xFF757575),"},{"type":"INSERT","lineNumber":452,"content":"              ),"},{"type":"INSERT","lineNumber":453,"content":"              onPressed: () {"},{"type":"INSERT","lineNumber":454,"content":"                setState(() {"},{"type":"INSERT","lineNumber":455,"content":"                  _obscureConfirmPassword = !_obscureConfirmPassword;"},{"type":"INSERT","lineNumber":456,"content":"                });"},{"type":"INSERT","lineNumber":457,"content":"              },"},{"type":"INSERT","lineNumber":458,"content":"            ),"},{"type":"INSERT","lineNumber":459,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":460,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":403,"oldContent":"        "},{"type":"INSERT","lineNumber":463,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":464,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":465,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":466,"content":"            ),"},{"type":"DELETE","lineNumber":406,"oldContent":"        // Confirm Password Field"},{"type":"DELETE","lineNumber":409,"oldContent":"        TextFormField("},{"type":"DELETE","lineNumber":412,"oldContent":"          controller: _confirmPasswordController,"},{"type":"DELETE","lineNumber":415,"oldContent":"          obscureText: _obscureConfirmPassword,"},{"type":"DELETE","lineNumber":418,"oldContent":"          decoration: InputDecoration("},{"type":"DELETE","lineNumber":421,"oldContent":"            labelText: 'Confirm Password',"},{"type":"DELETE","lineNumber":424,"oldContent":"            prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"DELETE","lineNumber":427,"oldContent":"            suffixIcon: IconButton("},{"type":"DELETE","lineNumber":430,"oldContent":"              icon: Icon("},{"type":"DELETE","lineNumber":433,"oldContent":"                _obscureConfirmPassword ? Icons.visibility_off : Icons.visibility,"},{"type":"DELETE","lineNumber":436,"oldContent":"                color: const Color(0xFF757575),"},{"type":"DELETE","lineNumber":439,"oldContent":"              ),"},{"type":"DELETE","lineNumber":442,"oldContent":"              onPressed: () {"},{"type":"DELETE","lineNumber":445,"oldContent":"                setState(() {"},{"type":"DELETE","lineNumber":448,"oldContent":"                  _obscureConfirmPassword = !_obscureConfirmPassword;"},{"type":"DELETE","lineNumber":451,"oldContent":"                });"},{"type":"DELETE","lineNumber":454,"oldContent":"              },"},{"type":"DELETE","lineNumber":457,"oldContent":"            ),"},{"type":"DELETE","lineNumber":460,"oldContent":"            border: OutlineInputBorder("},{"type":"DELETE","lineNumber":463,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":466,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":468,"oldContent":"            ),"},{"type":"DELETE","lineNumber":472,"oldContent":"            enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":474,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":476,"oldContent":""},{"type":"DELETE","lineNumber":478,"oldContent":"}"},{"type":"DELETE","lineNumber":480,"oldContent":"  }"},{"type":"DELETE","lineNumber":482,"oldContent":"    );"},{"type":"DELETE","lineNumber":484,"oldContent":"      ),"},{"type":"DELETE","lineNumber":486,"oldContent":"        ],"},{"type":"INSERT","lineNumber":522,"content":"        ],"},{"type":"INSERT","lineNumber":523,"content":"      ),"},{"type":"INSERT","lineNumber":524,"content":"    );"},{"type":"INSERT","lineNumber":525,"content":"  }"},{"type":"INSERT","lineNumber":526,"content":"}"},{"type":"INSERT","lineNumber":527,"content":""}]},{"timestamp":1754639151391,"changes":[{"type":"INSERT","lineNumber":5,"content":"import 'otp_verification_screen.dart';"},{"type":"INSERT","lineNumber":7,"content":"class RegisterScreen extends StatefulWidget {"},{"type":"DELETE","lineNumber":7,"oldContent":"  const RegisterScreen({Key? key}) : super(key: key);"},{"type":"INSERT","lineNumber":10,"content":"  @override"},{"type":"DELETE","lineNumber":10,"oldContent":"  _RegisterScreenState createState() => _RegisterScreenState();"},{"type":"DELETE","lineNumber":30,"oldContent":"  void _onNextStep() {"},{"type":"DELETE","lineNumber":32,"oldContent":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"INSERT","lineNumber":33,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":34,"content":"  }"},{"type":"INSERT","lineNumber":35,"content":""},{"type":"INSERT","lineNumber":36,"content":"  void _onNextStep() {"},{"type":"INSERT","lineNumber":37,"content":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"DELETE","lineNumber":36,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":38,"oldContent":"  }"},{"type":"DELETE","lineNumber":40,"oldContent":""},{"type":"DELETE","lineNumber":42,"oldContent":"  }"},{"type":"INSERT","lineNumber":44,"content":"  }"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"DELETE","lineNumber":46,"oldContent":""},{"type":"INSERT","lineNumber":58,"content":"        Navigator.pushReplacement("},{"type":"INSERT","lineNumber":59,"content":"          context,"},{"type":"INSERT","lineNumber":60,"content":"          MaterialPageRoute("},{"type":"INSERT","lineNumber":61,"content":"            builder: (context) => const LoginScreen(),"},{"type":"INSERT","lineNumber":62,"content":"          ),"},{"type":"DELETE","lineNumber":59,"oldContent":"        Navigator.pushReplacement("},{"type":"INSERT","lineNumber":65,"content":"    }"},{"type":"DELETE","lineNumber":61,"oldContent":"          context,"},{"type":"DELETE","lineNumber":64,"oldContent":"          MaterialPageRoute("},{"type":"DELETE","lineNumber":67,"oldContent":"            builder: (context) => const LoginScreen(),"},{"type":"DELETE","lineNumber":70,"oldContent":"          ),"},{"type":"DELETE","lineNumber":72,"oldContent":"    }"},{"type":"DELETE","lineNumber":74,"oldContent":"        );"},{"type":"MODIFY","lineNumber":77,"content":"        );","oldContent":"      }"},{"type":"MODIFY","lineNumber":79,"content":"      }","oldContent":"    }"},{"type":"DELETE","lineNumber":81,"oldContent":"  }"},{"type":"DELETE","lineNumber":84,"oldContent":""},{"type":"DELETE","lineNumber":86,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":88,"oldContent":"            color: const Color(0xFF333333),"},{"type":"DELETE","lineNumber":90,"oldContent":"            fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":92,"oldContent":"          ),"},{"type":"DELETE","lineNumber":94,"oldContent":"        ),"},{"type":"DELETE","lineNumber":96,"oldContent":"        backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":98,"oldContent":"        elevation: 0,"},{"type":"DELETE","lineNumber":100,"oldContent":"      body: BlocListener<AuthBloc, AuthState>("},{"type":"DELETE","lineNumber":102,"oldContent":"        listener: (context, state) {"},{"type":"DELETE","lineNumber":104,"oldContent":"          if (state.status == AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":109,"oldContent":"          } else if (state.status == AuthStatus.error) {"},{"type":"DELETE","lineNumber":111,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":98,"content":"    }"},{"type":"INSERT","lineNumber":99,"content":"  }"},{"type":"INSERT","lineNumber":100,"content":""},{"type":"DELETE","lineNumber":114,"oldContent":"            );"},{"type":"DELETE","lineNumber":117,"oldContent":"          }"},{"type":"DELETE","lineNumber":120,"oldContent":"        },"},{"type":"DELETE","lineNumber":122,"oldContent":"        child: SingleChildScrollView("},{"type":"DELETE","lineNumber":124,"oldContent":"          child: Column("},{"type":"INSERT","lineNumber":111,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":112,"content":"            color: const Color(0xFF333333),"},{"type":"INSERT","lineNumber":113,"content":"            fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":114,"content":"          ),"},{"type":"INSERT","lineNumber":115,"content":"        ),"},{"type":"INSERT","lineNumber":116,"content":"        backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":117,"content":"        elevation: 0,"},{"type":"INSERT","lineNumber":118,"content":"      ),"},{"type":"INSERT","lineNumber":119,"content":"      body: BlocListener<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":120,"content":"        listener: (context, state) {"},{"type":"INSERT","lineNumber":121,"content":"          if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":122,"content":"            // Navigate to OTP verification screen"},{"type":"INSERT","lineNumber":123,"content":"            Navigator.pushReplacement("},{"type":"INSERT","lineNumber":124,"content":"              context,"},{"type":"INSERT","lineNumber":125,"content":"              MaterialPageRoute("},{"type":"INSERT","lineNumber":126,"content":"                builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":127,"content":"                  phoneNumber: _phoneController.text.trim(),"},{"type":"INSERT","lineNumber":128,"content":"                  verificationId: state.verificationId ?? '',"},{"type":"INSERT","lineNumber":129,"content":"                ),"},{"type":"INSERT","lineNumber":130,"content":"              ),"},{"type":"INSERT","lineNumber":131,"content":"            );"},{"type":"INSERT","lineNumber":132,"content":"          } else if (state.status == AuthStatus.error) {"},{"type":"INSERT","lineNumber":133,"content":"            // Show error message"},{"type":"INSERT","lineNumber":134,"content":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":135,"content":"              SnackBar("},{"type":"INSERT","lineNumber":136,"content":"                content: Text(state.error ?? 'Registration failed. Please try again.'),"},{"type":"INSERT","lineNumber":137,"content":"                duration: const Duration(seconds: 3),"},{"type":"INSERT","lineNumber":138,"content":"              ),"},{"type":"INSERT","lineNumber":139,"content":"            );"},{"type":"INSERT","lineNumber":140,"content":"          }"},{"type":"INSERT","lineNumber":141,"content":"        },"},{"type":"INSERT","lineNumber":142,"content":"        child: SingleChildScrollView("},{"type":"INSERT","lineNumber":143,"content":"          child: Column("},{"type":"DELETE","lineNumber":135,"oldContent":"      ),"},{"type":"DELETE","lineNumber":139,"oldContent":"            // Navigate to OTP verification screen"},{"type":"DELETE","lineNumber":141,"oldContent":"            Navigator.pushReplacement("},{"type":"DELETE","lineNumber":143,"oldContent":"              context,"},{"type":"DELETE","lineNumber":145,"oldContent":"              MaterialPageRoute("},{"type":"DELETE","lineNumber":147,"oldContent":"                builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":159,"content":"                      ),"},{"type":"DELETE","lineNumber":149,"oldContent":"                  phoneNumber: _phoneController.text.trim(),"},{"type":"DELETE","lineNumber":151,"oldContent":"                  verificationId: state.verificationId ?? '',"},{"type":"DELETE","lineNumber":154,"oldContent":"                ),"},{"type":"DELETE","lineNumber":156,"oldContent":"              ),"},{"type":"DELETE","lineNumber":157,"oldContent":"            );"},{"type":"DELETE","lineNumber":160,"oldContent":"            // Show error message"},{"type":"DELETE","lineNumber":163,"oldContent":"              SnackBar("},{"type":"DELETE","lineNumber":165,"oldContent":"                content: Text(state.error ?? 'Registration failed. Please try again.'),"},{"type":"DELETE","lineNumber":167,"oldContent":"                duration: const Duration(seconds: 3),"},{"type":"DELETE","lineNumber":169,"oldContent":"              ),"},{"type":"INSERT","lineNumber":173,"content":"                  child: Column("},{"type":"INSERT","lineNumber":174,"content":"                    children: ["},{"type":"DELETE","lineNumber":189,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":203,"oldContent":"                  child: Column("},{"type":"DELETE","lineNumber":205,"oldContent":"                    children: ["},{"type":"INSERT","lineNumber":214,"content":"                            ),"},{"type":"INSERT","lineNumber":217,"content":"                      ),"},{"type":"INSERT","lineNumber":230,"content":"                            ),"},{"type":"DELETE","lineNumber":243,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":247,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":251,"content":"                      ),"},{"type":"INSERT","lineNumber":254,"content":"                    ],"},{"type":"INSERT","lineNumber":255,"content":"                  ),"},{"type":"INSERT","lineNumber":256,"content":"                ),"},{"type":"INSERT","lineNumber":263,"content":"  }"},{"type":"DELETE","lineNumber":260,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":278,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":282,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":284,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":286,"oldContent":"                ),"},{"type":"INSERT","lineNumber":295,"content":"    );"},{"type":"DELETE","lineNumber":294,"oldContent":"  }"},{"type":"INSERT","lineNumber":317,"content":"          ),"},{"type":"DELETE","lineNumber":326,"oldContent":"    );"},{"type":"DELETE","lineNumber":348,"oldContent":"          ),"},{"type":"INSERT","lineNumber":389,"content":"  }"},{"type":"DELETE","lineNumber":419,"oldContent":"  }"},{"type":"INSERT","lineNumber":430,"content":"            if (!value.contains(RegExp(r'[A-Z]'))) {"},{"type":"INSERT","lineNumber":431,"content":"              return 'Password must contain at least one uppercase letter';"},{"type":"INSERT","lineNumber":432,"content":"            }"},{"type":"INSERT","lineNumber":433,"content":"            if (!value.contains(RegExp(r'[0-9]'))) {"},{"type":"INSERT","lineNumber":434,"content":"              return 'Password must contain at least one number';"},{"type":"INSERT","lineNumber":435,"content":"            }"},{"type":"INSERT","lineNumber":438,"content":"        ),"},{"type":"INSERT","lineNumber":441,"content":"        "},{"type":"INSERT","lineNumber":442,"content":"        // Confirm Password Field"},{"type":"INSERT","lineNumber":443,"content":"        TextFormField("},{"type":"INSERT","lineNumber":444,"content":"          controller: _confirmPasswordController,"},{"type":"INSERT","lineNumber":445,"content":"          obscureText: _obscureConfirmPassword,"},{"type":"INSERT","lineNumber":446,"content":"          decoration: InputDecoration("},{"type":"INSERT","lineNumber":447,"content":"            labelText: 'Confirm Password',"},{"type":"INSERT","lineNumber":448,"content":"            prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":449,"content":"            suffixIcon: IconButton("},{"type":"INSERT","lineNumber":450,"content":"              icon: Icon("},{"type":"INSERT","lineNumber":451,"content":"                _obscureConfirmPassword ? Icons.visibility_off : Icons.visibility,"},{"type":"INSERT","lineNumber":452,"content":"                color: const Color(0xFF757575),"},{"type":"INSERT","lineNumber":453,"content":"              ),"},{"type":"INSERT","lineNumber":454,"content":"              onPressed: () {"},{"type":"INSERT","lineNumber":455,"content":"                setState(() {"},{"type":"INSERT","lineNumber":456,"content":"                  _obscureConfirmPassword = !_obscureConfirmPassword;"},{"type":"INSERT","lineNumber":457,"content":"                });"},{"type":"INSERT","lineNumber":458,"content":"              },"},{"type":"INSERT","lineNumber":459,"content":"            ),"},{"type":"INSERT","lineNumber":460,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":461,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":464,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":465,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":466,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":467,"content":"            ),"},{"type":"DELETE","lineNumber":452,"oldContent":"            if (!value.contains(RegExp(r'[A-Z]'))) {"},{"type":"DELETE","lineNumber":454,"oldContent":"              return 'Password must contain at least one uppercase letter';"},{"type":"DELETE","lineNumber":455,"oldContent":"            }"},{"type":"DELETE","lineNumber":457,"oldContent":"            if (!value.contains(RegExp(r'[0-9]'))) {"},{"type":"DELETE","lineNumber":459,"oldContent":"              return 'Password must contain at least one number';"},{"type":"DELETE","lineNumber":460,"oldContent":"            }"},{"type":"DELETE","lineNumber":463,"oldContent":"        ),"},{"type":"DELETE","lineNumber":466,"oldContent":"        "},{"type":"DELETE","lineNumber":468,"oldContent":"        // Confirm Password Field"},{"type":"DELETE","lineNumber":470,"oldContent":"        TextFormField("},{"type":"DELETE","lineNumber":471,"oldContent":"          controller: _confirmPasswordController,"},{"type":"DELETE","lineNumber":473,"oldContent":"          obscureText: _obscureConfirmPassword,"},{"type":"DELETE","lineNumber":475,"oldContent":"          decoration: InputDecoration("},{"type":"DELETE","lineNumber":476,"oldContent":"            labelText: 'Confirm Password',"},{"type":"DELETE","lineNumber":478,"oldContent":"            prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"DELETE","lineNumber":480,"oldContent":"            suffixIcon: IconButton("},{"type":"DELETE","lineNumber":481,"oldContent":"              icon: Icon("},{"type":"DELETE","lineNumber":483,"oldContent":"                _obscureConfirmPassword ? Icons.visibility_off : Icons.visibility,"},{"type":"DELETE","lineNumber":485,"oldContent":"                color: const Color(0xFF757575),"},{"type":"DELETE","lineNumber":486,"oldContent":"              ),"},{"type":"DELETE","lineNumber":488,"oldContent":"              onPressed: () {"},{"type":"DELETE","lineNumber":490,"oldContent":"                setState(() {"},{"type":"DELETE","lineNumber":491,"oldContent":"                  _obscureConfirmPassword = !_obscureConfirmPassword;"},{"type":"DELETE","lineNumber":493,"oldContent":"                });"},{"type":"DELETE","lineNumber":495,"oldContent":"              },"},{"type":"DELETE","lineNumber":496,"oldContent":"            ),"},{"type":"DELETE","lineNumber":498,"oldContent":"            border: OutlineInputBorder("},{"type":"DELETE","lineNumber":500,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":503,"oldContent":"            enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":504,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":506,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":508,"oldContent":"            ),"},{"type":"DELETE","lineNumber":522,"oldContent":""},{"type":"DELETE","lineNumber":523,"oldContent":"}"},{"type":"DELETE","lineNumber":524,"oldContent":"  }"},{"type":"DELETE","lineNumber":525,"oldContent":"    );"},{"type":"DELETE","lineNumber":526,"oldContent":"      ),"},{"type":"INSERT","lineNumber":524,"content":"      ),"},{"type":"INSERT","lineNumber":525,"content":"    );"},{"type":"INSERT","lineNumber":526,"content":"  }"},{"type":"INSERT","lineNumber":527,"content":"}"},{"type":"INSERT","lineNumber":528,"content":""}]},{"timestamp":1754644851361,"changes":[{"type":"MODIFY","lineNumber":8,"content":"  const RegisterScreen({Key? key}) : super(key: key);","oldContent":"  const RegisterScreen({Key? key}) : super(key: key);"},{"type":"MODIFY","lineNumber":11,"content":"  _RegisterScreenState createState() => _RegisterScreenState();","oldContent":"  _RegisterScreenState createState() => _RegisterScreenState();"},{"type":"MODIFY","lineNumber":33,"content":"    super.dispose();","oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":35,"oldContent":"      if (_currentStep < 1) {"},{"type":"MODIFY","lineNumber":38,"content":"      if (_currentStep < 1) {","oldContent":"        setState(() {"},{"type":"INSERT","lineNumber":39,"content":"        setState(() {"},{"type":"MODIFY","lineNumber":46,"content":"  void _onPreviousStep() {","oldContent":"  void _onPreviousStep() {"},{"type":"DELETE","lineNumber":58,"oldContent":"        );"},{"type":"DELETE","lineNumber":60,"oldContent":"      }"},{"type":"MODIFY","lineNumber":63,"content":"        );","oldContent":"  }"},{"type":"INSERT","lineNumber":64,"content":"      }"},{"type":"INSERT","lineNumber":65,"content":"    }"},{"type":"INSERT","lineNumber":66,"content":"  }"},{"type":"DELETE","lineNumber":68,"oldContent":"    }"},{"type":"DELETE","lineNumber":90,"oldContent":"    }"},{"type":"DELETE","lineNumber":91,"oldContent":"  }"},{"type":"DELETE","lineNumber":93,"oldContent":""},{"type":"DELETE","lineNumber":101,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":102,"oldContent":"            color: const Color(0xFF333333),"},{"type":"INSERT","lineNumber":98,"content":"    }"},{"type":"INSERT","lineNumber":99,"content":"  }"},{"type":"INSERT","lineNumber":100,"content":""},{"type":"DELETE","lineNumber":104,"oldContent":"            fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":106,"oldContent":"          ),"},{"type":"DELETE","lineNumber":107,"oldContent":"        ),"},{"type":"DELETE","lineNumber":109,"oldContent":"        backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":111,"oldContent":"        elevation: 0,"},{"type":"DELETE","lineNumber":112,"oldContent":"      ),"},{"type":"DELETE","lineNumber":114,"oldContent":"      body: BlocListener<AuthBloc, AuthState>("},{"type":"DELETE","lineNumber":116,"oldContent":"        listener: (context, state) {"},{"type":"DELETE","lineNumber":117,"oldContent":"          if (state.status == AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":119,"oldContent":"            // Navigate to OTP verification screen"},{"type":"DELETE","lineNumber":120,"oldContent":"            Navigator.pushReplacement("},{"type":"DELETE","lineNumber":122,"oldContent":"              context,"},{"type":"DELETE","lineNumber":123,"oldContent":"              MaterialPageRoute("},{"type":"DELETE","lineNumber":125,"oldContent":"                builder: (context) => OtpVerificationScreen("},{"type":"DELETE","lineNumber":127,"oldContent":"                  phoneNumber: _phoneController.text.trim(),"},{"type":"INSERT","lineNumber":111,"content":"              ),"},{"type":"INSERT","lineNumber":112,"content":"            ),"},{"type":"INSERT","lineNumber":113,"content":"          );"},{"type":"INSERT","lineNumber":114,"content":"        } else if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":115,"content":"          // Navigate to success screen after successful verification"},{"type":"INSERT","lineNumber":116,"content":"          Navigator.pushReplacement("},{"type":"INSERT","lineNumber":117,"content":"            context,"},{"type":"INSERT","lineNumber":118,"content":"            MaterialPageRoute("},{"type":"INSERT","lineNumber":119,"content":"              builder: (context) => const SuccessScreen("},{"type":"INSERT","lineNumber":120,"content":"                title: 'Registration Successful!',"},{"type":"INSERT","lineNumber":121,"content":"                message: 'Your account has been created and verified successfully.',"},{"type":"INSERT","lineNumber":122,"content":"                isRegistration: true,"},{"type":"INSERT","lineNumber":123,"content":"              ),"},{"type":"INSERT","lineNumber":124,"content":"            ),"},{"type":"INSERT","lineNumber":125,"content":"          );"},{"type":"INSERT","lineNumber":126,"content":"        } else if (state.status == AuthStatus.error) {"},{"type":"INSERT","lineNumber":127,"content":"          // Show error message if registration fails"},{"type":"INSERT","lineNumber":128,"content":"          if (state.error != null) {"},{"type":"INSERT","lineNumber":129,"content":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":130,"content":"              SnackBar(content: Text(state.error!)),"},{"type":"INSERT","lineNumber":131,"content":"            );"},{"type":"INSERT","lineNumber":132,"content":"          }"},{"type":"INSERT","lineNumber":133,"content":"        }"},{"type":"INSERT","lineNumber":134,"content":"      },"},{"type":"INSERT","lineNumber":135,"content":"      child: Scaffold("},{"type":"INSERT","lineNumber":136,"content":"        appBar: AppBar("},{"type":"INSERT","lineNumber":137,"content":"          leading: IconButton("},{"type":"INSERT","lineNumber":138,"content":"            icon: const Icon(Icons.arrow_back_ios, color: Color(0xFF333333)),"},{"type":"INSERT","lineNumber":139,"content":"            onPressed: _onPreviousStep,"},{"type":"INSERT","lineNumber":140,"content":"          ),"},{"type":"INSERT","lineNumber":141,"content":"          title: Text("},{"type":"INSERT","lineNumber":142,"content":"            'Create Account',"},{"type":"INSERT","lineNumber":143,"content":"            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":144,"content":"              color: const Color(0xFF333333),"},{"type":"INSERT","lineNumber":145,"content":"              fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":146,"content":"            ),"},{"type":"INSERT","lineNumber":147,"content":"          ),"},{"type":"INSERT","lineNumber":148,"content":"          backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":149,"content":"          elevation: 0,"},{"type":"INSERT","lineNumber":150,"content":"        ),"},{"type":"INSERT","lineNumber":151,"content":"        body: SingleChildScrollView("},{"type":"INSERT","lineNumber":152,"content":"          child: Column("},{"type":"DELETE","lineNumber":129,"oldContent":"                  verificationId: state.verificationId ?? '',"},{"type":"DELETE","lineNumber":131,"oldContent":"                ),"},{"type":"DELETE","lineNumber":133,"oldContent":"              ),"},{"type":"DELETE","lineNumber":135,"oldContent":"            );"},{"type":"DELETE","lineNumber":137,"oldContent":"          } else if (state.status == AuthStatus.error) {"},{"type":"DELETE","lineNumber":139,"oldContent":"            // Show error message"},{"type":"DELETE","lineNumber":141,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":143,"oldContent":"              SnackBar("},{"type":"DELETE","lineNumber":144,"oldContent":"                content: Text(state.error ?? 'Registration failed. Please try again.'),"},{"type":"DELETE","lineNumber":146,"oldContent":"                duration: const Duration(seconds: 3),"},{"type":"DELETE","lineNumber":148,"oldContent":"              ),"},{"type":"DELETE","lineNumber":150,"oldContent":"            );"},{"type":"DELETE","lineNumber":151,"oldContent":"          }"},{"type":"DELETE","lineNumber":153,"oldContent":"        },"},{"type":"DELETE","lineNumber":154,"oldContent":"        child: SingleChildScrollView("},{"type":"DELETE","lineNumber":156,"oldContent":"          child: Column("},{"type":"INSERT","lineNumber":168,"content":"                      ),"},{"type":"DELETE","lineNumber":165,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":182,"content":"                  child: Column("},{"type":"INSERT","lineNumber":183,"content":"                    children: ["},{"type":"DELETE","lineNumber":175,"oldContent":"                  child: Column("},{"type":"DELETE","lineNumber":177,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":214,"oldContent":"                          );"},{"type":"INSERT","lineNumber":224,"content":"                          );"},{"type":"INSERT","lineNumber":226,"content":"                      ),"},{"type":"DELETE","lineNumber":219,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":239,"content":"                            ),"},{"type":"DELETE","lineNumber":233,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":260,"content":"                      ),"},{"type":"DELETE","lineNumber":253,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":263,"content":"                    ],"},{"type":"INSERT","lineNumber":264,"content":"                  ),"},{"type":"INSERT","lineNumber":265,"content":"                ),"},{"type":"DELETE","lineNumber":257,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":259,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":261,"oldContent":"                ),"},{"type":"INSERT","lineNumber":272,"content":"  }"},{"type":"DELETE","lineNumber":268,"oldContent":"  }"},{"type":"DELETE","lineNumber":295,"oldContent":"  }"},{"type":"INSERT","lineNumber":305,"content":"  }"},{"type":"INSERT","lineNumber":326,"content":"          ),"},{"type":"DELETE","lineNumber":319,"oldContent":"          ),"},{"type":"DELETE","lineNumber":389,"oldContent":""},{"type":"INSERT","lineNumber":399,"content":""},{"type":"DELETE","lineNumber":430,"oldContent":"            return null;"},{"type":"DELETE","lineNumber":432,"oldContent":"          },"},{"type":"DELETE","lineNumber":434,"oldContent":"        "},{"type":"DELETE","lineNumber":436,"oldContent":"        const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":438,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":440,"oldContent":"            ),"},{"type":"DELETE","lineNumber":442,"oldContent":"            filled: true,"},{"type":"DELETE","lineNumber":443,"oldContent":"            fillColor: Colors.white,"},{"type":"DELETE","lineNumber":444,"oldContent":"          ),"},{"type":"INSERT","lineNumber":445,"content":"            return null;"},{"type":"INSERT","lineNumber":446,"content":"          },"},{"type":"DELETE","lineNumber":446,"oldContent":"          validator: (value) {"},{"type":"DELETE","lineNumber":447,"oldContent":"            if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":448,"oldContent":"              return 'Please confirm your password';"},{"type":"DELETE","lineNumber":450,"oldContent":"            }"},{"type":"INSERT","lineNumber":449,"content":"        const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":450,"content":"        "},{"type":"DELETE","lineNumber":452,"oldContent":"            if (value != _passwordController.text) {"},{"type":"DELETE","lineNumber":454,"oldContent":"              return 'Passwords do not match';"},{"type":"DELETE","lineNumber":456,"oldContent":"            }"},{"type":"DELETE","lineNumber":458,"oldContent":"            return null;"},{"type":"DELETE","lineNumber":460,"oldContent":"          },"},{"type":"DELETE","lineNumber":462,"oldContent":"        ),"},{"type":"DELETE","lineNumber":464,"oldContent":"        "},{"type":"DELETE","lineNumber":466,"oldContent":"        const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":468,"oldContent":"        "},{"type":"DELETE","lineNumber":470,"oldContent":"        // Password Requirements"},{"type":"DELETE","lineNumber":473,"oldContent":"        Column("},{"type":"DELETE","lineNumber":477,"oldContent":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":480,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":484,"oldContent":"            Text("},{"type":"DELETE","lineNumber":485,"oldContent":"              'Password must contain:',"},{"type":"INSERT","lineNumber":471,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":472,"content":"            ),"},{"type":"DELETE","lineNumber":487,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":489,"oldContent":"                color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":477,"content":"            filled: true,"},{"type":"INSERT","lineNumber":478,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":479,"content":"          ),"},{"type":"INSERT","lineNumber":480,"content":"          validator: (value) {"},{"type":"INSERT","lineNumber":481,"content":"            if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":482,"content":"              return 'Please confirm your password';"},{"type":"INSERT","lineNumber":483,"content":"            }"},{"type":"INSERT","lineNumber":484,"content":"            if (value != _passwordController.text) {"},{"type":"INSERT","lineNumber":485,"content":"              return 'Passwords do not match';"},{"type":"INSERT","lineNumber":486,"content":"            }"},{"type":"INSERT","lineNumber":487,"content":"            return null;"},{"type":"INSERT","lineNumber":488,"content":"          },"},{"type":"INSERT","lineNumber":489,"content":"        ),"},{"type":"INSERT","lineNumber":490,"content":"        "},{"type":"INSERT","lineNumber":491,"content":"        const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":492,"content":"        "},{"type":"INSERT","lineNumber":493,"content":"        // Password Requirements"},{"type":"INSERT","lineNumber":494,"content":"        Column("},{"type":"INSERT","lineNumber":495,"content":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":496,"content":"          children: ["},{"type":"INSERT","lineNumber":497,"content":"            Text("},{"type":"INSERT","lineNumber":498,"content":"              'Password must contain:',"},{"type":"INSERT","lineNumber":499,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":500,"content":"                color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":532,"content":"        ],"},{"type":"DELETE","lineNumber":527,"oldContent":"        ],"}]},{"timestamp":1754644896183,"changes":[{"type":"INSERT","lineNumber":7,"content":"class RegisterScreen extends StatefulWidget {"},{"type":"DELETE","lineNumber":8,"oldContent":"  const RegisterScreen({Key? key}) : super(key: key);"},{"type":"INSERT","lineNumber":10,"content":"  @override"},{"type":"DELETE","lineNumber":11,"oldContent":"  _RegisterScreenState createState() => _RegisterScreenState();"},{"type":"INSERT","lineNumber":32,"content":"    _confirmPasswordController.dispose();"},{"type":"DELETE","lineNumber":33,"oldContent":"    super.dispose();"},{"type":"MODIFY","lineNumber":36,"content":"  void _onNextStep() {","oldContent":"        setState(() {"},{"type":"INSERT","lineNumber":37,"content":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"DELETE","lineNumber":39,"oldContent":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"DELETE","lineNumber":46,"oldContent":"  void _onPreviousStep() {"},{"type":"INSERT","lineNumber":61,"content":"            builder: (context) => const LoginScreen(),"},{"type":"INSERT","lineNumber":62,"content":"          ),"},{"type":"DELETE","lineNumber":63,"oldContent":"            builder: (context) => const LoginScreen(),"},{"type":"DELETE","lineNumber":65,"oldContent":"          ),"},{"type":"DELETE","lineNumber":95,"oldContent":"    }"},{"type":"DELETE","lineNumber":97,"oldContent":"  }"},{"type":"DELETE","lineNumber":99,"oldContent":""},{"type":"INSERT","lineNumber":98,"content":"    }"},{"type":"INSERT","lineNumber":99,"content":"  }"},{"type":"INSERT","lineNumber":100,"content":""},{"type":"DELETE","lineNumber":103,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":104,"oldContent":"      appBar: AppBar("},{"type":"INSERT","lineNumber":103,"content":"    return BlocListener<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":104,"content":"      listener: (context, state) {"},{"type":"INSERT","lineNumber":105,"content":"        if (state.status == AuthStatus.otpSent) {"},{"type":"INSERT","lineNumber":106,"content":"          // Navigate to OTP verification screen for phone verification"},{"type":"INSERT","lineNumber":107,"content":"          Navigator.push("},{"type":"INSERT","lineNumber":108,"content":"            context,"},{"type":"INSERT","lineNumber":109,"content":"            MaterialPageRoute("},{"type":"INSERT","lineNumber":110,"content":"              builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":111,"content":"                verificationId: state.verificationId!,"},{"type":"INSERT","lineNumber":112,"content":"                phoneNumber: _phoneController.text.trim(),"},{"type":"INSERT","lineNumber":113,"content":"                isRegistration: true,"},{"type":"DELETE","lineNumber":108,"oldContent":"        leading: IconButton("},{"type":"DELETE","lineNumber":111,"oldContent":"          icon: const Icon(Icons.arrow_back_ios, color: Color(0xFF333333)),"},{"type":"DELETE","lineNumber":115,"oldContent":"          onPressed: _onPreviousStep,"},{"type":"DELETE","lineNumber":119,"oldContent":"        ),"},{"type":"DELETE","lineNumber":123,"oldContent":"        title: Text("},{"type":"DELETE","lineNumber":126,"oldContent":"          'Create Account',"},{"type":"DELETE","lineNumber":129,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":132,"oldContent":"              // Progress Indicator"},{"type":"DELETE","lineNumber":135,"oldContent":"              Padding("},{"type":"DELETE","lineNumber":138,"oldContent":"                padding: const EdgeInsets.symmetric(horizontal: 32.0, vertical: 16.0),"},{"type":"DELETE","lineNumber":141,"oldContent":"                child: Row("},{"type":"DELETE","lineNumber":144,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":147,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":150,"oldContent":"                    _buildStep(1, 'Details', _currentStep >= 0),"},{"type":"DELETE","lineNumber":154,"oldContent":"                    Expanded("},{"type":"DELETE","lineNumber":157,"oldContent":"                      child: Container("},{"type":"DELETE","lineNumber":160,"oldContent":"                        height: 2,"},{"type":"INSERT","lineNumber":156,"content":"            children: ["},{"type":"INSERT","lineNumber":157,"content":"              // Progress Indicator"},{"type":"INSERT","lineNumber":158,"content":"              Padding("},{"type":"INSERT","lineNumber":159,"content":"                padding: const EdgeInsets.symmetric(horizontal: 32.0, vertical: 16.0),"},{"type":"INSERT","lineNumber":160,"content":"                child: Row("},{"type":"INSERT","lineNumber":161,"content":"                  mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":162,"content":"                  children: ["},{"type":"INSERT","lineNumber":163,"content":"                    _buildStep(1, 'Details', _currentStep >= 0),"},{"type":"INSERT","lineNumber":164,"content":"                    Expanded("},{"type":"INSERT","lineNumber":165,"content":"                      child: Container("},{"type":"INSERT","lineNumber":166,"content":"                        height: 2,"},{"type":"INSERT","lineNumber":171,"content":"                      ),"},{"type":"DELETE","lineNumber":176,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":185,"content":"                  child: Column("},{"type":"INSERT","lineNumber":186,"content":"                    children: ["},{"type":"DELETE","lineNumber":189,"oldContent":"                  child: Column("},{"type":"DELETE","lineNumber":191,"oldContent":"                    children: ["},{"type":"INSERT","lineNumber":227,"content":"                          );"},{"type":"INSERT","lineNumber":229,"content":"                      ),"},{"type":"DELETE","lineNumber":231,"oldContent":"                          );"},{"type":"DELETE","lineNumber":234,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":242,"content":"                            ),"},{"type":"DELETE","lineNumber":247,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":263,"content":"                      ),"},{"type":"INSERT","lineNumber":266,"content":"                    ],"},{"type":"INSERT","lineNumber":267,"content":"                  ),"},{"type":"INSERT","lineNumber":268,"content":"                ),"},{"type":"DELETE","lineNumber":266,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":269,"oldContent":"                    ],"},{"type":"INSERT","lineNumber":275,"content":"  }"},{"type":"DELETE","lineNumber":271,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":273,"oldContent":"                ),"},{"type":"DELETE","lineNumber":280,"oldContent":"  }"},{"type":"INSERT","lineNumber":308,"content":"  }"},{"type":"DELETE","lineNumber":313,"oldContent":"  }"},{"type":"INSERT","lineNumber":329,"content":"          ),"},{"type":"DELETE","lineNumber":334,"oldContent":"          ),"},{"type":"INSERT","lineNumber":402,"content":""},{"type":"DELETE","lineNumber":407,"oldContent":""},{"type":"DELETE","lineNumber":446,"oldContent":"        ),"},{"type":"INSERT","lineNumber":450,"content":"        ),"},{"type":"INSERT","lineNumber":451,"content":"        "},{"type":"DELETE","lineNumber":450,"oldContent":"        "},{"type":"DELETE","lineNumber":461,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":463,"oldContent":"            ),"},{"type":"INSERT","lineNumber":469,"content":"                });"},{"type":"INSERT","lineNumber":470,"content":"              },"},{"type":"INSERT","lineNumber":471,"content":"            ),"},{"type":"INSERT","lineNumber":472,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":473,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":474,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":475,"content":"            ),"},{"type":"INSERT","lineNumber":476,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":477,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":478,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":479,"content":"            ),"},{"type":"DELETE","lineNumber":470,"oldContent":"                });"},{"type":"DELETE","lineNumber":472,"oldContent":"              },"},{"type":"DELETE","lineNumber":475,"oldContent":"            ),"},{"type":"DELETE","lineNumber":477,"oldContent":"            border: OutlineInputBorder("},{"type":"DELETE","lineNumber":479,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":483,"oldContent":"            enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":486,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":489,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":491,"oldContent":"            ),"},{"type":"DELETE","lineNumber":493,"oldContent":"                fontSize: 12,"},{"type":"DELETE","lineNumber":495,"oldContent":"              ),"},{"type":"DELETE","lineNumber":497,"oldContent":"            ),"},{"type":"DELETE","lineNumber":499,"oldContent":"            const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":501,"oldContent":"            _buildRequirement('At least 6 characters', _passwordController.text.length >= 6),"},{"type":"DELETE","lineNumber":503,"oldContent":"            _buildRequirement('At least one uppercase letter', _passwordController.text.contains(RegExp(r'[A-Z]'))),"},{"type":"DELETE","lineNumber":505,"oldContent":"            _buildRequirement('At least one number', _passwordController.text.contains(RegExp(r'[0-9]'))),"},{"type":"DELETE","lineNumber":507,"oldContent":"          ],"},{"type":"INSERT","lineNumber":504,"content":"                fontSize: 12,"},{"type":"INSERT","lineNumber":505,"content":"              ),"},{"type":"INSERT","lineNumber":506,"content":"            ),"},{"type":"INSERT","lineNumber":507,"content":"            const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":508,"content":"            _buildRequirement('At least 6 characters', _passwordController.text.length >= 6),"},{"type":"INSERT","lineNumber":509,"content":"            _buildRequirement('At least one uppercase letter', _passwordController.text.contains(RegExp(r'[A-Z]'))),"},{"type":"INSERT","lineNumber":510,"content":"            _buildRequirement('At least one number', _passwordController.text.contains(RegExp(r'[0-9]'))),"},{"type":"INSERT","lineNumber":511,"content":"          ],"},{"type":"INSERT","lineNumber":535,"content":"        ],"},{"type":"DELETE","lineNumber":537,"oldContent":"        ],"}]},{"timestamp":1754644911329,"changes":[{"type":"INSERT","lineNumber":6,"content":"import 'success_screen.dart';"},{"type":"DELETE","lineNumber":62,"oldContent":"        );"},{"type":"INSERT","lineNumber":64,"content":"        );"},{"type":"DELETE","lineNumber":96,"oldContent":"    }"},{"type":"INSERT","lineNumber":98,"content":"          );"},{"type":"INSERT","lineNumber":99,"content":"    }"},{"type":"DELETE","lineNumber":100,"oldContent":"          );"},{"type":"DELETE","lineNumber":106,"oldContent":"              ),"},{"type":"DELETE","lineNumber":108,"oldContent":"            ),"},{"type":"DELETE","lineNumber":110,"oldContent":"          );"},{"type":"DELETE","lineNumber":113,"oldContent":"        } else if (state.status == AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":115,"oldContent":"          // Navigate to success screen after successful verification"},{"type":"DELETE","lineNumber":118,"oldContent":"          Navigator.pushReplacement("},{"type":"INSERT","lineNumber":115,"content":"              ),"},{"type":"INSERT","lineNumber":116,"content":"            ),"},{"type":"INSERT","lineNumber":117,"content":"          );"},{"type":"INSERT","lineNumber":118,"content":"        } else if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":119,"content":"          // Navigate to success screen after successful verification"},{"type":"INSERT","lineNumber":120,"content":"          Navigator.pushReplacement("},{"type":"DELETE","lineNumber":150,"oldContent":"            children: ["},{"type":"INSERT","lineNumber":152,"content":"          backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":153,"content":"          elevation: 0,"},{"type":"INSERT","lineNumber":154,"content":"        ),"},{"type":"INSERT","lineNumber":155,"content":"        body: SingleChildScrollView("},{"type":"INSERT","lineNumber":156,"content":"          child: Column("},{"type":"INSERT","lineNumber":157,"content":"            children: ["},{"type":"DELETE","lineNumber":154,"oldContent":"          backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":156,"oldContent":"          elevation: 0,"},{"type":"DELETE","lineNumber":159,"oldContent":"        ),"},{"type":"DELETE","lineNumber":161,"oldContent":"        body: SingleChildScrollView("},{"type":"DELETE","lineNumber":163,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":165,"oldContent":"                        color: _currentStep >= 1"},{"type":"DELETE","lineNumber":167,"oldContent":"                            ? const Color(0xFFFF6B35)"},{"type":"INSERT","lineNumber":168,"content":"                        color: _currentStep >= 1"},{"type":"INSERT","lineNumber":169,"content":"                            ? const Color(0xFFFF6B35)"},{"type":"INSERT","lineNumber":172,"content":"                      ),"},{"type":"DELETE","lineNumber":174,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":186,"content":"                  child: Column("},{"type":"INSERT","lineNumber":187,"content":"                    children: ["},{"type":"DELETE","lineNumber":188,"oldContent":"                  child: Column("},{"type":"DELETE","lineNumber":190,"oldContent":"                    children: ["},{"type":"INSERT","lineNumber":228,"content":"                          );"},{"type":"INSERT","lineNumber":230,"content":"                      ),"},{"type":"DELETE","lineNumber":230,"oldContent":"                          );"},{"type":"DELETE","lineNumber":233,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":243,"content":"                            ),"},{"type":"DELETE","lineNumber":245,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":264,"content":"                      ),"},{"type":"INSERT","lineNumber":267,"content":"                    ],"},{"type":"INSERT","lineNumber":268,"content":"                  ),"},{"type":"INSERT","lineNumber":269,"content":"                ),"},{"type":"DELETE","lineNumber":266,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":270,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":271,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":273,"oldContent":"                ),"},{"type":"INSERT","lineNumber":276,"content":"  }"},{"type":"DELETE","lineNumber":278,"oldContent":"  }"},{"type":"INSERT","lineNumber":309,"content":"  }"},{"type":"DELETE","lineNumber":311,"oldContent":"  }"},{"type":"INSERT","lineNumber":330,"content":"          ),"},{"type":"DELETE","lineNumber":332,"oldContent":"          ),"},{"type":"INSERT","lineNumber":403,"content":""},{"type":"DELETE","lineNumber":405,"oldContent":""},{"type":"DELETE","lineNumber":450,"oldContent":"        const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":451,"oldContent":"        "},{"type":"INSERT","lineNumber":453,"content":"        const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":454,"content":"        "},{"type":"DELETE","lineNumber":469,"oldContent":"            filled: true,"},{"type":"DELETE","lineNumber":471,"oldContent":"            fillColor: Colors.white,"},{"type":"DELETE","lineNumber":474,"oldContent":"          ),"},{"type":"DELETE","lineNumber":477,"oldContent":"          validator: (value) {"},{"type":"DELETE","lineNumber":479,"oldContent":"            if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":482,"oldContent":"              return 'Please confirm your password';"},{"type":"DELETE","lineNumber":485,"oldContent":"            }"},{"type":"INSERT","lineNumber":481,"content":"            filled: true,"},{"type":"INSERT","lineNumber":482,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":483,"content":"          ),"},{"type":"INSERT","lineNumber":484,"content":"          validator: (value) {"},{"type":"INSERT","lineNumber":485,"content":"            if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":486,"content":"              return 'Please confirm your password';"},{"type":"INSERT","lineNumber":487,"content":"            }"},{"type":"DELETE","lineNumber":501,"oldContent":"                fontSize: 12,"},{"type":"INSERT","lineNumber":503,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":504,"content":"                color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":505,"content":"                fontSize: 12,"},{"type":"DELETE","lineNumber":505,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":508,"oldContent":"                color: const Color(0xFF666666),"},{"type":"DELETE","lineNumber":510,"oldContent":"        ),"},{"type":"MODIFY","lineNumber":513,"content":"        ),","oldContent":"      ],"},{"type":"INSERT","lineNumber":514,"content":"      ],"},{"type":"DELETE","lineNumber":533,"oldContent":""},{"type":"MODIFY","lineNumber":534,"content":"            ),","oldContent":"}"},{"type":"INSERT","lineNumber":535,"content":"          ),"},{"type":"INSERT","lineNumber":536,"content":"        ],"},{"type":"DELETE","lineNumber":538,"oldContent":"        ],"},{"type":"INSERT","lineNumber":541,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/screens/login_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/screens/login_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:flutter_bloc/flutter_bloc.dart';\nimport 'package:family_tree_firebase/core/constants/app_constants.dart';\n\nclass LoginScreen extends StatefulWidget {\n  const LoginScreen({super.key});\n\n  @override\n  State<LoginScreen> createState() => _LoginScreenState();\n}\n\nclass _LoginScreenState extends State<LoginScreen> {\n  final _formKey = GlobalKey<FormState>();\n  final _emailController = TextEditingController();\n  final _passwordController = TextEditingController();\n  bool _obscurePassword = true;\n  bool _isLoading = false;\n\n  Future<void> _login() async {\n    if (!_formKey.currentState!.validate()) return;\n    \n    setState(() => _isLoading = true);\n    \n    try {\n      // TODO: Implement login logic with Firebase\n      await Future.delayed(const Duration(seconds: 2)); // Simulate API call\n      \n      if (mounted) {\n        // In a real app, you would check if the user has already joined a family\n        final hasJoinedFamily = false; // Replace with actual check\n        \n        if (hasJoinedFamily) {\n          Navigator.pushReplacementNamed(context, AppConstants.homeRoute);\n        } else {\n          Navigator.pushReplacementNamed(context, AppConstants.joinOrCreateFamilyRoute);\n        }\n      }\n    } catch (e) {\n      if (mounted) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          SnackBar(content: Text(e.toString())),\n        );\n      }\n    } finally {\n      if (mounted) {\n        setState(() => _isLoading = false);\n      }\n    }\n  }\n\n  @override\n  void dispose() {\n    _emailController.dispose();\n    _passwordController.dispose();\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      body: SafeArea(\n        child: SingleChildScrollView(\n          padding: const EdgeInsets.all(24.0),\n          child: Form(\n            key: _formKey,\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.stretch,\n              children: [\n                // Back button and title\n                Row(\n                  children: [\n                    IconButton(\n                      icon: const Icon(Icons.arrow_back_ios, size: 20),\n                      onPressed: () => Navigator.pop(context),\n                    ),\n                    const SizedBox(width: 8),\n                    const Text(\n                      'Login',\n                      style: TextStyle(\n                        fontSize: 24,\n                        fontWeight: FontWeight.bold,\n                      ),\n                    ),\n                  ],\n                ),\n                \n                const SizedBox(height: 40),\n                \n                // Welcome text\n                const Text(\n                  'Welcome Back!',\n                  style: TextStyle(\n                    fontSize: 28,\n                    fontWeight: FontWeight.bold,\n                  ),\n                ),\n                const SizedBox(height: 8),\n                Text(\n                  'Login to continue using Family Connect',\n                  style: TextStyle(\n                    fontSize: 16,\n                    color: Colors.grey[600],\n                  ),\n                ),\n                \n                const SizedBox(height: 40),\n                \n                // Email field\n                TextFormField(\n                  controller: _emailController,\n                  keyboardType: TextInputType.emailAddress,\n                  decoration: InputDecoration(\n                    labelText: 'Email',\n                    prefixIcon: const Icon(Icons.email_outlined),\n                    border: OutlineInputBorder(\n                      borderRadius: BorderRadius.circular(12),\n                    ),\n                  ),\n                  validator: (value) {\n                    if (value == null || value.isEmpty) {\n                      return 'Please enter your email';\n                    }\n                    if (!RegExp(r'^[^@]+@[^\\s]+\\.[^\\s]+').hasMatch(value)) {\n                      return 'Please enter a valid email';\n                    }\n                    return null;\n                  },\n                ),\n                \n                const SizedBox(height: 20),\n                \n                // Password field\n                TextFormField(\n                  controller: _passwordController,\n                  obscureText: _obscurePassword,\n                  decoration: InputDecoration(\n                    labelText: 'Password',\n                    prefixIcon: const Icon(Icons.lock_outline),\n                    suffixIcon: IconButton(\n                      icon: Icon(\n                        _obscurePassword\n                            ? Icons.visibility_off\n                            : Icons.visibility,\n                      ),\n                      onPressed: () {\n                        setState(() {\n                          _obscurePassword = !_obscurePassword;\n                        });\n                      },\n                    ),\n                    border: OutlineInputBorder(\n                      borderRadius: BorderRadius.circular(12),\n                    ),\n                  ),\n                  validator: (value) {\n                    if (value == null || value.isEmpty) {\n                      return 'Please enter your password';\n                    }\n                    if (value.length < 6) {\n                      return 'Password must be at least 6 characters';\n                    }\n                    return null;\n                  },\n                ),\n                \n                const SizedBox(height: 8),\n                \n                // Forgot password\n                Align(\n                  alignment: Alignment.centerRight,\n                  child: TextButton(\n                    onPressed: () {\n                      // TODO: Implement forgot password\n                    },\n                    child: const Text('Forgot Password?'),\n                  ),\n                ),\n                \n                const SizedBox(height: 24),\n                \n                // Login button\n                ElevatedButton(\n                  onPressed: _isLoading ? null : _login,\n                  style: ElevatedButton.styleFrom(\n                    padding: const EdgeInsets.symmetric(vertical: 16),\n                    shape: RoundedRectangleBorder(\n                      borderRadius: BorderRadius.circular(12),\n                    ),\n                  ),\n                  child: _isLoading\n                      ? const SizedBox(\n                          width: 24,\n                          height: 24,\n                          child: CircularProgressIndicator(\n                            color: Colors.white,\n                            strokeWidth: 2,\n                          ),\n                        )\n                      : const Text(\n                          'Login',\n                          style: TextStyle(fontSize: 16),\n                        ),\n                ),\n                \n                const SizedBox(height: 24),\n                \n                // Divider with \"or\" text\n                Row(\n                  children: [\n                    const Expanded(child: Divider()),\n                    Padding(\n                      padding: const EdgeInsets.symmetric(horizontal: 16),\n                      child: Text(\n                        'or continue with',\n                        style: TextStyle(\n                          color: Colors.grey[600],\n                        ),\n                      ),\n                    ),\n                    const Expanded(child: Divider()),\n                  ],\n                ),\n                \n                const SizedBox(height: 24),\n                \n                // Social login buttons\n                Row(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    // Google\n                    IconButton(\n                      onPressed: () {\n                        // TODO: Implement Google sign in\n                      },\n                      style: IconButton.styleFrom(\n                        backgroundColor: Colors.grey[100],\n                        padding: const EdgeInsets.all(16),\n                        shape: RoundedRectangleBorder(\n                          borderRadius: BorderRadius.circular(12),\n                        ),\n                      ),\n                      icon: Image.asset(\n                        'assets/images/google.png',\n                        width: 24,\n                        height: 24,\n                      ),\n                    ),\n                    \n                    const SizedBox(width: 16),\n                    \n                    // Apple\n                    IconButton(\n                      onPressed: () {\n                        // TODO: Implement Apple sign in\n                      },\n                      style: IconButton.styleFrom(\n                        backgroundColor: Colors.grey[100],\n                        padding: const EdgeInsets.all(16),\n                        shape: RoundedRectangleBorder(\n                          borderRadius: BorderRadius.circular(12),\n                        ),\n                      ),\n                      icon: const Icon(\n                        Icons.apple,\n                        size: 24,\n                        color: Colors.black,\n                      ),\n                    ),\n                  ],\n                ),\n                \n                const SizedBox(height: 24),\n                \n                // Sign up link\n                Row(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    const Text(\"Don't have an account?\"),\n                    TextButton(\n                      onPressed: () {\n                        Navigator.pushReplacementNamed(\n                          context,\n                          AppConstants.registerRoute,\n                        );\n                      },\n                      child: const Text('Sign Up'),\n                    ),\n                  ],\n                ),\n              ],\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n}\n","baseTimestamp":1754375914485,"deltas":[{"timestamp":1754457799802,"changes":[{"type":"INSERT","lineNumber":2,"content":"import 'package:flutter_svg/flutter_svg.dart';"},{"type":"DELETE","lineNumber":241,"oldContent":"                      icon: Image.asset("},{"type":"MODIFY","lineNumber":242,"content":"                      icon: SvgPicture.asset(","oldContent":"                        'assets/images/google.png',"},{"type":"INSERT","lineNumber":243,"content":"                        'assets/images/google.svg',"}]},{"timestamp":1754457958185,"changes":[{"type":"DELETE","lineNumber":227,"oldContent":"                Row("},{"type":"DELETE","lineNumber":228,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":229,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":230,"oldContent":"                    // Google"},{"type":"DELETE","lineNumber":231,"oldContent":"                    IconButton("},{"type":"DELETE","lineNumber":232,"oldContent":"                      onPressed: () {"},{"type":"DELETE","lineNumber":233,"oldContent":"                        // TODO: Implement Google sign in"},{"type":"DELETE","lineNumber":234,"oldContent":"                      },"},{"type":"DELETE","lineNumber":235,"oldContent":"                      style: IconButton.styleFrom("},{"type":"DELETE","lineNumber":236,"oldContent":"                        backgroundColor: Colors.grey[100],"},{"type":"DELETE","lineNumber":237,"oldContent":"                        padding: const EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":238,"oldContent":"                        shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":239,"oldContent":"                          borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":227,"content":"                ConstrainedBox("},{"type":"INSERT","lineNumber":228,"content":"                  constraints: const BoxConstraints(maxWidth: 300),"},{"type":"INSERT","lineNumber":229,"content":"                  child: Row("},{"type":"INSERT","lineNumber":230,"content":"                    mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":231,"content":"                    children: ["},{"type":"INSERT","lineNumber":232,"content":"                      // Google"},{"type":"INSERT","lineNumber":233,"content":"                      Expanded("},{"type":"INSERT","lineNumber":234,"content":"                        child: IconButton("},{"type":"INSERT","lineNumber":235,"content":"                          onPressed: () {"},{"type":"INSERT","lineNumber":236,"content":"                            // TODO: Implement Google sign in"},{"type":"INSERT","lineNumber":237,"content":"                          },"},{"type":"INSERT","lineNumber":238,"content":"                          style: IconButton.styleFrom("},{"type":"INSERT","lineNumber":239,"content":"                            backgroundColor: Colors.grey[100],"},{"type":"INSERT","lineNumber":240,"content":"                            padding: const EdgeInsets.symmetric(vertical: 12, horizontal: 16),"},{"type":"INSERT","lineNumber":241,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":242,"content":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":243,"content":"                            ),"},{"type":"INSERT","lineNumber":244,"content":"                          ),"},{"type":"INSERT","lineNumber":245,"content":"                          icon: SvgPicture.asset("},{"type":"INSERT","lineNumber":246,"content":"                            'assets/images/google.svg',"},{"type":"INSERT","lineNumber":247,"content":"                            width: 24,"},{"type":"INSERT","lineNumber":248,"content":"                            height: 24,"},{"type":"INSERT","lineNumber":249,"content":"                          ),"},{"type":"DELETE","lineNumber":242,"oldContent":"                      icon: SvgPicture.asset("},{"type":"DELETE","lineNumber":243,"oldContent":"                        'assets/images/google.svg',"},{"type":"DELETE","lineNumber":244,"oldContent":"                        width: 24,"},{"type":"DELETE","lineNumber":245,"oldContent":"                        height: 24,"},{"type":"DELETE","lineNumber":246,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":247,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":248,"oldContent":"                    "},{"type":"DELETE","lineNumber":249,"oldContent":"                    const SizedBox(width: 16),"},{"type":"DELETE","lineNumber":250,"oldContent":"                    "},{"type":"DELETE","lineNumber":251,"oldContent":"                    // Apple"},{"type":"DELETE","lineNumber":252,"oldContent":"                    IconButton("},{"type":"DELETE","lineNumber":253,"oldContent":"                      onPressed: () {"},{"type":"DELETE","lineNumber":254,"oldContent":"                        // TODO: Implement Apple sign in"},{"type":"DELETE","lineNumber":255,"oldContent":"                      },"},{"type":"DELETE","lineNumber":256,"oldContent":"                      style: IconButton.styleFrom("},{"type":"DELETE","lineNumber":257,"oldContent":"                        backgroundColor: Colors.grey[100],"},{"type":"DELETE","lineNumber":258,"oldContent":"                        padding: const EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":259,"oldContent":"                        shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":260,"oldContent":"                          borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":252,"content":"                      "},{"type":"INSERT","lineNumber":253,"content":"                      const SizedBox(width: 16),"},{"type":"INSERT","lineNumber":254,"content":"                      "},{"type":"INSERT","lineNumber":255,"content":"                      // Apple"},{"type":"INSERT","lineNumber":256,"content":"                      Expanded("},{"type":"INSERT","lineNumber":257,"content":"                        child: IconButton("},{"type":"INSERT","lineNumber":258,"content":"                          onPressed: () {"},{"type":"INSERT","lineNumber":259,"content":"                            // TODO: Implement Apple sign in"},{"type":"INSERT","lineNumber":260,"content":"                          },"},{"type":"INSERT","lineNumber":261,"content":"                          style: IconButton.styleFrom("},{"type":"INSERT","lineNumber":262,"content":"                            backgroundColor: Colors.grey[100],"},{"type":"INSERT","lineNumber":263,"content":"                            padding: const EdgeInsets.symmetric(vertical: 12, horizontal: 16),"},{"type":"INSERT","lineNumber":264,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":265,"content":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":266,"content":"                            ),"},{"type":"INSERT","lineNumber":267,"content":"                          ),"},{"type":"INSERT","lineNumber":268,"content":"                          icon: const Icon("},{"type":"INSERT","lineNumber":269,"content":"                            Icons.apple,"},{"type":"INSERT","lineNumber":270,"content":"                            size: 24,"},{"type":"INSERT","lineNumber":271,"content":"                            color: Colors.black,"},{"type":"INSERT","lineNumber":272,"content":"                          ),"},{"type":"DELETE","lineNumber":263,"oldContent":"                      icon: const Icon("},{"type":"DELETE","lineNumber":264,"oldContent":"                        Icons.apple,"},{"type":"DELETE","lineNumber":265,"oldContent":"                        size: 24,"},{"type":"DELETE","lineNumber":266,"oldContent":"                        color: Colors.black,"},{"type":"DELETE","lineNumber":267,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":268,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":269,"oldContent":"                  ],"},{"type":"INSERT","lineNumber":275,"content":"                    ],"},{"type":"INSERT","lineNumber":276,"content":"                  ),"}]},{"timestamp":1754460521820,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:provider/provider.dart';","oldContent":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:family_tree_firebase/core/base/base_view.dart';"},{"type":"INSERT","lineNumber":5,"content":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"DELETE","lineNumber":17,"oldContent":"  bool _isLoading = false;"},{"type":"INSERT","lineNumber":19,"content":"  late AuthViewModel _viewModel;"},{"type":"INSERT","lineNumber":21,"content":"  @override"},{"type":"INSERT","lineNumber":22,"content":"  void initState() {"},{"type":"INSERT","lineNumber":23,"content":"    super.initState();"},{"type":"INSERT","lineNumber":24,"content":"    _viewModel = context.read<AuthViewModel>();"},{"type":"INSERT","lineNumber":25,"content":"    _viewModel.addListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":26,"content":"  }"},{"type":"INSERT","lineNumber":27,"content":""},{"type":"INSERT","lineNumber":28,"content":"  @override"},{"type":"INSERT","lineNumber":29,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":30,"content":"    _emailController.dispose();"},{"type":"INSERT","lineNumber":31,"content":"    _passwordController.dispose();"},{"type":"INSERT","lineNumber":32,"content":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":33,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":34,"content":"  }"},{"type":"INSERT","lineNumber":35,"content":""},{"type":"INSERT","lineNumber":36,"content":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":37,"content":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"INSERT","lineNumber":38,"content":"      ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":39,"content":"        SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"INSERT","lineNumber":40,"content":"      );"},{"type":"INSERT","lineNumber":41,"content":"      _viewModel.clearError();"},{"type":"INSERT","lineNumber":42,"content":"    }"},{"type":"INSERT","lineNumber":43,"content":"  }"},{"type":"INSERT","lineNumber":44,"content":""},{"type":"DELETE","lineNumber":22,"oldContent":"    setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":48,"content":"    final success = await _viewModel.signInWithEmail("},{"type":"INSERT","lineNumber":49,"content":"      _emailController.text.trim(),"},{"type":"INSERT","lineNumber":50,"content":"      _passwordController.text,"},{"type":"INSERT","lineNumber":51,"content":"    );"},{"type":"DELETE","lineNumber":24,"oldContent":"    try {"},{"type":"DELETE","lineNumber":25,"oldContent":"      // TODO: Implement login logic with Firebase"},{"type":"DELETE","lineNumber":26,"oldContent":"      await Future.delayed(const Duration(seconds: 2)); // Simulate API call"},{"type":"INSERT","lineNumber":53,"content":"    if (success && mounted) {"},{"type":"INSERT","lineNumber":54,"content":"      // In a real app, you would check if the user has already joined a family"},{"type":"INSERT","lineNumber":55,"content":"      final hasJoinedFamily = true; // Replace with actual check from user data"},{"type":"DELETE","lineNumber":28,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":29,"oldContent":"        // In a real app, you would check if the user has already joined a family"},{"type":"DELETE","lineNumber":30,"oldContent":"        final hasJoinedFamily = false; // Replace with actual check"},{"type":"DELETE","lineNumber":31,"oldContent":"        "},{"type":"DELETE","lineNumber":32,"oldContent":"        if (hasJoinedFamily) {"},{"type":"DELETE","lineNumber":33,"oldContent":"          Navigator.pushReplacementNamed(context, AppConstants.homeRoute);"},{"type":"DELETE","lineNumber":34,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":35,"oldContent":"          Navigator.pushReplacementNamed(context, AppConstants.joinOrCreateFamilyRoute);"},{"type":"DELETE","lineNumber":36,"oldContent":"        }"},{"type":"INSERT","lineNumber":57,"content":"      if (hasJoinedFamily) {"},{"type":"INSERT","lineNumber":58,"content":"        Navigator.pushReplacementNamed(context, AppConstants.homeRoute);"},{"type":"INSERT","lineNumber":59,"content":"      } else {"},{"type":"INSERT","lineNumber":60,"content":"        Navigator.pushReplacementNamed(context, AppConstants.joinOrCreateFamilyRoute);"},{"type":"DELETE","lineNumber":38,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":39,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":40,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":41,"oldContent":"          SnackBar(content: Text(e.toString())),"},{"type":"DELETE","lineNumber":42,"oldContent":"        );"},{"type":"DELETE","lineNumber":43,"oldContent":"      }"},{"type":"DELETE","lineNumber":44,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":45,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":46,"oldContent":"        setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":47,"oldContent":"      }"},{"type":"DELETE","lineNumber":60,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":61,"oldContent":"      body: SafeArea("},{"type":"INSERT","lineNumber":74,"content":"    return Consumer<AuthViewModel>("},{"type":"INSERT","lineNumber":75,"content":"      builder: (context, viewModel, _) {"},{"type":"INSERT","lineNumber":76,"content":"        return Scaffold("},{"type":"INSERT","lineNumber":77,"content":"          body: SafeArea("},{"type":"DELETE","lineNumber":183,"oldContent":"                  onPressed: _isLoading ? null : _login,"},{"type":"INSERT","lineNumber":199,"content":"                  onPressed: viewModel.isLoading ? null : _login,"},{"type":"DELETE","lineNumber":190,"oldContent":"                  child: _isLoading"},{"type":"INSERT","lineNumber":206,"content":"                  child: viewModel.isLoading"},{"type":"DELETE","lineNumber":241,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":243,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":266,"content":"                        ),"},{"type":"INSERT","lineNumber":267,"content":"                      ),"},{"type":"DELETE","lineNumber":262,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":264,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":273,"oldContent":"                ),"},{"type":"DELETE","lineNumber":275,"oldContent":"                "},{"type":"INSERT","lineNumber":289,"content":"                        ),"},{"type":"INSERT","lineNumber":290,"content":"                      ),"},{"type":"INSERT","lineNumber":291,"content":"                    ],"},{"type":"INSERT","lineNumber":292,"content":"                  ),"},{"type":"INSERT","lineNumber":293,"content":"                ),"},{"type":"INSERT","lineNumber":294,"content":"                "},{"type":"DELETE","lineNumber":280,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":282,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":301,"oldContent":"      ),"},{"type":"INSERT","lineNumber":317,"content":"          ),"},{"type":"INSERT","lineNumber":318,"content":"        );"},{"type":"INSERT","lineNumber":319,"content":"      },"}]},{"timestamp":1754472355586,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:flutter_svg/flutter_svg.dart';","oldContent":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"MODIFY","lineNumber":6,"content":"","oldContent":""},{"type":"DELETE","lineNumber":19,"oldContent":""},{"type":"DELETE","lineNumber":21,"oldContent":"  Future<void> _login() async {"},{"type":"DELETE","lineNumber":22,"oldContent":"    if (!_formKey.currentState!.validate()) return;"},{"type":"INSERT","lineNumber":20,"content":""},{"type":"DELETE","lineNumber":24,"oldContent":"    "},{"type":"DELETE","lineNumber":27,"oldContent":"    "},{"type":"DELETE","lineNumber":32,"oldContent":"      "},{"type":"INSERT","lineNumber":38,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":39,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":40,"content":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"INSERT","lineNumber":41,"content":"        );"},{"type":"INSERT","lineNumber":42,"content":"        _viewModel.setError(null);"},{"type":"DELETE","lineNumber":44,"oldContent":"      ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":45,"oldContent":"        SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"DELETE","lineNumber":46,"oldContent":"      );"},{"type":"MODIFY","lineNumber":47,"content":"  Future<void> _login() async {","oldContent":"      _viewModel.clearError();"},{"type":"INSERT","lineNumber":48,"content":"    if (!_formKey.currentState!.validate()) return;"},{"type":"INSERT","lineNumber":49,"content":"    "},{"type":"DELETE","lineNumber":52,"oldContent":"    }"},{"type":"DELETE","lineNumber":54,"oldContent":"  }"},{"type":"DELETE","lineNumber":56,"oldContent":""},{"type":"DELETE","lineNumber":58,"oldContent":"  @override"},{"type":"DELETE","lineNumber":59,"oldContent":"  void dispose() {"},{"type":"INSERT","lineNumber":54,"content":"    "},{"type":"DELETE","lineNumber":61,"oldContent":"    _emailController.dispose();"},{"type":"DELETE","lineNumber":62,"oldContent":"      // In a real app, you would check if the user has already joined a family"},{"type":"DELETE","lineNumber":63,"oldContent":"    _passwordController.dispose();"},{"type":"DELETE","lineNumber":64,"oldContent":"      final hasJoinedFamily = true; // Replace with actual check from user data"},{"type":"DELETE","lineNumber":65,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":66,"oldContent":"  }"},{"type":"INSERT","lineNumber":56,"content":"      // Check if the user has already joined a family"},{"type":"INSERT","lineNumber":57,"content":"      final hasJoinedFamily = true; // TODO: Replace with actual check from user data"},{"type":"INSERT","lineNumber":58,"content":"      "},{"type":"INSERT","lineNumber":60,"content":"        if (mounted) {"},{"type":"INSERT","lineNumber":61,"content":"          Navigator.pushReplacementNamed(context, AppConstants.homeRoute);"},{"type":"INSERT","lineNumber":62,"content":"        }"},{"type":"INSERT","lineNumber":63,"content":"      } else {"},{"type":"INSERT","lineNumber":64,"content":"        if (mounted) {"},{"type":"INSERT","lineNumber":65,"content":"          Navigator.pushReplacementNamed(context, AppConstants.joinOrCreateFamilyRoute);"},{"type":"INSERT","lineNumber":66,"content":"        }"},{"type":"INSERT","lineNumber":67,"content":"      }"},{"type":"INSERT","lineNumber":68,"content":"    }"},{"type":"INSERT","lineNumber":69,"content":"  }"},{"type":"DELETE","lineNumber":69,"oldContent":"        Navigator.pushReplacementNamed(context, AppConstants.homeRoute);"},{"type":"DELETE","lineNumber":71,"oldContent":"      } else {"},{"type":"MODIFY","lineNumber":73,"content":"    return Consumer<AuthViewModel>(","oldContent":"        Navigator.pushReplacementNamed(context, AppConstants.joinOrCreateFamilyRoute);"},{"type":"INSERT","lineNumber":74,"content":"      builder: (context, viewModel, _) {"},{"type":"INSERT","lineNumber":75,"content":"        return Scaffold("},{"type":"INSERT","lineNumber":76,"content":"          body: SafeArea("},{"type":"DELETE","lineNumber":86,"oldContent":"    return Consumer<AuthViewModel>("},{"type":"DELETE","lineNumber":88,"oldContent":"      builder: (context, viewModel, _) {"},{"type":"DELETE","lineNumber":90,"oldContent":"        return Scaffold("},{"type":"DELETE","lineNumber":92,"oldContent":"          body: SafeArea("},{"type":"INSERT","lineNumber":198,"content":"                  onPressed: viewModel.isLoading ? null : _login,"},{"type":"INSERT","lineNumber":205,"content":"                  child: viewModel.isLoading"},{"type":"DELETE","lineNumber":213,"oldContent":"                  onPressed: viewModel.isLoading ? null : _login,"},{"type":"DELETE","lineNumber":221,"oldContent":"                  child: viewModel.isLoading"},{"type":"INSERT","lineNumber":265,"content":"                        ),"},{"type":"INSERT","lineNumber":266,"content":"                      ),"},{"type":"DELETE","lineNumber":278,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":280,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":288,"content":"                        ),"},{"type":"INSERT","lineNumber":289,"content":"                      ),"},{"type":"INSERT","lineNumber":290,"content":"                    ],"},{"type":"INSERT","lineNumber":291,"content":"                  ),"},{"type":"INSERT","lineNumber":292,"content":"                ),"},{"type":"INSERT","lineNumber":293,"content":"                "},{"type":"DELETE","lineNumber":299,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":301,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":303,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":305,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":307,"oldContent":"                ),"},{"type":"DELETE","lineNumber":309,"oldContent":"                "},{"type":"INSERT","lineNumber":316,"content":"          ),"},{"type":"INSERT","lineNumber":317,"content":"        );"},{"type":"INSERT","lineNumber":318,"content":"      },"},{"type":"DELETE","lineNumber":321,"oldContent":"      },"},{"type":"DELETE","lineNumber":322,"oldContent":"        );"},{"type":"DELETE","lineNumber":323,"oldContent":"          ),"}]},{"timestamp":1754512673684,"changes":[{"type":"INSERT","lineNumber":5,"content":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":""},{"type":"MODIFY","lineNumber":20,"content":"","oldContent":""},{"type":"DELETE","lineNumber":33,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":35,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":37,"oldContent":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"DELETE","lineNumber":39,"oldContent":"        );"},{"type":"DELETE","lineNumber":41,"oldContent":"        _viewModel.setError(null);"},{"type":"INSERT","lineNumber":38,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":39,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":40,"content":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"INSERT","lineNumber":41,"content":"        );"},{"type":"INSERT","lineNumber":42,"content":"        _viewModel.resetError();"},{"type":"DELETE","lineNumber":44,"oldContent":"  Future<void> _login() async {"},{"type":"DELETE","lineNumber":45,"oldContent":"    if (!_formKey.currentState!.validate()) return;"},{"type":"MODIFY","lineNumber":47,"content":"  Future<void> _login() async {","oldContent":"    "},{"type":"INSERT","lineNumber":48,"content":"    if (!_formKey.currentState!.validate()) return;"},{"type":"INSERT","lineNumber":49,"content":"    "},{"type":"DELETE","lineNumber":52,"oldContent":"    "},{"type":"INSERT","lineNumber":53,"content":"    );"},{"type":"INSERT","lineNumber":54,"content":"    "},{"type":"INSERT","lineNumber":55,"content":"    if (success && mounted) {"},{"type":"DELETE","lineNumber":56,"oldContent":"    );"},{"type":"INSERT","lineNumber":59,"content":"      if (hasJoinedFamily) {"},{"type":"DELETE","lineNumber":59,"oldContent":"    if (success && mounted) {"},{"type":"DELETE","lineNumber":67,"oldContent":"      if (hasJoinedFamily) {"},{"type":"MODIFY","lineNumber":70,"content":"","oldContent":""},{"type":"DELETE","lineNumber":75,"oldContent":"        child: SingleChildScrollView("},{"type":"MODIFY","lineNumber":77,"content":"        child: SingleChildScrollView(","oldContent":"          padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":78,"content":"          padding: const EdgeInsets.all(24.0),"},{"type":"MODIFY","lineNumber":198,"content":"                  onPressed: viewModel.isLoading ? null : _login,","oldContent":"                  onPressed: viewModel.isLoading ? null : _login,"},{"type":"MODIFY","lineNumber":265,"content":"                        ),","oldContent":"                        ),"},{"type":"MODIFY","lineNumber":288,"content":"                        ),","oldContent":"                        ),"},{"type":"DELETE","lineNumber":290,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":292,"oldContent":"                "},{"type":"DELETE","lineNumber":294,"oldContent":"                // Sign up link"},{"type":"DELETE","lineNumber":296,"oldContent":"                Row("},{"type":"INSERT","lineNumber":294,"content":"                const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":295,"content":"                "},{"type":"INSERT","lineNumber":296,"content":"                // Sign up link"},{"type":"INSERT","lineNumber":297,"content":"                Row("},{"type":"MODIFY","lineNumber":316,"content":"          ),","oldContent":"          ),"},{"type":"MODIFY","lineNumber":319,"content":"    );","oldContent":"    );"}]},{"timestamp":1754594101827,"changes":[{"type":"INSERT","lineNumber":19,"content":"  late AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":20,"oldContent":""},{"type":"DELETE","lineNumber":35,"oldContent":"      if (mounted) {"},{"type":"INSERT","lineNumber":36,"content":"  bool _isHandlingError = false;"},{"type":"INSERT","lineNumber":37,"content":""},{"type":"INSERT","lineNumber":38,"content":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":39,"content":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty && !_isHandlingError) {"},{"type":"INSERT","lineNumber":40,"content":"      _isHandlingError = true;"},{"type":"INSERT","lineNumber":41,"content":"      if (mounted) {"},{"type":"DELETE","lineNumber":39,"oldContent":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":41,"oldContent":"        _viewModel.resetError();"},{"type":"DELETE","lineNumber":42,"oldContent":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"INSERT","lineNumber":45,"content":"        // Reset the error without triggering another notification"},{"type":"INSERT","lineNumber":46,"content":"        _viewModel.setError(notify: false);"},{"type":"INSERT","lineNumber":48,"content":"      _isHandlingError = false;"},{"type":"INSERT","lineNumber":50,"content":"  }"},{"type":"INSERT","lineNumber":51,"content":""},{"type":"DELETE","lineNumber":47,"oldContent":"  }"},{"type":"DELETE","lineNumber":49,"oldContent":""},{"type":"DELETE","lineNumber":52,"oldContent":"    );"},{"type":"INSERT","lineNumber":58,"content":"    );"},{"type":"DELETE","lineNumber":55,"oldContent":"      // Check if the user has already joined a family"},{"type":"INSERT","lineNumber":61,"content":"      // Check if the user has already joined a family"},{"type":"DELETE","lineNumber":59,"oldContent":"        if (mounted) {"},{"type":"INSERT","lineNumber":65,"content":"        if (mounted) {"},{"type":"INSERT","lineNumber":74,"content":"  }"},{"type":"DELETE","lineNumber":70,"oldContent":""},{"type":"INSERT","lineNumber":81,"content":"          body: SafeArea("},{"type":"DELETE","lineNumber":78,"oldContent":"          body: SafeArea("},{"type":"INSERT","lineNumber":202,"content":"                ElevatedButton("},{"type":"DELETE","lineNumber":198,"oldContent":"                  onPressed: viewModel.isLoading ? null : _login,"},{"type":"INSERT","lineNumber":269,"content":"                          ),"},{"type":"DELETE","lineNumber":265,"oldContent":"                        ),"},{"type":"INSERT","lineNumber":292,"content":"                          ),"},{"type":"DELETE","lineNumber":288,"oldContent":"                        ),"},{"type":"INSERT","lineNumber":297,"content":"                ),"},{"type":"INSERT","lineNumber":298,"content":"                "},{"type":"DELETE","lineNumber":294,"oldContent":"                ),"},{"type":"DELETE","lineNumber":297,"oldContent":"                "},{"type":"INSERT","lineNumber":320,"content":"        ),"},{"type":"DELETE","lineNumber":316,"oldContent":"          ),"},{"type":"INSERT","lineNumber":323,"content":"      },"},{"type":"DELETE","lineNumber":319,"oldContent":"    );"}]},{"timestamp":1754594165893,"changes":[{"type":"INSERT","lineNumber":35,"content":""},{"type":"DELETE","lineNumber":37,"oldContent":""},{"type":"DELETE","lineNumber":38,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":40,"oldContent":"          SnackBar(content: Text(_viewModel.errorMessage!)),"},{"type":"DELETE","lineNumber":43,"oldContent":"        );"},{"type":"INSERT","lineNumber":42,"content":"        final errorMessage = _viewModel.errorMessage!;"},{"type":"INSERT","lineNumber":43,"content":"        // Clear the error first to prevent duplicate handling"},{"type":"INSERT","lineNumber":44,"content":"        _viewModel._setErrorSilently();"},{"type":"INSERT","lineNumber":45,"content":"        "},{"type":"INSERT","lineNumber":46,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":47,"content":"          SnackBar(content: Text(errorMessage)),"},{"type":"INSERT","lineNumber":48,"content":"        );"},{"type":"INSERT","lineNumber":50,"content":"      _isHandlingError = false;"},{"type":"DELETE","lineNumber":47,"oldContent":"        // Reset the error without triggering another notification"},{"type":"INSERT","lineNumber":52,"content":"  }"},{"type":"INSERT","lineNumber":53,"content":""},{"type":"DELETE","lineNumber":49,"oldContent":"        _viewModel.setError(notify: false);"},{"type":"DELETE","lineNumber":51,"oldContent":"      _isHandlingError = false;"},{"type":"DELETE","lineNumber":53,"oldContent":"  }"},{"type":"DELETE","lineNumber":55,"oldContent":""},{"type":"INSERT","lineNumber":60,"content":"    );"},{"type":"INSERT","lineNumber":63,"content":"      // Check if the user has already joined a family"},{"type":"DELETE","lineNumber":61,"oldContent":"    );"},{"type":"DELETE","lineNumber":64,"oldContent":"      // Check if the user has already joined a family"},{"type":"INSERT","lineNumber":67,"content":"        if (mounted) {"},{"type":"DELETE","lineNumber":69,"oldContent":"        if (mounted) {"},{"type":"INSERT","lineNumber":76,"content":"  }"},{"type":"DELETE","lineNumber":78,"oldContent":"  }"},{"type":"INSERT","lineNumber":83,"content":"          body: SafeArea("},{"type":"DELETE","lineNumber":85,"oldContent":"          body: SafeArea("},{"type":"INSERT","lineNumber":204,"content":"                ElevatedButton("},{"type":"DELETE","lineNumber":206,"oldContent":"                ElevatedButton("},{"type":"INSERT","lineNumber":271,"content":"                          ),"},{"type":"DELETE","lineNumber":273,"oldContent":"                          ),"},{"type":"INSERT","lineNumber":294,"content":"                          ),"},{"type":"DELETE","lineNumber":296,"oldContent":"                          ),"},{"type":"INSERT","lineNumber":299,"content":"                ),"},{"type":"INSERT","lineNumber":300,"content":"                "},{"type":"DELETE","lineNumber":301,"oldContent":"                ),"},{"type":"DELETE","lineNumber":302,"oldContent":"                "},{"type":"INSERT","lineNumber":322,"content":"        ),"},{"type":"INSERT","lineNumber":325,"content":"      },"},{"type":"DELETE","lineNumber":323,"oldContent":"        ),"},{"type":"DELETE","lineNumber":327,"oldContent":"      },"}]},{"timestamp":1754594218718,"changes":[{"type":"DELETE","lineNumber":40,"oldContent":"        final errorMessage = _viewModel.errorMessage!;"},{"type":"DELETE","lineNumber":42,"oldContent":"        // Clear the error first to prevent duplicate handling"},{"type":"DELETE","lineNumber":43,"oldContent":"        _viewModel._setErrorSilently();"},{"type":"INSERT","lineNumber":42,"content":"        final errorMessage = _viewModel.errorMessage!;"},{"type":"INSERT","lineNumber":43,"content":"        // Clear the error first to prevent duplicate handling"},{"type":"INSERT","lineNumber":44,"content":"        _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":46,"oldContent":"      }"},{"type":"DELETE","lineNumber":48,"oldContent":"    }"},{"type":"DELETE","lineNumber":51,"oldContent":"  Future<void> _login() async {"},{"type":"INSERT","lineNumber":49,"content":"      }"},{"type":"DELETE","lineNumber":53,"oldContent":"    if (!_formKey.currentState!.validate()) return;"},{"type":"INSERT","lineNumber":51,"content":"    }"},{"type":"DELETE","lineNumber":55,"oldContent":"    "},{"type":"INSERT","lineNumber":54,"content":"  Future<void> _login() async {"},{"type":"INSERT","lineNumber":55,"content":"    if (!_formKey.currentState!.validate()) return;"},{"type":"INSERT","lineNumber":56,"content":"    "},{"type":"INSERT","lineNumber":60,"content":"    );"},{"type":"DELETE","lineNumber":62,"oldContent":"    );"},{"type":"INSERT","lineNumber":63,"content":"      // Check if the user has already joined a family"},{"type":"DELETE","lineNumber":65,"oldContent":"      // Check if the user has already joined a family"},{"type":"INSERT","lineNumber":67,"content":"        if (mounted) {"},{"type":"DELETE","lineNumber":69,"oldContent":"        if (mounted) {"},{"type":"INSERT","lineNumber":76,"content":"  }"},{"type":"DELETE","lineNumber":78,"oldContent":"  }"},{"type":"INSERT","lineNumber":83,"content":"          body: SafeArea("},{"type":"DELETE","lineNumber":85,"oldContent":"          body: SafeArea("},{"type":"INSERT","lineNumber":204,"content":"                ElevatedButton("},{"type":"DELETE","lineNumber":206,"oldContent":"                ElevatedButton("},{"type":"INSERT","lineNumber":271,"content":"                          ),"},{"type":"DELETE","lineNumber":273,"oldContent":"                          ),"},{"type":"INSERT","lineNumber":294,"content":"                          ),"},{"type":"DELETE","lineNumber":296,"oldContent":"                          ),"},{"type":"INSERT","lineNumber":299,"content":"                ),"},{"type":"INSERT","lineNumber":300,"content":"                "},{"type":"DELETE","lineNumber":301,"oldContent":"                ),"},{"type":"DELETE","lineNumber":303,"oldContent":"                "},{"type":"INSERT","lineNumber":322,"content":"        ),"},{"type":"MODIFY","lineNumber":325,"content":"      },","oldContent":"        ),"},{"type":"DELETE","lineNumber":327,"oldContent":"      },"}]},{"timestamp":1754628531689,"changes":[{"type":"DELETE","lineNumber":1,"oldContent":"import 'package:flutter_svg/flutter_svg.dart';"},{"type":"DELETE","lineNumber":2,"oldContent":"import 'package:provider/provider.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:family_tree_firebase/core/base/base_view.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:family_tree_firebase/core/constants/app_constants.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/viewmodels/auth_viewmodel.dart';"},{"type":"INSERT","lineNumber":1,"content":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"INSERT","lineNumber":2,"content":"import 'package:google_fonts/google_fonts.dart';"},{"type":"INSERT","lineNumber":3,"content":"import '../bloc/auth_bloc.dart';"},{"type":"INSERT","lineNumber":4,"content":"import 'register_screen.dart';"},{"type":"MODIFY","lineNumber":7,"content":"  const LoginScreen({Key? key}) : super(key: key);","oldContent":"  const LoginScreen({super.key});"},{"type":"MODIFY","lineNumber":10,"content":"  _LoginScreenState createState() => _LoginScreenState();","oldContent":"  State<LoginScreen> createState() => _LoginScreenState();"},{"type":"INSERT","lineNumber":17,"content":"  bool _rememberMe = false;"},{"type":"DELETE","lineNumber":19,"oldContent":"  late AuthViewModel _viewModel;"},{"type":"DELETE","lineNumber":22,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":23,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":24,"oldContent":"    _viewModel = context.read<AuthViewModel>();"},{"type":"DELETE","lineNumber":25,"oldContent":"    _viewModel.addListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":26,"oldContent":"  }"},{"type":"DELETE","lineNumber":27,"oldContent":""},{"type":"DELETE","lineNumber":28,"oldContent":"  @override"},{"type":"DELETE","lineNumber":32,"oldContent":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"DELETE","lineNumber":36,"oldContent":"  bool _isHandlingError = false;"},{"type":"DELETE","lineNumber":37,"oldContent":""},{"type":"DELETE","lineNumber":38,"oldContent":"  void _onViewModelChange() {"},{"type":"DELETE","lineNumber":39,"oldContent":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty && !_isHandlingError) {"},{"type":"DELETE","lineNumber":40,"oldContent":"      _isHandlingError = true;"},{"type":"DELETE","lineNumber":41,"oldContent":"        final errorMessage = _viewModel.errorMessage!;"},{"type":"DELETE","lineNumber":42,"oldContent":"        // Clear the error first to prevent duplicate handling"},{"type":"DELETE","lineNumber":43,"oldContent":"        _viewModel.setErrorSilently();"},{"type":"DELETE","lineNumber":44,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":45,"oldContent":"        "},{"type":"DELETE","lineNumber":46,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":47,"oldContent":"      }"},{"type":"DELETE","lineNumber":48,"oldContent":"          SnackBar(content: Text(errorMessage)),"},{"type":"DELETE","lineNumber":49,"oldContent":"        );"},{"type":"INSERT","lineNumber":27,"content":"  void _onLoginPressed() {"},{"type":"INSERT","lineNumber":28,"content":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"INSERT","lineNumber":29,"content":"      context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":30,"content":"            LoginRequested("},{"type":"INSERT","lineNumber":31,"content":"              email: _emailController.text.trim(),"},{"type":"INSERT","lineNumber":32,"content":"              password: _passwordController.text.trim(),"},{"type":"INSERT","lineNumber":33,"content":"            ),"},{"type":"INSERT","lineNumber":34,"content":"          );"},{"type":"DELETE","lineNumber":51,"oldContent":"      _isHandlingError = false;"},{"type":"DELETE","lineNumber":52,"oldContent":"  Future<void> _login() async {"},{"type":"DELETE","lineNumber":54,"oldContent":"    if (!_formKey.currentState!.validate()) return;"},{"type":"DELETE","lineNumber":55,"oldContent":"    "},{"type":"DELETE","lineNumber":57,"oldContent":"    final success = await _viewModel.signInWithEmail("},{"type":"DELETE","lineNumber":58,"oldContent":"      _emailController.text.trim(),"},{"type":"DELETE","lineNumber":59,"oldContent":"      _passwordController.text,"},{"type":"DELETE","lineNumber":60,"oldContent":"    );"},{"type":"DELETE","lineNumber":61,"oldContent":"    "},{"type":"DELETE","lineNumber":62,"oldContent":"    if (success && mounted) {"},{"type":"DELETE","lineNumber":63,"oldContent":"      // Check if the user has already joined a family"},{"type":"DELETE","lineNumber":64,"oldContent":"      final hasJoinedFamily = true; // TODO: Replace with actual check from user data"},{"type":"DELETE","lineNumber":65,"oldContent":"      "},{"type":"DELETE","lineNumber":66,"oldContent":"      if (hasJoinedFamily) {"},{"type":"DELETE","lineNumber":67,"oldContent":"        if (mounted) {"},{"type":"DELETE","lineNumber":68,"oldContent":"          Navigator.pushReplacementNamed(context, AppConstants.homeRoute);"},{"type":"DELETE","lineNumber":69,"oldContent":"        }"},{"type":"DELETE","lineNumber":70,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":71,"oldContent":"        if (mounted) {"},{"type":"DELETE","lineNumber":72,"oldContent":"          Navigator.pushReplacementNamed(context, AppConstants.joinOrCreateFamilyRoute);"},{"type":"DELETE","lineNumber":73,"oldContent":"        }"},{"type":"DELETE","lineNumber":74,"oldContent":"      }"},{"type":"DELETE","lineNumber":75,"oldContent":"    }"},{"type":"DELETE","lineNumber":76,"oldContent":"  }"},{"type":"DELETE","lineNumber":77,"oldContent":""},{"type":"DELETE","lineNumber":80,"oldContent":"    return Consumer<AuthViewModel>("},{"type":"DELETE","lineNumber":81,"oldContent":"      builder: (context, viewModel, _) {"},{"type":"DELETE","lineNumber":82,"oldContent":"        return Scaffold("},{"type":"DELETE","lineNumber":83,"oldContent":"          body: SafeArea("},{"type":"INSERT","lineNumber":40,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":41,"content":"      body: BlocListener<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":42,"content":"        listener: (context, state) {"},{"type":"INSERT","lineNumber":43,"content":"          if (state.status == AuthStatus.error) {"},{"type":"INSERT","lineNumber":44,"content":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":45,"content":"              SnackBar(content: Text(state.error ?? 'An error occurred')),"},{"type":"INSERT","lineNumber":46,"content":"            );"},{"type":"INSERT","lineNumber":47,"content":"          }"},{"type":"INSERT","lineNumber":48,"content":"        },"},{"type":"DELETE","lineNumber":85,"oldContent":"          padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":86,"oldContent":"          child: Form("},{"type":"DELETE","lineNumber":87,"oldContent":"            key: _formKey,"},{"type":"DELETE","lineNumber":88,"oldContent":"            child: Column("},{"type":"DELETE","lineNumber":89,"oldContent":"              crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"DELETE","lineNumber":90,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":91,"oldContent":"                // Back button and title"},{"type":"DELETE","lineNumber":92,"oldContent":"                Row("},{"type":"DELETE","lineNumber":93,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":94,"oldContent":"                    IconButton("},{"type":"DELETE","lineNumber":95,"oldContent":"                      icon: const Icon(Icons.arrow_back_ios, size: 20),"},{"type":"DELETE","lineNumber":96,"oldContent":"                      onPressed: () => Navigator.pop(context),"},{"type":"DELETE","lineNumber":97,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":98,"oldContent":"                    const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":99,"oldContent":"                    const Text("},{"type":"DELETE","lineNumber":100,"oldContent":"                      'Login',"},{"type":"DELETE","lineNumber":101,"oldContent":"                      style: TextStyle("},{"type":"DELETE","lineNumber":102,"oldContent":"                        fontSize: 24,"},{"type":"DELETE","lineNumber":103,"oldContent":"                        fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":104,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":105,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":106,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":107,"oldContent":"                ),"},{"type":"DELETE","lineNumber":108,"oldContent":"                "},{"type":"DELETE","lineNumber":109,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":110,"oldContent":"                "},{"type":"DELETE","lineNumber":111,"oldContent":"                // Welcome text"},{"type":"DELETE","lineNumber":112,"oldContent":"                const Text("},{"type":"DELETE","lineNumber":113,"oldContent":"                  'Welcome Back!',"},{"type":"DELETE","lineNumber":114,"oldContent":"                  style: TextStyle("},{"type":"DELETE","lineNumber":115,"oldContent":"                    fontSize: 28,"},{"type":"DELETE","lineNumber":116,"oldContent":"                    fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":50,"content":"          child: Column("},{"type":"INSERT","lineNumber":51,"content":"            children: ["},{"type":"INSERT","lineNumber":52,"content":"              // Header with Image"},{"type":"INSERT","lineNumber":53,"content":"              Container("},{"type":"INSERT","lineNumber":54,"content":"                height: 250,"},{"type":"INSERT","lineNumber":55,"content":"                decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":56,"content":"                  image: DecorationImage("},{"type":"INSERT","lineNumber":57,"content":"                    image: AssetImage('assets/images/family_header.png'),"},{"type":"INSERT","lineNumber":58,"content":"                    fit: BoxFit.cover,"},{"type":"DELETE","lineNumber":119,"oldContent":"                const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":120,"oldContent":"                Text("},{"type":"DELETE","lineNumber":121,"oldContent":"                  'Login to continue using Family Connect',"},{"type":"DELETE","lineNumber":122,"oldContent":"                  style: TextStyle("},{"type":"DELETE","lineNumber":123,"oldContent":"                    fontSize: 16,"},{"type":"DELETE","lineNumber":124,"oldContent":"                    color: Colors.grey[600],"},{"type":"DELETE","lineNumber":125,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":126,"oldContent":"                ),"},{"type":"DELETE","lineNumber":127,"oldContent":"                "},{"type":"DELETE","lineNumber":128,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":129,"oldContent":"                "},{"type":"DELETE","lineNumber":130,"oldContent":"                // Email field"},{"type":"DELETE","lineNumber":131,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":132,"oldContent":"                  controller: _emailController,"},{"type":"DELETE","lineNumber":133,"oldContent":"                  keyboardType: TextInputType.emailAddress,"},{"type":"DELETE","lineNumber":134,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":135,"oldContent":"                    labelText: 'Email',"},{"type":"DELETE","lineNumber":136,"oldContent":"                    prefixIcon: const Icon(Icons.email_outlined),"},{"type":"DELETE","lineNumber":137,"oldContent":"                    border: OutlineInputBorder("},{"type":"DELETE","lineNumber":138,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":61,"content":"                child: Container("},{"type":"INSERT","lineNumber":62,"content":"                  decoration: BoxDecoration("},{"type":"INSERT","lineNumber":63,"content":"                    gradient: LinearGradient("},{"type":"INSERT","lineNumber":64,"content":"                      begin: Alignment.topCenter,"},{"type":"INSERT","lineNumber":65,"content":"                      end: Alignment.bottomCenter,"},{"type":"INSERT","lineNumber":66,"content":"                      colors: ["},{"type":"INSERT","lineNumber":67,"content":"                        Colors.black.withOpacity(0.6),"},{"type":"INSERT","lineNumber":68,"content":"                        Colors.transparent,"},{"type":"INSERT","lineNumber":69,"content":"                      ],"},{"type":"DELETE","lineNumber":141,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":142,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":143,"oldContent":"                      return 'Please enter your email';"},{"type":"DELETE","lineNumber":144,"oldContent":"                    }"},{"type":"DELETE","lineNumber":145,"oldContent":"                    if (!RegExp(r'^[^@]+@[^\\s]+\\.[^\\s]+').hasMatch(value)) {"},{"type":"DELETE","lineNumber":146,"oldContent":"                      return 'Please enter a valid email';"},{"type":"DELETE","lineNumber":147,"oldContent":"                    }"},{"type":"DELETE","lineNumber":148,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":149,"oldContent":"                  },"},{"type":"DELETE","lineNumber":150,"oldContent":"                ),"},{"type":"DELETE","lineNumber":151,"oldContent":"                "},{"type":"DELETE","lineNumber":152,"oldContent":"                const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":153,"oldContent":"                "},{"type":"DELETE","lineNumber":154,"oldContent":"                // Password field"},{"type":"DELETE","lineNumber":155,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":156,"oldContent":"                  controller: _passwordController,"},{"type":"DELETE","lineNumber":157,"oldContent":"                  obscureText: _obscurePassword,"},{"type":"DELETE","lineNumber":158,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":159,"oldContent":"                    labelText: 'Password',"},{"type":"DELETE","lineNumber":160,"oldContent":"                    prefixIcon: const Icon(Icons.lock_outline),"},{"type":"DELETE","lineNumber":161,"oldContent":"                    suffixIcon: IconButton("},{"type":"DELETE","lineNumber":162,"oldContent":"                      icon: Icon("},{"type":"DELETE","lineNumber":163,"oldContent":"                        _obscurePassword"},{"type":"DELETE","lineNumber":164,"oldContent":"                            ? Icons.visibility_off"},{"type":"DELETE","lineNumber":165,"oldContent":"                            : Icons.visibility,"},{"type":"INSERT","lineNumber":72,"content":"                  child: Center("},{"type":"INSERT","lineNumber":73,"content":"                    child: Text("},{"type":"INSERT","lineNumber":74,"content":"                      'Family!',"},{"type":"INSERT","lineNumber":75,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":76,"content":"                        color: Colors.white,"},{"type":"INSERT","lineNumber":77,"content":"                        fontSize: 36,"},{"type":"INSERT","lineNumber":78,"content":"                        fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":167,"oldContent":"                      onPressed: () {"},{"type":"DELETE","lineNumber":168,"oldContent":"                        setState(() {"},{"type":"DELETE","lineNumber":169,"oldContent":"                          _obscurePassword = !_obscurePassword;"},{"type":"DELETE","lineNumber":170,"oldContent":"                        });"},{"type":"DELETE","lineNumber":171,"oldContent":"                      },"},{"type":"DELETE","lineNumber":173,"oldContent":"                    border: OutlineInputBorder("},{"type":"DELETE","lineNumber":174,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":175,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":177,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":178,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":179,"oldContent":"                      return 'Please enter your password';"},{"type":"DELETE","lineNumber":180,"oldContent":"                    }"},{"type":"DELETE","lineNumber":181,"oldContent":"                    if (value.length < 6) {"},{"type":"DELETE","lineNumber":182,"oldContent":"                      return 'Password must be at least 6 characters';"},{"type":"DELETE","lineNumber":183,"oldContent":"                    }"},{"type":"DELETE","lineNumber":184,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":185,"oldContent":"                  },"},{"type":"DELETE","lineNumber":187,"oldContent":"                "},{"type":"DELETE","lineNumber":188,"oldContent":"                const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":189,"oldContent":"                "},{"type":"DELETE","lineNumber":190,"oldContent":"                // Forgot password"},{"type":"DELETE","lineNumber":191,"oldContent":"                Align("},{"type":"DELETE","lineNumber":192,"oldContent":"                  alignment: Alignment.centerRight,"},{"type":"DELETE","lineNumber":193,"oldContent":"                  child: TextButton("},{"type":"DELETE","lineNumber":194,"oldContent":"                    onPressed: () {"},{"type":"DELETE","lineNumber":195,"oldContent":"                      // TODO: Implement forgot password"},{"type":"DELETE","lineNumber":196,"oldContent":"                    },"},{"type":"DELETE","lineNumber":197,"oldContent":"                    child: const Text('Forgot Password?'),"},{"type":"INSERT","lineNumber":83,"content":"              ),"},{"type":"INSERT","lineNumber":84,"content":"              "},{"type":"INSERT","lineNumber":85,"content":"              // Welcome Back Text"},{"type":"INSERT","lineNumber":86,"content":"              Padding("},{"type":"INSERT","lineNumber":87,"content":"                padding: const EdgeInsets.only(top: 24.0, bottom: 32.0),"},{"type":"INSERT","lineNumber":88,"content":"                child: Text("},{"type":"INSERT","lineNumber":89,"content":"                  'Welcome Back',"},{"type":"INSERT","lineNumber":90,"content":"                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":91,"content":"                    fontSize: 24,"},{"type":"INSERT","lineNumber":92,"content":"                    fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":93,"content":"                    color: const Color(0xFF333333),"},{"type":"DELETE","lineNumber":200,"oldContent":"                "},{"type":"DELETE","lineNumber":201,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":202,"oldContent":"                "},{"type":"DELETE","lineNumber":203,"oldContent":"                // Login button"},{"type":"DELETE","lineNumber":204,"oldContent":"                ElevatedButton("},{"type":"DELETE","lineNumber":205,"oldContent":"                  onPressed: viewModel.isLoading ? null : _login,"},{"type":"DELETE","lineNumber":206,"oldContent":"                  style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":207,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":208,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":209,"oldContent":"                      borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":210,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":211,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":212,"oldContent":"                  child: viewModel.isLoading"},{"type":"DELETE","lineNumber":213,"oldContent":"                      ? const SizedBox("},{"type":"DELETE","lineNumber":214,"oldContent":"                          width: 24,"},{"type":"DELETE","lineNumber":215,"oldContent":"                          height: 24,"},{"type":"DELETE","lineNumber":216,"oldContent":"                          child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":217,"oldContent":"                            color: Colors.white,"},{"type":"DELETE","lineNumber":218,"oldContent":"                            strokeWidth: 2,"},{"type":"INSERT","lineNumber":96,"content":"              ),"},{"type":"INSERT","lineNumber":97,"content":"              "},{"type":"INSERT","lineNumber":98,"content":"              // Login Form"},{"type":"INSERT","lineNumber":99,"content":"              Padding("},{"type":"INSERT","lineNumber":100,"content":"                padding: const EdgeInsets.symmetric(horizontal: 24.0),"},{"type":"INSERT","lineNumber":101,"content":"                child: Form("},{"type":"INSERT","lineNumber":102,"content":"                  key: _formKey,"},{"type":"INSERT","lineNumber":103,"content":"                  child: Column("},{"type":"INSERT","lineNumber":104,"content":"                    children: ["},{"type":"INSERT","lineNumber":105,"content":"                      // Email/Username Field"},{"type":"INSERT","lineNumber":106,"content":"                      TextFormField("},{"type":"INSERT","lineNumber":107,"content":"                        controller: _emailController,"},{"type":"INSERT","lineNumber":108,"content":"                        decoration: InputDecoration("},{"type":"INSERT","lineNumber":109,"content":"                          labelText: 'Username or Mobile number',"},{"type":"INSERT","lineNumber":110,"content":"                          prefixIcon: const Icon(Icons.person_outline, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":111,"content":"                          border: OutlineInputBorder("},{"type":"INSERT","lineNumber":112,"content":"                            borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":113,"content":"                            borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":220,"oldContent":"                        )"},{"type":"DELETE","lineNumber":221,"oldContent":"                      : const Text("},{"type":"DELETE","lineNumber":222,"oldContent":"                          'Login',"},{"type":"DELETE","lineNumber":223,"oldContent":"                          style: TextStyle(fontSize: 16),"},{"type":"INSERT","lineNumber":115,"content":"                          enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":116,"content":"                            borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":117,"content":"                            borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":118,"content":"                          ),"},{"type":"INSERT","lineNumber":119,"content":"                          filled: true,"},{"type":"INSERT","lineNumber":120,"content":"                          fillColor: Colors.white,"},{"type":"DELETE","lineNumber":225,"oldContent":"                ),"},{"type":"DELETE","lineNumber":226,"oldContent":"                "},{"type":"DELETE","lineNumber":227,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":228,"oldContent":"                "},{"type":"DELETE","lineNumber":229,"oldContent":"                // Divider with \"or\" text"},{"type":"DELETE","lineNumber":230,"oldContent":"                Row("},{"type":"DELETE","lineNumber":231,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":232,"oldContent":"                    const Expanded(child: Divider()),"},{"type":"DELETE","lineNumber":233,"oldContent":"                    Padding("},{"type":"DELETE","lineNumber":234,"oldContent":"                      padding: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"DELETE","lineNumber":235,"oldContent":"                      child: Text("},{"type":"DELETE","lineNumber":236,"oldContent":"                        'or continue with',"},{"type":"DELETE","lineNumber":237,"oldContent":"                        style: TextStyle("},{"type":"DELETE","lineNumber":238,"oldContent":"                          color: Colors.grey[600],"},{"type":"DELETE","lineNumber":239,"oldContent":"                        ),"},{"type":"INSERT","lineNumber":122,"content":"                        keyboardType: TextInputType.emailAddress,"},{"type":"INSERT","lineNumber":123,"content":"                        validator: (value) {"},{"type":"INSERT","lineNumber":124,"content":"                          if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":125,"content":"                            return 'Please enter your email or mobile number';"},{"type":"INSERT","lineNumber":126,"content":"                          }"},{"type":"INSERT","lineNumber":127,"content":"                          return null;"},{"type":"INSERT","lineNumber":128,"content":"                        },"},{"type":"DELETE","lineNumber":241,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":242,"oldContent":"                    const Expanded(child: Divider()),"},{"type":"DELETE","lineNumber":243,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":244,"oldContent":"                ),"},{"type":"DELETE","lineNumber":245,"oldContent":"                "},{"type":"DELETE","lineNumber":246,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":247,"oldContent":"                "},{"type":"DELETE","lineNumber":248,"oldContent":"                // Social login buttons"},{"type":"DELETE","lineNumber":249,"oldContent":"                ConstrainedBox("},{"type":"DELETE","lineNumber":250,"oldContent":"                  constraints: const BoxConstraints(maxWidth: 300),"},{"type":"DELETE","lineNumber":251,"oldContent":"                  child: Row("},{"type":"DELETE","lineNumber":252,"oldContent":"                    mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":253,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":254,"oldContent":"                      // Google"},{"type":"DELETE","lineNumber":255,"oldContent":"                      Expanded("},{"type":"DELETE","lineNumber":256,"oldContent":"                        child: IconButton("},{"type":"DELETE","lineNumber":257,"oldContent":"                          onPressed: () {"},{"type":"DELETE","lineNumber":258,"oldContent":"                            // TODO: Implement Google sign in"},{"type":"DELETE","lineNumber":259,"oldContent":"                          },"},{"type":"DELETE","lineNumber":260,"oldContent":"                          style: IconButton.styleFrom("},{"type":"DELETE","lineNumber":261,"oldContent":"                            backgroundColor: Colors.grey[100],"},{"type":"DELETE","lineNumber":262,"oldContent":"                            padding: const EdgeInsets.symmetric(vertical: 12, horizontal: 16),"},{"type":"DELETE","lineNumber":263,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":264,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":130,"content":"                      "},{"type":"INSERT","lineNumber":131,"content":"                      const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":132,"content":"                      "},{"type":"INSERT","lineNumber":133,"content":"                      // Password Field"},{"type":"INSERT","lineNumber":134,"content":"                      TextFormField("},{"type":"INSERT","lineNumber":135,"content":"                        controller: _passwordController,"},{"type":"INSERT","lineNumber":136,"content":"                        obscureText: _obscurePassword,"},{"type":"INSERT","lineNumber":137,"content":"                        decoration: InputDecoration("},{"type":"INSERT","lineNumber":138,"content":"                          labelText: 'Password',"},{"type":"INSERT","lineNumber":139,"content":"                          prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":140,"content":"                          suffixIcon: IconButton("},{"type":"INSERT","lineNumber":141,"content":"                            icon: Icon("},{"type":"INSERT","lineNumber":142,"content":"                              _obscurePassword ? Icons.visibility_off : Icons.visibility,"},{"type":"INSERT","lineNumber":143,"content":"                              color: const Color(0xFF757575),"},{"type":"INSERT","lineNumber":145,"content":"                            onPressed: () {"},{"type":"INSERT","lineNumber":146,"content":"                              setState(() {"},{"type":"INSERT","lineNumber":147,"content":"                                _obscurePassword = !_obscurePassword;"},{"type":"INSERT","lineNumber":148,"content":"                              });"},{"type":"INSERT","lineNumber":149,"content":"                            },"},{"type":"DELETE","lineNumber":267,"oldContent":"                          icon: SvgPicture.asset("},{"type":"DELETE","lineNumber":268,"oldContent":"                            'assets/images/google.svg',"},{"type":"DELETE","lineNumber":269,"oldContent":"                            width: 24,"},{"type":"DELETE","lineNumber":270,"oldContent":"                            height: 24,"},{"type":"INSERT","lineNumber":151,"content":"                          border: OutlineInputBorder("},{"type":"INSERT","lineNumber":152,"content":"                            borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":153,"content":"                            borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":155,"content":"                          enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":156,"content":"                            borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":157,"content":"                            borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":158,"content":"                          ),"},{"type":"INSERT","lineNumber":159,"content":"                          filled: true,"},{"type":"INSERT","lineNumber":160,"content":"                          fillColor: Colors.white,"},{"type":"INSERT","lineNumber":162,"content":"                        validator: (value) {"},{"type":"INSERT","lineNumber":163,"content":"                          if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":164,"content":"                            return 'Please enter your password';"},{"type":"INSERT","lineNumber":165,"content":"                          }"},{"type":"INSERT","lineNumber":166,"content":"                          if (value.length < 6) {"},{"type":"INSERT","lineNumber":167,"content":"                            return 'Password must be at least 6 characters';"},{"type":"INSERT","lineNumber":168,"content":"                          }"},{"type":"INSERT","lineNumber":169,"content":"                          return null;"},{"type":"INSERT","lineNumber":170,"content":"                        },"},{"type":"DELETE","lineNumber":275,"oldContent":"                      const SizedBox(width: 16),"},{"type":"INSERT","lineNumber":173,"content":"                      // Remember Me & Forgot Password"},{"type":"INSERT","lineNumber":174,"content":"                      Padding("},{"type":"INSERT","lineNumber":175,"content":"                        padding: const EdgeInsets.symmetric(vertical: 12.0),"},{"type":"INSERT","lineNumber":176,"content":"                        child: Row("},{"type":"INSERT","lineNumber":177,"content":"                          mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":178,"content":"                          children: ["},{"type":"INSERT","lineNumber":179,"content":"                            // Remember Me"},{"type":"INSERT","lineNumber":180,"content":"                            Row("},{"type":"INSERT","lineNumber":181,"content":"                              children: ["},{"type":"INSERT","lineNumber":182,"content":"                                Checkbox("},{"type":"INSERT","lineNumber":183,"content":"                                  value: _rememberMe,"},{"type":"INSERT","lineNumber":184,"content":"                                  onChanged: (value) {"},{"type":"INSERT","lineNumber":185,"content":"                                    setState(() {"},{"type":"INSERT","lineNumber":186,"content":"                                      _rememberMe = value ?? false;"},{"type":"INSERT","lineNumber":187,"content":"                                    });"},{"type":"INSERT","lineNumber":188,"content":"                                  },"},{"type":"INSERT","lineNumber":189,"content":"                                  activeColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":190,"content":"                                ),"},{"type":"INSERT","lineNumber":191,"content":"                                Text("},{"type":"INSERT","lineNumber":192,"content":"                                  'Remember Me',"},{"type":"INSERT","lineNumber":193,"content":"                                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":194,"content":"                                    color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":195,"content":"                                    fontSize: 14,"},{"type":"INSERT","lineNumber":196,"content":"                                  ),"},{"type":"INSERT","lineNumber":197,"content":"                                ),"},{"type":"INSERT","lineNumber":198,"content":"                              ],"},{"type":"INSERT","lineNumber":199,"content":"                            ),"},{"type":"INSERT","lineNumber":200,"content":"                            // Forgot Password"},{"type":"INSERT","lineNumber":201,"content":"                            TextButton("},{"type":"INSERT","lineNumber":202,"content":"                              onPressed: () {"},{"type":"INSERT","lineNumber":203,"content":"                                // TODO: Implement forgot password"},{"type":"INSERT","lineNumber":204,"content":"                              },"},{"type":"INSERT","lineNumber":205,"content":"                              child: Text("},{"type":"INSERT","lineNumber":206,"content":"                                'Forgot Password?',"},{"type":"INSERT","lineNumber":207,"content":"                                style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":208,"content":"                                  color: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":209,"content":"                                  fontSize: 14,"},{"type":"INSERT","lineNumber":210,"content":"                                  fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":211,"content":"                                ),"},{"type":"INSERT","lineNumber":212,"content":"                              ),"},{"type":"INSERT","lineNumber":213,"content":"                            ),"},{"type":"INSERT","lineNumber":214,"content":"                          ],"},{"type":"INSERT","lineNumber":215,"content":"                        ),"},{"type":"INSERT","lineNumber":216,"content":"                      ),"},{"type":"DELETE","lineNumber":277,"oldContent":"                      // Apple"},{"type":"DELETE","lineNumber":278,"oldContent":"                      Expanded("},{"type":"DELETE","lineNumber":279,"oldContent":"                        child: IconButton("},{"type":"DELETE","lineNumber":280,"oldContent":"                          onPressed: () {"},{"type":"DELETE","lineNumber":281,"oldContent":"                            // TODO: Implement Apple sign in"},{"type":"DELETE","lineNumber":282,"oldContent":"                          },"},{"type":"DELETE","lineNumber":283,"oldContent":"                          style: IconButton.styleFrom("},{"type":"DELETE","lineNumber":284,"oldContent":"                            backgroundColor: Colors.grey[100],"},{"type":"DELETE","lineNumber":285,"oldContent":"                            padding: const EdgeInsets.symmetric(vertical: 12, horizontal: 16),"},{"type":"DELETE","lineNumber":286,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":287,"oldContent":"                              borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":218,"content":"                      const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":219,"content":"                      "},{"type":"INSERT","lineNumber":220,"content":"                      // Login Button"},{"type":"INSERT","lineNumber":221,"content":"                      BlocBuilder<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":222,"content":"                        builder: (context, state) {"},{"type":"INSERT","lineNumber":223,"content":"                          return SizedBox("},{"type":"INSERT","lineNumber":224,"content":"                            width: double.infinity,"},{"type":"INSERT","lineNumber":225,"content":"                            height: 56,"},{"type":"INSERT","lineNumber":226,"content":"                            child: ElevatedButton("},{"type":"INSERT","lineNumber":227,"content":"                              onPressed: state.status == AuthStatus.loading"},{"type":"INSERT","lineNumber":228,"content":"                                  ? null"},{"type":"INSERT","lineNumber":229,"content":"                                  : _onLoginPressed,"},{"type":"INSERT","lineNumber":230,"content":"                              style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":231,"content":"                                backgroundColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":232,"content":"                                shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":233,"content":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":234,"content":"                                ),"},{"type":"INSERT","lineNumber":235,"content":"                                elevation: 0,"},{"type":"INSERT","lineNumber":236,"content":"                              ),"},{"type":"INSERT","lineNumber":237,"content":"                              child: state.status == AuthStatus.loading"},{"type":"INSERT","lineNumber":238,"content":"                                  ? const SizedBox("},{"type":"INSERT","lineNumber":239,"content":"                                      width: 24,"},{"type":"INSERT","lineNumber":240,"content":"                                      height: 24,"},{"type":"INSERT","lineNumber":241,"content":"                                      child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":242,"content":"                                        color: Colors.white,"},{"type":"INSERT","lineNumber":243,"content":"                                        strokeWidth: 2,"},{"type":"INSERT","lineNumber":244,"content":"                                      ),"},{"type":"INSERT","lineNumber":245,"content":"                                    )"},{"type":"INSERT","lineNumber":246,"content":"                                  : Text("},{"type":"INSERT","lineNumber":247,"content":"                                      'LOGIN',"},{"type":"INSERT","lineNumber":248,"content":"                                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":249,"content":"                                        fontSize: 16,"},{"type":"INSERT","lineNumber":250,"content":"                                        fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":251,"content":"                                        color: Colors.white,"},{"type":"INSERT","lineNumber":252,"content":"                                      ),"},{"type":"INSERT","lineNumber":253,"content":"                                    ),"},{"type":"INSERT","lineNumber":255,"content":"                          );"},{"type":"INSERT","lineNumber":256,"content":"                        },"},{"type":"INSERT","lineNumber":257,"content":"                      ),"},{"type":"INSERT","lineNumber":258,"content":"                      "},{"type":"INSERT","lineNumber":259,"content":"                      const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":260,"content":"                      "},{"type":"INSERT","lineNumber":261,"content":"                      // Sign Up Link"},{"type":"INSERT","lineNumber":262,"content":"                      Row("},{"type":"INSERT","lineNumber":263,"content":"                        mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":264,"content":"                        children: ["},{"type":"INSERT","lineNumber":265,"content":"                          Text("},{"type":"INSERT","lineNumber":266,"content":"                            'Don\\'t Have Account? ',"},{"type":"INSERT","lineNumber":267,"content":"                            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":268,"content":"                              color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":269,"content":"                              fontSize: 14,"},{"type":"INSERT","lineNumber":270,"content":"                            ),"},{"type":"DELETE","lineNumber":290,"oldContent":"                          icon: const Icon("},{"type":"DELETE","lineNumber":291,"oldContent":"                            Icons.apple,"},{"type":"DELETE","lineNumber":292,"oldContent":"                            size: 24,"},{"type":"DELETE","lineNumber":293,"oldContent":"                            color: Colors.black,"},{"type":"INSERT","lineNumber":272,"content":"                          TextButton("},{"type":"INSERT","lineNumber":273,"content":"                            onPressed: () {"},{"type":"INSERT","lineNumber":274,"content":"                              Navigator.push("},{"type":"INSERT","lineNumber":275,"content":"                                context,"},{"type":"INSERT","lineNumber":276,"content":"                                MaterialPageRoute("},{"type":"INSERT","lineNumber":277,"content":"                                  builder: (context) => const RegisterScreen(),"},{"type":"INSERT","lineNumber":278,"content":"                                ),"},{"type":"INSERT","lineNumber":279,"content":"                              );"},{"type":"INSERT","lineNumber":280,"content":"                            },"},{"type":"INSERT","lineNumber":281,"content":"                            style: TextButton.styleFrom("},{"type":"INSERT","lineNumber":282,"content":"                              padding: EdgeInsets.zero,"},{"type":"INSERT","lineNumber":283,"content":"                              minimumSize: Size.zero,"},{"type":"INSERT","lineNumber":284,"content":"                              tapTargetSize: MaterialTapTargetSize.shrinkWrap,"},{"type":"INSERT","lineNumber":285,"content":"                            ),"},{"type":"INSERT","lineNumber":286,"content":"                            child: Text("},{"type":"INSERT","lineNumber":287,"content":"                              'Signup',"},{"type":"INSERT","lineNumber":288,"content":"                              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":289,"content":"                                color: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":290,"content":"                                fontSize: 14,"},{"type":"INSERT","lineNumber":291,"content":"                                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":292,"content":"                              ),"},{"type":"INSERT","lineNumber":293,"content":"                            ),"},{"type":"MODIFY","lineNumber":295,"content":"                        ],","oldContent":"                        ),"},{"type":"INSERT","lineNumber":297,"content":"                      "},{"type":"INSERT","lineNumber":298,"content":"                      const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":300,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":301,"oldContent":"                "},{"type":"DELETE","lineNumber":302,"oldContent":"                "},{"type":"DELETE","lineNumber":303,"oldContent":"                // Sign up link"},{"type":"DELETE","lineNumber":304,"oldContent":"                Row("},{"type":"DELETE","lineNumber":305,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":306,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":307,"oldContent":"                    const Text(\"Don't have an account?\"),"},{"type":"DELETE","lineNumber":308,"oldContent":"                    TextButton("},{"type":"DELETE","lineNumber":309,"oldContent":"                      onPressed: () {"},{"type":"DELETE","lineNumber":310,"oldContent":"                        Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":311,"oldContent":"                          context,"},{"type":"DELETE","lineNumber":312,"oldContent":"                          AppConstants.registerRoute,"},{"type":"DELETE","lineNumber":313,"oldContent":"                        );"},{"type":"DELETE","lineNumber":314,"oldContent":"                      },"},{"type":"DELETE","lineNumber":315,"oldContent":"                      child: const Text('Sign Up'),"},{"type":"DELETE","lineNumber":316,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":317,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":318,"oldContent":"                ),"},{"type":"DELETE","lineNumber":319,"oldContent":"              ],"},{"type":"DELETE","lineNumber":320,"oldContent":"            ),"},{"type":"INSERT","lineNumber":302,"content":"              ),"},{"type":"INSERT","lineNumber":303,"content":"            ],"},{"type":"DELETE","lineNumber":323,"oldContent":"          ),"},{"type":"DELETE","lineNumber":324,"oldContent":"        );"},{"type":"DELETE","lineNumber":325,"oldContent":"        ),"},{"type":"DELETE","lineNumber":326,"oldContent":"      },"},{"type":"INSERT","lineNumber":306,"content":"      ),"},{"type":"INSERT","lineNumber":307,"content":"    );"}]},{"timestamp":1754632305772,"changes":[{"type":"INSERT","lineNumber":6,"content":"class LoginScreen extends StatefulWidget {"},{"type":"DELETE","lineNumber":7,"oldContent":"  const LoginScreen({super.key});"},{"type":"INSERT","lineNumber":9,"content":"  @override"},{"type":"DELETE","lineNumber":10,"oldContent":"  State<LoginScreen> createState() => _LoginScreenState();"},{"type":"MODIFY","lineNumber":17,"content":"  bool _rememberMe = false;","oldContent":"  bool _rememberMe = false;"},{"type":"INSERT","lineNumber":21,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":22,"content":"    _emailController.dispose();"},{"type":"INSERT","lineNumber":23,"content":"    _passwordController.dispose();"},{"type":"INSERT","lineNumber":24,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":25,"content":"  }"},{"type":"INSERT","lineNumber":26,"content":""},{"type":"DELETE","lineNumber":24,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":26,"oldContent":"    _emailController.dispose();"},{"type":"DELETE","lineNumber":28,"oldContent":"    _passwordController.dispose();"},{"type":"DELETE","lineNumber":31,"oldContent":"    super.dispose();"},{"type":"INSERT","lineNumber":35,"content":"    }"},{"type":"INSERT","lineNumber":38,"content":"  @override"},{"type":"INSERT","lineNumber":39,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":49,"content":"        child: SingleChildScrollView("},{"type":"DELETE","lineNumber":45,"oldContent":"    }"},{"type":"DELETE","lineNumber":49,"oldContent":"  }"},{"type":"DELETE","lineNumber":53,"oldContent":""},{"type":"DELETE","lineNumber":54,"oldContent":"                    image: AssetImage('assets/images/family_header.png'),"},{"type":"INSERT","lineNumber":57,"content":"                    image: AssetImage('assets/images/rajiv-perera-_JjYYsQPneE-unsplash (1).jpg'),"},{"type":"INSERT","lineNumber":59,"content":"                  ),"},{"type":"INSERT","lineNumber":60,"content":"                ),"},{"type":"INSERT","lineNumber":70,"content":"                    ),"},{"type":"INSERT","lineNumber":71,"content":"                  ),"},{"type":"DELETE","lineNumber":72,"oldContent":"  @override"},{"type":"DELETE","lineNumber":73,"oldContent":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":79,"content":"                      ),"},{"type":"INSERT","lineNumber":80,"content":"                    ),"},{"type":"INSERT","lineNumber":81,"content":"                  ),"},{"type":"INSERT","lineNumber":82,"content":"                ),"},{"type":"DELETE","lineNumber":76,"oldContent":"        child: SingleChildScrollView("},{"type":"INSERT","lineNumber":94,"content":"                  ),"},{"type":"INSERT","lineNumber":95,"content":"                ),"},{"type":"INSERT","lineNumber":114,"content":"                          ),"},{"type":"DELETE","lineNumber":107,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":109,"oldContent":"                ),"},{"type":"INSERT","lineNumber":121,"content":"                        ),"},{"type":"INSERT","lineNumber":129,"content":"                      ),"},{"type":"DELETE","lineNumber":129,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":131,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":144,"content":"                            ),"},{"type":"INSERT","lineNumber":150,"content":"                          ),"},{"type":"INSERT","lineNumber":154,"content":"                          ),"},{"type":"INSERT","lineNumber":161,"content":"                        ),"},{"type":"DELETE","lineNumber":154,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":159,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":171,"content":"                      ),"},{"type":"INSERT","lineNumber":172,"content":"                      "},{"type":"DELETE","lineNumber":164,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":175,"oldContent":"                ),"},{"type":"DELETE","lineNumber":188,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":190,"oldContent":"                ),"},{"type":"INSERT","lineNumber":217,"content":"                      "},{"type":"DELETE","lineNumber":210,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":216,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":233,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":254,"content":"                            ),"},{"type":"DELETE","lineNumber":258,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":260,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":267,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":269,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":271,"oldContent":"                      "},{"type":"DELETE","lineNumber":274,"oldContent":"                      "},{"type":"DELETE","lineNumber":287,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":289,"oldContent":"                          ),"},{"type":"MODIFY","lineNumber":299,"content":"                    ],","oldContent":"                    ],"},{"type":"DELETE","lineNumber":304,"oldContent":"      ),"},{"type":"MODIFY","lineNumber":306,"content":"      ),","oldContent":"    );"},{"type":"INSERT","lineNumber":307,"content":"    );"}]},{"timestamp":1754638457438,"changes":[{"type":"INSERT","lineNumber":16,"content":"  final _passwordController = TextEditingController();"},{"type":"DELETE","lineNumber":17,"oldContent":"  bool _rememberMe = false;"},{"type":"DELETE","lineNumber":22,"oldContent":"  void _onLoginPressed() {"},{"type":"DELETE","lineNumber":24,"oldContent":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"DELETE","lineNumber":26,"oldContent":"      context.read<AuthBloc>().add("},{"type":"DELETE","lineNumber":29,"oldContent":"            LoginRequested("},{"type":"INSERT","lineNumber":27,"content":"  void _onLoginPressed() {"},{"type":"INSERT","lineNumber":28,"content":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"INSERT","lineNumber":29,"content":"      context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":30,"content":"            LoginRequested("},{"type":"INSERT","lineNumber":35,"content":"    }"},{"type":"DELETE","lineNumber":37,"oldContent":"    }"},{"type":"INSERT","lineNumber":38,"content":"  @override"},{"type":"INSERT","lineNumber":39,"content":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":41,"oldContent":"  @override"},{"type":"DELETE","lineNumber":43,"oldContent":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":49,"content":"        child: SingleChildScrollView("},{"type":"DELETE","lineNumber":53,"oldContent":"        child: SingleChildScrollView("},{"type":"INSERT","lineNumber":57,"content":"                    image: AssetImage('assets/images/rajiv-perera-_JjYYsQPneE-unsplash (1).jpg'),"},{"type":"INSERT","lineNumber":59,"content":"                  ),"},{"type":"INSERT","lineNumber":60,"content":"                ),"},{"type":"DELETE","lineNumber":59,"oldContent":"                    image: AssetImage('assets/images/rajiv-perera-_JjYYsQPneE-unsplash (1).jpg'),"},{"type":"DELETE","lineNumber":62,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":64,"oldContent":"                ),"},{"type":"INSERT","lineNumber":70,"content":"                    ),"},{"type":"INSERT","lineNumber":71,"content":"                  ),"},{"type":"DELETE","lineNumber":75,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":77,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":79,"content":"                      ),"},{"type":"INSERT","lineNumber":80,"content":"                    ),"},{"type":"INSERT","lineNumber":81,"content":"                  ),"},{"type":"INSERT","lineNumber":82,"content":"                ),"},{"type":"DELETE","lineNumber":83,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":85,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":87,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":89,"oldContent":"                ),"},{"type":"INSERT","lineNumber":94,"content":"                  ),"},{"type":"INSERT","lineNumber":95,"content":"                ),"},{"type":"DELETE","lineNumber":102,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":104,"oldContent":"                ),"},{"type":"INSERT","lineNumber":114,"content":"                          ),"},{"type":"INSERT","lineNumber":121,"content":"                        ),"},{"type":"DELETE","lineNumber":122,"oldContent":"                          ),"},{"type":"INSERT","lineNumber":129,"content":"                      ),"},{"type":"DELETE","lineNumber":130,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":139,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":144,"content":"                            ),"},{"type":"INSERT","lineNumber":150,"content":"                          ),"},{"type":"INSERT","lineNumber":154,"content":"                          ),"},{"type":"DELETE","lineNumber":153,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":161,"content":"                        ),"},{"type":"DELETE","lineNumber":160,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":165,"oldContent":"                          ),"},{"type":"INSERT","lineNumber":171,"content":"                      ),"},{"type":"INSERT","lineNumber":172,"content":"                      "},{"type":"DELETE","lineNumber":171,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":181,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":183,"oldContent":"                      "},{"type":"INSERT","lineNumber":217,"content":"                      "},{"type":"DELETE","lineNumber":224,"oldContent":"                      "},{"type":"INSERT","lineNumber":254,"content":"                            ),"},{"type":"DELETE","lineNumber":261,"oldContent":"                            ),"},{"type":"MODIFY","lineNumber":274,"content":"                              // Navigate to registration screen with flag indicating it's not the first time","oldContent":"                              Navigator.push("},{"type":"INSERT","lineNumber":275,"content":"                              Navigator.pushReplacement("},{"type":"INSERT","lineNumber":279,"content":"                                  settings: const RouteSettings(arguments: false),"},{"type":"INSERT","lineNumber":300,"content":"                      const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":299,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":304,"oldContent":"    );"},{"type":"INSERT","lineNumber":306,"content":"          ),"},{"type":"INSERT","lineNumber":307,"content":"        ),"},{"type":"DELETE","lineNumber":307,"oldContent":"        ),"}]},{"timestamp":1754644941670,"changes":[{"type":"DELETE","lineNumber":24,"oldContent":"  void _onLoginPressed() {"},{"type":"MODIFY","lineNumber":26,"content":"","oldContent":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"INSERT","lineNumber":27,"content":"  void _onLoginPressed() {"},{"type":"INSERT","lineNumber":28,"content":"    if (_formKey.currentState?.validate() ?? false) {"},{"type":"DELETE","lineNumber":30,"oldContent":""},{"type":"DELETE","lineNumber":39,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":41,"oldContent":"      body: BlocListener<AuthBloc, AuthState>("},{"type":"DELETE","lineNumber":42,"oldContent":"        listener: (context, state) {"},{"type":"DELETE","lineNumber":43,"oldContent":"          if (state.status == AuthStatus.error) {"},{"type":"DELETE","lineNumber":44,"oldContent":"            ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":45,"oldContent":"              SnackBar(content: Text(state.error ?? 'An error occurred')),"},{"type":"DELETE","lineNumber":46,"oldContent":"            );"},{"type":"DELETE","lineNumber":47,"oldContent":"          }"},{"type":"DELETE","lineNumber":48,"oldContent":"        },"},{"type":"INSERT","lineNumber":40,"content":"    return BlocListener<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":41,"content":"      listener: (context, state) {"},{"type":"INSERT","lineNumber":42,"content":"        if (state.status == AuthStatus.otpSent) {"},{"type":"INSERT","lineNumber":43,"content":"          // Navigate to OTP verification screen"},{"type":"INSERT","lineNumber":44,"content":"          Navigator.push("},{"type":"INSERT","lineNumber":45,"content":"            context,"},{"type":"INSERT","lineNumber":46,"content":"            MaterialPageRoute("},{"type":"INSERT","lineNumber":47,"content":"              builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":48,"content":"                verificationId: state.verificationId!,"},{"type":"INSERT","lineNumber":49,"content":"                phoneNumber: state.phoneNumber ?? '',"},{"type":"INSERT","lineNumber":50,"content":"                isRegistration: false,"},{"type":"INSERT","lineNumber":51,"content":"              ),"},{"type":"INSERT","lineNumber":52,"content":"            ),"},{"type":"INSERT","lineNumber":53,"content":"          );"},{"type":"INSERT","lineNumber":54,"content":"        } else if (state.status == AuthStatus.error) {"},{"type":"INSERT","lineNumber":55,"content":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":56,"content":"            SnackBar("},{"type":"INSERT","lineNumber":57,"content":"              content: Text(state.error ?? 'An error occurred'),"},{"type":"INSERT","lineNumber":58,"content":"              backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":59,"content":"            ),"},{"type":"INSERT","lineNumber":60,"content":"          );"},{"type":"INSERT","lineNumber":61,"content":"        }"},{"type":"INSERT","lineNumber":62,"content":"      },"},{"type":"DELETE","lineNumber":59,"oldContent":"                child: Container("},{"type":"INSERT","lineNumber":75,"content":"                child: Container("},{"type":"DELETE","lineNumber":71,"oldContent":"                  child: Center("},{"type":"INSERT","lineNumber":86,"content":"                  child: Center("},{"type":"DELETE","lineNumber":80,"oldContent":"              ),"},{"type":"DELETE","lineNumber":82,"oldContent":"              "},{"type":"DELETE","lineNumber":84,"oldContent":"              // Welcome Back Text"},{"type":"INSERT","lineNumber":97,"content":"              ),"},{"type":"INSERT","lineNumber":98,"content":"              "},{"type":"INSERT","lineNumber":99,"content":"              // Welcome Back Text"},{"type":"DELETE","lineNumber":95,"oldContent":"              ),"},{"type":"INSERT","lineNumber":110,"content":"              ),"},{"type":"DELETE","lineNumber":121,"oldContent":"                        keyboardType: TextInputType.emailAddress,"},{"type":"INSERT","lineNumber":136,"content":"                        keyboardType: TextInputType.emailAddress,"},{"type":"DELETE","lineNumber":129,"oldContent":"                      "},{"type":"INSERT","lineNumber":144,"content":"                      "},{"type":"DELETE","lineNumber":150,"oldContent":"                          border: OutlineInputBorder("},{"type":"INSERT","lineNumber":165,"content":"                          border: OutlineInputBorder("},{"type":"DELETE","lineNumber":154,"oldContent":"                          enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":169,"content":"                          enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":161,"oldContent":"                        validator: (value) {"},{"type":"INSERT","lineNumber":176,"content":"                        validator: (value) {"},{"type":"DELETE","lineNumber":171,"oldContent":"                      // Remember Me & Forgot Password"},{"type":"INSERT","lineNumber":187,"content":"                      // Remember Me & Forgot Password"},{"type":"DELETE","lineNumber":279,"oldContent":"                                ),"},{"type":"INSERT","lineNumber":294,"content":"                                ),"},{"type":"DELETE","lineNumber":300,"oldContent":"                    ],"},{"type":"INSERT","lineNumber":315,"content":"                    ],"},{"type":"DELETE","lineNumber":306,"oldContent":"      ),"},{"type":"DELETE","lineNumber":308,"oldContent":"    );"},{"type":"INSERT","lineNumber":322,"content":"      ),"},{"type":"INSERT","lineNumber":323,"content":"    );"}]},{"timestamp":1754645031830,"changes":[{"type":"INSERT","lineNumber":5,"content":"import 'otp_verification_screen.dart';"},{"type":"INSERT","lineNumber":6,"content":"import 'success_screen.dart';"},{"type":"INSERT","lineNumber":19,"content":"  final _phoneController = TextEditingController();"},{"type":"INSERT","lineNumber":22,"content":"  bool _isPhoneLogin = false;"},{"type":"INSERT","lineNumber":28,"content":"    _phoneController.dispose();"},{"type":"INSERT","lineNumber":30,"content":"  }"},{"type":"DELETE","lineNumber":27,"oldContent":"  }"},{"type":"DELETE","lineNumber":29,"oldContent":"      context.read<AuthBloc>().add("},{"type":"DELETE","lineNumber":30,"oldContent":"            LoginRequested("},{"type":"DELETE","lineNumber":31,"oldContent":"              email: _emailController.text.trim(),"},{"type":"DELETE","lineNumber":32,"oldContent":"              password: _passwordController.text.trim(),"},{"type":"DELETE","lineNumber":33,"oldContent":"            ),"},{"type":"MODIFY","lineNumber":34,"content":"      if (_isPhoneLogin) {","oldContent":"          );"},{"type":"INSERT","lineNumber":35,"content":"        // Handle phone number login"},{"type":"INSERT","lineNumber":36,"content":"        context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":37,"content":"              SendOtpRequested(_phoneController.text.trim()),"},{"type":"INSERT","lineNumber":38,"content":"            );"},{"type":"INSERT","lineNumber":39,"content":"      } else {"},{"type":"INSERT","lineNumber":40,"content":"        // Handle email/password login"},{"type":"INSERT","lineNumber":41,"content":"        context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":42,"content":"              LoginRequested("},{"type":"INSERT","lineNumber":43,"content":"                email: _emailController.text.trim(),"},{"type":"INSERT","lineNumber":44,"content":"                password: _passwordController.text.trim(),"},{"type":"INSERT","lineNumber":45,"content":"              ),"},{"type":"INSERT","lineNumber":46,"content":"            );"},{"type":"INSERT","lineNumber":47,"content":"      }"},{"type":"DELETE","lineNumber":39,"oldContent":"    return BlocListener<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":53,"content":"    return BlocListener<AuthBloc, AuthState>("},{"type":"DELETE","lineNumber":50,"oldContent":"        child: SingleChildScrollView("},{"type":"DELETE","lineNumber":52,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":54,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":56,"oldContent":"              // Header with Image"},{"type":"DELETE","lineNumber":58,"oldContent":"              Container("},{"type":"DELETE","lineNumber":60,"oldContent":"                height: 250,"},{"type":"DELETE","lineNumber":62,"oldContent":"                decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":64,"oldContent":"                  image: DecorationImage("},{"type":"DELETE","lineNumber":66,"oldContent":"                    image: AssetImage('assets/images/rajiv-perera-_JjYYsQPneE-unsplash (1).jpg'),"},{"type":"DELETE","lineNumber":68,"oldContent":"                    fit: BoxFit.cover,"},{"type":"DELETE","lineNumber":71,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":73,"oldContent":"                ),"},{"type":"INSERT","lineNumber":76,"content":"        child: SingleChildScrollView("},{"type":"INSERT","lineNumber":77,"content":"          child: Column("},{"type":"INSERT","lineNumber":78,"content":"            children: ["},{"type":"INSERT","lineNumber":79,"content":"              // Header with Image"},{"type":"INSERT","lineNumber":80,"content":"              Container("},{"type":"INSERT","lineNumber":81,"content":"                height: 250,"},{"type":"INSERT","lineNumber":82,"content":"                decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":83,"content":"                  image: DecorationImage("},{"type":"INSERT","lineNumber":84,"content":"                    image: AssetImage('assets/images/rajiv-perera-_JjYYsQPneE-unsplash (1).jpg'),"},{"type":"INSERT","lineNumber":85,"content":"                    fit: BoxFit.cover,"},{"type":"INSERT","lineNumber":86,"content":"                  ),"},{"type":"INSERT","lineNumber":87,"content":"                ),"},{"type":"INSERT","lineNumber":88,"content":"                child: Container("},{"type":"INSERT","lineNumber":99,"content":"                  child: Center("},{"type":"DELETE","lineNumber":87,"oldContent":"                child: Container("},{"type":"DELETE","lineNumber":96,"oldContent":"                  child: Center("},{"type":"INSERT","lineNumber":110,"content":"              ),"},{"type":"INSERT","lineNumber":111,"content":"              "},{"type":"INSERT","lineNumber":112,"content":"              // Welcome Back Text"},{"type":"DELETE","lineNumber":109,"oldContent":"              "},{"type":"DELETE","lineNumber":111,"oldContent":"              // Welcome Back Text"},{"type":"DELETE","lineNumber":118,"oldContent":"                      // Email/Username Field"},{"type":"DELETE","lineNumber":119,"oldContent":"                      TextFormField("},{"type":"DELETE","lineNumber":120,"oldContent":"                        controller: _emailController,"},{"type":"DELETE","lineNumber":121,"oldContent":"                        decoration: InputDecoration("},{"type":"DELETE","lineNumber":122,"oldContent":"                          labelText: 'Username or Mobile number',"},{"type":"DELETE","lineNumber":123,"oldContent":"              ),"},{"type":"DELETE","lineNumber":124,"oldContent":"                          prefixIcon: const Icon(Icons.person_outline, color: Color(0xFF757575)),"},{"type":"DELETE","lineNumber":125,"oldContent":"                          border: OutlineInputBorder("},{"type":"DELETE","lineNumber":126,"oldContent":"                            borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":127,"oldContent":"                            borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":132,"content":"                      // Toggle between email and phone login"},{"type":"INSERT","lineNumber":133,"content":"                      Row("},{"type":"INSERT","lineNumber":134,"content":"                        mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":135,"content":"                        children: ["},{"type":"INSERT","lineNumber":136,"content":"                          Text("},{"type":"INSERT","lineNumber":137,"content":"                            'Use Phone Number',"},{"type":"INSERT","lineNumber":138,"content":"                            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":139,"content":"                              color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":140,"content":"                              fontSize: 14,"},{"type":"INSERT","lineNumber":141,"content":"                            ),"},{"type":"DELETE","lineNumber":129,"oldContent":"                          enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":130,"oldContent":"                            borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":131,"oldContent":"                            borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":143,"content":"                          Switch("},{"type":"INSERT","lineNumber":144,"content":"                            value: _isPhoneLogin,"},{"type":"INSERT","lineNumber":145,"content":"                            onChanged: (value) {"},{"type":"INSERT","lineNumber":146,"content":"                              setState(() {"},{"type":"INSERT","lineNumber":147,"content":"                                _isPhoneLogin = value;"},{"type":"INSERT","lineNumber":148,"content":"                              });"},{"type":"INSERT","lineNumber":149,"content":"                            },"},{"type":"INSERT","lineNumber":150,"content":"                            activeColor: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":133,"oldContent":"                          filled: true,"},{"type":"DELETE","lineNumber":134,"oldContent":"                          fillColor: Colors.white,"},{"type":"DELETE","lineNumber":135,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":136,"oldContent":"                        validator: (value) {"},{"type":"DELETE","lineNumber":137,"oldContent":"                          if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":138,"oldContent":"                            return 'Please enter your email or mobile number';"},{"type":"DELETE","lineNumber":139,"oldContent":"                          }"},{"type":"DELETE","lineNumber":140,"oldContent":"                          return null;"},{"type":"DELETE","lineNumber":141,"oldContent":"                        },"},{"type":"INSERT","lineNumber":152,"content":"                          Text("},{"type":"INSERT","lineNumber":153,"content":"                            'Use Email',"},{"type":"INSERT","lineNumber":154,"content":"                            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":155,"content":"                              color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":156,"content":"                              fontSize: 14,"},{"type":"INSERT","lineNumber":157,"content":"                            ),"},{"type":"INSERT","lineNumber":158,"content":"                          ),"},{"type":"INSERT","lineNumber":159,"content":"                        ],"},{"type":"DELETE","lineNumber":143,"oldContent":"                      const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":161,"content":"                      const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":145,"oldContent":"                      // Password Field"},{"type":"DELETE","lineNumber":146,"oldContent":"                      TextFormField("},{"type":"DELETE","lineNumber":147,"oldContent":"                        controller: _passwordController,"},{"type":"DELETE","lineNumber":148,"oldContent":"                        keyboardType: TextInputType.emailAddress,"},{"type":"DELETE","lineNumber":149,"oldContent":"                        obscureText: _obscurePassword,"},{"type":"DELETE","lineNumber":150,"oldContent":"                        decoration: InputDecoration("},{"type":"DELETE","lineNumber":151,"oldContent":"                          labelText: 'Password',"},{"type":"DELETE","lineNumber":152,"oldContent":"                          prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"DELETE","lineNumber":153,"oldContent":"                          suffixIcon: IconButton("},{"type":"DELETE","lineNumber":154,"oldContent":"                            icon: Icon("},{"type":"DELETE","lineNumber":155,"oldContent":"                              _obscurePassword ? Icons.visibility_off : Icons.visibility,"},{"type":"DELETE","lineNumber":156,"oldContent":"                              color: const Color(0xFF757575),"},{"type":"INSERT","lineNumber":163,"content":"                      // Email/Phone Field"},{"type":"INSERT","lineNumber":164,"content":"                      _isPhoneLogin"},{"type":"INSERT","lineNumber":165,"content":"                          ? TextFormField("},{"type":"INSERT","lineNumber":166,"content":"                              controller: _phoneController,"},{"type":"INSERT","lineNumber":167,"content":"                              decoration: InputDecoration("},{"type":"INSERT","lineNumber":168,"content":"                                labelText: 'Phone Number',"},{"type":"INSERT","lineNumber":169,"content":"                                prefixIcon: const Icon(Icons.phone, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":170,"content":"                                border: OutlineInputBorder("},{"type":"INSERT","lineNumber":171,"content":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":172,"content":"                                  borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":173,"content":"                                ),"},{"type":"INSERT","lineNumber":174,"content":"                                enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":175,"content":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":176,"content":"                                  borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":177,"content":"                                ),"},{"type":"INSERT","lineNumber":178,"content":"                                filled: true,"},{"type":"INSERT","lineNumber":179,"content":"                                fillColor: Colors.white,"},{"type":"INSERT","lineNumber":180,"content":"                                hintText: '+1 (___) ___-____',"},{"type":"INSERT","lineNumber":181,"content":"                              ),"},{"type":"INSERT","lineNumber":182,"content":"                              keyboardType: TextInputType.phone,"},{"type":"INSERT","lineNumber":183,"content":"                              validator: (value) {"},{"type":"INSERT","lineNumber":184,"content":"                                if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":185,"content":"                                  return 'Please enter your phone number';"},{"type":"INSERT","lineNumber":186,"content":"                                }"},{"type":"INSERT","lineNumber":187,"content":"                                // Simple phone number validation"},{"type":"INSERT","lineNumber":188,"content":"                                if (!RegExp(r'^[0-9+\\s\\-()]{10,}$').hasMatch(value)) {"},{"type":"INSERT","lineNumber":189,"content":"                                  return 'Please enter a valid phone number';"},{"type":"INSERT","lineNumber":190,"content":"                                }"},{"type":"INSERT","lineNumber":191,"content":"                                return null;"},{"type":"INSERT","lineNumber":192,"content":"                              },"},{"type":"INSERT","lineNumber":193,"content":"                            )"},{"type":"INSERT","lineNumber":194,"content":"                          : TextFormField("},{"type":"INSERT","lineNumber":195,"content":"                              controller: _emailController,"},{"type":"INSERT","lineNumber":196,"content":"                              decoration: InputDecoration("},{"type":"INSERT","lineNumber":197,"content":"                                labelText: 'Email',"},{"type":"INSERT","lineNumber":198,"content":"                                prefixIcon: const Icon(Icons.email_outlined, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":199,"content":"                                border: OutlineInputBorder("},{"type":"INSERT","lineNumber":200,"content":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":201,"content":"                                  borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":202,"content":"                                ),"},{"type":"INSERT","lineNumber":203,"content":"                                enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":204,"content":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":205,"content":"                                  borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":206,"content":"                                ),"},{"type":"INSERT","lineNumber":207,"content":"                                filled: true,"},{"type":"INSERT","lineNumber":208,"content":"                                fillColor: Colors.white,"},{"type":"INSERT","lineNumber":209,"content":"                              ),"},{"type":"INSERT","lineNumber":210,"content":"                              keyboardType: TextInputType.emailAddress,"},{"type":"INSERT","lineNumber":211,"content":"                              validator: (value) {"},{"type":"INSERT","lineNumber":212,"content":"                                if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":213,"content":"                                  return 'Please enter your email';"},{"type":"INSERT","lineNumber":214,"content":"                                }"},{"type":"INSERT","lineNumber":215,"content":"                                if (!RegExp(r'^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$').hasMatch(value)) {"},{"type":"INSERT","lineNumber":216,"content":"                                  return 'Please enter a valid email';"},{"type":"INSERT","lineNumber":217,"content":"                                }"},{"type":"INSERT","lineNumber":218,"content":"                                return null;"},{"type":"INSERT","lineNumber":219,"content":"                              },"},{"type":"INSERT","lineNumber":220,"content":"                            ),"},{"type":"INSERT","lineNumber":222,"content":"                      const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":223,"content":"                      "},{"type":"INSERT","lineNumber":224,"content":"                      // Password Field (only for email login)"},{"type":"INSERT","lineNumber":225,"content":"                      if (!_isPhoneLogin) ...["},{"type":"INSERT","lineNumber":226,"content":"                        const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":227,"content":"                        TextFormField("},{"type":"INSERT","lineNumber":228,"content":"                          controller: _passwordController,"},{"type":"INSERT","lineNumber":229,"content":"                          obscureText: _obscurePassword,"},{"type":"INSERT","lineNumber":230,"content":"                          decoration: InputDecoration("},{"type":"INSERT","lineNumber":231,"content":"                            labelText: 'Password',"},{"type":"INSERT","lineNumber":232,"content":"                            prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"INSERT","lineNumber":233,"content":"                            suffixIcon: IconButton("},{"type":"INSERT","lineNumber":234,"content":"                              icon: Icon("},{"type":"INSERT","lineNumber":235,"content":"                                _obscurePassword ? Icons.visibility_off : Icons.visibility,"},{"type":"INSERT","lineNumber":236,"content":"                                color: const Color(0xFF757575),"},{"type":"INSERT","lineNumber":237,"content":"                              ),"},{"type":"INSERT","lineNumber":238,"content":"                              onPressed: () {"},{"type":"INSERT","lineNumber":239,"content":"                                setState(() {"},{"type":"INSERT","lineNumber":240,"content":"                                  _obscurePassword = !_obscurePassword;"},{"type":"INSERT","lineNumber":241,"content":"                                });"},{"type":"INSERT","lineNumber":242,"content":"                              },"},{"type":"DELETE","lineNumber":159,"oldContent":"                            onPressed: () {"},{"type":"DELETE","lineNumber":160,"oldContent":"                              setState(() {"},{"type":"DELETE","lineNumber":161,"oldContent":"                                _obscurePassword = !_obscurePassword;"},{"type":"DELETE","lineNumber":162,"oldContent":"                              });"},{"type":"DELETE","lineNumber":163,"oldContent":"                            },"},{"type":"INSERT","lineNumber":244,"content":"                            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":245,"content":"                              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":246,"content":"                              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":247,"content":"                            ),"},{"type":"INSERT","lineNumber":248,"content":"                            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":249,"content":"                              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":250,"content":"                              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":251,"content":"                            ),"},{"type":"INSERT","lineNumber":252,"content":"                            filled: true,"},{"type":"INSERT","lineNumber":253,"content":"                            fillColor: Colors.white,"},{"type":"DELETE","lineNumber":165,"oldContent":"                            borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":166,"oldContent":"                            borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":167,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":168,"oldContent":"                            borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":169,"oldContent":"                            borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":170,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":171,"oldContent":"                          filled: true,"},{"type":"DELETE","lineNumber":172,"oldContent":"                          fillColor: Colors.white,"},{"type":"INSERT","lineNumber":255,"content":"                          validator: (value) {"},{"type":"INSERT","lineNumber":256,"content":"                            if (!_isPhoneLogin && (value == null || value.isEmpty)) {"},{"type":"INSERT","lineNumber":257,"content":"                              return 'Please enter your password';"},{"type":"INSERT","lineNumber":258,"content":"                            }"},{"type":"INSERT","lineNumber":259,"content":"                            if (!_isPhoneLogin && value != null && value.length < 6) {"},{"type":"INSERT","lineNumber":260,"content":"                              return 'Password must be at least 6 characters';"},{"type":"INSERT","lineNumber":261,"content":"                            }"},{"type":"INSERT","lineNumber":262,"content":"                            return null;"},{"type":"INSERT","lineNumber":263,"content":"                          },"},{"type":"DELETE","lineNumber":174,"oldContent":"                          if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":175,"oldContent":"                            return 'Please enter your password';"},{"type":"DELETE","lineNumber":176,"oldContent":"                          border: OutlineInputBorder("},{"type":"DELETE","lineNumber":177,"oldContent":"                          }"},{"type":"DELETE","lineNumber":178,"oldContent":"                          if (value.length < 6) {"},{"type":"DELETE","lineNumber":179,"oldContent":"                            return 'Password must be at least 6 characters';"},{"type":"DELETE","lineNumber":180,"oldContent":"                          }"},{"type":"DELETE","lineNumber":181,"oldContent":"                          enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":182,"oldContent":"                          return null;"},{"type":"DELETE","lineNumber":183,"oldContent":"                        },"},{"type":"DELETE","lineNumber":184,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":265,"content":"                      ],"},{"type":"INSERT","lineNumber":267,"content":"                      // Remember Me & Forgot Password"},{"type":"DELETE","lineNumber":188,"oldContent":"                        validator: (value) {"},{"type":"DELETE","lineNumber":200,"oldContent":"                      // Remember Me & Forgot Password"},{"type":"DELETE","lineNumber":234,"oldContent":"                      // Login Button"},{"type":"DELETE","lineNumber":235,"oldContent":"                      BlocBuilder<AuthBloc, AuthState>("},{"type":"DELETE","lineNumber":236,"oldContent":"                        builder: (context, state) {"},{"type":"DELETE","lineNumber":237,"oldContent":"                          return SizedBox("},{"type":"DELETE","lineNumber":238,"oldContent":"                            width: double.infinity,"},{"type":"DELETE","lineNumber":239,"oldContent":"                            height: 56,"},{"type":"DELETE","lineNumber":240,"oldContent":"                            child: ElevatedButton("},{"type":"DELETE","lineNumber":241,"oldContent":"                              onPressed: state.status == AuthStatus.loading"},{"type":"DELETE","lineNumber":242,"oldContent":"                                  ? null"},{"type":"DELETE","lineNumber":243,"oldContent":"                                  : _onLoginPressed,"},{"type":"DELETE","lineNumber":244,"oldContent":"                              style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":245,"oldContent":"                                backgroundColor: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":246,"oldContent":"                                shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":247,"oldContent":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":248,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":249,"oldContent":"                                elevation: 0,"},{"type":"DELETE","lineNumber":250,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":251,"oldContent":"                              child: state.status == AuthStatus.loading"},{"type":"DELETE","lineNumber":252,"oldContent":"                                  ? const SizedBox("},{"type":"DELETE","lineNumber":253,"oldContent":"                                      width: 24,"},{"type":"DELETE","lineNumber":254,"oldContent":"                                      height: 24,"},{"type":"DELETE","lineNumber":255,"oldContent":"                                      child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":256,"oldContent":"                                        color: Colors.white,"},{"type":"DELETE","lineNumber":257,"oldContent":"                                        strokeWidth: 2,"},{"type":"DELETE","lineNumber":258,"oldContent":"                                      ),"},{"type":"DELETE","lineNumber":259,"oldContent":"                                    )"},{"type":"DELETE","lineNumber":260,"oldContent":"                                  : Text("},{"type":"DELETE","lineNumber":261,"oldContent":"                                      'LOGIN',"},{"type":"DELETE","lineNumber":262,"oldContent":"                                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":263,"oldContent":"                                        fontSize: 16,"},{"type":"INSERT","lineNumber":314,"content":"                      // Login/Request OTP Button"},{"type":"INSERT","lineNumber":315,"content":"                      const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":316,"content":"                      SizedBox("},{"type":"INSERT","lineNumber":317,"content":"                        width: double.infinity,"},{"type":"INSERT","lineNumber":318,"content":"                        height: 56,"},{"type":"INSERT","lineNumber":319,"content":"                        child: ElevatedButton("},{"type":"INSERT","lineNumber":320,"content":"                          onPressed: _onLoginPressed,"},{"type":"INSERT","lineNumber":321,"content":"                          style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":322,"content":"                            backgroundColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":323,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":324,"content":"                              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":355,"content":"                                ),"},{"type":"DELETE","lineNumber":307,"oldContent":"                                ),"},{"type":"INSERT","lineNumber":376,"content":"                    ],"},{"type":"INSERT","lineNumber":383,"content":"      ),"},{"type":"INSERT","lineNumber":384,"content":"    );"},{"type":"DELETE","lineNumber":324,"oldContent":"    );"},{"type":"DELETE","lineNumber":325,"oldContent":"      ),"},{"type":"DELETE","lineNumber":326,"oldContent":"                    ],"}]},{"timestamp":1754645638442,"changes":[{"type":"DELETE","lineNumber":7,"oldContent":"import 'success_screen.dart';"},{"type":"INSERT","lineNumber":18,"content":"  final _phoneController = TextEditingController();"},{"type":"MODIFY","lineNumber":21,"content":"  bool _isPhoneLogin = false;","oldContent":"  final _phoneController = TextEditingController();"},{"type":"DELETE","lineNumber":25,"oldContent":"  bool _isPhoneLogin = false;"},{"type":"INSERT","lineNumber":27,"content":"    _phoneController.dispose();"},{"type":"INSERT","lineNumber":29,"content":"  }"},{"type":"DELETE","lineNumber":31,"oldContent":"    _phoneController.dispose();"},{"type":"DELETE","lineNumber":33,"oldContent":"  }"},{"type":"DELETE","lineNumber":35,"oldContent":"        // Handle phone number login"},{"type":"DELETE","lineNumber":36,"oldContent":"    }"},{"type":"DELETE","lineNumber":38,"oldContent":"  }"},{"type":"DELETE","lineNumber":40,"oldContent":""},{"type":"DELETE","lineNumber":42,"oldContent":"  @override"},{"type":"DELETE","lineNumber":44,"oldContent":"        // Handle email/password login"},{"type":"DELETE","lineNumber":45,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":47,"oldContent":"      listener: (context, state) {"},{"type":"DELETE","lineNumber":49,"oldContent":"        if (state.status == AuthStatus.otpSent) {"},{"type":"DELETE","lineNumber":51,"oldContent":"          // Navigate to OTP verification screen"},{"type":"DELETE","lineNumber":53,"oldContent":"          Navigator.push("},{"type":"DELETE","lineNumber":55,"oldContent":"            context,"},{"type":"DELETE","lineNumber":57,"oldContent":"            MaterialPageRoute("},{"type":"INSERT","lineNumber":45,"content":"    }"},{"type":"INSERT","lineNumber":46,"content":"  }"},{"type":"INSERT","lineNumber":47,"content":""},{"type":"INSERT","lineNumber":48,"content":"  @override"},{"type":"INSERT","lineNumber":49,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":50,"content":"    return BlocListener<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":51,"content":"      listener: (context, state) {"},{"type":"INSERT","lineNumber":52,"content":"        if (state.status == AuthStatus.otpSent) {"},{"type":"INSERT","lineNumber":53,"content":"          Navigator.push("},{"type":"INSERT","lineNumber":54,"content":"            context,"},{"type":"INSERT","lineNumber":55,"content":"            MaterialPageRoute("},{"type":"DELETE","lineNumber":61,"oldContent":"                phoneNumber: state.phoneNumber ?? '',"},{"type":"INSERT","lineNumber":58,"content":"                phoneNumber: state.phoneNumber ?? _phoneController.text.trim(),"},{"type":"DELETE","lineNumber":63,"oldContent":"    return BlocListener<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":70,"content":"        } else if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":71,"content":"          Navigator.pushReplacementNamed(context, '/home');"},{"type":"DELETE","lineNumber":76,"oldContent":"                  decoration: BoxDecoration("},{"type":"DELETE","lineNumber":77,"oldContent":"        child: SingleChildScrollView("},{"type":"DELETE","lineNumber":78,"oldContent":"                    gradient: LinearGradient("},{"type":"INSERT","lineNumber":74,"content":"      child: Scaffold("},{"type":"INSERT","lineNumber":75,"content":"        body: SingleChildScrollView("},{"type":"DELETE","lineNumber":80,"oldContent":"                      begin: Alignment.topCenter,"},{"type":"DELETE","lineNumber":82,"oldContent":"                      end: Alignment.bottomCenter,"},{"type":"DELETE","lineNumber":84,"oldContent":"                      colors: ["},{"type":"DELETE","lineNumber":86,"oldContent":"                        Colors.black.withOpacity(0.6),"},{"type":"DELETE","lineNumber":88,"oldContent":"                        Colors.transparent,"},{"type":"DELETE","lineNumber":90,"oldContent":"                      ],"},{"type":"DELETE","lineNumber":92,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":94,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":96,"oldContent":"                    child: Text("},{"type":"DELETE","lineNumber":98,"oldContent":"                      'Family!',"},{"type":"INSERT","lineNumber":88,"content":"                  decoration: BoxDecoration("},{"type":"INSERT","lineNumber":89,"content":"                    gradient: LinearGradient("},{"type":"INSERT","lineNumber":90,"content":"                      begin: Alignment.topCenter,"},{"type":"INSERT","lineNumber":91,"content":"                      end: Alignment.bottomCenter,"},{"type":"INSERT","lineNumber":92,"content":"                      colors: ["},{"type":"INSERT","lineNumber":93,"content":"                        Colors.black.withOpacity(0.6),"},{"type":"INSERT","lineNumber":94,"content":"                        Colors.transparent,"},{"type":"INSERT","lineNumber":95,"content":"                      ],"},{"type":"INSERT","lineNumber":96,"content":"                    ),"},{"type":"INSERT","lineNumber":97,"content":"                  ),"},{"type":"INSERT","lineNumber":98,"content":"                  child: Center("},{"type":"INSERT","lineNumber":99,"content":"                    child: Text("},{"type":"INSERT","lineNumber":100,"content":"                      'Family!',"},{"type":"INSERT","lineNumber":109,"content":"              ),"},{"type":"INSERT","lineNumber":110,"content":"              "},{"type":"INSERT","lineNumber":111,"content":"              // Welcome Back Text"},{"type":"DELETE","lineNumber":111,"oldContent":"                  child: Center("},{"type":"DELETE","lineNumber":122,"oldContent":"              ),"},{"type":"DELETE","lineNumber":124,"oldContent":"              "},{"type":"DELETE","lineNumber":125,"oldContent":"              // Welcome Back Text"},{"type":"DELETE","lineNumber":132,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":134,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":144,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":141,"content":"                          ),"},{"type":"DELETE","lineNumber":147,"oldContent":"                      "},{"type":"INSERT","lineNumber":150,"content":"                          ),"},{"type":"DELETE","lineNumber":160,"oldContent":"                      "},{"type":"DELETE","lineNumber":162,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":159,"content":"                      ),"},{"type":"INSERT","lineNumber":161,"content":"                      "},{"type":"DELETE","lineNumber":167,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":177,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":190,"oldContent":"                      "},{"type":"DELETE","lineNumber":192,"oldContent":"                      Padding("},{"type":"DELETE","lineNumber":194,"oldContent":"                        padding: const EdgeInsets.symmetric(vertical: 12.0),"},{"type":"DELETE","lineNumber":197,"oldContent":"                        child: Row("},{"type":"DELETE","lineNumber":199,"oldContent":"                          mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":201,"oldContent":"                          children: ["},{"type":"DELETE","lineNumber":203,"oldContent":"                            // Remember Me"},{"type":"DELETE","lineNumber":205,"oldContent":"                            Row("},{"type":"DELETE","lineNumber":207,"oldContent":"                              children: ["},{"type":"DELETE","lineNumber":209,"oldContent":"                                Checkbox("},{"type":"DELETE","lineNumber":211,"oldContent":"                                  value: _rememberMe,"},{"type":"DELETE","lineNumber":213,"oldContent":"                                  onChanged: (value) {"},{"type":"DELETE","lineNumber":215,"oldContent":"                                    setState(() {"},{"type":"DELETE","lineNumber":217,"oldContent":"                                      _rememberMe = value ?? false;"},{"type":"DELETE","lineNumber":220,"oldContent":"                                    });"},{"type":"DELETE","lineNumber":222,"oldContent":"                                  },"},{"type":"DELETE","lineNumber":224,"oldContent":"                                  activeColor: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":226,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":228,"oldContent":"                                Text("},{"type":"DELETE","lineNumber":230,"oldContent":"                                  'Remember Me',"},{"type":"DELETE","lineNumber":232,"oldContent":"                                  style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":234,"oldContent":"                                    color: const Color(0xFF666666),"},{"type":"DELETE","lineNumber":236,"oldContent":"                                    fontSize: 14,"},{"type":"DELETE","lineNumber":238,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":240,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":242,"oldContent":"                              ],"},{"type":"DELETE","lineNumber":244,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":246,"oldContent":"                            // Forgot Password"},{"type":"DELETE","lineNumber":248,"oldContent":"                            TextButton("},{"type":"DELETE","lineNumber":250,"oldContent":"                              onPressed: () {"},{"type":"DELETE","lineNumber":252,"oldContent":"                                // TODO: Implement forgot password"},{"type":"DELETE","lineNumber":255,"oldContent":"                              },"},{"type":"DELETE","lineNumber":256,"oldContent":"                              child: Text("},{"type":"DELETE","lineNumber":258,"oldContent":"                                'Forgot Password?',"},{"type":"DELETE","lineNumber":259,"oldContent":"                                style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":220,"content":"                      "},{"type":"DELETE","lineNumber":261,"oldContent":"                                  color: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":263,"oldContent":"                                  fontSize: 14,"},{"type":"DELETE","lineNumber":265,"oldContent":"                                  fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":267,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":269,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":271,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":273,"oldContent":"                          ],"},{"type":"DELETE","lineNumber":275,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":277,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":279,"oldContent":"                      "},{"type":"DELETE","lineNumber":281,"oldContent":"                      const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":283,"oldContent":"                      "},{"type":"INSERT","lineNumber":242,"content":"                            ),"},{"type":"INSERT","lineNumber":253,"content":"                          ),"},{"type":"DELETE","lineNumber":312,"oldContent":"                                        fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":263,"content":"                        ),"},{"type":"INSERT","lineNumber":265,"content":"                      "},{"type":"INSERT","lineNumber":266,"content":"                      // Remember Me & Forgot Password"},{"type":"INSERT","lineNumber":267,"content":"                      Padding("},{"type":"INSERT","lineNumber":268,"content":"                        padding: const EdgeInsets.symmetric(vertical: 12.0),"},{"type":"INSERT","lineNumber":269,"content":"                        child: Row("},{"type":"INSERT","lineNumber":270,"content":"                          mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":271,"content":"                          children: ["},{"type":"INSERT","lineNumber":272,"content":"                            // Remember Me"},{"type":"INSERT","lineNumber":273,"content":"                            Row("},{"type":"INSERT","lineNumber":274,"content":"                              children: ["},{"type":"INSERT","lineNumber":275,"content":"                                Checkbox("},{"type":"INSERT","lineNumber":276,"content":"                                  value: _rememberMe,"},{"type":"INSERT","lineNumber":277,"content":"                                  onChanged: (value) {"},{"type":"INSERT","lineNumber":278,"content":"                                    setState(() {"},{"type":"INSERT","lineNumber":279,"content":"                                      _rememberMe = value ?? false;"},{"type":"INSERT","lineNumber":280,"content":"                                    });"},{"type":"INSERT","lineNumber":281,"content":"                                  },"},{"type":"INSERT","lineNumber":282,"content":"                                  activeColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":283,"content":"                                ),"},{"type":"INSERT","lineNumber":284,"content":"                                Text("},{"type":"INSERT","lineNumber":285,"content":"                                  'Remember Me',"},{"type":"INSERT","lineNumber":286,"content":"                                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":287,"content":"                                    color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":288,"content":"                                    fontSize: 14,"},{"type":"INSERT","lineNumber":289,"content":"                                  ),"},{"type":"INSERT","lineNumber":290,"content":"                                ),"},{"type":"INSERT","lineNumber":291,"content":"                              ],"},{"type":"INSERT","lineNumber":292,"content":"                            ),"},{"type":"INSERT","lineNumber":293,"content":"                            // Forgot Password"},{"type":"INSERT","lineNumber":294,"content":"                            TextButton("},{"type":"INSERT","lineNumber":295,"content":"                              onPressed: () {"},{"type":"INSERT","lineNumber":296,"content":"                                // TODO: Implement forgot password"},{"type":"INSERT","lineNumber":297,"content":"                              },"},{"type":"INSERT","lineNumber":298,"content":"                              child: Text("},{"type":"INSERT","lineNumber":299,"content":"                                'Forgot Password?',"},{"type":"INSERT","lineNumber":300,"content":"                                style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":301,"content":"                                  color: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":302,"content":"                                  fontSize: 14,"},{"type":"INSERT","lineNumber":303,"content":"                                  fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":304,"content":"                                ),"},{"type":"INSERT","lineNumber":305,"content":"                              ),"},{"type":"INSERT","lineNumber":306,"content":"                            ),"},{"type":"INSERT","lineNumber":307,"content":"                          ],"},{"type":"INSERT","lineNumber":308,"content":"                        ),"},{"type":"INSERT","lineNumber":309,"content":"                      ),"},{"type":"INSERT","lineNumber":310,"content":"                      "},{"type":"INSERT","lineNumber":311,"content":"                      const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":312,"content":"                      "},{"type":"INSERT","lineNumber":313,"content":"                      // Login/Request OTP Button"},{"type":"INSERT","lineNumber":314,"content":"                      const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":315,"content":"                      SizedBox("},{"type":"INSERT","lineNumber":316,"content":"                        width: double.infinity,"},{"type":"INSERT","lineNumber":317,"content":"                        height: 56,"},{"type":"INSERT","lineNumber":318,"content":"                        child: ElevatedButton("},{"type":"INSERT","lineNumber":319,"content":"                          onPressed: _onLoginPressed,"},{"type":"INSERT","lineNumber":320,"content":"                          style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":321,"content":"                            backgroundColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":322,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":323,"content":"                              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":324,"content":"                                        fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":316,"oldContent":"                      // Remember Me & Forgot Password"},{"type":"INSERT","lineNumber":354,"content":"                                ),"},{"type":"DELETE","lineNumber":363,"oldContent":"                      // Login/Request OTP Button"},{"type":"DELETE","lineNumber":365,"oldContent":"                      const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":375,"content":"                    ],"},{"type":"DELETE","lineNumber":367,"oldContent":"                      SizedBox("},{"type":"DELETE","lineNumber":369,"oldContent":"                        width: double.infinity,"},{"type":"DELETE","lineNumber":371,"oldContent":"                        height: 56,"},{"type":"DELETE","lineNumber":373,"oldContent":"                        child: ElevatedButton("},{"type":"DELETE","lineNumber":375,"oldContent":"                          onPressed: _onLoginPressed,"},{"type":"DELETE","lineNumber":377,"oldContent":"                          style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":382,"content":"      ),"},{"type":"INSERT","lineNumber":383,"content":"    );"},{"type":"DELETE","lineNumber":379,"oldContent":"                            backgroundColor: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":381,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":383,"oldContent":"                              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":384,"oldContent":"    );"},{"type":"DELETE","lineNumber":385,"oldContent":"      ),"},{"type":"DELETE","lineNumber":386,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":387,"oldContent":"                                ),"}]},{"timestamp":1754645848962,"changes":[{"type":"MODIFY","lineNumber":18,"content":"  final _phoneController = TextEditingController();","oldContent":"  final _phoneController = TextEditingController();"},{"type":"MODIFY","lineNumber":27,"content":"    _phoneController.dispose();","oldContent":"    _phoneController.dispose();"},{"type":"INSERT","lineNumber":38,"content":"        context.read<AuthBloc>().add("},{"type":"INSERT","lineNumber":39,"content":"              LoginRequested("},{"type":"INSERT","lineNumber":40,"content":"                email: _emailController.text.trim(),"},{"type":"INSERT","lineNumber":41,"content":"                password: _passwordController.text.trim(),"},{"type":"INSERT","lineNumber":42,"content":"              ),"},{"type":"INSERT","lineNumber":43,"content":"            );"},{"type":"INSERT","lineNumber":44,"content":"      }"},{"type":"DELETE","lineNumber":40,"oldContent":"        context.read<AuthBloc>().add("},{"type":"DELETE","lineNumber":43,"oldContent":"              LoginRequested("},{"type":"DELETE","lineNumber":46,"oldContent":"                email: _emailController.text.trim(),"},{"type":"DELETE","lineNumber":49,"oldContent":"                password: _passwordController.text.trim(),"},{"type":"DELETE","lineNumber":52,"oldContent":"              ),"},{"type":"DELETE","lineNumber":54,"oldContent":"            );"},{"type":"DELETE","lineNumber":55,"oldContent":"                phoneNumber: state.phoneNumber ?? _phoneController.text.trim(),"},{"type":"DELETE","lineNumber":56,"oldContent":"      }"},{"type":"INSERT","lineNumber":58,"content":"                phoneNumber: state.phoneNumber ?? _phoneController.text.trim(),"},{"type":"DELETE","lineNumber":66,"oldContent":"        } else if (state.status == AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":68,"oldContent":"          Navigator.pushReplacementNamed(context, '/home');"},{"type":"DELETE","lineNumber":72,"oldContent":"      child: Scaffold("},{"type":"INSERT","lineNumber":70,"content":"        } else if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":71,"content":"          Navigator.pushReplacementNamed(context, '/home');"},{"type":"DELETE","lineNumber":74,"oldContent":"        body: SingleChildScrollView("},{"type":"DELETE","lineNumber":76,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":77,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":78,"oldContent":"              // Header with Image"},{"type":"DELETE","lineNumber":79,"oldContent":"              Container("},{"type":"DELETE","lineNumber":80,"oldContent":"                height: 250,"},{"type":"DELETE","lineNumber":81,"oldContent":"                  decoration: BoxDecoration("},{"type":"DELETE","lineNumber":82,"oldContent":"                    gradient: LinearGradient("},{"type":"DELETE","lineNumber":83,"oldContent":"                decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":84,"oldContent":"                      begin: Alignment.topCenter,"},{"type":"DELETE","lineNumber":85,"oldContent":"                      end: Alignment.bottomCenter,"},{"type":"DELETE","lineNumber":86,"oldContent":"                  image: DecorationImage("},{"type":"DELETE","lineNumber":87,"oldContent":"                      colors: ["},{"type":"DELETE","lineNumber":88,"oldContent":"                        Colors.black.withOpacity(0.6),"},{"type":"DELETE","lineNumber":89,"oldContent":"                    image: AssetImage('assets/images/rajiv-perera-_JjYYsQPneE-unsplash (1).jpg'),"},{"type":"DELETE","lineNumber":90,"oldContent":"                        Colors.transparent,"},{"type":"DELETE","lineNumber":91,"oldContent":"                      ],"},{"type":"DELETE","lineNumber":92,"oldContent":"                    fit: BoxFit.cover,"},{"type":"DELETE","lineNumber":93,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":94,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":95,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":96,"oldContent":"                  child: Center("},{"type":"DELETE","lineNumber":97,"oldContent":"                    child: Text("},{"type":"DELETE","lineNumber":98,"oldContent":"                ),"},{"type":"DELETE","lineNumber":99,"oldContent":"                      'Family!',"},{"type":"DELETE","lineNumber":100,"oldContent":"                child: Container("},{"type":"INSERT","lineNumber":74,"content":"      child: Scaffold("},{"type":"INSERT","lineNumber":75,"content":"        body: SafeArea("},{"type":"INSERT","lineNumber":76,"content":"          child: SingleChildScrollView("},{"type":"INSERT","lineNumber":77,"content":"            child: Padding("},{"type":"INSERT","lineNumber":78,"content":"              padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":79,"content":"              child: Form("},{"type":"INSERT","lineNumber":80,"content":"                key: _formKey,"},{"type":"INSERT","lineNumber":81,"content":"                child: Column("},{"type":"INSERT","lineNumber":82,"content":"                  crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"INSERT","lineNumber":83,"content":"                  children: ["},{"type":"INSERT","lineNumber":84,"content":"                    // Header"},{"type":"INSERT","lineNumber":85,"content":"                    const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":86,"content":"                    Text("},{"type":"INSERT","lineNumber":87,"content":"                      'Welcome Back',"},{"type":"DELETE","lineNumber":102,"oldContent":"                        color: Colors.white,"},{"type":"DELETE","lineNumber":103,"oldContent":"                        fontSize: 36,"},{"type":"INSERT","lineNumber":89,"content":"                        fontSize: 28,"},{"type":"INSERT","lineNumber":91,"content":"                        color: Colors.black87,"},{"type":"INSERT","lineNumber":93,"content":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":107,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":108,"oldContent":"                ),"},{"type":"DELETE","lineNumber":109,"oldContent":"              ),"},{"type":"DELETE","lineNumber":110,"oldContent":"              Padding("},{"type":"DELETE","lineNumber":111,"oldContent":"              "},{"type":"DELETE","lineNumber":112,"oldContent":"                padding: const EdgeInsets.only(top: 24.0, bottom: 32.0),"},{"type":"DELETE","lineNumber":113,"oldContent":"              // Welcome Back Text"},{"type":"DELETE","lineNumber":114,"oldContent":"                child: Text("},{"type":"DELETE","lineNumber":115,"oldContent":"                  'Welcome Back',"},{"type":"DELETE","lineNumber":116,"oldContent":"                  style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":117,"oldContent":"                    fontSize: 24,"},{"type":"DELETE","lineNumber":118,"oldContent":"                    fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":119,"oldContent":"                    color: const Color(0xFF333333),"},{"type":"DELETE","lineNumber":120,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":121,"oldContent":"                ),"},{"type":"DELETE","lineNumber":122,"oldContent":"              ),"},{"type":"DELETE","lineNumber":123,"oldContent":"              "},{"type":"DELETE","lineNumber":124,"oldContent":"              // Login Form"},{"type":"DELETE","lineNumber":125,"oldContent":"              Padding("},{"type":"DELETE","lineNumber":126,"oldContent":"                padding: const EdgeInsets.symmetric(horizontal: 24.0),"},{"type":"DELETE","lineNumber":127,"oldContent":"                child: Form("},{"type":"DELETE","lineNumber":128,"oldContent":"                  key: _formKey,"},{"type":"DELETE","lineNumber":129,"oldContent":"                  child: Column("},{"type":"DELETE","lineNumber":130,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":131,"oldContent":"                      // Toggle between email and phone login"},{"type":"DELETE","lineNumber":132,"oldContent":"                      Row("},{"type":"DELETE","lineNumber":133,"oldContent":"                        mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":134,"oldContent":"                        children: ["},{"type":"DELETE","lineNumber":135,"oldContent":"                          Text("},{"type":"DELETE","lineNumber":136,"oldContent":"                            'Use Phone Number',"},{"type":"DELETE","lineNumber":137,"oldContent":"                            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":95,"content":"                    const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":96,"content":"                    Text("},{"type":"INSERT","lineNumber":97,"content":"                      'Sign in to continue',"},{"type":"INSERT","lineNumber":98,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":99,"content":"                        fontSize: 16,"},{"type":"INSERT","lineNumber":100,"content":"                        color: Colors.grey[600],"},{"type":"INSERT","lineNumber":101,"content":"                      ),"},{"type":"INSERT","lineNumber":102,"content":"                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":103,"content":"                    ),"},{"type":"INSERT","lineNumber":104,"content":"                    "},{"type":"INSERT","lineNumber":105,"content":"                    const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":106,"content":"                    "},{"type":"INSERT","lineNumber":107,"content":"                    // Toggle between email and phone login"},{"type":"INSERT","lineNumber":108,"content":"                    Row("},{"type":"INSERT","lineNumber":109,"content":"                      mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":110,"content":"                      children: ["},{"type":"INSERT","lineNumber":111,"content":"                        Text("},{"type":"INSERT","lineNumber":112,"content":"                          'Use Phone Number',"},{"type":"INSERT","lineNumber":113,"content":"                          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":114,"content":"                            color: Colors.grey[700],"},{"type":"DELETE","lineNumber":139,"oldContent":"                              color: const Color(0xFF666666),"},{"type":"DELETE","lineNumber":140,"oldContent":"                              fontSize: 14,"},{"type":"DELETE","lineNumber":141,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":142,"oldContent":"                          Switch("},{"type":"DELETE","lineNumber":143,"oldContent":"                            value: _isPhoneLogin,"},{"type":"DELETE","lineNumber":144,"oldContent":"                            onChanged: (value) {"},{"type":"DELETE","lineNumber":145,"oldContent":"                              setState(() {"},{"type":"INSERT","lineNumber":116,"content":"                        ),"},{"type":"INSERT","lineNumber":117,"content":"                        Switch("},{"type":"INSERT","lineNumber":118,"content":"                          value: _isPhoneLogin,"},{"type":"INSERT","lineNumber":119,"content":"                          onChanged: (value) {"},{"type":"INSERT","lineNumber":120,"content":"                            setState(() {"},{"type":"INSERT","lineNumber":121,"content":"                              _isPhoneLogin = value;"},{"type":"INSERT","lineNumber":122,"content":"                            });"},{"type":"INSERT","lineNumber":123,"content":"                          },"},{"type":"INSERT","lineNumber":124,"content":"                          activeColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":125,"content":"                        ),"},{"type":"INSERT","lineNumber":126,"content":"                        Text("},{"type":"INSERT","lineNumber":127,"content":"                          'Use Email',"},{"type":"INSERT","lineNumber":128,"content":"                          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":129,"content":"                            color: Colors.grey[700],"},{"type":"DELETE","lineNumber":147,"oldContent":"                                _isPhoneLogin = value;"},{"type":"DELETE","lineNumber":148,"oldContent":"                              });"},{"type":"DELETE","lineNumber":149,"oldContent":"                            },"},{"type":"DELETE","lineNumber":150,"oldContent":"                            activeColor: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":151,"oldContent":"                          Text("},{"type":"DELETE","lineNumber":152,"oldContent":"                            'Use Email',"},{"type":"DELETE","lineNumber":153,"oldContent":"                            style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":154,"oldContent":"                              color: const Color(0xFF666666),"},{"type":"DELETE","lineNumber":155,"oldContent":"                              fontSize: 14,"},{"type":"DELETE","lineNumber":156,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":157,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":158,"oldContent":"                      "},{"type":"INSERT","lineNumber":131,"content":"                        ),"},{"type":"INSERT","lineNumber":132,"content":"                      ],"},{"type":"INSERT","lineNumber":133,"content":"                    ),"},{"type":"INSERT","lineNumber":134,"content":"                    "},{"type":"INSERT","lineNumber":135,"content":"                    const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":136,"content":"                    "},{"type":"INSERT","lineNumber":137,"content":"                    // Phone or Email Input"},{"type":"INSERT","lineNumber":138,"content":"                    if (_isPhoneLogin)"},{"type":"INSERT","lineNumber":139,"content":"                      TextFormField("},{"type":"INSERT","lineNumber":140,"content":"                        controller: _phoneController,"},{"type":"INSERT","lineNumber":141,"content":"                        keyboardType: TextInputType.phone,"},{"type":"INSERT","lineNumber":142,"content":"                        decoration: InputDecoration("},{"type":"INSERT","lineNumber":143,"content":"                          labelText: 'Phone Number',"},{"type":"INSERT","lineNumber":144,"content":"                          prefixIcon: const Icon(Icons.phone),"},{"type":"INSERT","lineNumber":145,"content":"                          border: OutlineInputBorder("},{"type":"INSERT","lineNumber":146,"content":"                            borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":160,"oldContent":"                        ],"},{"type":"DELETE","lineNumber":161,"oldContent":"                      const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":162,"oldContent":"                      // Email/Phone Field"},{"type":"DELETE","lineNumber":163,"oldContent":"                      _isPhoneLogin"},{"type":"DELETE","lineNumber":164,"oldContent":"                          ? TextFormField("},{"type":"DELETE","lineNumber":165,"oldContent":"                              controller: _phoneController,"},{"type":"DELETE","lineNumber":166,"oldContent":"                              decoration: InputDecoration("},{"type":"DELETE","lineNumber":167,"oldContent":"                                labelText: 'Phone Number',"},{"type":"DELETE","lineNumber":168,"oldContent":"                                prefixIcon: const Icon(Icons.phone, color: Color(0xFF757575)),"},{"type":"DELETE","lineNumber":169,"oldContent":"                                border: OutlineInputBorder("},{"type":"DELETE","lineNumber":170,"oldContent":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":171,"oldContent":"                                  borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":172,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":173,"oldContent":"                                enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":174,"oldContent":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":175,"oldContent":"                                  borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":176,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":177,"oldContent":"                                filled: true,"},{"type":"DELETE","lineNumber":178,"oldContent":"                                fillColor: Colors.white,"},{"type":"DELETE","lineNumber":179,"oldContent":"                                hintText: '+1 (___) ___-____',"},{"type":"INSERT","lineNumber":148,"content":"                        ),"},{"type":"INSERT","lineNumber":149,"content":"                        validator: (value) {"},{"type":"INSERT","lineNumber":150,"content":"                          if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":151,"content":"                            return 'Please enter your phone number';"},{"type":"INSERT","lineNumber":152,"content":"                          }"},{"type":"INSERT","lineNumber":153,"content":"                          return null;"},{"type":"INSERT","lineNumber":154,"content":"                        },"},{"type":"INSERT","lineNumber":155,"content":"                      )"},{"type":"INSERT","lineNumber":156,"content":"                    else"},{"type":"INSERT","lineNumber":157,"content":"                      Column("},{"type":"INSERT","lineNumber":158,"content":"                        crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"INSERT","lineNumber":159,"content":"                        children: ["},{"type":"INSERT","lineNumber":160,"content":"                          TextFormField("},{"type":"INSERT","lineNumber":161,"content":"                            controller: _emailController,"},{"type":"INSERT","lineNumber":162,"content":"                            keyboardType: TextInputType.emailAddress,"},{"type":"INSERT","lineNumber":163,"content":"                            decoration: InputDecoration("},{"type":"INSERT","lineNumber":164,"content":"                              labelText: 'Email',"},{"type":"INSERT","lineNumber":165,"content":"                              prefixIcon: const Icon(Icons.email),"},{"type":"INSERT","lineNumber":166,"content":"                              border: OutlineInputBorder("},{"type":"INSERT","lineNumber":167,"content":"                                borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":181,"oldContent":"                              keyboardType: TextInputType.phone,"},{"type":"DELETE","lineNumber":182,"oldContent":"                              validator: (value) {"},{"type":"DELETE","lineNumber":183,"oldContent":"                                if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":184,"oldContent":"                                  return 'Please enter your phone number';"},{"type":"DELETE","lineNumber":185,"oldContent":"                                }"},{"type":"DELETE","lineNumber":186,"oldContent":"                                // Simple phone number validation"},{"type":"DELETE","lineNumber":187,"oldContent":"                                if (!RegExp(r'^[0-9+\\s\\-()]{10,}$').hasMatch(value)) {"},{"type":"DELETE","lineNumber":188,"oldContent":"                                  return 'Please enter a valid phone number';"},{"type":"DELETE","lineNumber":189,"oldContent":"                                }"},{"type":"DELETE","lineNumber":190,"oldContent":"                                return null;"},{"type":"DELETE","lineNumber":191,"oldContent":"                              },"},{"type":"DELETE","lineNumber":192,"oldContent":"                            )"},{"type":"DELETE","lineNumber":193,"oldContent":"                          : TextFormField("},{"type":"DELETE","lineNumber":194,"oldContent":"                              controller: _emailController,"},{"type":"DELETE","lineNumber":195,"oldContent":"                              decoration: InputDecoration("},{"type":"DELETE","lineNumber":196,"oldContent":"                                labelText: 'Email',"},{"type":"DELETE","lineNumber":197,"oldContent":"                                prefixIcon: const Icon(Icons.email_outlined, color: Color(0xFF757575)),"},{"type":"DELETE","lineNumber":198,"oldContent":"                                border: OutlineInputBorder("},{"type":"DELETE","lineNumber":199,"oldContent":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":200,"oldContent":"                                  borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":201,"oldContent":"                      "},{"type":"DELETE","lineNumber":202,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":203,"oldContent":"                                enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":204,"oldContent":"                                  borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":205,"oldContent":"                                  borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":206,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":207,"oldContent":"                                filled: true,"},{"type":"DELETE","lineNumber":208,"oldContent":"                                fillColor: Colors.white,"},{"type":"DELETE","lineNumber":209,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":210,"oldContent":"                              keyboardType: TextInputType.emailAddress,"},{"type":"DELETE","lineNumber":211,"oldContent":"                              validator: (value) {"},{"type":"DELETE","lineNumber":212,"oldContent":"                                if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":214,"oldContent":"                                  return 'Please enter your email';"},{"type":"DELETE","lineNumber":215,"oldContent":"                                }"},{"type":"DELETE","lineNumber":216,"oldContent":"                                if (!RegExp(r'^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$').hasMatch(value)) {"},{"type":"DELETE","lineNumber":217,"oldContent":"                                  return 'Please enter a valid email';"},{"type":"DELETE","lineNumber":218,"oldContent":"                                }"},{"type":"INSERT","lineNumber":170,"content":"                            validator: (value) {"},{"type":"INSERT","lineNumber":171,"content":"                              if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":172,"content":"                                return 'Please enter your email';"},{"type":"INSERT","lineNumber":173,"content":"                              }"},{"type":"INSERT","lineNumber":174,"content":"                              if (!RegExp(r'^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$')"},{"type":"INSERT","lineNumber":175,"content":"                                  .hasMatch(value)) {"},{"type":"INSERT","lineNumber":176,"content":"                                return 'Please enter a valid email';"},{"type":"INSERT","lineNumber":177,"content":"                              }"},{"type":"INSERT","lineNumber":178,"content":"                              return null;"},{"type":"INSERT","lineNumber":179,"content":"                            },"},{"type":"DELETE","lineNumber":220,"oldContent":"                                return null;"},{"type":"DELETE","lineNumber":221,"oldContent":"                              },"},{"type":"DELETE","lineNumber":222,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":223,"oldContent":"                      const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":224,"oldContent":"                      "},{"type":"DELETE","lineNumber":225,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":226,"oldContent":"                      // Password Field (only for email login)"},{"type":"DELETE","lineNumber":227,"oldContent":"                      "},{"type":"DELETE","lineNumber":228,"oldContent":"                      // Remember Me & Forgot Password"},{"type":"DELETE","lineNumber":229,"oldContent":"                      if (!_isPhoneLogin) ...["},{"type":"DELETE","lineNumber":230,"oldContent":"                      Padding("},{"type":"DELETE","lineNumber":231,"oldContent":"                        padding: const EdgeInsets.symmetric(vertical: 12.0),"},{"type":"DELETE","lineNumber":232,"oldContent":"                        const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":233,"oldContent":"                        child: Row("},{"type":"DELETE","lineNumber":234,"oldContent":"                          mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":235,"oldContent":"                        TextFormField("},{"type":"DELETE","lineNumber":236,"oldContent":"                          children: ["},{"type":"DELETE","lineNumber":237,"oldContent":"                            // Remember Me"},{"type":"DELETE","lineNumber":238,"oldContent":"                          controller: _passwordController,"},{"type":"DELETE","lineNumber":239,"oldContent":"                            Row("},{"type":"DELETE","lineNumber":240,"oldContent":"                              children: ["},{"type":"DELETE","lineNumber":241,"oldContent":"                          obscureText: _obscurePassword,"},{"type":"DELETE","lineNumber":242,"oldContent":"                                Checkbox("},{"type":"DELETE","lineNumber":243,"oldContent":"                                  value: _rememberMe,"},{"type":"DELETE","lineNumber":244,"oldContent":"                          decoration: InputDecoration("},{"type":"DELETE","lineNumber":245,"oldContent":"                                  onChanged: (value) {"},{"type":"DELETE","lineNumber":246,"oldContent":"                                    setState(() {"},{"type":"DELETE","lineNumber":247,"oldContent":"                            labelText: 'Password',"},{"type":"DELETE","lineNumber":248,"oldContent":"                                      _rememberMe = value ?? false;"},{"type":"DELETE","lineNumber":249,"oldContent":"                                    });"},{"type":"DELETE","lineNumber":250,"oldContent":"                            prefixIcon: const Icon(Icons.lock_outline, color: Color(0xFF757575)),"},{"type":"DELETE","lineNumber":251,"oldContent":"                                  },"},{"type":"DELETE","lineNumber":252,"oldContent":"                                  activeColor: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":253,"oldContent":"                            suffixIcon: IconButton("},{"type":"INSERT","lineNumber":181,"content":"                          const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":182,"content":"                          TextFormField("},{"type":"INSERT","lineNumber":183,"content":"                            controller: _passwordController,"},{"type":"INSERT","lineNumber":184,"content":"                            obscureText: _obscurePassword,"},{"type":"INSERT","lineNumber":185,"content":"                            decoration: InputDecoration("},{"type":"INSERT","lineNumber":186,"content":"                              labelText: 'Password',"},{"type":"INSERT","lineNumber":187,"content":"                              prefixIcon: const Icon(Icons.lock),"},{"type":"INSERT","lineNumber":188,"content":"                              suffixIcon: IconButton("},{"type":"INSERT","lineNumber":189,"content":"                                icon: Icon("},{"type":"INSERT","lineNumber":190,"content":"                                  _obscurePassword"},{"type":"INSERT","lineNumber":191,"content":"                                      ? Icons.visibility"},{"type":"INSERT","lineNumber":192,"content":"                                      : Icons.visibility_off,"},{"type":"DELETE","lineNumber":255,"oldContent":"                                Text("},{"type":"DELETE","lineNumber":256,"oldContent":"                              icon: Icon("},{"type":"DELETE","lineNumber":257,"oldContent":"                                  'Remember Me',"},{"type":"DELETE","lineNumber":258,"oldContent":"                                _obscurePassword ? Icons.visibility_off : Icons.visibility,"},{"type":"DELETE","lineNumber":259,"oldContent":"                                  style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":260,"oldContent":"                                color: const Color(0xFF757575),"},{"type":"DELETE","lineNumber":261,"oldContent":"                                    color: const Color(0xFF666666),"},{"type":"INSERT","lineNumber":194,"content":"                                onPressed: () {"},{"type":"INSERT","lineNumber":195,"content":"                                  setState(() {"},{"type":"INSERT","lineNumber":196,"content":"                                    _obscurePassword = !_obscurePassword;"},{"type":"INSERT","lineNumber":197,"content":"                                  });"},{"type":"INSERT","lineNumber":198,"content":"                                },"},{"type":"DELETE","lineNumber":263,"oldContent":"                                    fontSize: 14,"},{"type":"DELETE","lineNumber":264,"oldContent":"                              onPressed: () {"},{"type":"DELETE","lineNumber":265,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":266,"oldContent":"                                setState(() {"},{"type":"DELETE","lineNumber":267,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":268,"oldContent":"                                  _obscurePassword = !_obscurePassword;"},{"type":"DELETE","lineNumber":269,"oldContent":"                              ],"},{"type":"DELETE","lineNumber":270,"oldContent":"                                });"},{"type":"DELETE","lineNumber":271,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":272,"oldContent":"                              },"},{"type":"DELETE","lineNumber":273,"oldContent":"                            // Forgot Password"},{"type":"DELETE","lineNumber":274,"oldContent":"                            border: OutlineInputBorder("},{"type":"DELETE","lineNumber":275,"oldContent":"                            TextButton("},{"type":"DELETE","lineNumber":276,"oldContent":"                              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":277,"oldContent":"                              onPressed: () {"},{"type":"DELETE","lineNumber":278,"oldContent":"                              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":279,"oldContent":"                                // TODO: Implement forgot password"},{"type":"DELETE","lineNumber":280,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":281,"oldContent":"                              },"},{"type":"DELETE","lineNumber":282,"oldContent":"                            enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":283,"oldContent":"                              child: Text("},{"type":"DELETE","lineNumber":284,"oldContent":"                              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":285,"oldContent":"                                'Forgot Password?',"},{"type":"DELETE","lineNumber":286,"oldContent":"                              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":287,"oldContent":"                                style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":288,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":289,"oldContent":"                                  color: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":290,"oldContent":"                            filled: true,"},{"type":"DELETE","lineNumber":291,"oldContent":"                                  fontSize: 14,"},{"type":"DELETE","lineNumber":292,"oldContent":"                            fillColor: Colors.white,"},{"type":"DELETE","lineNumber":293,"oldContent":"                                  fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":294,"oldContent":"                          validator: (value) {"},{"type":"DELETE","lineNumber":295,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":296,"oldContent":"                            if (!_isPhoneLogin && (value == null || value.isEmpty)) {"},{"type":"INSERT","lineNumber":200,"content":"                              border: OutlineInputBorder("},{"type":"INSERT","lineNumber":201,"content":"                                borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":298,"oldContent":"                              return 'Please enter your password';"},{"type":"DELETE","lineNumber":300,"oldContent":"                            }"},{"type":"DELETE","lineNumber":301,"oldContent":"                          ],"},{"type":"DELETE","lineNumber":302,"oldContent":"                            if (!_isPhoneLogin && value != null && value.length < 6) {"},{"type":"DELETE","lineNumber":303,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":304,"oldContent":"                              return 'Password must be at least 6 characters';"},{"type":"INSERT","lineNumber":204,"content":"                            validator: (value) {"},{"type":"INSERT","lineNumber":205,"content":"                              if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":206,"content":"                                return 'Please enter your password';"},{"type":"INSERT","lineNumber":207,"content":"                              }"},{"type":"INSERT","lineNumber":208,"content":"                              if (value.length < 6) {"},{"type":"INSERT","lineNumber":209,"content":"                                return 'Password must be at least 6 characters';"},{"type":"INSERT","lineNumber":210,"content":"                              }"},{"type":"INSERT","lineNumber":211,"content":"                              return null;"},{"type":"INSERT","lineNumber":212,"content":"                            },"},{"type":"INSERT","lineNumber":213,"content":"                          ),"},{"type":"INSERT","lineNumber":214,"content":"                        ],"},{"type":"DELETE","lineNumber":306,"oldContent":"                            }"},{"type":"DELETE","lineNumber":307,"oldContent":"                      "},{"type":"DELETE","lineNumber":308,"oldContent":"                            return null;"},{"type":"INSERT","lineNumber":216,"content":"                    "},{"type":"INSERT","lineNumber":217,"content":"                    if (!_isPhoneLogin) ...["},{"type":"DELETE","lineNumber":310,"oldContent":"                          },"},{"type":"DELETE","lineNumber":311,"oldContent":"                      "},{"type":"DELETE","lineNumber":312,"oldContent":"                      // Login/Request OTP Button"},{"type":"DELETE","lineNumber":313,"oldContent":"                      ],"},{"type":"DELETE","lineNumber":314,"oldContent":"                      const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":315,"oldContent":"                                        color: Colors.white,"},{"type":"DELETE","lineNumber":316,"oldContent":"                      SizedBox("},{"type":"DELETE","lineNumber":317,"oldContent":"                                      ),"},{"type":"DELETE","lineNumber":318,"oldContent":"                        width: double.infinity,"},{"type":"DELETE","lineNumber":319,"oldContent":"                        height: 56,"},{"type":"DELETE","lineNumber":320,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":321,"oldContent":"                        child: ElevatedButton("},{"type":"DELETE","lineNumber":322,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":323,"oldContent":"                          onPressed: _onLoginPressed,"},{"type":"DELETE","lineNumber":324,"oldContent":"                          );"},{"type":"DELETE","lineNumber":325,"oldContent":"                          style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":326,"oldContent":"                        },"},{"type":"DELETE","lineNumber":327,"oldContent":"                            backgroundColor: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":328,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":329,"oldContent":"                            shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":330,"oldContent":"                      "},{"type":"DELETE","lineNumber":331,"oldContent":"                              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":332,"oldContent":"                      const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":333,"oldContent":"                                        fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":334,"oldContent":"                      "},{"type":"DELETE","lineNumber":335,"oldContent":"                      // Sign Up Link"},{"type":"DELETE","lineNumber":337,"oldContent":"                        mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":221,"content":"                          Checkbox("},{"type":"INSERT","lineNumber":222,"content":"                            value: _rememberMe,"},{"type":"INSERT","lineNumber":223,"content":"                            onChanged: (value) {"},{"type":"INSERT","lineNumber":224,"content":"                              setState(() {"},{"type":"INSERT","lineNumber":225,"content":"                                _rememberMe = value ?? false;"},{"type":"INSERT","lineNumber":226,"content":"                              });"},{"type":"INSERT","lineNumber":227,"content":"                            },"},{"type":"INSERT","lineNumber":228,"content":"                            activeColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":229,"content":"                          ),"},{"type":"DELETE","lineNumber":340,"oldContent":"                            'Don\\'t Have Account? ',"},{"type":"DELETE","lineNumber":341,"oldContent":"                            style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":342,"oldContent":"                              color: const Color(0xFF666666),"},{"type":"DELETE","lineNumber":343,"oldContent":"                              fontSize: 14,"},{"type":"DELETE","lineNumber":344,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":231,"content":"                            'Remember me',"},{"type":"INSERT","lineNumber":232,"content":"                            style: GoogleFonts.poppins(),"},{"type":"INSERT","lineNumber":234,"content":"                          const Spacer(),"},{"type":"DELETE","lineNumber":348,"oldContent":"                              // Navigate to registration screen with flag indicating it's not the first time"},{"type":"DELETE","lineNumber":349,"oldContent":"                              Navigator.pushReplacement("},{"type":"DELETE","lineNumber":350,"oldContent":"                                context,"},{"type":"DELETE","lineNumber":351,"oldContent":"                                MaterialPageRoute("},{"type":"DELETE","lineNumber":352,"oldContent":"                                  builder: (context) => const RegisterScreen(),"},{"type":"DELETE","lineNumber":353,"oldContent":"                                  settings: const RouteSettings(arguments: false),"},{"type":"DELETE","lineNumber":354,"oldContent":"                              );"},{"type":"INSERT","lineNumber":237,"content":"                              // TODO: Implement forgot password"},{"type":"DELETE","lineNumber":356,"oldContent":"                            style: TextButton.styleFrom("},{"type":"DELETE","lineNumber":357,"oldContent":"                              padding: EdgeInsets.zero,"},{"type":"DELETE","lineNumber":358,"oldContent":"                              minimumSize: Size.zero,"},{"type":"DELETE","lineNumber":359,"oldContent":"                              tapTargetSize: MaterialTapTargetSize.shrinkWrap,"},{"type":"DELETE","lineNumber":360,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":362,"oldContent":"                              'Signup',"},{"type":"INSERT","lineNumber":240,"content":"                              'Forgot Password?',"},{"type":"DELETE","lineNumber":364,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":366,"oldContent":"                                fontSize: 14,"},{"type":"DELETE","lineNumber":367,"oldContent":"                                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":373,"oldContent":"                      "},{"type":"DELETE","lineNumber":374,"oldContent":"                      const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":375,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":248,"content":"                    ],"},{"type":"INSERT","lineNumber":249,"content":"                    "},{"type":"INSERT","lineNumber":250,"content":"                    const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":251,"content":"                    "},{"type":"INSERT","lineNumber":252,"content":"                    // Login Button"},{"type":"INSERT","lineNumber":253,"content":"                    ElevatedButton("},{"type":"INSERT","lineNumber":254,"content":"                      onPressed: _onLoginPressed,"},{"type":"INSERT","lineNumber":255,"content":"                      style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":256,"content":"                        backgroundColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":257,"content":"                        padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":258,"content":"                        shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":259,"content":"                          borderRadius: BorderRadius.circular(12),"},{"type":"INSERT","lineNumber":260,"content":"                        ),"},{"type":"INSERT","lineNumber":261,"content":"                      ),"},{"type":"INSERT","lineNumber":262,"content":"                      child: BlocBuilder<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":263,"content":"                        builder: (context, state) {"},{"type":"INSERT","lineNumber":264,"content":"                          return state.status == AuthStatus.loading"},{"type":"INSERT","lineNumber":265,"content":"                              ? const SizedBox("},{"type":"INSERT","lineNumber":266,"content":"                                  width: 24,"},{"type":"INSERT","lineNumber":267,"content":"                                  height: 24,"},{"type":"INSERT","lineNumber":268,"content":"                                  child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":269,"content":"                                    color: Colors.white,"},{"type":"INSERT","lineNumber":270,"content":"                                    strokeWidth: 2,"},{"type":"INSERT","lineNumber":271,"content":"                                  ),"},{"type":"INSERT","lineNumber":272,"content":"                                )"},{"type":"INSERT","lineNumber":273,"content":"                              : Text("},{"type":"INSERT","lineNumber":274,"content":"                                  _isPhoneLogin ? 'Send OTP' : 'Login',"},{"type":"INSERT","lineNumber":275,"content":"                                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":276,"content":"                                    fontSize: 16,"},{"type":"INSERT","lineNumber":277,"content":"                                    fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":278,"content":"                                  ),"},{"type":"INSERT","lineNumber":279,"content":"                                );"},{"type":"INSERT","lineNumber":280,"content":"                        },"},{"type":"INSERT","lineNumber":281,"content":"                      ),"},{"type":"INSERT","lineNumber":282,"content":"                    ),"},{"type":"INSERT","lineNumber":283,"content":"                    "},{"type":"INSERT","lineNumber":284,"content":"                    const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":285,"content":"                    "},{"type":"INSERT","lineNumber":286,"content":"                    // Sign Up Link"},{"type":"INSERT","lineNumber":287,"content":"                    Row("},{"type":"INSERT","lineNumber":288,"content":"                      mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":289,"content":"                      children: ["},{"type":"INSERT","lineNumber":290,"content":"                        Text("},{"type":"INSERT","lineNumber":291,"content":"                          'Don\\'t have an account? ',"},{"type":"INSERT","lineNumber":292,"content":"                          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":293,"content":"                            color: Colors.grey[700],"},{"type":"INSERT","lineNumber":294,"content":"                          ),"},{"type":"INSERT","lineNumber":295,"content":"                        ),"},{"type":"INSERT","lineNumber":296,"content":"                        TextButton("},{"type":"INSERT","lineNumber":297,"content":"                          onPressed: () {"},{"type":"INSERT","lineNumber":298,"content":"                            Navigator.pushReplacement("},{"type":"INSERT","lineNumber":299,"content":"                              context,"},{"type":"INSERT","lineNumber":300,"content":"                              MaterialPageRoute("},{"type":"INSERT","lineNumber":301,"content":"                                builder: (context) => const RegisterScreen(),"},{"type":"INSERT","lineNumber":302,"content":"                              ),"},{"type":"INSERT","lineNumber":303,"content":"                            );"},{"type":"INSERT","lineNumber":304,"content":"                          },"},{"type":"INSERT","lineNumber":305,"content":"                          child: Text("},{"type":"INSERT","lineNumber":306,"content":"                            'Sign Up',"},{"type":"INSERT","lineNumber":307,"content":"                            style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":308,"content":"                              color: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":309,"content":"                              fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":310,"content":"                            ),"},{"type":"INSERT","lineNumber":311,"content":"                          ),"},{"type":"INSERT","lineNumber":312,"content":"                        ),"},{"type":"INSERT","lineNumber":313,"content":"                      ],"},{"type":"INSERT","lineNumber":314,"content":"                    ),"},{"type":"INSERT","lineNumber":315,"content":"                  ],"},{"type":"DELETE","lineNumber":378,"oldContent":"            ],"},{"type":"INSERT","lineNumber":318,"content":"            ),"},{"type":"DELETE","lineNumber":380,"oldContent":"                    ],"},{"type":"INSERT","lineNumber":321,"content":"      ),"},{"type":"INSERT","lineNumber":322,"content":"    );"},{"type":"DELETE","lineNumber":384,"oldContent":"      ),"},{"type":"DELETE","lineNumber":386,"oldContent":"    );"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/pubspec.yaml":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/pubspec.yaml","baseContent":"name: family_tree_firebase\ndescription: \"A new Flutter project.\"\n# The following line prevents the package from being accidentally published to\n# pub.dev using `flutter pub publish`. This is preferred for private packages.\npublish_to: 'none' # Remove this line if you wish to publish to pub.dev\n\n# The following defines the version and build number for your application.\n# A version number is three numbers separated by dots, like 1.2.43\n# followed by an optional build number separated by a +.\n# Both the version and the builder number may be overridden in flutter\n# build by specifying --build-name and --build-number, respectively.\n# In Android, build-name is used as versionName while build-number used as versionCode.\n# Read more about Android versioning at https://developer.android.com/studio/publish/versioning\n# In iOS, build-name is used as CFBundleShortVersionString while build-number is used as CFBundleVersion.\n# Read more about iOS versioning at\n# https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html\n# In Windows, build-name is used as the major, minor, and patch parts\n# of the product and file versions while build-number is used as the build suffix.\nversion: 1.0.0+1\n\nenvironment:\n  sdk: ^3.8.1\n\n# Dependencies specify other packages that your package needs in order to work.\n# To automatically upgrade your package dependencies to the latest versions\n# consider running `flutter pub upgrade --major-versions`. Alternatively,\n# dependencies can be manually updated by changing the version numbers below to\n# the latest version available on pub.dev. To see which dependencies have newer\n# versions available, run `flutter pub outdated`.\ndependencies:\n  flutter:\n    sdk: flutter\n\n  # The following adds the Cupertino Icons font to your application.\n  # Use with the CupertinoIcons class for iOS style icons.\n  cupertino_icons: ^1.0.8\n  firebase_core: ^4.0.0\n  \n  # UI and Animations\n  lottie: ^2.7.0\n  cached_network_image: ^3.3.1\n  video_player: ^2.8.3\n  timeago: ^3.6.3\n  \n  # State Management\n  flutter_bloc: ^8.1.4\n  equatable: ^2.0.5\n  \n  # Form Validation\n  formz: ^0.7.0\n\ndev_dependencies:\n  flutter_test:\n    sdk: flutter\n\n  # The \"flutter_lints\" package below contains a set of recommended lints to\n  # encourage good coding practices. The lint set provided by the package is\n  # activated in the `analysis_options.yaml` file located at the root of your\n  # package. See that file for information about deactivating specific lint\n  # rules and activating additional ones.\n  flutter_lints: ^5.0.0\n\n# For information on the generic Dart part of this file, see the\n# following page: https://dart.dev/tools/pub/pubspec\n\n# The following section is specific to Flutter packages.\nflutter:\n\n  # The following line ensures that the Material Icons font is\n  # included with your application, so that you can use the icons in\n  # the material Icons class.\n  uses-material-design: true\n\n  # To add assets to your application, add an assets section, like this:\n  # assets:\n  #   - images/a_dot_burr.jpeg\n  #   - images/a_dot_ham.jpeg\n\n  # An image asset can refer to one or more resolution-specific \"variants\", see\n  # https://flutter.dev/to/resolution-aware-images\n\n  # For details regarding adding assets from package dependencies, see\n  # https://flutter.dev/to/asset-from-package\n\n  # To add custom fonts to your application, add a fonts section here,\n  # in this \"flutter\" section. Each entry in this list should have a\n  # \"family\" key with the font family name, and a \"fonts\" key with a\n  # list giving the asset and other descriptors for the font. For\n  # example:\n  # fonts:\n  #   - family: Schyler\n  #     fonts:\n  #       - asset: fonts/Schyler-Regular.ttf\n  #       - asset: fonts/Schyler-Italic.ttf\n  #         style: italic\n  #   - family: Trajan Pro\n  #     fonts:\n  #       - asset: fonts/TrajanPro.ttf\n  #       - asset: fonts/TrajanPro_Bold.ttf\n  #         weight: 700\n  #\n  # For details regarding fonts from package dependencies,\n  # see https://flutter.dev/to/font-from-package\n","baseTimestamp":1754376255476,"deltas":[{"timestamp":1754455016498,"changes":[{"type":"INSERT","lineNumber":50,"content":"  "},{"type":"INSERT","lineNumber":51,"content":"  # Firebase"},{"type":"INSERT","lineNumber":52,"content":"  cloud_firestore: ^4.15.9"},{"type":"INSERT","lineNumber":53,"content":"  firebase_auth: ^4.17.4"},{"type":"INSERT","lineNumber":54,"content":"  "},{"type":"INSERT","lineNumber":55,"content":"  # Dependency Injection"},{"type":"INSERT","lineNumber":56,"content":"  get_it: ^7.6.7"},{"type":"INSERT","lineNumber":57,"content":"  "},{"type":"INSERT","lineNumber":58,"content":"  # Functional Programming"},{"type":"INSERT","lineNumber":59,"content":"  dartz: ^0.10.1"}]},{"timestamp":1754455194235,"changes":[{"type":"MODIFY","lineNumber":36,"content":"  firebase_core: ^2.32.0","oldContent":"  firebase_core: ^4.0.0"},{"type":"DELETE","lineNumber":51,"oldContent":""},{"type":"DELETE","lineNumber":53,"oldContent":"dev_dependencies:"},{"type":"DELETE","lineNumber":55,"oldContent":"  flutter_test:"},{"type":"DELETE","lineNumber":57,"oldContent":"    sdk: flutter"},{"type":"DELETE","lineNumber":59,"oldContent":""},{"type":"DELETE","lineNumber":61,"oldContent":"  # The \"flutter_lints\" package below contains a set of recommended lints to"},{"type":"DELETE","lineNumber":63,"oldContent":"  # encourage good coding practices. The lint set provided by the package is"},{"type":"DELETE","lineNumber":65,"oldContent":"  # activated in the `analysis_options.yaml` file located at the root of your"},{"type":"DELETE","lineNumber":67,"oldContent":"  # package. See that file for information about deactivating specific lint"},{"type":"INSERT","lineNumber":60,"content":""},{"type":"INSERT","lineNumber":61,"content":"dev_dependencies:"},{"type":"INSERT","lineNumber":62,"content":"  flutter_test:"},{"type":"INSERT","lineNumber":63,"content":"    sdk: flutter"},{"type":"INSERT","lineNumber":64,"content":""},{"type":"INSERT","lineNumber":65,"content":"  # The \"flutter_lints\" package below contains a set of recommended lints to"},{"type":"INSERT","lineNumber":66,"content":"  # encourage good coding practices. The lint set provided by the package is"},{"type":"INSERT","lineNumber":67,"content":"  # activated in the `analysis_options.yaml` file located at the root of your"},{"type":"INSERT","lineNumber":68,"content":"  # package. See that file for information about deactivating specific lint"}]},{"timestamp":1754457239242,"changes":[{"type":"DELETE","lineNumber":55,"oldContent":""},{"type":"INSERT","lineNumber":56,"content":"  get_it: ^7.6.7"},{"type":"INSERT","lineNumber":57,"content":"  "},{"type":"INSERT","lineNumber":58,"content":"  # Functional Programming"},{"type":"INSERT","lineNumber":59,"content":"  dartz: ^0.10.1"},{"type":"INSERT","lineNumber":60,"content":""},{"type":"DELETE","lineNumber":59,"oldContent":"  get_it: ^7.6.7"},{"type":"DELETE","lineNumber":62,"oldContent":"  "},{"type":"DELETE","lineNumber":65,"oldContent":"  # Functional Programming"},{"type":"DELETE","lineNumber":68,"oldContent":"  dartz: ^0.10.1"},{"type":"DELETE","lineNumber":84,"oldContent":"  # assets:"},{"type":"DELETE","lineNumber":85,"oldContent":"  #   - images/a_dot_burr.jpeg"},{"type":"DELETE","lineNumber":86,"oldContent":"  #   - images/a_dot_ham.jpeg"},{"type":"INSERT","lineNumber":84,"content":"  assets:"},{"type":"INSERT","lineNumber":85,"content":"    - assets/images/"}]},{"timestamp":1754457781075,"changes":[{"type":"INSERT","lineNumber":43,"content":"  flutter_svg: ^2.0.10+1"},{"type":"DELETE","lineNumber":55,"oldContent":"  get_it: ^7.6.7"},{"type":"INSERT","lineNumber":57,"content":"  get_it: ^7.6.7"},{"type":"DELETE","lineNumber":58,"oldContent":"dev_dependencies:"},{"type":"DELETE","lineNumber":60,"oldContent":"  flutter_test:"},{"type":"INSERT","lineNumber":62,"content":"dev_dependencies:"},{"type":"INSERT","lineNumber":63,"content":"  flutter_test:"}]},{"timestamp":1754459332170,"changes":[{"type":"MODIFY","lineNumber":61,"content":"  ","oldContent":"dev_dependencies:"},{"type":"INSERT","lineNumber":62,"content":"  # Network"},{"type":"INSERT","lineNumber":63,"content":"  connectivity_plus: ^5.0.2"},{"type":"INSERT","lineNumber":65,"content":"dev_dependencies:"}]},{"timestamp":1754459405368,"changes":[{"type":"MODIFY","lineNumber":64,"content":"  ","oldContent":""},{"type":"INSERT","lineNumber":65,"content":"  # Image Picking and Processing"},{"type":"INSERT","lineNumber":66,"content":"  image_picker: ^1.0.7"},{"type":"INSERT","lineNumber":67,"content":"  path_provider: ^2.1.1"},{"type":"INSERT","lineNumber":68,"content":"  image: ^4.1.7"},{"type":"INSERT","lineNumber":69,"content":""},{"type":"INSERT","lineNumber":70,"content":"dev_dependencies:"},{"type":"DELETE","lineNumber":67,"oldContent":"dev_dependencies:"}]},{"timestamp":1754459511691,"changes":[{"type":"MODIFY","lineNumber":63,"content":"  connectivity_plus: ^5.0.2","oldContent":""},{"type":"DELETE","lineNumber":66,"oldContent":"  flutter_test:"},{"type":"DELETE","lineNumber":68,"oldContent":"    sdk: flutter"},{"type":"INSERT","lineNumber":69,"content":"  "},{"type":"INSERT","lineNumber":70,"content":"  # Internationalization and Localization"},{"type":"INSERT","lineNumber":71,"content":"  intl: ^0.19.0"},{"type":"INSERT","lineNumber":73,"content":"dev_dependencies:"},{"type":"INSERT","lineNumber":74,"content":"  flutter_test:"},{"type":"INSERT","lineNumber":75,"content":"    sdk: flutter"},{"type":"DELETE","lineNumber":74,"oldContent":"dev_dependencies:"}]},{"timestamp":1754459979038,"changes":[{"type":"DELETE","lineNumber":67,"oldContent":"  "},{"type":"MODIFY","lineNumber":69,"content":"  ","oldContent":"  # Internationalization and Localization"},{"type":"INSERT","lineNumber":70,"content":"  # Internationalization and Localization"},{"type":"INSERT","lineNumber":72,"content":"  "},{"type":"INSERT","lineNumber":73,"content":"  # State Management for MVVM"},{"type":"INSERT","lineNumber":74,"content":"  provider: ^6.1.1"},{"type":"INSERT","lineNumber":75,"content":"  change_notifier_provider: ^2.1.0"},{"type":"DELETE","lineNumber":73,"oldContent":""},{"type":"DELETE","lineNumber":75,"oldContent":"  # The \"flutter_lints\" package below contains a set of recommended lints to"},{"type":"INSERT","lineNumber":80,"content":""},{"type":"INSERT","lineNumber":81,"content":"  # The \"flutter_lints\" package below contains a set of recommended lints to"}]},{"timestamp":1754470994049,"changes":[{"type":"DELETE","lineNumber":46,"oldContent":"  flutter_bloc: ^8.1.4"},{"type":"INSERT","lineNumber":67,"content":"  image: ^4.1.7"},{"type":"DELETE","lineNumber":70,"oldContent":"  image: ^4.1.7"},{"type":"DELETE","lineNumber":73,"oldContent":""},{"type":"DELETE","lineNumber":76,"oldContent":"dev_dependencies:"},{"type":"INSERT","lineNumber":75,"content":""},{"type":"INSERT","lineNumber":76,"content":"dev_dependencies:"},{"type":"INSERT","lineNumber":79,"content":""},{"type":"INSERT","lineNumber":80,"content":"  # The \"flutter_lints\" package below contains a set of recommended lints to"},{"type":"DELETE","lineNumber":82,"oldContent":""},{"type":"DELETE","lineNumber":84,"oldContent":"  # The \"flutter_lints\" package below contains a set of recommended lints to"}]},{"timestamp":1754474224863,"changes":[{"type":"MODIFY","lineNumber":67,"content":"  image: ^4.1.7","oldContent":"  image: ^4.1.7"},{"type":"MODIFY","lineNumber":74,"content":"","oldContent":""},{"type":"DELETE","lineNumber":76,"oldContent":"  change_notifier_provider: ^2.1.0"},{"type":"MODIFY","lineNumber":78,"content":"","oldContent":""}]},{"timestamp":1754475159998,"changes":[{"type":"INSERT","lineNumber":66,"content":"  path_provider: ^2.1.1"},{"type":"DELETE","lineNumber":67,"oldContent":"  image: ^4.1.7"},{"type":"INSERT","lineNumber":73,"content":"  provider: ^6.1.1"},{"type":"INSERT","lineNumber":74,"content":"  "},{"type":"INSERT","lineNumber":75,"content":"  # UI Components"},{"type":"INSERT","lineNumber":76,"content":"  google_fonts: ^6.1.0"},{"type":"INSERT","lineNumber":77,"content":"  "},{"type":"INSERT","lineNumber":78,"content":"  # Storage"},{"type":"INSERT","lineNumber":79,"content":"  shared_preferences: ^2.2.2"},{"type":"INSERT","lineNumber":80,"content":"  "},{"type":"INSERT","lineNumber":81,"content":"  # Dependency Injection"},{"type":"INSERT","lineNumber":82,"content":"  injectable: ^2.1.2"},{"type":"INSERT","lineNumber":83,"content":"  injectable_generator: ^2.1.5"},{"type":"INSERT","lineNumber":84,"content":"  "},{"type":"INSERT","lineNumber":85,"content":"  # Authentication"},{"type":"INSERT","lineNumber":86,"content":"  google_sign_in: ^6.2.1"},{"type":"INSERT","lineNumber":87,"content":"  sign_in_with_apple: ^5.0.0"},{"type":"INSERT","lineNumber":88,"content":"  "},{"type":"INSERT","lineNumber":89,"content":"  # Utilities"},{"type":"INSERT","lineNumber":90,"content":"  logger: ^2.0.2"},{"type":"DELETE","lineNumber":74,"oldContent":""},{"type":"DELETE","lineNumber":77,"oldContent":""},{"type":"INSERT","lineNumber":95,"content":"  build_runner: ^2.4.7"},{"type":"INSERT","lineNumber":96,"content":"  flutter_launcher_icons: ^0.13.1"},{"type":"INSERT","lineNumber":97,"content":"  flutter_native_splash: ^2.3.9"},{"type":"INSERT","lineNumber":98,"content":"  injectable_generator: ^2.1.5"},{"type":"INSERT","lineNumber":99,"content":""}]},{"timestamp":1754517333120,"changes":[{"type":"DELETE","lineNumber":74,"oldContent":""},{"type":"DELETE","lineNumber":77,"oldContent":"dev_dependencies:"},{"type":"DELETE","lineNumber":79,"oldContent":"  flutter_test:"},{"type":"DELETE","lineNumber":82,"oldContent":"    sdk: flutter"},{"type":"DELETE","lineNumber":84,"oldContent":"  # The \"flutter_lints\" package below contains a set of recommended lints to"},{"type":"DELETE","lineNumber":86,"oldContent":"  # encourage good coding practices. The lint set provided by the package is"},{"type":"DELETE","lineNumber":88,"oldContent":"  # activated in the `analysis_options.yaml` file located at the root of your"},{"type":"DELETE","lineNumber":90,"oldContent":"  # package. See that file for information about deactivating specific lint"},{"type":"DELETE","lineNumber":92,"oldContent":"  # rules and activating additional ones."},{"type":"DELETE","lineNumber":94,"oldContent":"  flutter_lints: ^5.0.0"},{"type":"DELETE","lineNumber":96,"oldContent":""},{"type":"INSERT","lineNumber":87,"content":"  sign_in_with_apple: ^7.0.1"},{"type":"INSERT","lineNumber":88,"content":"  "},{"type":"INSERT","lineNumber":89,"content":"  # Utilities"},{"type":"INSERT","lineNumber":90,"content":"  logger: ^2.0.2"},{"type":"INSERT","lineNumber":91,"content":""},{"type":"INSERT","lineNumber":92,"content":"dev_dependencies:"},{"type":"INSERT","lineNumber":93,"content":"  flutter_test:"},{"type":"INSERT","lineNumber":94,"content":"    sdk: flutter"},{"type":"INSERT","lineNumber":95,"content":"  build_runner: ^2.4.7"},{"type":"INSERT","lineNumber":96,"content":"  flutter_launcher_icons: ^0.13.1"},{"type":"INSERT","lineNumber":97,"content":"  flutter_native_splash: ^2.3.9"},{"type":"INSERT","lineNumber":98,"content":"  injectable_generator: ^2.1.5"},{"type":"INSERT","lineNumber":99,"content":""},{"type":"INSERT","lineNumber":100,"content":"  # The \"flutter_lints\" package below contains a set of recommended lints to"},{"type":"INSERT","lineNumber":101,"content":"  # encourage good coding practices. The lint set provided by the package is"},{"type":"INSERT","lineNumber":102,"content":"  # activated in the `analysis_options.yaml` file located at the root of your"},{"type":"INSERT","lineNumber":103,"content":"  # package. See that file for information about deactivating specific lint"},{"type":"INSERT","lineNumber":104,"content":"  # rules and activating additional ones."},{"type":"INSERT","lineNumber":105,"content":"  flutter_lints: ^5.0.0"},{"type":"INSERT","lineNumber":106,"content":""},{"type":"DELETE","lineNumber":99,"oldContent":"  sign_in_with_apple: ^5.0.0"},{"type":"DELETE","lineNumber":101,"oldContent":"  "},{"type":"DELETE","lineNumber":103,"oldContent":"  # Utilities"},{"type":"DELETE","lineNumber":105,"oldContent":"  logger: ^2.0.2"},{"type":"DELETE","lineNumber":111,"oldContent":"  build_runner: ^2.4.7"},{"type":"DELETE","lineNumber":113,"oldContent":"  flutter_launcher_icons: ^0.13.1"},{"type":"DELETE","lineNumber":115,"oldContent":"  flutter_native_splash: ^2.3.9"},{"type":"DELETE","lineNumber":117,"oldContent":"  injectable_generator: ^2.1.5"},{"type":"DELETE","lineNumber":119,"oldContent":""}]},{"timestamp":1754621241053,"changes":[{"type":"INSERT","lineNumber":47,"content":"  flutter_bloc: ^8.1.4"},{"type":"DELETE","lineNumber":81,"oldContent":"  sign_in_with_apple: ^7.0.1"},{"type":"INSERT","lineNumber":83,"content":"  injectable: ^2.1.2"},{"type":"INSERT","lineNumber":84,"content":"  injectable_generator: ^2.1.5"},{"type":"INSERT","lineNumber":86,"content":"  # Authentication"},{"type":"INSERT","lineNumber":87,"content":"  google_sign_in: ^6.2.1"},{"type":"INSERT","lineNumber":88,"content":"  sign_in_with_apple: ^7.0.1"},{"type":"INSERT","lineNumber":89,"content":"  "},{"type":"DELETE","lineNumber":85,"oldContent":"  injectable: ^2.1.2"},{"type":"DELETE","lineNumber":88,"oldContent":"  injectable_generator: ^2.1.5"},{"type":"DELETE","lineNumber":91,"oldContent":"  "},{"type":"DELETE","lineNumber":94,"oldContent":"  # Authentication"},{"type":"DELETE","lineNumber":97,"oldContent":"  google_sign_in: ^6.2.1"},{"type":"DELETE","lineNumber":99,"oldContent":"# For information on the generic Dart part of this file, see the"},{"type":"DELETE","lineNumber":102,"oldContent":"# following page: https://dart.dev/tools/pub/pubspec"},{"type":"DELETE","lineNumber":105,"oldContent":""},{"type":"MODIFY","lineNumber":108,"content":"# For information on the generic Dart part of this file, see the","oldContent":"# The following section is specific to Flutter packages."},{"type":"INSERT","lineNumber":109,"content":"# following page: https://dart.dev/tools/pub/pubspec"},{"type":"INSERT","lineNumber":110,"content":""},{"type":"INSERT","lineNumber":111,"content":"# The following section is specific to Flutter packages."}]},{"timestamp":1754650595154,"changes":[{"type":"DELETE","lineNumber":84,"oldContent":"  "},{"type":"DELETE","lineNumber":86,"oldContent":"  # Utilities"},{"type":"INSERT","lineNumber":85,"content":"  "},{"type":"DELETE","lineNumber":88,"oldContent":"  logger: ^2.0.2"},{"type":"MODIFY","lineNumber":90,"content":"  # Utilities","oldContent":""},{"type":"INSERT","lineNumber":91,"content":"  logger: ^2.0.2"},{"type":"INSERT","lineNumber":92,"content":""},{"type":"INSERT","lineNumber":106,"content":"  flutter_lints: ^5.0.0"},{"type":"INSERT","lineNumber":107,"content":""},{"type":"DELETE","lineNumber":108,"oldContent":"  flutter_lints: ^5.0.0"},{"type":"DELETE","lineNumber":110,"oldContent":""},{"type":"DELETE","lineNumber":113,"oldContent":""},{"type":"DELETE","lineNumber":119,"oldContent":"  # To add assets to your application, add an assets section, like this:"},{"type":"INSERT","lineNumber":118,"content":"  # Assets configuration"}]},{"timestamp":1754650843620,"changes":[{"type":"MODIFY","lineNumber":85,"content":"  ","oldContent":"  "},{"type":"INSERT","lineNumber":88,"content":"  sign_in_with_apple: ^7.0.1"},{"type":"INSERT","lineNumber":89,"content":"  "},{"type":"DELETE","lineNumber":90,"oldContent":"  sign_in_with_apple: ^7.0.1"},{"type":"INSERT","lineNumber":92,"content":"  uuid: ^4.3.3"},{"type":"DELETE","lineNumber":92,"oldContent":"  "},{"type":"DELETE","lineNumber":107,"oldContent":"# For information on the generic Dart part of this file, see the"},{"type":"INSERT","lineNumber":109,"content":"# For information on the generic Dart part of this file, see the"},{"type":"DELETE","lineNumber":117,"oldContent":"  # Assets configuration"},{"type":"INSERT","lineNumber":119,"content":"  # Assets configuration"}]},{"timestamp":1754651312936,"changes":[{"type":"INSERT","lineNumber":53,"content":"  firebase_core: ^2.32.0"},{"type":"INSERT","lineNumber":56,"content":"  firebase_storage: ^11.6.0"},{"type":"INSERT","lineNumber":57,"content":"  firebase_messaging: ^14.7.10"},{"type":"INSERT","lineNumber":58,"content":"  cloud_functions: ^4.5.1"},{"type":"INSERT","lineNumber":88,"content":"  injectable_generator: ^2.1.5"},{"type":"DELETE","lineNumber":85,"oldContent":"  "},{"type":"DELETE","lineNumber":89,"oldContent":"  # Utilities"},{"type":"INSERT","lineNumber":94,"content":"  # Utilities"},{"type":"DELETE","lineNumber":92,"oldContent":""},{"type":"INSERT","lineNumber":97,"content":""}]},{"timestamp":1754651960323,"changes":[{"type":"DELETE","lineNumber":56,"oldContent":"  "},{"type":"DELETE","lineNumber":58,"oldContent":"  # Dependency Injection"},{"type":"MODIFY","lineNumber":60,"content":"  # Dependency Injection","oldContent":"  get_it: ^7.6.7"},{"type":"INSERT","lineNumber":61,"content":"  get_it: ^7.6.7"},{"type":"INSERT","lineNumber":62,"content":"  "},{"type":"INSERT","lineNumber":88,"content":"  injectable_generator: ^2.1.5"},{"type":"DELETE","lineNumber":91,"oldContent":"  injectable_generator: ^2.1.5"},{"type":"INSERT","lineNumber":94,"content":"  # Utilities"},{"type":"DELETE","lineNumber":96,"oldContent":"  # Utilities"},{"type":"INSERT","lineNumber":97,"content":""},{"type":"DELETE","lineNumber":100,"oldContent":""}]},{"timestamp":1754652141489,"changes":[{"type":"DELETE","lineNumber":36,"oldContent":"  firebase_core: ^2.32.0"},{"type":"INSERT","lineNumber":57,"content":"  cloud_functions: ^4.5.1"},{"type":"INSERT","lineNumber":58,"content":"  "},{"type":"DELETE","lineNumber":60,"oldContent":"  cloud_functions: ^4.5.1"},{"type":"DELETE","lineNumber":62,"oldContent":"  "},{"type":"INSERT","lineNumber":96,"content":"  get_storage: ^2.1.1"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/screens/join_family_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/screens/join_family_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:flutter_bloc/flutter_bloc.dart';\nimport 'package:family_tree_firebase/core/constants/app_constants.dart';\nimport 'package:family_tree_firebase/features/family/presentation/bloc/family_bloc.dart';\nimport 'package:family_tree_firebase/features/family/presentation/bloc/family_event.dart';\nimport 'package:family_tree_firebase/features/family/presentation/bloc/family_state.dart';\nimport 'package:family_tree_firebase/features/home/presentation/screens/home_screen.dart';\n\nclass JoinFamilyScreen extends StatefulWidget {\n  const JoinFamilyScreen({super.key});\n\n  @override\n  State<JoinFamilyScreen> createState() => _JoinFamilyScreenState();\n}\n\nclass _JoinFamilyScreenState extends State<JoinFamilyScreen> {\n  final _formKey = GlobalKey<FormState>();\n  final _inviteCodeController = TextEditingController();\n\n  @override\n  void initState() {\n    super.initState();\n    // Reset any previous state when the screen is first loaded\n    context.read<FamilyBloc>().add(const ResetFamilyStateEvent());\n  }\n\n  @override\n  void dispose() {\n    _inviteCodeController.dispose();\n    super.dispose();\n  }\n\n  void _showErrorSnackBar(String message) {\n    ScaffoldMessenger.of(context).showSnackBar(\n      SnackBar(\n        content: Text(message),\n        backgroundColor: Colors.red,\n        behavior: SnackBarBehavior.floating,\n        margin: const EdgeInsets.all(16),\n        shape: RoundedRectangleBorder(\n          borderRadius: BorderRadius.circular(8),\n        ),\n      ),\n    );\n  }\n\n  bool _isLoading = false;\n\n  void _joinFamily() {\n    if (!_formKey.currentState!.validate()) return;\n    \n    // Dismiss keyboard\n    FocusScope.of(context).unfocus();\n    \n    // Dispatch the JoinFamilyEvent\n    context.read<FamilyBloc>().add(\n          JoinFamilyEvent(_inviteCodeController.text.trim()),\n        );\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return BlocConsumer<FamilyBloc, FamilyState>(\n      listener: (context, state) {\n        if (state is FamilyError) {\n          _showErrorSnackBar(state.message);\n          setState(() => _isLoading = false);\n        } else if (state is FamilyLoadSuccess) {\n          // Navigate to home screen on successful join\n          Navigator.pushReplacement(\n            context,\n            MaterialPageRoute(builder: (context) => const HomeScreen()),\n          );\n        } else if (state is FamilyLoading) {\n          setState(() => _isLoading = true);\n        } else {\n          setState(() => _isLoading = false);\n        }\n      },\n      builder: (context, state) => Scaffold(\n        appBar: AppBar(\n          title: const Text('Join Family'),\n          leading: _isLoading\n              ? const SizedBox.shrink()\n              : IconButton(\n                  icon: const Icon(Icons.arrow_back),\n                  onPressed: () => Navigator.pop(context),\n                ),\n        ),\n      body: SafeArea(\n        child: Stack(\n          children: [\n            SingleChildScrollView(\n              padding: const EdgeInsets.all(AppConstants.defaultPadding),\n              child: Form(\n                key: _formKey,\n                child: Column(\n                  crossAxisAlignment: CrossAxisAlignment.stretch,\n                  children: [\n                const SizedBox(height: 40),\n                \n                // Illustration\n                Icon(\n                  Icons.group_add,\n                  size: 120,\n                  color: Theme.of(context).primaryColor.withOpacity(0.8),\n                ),\n                \n                const SizedBox(height: 32),\n                \n                // Title\n                const Text(\n                  'Join a Family Group',\n                  style: TextStyle(\n                    fontSize: 24,\n                    fontWeight: FontWeight.bold,\n                  ),\n                  textAlign: TextAlign.center,\n                ),\n                \n                const SizedBox(height: 16),\n                \n                // Description\n                Text(\n                  'Enter the invite code provided by your family member to join their family group.',\n                  style: TextStyle(\n                    fontSize: 16,\n                    color: Colors.grey[600],\n                    height: 1.5,\n                  ),\n                  textAlign: TextAlign.center,\n                ),\n                \n                const SizedBox(height: 40),\n                \n                // Invite code field\n                TextFormField(\n                  controller: _inviteCodeController,\n                  decoration: InputDecoration(\n                    labelText: 'Invite Code',\n                    hintText: 'e.g., ABC123',\n                    prefixIcon: const Icon(Icons.vpn_key_outlined),\n                    border: OutlineInputBorder(\n                      borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),\n                    ),\n                  ),\n                  textCapitalization: TextCapitalization.characters,\n                  validator: (value) {\n                    if (value == null || value.isEmpty) {\n                      return 'Please enter an invite code';\n                    }\n                    if (value.length < 6) {\n                      return 'Invite code must be at least 6 characters';\n                    }\n                    return null;\n                  },\n                ),\n                \n                const SizedBox(height: 24),\n                \n                    // Join button\n                    ElevatedButton(\n                      onPressed: _isLoading ? null : _joinFamily,\n                      style: ElevatedButton.styleFrom(\n                        padding: const EdgeInsets.symmetric(vertical: 16),\n                        shape: RoundedRectangleBorder(\n                          borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),\n                        ),\n                      ),\n                      child: _isLoading\n                          ? const SizedBox(\n                              width: 24,\n                              height: 24,\n                              child: CircularProgressIndicator(\n                                color: Colors.white,\n                                strokeWidth: 2,\n                              ),\n                            )\n                          : const Text(\n                              'Join Family',\n                              style: TextStyle(fontSize: 16),\n                            ),\n                    ),\n                \n                    const SizedBox(height: 20),\n                    \n                    // Don't have a code? Create a family instead\n                    TextButton(\n                      onPressed: _isLoading\n                          ? null\n                          : () {\n                              Navigator.pushReplacementNamed(\n                                context,\n                                AppConstants.createFamilyRoute,\n                              );\n                            },\n                      child: const Text('Create a new family instead'),\n                    ),\n                  ],\n                ),\n              ),\n            ),\n            \n            // Loading overlay\n            if (_isLoading)\n              Container(\n                color: Colors.black.withOpacity(0.5),\n                child: const Center(\n                  child: CircularProgressIndicator(),\n                ),\n              ),\n          ],\n        ),\n      ),\n      ),\n    );\n  }\n}\n","baseTimestamp":1754377493239,"deltas":[{"timestamp":1754462100702,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:provider/provider.dart';","oldContent":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_bloc.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_event.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_state.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":"import 'package:family_tree_firebase/features/home/presentation/screens/home_screen.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:family_tree_firebase/features/family/presentation/viewmodels/family_viewmodel.dart';"},{"type":"INSERT","lineNumber":15,"content":"  late FamilyViewModel _viewModel;"},{"type":"DELETE","lineNumber":22,"oldContent":"    // Reset any previous state when the screen is first loaded"},{"type":"DELETE","lineNumber":23,"oldContent":"    context.read<FamilyBloc>().add(const ResetFamilyStateEvent());"},{"type":"INSERT","lineNumber":20,"content":"    _viewModel = context.read<FamilyViewModel>();"},{"type":"INSERT","lineNumber":21,"content":"    _viewModel.addListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":27,"content":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":31,"content":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":32,"content":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"INSERT","lineNumber":33,"content":"      _showErrorSnackBar(_viewModel.errorMessage!);"},{"type":"INSERT","lineNumber":34,"content":"      _viewModel.clearError();"},{"type":"INSERT","lineNumber":35,"content":"    }"},{"type":"INSERT","lineNumber":36,"content":"  }"},{"type":"INSERT","lineNumber":37,"content":""},{"type":"INSERT","lineNumber":39,"content":"    if (!mounted) return;"},{"type":"DELETE","lineNumber":46,"oldContent":"  bool _isLoading = false;"},{"type":"DELETE","lineNumber":47,"oldContent":""},{"type":"DELETE","lineNumber":48,"oldContent":"  void _joinFamily() {"},{"type":"INSERT","lineNumber":53,"content":"  Future<void> _joinFamily() async {"},{"type":"DELETE","lineNumber":54,"oldContent":"    // Dispatch the JoinFamilyEvent"},{"type":"DELETE","lineNumber":55,"oldContent":"    context.read<FamilyBloc>().add("},{"type":"DELETE","lineNumber":56,"oldContent":"          JoinFamilyEvent(_inviteCodeController.text.trim()),"},{"type":"DELETE","lineNumber":57,"oldContent":"        );"},{"type":"INSERT","lineNumber":59,"content":"    final isValid = await _viewModel.validateCode(_inviteCodeController.text.trim());"},{"type":"INSERT","lineNumber":60,"content":"    if (isValid && _viewModel.inviteCode != null) {"},{"type":"INSERT","lineNumber":61,"content":"      final success = await _viewModel.joinExistingFamily(_viewModel.inviteCode!);"},{"type":"INSERT","lineNumber":62,"content":"      if (success && mounted) {"},{"type":"INSERT","lineNumber":63,"content":"        Navigator.pushReplacementNamed(context, AppConstants.homeRoute);"},{"type":"INSERT","lineNumber":64,"content":"      }"},{"type":"INSERT","lineNumber":65,"content":"    }"},{"type":"DELETE","lineNumber":62,"oldContent":"    return BlocConsumer<FamilyBloc, FamilyState>("},{"type":"DELETE","lineNumber":63,"oldContent":"      listener: (context, state) {"},{"type":"DELETE","lineNumber":64,"oldContent":"        if (state is FamilyError) {"},{"type":"DELETE","lineNumber":65,"oldContent":"          _showErrorSnackBar(state.message);"},{"type":"DELETE","lineNumber":66,"oldContent":"          setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":67,"oldContent":"        } else if (state is FamilyLoadSuccess) {"},{"type":"DELETE","lineNumber":68,"oldContent":"          // Navigate to home screen on successful join"},{"type":"DELETE","lineNumber":69,"oldContent":"          Navigator.pushReplacement("},{"type":"DELETE","lineNumber":70,"oldContent":"            context,"},{"type":"DELETE","lineNumber":71,"oldContent":"            MaterialPageRoute(builder: (context) => const HomeScreen()),"},{"type":"DELETE","lineNumber":72,"oldContent":"          );"},{"type":"DELETE","lineNumber":73,"oldContent":"        } else if (state is FamilyLoading) {"},{"type":"DELETE","lineNumber":74,"oldContent":"          setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":75,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":76,"oldContent":"          setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":77,"oldContent":"        }"},{"type":"DELETE","lineNumber":78,"oldContent":"      },"},{"type":"DELETE","lineNumber":79,"oldContent":"      builder: (context, state) => Scaffold("},{"type":"DELETE","lineNumber":80,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":81,"oldContent":"          title: const Text('Join Family'),"},{"type":"DELETE","lineNumber":82,"oldContent":"          leading: _isLoading"},{"type":"DELETE","lineNumber":83,"oldContent":"              ? const SizedBox.shrink()"},{"type":"DELETE","lineNumber":84,"oldContent":"              : IconButton("},{"type":"DELETE","lineNumber":85,"oldContent":"                  icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":86,"oldContent":"                  onPressed: () => Navigator.pop(context),"},{"type":"DELETE","lineNumber":87,"oldContent":"                ),"},{"type":"DELETE","lineNumber":88,"oldContent":"        ),"},{"type":"DELETE","lineNumber":89,"oldContent":"      body: SafeArea("},{"type":"DELETE","lineNumber":90,"oldContent":"        child: Stack("},{"type":"DELETE","lineNumber":91,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":92,"oldContent":"            SingleChildScrollView("},{"type":"DELETE","lineNumber":93,"oldContent":"              padding: const EdgeInsets.all(AppConstants.defaultPadding),"},{"type":"DELETE","lineNumber":94,"oldContent":"              child: Form("},{"type":"DELETE","lineNumber":95,"oldContent":"                key: _formKey,"},{"type":"DELETE","lineNumber":96,"oldContent":"                child: Column("},{"type":"DELETE","lineNumber":97,"oldContent":"                  crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"DELETE","lineNumber":98,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":99,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":100,"oldContent":"                "},{"type":"DELETE","lineNumber":101,"oldContent":"                // Illustration"},{"type":"DELETE","lineNumber":102,"oldContent":"                Icon("},{"type":"DELETE","lineNumber":103,"oldContent":"                  Icons.group_add,"},{"type":"DELETE","lineNumber":104,"oldContent":"                  size: 120,"},{"type":"DELETE","lineNumber":105,"oldContent":"                  color: Theme.of(context).primaryColor.withOpacity(0.8),"},{"type":"DELETE","lineNumber":106,"oldContent":"                ),"},{"type":"DELETE","lineNumber":107,"oldContent":"                "},{"type":"DELETE","lineNumber":108,"oldContent":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":109,"oldContent":"                "},{"type":"DELETE","lineNumber":110,"oldContent":"                // Title"},{"type":"DELETE","lineNumber":111,"oldContent":"                const Text("},{"type":"DELETE","lineNumber":112,"oldContent":"                  'Join a Family Group',"},{"type":"DELETE","lineNumber":113,"oldContent":"                  style: TextStyle("},{"type":"DELETE","lineNumber":114,"oldContent":"                    fontSize: 24,"},{"type":"DELETE","lineNumber":115,"oldContent":"                    fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":70,"content":"    return Consumer<FamilyViewModel>("},{"type":"INSERT","lineNumber":71,"content":"      builder: (context, viewModel, _) {"},{"type":"INSERT","lineNumber":72,"content":"        return Scaffold("},{"type":"INSERT","lineNumber":73,"content":"          appBar: AppBar("},{"type":"INSERT","lineNumber":74,"content":"            title: const Text('Join Family'),"},{"type":"INSERT","lineNumber":75,"content":"            leading: viewModel.isLoading"},{"type":"INSERT","lineNumber":76,"content":"                ? const SizedBox.shrink()"},{"type":"INSERT","lineNumber":77,"content":"                : IconButton("},{"type":"INSERT","lineNumber":78,"content":"                    icon: const Icon(Icons.arrow_back),"},{"type":"INSERT","lineNumber":79,"content":"                    onPressed: () => Navigator.pop(context),"},{"type":"DELETE","lineNumber":117,"oldContent":"                  textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":118,"oldContent":"                ),"},{"type":"DELETE","lineNumber":119,"oldContent":"                "},{"type":"DELETE","lineNumber":120,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":121,"oldContent":"                "},{"type":"DELETE","lineNumber":122,"oldContent":"                // Description"},{"type":"DELETE","lineNumber":123,"oldContent":"                Text("},{"type":"DELETE","lineNumber":124,"oldContent":"                  'Enter the invite code provided by your family member to join their family group.',"},{"type":"DELETE","lineNumber":125,"oldContent":"                  style: TextStyle("},{"type":"DELETE","lineNumber":126,"oldContent":"                    fontSize: 16,"},{"type":"DELETE","lineNumber":127,"oldContent":"                    color: Colors.grey[600],"},{"type":"DELETE","lineNumber":128,"oldContent":"                    height: 1.5,"},{"type":"DELETE","lineNumber":129,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":130,"oldContent":"                  textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":131,"oldContent":"                ),"},{"type":"DELETE","lineNumber":132,"oldContent":"                "},{"type":"DELETE","lineNumber":133,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":134,"oldContent":"                "},{"type":"DELETE","lineNumber":135,"oldContent":"                // Invite code field"},{"type":"DELETE","lineNumber":136,"oldContent":"                TextFormField("},{"type":"DELETE","lineNumber":137,"oldContent":"                  controller: _inviteCodeController,"},{"type":"DELETE","lineNumber":138,"oldContent":"                  decoration: InputDecoration("},{"type":"DELETE","lineNumber":139,"oldContent":"                    labelText: 'Invite Code',"},{"type":"DELETE","lineNumber":140,"oldContent":"                    hintText: 'e.g., ABC123',"},{"type":"DELETE","lineNumber":141,"oldContent":"                    prefixIcon: const Icon(Icons.vpn_key_outlined),"},{"type":"DELETE","lineNumber":142,"oldContent":"                    border: OutlineInputBorder("},{"type":"DELETE","lineNumber":143,"oldContent":"                      borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"INSERT","lineNumber":81,"content":"          ),"},{"type":"INSERT","lineNumber":82,"content":"          body: SafeArea("},{"type":"INSERT","lineNumber":83,"content":"            child: Stack("},{"type":"INSERT","lineNumber":84,"content":"              children: ["},{"type":"INSERT","lineNumber":85,"content":"                SingleChildScrollView("},{"type":"INSERT","lineNumber":86,"content":"                  padding: const EdgeInsets.all(AppConstants.defaultPadding),"},{"type":"INSERT","lineNumber":87,"content":"                  child: Form("},{"type":"INSERT","lineNumber":88,"content":"                    key: _formKey,"},{"type":"INSERT","lineNumber":89,"content":"                    child: Column("},{"type":"INSERT","lineNumber":90,"content":"                      crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"INSERT","lineNumber":91,"content":"                      children: ["},{"type":"INSERT","lineNumber":92,"content":"                        const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":93,"content":"                        "},{"type":"INSERT","lineNumber":94,"content":"                        // Illustration"},{"type":"INSERT","lineNumber":95,"content":"                        Icon("},{"type":"INSERT","lineNumber":96,"content":"                          Icons.group_add,"},{"type":"INSERT","lineNumber":97,"content":"                          size: 120,"},{"type":"INSERT","lineNumber":98,"content":"                          color: Theme.of(context).primaryColor.withOpacity(0.8),"},{"type":"INSERT","lineNumber":99,"content":"                        ),"},{"type":"INSERT","lineNumber":100,"content":"                        "},{"type":"INSERT","lineNumber":101,"content":"                        const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":102,"content":"                        "},{"type":"INSERT","lineNumber":103,"content":"                        // Title"},{"type":"INSERT","lineNumber":104,"content":"                        const Text("},{"type":"INSERT","lineNumber":105,"content":"                          'Join a Family Group',"},{"type":"INSERT","lineNumber":106,"content":"                          style: TextStyle("},{"type":"INSERT","lineNumber":107,"content":"                            fontSize: 24,"},{"type":"INSERT","lineNumber":108,"content":"                            fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":109,"content":"                          ),"},{"type":"INSERT","lineNumber":110,"content":"                          textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":111,"content":"                        ),"},{"type":"INSERT","lineNumber":112,"content":"                        "},{"type":"INSERT","lineNumber":113,"content":"                        const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":114,"content":"                        "},{"type":"INSERT","lineNumber":115,"content":"                        // Description"},{"type":"INSERT","lineNumber":116,"content":"                        Text("},{"type":"INSERT","lineNumber":117,"content":"                          'Enter the invite code provided by your family member to join their family group.',"},{"type":"INSERT","lineNumber":118,"content":"                          style: TextStyle("},{"type":"INSERT","lineNumber":119,"content":"                            fontSize: 16,"},{"type":"INSERT","lineNumber":120,"content":"                            color: Colors.grey[600],"},{"type":"INSERT","lineNumber":121,"content":"                            height: 1.5,"},{"type":"INSERT","lineNumber":122,"content":"                          ),"},{"type":"INSERT","lineNumber":123,"content":"                          textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":124,"content":"                        ),"},{"type":"INSERT","lineNumber":125,"content":"                        "},{"type":"INSERT","lineNumber":126,"content":"                        const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":127,"content":"                        "},{"type":"INSERT","lineNumber":128,"content":"                        // Invite code field"},{"type":"INSERT","lineNumber":129,"content":"                        TextFormField("},{"type":"INSERT","lineNumber":130,"content":"                          controller: _inviteCodeController,"},{"type":"INSERT","lineNumber":131,"content":"                          decoration: InputDecoration("},{"type":"INSERT","lineNumber":132,"content":"                            labelText: 'Invite Code',"},{"type":"INSERT","lineNumber":133,"content":"                            hintText: 'e.g., ABC123',"},{"type":"INSERT","lineNumber":134,"content":"                            prefixIcon: const Icon(Icons.vpn_key_outlined),"},{"type":"INSERT","lineNumber":135,"content":"                            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":136,"content":"                              borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"INSERT","lineNumber":137,"content":"                            ),"},{"type":"INSERT","lineNumber":138,"content":"                          ),"},{"type":"INSERT","lineNumber":139,"content":"                          textCapitalization: TextCapitalization.characters,"},{"type":"INSERT","lineNumber":140,"content":"                          validator: (value) {"},{"type":"INSERT","lineNumber":141,"content":"                            if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":142,"content":"                              return 'Please enter an invite code';"},{"type":"INSERT","lineNumber":143,"content":"                            }"},{"type":"INSERT","lineNumber":144,"content":"                            if (value.length < 6) {"},{"type":"INSERT","lineNumber":145,"content":"                              return 'Invite code must be at least 6 characters';"},{"type":"INSERT","lineNumber":146,"content":"                            }"},{"type":"INSERT","lineNumber":147,"content":"                            return null;"},{"type":"INSERT","lineNumber":148,"content":"                          },"},{"type":"INSERT","lineNumber":149,"content":"                        ),"},{"type":"INSERT","lineNumber":150,"content":"                        "},{"type":"INSERT","lineNumber":151,"content":"                        const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":152,"content":"                        "},{"type":"INSERT","lineNumber":153,"content":"                        // Join button"},{"type":"INSERT","lineNumber":154,"content":"                        ElevatedButton("},{"type":"INSERT","lineNumber":155,"content":"                          onPressed: viewModel.isLoading ? null : _joinFamily,"},{"type":"INSERT","lineNumber":156,"content":"                          style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":157,"content":"                            padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":158,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":159,"content":"                              borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"INSERT","lineNumber":160,"content":"                            ),"},{"type":"INSERT","lineNumber":161,"content":"                          ),"},{"type":"INSERT","lineNumber":162,"content":"                          child: viewModel.isLoading"},{"type":"INSERT","lineNumber":163,"content":"                              ? const SizedBox("},{"type":"INSERT","lineNumber":164,"content":"                                  width: 24,"},{"type":"INSERT","lineNumber":165,"content":"                                  height: 24,"},{"type":"INSERT","lineNumber":166,"content":"                                  child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":167,"content":"                                    color: Colors.white,"},{"type":"INSERT","lineNumber":168,"content":"                                    strokeWidth: 2,"},{"type":"INSERT","lineNumber":169,"content":"                                  ),"},{"type":"INSERT","lineNumber":170,"content":"                                )"},{"type":"INSERT","lineNumber":171,"content":"                              : const Text("},{"type":"INSERT","lineNumber":172,"content":"                                  'Join Family',"},{"type":"INSERT","lineNumber":173,"content":"                                  style: TextStyle(fontSize: 16),"},{"type":"INSERT","lineNumber":174,"content":"                                ),"},{"type":"INSERT","lineNumber":175,"content":"                        ),"},{"type":"INSERT","lineNumber":176,"content":"                        "},{"type":"INSERT","lineNumber":177,"content":"                        const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":178,"content":"                        "},{"type":"INSERT","lineNumber":179,"content":"                        // Don't have a code? Create a family instead"},{"type":"INSERT","lineNumber":180,"content":"                        TextButton("},{"type":"INSERT","lineNumber":181,"content":"                          onPressed: viewModel.isLoading"},{"type":"INSERT","lineNumber":182,"content":"                              ? null"},{"type":"INSERT","lineNumber":183,"content":"                              : () {"},{"type":"INSERT","lineNumber":184,"content":"                                  Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":185,"content":"                                    context,"},{"type":"INSERT","lineNumber":186,"content":"                                    AppConstants.createFamilyRoute,"},{"type":"INSERT","lineNumber":187,"content":"                                  );"},{"type":"INSERT","lineNumber":188,"content":"                                },"},{"type":"INSERT","lineNumber":189,"content":"                          child: const Text('Create a new family instead'),"},{"type":"INSERT","lineNumber":190,"content":"                        ),"},{"type":"INSERT","lineNumber":191,"content":"                      ],"},{"type":"DELETE","lineNumber":146,"oldContent":"                  textCapitalization: TextCapitalization.characters,"},{"type":"DELETE","lineNumber":147,"oldContent":"                  validator: (value) {"},{"type":"DELETE","lineNumber":148,"oldContent":"                    if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":149,"oldContent":"                      return 'Please enter an invite code';"},{"type":"DELETE","lineNumber":150,"oldContent":"                    }"},{"type":"DELETE","lineNumber":151,"oldContent":"                    if (value.length < 6) {"},{"type":"DELETE","lineNumber":152,"oldContent":"                      return 'Invite code must be at least 6 characters';"},{"type":"DELETE","lineNumber":153,"oldContent":"                    }"},{"type":"DELETE","lineNumber":154,"oldContent":"                    return null;"},{"type":"DELETE","lineNumber":155,"oldContent":"                  },"},{"type":"DELETE","lineNumber":158,"oldContent":"                const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":159,"oldContent":"                "},{"type":"DELETE","lineNumber":160,"oldContent":"                    // Join button"},{"type":"DELETE","lineNumber":161,"oldContent":"                    ElevatedButton("},{"type":"DELETE","lineNumber":162,"oldContent":"                      onPressed: _isLoading ? null : _joinFamily,"},{"type":"DELETE","lineNumber":163,"oldContent":"                      style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":164,"oldContent":"                        padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":165,"oldContent":"                        shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":166,"oldContent":"                          borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"DELETE","lineNumber":167,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":168,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":169,"oldContent":"                      child: _isLoading"},{"type":"DELETE","lineNumber":170,"oldContent":"                          ? const SizedBox("},{"type":"DELETE","lineNumber":171,"oldContent":"                              width: 24,"},{"type":"DELETE","lineNumber":172,"oldContent":"                              height: 24,"},{"type":"DELETE","lineNumber":173,"oldContent":"                              child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":174,"oldContent":"                                color: Colors.white,"},{"type":"DELETE","lineNumber":175,"oldContent":"                                strokeWidth: 2,"},{"type":"DELETE","lineNumber":176,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":177,"oldContent":"                            )"},{"type":"DELETE","lineNumber":178,"oldContent":"                          : const Text("},{"type":"DELETE","lineNumber":179,"oldContent":"                              'Join Family',"},{"type":"DELETE","lineNumber":180,"oldContent":"                              style: TextStyle(fontSize: 16),"},{"type":"DELETE","lineNumber":181,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":196,"content":"                // Loading overlay"},{"type":"INSERT","lineNumber":197,"content":"                if (viewModel.isLoading)"},{"type":"INSERT","lineNumber":198,"content":"                  Container("},{"type":"INSERT","lineNumber":199,"content":"                    color: Colors.black.withOpacity(0.5),"},{"type":"INSERT","lineNumber":200,"content":"                    child: const Center("},{"type":"INSERT","lineNumber":201,"content":"                      child: CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":183,"oldContent":"                "},{"type":"DELETE","lineNumber":184,"oldContent":"                    const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":185,"oldContent":"                    "},{"type":"DELETE","lineNumber":186,"oldContent":"                    // Don't have a code? Create a family instead"},{"type":"DELETE","lineNumber":187,"oldContent":"                    TextButton("},{"type":"DELETE","lineNumber":188,"oldContent":"                      onPressed: _isLoading"},{"type":"DELETE","lineNumber":189,"oldContent":"                          ? null"},{"type":"DELETE","lineNumber":190,"oldContent":"                          : () {"},{"type":"DELETE","lineNumber":191,"oldContent":"                              Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":192,"oldContent":"                                context,"},{"type":"DELETE","lineNumber":193,"oldContent":"                                AppConstants.createFamilyRoute,"},{"type":"DELETE","lineNumber":194,"oldContent":"                              );"},{"type":"DELETE","lineNumber":195,"oldContent":"                            },"},{"type":"DELETE","lineNumber":196,"oldContent":"                      child: const Text('Create a new family instead'),"},{"type":"DELETE","lineNumber":197,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":198,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":199,"oldContent":"                ),"},{"type":"DELETE","lineNumber":200,"oldContent":"              ),"},{"type":"INSERT","lineNumber":203,"content":"                  ),"},{"type":"INSERT","lineNumber":204,"content":"              ],"},{"type":"DELETE","lineNumber":202,"oldContent":"            "},{"type":"DELETE","lineNumber":203,"oldContent":"            // Loading overlay"},{"type":"DELETE","lineNumber":204,"oldContent":"            if (_isLoading)"},{"type":"DELETE","lineNumber":205,"oldContent":"              Container("},{"type":"DELETE","lineNumber":206,"oldContent":"                color: Colors.black.withOpacity(0.5),"},{"type":"DELETE","lineNumber":207,"oldContent":"                child: const Center("},{"type":"DELETE","lineNumber":208,"oldContent":"                  child: CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":209,"oldContent":"                ),"},{"type":"DELETE","lineNumber":210,"oldContent":"              ),"},{"type":"DELETE","lineNumber":211,"oldContent":"          ],"},{"type":"DELETE","lineNumber":212,"oldContent":"        ),"},{"type":"DELETE","lineNumber":213,"oldContent":"      ),"},{"type":"DELETE","lineNumber":214,"oldContent":"      ),"},{"type":"INSERT","lineNumber":206,"content":"          ),"},{"type":"INSERT","lineNumber":207,"content":"        );"},{"type":"INSERT","lineNumber":208,"content":"      },"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/screens/create_family_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/screens/create_family_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:flutter_bloc/flutter_bloc.dart';\nimport 'package:family_tree_firebase/core/constants/app_constants.dart';\nimport 'package:family_tree_firebase/features/family/presentation/bloc/family_bloc.dart';\nimport 'package:family_tree_firebase/features/family/presentation/bloc/family_event.dart';\nimport 'package:family_tree_firebase/features/family/presentation/bloc/family_state.dart';\nimport 'package:family_tree_firebase/features/home/presentation/screens/home_screen.dart';\n\nclass CreateFamilyScreen extends StatefulWidget {\n  const CreateFamilyScreen({super.key});\n\n  @override\n  State<CreateFamilyScreen> createState() => _CreateFamilyScreenState();\n}\n\nclass _CreateFamilyScreenState extends State<CreateFamilyScreen> {\n  final _formKey = GlobalKey<FormState>();\n  final _familyNameController = TextEditingController();\n  bool _isLoading = false;\n  String? _generatedCode;\n\n  @override\n  void initState() {\n    super.initState();\n    // Reset any previous state when the screen is first loaded\n    context.read<FamilyBloc>().add(const ResetFamilyStateEvent());\n  }\n\n  @override\n  void dispose() {\n    _familyNameController.dispose();\n    super.dispose();\n  }\n  \n  void _showErrorSnackBar(String message) {\n    ScaffoldMessenger.of(context).showSnackBar(\n      SnackBar(\n        content: Text(message),\n        backgroundColor: Colors.red,\n        behavior: SnackBarBehavior.floating,\n        margin: const EdgeInsets.all(16),\n        shape: RoundedRectangleBorder(\n          borderRadius: BorderRadius.circular(8),\n        ),\n      ),\n    );\n  }\n\n  void _createFamily() {\n    if (!_formKey.currentState!.validate()) return;\n    \n    // Dismiss keyboard\n    FocusScope.of(context).unfocus();\n    \n    // Dispatch the CreateFamilyEvent\n    context.read<FamilyBloc>().add(\n          CreateFamilyEvent(_familyNameController.text.trim()),\n        );\n  }\n\n  void _copyToClipboard() {\n    if (_generatedCode == null) return;\n    \n    // TODO: Implement copy to clipboard\n    ScaffoldMessenger.of(context).showSnackBar(\n      const SnackBar(\n        content: Text('Invite code copied to clipboard'),\n        backgroundColor: Colors.green,\n        behavior: SnackBarBehavior.floating,\n        margin: EdgeInsets.all(16),\n        shape: RoundedRectangleBorder(\n          borderRadius: BorderRadius.circular(8),\n        ),\n      ),\n    );\n  }\n\n  void _continueToHome() {\n    Navigator.pushReplacement(\n      context,\n      MaterialPageRoute(builder: (context) => const HomeScreen()),\n    );\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return BlocConsumer<FamilyBloc, FamilyState>(\n      listener: (context, state) {\n        if (state is FamilyError) {\n          _showErrorSnackBar(state.message);\n          setState(() => _isLoading = false);\n        } else if (state is FamilyLoadSuccess && state.isNewlyCreated) {\n          // Show success message\n          ScaffoldMessenger.of(context).showSnackBar(\n            const SnackBar(\n              content: Text('Family created successfully!'),\n              backgroundColor: Colors.green,\n              behavior: SnackBarBehavior.floating,\n              margin: EdgeInsets.all(16),\n              shape: RoundedRectangleBorder(\n                borderRadius: BorderRadius.circular(8),\n              ),\n            ),\n          );\n          \n          // Set the generated code\n          if (state.family.currentInviteCode != null) {\n            setState(() {\n              _generatedCode = state.family.currentInviteCode;\n              _isLoading = false;\n            });\n          }\n        } else if (state is FamilyLoading) {\n          setState(() => _isLoading = true);\n        } else {\n          setState(() => _isLoading = false);\n        }\n      },\n      builder: (context, state) => Scaffold(\n        appBar: AppBar(\n          title: const Text('Create Family'),\n          leading: _isLoading\n              ? const SizedBox.shrink()\n              : IconButton(\n                  icon: const Icon(Icons.arrow_back),\n                  onPressed: _generatedCode == null \n                      ? () => Navigator.pop(context)\n                      : null,\n                ),\n        ),\n      body: SafeArea(\n        child: Stack(\n          children: [\n            SingleChildScrollView(\n              padding: const EdgeInsets.all(AppConstants.defaultPadding),\n              child: Form(\n                key: _formKey,\n                child: Column(\n                  crossAxisAlignment: CrossAxisAlignment.stretch,\n                  children: [\n                const SizedBox(height: 40),\n                \n                // Illustration\n                Icon(\n                  Icons.family_restroom,\n                  size: 120,\n                  color: Theme.of(context).primaryColor.withOpacity(0.8),\n                ),\n                \n                const SizedBox(height: 32),\n                \n                // Title\n                Text(\n                  _generatedCode == null \n                      ? 'Create a New Family'\n                      : 'Family Created!',\n                  style: const TextStyle(\n                    fontSize: 24,\n                    fontWeight: FontWeight.bold,\n                  ),\n                  textAlign: TextAlign.center,\n                ),\n                \n                const SizedBox(height: 16),\n                \n                if (_generatedCode == null) ...[\n                  // Family name input\n                  TextFormField(\n                    controller: _familyNameController,\n                    decoration: InputDecoration(\n                      labelText: 'Family Name',\n                      hintText: 'e.g., The Smiths',\n                      prefixIcon: const Icon(Icons.house_outlined),\n                      border: OutlineInputBorder(\n                        borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),\n                      ),\n                    ),\n                    validator: (value) {\n                      if (value == null || value.isEmpty) {\n                        return 'Please enter a family name';\n                      }\n                      if (value.length < 3) {\n                        return 'Name must be at least 3 characters';\n                      }\n                      return null;\n                    },\n                  ),\n                  \n                  const SizedBox(height: 24),\n                  \n                  // Create button\n                  ElevatedButton(\n                    onPressed: _isLoading ? null : _createFamily,\n                    style: ElevatedButton.styleFrom(\n                      padding: const EdgeInsets.symmetric(vertical: 16),\n                      shape: RoundedRectangleBorder(\n                        borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),\n                      ),\n                    ),\n                    child: _isLoading\n                        ? const SizedBox(\n                            width: 24,\n                            height: 24,\n                            child: CircularProgressIndicator(\n                              color: Colors.white,\n                              strokeWidth: 2,\n                            ),\n                          )\n                        : const Text(\n                            'Create Family',\n                            style: TextStyle(fontSize: 16),\n                          ),\n                  ),\n                ] else ...[\n                  // Success message\n                  Text(\n                    'Share this invite code with your family members to connect with them:',\n                    style: TextStyle(\n                      fontSize: 16,\n                      color: Colors.grey[600],\n                      height: 1.5,\n                    ),\n                    textAlign: TextAlign.center,\n                  ),\n                  \n                  const SizedBox(height: 32),\n                  \n                  // Invite code card\n                  Card(\n                    elevation: 4,\n                    shape: RoundedRectangleBorder(\n                      borderRadius: BorderRadius.circular(16),\n                    ),\n                    child: Padding(\n                      padding: const EdgeInsets.all(24.0),\n                      child: Column(\n                        children: [\n                          const Text(\n                            'Your Invite Code',\n                            style: TextStyle(\n                              fontSize: 16,\n                              color: Colors.grey,\n                            ),\n                          ),\n                          const SizedBox(height: 12),\n                          Text(\n                            _generatedCode!,\n                            style: const TextStyle(\n                              fontSize: 36,\n                              fontWeight: FontWeight.bold,\n                              letterSpacing: 4,\n                            ),\n                          ),\n                          const SizedBox(height: 8),\n                          Text(\n                            'Expires in 7 days',\n                            style: TextStyle(\n                              color: Colors.grey[600],\n                              fontSize: 14,\n                            ),\n                          ),\n                        ],\n                      ),\n                    ),\n                  ),\n                  \n                  const SizedBox(height: 24),\n                  \n                  // Copy button\n                  OutlinedButton.icon(\n                    onPressed: _copyToClipboard,\n                    icon: const Icon(Icons.copy),\n                    label: const Text('Copy Invite Code'),\n                    style: OutlinedButton.styleFrom(\n                      padding: const EdgeInsets.symmetric(vertical: 16),\n                      shape: RoundedRectangleBorder(\n                        borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),\n                      ),\n                    ),\n                  ),\n                  \n                  const SizedBox(height: 16),\n                  \n                  // Share button\n                  ElevatedButton.icon(\n                    onPressed: () {\n                      // TODO: Implement share functionality\n                    },\n                    icon: const Icon(Icons.share),\n                    label: const Text('Share Invite'),\n                    style: ElevatedButton.styleFrom(\n                      padding: const EdgeInsets.symmetric(vertical: 16),\n                      shape: RoundedRectangleBorder(\n                        borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),\n                      ),\n                    ),\n                  ),\n                  \n                  const SizedBox(height: 16),\n                  \n                  // Continue button\n                  TextButton(\n                    onPressed: _continueToHome,\n                    child: const Text('Continue to Home'),\n                  ),\n                ],\n                  ],\n                ),\n              ),\n            ),\n            \n            // Loading overlay\n            if (_isLoading)\n              Container(\n                color: Colors.black.withOpacity(0.5),\n                child: const Center(\n                  child: CircularProgressIndicator(),\n                ),\n              ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n","baseTimestamp":1754377599301,"deltas":[{"timestamp":1754462279965,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:provider/provider.dart';","oldContent":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_bloc.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_event.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_state.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":"import 'package:family_tree_firebase/features/home/presentation/screens/home_screen.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:family_tree_firebase/features/family/presentation/viewmodels/family_viewmodel.dart';"},{"type":"DELETE","lineNumber":18,"oldContent":"  bool _isLoading = false;"},{"type":"INSERT","lineNumber":15,"content":"  late FamilyViewModel _viewModel;"},{"type":"DELETE","lineNumber":24,"oldContent":"    // Reset any previous state when the screen is first loaded"},{"type":"DELETE","lineNumber":25,"oldContent":"    context.read<FamilyBloc>().add(const ResetFamilyStateEvent());"},{"type":"INSERT","lineNumber":21,"content":"    _viewModel = context.read<FamilyViewModel>();"},{"type":"INSERT","lineNumber":22,"content":"    _viewModel.addListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":28,"content":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":32,"content":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":33,"content":"    if (_viewModel.currentFamily != null && _viewModel.currentFamily!.currentInviteCode != null) {"},{"type":"INSERT","lineNumber":34,"content":"      setState(() {"},{"type":"INSERT","lineNumber":35,"content":"        _generatedCode = _viewModel.currentFamily!.currentInviteCode;"},{"type":"INSERT","lineNumber":36,"content":"      });"},{"type":"INSERT","lineNumber":37,"content":"    }"},{"type":"INSERT","lineNumber":38,"content":"    "},{"type":"INSERT","lineNumber":39,"content":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"INSERT","lineNumber":40,"content":"      _showErrorSnackBar(_viewModel.errorMessage!);"},{"type":"INSERT","lineNumber":41,"content":"      _viewModel.clearError();"},{"type":"INSERT","lineNumber":42,"content":"    }"},{"type":"INSERT","lineNumber":43,"content":"  }"},{"type":"INSERT","lineNumber":44,"content":"  "},{"type":"INSERT","lineNumber":46,"content":"    if (!mounted) return;"},{"type":"DELETE","lineNumber":48,"oldContent":"  void _createFamily() {"},{"type":"INSERT","lineNumber":60,"content":"  Future<void> _createFamily() async {"},{"type":"DELETE","lineNumber":54,"oldContent":"    // Dispatch the CreateFamilyEvent"},{"type":"DELETE","lineNumber":55,"oldContent":"    context.read<FamilyBloc>().add("},{"type":"DELETE","lineNumber":56,"oldContent":"          CreateFamilyEvent(_familyNameController.text.trim()),"},{"type":"DELETE","lineNumber":57,"oldContent":"        );"},{"type":"INSERT","lineNumber":66,"content":"    final success = await _viewModel.createNewFamily(_familyNameController.text.trim());"},{"type":"INSERT","lineNumber":67,"content":"    if (success && _viewModel.currentFamily != null) {"},{"type":"INSERT","lineNumber":68,"content":"      // Generate invite code after creating family"},{"type":"INSERT","lineNumber":69,"content":"      await _viewModel.generateNewInviteCode();"},{"type":"INSERT","lineNumber":70,"content":"    }"},{"type":"DELETE","lineNumber":86,"oldContent":"    return BlocConsumer<FamilyBloc, FamilyState>("},{"type":"DELETE","lineNumber":87,"oldContent":"      listener: (context, state) {"},{"type":"DELETE","lineNumber":88,"oldContent":"        if (state is FamilyError) {"},{"type":"DELETE","lineNumber":89,"oldContent":"          _showErrorSnackBar(state.message);"},{"type":"DELETE","lineNumber":90,"oldContent":"          setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":91,"oldContent":"        } else if (state is FamilyLoadSuccess && state.isNewlyCreated) {"},{"type":"DELETE","lineNumber":92,"oldContent":"          // Show success message"},{"type":"DELETE","lineNumber":93,"oldContent":"          ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":94,"oldContent":"            const SnackBar("},{"type":"DELETE","lineNumber":95,"oldContent":"              content: Text('Family created successfully!'),"},{"type":"DELETE","lineNumber":96,"oldContent":"              backgroundColor: Colors.green,"},{"type":"DELETE","lineNumber":97,"oldContent":"              behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":98,"oldContent":"              margin: EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":99,"oldContent":"              shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":100,"oldContent":"                borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":101,"oldContent":"              ),"},{"type":"DELETE","lineNumber":102,"oldContent":"            ),"},{"type":"DELETE","lineNumber":103,"oldContent":"          );"},{"type":"DELETE","lineNumber":104,"oldContent":"          "},{"type":"DELETE","lineNumber":105,"oldContent":"          // Set the generated code"},{"type":"DELETE","lineNumber":106,"oldContent":"          if (state.family.currentInviteCode != null) {"},{"type":"DELETE","lineNumber":107,"oldContent":"            setState(() {"},{"type":"DELETE","lineNumber":108,"oldContent":"              _generatedCode = state.family.currentInviteCode;"},{"type":"DELETE","lineNumber":109,"oldContent":"              _isLoading = false;"},{"type":"DELETE","lineNumber":110,"oldContent":"            });"},{"type":"DELETE","lineNumber":111,"oldContent":"          }"},{"type":"DELETE","lineNumber":112,"oldContent":"        } else if (state is FamilyLoading) {"},{"type":"DELETE","lineNumber":113,"oldContent":"          setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":114,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":115,"oldContent":"          setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":116,"oldContent":"        }"},{"type":"DELETE","lineNumber":117,"oldContent":"      },"},{"type":"DELETE","lineNumber":118,"oldContent":"      builder: (context, state) => Scaffold("},{"type":"DELETE","lineNumber":119,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":120,"oldContent":"          title: const Text('Create Family'),"},{"type":"DELETE","lineNumber":121,"oldContent":"          leading: _isLoading"},{"type":"DELETE","lineNumber":122,"oldContent":"              ? const SizedBox.shrink()"},{"type":"DELETE","lineNumber":123,"oldContent":"              : IconButton("},{"type":"DELETE","lineNumber":124,"oldContent":"                  icon: const Icon(Icons.arrow_back),"},{"type":"DELETE","lineNumber":125,"oldContent":"                  onPressed: _generatedCode == null "},{"type":"DELETE","lineNumber":126,"oldContent":"                      ? () => Navigator.pop(context)"},{"type":"DELETE","lineNumber":127,"oldContent":"                      : null,"},{"type":"DELETE","lineNumber":128,"oldContent":"                ),"},{"type":"DELETE","lineNumber":129,"oldContent":"        ),"},{"type":"DELETE","lineNumber":130,"oldContent":"      body: SafeArea("},{"type":"DELETE","lineNumber":131,"oldContent":"        child: Stack("},{"type":"DELETE","lineNumber":132,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":133,"oldContent":"            SingleChildScrollView("},{"type":"DELETE","lineNumber":134,"oldContent":"              padding: const EdgeInsets.all(AppConstants.defaultPadding),"},{"type":"DELETE","lineNumber":135,"oldContent":"              child: Form("},{"type":"DELETE","lineNumber":136,"oldContent":"                key: _formKey,"},{"type":"DELETE","lineNumber":137,"oldContent":"                child: Column("},{"type":"DELETE","lineNumber":138,"oldContent":"                  crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"DELETE","lineNumber":139,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":140,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":141,"oldContent":"                "},{"type":"DELETE","lineNumber":142,"oldContent":"                // Illustration"},{"type":"DELETE","lineNumber":143,"oldContent":"                Icon("},{"type":"DELETE","lineNumber":144,"oldContent":"                  Icons.family_restroom,"},{"type":"DELETE","lineNumber":145,"oldContent":"                  size: 120,"},{"type":"DELETE","lineNumber":146,"oldContent":"                  color: Theme.of(context).primaryColor.withOpacity(0.8),"},{"type":"DELETE","lineNumber":147,"oldContent":"                ),"},{"type":"DELETE","lineNumber":148,"oldContent":"                "},{"type":"DELETE","lineNumber":149,"oldContent":"                const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":150,"oldContent":"                "},{"type":"DELETE","lineNumber":151,"oldContent":"                // Title"},{"type":"DELETE","lineNumber":152,"oldContent":"                Text("},{"type":"DELETE","lineNumber":153,"oldContent":"                  _generatedCode == null "},{"type":"DELETE","lineNumber":154,"oldContent":"                      ? 'Create a New Family'"},{"type":"DELETE","lineNumber":155,"oldContent":"                      : 'Family Created!',"},{"type":"DELETE","lineNumber":156,"oldContent":"                  style: const TextStyle("},{"type":"DELETE","lineNumber":157,"oldContent":"                    fontSize: 24,"},{"type":"DELETE","lineNumber":158,"oldContent":"                    fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":99,"content":"    return Consumer<FamilyViewModel>("},{"type":"INSERT","lineNumber":100,"content":"      builder: (context, viewModel, _) {"},{"type":"INSERT","lineNumber":101,"content":"        return Scaffold("},{"type":"INSERT","lineNumber":102,"content":"          appBar: AppBar("},{"type":"INSERT","lineNumber":103,"content":"            title: const Text('Create Family'),"},{"type":"INSERT","lineNumber":104,"content":"            leading: viewModel.isLoading"},{"type":"INSERT","lineNumber":105,"content":"                ? const SizedBox.shrink()"},{"type":"INSERT","lineNumber":106,"content":"                : IconButton("},{"type":"INSERT","lineNumber":107,"content":"                    icon: const Icon(Icons.arrow_back),"},{"type":"INSERT","lineNumber":108,"content":"                    onPressed: () => Navigator.pop(context),"},{"type":"DELETE","lineNumber":160,"oldContent":"                  textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":161,"oldContent":"                ),"},{"type":"DELETE","lineNumber":162,"oldContent":"                "},{"type":"DELETE","lineNumber":163,"oldContent":"                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":164,"oldContent":"                "},{"type":"DELETE","lineNumber":165,"oldContent":"                if (_generatedCode == null) ...["},{"type":"DELETE","lineNumber":166,"oldContent":"                  // Family name input"},{"type":"DELETE","lineNumber":167,"oldContent":"                  TextFormField("},{"type":"DELETE","lineNumber":168,"oldContent":"                    controller: _familyNameController,"},{"type":"DELETE","lineNumber":169,"oldContent":"                    decoration: InputDecoration("},{"type":"DELETE","lineNumber":170,"oldContent":"                      labelText: 'Family Name',"},{"type":"DELETE","lineNumber":171,"oldContent":"                      hintText: 'e.g., The Smiths',"},{"type":"DELETE","lineNumber":172,"oldContent":"                      prefixIcon: const Icon(Icons.house_outlined),"},{"type":"DELETE","lineNumber":173,"oldContent":"                      border: OutlineInputBorder("},{"type":"DELETE","lineNumber":174,"oldContent":"                        borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"DELETE","lineNumber":175,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":176,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":177,"oldContent":"                    validator: (value) {"},{"type":"DELETE","lineNumber":178,"oldContent":"                      if (value == null || value.isEmpty) {"},{"type":"DELETE","lineNumber":179,"oldContent":"                        return 'Please enter a family name';"},{"type":"DELETE","lineNumber":180,"oldContent":"                      }"},{"type":"DELETE","lineNumber":181,"oldContent":"                      if (value.length < 3) {"},{"type":"DELETE","lineNumber":182,"oldContent":"                        return 'Name must be at least 3 characters';"},{"type":"DELETE","lineNumber":183,"oldContent":"                      }"},{"type":"DELETE","lineNumber":184,"oldContent":"                      return null;"},{"type":"DELETE","lineNumber":185,"oldContent":"                    },"},{"type":"DELETE","lineNumber":186,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":187,"oldContent":"                  "},{"type":"DELETE","lineNumber":188,"oldContent":"                  const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":189,"oldContent":"                  "},{"type":"DELETE","lineNumber":190,"oldContent":"                  // Create button"},{"type":"DELETE","lineNumber":191,"oldContent":"                  ElevatedButton("},{"type":"DELETE","lineNumber":192,"oldContent":"                    onPressed: _isLoading ? null : _createFamily,"},{"type":"DELETE","lineNumber":193,"oldContent":"                    style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":194,"oldContent":"                      padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":195,"oldContent":"                      shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":196,"oldContent":"                        borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"DELETE","lineNumber":197,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":198,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":199,"oldContent":"                    child: _isLoading"},{"type":"DELETE","lineNumber":200,"oldContent":"                        ? const SizedBox("},{"type":"DELETE","lineNumber":201,"oldContent":"                            width: 24,"},{"type":"DELETE","lineNumber":202,"oldContent":"                            height: 24,"},{"type":"DELETE","lineNumber":203,"oldContent":"                            child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":204,"oldContent":"                              color: Colors.white,"},{"type":"DELETE","lineNumber":205,"oldContent":"                              strokeWidth: 2,"},{"type":"DELETE","lineNumber":206,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":207,"oldContent":"                          )"},{"type":"DELETE","lineNumber":208,"oldContent":"                        : const Text("},{"type":"DELETE","lineNumber":209,"oldContent":"                            'Create Family',"},{"type":"DELETE","lineNumber":210,"oldContent":"                            style: TextStyle(fontSize: 16),"},{"type":"INSERT","lineNumber":110,"content":"          ),"},{"type":"INSERT","lineNumber":111,"content":"          body: SafeArea("},{"type":"INSERT","lineNumber":112,"content":"            child: Stack("},{"type":"INSERT","lineNumber":113,"content":"              children: ["},{"type":"INSERT","lineNumber":114,"content":"                SingleChildScrollView("},{"type":"INSERT","lineNumber":115,"content":"                  padding: const EdgeInsets.all(AppConstants.defaultPadding),"},{"type":"INSERT","lineNumber":116,"content":"                  child: Form("},{"type":"INSERT","lineNumber":117,"content":"                    key: _formKey,"},{"type":"INSERT","lineNumber":118,"content":"                    child: Column("},{"type":"INSERT","lineNumber":119,"content":"                      crossAxisAlignment: CrossAxisAlignment.stretch,"},{"type":"INSERT","lineNumber":120,"content":"                      children: ["},{"type":"INSERT","lineNumber":121,"content":"                        const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":122,"content":"                        "},{"type":"INSERT","lineNumber":123,"content":"                        // Illustration"},{"type":"INSERT","lineNumber":124,"content":"                        Icon("},{"type":"INSERT","lineNumber":125,"content":"                          Icons.family_restroom,"},{"type":"INSERT","lineNumber":126,"content":"                          size: 120,"},{"type":"INSERT","lineNumber":127,"content":"                          color: Theme.of(context).primaryColor.withOpacity(0.8),"},{"type":"INSERT","lineNumber":128,"content":"                        ),"},{"type":"INSERT","lineNumber":129,"content":"                        "},{"type":"INSERT","lineNumber":130,"content":"                        const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":131,"content":"                        "},{"type":"INSERT","lineNumber":132,"content":"                        // Title"},{"type":"INSERT","lineNumber":133,"content":"                        Text("},{"type":"INSERT","lineNumber":134,"content":"                          _generatedCode == null "},{"type":"INSERT","lineNumber":135,"content":"                              ? 'Create a New Family'"},{"type":"INSERT","lineNumber":136,"content":"                              : 'Family Created!',"},{"type":"INSERT","lineNumber":137,"content":"                          style: const TextStyle("},{"type":"INSERT","lineNumber":138,"content":"                            fontSize: 24,"},{"type":"INSERT","lineNumber":139,"content":"                            fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":212,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":213,"oldContent":"                ] else ...["},{"type":"DELETE","lineNumber":214,"oldContent":"                  // Success message"},{"type":"DELETE","lineNumber":215,"oldContent":"                  Text("},{"type":"DELETE","lineNumber":216,"oldContent":"                    'Share this invite code with your family members to connect with them:',"},{"type":"DELETE","lineNumber":217,"oldContent":"                    style: TextStyle("},{"type":"DELETE","lineNumber":218,"oldContent":"                      fontSize: 16,"},{"type":"DELETE","lineNumber":219,"oldContent":"                      color: Colors.grey[600],"},{"type":"DELETE","lineNumber":220,"oldContent":"                      height: 1.5,"},{"type":"DELETE","lineNumber":221,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":222,"oldContent":"                    textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":223,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":224,"oldContent":"                  "},{"type":"DELETE","lineNumber":225,"oldContent":"                  const SizedBox(height: 32),"},{"type":"DELETE","lineNumber":226,"oldContent":"                  "},{"type":"DELETE","lineNumber":227,"oldContent":"                  // Invite code card"},{"type":"DELETE","lineNumber":228,"oldContent":"                  Card("},{"type":"DELETE","lineNumber":229,"oldContent":"                    elevation: 4,"},{"type":"DELETE","lineNumber":230,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":231,"oldContent":"                      borderRadius: BorderRadius.circular(16),"},{"type":"DELETE","lineNumber":232,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":233,"oldContent":"                    child: Padding("},{"type":"DELETE","lineNumber":234,"oldContent":"                      padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":235,"oldContent":"                      child: Column("},{"type":"DELETE","lineNumber":236,"oldContent":"                        children: ["},{"type":"DELETE","lineNumber":237,"oldContent":"                          const Text("},{"type":"DELETE","lineNumber":238,"oldContent":"                            'Your Invite Code',"},{"type":"DELETE","lineNumber":239,"oldContent":"                            style: TextStyle("},{"type":"DELETE","lineNumber":240,"oldContent":"                              fontSize: 16,"},{"type":"DELETE","lineNumber":241,"oldContent":"                              color: Colors.grey,"},{"type":"INSERT","lineNumber":141,"content":"                          textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":142,"content":"                        ),"},{"type":"INSERT","lineNumber":143,"content":"                        "},{"type":"INSERT","lineNumber":144,"content":"                        const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":145,"content":"                        "},{"type":"INSERT","lineNumber":146,"content":"                        if (_generatedCode == null) ...["},{"type":"INSERT","lineNumber":147,"content":"                          // Family name input"},{"type":"INSERT","lineNumber":148,"content":"                          TextFormField("},{"type":"INSERT","lineNumber":149,"content":"                            controller: _familyNameController,"},{"type":"INSERT","lineNumber":150,"content":"                            decoration: InputDecoration("},{"type":"INSERT","lineNumber":151,"content":"                              labelText: 'Family Name',"},{"type":"INSERT","lineNumber":152,"content":"                              hintText: 'e.g., The Smiths',"},{"type":"INSERT","lineNumber":153,"content":"                              prefixIcon: const Icon(Icons.house_outlined),"},{"type":"INSERT","lineNumber":154,"content":"                              border: OutlineInputBorder("},{"type":"INSERT","lineNumber":155,"content":"                                borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"INSERT","lineNumber":156,"content":"                              ),"},{"type":"INSERT","lineNumber":158,"content":"                            validator: (value) {"},{"type":"INSERT","lineNumber":159,"content":"                              if (value == null || value.isEmpty) {"},{"type":"INSERT","lineNumber":160,"content":"                                return 'Please enter a family name';"},{"type":"INSERT","lineNumber":161,"content":"                              }"},{"type":"INSERT","lineNumber":162,"content":"                              if (value.length < 3) {"},{"type":"INSERT","lineNumber":163,"content":"                                return 'Name must be at least 3 characters';"},{"type":"INSERT","lineNumber":164,"content":"                              }"},{"type":"INSERT","lineNumber":165,"content":"                              return null;"},{"type":"INSERT","lineNumber":166,"content":"                            },"},{"type":"DELETE","lineNumber":244,"oldContent":"                          const SizedBox(height: 12),"},{"type":"DELETE","lineNumber":245,"oldContent":"                          Text("},{"type":"DELETE","lineNumber":246,"oldContent":"                            _generatedCode!,"},{"type":"DELETE","lineNumber":247,"oldContent":"                            style: const TextStyle("},{"type":"DELETE","lineNumber":248,"oldContent":"                              fontSize: 36,"},{"type":"DELETE","lineNumber":249,"oldContent":"                              fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":250,"oldContent":"                              letterSpacing: 4,"},{"type":"INSERT","lineNumber":168,"content":"                          "},{"type":"INSERT","lineNumber":169,"content":"                          const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":170,"content":"                          "},{"type":"INSERT","lineNumber":171,"content":"                          // Create button"},{"type":"INSERT","lineNumber":172,"content":"                          ElevatedButton("},{"type":"INSERT","lineNumber":173,"content":"                            onPressed: viewModel.isLoading ? null : _createFamily,"},{"type":"INSERT","lineNumber":174,"content":"                            style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":175,"content":"                              padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":176,"content":"                              shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":177,"content":"                                borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"INSERT","lineNumber":178,"content":"                              ),"},{"type":"INSERT","lineNumber":180,"content":"                            child: viewModel.isLoading"},{"type":"INSERT","lineNumber":181,"content":"                                ? const SizedBox("},{"type":"INSERT","lineNumber":182,"content":"                                    width: 24,"},{"type":"INSERT","lineNumber":183,"content":"                                    height: 24,"},{"type":"INSERT","lineNumber":184,"content":"                                    child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":185,"content":"                                      color: Colors.white,"},{"type":"INSERT","lineNumber":186,"content":"                                      strokeWidth: 2,"},{"type":"INSERT","lineNumber":187,"content":"                                    ),"},{"type":"INSERT","lineNumber":188,"content":"                                  )"},{"type":"INSERT","lineNumber":189,"content":"                                : const Text("},{"type":"INSERT","lineNumber":190,"content":"                                    'Create Family',"},{"type":"INSERT","lineNumber":191,"content":"                                    style: TextStyle(fontSize: 16),"},{"type":"INSERT","lineNumber":192,"content":"                                  ),"},{"type":"DELETE","lineNumber":253,"oldContent":"                          const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":194,"content":"                        ] else ...["},{"type":"INSERT","lineNumber":195,"content":"                          // Success message"},{"type":"DELETE","lineNumber":255,"oldContent":"                            'Expires in 7 days',"},{"type":"INSERT","lineNumber":197,"content":"                            'Share this invite code with your family members to connect with them:',"},{"type":"INSERT","lineNumber":199,"content":"                              fontSize: 16,"},{"type":"DELETE","lineNumber":258,"oldContent":"                              fontSize: 14,"},{"type":"INSERT","lineNumber":201,"content":"                              height: 1.5,"},{"type":"INSERT","lineNumber":203,"content":"                            textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":205,"content":"                          "},{"type":"INSERT","lineNumber":206,"content":"                          const SizedBox(height: 32),"},{"type":"INSERT","lineNumber":207,"content":"                          "},{"type":"INSERT","lineNumber":208,"content":"                          // Invite code card"},{"type":"INSERT","lineNumber":209,"content":"                          Card("},{"type":"INSERT","lineNumber":210,"content":"                            elevation: 4,"},{"type":"INSERT","lineNumber":211,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":212,"content":"                              borderRadius: BorderRadius.circular(16),"},{"type":"INSERT","lineNumber":213,"content":"                            ),"},{"type":"INSERT","lineNumber":214,"content":"                            child: Padding("},{"type":"INSERT","lineNumber":215,"content":"                              padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":216,"content":"                              child: Column("},{"type":"INSERT","lineNumber":217,"content":"                                children: ["},{"type":"INSERT","lineNumber":218,"content":"                                  const Text("},{"type":"INSERT","lineNumber":219,"content":"                                    'Your Invite Code',"},{"type":"INSERT","lineNumber":220,"content":"                                    style: TextStyle("},{"type":"INSERT","lineNumber":221,"content":"                                      fontSize: 16,"},{"type":"INSERT","lineNumber":222,"content":"                                      color: Colors.grey,"},{"type":"INSERT","lineNumber":223,"content":"                                    ),"},{"type":"INSERT","lineNumber":224,"content":"                                  ),"},{"type":"INSERT","lineNumber":225,"content":"                                  const SizedBox(height: 12),"},{"type":"INSERT","lineNumber":226,"content":"                                  Text("},{"type":"INSERT","lineNumber":227,"content":"                                    _generatedCode!,"},{"type":"INSERT","lineNumber":228,"content":"                                    style: const TextStyle("},{"type":"INSERT","lineNumber":229,"content":"                                      fontSize: 36,"},{"type":"INSERT","lineNumber":230,"content":"                                      fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":231,"content":"                                      letterSpacing: 4,"},{"type":"INSERT","lineNumber":232,"content":"                                    ),"},{"type":"INSERT","lineNumber":233,"content":"                                  ),"},{"type":"INSERT","lineNumber":234,"content":"                                  const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":235,"content":"                                  Text("},{"type":"INSERT","lineNumber":236,"content":"                                    'Expires in 7 days',"},{"type":"INSERT","lineNumber":237,"content":"                                    style: TextStyle("},{"type":"INSERT","lineNumber":238,"content":"                                      color: Colors.grey[600],"},{"type":"INSERT","lineNumber":239,"content":"                                      fontSize: 14,"},{"type":"INSERT","lineNumber":240,"content":"                                    ),"},{"type":"INSERT","lineNumber":241,"content":"                                  ),"},{"type":"INSERT","lineNumber":242,"content":"                                ],"},{"type":"INSERT","lineNumber":243,"content":"                              ),"},{"type":"INSERT","lineNumber":244,"content":"                            ),"},{"type":"INSERT","lineNumber":245,"content":"                          ),"},{"type":"INSERT","lineNumber":246,"content":"                          "},{"type":"INSERT","lineNumber":247,"content":"                          const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":248,"content":"                          "},{"type":"INSERT","lineNumber":249,"content":"                          // Copy button"},{"type":"INSERT","lineNumber":250,"content":"                          OutlinedButton.icon("},{"type":"INSERT","lineNumber":251,"content":"                            onPressed: _copyToClipboard,"},{"type":"INSERT","lineNumber":252,"content":"                            icon: const Icon(Icons.copy),"},{"type":"INSERT","lineNumber":253,"content":"                            label: const Text('Copy Invite Code'),"},{"type":"INSERT","lineNumber":254,"content":"                            style: OutlinedButton.styleFrom("},{"type":"INSERT","lineNumber":255,"content":"                              padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":256,"content":"                              shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":257,"content":"                                borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"INSERT","lineNumber":258,"content":"                              ),"},{"type":"INSERT","lineNumber":259,"content":"                            ),"},{"type":"INSERT","lineNumber":260,"content":"                          ),"},{"type":"INSERT","lineNumber":261,"content":"                          "},{"type":"INSERT","lineNumber":262,"content":"                          const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":263,"content":"                          "},{"type":"INSERT","lineNumber":264,"content":"                          // Share button"},{"type":"INSERT","lineNumber":265,"content":"                          ElevatedButton.icon("},{"type":"INSERT","lineNumber":266,"content":"                            onPressed: () {"},{"type":"INSERT","lineNumber":267,"content":"                              // TODO: Implement share functionality"},{"type":"INSERT","lineNumber":268,"content":"                            },"},{"type":"INSERT","lineNumber":269,"content":"                            icon: const Icon(Icons.share),"},{"type":"INSERT","lineNumber":270,"content":"                            label: const Text('Share Invite'),"},{"type":"INSERT","lineNumber":271,"content":"                            style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":272,"content":"                              padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":273,"content":"                              shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":274,"content":"                                borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"INSERT","lineNumber":275,"content":"                              ),"},{"type":"INSERT","lineNumber":276,"content":"                            ),"},{"type":"INSERT","lineNumber":277,"content":"                          ),"},{"type":"INSERT","lineNumber":278,"content":"                          "},{"type":"INSERT","lineNumber":279,"content":"                          const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":280,"content":"                          "},{"type":"INSERT","lineNumber":281,"content":"                          // Continue button"},{"type":"INSERT","lineNumber":282,"content":"                          TextButton("},{"type":"INSERT","lineNumber":283,"content":"                            onPressed: _continueToHome,"},{"type":"INSERT","lineNumber":284,"content":"                            child: const Text('Continue to Home'),"},{"type":"INSERT","lineNumber":285,"content":"                          ),"},{"type":"DELETE","lineNumber":265,"oldContent":"                  "},{"type":"DELETE","lineNumber":266,"oldContent":"                  const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":267,"oldContent":"                  "},{"type":"DELETE","lineNumber":268,"oldContent":"                  // Copy button"},{"type":"DELETE","lineNumber":269,"oldContent":"                  OutlinedButton.icon("},{"type":"DELETE","lineNumber":270,"oldContent":"                    onPressed: _copyToClipboard,"},{"type":"DELETE","lineNumber":271,"oldContent":"                    icon: const Icon(Icons.copy),"},{"type":"DELETE","lineNumber":272,"oldContent":"                    label: const Text('Copy Invite Code'),"},{"type":"DELETE","lineNumber":273,"oldContent":"                    style: OutlinedButton.styleFrom("},{"type":"DELETE","lineNumber":274,"oldContent":"                      padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":275,"oldContent":"                      shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":276,"oldContent":"                        borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"DELETE","lineNumber":277,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":290,"content":"                ),"},{"type":"INSERT","lineNumber":291,"content":"                "},{"type":"INSERT","lineNumber":292,"content":"                // Loading overlay"},{"type":"INSERT","lineNumber":293,"content":"                if (viewModel.isLoading)"},{"type":"INSERT","lineNumber":294,"content":"                  Container("},{"type":"INSERT","lineNumber":295,"content":"                    color: Colors.black.withOpacity(0.5),"},{"type":"INSERT","lineNumber":296,"content":"                    child: const Center("},{"type":"INSERT","lineNumber":297,"content":"                      child: CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":280,"oldContent":"                  "},{"type":"DELETE","lineNumber":281,"oldContent":"                  const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":282,"oldContent":"                  "},{"type":"DELETE","lineNumber":283,"oldContent":"                  // Share button"},{"type":"DELETE","lineNumber":284,"oldContent":"                  ElevatedButton.icon("},{"type":"DELETE","lineNumber":285,"oldContent":"                    onPressed: () {"},{"type":"DELETE","lineNumber":286,"oldContent":"                      // TODO: Implement share functionality"},{"type":"DELETE","lineNumber":287,"oldContent":"                    },"},{"type":"DELETE","lineNumber":288,"oldContent":"                    icon: const Icon(Icons.share),"},{"type":"DELETE","lineNumber":289,"oldContent":"                    label: const Text('Share Invite'),"},{"type":"DELETE","lineNumber":290,"oldContent":"                    style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":291,"oldContent":"                      padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":292,"oldContent":"                      shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":293,"oldContent":"                        borderRadius: BorderRadius.circular(AppConstants.defaultBorderRadius),"},{"type":"DELETE","lineNumber":294,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":295,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":296,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":297,"oldContent":"                  "},{"type":"DELETE","lineNumber":298,"oldContent":"                  const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":299,"oldContent":"                  "},{"type":"DELETE","lineNumber":300,"oldContent":"                  // Continue button"},{"type":"DELETE","lineNumber":301,"oldContent":"                  TextButton("},{"type":"DELETE","lineNumber":302,"oldContent":"                    onPressed: _continueToHome,"},{"type":"DELETE","lineNumber":303,"oldContent":"                    child: const Text('Continue to Home'),"},{"type":"DELETE","lineNumber":304,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":305,"oldContent":"                ],"},{"type":"DELETE","lineNumber":306,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":307,"oldContent":"                ),"},{"type":"DELETE","lineNumber":308,"oldContent":"              ),"},{"type":"INSERT","lineNumber":300,"content":"              ],"},{"type":"DELETE","lineNumber":310,"oldContent":"            "},{"type":"DELETE","lineNumber":311,"oldContent":"            // Loading overlay"},{"type":"DELETE","lineNumber":312,"oldContent":"            if (_isLoading)"},{"type":"DELETE","lineNumber":313,"oldContent":"              Container("},{"type":"DELETE","lineNumber":314,"oldContent":"                color: Colors.black.withOpacity(0.5),"},{"type":"DELETE","lineNumber":315,"oldContent":"                child: const Center("},{"type":"DELETE","lineNumber":316,"oldContent":"                  child: CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":317,"oldContent":"                ),"},{"type":"DELETE","lineNumber":318,"oldContent":"              ),"},{"type":"DELETE","lineNumber":319,"oldContent":"          ],"},{"type":"DELETE","lineNumber":320,"oldContent":"        ),"},{"type":"DELETE","lineNumber":321,"oldContent":"      ),"},{"type":"INSERT","lineNumber":302,"content":"          ),"},{"type":"INSERT","lineNumber":303,"content":"        );"},{"type":"INSERT","lineNumber":304,"content":"      },"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/screens/join_or_create_family_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/screens/join_or_create_family_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:family_tree_firebase/core/constants/app_constants.dart';\n\nclass JoinOrCreateFamilyScreen extends StatelessWidget {\n  const JoinOrCreateFamilyScreen({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Family Setup'),\n        centerTitle: true,\n      ),\n      body: Padding(\n        padding: const EdgeInsets.all(24.0),\n        child: Column(\n          mainAxisAlignment: MainAxisAlignment.center,\n          children: [\n            // Welcome text\n            const Text(\n              'Welcome to Family Connect!',\n              style: TextStyle(\n                fontSize: 24,\n                fontWeight: FontWeight.bold,\n              ),\n              textAlign: TextAlign.center,\n            ),\n            \n            const SizedBox(height: 8),\n            \n            const Text(\n              'Get started by joining an existing family or creating a new one',\n              style: TextStyle(\n                fontSize: 16,\n                color: Colors.grey,\n              ),\n              textAlign: TextAlign.center,\n            ),\n            \n            const SizedBox(height: 48),\n            \n            // Join Family Card\n            _buildOptionCard(\n              context,\n              icon: Icons.group_add,\n              title: 'Join Family',\n              description: 'Join an existing family using an invite code',\n              color: Colors.blue,\n              onTap: () {\n            ),\n\n            const SizedBox(height: 24),\n\n            // Create Family Card\n            Card(\n              elevation: 4,\n              shape: RoundedRectangleBorder(\n                borderRadius: BorderRadius.circular(16.0),\n              ),\n              child: InkWell(\n                borderRadius: BorderRadius.circular(16.0),\n                onTap: _isLoading\n                    ? null\n                    : () {\n                        Navigator.pushNamed(context, AppConstants.createFamilyRoute);\n                      },\n                child: Opacity(\n                  opacity: _isLoading ? 0.6 : 1.0,\n                  child: Padding(\n                    padding: const EdgeInsets.all(24.0),\n                    child: Column(\n                      children: [\n                        Icon(\n                          Icons.add_circle_outline,\n                          size: 48,\n                          color: Theme.of(context).primaryColor,\n                        ),\n                        const SizedBox(height: 16),\n                        const Text(\n                          'Create a Family',\n                          style: TextStyle(\n                            fontSize: 20,\n                            fontWeight: FontWeight.bold,\n                          ),\n                        ),\n                        const SizedBox(height: 8),\n                        Text(\n                          'Start a new family group and invite members',\n                          textAlign: TextAlign.center,\n                          style: TextStyle(\n                            color: Colors.grey[600],\n                            fontSize: 14,\n                          ),\n                        ),\n                        if (_isLoading) ...[\n                          const SizedBox(height: 16),\n                          const CircularProgressIndicator(),\n                        ],\n                      ],\n                    ),\n                  ),\n                ),\n              ),\n            ),\n          ],\n          ),\n        ),\n      ),\n    );\n  }\n}\n","baseTimestamp":1754377938904,"deltas":[{"timestamp":1754377982014,"changes":[{"type":"INSERT","lineNumber":1,"content":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_bloc.dart';"},{"type":"INSERT","lineNumber":4,"content":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_event.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"class JoinOrCreateFamilyScreen extends StatelessWidget {"},{"type":"INSERT","lineNumber":6,"content":"class JoinOrCreateFamilyScreen extends StatefulWidget {"},{"type":"DELETE","lineNumber":7,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":8,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":9,"oldContent":"      appBar: AppBar("},{"type":"DELETE","lineNumber":10,"oldContent":"        title: const Text('Family Setup'),"},{"type":"DELETE","lineNumber":11,"oldContent":"        centerTitle: true,"},{"type":"INSERT","lineNumber":10,"content":"  State<JoinOrCreateFamilyScreen> createState() => _JoinOrCreateFamilyScreenState();"},{"type":"INSERT","lineNumber":11,"content":"}"},{"type":"INSERT","lineNumber":12,"content":""},{"type":"INSERT","lineNumber":13,"content":"class _JoinOrCreateFamilyScreenState extends State<JoinOrCreateFamilyScreen> {"},{"type":"INSERT","lineNumber":14,"content":"  bool _isLoading = false;"},{"type":"INSERT","lineNumber":15,"content":""},{"type":"INSERT","lineNumber":16,"content":"  void _showErrorSnackBar(String message) {"},{"type":"INSERT","lineNumber":17,"content":"    ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":18,"content":"      SnackBar("},{"type":"INSERT","lineNumber":19,"content":"        content: Text(message),"},{"type":"INSERT","lineNumber":20,"content":"        backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":21,"content":"        behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":22,"content":"        margin: const EdgeInsets.all(16),"},{"type":"INSERT","lineNumber":23,"content":"        shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":24,"content":"          borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":25,"content":"        ),"},{"type":"DELETE","lineNumber":13,"oldContent":"      body: Padding("},{"type":"DELETE","lineNumber":14,"oldContent":"        padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":15,"oldContent":"        child: Column("},{"type":"DELETE","lineNumber":16,"oldContent":"          mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":17,"oldContent":"          children: ["},{"type":"INSERT","lineNumber":27,"content":"    );"},{"type":"INSERT","lineNumber":28,"content":"  }"},{"type":"INSERT","lineNumber":29,"content":""},{"type":"INSERT","lineNumber":30,"content":"  @override"},{"type":"INSERT","lineNumber":31,"content":"  void initState() {"},{"type":"INSERT","lineNumber":32,"content":"    super.initState();"},{"type":"INSERT","lineNumber":33,"content":"    // Reset any previous state when the screen is first loaded"},{"type":"INSERT","lineNumber":34,"content":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"INSERT","lineNumber":35,"content":"      context.read<FamilyBloc>().add(const ResetFamilyStateEvent());"},{"type":"INSERT","lineNumber":36,"content":"    });"},{"type":"INSERT","lineNumber":37,"content":"  }"},{"type":"INSERT","lineNumber":38,"content":""},{"type":"INSERT","lineNumber":39,"content":"  @override"},{"type":"INSERT","lineNumber":40,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":41,"content":"    return BlocListener<FamilyBloc, FamilyState>("},{"type":"INSERT","lineNumber":42,"content":"      listener: (context, state) {"},{"type":"INSERT","lineNumber":43,"content":"        if (state is FamilyError) {"},{"type":"INSERT","lineNumber":44,"content":"          _showErrorSnackBar(state.message);"},{"type":"INSERT","lineNumber":45,"content":"          setState(() => _isLoading = false);"},{"type":"INSERT","lineNumber":46,"content":"        } else if (state is FamilyLoading) {"},{"type":"INSERT","lineNumber":47,"content":"          setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":48,"content":"        } else {"},{"type":"INSERT","lineNumber":49,"content":"          setState(() => _isLoading = false);"},{"type":"INSERT","lineNumber":50,"content":"        }"},{"type":"INSERT","lineNumber":51,"content":"      },"},{"type":"INSERT","lineNumber":52,"content":"      child: Scaffold("},{"type":"INSERT","lineNumber":53,"content":"        appBar: AppBar("},{"type":"INSERT","lineNumber":54,"content":"          title: const Text('Family Setup'),"},{"type":"INSERT","lineNumber":55,"content":"          centerTitle: true,"},{"type":"INSERT","lineNumber":56,"content":"          automaticallyImplyLeading: !_isLoading,"},{"type":"INSERT","lineNumber":57,"content":"        ),"},{"type":"INSERT","lineNumber":58,"content":"      body: Stack("},{"type":"INSERT","lineNumber":59,"content":"        children: ["},{"type":"INSERT","lineNumber":60,"content":"          Padding("},{"type":"INSERT","lineNumber":61,"content":"            padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":62,"content":"            child: Column("},{"type":"INSERT","lineNumber":63,"content":"              mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":64,"content":"              children: ["},{"type":"DELETE","lineNumber":41,"oldContent":"            // Join Family Card"},{"type":"DELETE","lineNumber":42,"oldContent":"            _buildOptionCard("},{"type":"DELETE","lineNumber":43,"oldContent":"              context,"},{"type":"DELETE","lineNumber":44,"oldContent":"              icon: Icons.group_add,"},{"type":"DELETE","lineNumber":45,"oldContent":"              title: 'Join Family',"},{"type":"DELETE","lineNumber":46,"oldContent":"              description: 'Join an existing family using an invite code',"},{"type":"DELETE","lineNumber":47,"oldContent":"              color: Colors.blue,"},{"type":"DELETE","lineNumber":48,"oldContent":"              onTap: () {"},{"type":"INSERT","lineNumber":88,"content":"                // Join Family Card"},{"type":"INSERT","lineNumber":89,"content":"                Card("},{"type":"INSERT","lineNumber":90,"content":"                  elevation: 4,"},{"type":"INSERT","lineNumber":91,"content":"                  shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":92,"content":"                    borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":93,"content":"                  ),"},{"type":"INSERT","lineNumber":94,"content":"                  child: InkWell("},{"type":"INSERT","lineNumber":95,"content":"                    borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":96,"content":"                    onTap: _isLoading"},{"type":"INSERT","lineNumber":97,"content":"                        ? null"},{"type":"INSERT","lineNumber":98,"content":"                        : () {"},{"type":"INSERT","lineNumber":99,"content":"                            Navigator.pushNamed(context, AppConstants.joinFamilyRoute);"},{"type":"INSERT","lineNumber":100,"content":"                          },"},{"type":"INSERT","lineNumber":101,"content":"                    child: Opacity("},{"type":"INSERT","lineNumber":102,"content":"                      opacity: _isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":103,"content":"                      child: Padding("},{"type":"INSERT","lineNumber":104,"content":"                        padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":105,"content":"                        child: Column("},{"type":"INSERT","lineNumber":106,"content":"                          children: ["},{"type":"INSERT","lineNumber":107,"content":"                            Icon("},{"type":"INSERT","lineNumber":108,"content":"                              Icons.group_add,"},{"type":"INSERT","lineNumber":109,"content":"                              size: 48,"},{"type":"INSERT","lineNumber":110,"content":"                              color: Colors.blue,"},{"type":"INSERT","lineNumber":111,"content":"                            ),"},{"type":"INSERT","lineNumber":112,"content":"                            const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":113,"content":"                            const Text("},{"type":"INSERT","lineNumber":114,"content":"                              'Join a Family',"},{"type":"INSERT","lineNumber":115,"content":"                              style: TextStyle("},{"type":"INSERT","lineNumber":116,"content":"                                fontSize: 20,"},{"type":"INSERT","lineNumber":117,"content":"                                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":118,"content":"                              ),"},{"type":"INSERT","lineNumber":119,"content":"                            ),"},{"type":"INSERT","lineNumber":120,"content":"                            const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":121,"content":"                            Text("},{"type":"INSERT","lineNumber":122,"content":"                              'Join an existing family group using an invite code',"},{"type":"INSERT","lineNumber":123,"content":"                              textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":124,"content":"                              style: TextStyle("},{"type":"INSERT","lineNumber":125,"content":"                                color: Colors.grey[600],"},{"type":"INSERT","lineNumber":126,"content":"                                fontSize: 14,"},{"type":"INSERT","lineNumber":127,"content":"                              ),"},{"type":"INSERT","lineNumber":128,"content":"                            ),"},{"type":"INSERT","lineNumber":129,"content":"                            if (_isLoading) ...["},{"type":"INSERT","lineNumber":130,"content":"                              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":131,"content":"                              const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":132,"content":"                            ],"},{"type":"INSERT","lineNumber":133,"content":"                          ],"},{"type":"INSERT","lineNumber":134,"content":"                        ),"},{"type":"INSERT","lineNumber":135,"content":"                      ),"},{"type":"INSERT","lineNumber":136,"content":"                    ),"},{"type":"INSERT","lineNumber":137,"content":"                  ),"},{"type":"INSERT","lineNumber":138,"content":"                ),"},{"type":"DELETE","lineNumber":104,"oldContent":"          ],"},{"type":"INSERT","lineNumber":194,"content":"              ],"},{"type":"INSERT","lineNumber":195,"content":"            ),"},{"type":"INSERT","lineNumber":197,"content":"          "},{"type":"INSERT","lineNumber":198,"content":"          // Loading overlay"},{"type":"INSERT","lineNumber":199,"content":"          if (_isLoading)"},{"type":"INSERT","lineNumber":200,"content":"            Container("},{"type":"INSERT","lineNumber":201,"content":"              color: Colors.black.withOpacity(0.5),"},{"type":"INSERT","lineNumber":202,"content":"              child: const Center("},{"type":"INSERT","lineNumber":203,"content":"                child: CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":204,"content":"              ),"},{"type":"INSERT","lineNumber":205,"content":"            ),"},{"type":"INSERT","lineNumber":206,"content":"        ],"},{"type":"INSERT","lineNumber":207,"content":"      ),"}]},{"timestamp":1754378067925,"changes":[{"type":"DELETE","lineNumber":3,"oldContent":""},{"type":"DELETE","lineNumber":6,"oldContent":"  const JoinOrCreateFamilyScreen({super.key});"},{"type":"INSERT","lineNumber":5,"content":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_state.dart';"},{"type":"INSERT","lineNumber":8,"content":"  const JoinOrCreateFamilyScreen({super.key});"},{"type":"INSERT","lineNumber":9,"content":""},{"type":"DELETE","lineNumber":13,"oldContent":"      ),"},{"type":"DELETE","lineNumber":20,"oldContent":"            // Welcome text"},{"type":"DELETE","lineNumber":22,"oldContent":"            const Text("},{"type":"DELETE","lineNumber":24,"oldContent":"              'Welcome to Family Connect!',"},{"type":"DELETE","lineNumber":26,"oldContent":"              style: TextStyle("},{"type":"DELETE","lineNumber":28,"oldContent":"                fontSize: 24,"},{"type":"DELETE","lineNumber":30,"oldContent":"                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":32,"oldContent":"              ),"},{"type":"DELETE","lineNumber":34,"oldContent":"              textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":35,"oldContent":"            ),"},{"type":"INSERT","lineNumber":27,"content":"      ),"},{"type":"DELETE","lineNumber":37,"oldContent":"            "},{"type":"DELETE","lineNumber":39,"oldContent":"            const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":41,"oldContent":"            "},{"type":"DELETE","lineNumber":43,"oldContent":"            const Text("},{"type":"DELETE","lineNumber":45,"oldContent":"              'Get started by joining an existing family or creating a new one',"},{"type":"DELETE","lineNumber":47,"oldContent":"              style: TextStyle("},{"type":"DELETE","lineNumber":49,"oldContent":"                fontSize: 16,"},{"type":"DELETE","lineNumber":51,"oldContent":"                color: Colors.grey,"},{"type":"DELETE","lineNumber":53,"oldContent":"              ),"},{"type":"DELETE","lineNumber":55,"oldContent":"              textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":57,"oldContent":"            ),"},{"type":"DELETE","lineNumber":59,"oldContent":"            "},{"type":"DELETE","lineNumber":61,"oldContent":"            const SizedBox(height: 48),"},{"type":"DELETE","lineNumber":63,"oldContent":"            "},{"type":"DELETE","lineNumber":73,"oldContent":"            ),"},{"type":"DELETE","lineNumber":75,"oldContent":""},{"type":"DELETE","lineNumber":77,"oldContent":"            const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":79,"oldContent":""},{"type":"DELETE","lineNumber":81,"oldContent":"            // Create Family Card"},{"type":"DELETE","lineNumber":83,"oldContent":"            Card("},{"type":"DELETE","lineNumber":85,"oldContent":"              elevation: 4,"},{"type":"DELETE","lineNumber":87,"oldContent":"              shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":89,"oldContent":"                borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":91,"oldContent":"              ),"},{"type":"DELETE","lineNumber":93,"oldContent":"              child: InkWell("},{"type":"DELETE","lineNumber":94,"oldContent":"          Padding("},{"type":"DELETE","lineNumber":95,"oldContent":"                borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":96,"oldContent":"            padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":97,"oldContent":"                onTap: _isLoading"},{"type":"DELETE","lineNumber":98,"oldContent":"            child: Column("},{"type":"DELETE","lineNumber":99,"oldContent":"                    ? null"},{"type":"DELETE","lineNumber":100,"oldContent":"              mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":101,"oldContent":"                    : () {"},{"type":"DELETE","lineNumber":102,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":103,"oldContent":"                        Navigator.pushNamed(context, AppConstants.createFamilyRoute);"},{"type":"DELETE","lineNumber":104,"oldContent":"                      },"},{"type":"DELETE","lineNumber":105,"oldContent":"                child: Opacity("},{"type":"DELETE","lineNumber":106,"oldContent":"                  opacity: _isLoading ? 0.6 : 1.0,"},{"type":"DELETE","lineNumber":107,"oldContent":"                  child: Padding("},{"type":"DELETE","lineNumber":108,"oldContent":"                    padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":109,"oldContent":"                    child: Column("},{"type":"DELETE","lineNumber":110,"oldContent":"                      children: ["},{"type":"DELETE","lineNumber":111,"oldContent":"                        Icon("},{"type":"DELETE","lineNumber":112,"oldContent":"                          Icons.add_circle_outline,"},{"type":"DELETE","lineNumber":113,"oldContent":"                          size: 48,"},{"type":"DELETE","lineNumber":114,"oldContent":"                          color: Theme.of(context).primaryColor,"},{"type":"DELETE","lineNumber":115,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":116,"oldContent":"                        const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":117,"oldContent":"                        const Text("},{"type":"DELETE","lineNumber":118,"oldContent":"                          'Create a Family',"},{"type":"DELETE","lineNumber":119,"oldContent":"                          style: TextStyle("},{"type":"DELETE","lineNumber":120,"oldContent":"                            fontSize: 20,"},{"type":"DELETE","lineNumber":121,"oldContent":"                            fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":61,"content":"          SingleChildScrollView("},{"type":"INSERT","lineNumber":62,"content":"            child: Padding("},{"type":"INSERT","lineNumber":63,"content":"              padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":64,"content":"              child: Column("},{"type":"INSERT","lineNumber":65,"content":"                mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":66,"content":"                children: ["},{"type":"INSERT","lineNumber":67,"content":"                  const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":68,"content":"                  // Welcome text"},{"type":"INSERT","lineNumber":69,"content":"                  const Text("},{"type":"INSERT","lineNumber":70,"content":"                    'Welcome to Family Connect!',"},{"type":"INSERT","lineNumber":71,"content":"                    style: TextStyle("},{"type":"INSERT","lineNumber":72,"content":"                      fontSize: 24,"},{"type":"INSERT","lineNumber":73,"content":"                      fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":74,"content":"                    ),"},{"type":"INSERT","lineNumber":75,"content":"                    textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":76,"content":"                  ),"},{"type":"INSERT","lineNumber":77,"content":"                  "},{"type":"INSERT","lineNumber":78,"content":"                  const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":79,"content":"                  "},{"type":"INSERT","lineNumber":80,"content":"                  const Text("},{"type":"INSERT","lineNumber":81,"content":"                    'Get started by joining an existing family or creating a new one',"},{"type":"INSERT","lineNumber":82,"content":"                    style: TextStyle("},{"type":"INSERT","lineNumber":83,"content":"                      fontSize: 16,"},{"type":"INSERT","lineNumber":84,"content":"                      color: Colors.grey,"},{"type":"INSERT","lineNumber":85,"content":"                    ),"},{"type":"INSERT","lineNumber":86,"content":"                    textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":87,"content":"                  ),"},{"type":"INSERT","lineNumber":88,"content":"                  "},{"type":"INSERT","lineNumber":89,"content":"                  const SizedBox(height: 48),"},{"type":"INSERT","lineNumber":90,"content":"            "},{"type":"INSERT","lineNumber":91,"content":"                  // Join Family Card"},{"type":"INSERT","lineNumber":92,"content":"                  Card("},{"type":"INSERT","lineNumber":93,"content":"                    elevation: 4,"},{"type":"INSERT","lineNumber":94,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":95,"content":"                      borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":96,"content":"                    ),"},{"type":"INSERT","lineNumber":97,"content":"                    child: InkWell("},{"type":"INSERT","lineNumber":98,"content":"                      borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":99,"content":"                      onTap: _isLoading"},{"type":"INSERT","lineNumber":100,"content":"                          ? null"},{"type":"INSERT","lineNumber":101,"content":"                          : () {"},{"type":"INSERT","lineNumber":102,"content":"                              Navigator.pushNamed(context, AppConstants.joinFamilyRoute);"},{"type":"INSERT","lineNumber":103,"content":"                            },"},{"type":"INSERT","lineNumber":104,"content":"                      child: Opacity("},{"type":"INSERT","lineNumber":105,"content":"                        opacity: _isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":106,"content":"                        child: Padding("},{"type":"INSERT","lineNumber":107,"content":"                          padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":108,"content":"                          child: Column("},{"type":"INSERT","lineNumber":109,"content":"                            children: ["},{"type":"INSERT","lineNumber":110,"content":"                              Icon("},{"type":"INSERT","lineNumber":111,"content":"                                Icons.group_add,"},{"type":"INSERT","lineNumber":112,"content":"                                size: 48,"},{"type":"INSERT","lineNumber":113,"content":"                                color: Colors.blue,"},{"type":"INSERT","lineNumber":114,"content":"                              ),"},{"type":"INSERT","lineNumber":115,"content":"                              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":116,"content":"                              const Text("},{"type":"INSERT","lineNumber":117,"content":"                                'Join a Family',"},{"type":"INSERT","lineNumber":118,"content":"                                style: TextStyle("},{"type":"INSERT","lineNumber":119,"content":"                                  fontSize: 20,"},{"type":"INSERT","lineNumber":120,"content":"                                  fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":121,"content":"                                ),"},{"type":"INSERT","lineNumber":122,"content":"                              ),"},{"type":"INSERT","lineNumber":123,"content":"                              const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":124,"content":"                              Text("},{"type":"INSERT","lineNumber":125,"content":"                                'Join an existing family group using an invite code',"},{"type":"INSERT","lineNumber":126,"content":"                                textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":127,"content":"                                style: TextStyle("},{"type":"INSERT","lineNumber":128,"content":"                                  color: Colors.grey[600],"},{"type":"INSERT","lineNumber":129,"content":"                                  fontSize: 14,"},{"type":"INSERT","lineNumber":130,"content":"                                ),"},{"type":"INSERT","lineNumber":131,"content":"                              ),"},{"type":"INSERT","lineNumber":132,"content":"                              if (_isLoading) ...["},{"type":"INSERT","lineNumber":133,"content":"                                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":134,"content":"                                const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":135,"content":"                              ],"},{"type":"INSERT","lineNumber":136,"content":"                            ],"},{"type":"DELETE","lineNumber":124,"oldContent":"                        const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":125,"oldContent":"                        Text("},{"type":"DELETE","lineNumber":126,"oldContent":"                          'Start a new family group and invite members',"},{"type":"DELETE","lineNumber":127,"oldContent":"                // Join Family Card"},{"type":"DELETE","lineNumber":128,"oldContent":"                          textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":129,"oldContent":"                Card("},{"type":"DELETE","lineNumber":130,"oldContent":"                          style: TextStyle("},{"type":"DELETE","lineNumber":131,"oldContent":"                  elevation: 4,"},{"type":"DELETE","lineNumber":132,"oldContent":"                            color: Colors.grey[600],"},{"type":"DELETE","lineNumber":133,"oldContent":"                  shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":134,"oldContent":"                            fontSize: 14,"},{"type":"DELETE","lineNumber":135,"oldContent":"                    borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":136,"oldContent":"                          ),"},{"type":"INSERT","lineNumber":139,"content":"                      ),"},{"type":"INSERT","lineNumber":140,"content":"                    ),"},{"type":"INSERT","lineNumber":142,"content":""},{"type":"INSERT","lineNumber":143,"content":"                  const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":144,"content":""},{"type":"INSERT","lineNumber":145,"content":"                  // Create Family Card"},{"type":"INSERT","lineNumber":146,"content":"                  Card("},{"type":"INSERT","lineNumber":147,"content":"                    elevation: 4,"},{"type":"INSERT","lineNumber":148,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":149,"content":"                      borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":150,"content":"                    ),"},{"type":"INSERT","lineNumber":151,"content":"                    child: InkWell("},{"type":"INSERT","lineNumber":152,"content":"                      borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":153,"content":"                      onTap: _isLoading"},{"type":"INSERT","lineNumber":154,"content":"                          ? null"},{"type":"INSERT","lineNumber":155,"content":"                          : () {"},{"type":"INSERT","lineNumber":156,"content":"                              Navigator.pushNamed(context, AppConstants.createFamilyRoute);"},{"type":"INSERT","lineNumber":157,"content":"                            },"},{"type":"INSERT","lineNumber":158,"content":"                      child: Opacity("},{"type":"INSERT","lineNumber":159,"content":"                        opacity: _isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":160,"content":"                        child: Padding("},{"type":"INSERT","lineNumber":161,"content":"                          padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":162,"content":"                          child: Column("},{"type":"INSERT","lineNumber":163,"content":"                            children: ["},{"type":"INSERT","lineNumber":164,"content":"                              Icon("},{"type":"INSERT","lineNumber":165,"content":"                                Icons.add_circle_outline,"},{"type":"INSERT","lineNumber":166,"content":"                                size: 48,"},{"type":"INSERT","lineNumber":167,"content":"                                color: Theme.of(context).primaryColor,"},{"type":"INSERT","lineNumber":168,"content":"                              ),"},{"type":"INSERT","lineNumber":169,"content":"                              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":170,"content":"                              const Text("},{"type":"INSERT","lineNumber":171,"content":"                                'Create a Family',"},{"type":"INSERT","lineNumber":172,"content":"                                style: TextStyle("},{"type":"INSERT","lineNumber":173,"content":"                                  fontSize: 20,"},{"type":"INSERT","lineNumber":174,"content":"                                  fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":175,"content":"                                ),"},{"type":"INSERT","lineNumber":176,"content":"                              ),"},{"type":"INSERT","lineNumber":177,"content":"                              const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":178,"content":"                              Text("},{"type":"INSERT","lineNumber":179,"content":"                                'Start a new family group and invite members',"},{"type":"INSERT","lineNumber":180,"content":"                                textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":181,"content":"                                style: TextStyle("},{"type":"INSERT","lineNumber":182,"content":"                                  color: Colors.grey[600],"},{"type":"INSERT","lineNumber":183,"content":"                                  fontSize: 14,"},{"type":"INSERT","lineNumber":184,"content":"                                ),"},{"type":"INSERT","lineNumber":185,"content":"                              ),"},{"type":"INSERT","lineNumber":186,"content":"                              if (_isLoading) ...["},{"type":"INSERT","lineNumber":187,"content":"                                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":188,"content":"                                const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":189,"content":"                              ],"},{"type":"INSERT","lineNumber":190,"content":"                            ],"},{"type":"INSERT","lineNumber":191,"content":"                          ),"},{"type":"DELETE","lineNumber":139,"oldContent":"                  child: InkWell("},{"type":"DELETE","lineNumber":140,"oldContent":"                        if (_isLoading) ...["},{"type":"DELETE","lineNumber":141,"oldContent":"                    borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":142,"oldContent":"                          const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":143,"oldContent":"                    onTap: _isLoading"},{"type":"DELETE","lineNumber":144,"oldContent":"                          const CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":145,"oldContent":"                        ? null"},{"type":"DELETE","lineNumber":146,"oldContent":"                        ],"},{"type":"DELETE","lineNumber":147,"oldContent":"                        : () {"},{"type":"DELETE","lineNumber":148,"oldContent":"                      ],"},{"type":"DELETE","lineNumber":149,"oldContent":"                            Navigator.pushNamed(context, AppConstants.joinFamilyRoute);"},{"type":"INSERT","lineNumber":193,"content":"                      ),"},{"type":"DELETE","lineNumber":151,"oldContent":"                          },"},{"type":"DELETE","lineNumber":153,"oldContent":"                    child: Opacity("},{"type":"DELETE","lineNumber":154,"oldContent":"                ),"},{"type":"DELETE","lineNumber":155,"oldContent":"                      opacity: _isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":196,"content":"                ],"},{"type":"DELETE","lineNumber":157,"oldContent":"                      child: Padding("},{"type":"DELETE","lineNumber":159,"oldContent":"                        padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":160,"oldContent":"                        child: Column("},{"type":"DELETE","lineNumber":162,"oldContent":"                          children: ["},{"type":"INSERT","lineNumber":200,"content":"          "},{"type":"INSERT","lineNumber":201,"content":"          // Loading overlay"},{"type":"INSERT","lineNumber":202,"content":"          if (_isLoading)"},{"type":"INSERT","lineNumber":203,"content":"            Container("},{"type":"INSERT","lineNumber":204,"content":"              color: Colors.black.withOpacity(0.5),"},{"type":"INSERT","lineNumber":205,"content":"              child: const Center("},{"type":"INSERT","lineNumber":206,"content":"                child: CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":207,"content":"              ),"},{"type":"INSERT","lineNumber":208,"content":"            ),"},{"type":"INSERT","lineNumber":209,"content":"        ],"},{"type":"INSERT","lineNumber":210,"content":"      ),"},{"type":"DELETE","lineNumber":164,"oldContent":"                            Icon("},{"type":"DELETE","lineNumber":166,"oldContent":"                              Icons.group_add,"},{"type":"DELETE","lineNumber":168,"oldContent":"                              size: 48,"},{"type":"DELETE","lineNumber":170,"oldContent":"                              color: Colors.blue,"},{"type":"DELETE","lineNumber":172,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":174,"oldContent":"                            const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":175,"oldContent":"      ),"},{"type":"DELETE","lineNumber":176,"oldContent":"                            const Text("},{"type":"DELETE","lineNumber":177,"oldContent":"        ],"},{"type":"DELETE","lineNumber":178,"oldContent":"                              'Join a Family',"},{"type":"DELETE","lineNumber":179,"oldContent":"            ),"},{"type":"DELETE","lineNumber":180,"oldContent":"                              style: TextStyle("},{"type":"DELETE","lineNumber":181,"oldContent":"              ),"},{"type":"DELETE","lineNumber":182,"oldContent":"                                fontSize: 20,"},{"type":"DELETE","lineNumber":183,"oldContent":"                child: CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":184,"oldContent":"                                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":185,"oldContent":"              child: const Center("},{"type":"DELETE","lineNumber":186,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":187,"oldContent":"              color: Colors.black.withOpacity(0.5),"},{"type":"DELETE","lineNumber":188,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":189,"oldContent":"            Container("},{"type":"DELETE","lineNumber":190,"oldContent":"                            const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":191,"oldContent":"          if (_isLoading)"},{"type":"DELETE","lineNumber":192,"oldContent":"                            Text("},{"type":"DELETE","lineNumber":193,"oldContent":"          // Loading overlay"},{"type":"DELETE","lineNumber":194,"oldContent":"                              'Join an existing family group using an invite code',"},{"type":"DELETE","lineNumber":195,"oldContent":"          "},{"type":"DELETE","lineNumber":196,"oldContent":"                              textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":197,"oldContent":"            ),"},{"type":"DELETE","lineNumber":198,"oldContent":"                              style: TextStyle("},{"type":"DELETE","lineNumber":199,"oldContent":"              ],"},{"type":"DELETE","lineNumber":200,"oldContent":"                                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":201,"oldContent":"                ),"},{"type":"DELETE","lineNumber":202,"oldContent":"                                fontSize: 14,"},{"type":"DELETE","lineNumber":203,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":204,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":205,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":206,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":207,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":208,"oldContent":"                            if (_isLoading) ...["},{"type":"DELETE","lineNumber":209,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":210,"oldContent":"                              const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":211,"oldContent":"                          ],"},{"type":"DELETE","lineNumber":212,"oldContent":"                              const CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":213,"oldContent":"                            ],"}]},{"timestamp":1754455259515,"changes":[{"type":"MODIFY","lineNumber":5,"content":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_state.dart';","oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_state.dart';"},{"type":"MODIFY","lineNumber":8,"content":"  const JoinOrCreateFamilyScreen({super.key});","oldContent":"  const JoinOrCreateFamilyScreen({super.key});"},{"type":"DELETE","lineNumber":23,"oldContent":"      ),"},{"type":"INSERT","lineNumber":27,"content":"      ),"},{"type":"INSERT","lineNumber":41,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":42,"content":"    return BlocListener<FamilyBloc, FamilyState>("},{"type":"INSERT","lineNumber":43,"content":"      listener: (context, state) {"},{"type":"INSERT","lineNumber":44,"content":"        if (state is FamilyError) {"},{"type":"INSERT","lineNumber":45,"content":"          _showErrorSnackBar(state.message);"},{"type":"INSERT","lineNumber":46,"content":"          setState(() => _isLoading = false);"},{"type":"INSERT","lineNumber":47,"content":"        } else if (state is FamilyLoading) {"},{"type":"INSERT","lineNumber":48,"content":"          setState(() => _isLoading = true);"},{"type":"INSERT","lineNumber":49,"content":"        } else {"},{"type":"INSERT","lineNumber":50,"content":"          setState(() => _isLoading = false);"},{"type":"INSERT","lineNumber":51,"content":"        }"},{"type":"INSERT","lineNumber":52,"content":"      },"},{"type":"INSERT","lineNumber":53,"content":"      child: Scaffold("},{"type":"INSERT","lineNumber":54,"content":"        appBar: AppBar("},{"type":"INSERT","lineNumber":55,"content":"          title: const Text('Family Setup'),"},{"type":"INSERT","lineNumber":56,"content":"          centerTitle: true,"},{"type":"INSERT","lineNumber":57,"content":"          automaticallyImplyLeading: !_isLoading,"},{"type":"INSERT","lineNumber":58,"content":"        ),"},{"type":"INSERT","lineNumber":59,"content":"      body: Stack("},{"type":"INSERT","lineNumber":60,"content":"        children: ["},{"type":"DELETE","lineNumber":43,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":46,"oldContent":"    return BlocListener<FamilyBloc, FamilyState>("},{"type":"DELETE","lineNumber":48,"oldContent":"      listener: (context, state) {"},{"type":"DELETE","lineNumber":50,"oldContent":"        if (state is FamilyError) {"},{"type":"DELETE","lineNumber":52,"oldContent":"          _showErrorSnackBar(state.message);"},{"type":"DELETE","lineNumber":54,"oldContent":"          setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":56,"oldContent":"        } else if (state is FamilyLoading) {"},{"type":"DELETE","lineNumber":58,"oldContent":"          setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":60,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":62,"oldContent":"          setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":65,"oldContent":"        }"},{"type":"DELETE","lineNumber":68,"oldContent":"      },"},{"type":"DELETE","lineNumber":71,"oldContent":"      child: Scaffold("},{"type":"DELETE","lineNumber":74,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":77,"oldContent":"          title: const Text('Family Setup'),"},{"type":"DELETE","lineNumber":80,"oldContent":"          centerTitle: true,"},{"type":"DELETE","lineNumber":83,"oldContent":"          automaticallyImplyLeading: !_isLoading,"},{"type":"DELETE","lineNumber":86,"oldContent":"        ),"},{"type":"DELETE","lineNumber":89,"oldContent":"      body: Stack("},{"type":"DELETE","lineNumber":92,"oldContent":"        children: ["},{"type":"DELETE","lineNumber":123,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":125,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":139,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":137,"content":"                          ),"},{"type":"INSERT","lineNumber":141,"content":"                  ),"},{"type":"DELETE","lineNumber":152,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":155,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":160,"oldContent":"              ),"},{"type":"DELETE","lineNumber":163,"oldContent":"            ),"},{"type":"DELETE","lineNumber":167,"oldContent":"          ),"},{"type":"DELETE","lineNumber":170,"oldContent":"        ),"},{"type":"DELETE","lineNumber":173,"oldContent":"      ),"},{"type":"DELETE","lineNumber":176,"oldContent":"    );"},{"type":"DELETE","lineNumber":179,"oldContent":"  }"},{"type":"DELETE","lineNumber":182,"oldContent":"}"},{"type":"DELETE","lineNumber":185,"oldContent":""},{"type":"INSERT","lineNumber":192,"content":"                        ),"},{"type":"INSERT","lineNumber":194,"content":"                    ),"},{"type":"INSERT","lineNumber":195,"content":"                  ),"},{"type":"INSERT","lineNumber":197,"content":"              ),"},{"type":"INSERT","lineNumber":198,"content":"            ),"},{"type":"INSERT","lineNumber":199,"content":"          ),"},{"type":"INSERT","lineNumber":211,"content":"      ),"},{"type":"INSERT","lineNumber":212,"content":"    );"},{"type":"INSERT","lineNumber":213,"content":"  }"},{"type":"INSERT","lineNumber":214,"content":"  }"},{"type":"INSERT","lineNumber":215,"content":"}"},{"type":"INSERT","lineNumber":216,"content":""}]},{"timestamp":1754455755180,"changes":[{"type":"INSERT","lineNumber":4,"content":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_event.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_state.dart';"},{"type":"INSERT","lineNumber":7,"content":"class JoinOrCreateFamilyScreen extends StatefulWidget {"},{"type":"DELETE","lineNumber":8,"oldContent":"  const JoinOrCreateFamilyScreen({super.key});"},{"type":"MODIFY","lineNumber":27,"content":"      ),","oldContent":"      ),"},{"type":"DELETE","lineNumber":42,"oldContent":"          SingleChildScrollView("},{"type":"DELETE","lineNumber":44,"oldContent":"            child: Padding("},{"type":"DELETE","lineNumber":47,"oldContent":"              padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":49,"oldContent":"              child: Column("},{"type":"DELETE","lineNumber":52,"oldContent":"                mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":55,"oldContent":"                children: ["},{"type":"DELETE","lineNumber":58,"oldContent":"                  const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":61,"oldContent":"                  // Welcome text"},{"type":"DELETE","lineNumber":64,"oldContent":"                  const Text("},{"type":"DELETE","lineNumber":67,"oldContent":"                    'Welcome to Family Connect!',"},{"type":"DELETE","lineNumber":70,"oldContent":"                    style: TextStyle("},{"type":"INSERT","lineNumber":61,"content":"          SingleChildScrollView("},{"type":"INSERT","lineNumber":62,"content":"            child: Padding("},{"type":"INSERT","lineNumber":63,"content":"              padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":64,"content":"              child: Column("},{"type":"INSERT","lineNumber":65,"content":"                mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":66,"content":"                children: ["},{"type":"INSERT","lineNumber":67,"content":"                  const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":68,"content":"                  // Welcome text"},{"type":"INSERT","lineNumber":69,"content":"                  const Text("},{"type":"INSERT","lineNumber":70,"content":"                    'Welcome to Family Connect!',"},{"type":"INSERT","lineNumber":71,"content":"                    style: TextStyle("},{"type":"DELETE","lineNumber":135,"oldContent":"                          ),"},{"type":"INSERT","lineNumber":137,"content":"                          ),"},{"type":"DELETE","lineNumber":139,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":141,"content":"                  ),"},{"type":"DELETE","lineNumber":180,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":183,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":185,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":188,"oldContent":"              ),"},{"type":"DELETE","lineNumber":190,"oldContent":"            ),"},{"type":"MODIFY","lineNumber":192,"content":"                        ),","oldContent":"          ),"},{"type":"INSERT","lineNumber":194,"content":"                    ),"},{"type":"INSERT","lineNumber":195,"content":"                  ),"},{"type":"INSERT","lineNumber":197,"content":"              ),"},{"type":"INSERT","lineNumber":198,"content":"            ),"},{"type":"INSERT","lineNumber":199,"content":"          ),"},{"type":"DELETE","lineNumber":205,"oldContent":"      ),"},{"type":"DELETE","lineNumber":207,"oldContent":"    );"},{"type":"DELETE","lineNumber":209,"oldContent":"  }"},{"type":"DELETE","lineNumber":211,"oldContent":"  }"},{"type":"DELETE","lineNumber":213,"oldContent":"}"},{"type":"DELETE","lineNumber":215,"oldContent":""},{"type":"INSERT","lineNumber":211,"content":"    );"},{"type":"INSERT","lineNumber":212,"content":"  }"},{"type":"INSERT","lineNumber":213,"content":"}"},{"type":"INSERT","lineNumber":214,"content":""}]},{"timestamp":1754455863028,"changes":[{"type":"INSERT","lineNumber":26,"content":"        ),"},{"type":"DELETE","lineNumber":27,"oldContent":"      ),"},{"type":"INSERT","lineNumber":52,"content":"          setState(() => _isLoading = false);"},{"type":"INSERT","lineNumber":53,"content":"        }"},{"type":"INSERT","lineNumber":56,"content":"        appBar: AppBar("},{"type":"INSERT","lineNumber":57,"content":"          title: const Text('Family Setup'),"},{"type":"INSERT","lineNumber":58,"content":"          centerTitle: true,"},{"type":"INSERT","lineNumber":59,"content":"          automaticallyImplyLeading: !_isLoading,"},{"type":"INSERT","lineNumber":60,"content":"        ),"},{"type":"INSERT","lineNumber":61,"content":"      body: Stack("},{"type":"INSERT","lineNumber":62,"content":"        children: ["},{"type":"DELETE","lineNumber":56,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":58,"oldContent":"          title: const Text('Family Setup'),"},{"type":"DELETE","lineNumber":61,"oldContent":"          centerTitle: true,"},{"type":"DELETE","lineNumber":63,"oldContent":"          automaticallyImplyLeading: !_isLoading,"},{"type":"DELETE","lineNumber":66,"oldContent":"        ),"},{"type":"DELETE","lineNumber":68,"oldContent":"      body: Stack("},{"type":"DELETE","lineNumber":71,"oldContent":"        children: ["},{"type":"DELETE","lineNumber":136,"oldContent":"                          ),"},{"type":"INSERT","lineNumber":139,"content":"                          ),"},{"type":"DELETE","lineNumber":140,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":143,"content":"                  ),"},{"type":"DELETE","lineNumber":187,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":189,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":191,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":194,"oldContent":"              ),"},{"type":"DELETE","lineNumber":196,"oldContent":"            ),"},{"type":"INSERT","lineNumber":194,"content":"                        ),"},{"type":"DELETE","lineNumber":198,"oldContent":"          ),"},{"type":"INSERT","lineNumber":196,"content":"                    ),"},{"type":"INSERT","lineNumber":197,"content":"                  ),"},{"type":"INSERT","lineNumber":199,"content":"              ),"},{"type":"INSERT","lineNumber":200,"content":"            ),"},{"type":"INSERT","lineNumber":201,"content":"          ),"},{"type":"INSERT","lineNumber":210,"content":"            ),"},{"type":"INSERT","lineNumber":211,"content":"        ],"},{"type":"INSERT","lineNumber":212,"content":"      ),"},{"type":"DELETE","lineNumber":210,"oldContent":"            ),"},{"type":"DELETE","lineNumber":213,"oldContent":"        ],"},{"type":"DELETE","lineNumber":214,"oldContent":"      ),"}]},{"timestamp":1754455877777,"changes":[{"type":"DELETE","lineNumber":52,"oldContent":"          setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":54,"oldContent":"        }"},{"type":"DELETE","lineNumber":56,"oldContent":"          SingleChildScrollView("},{"type":"DELETE","lineNumber":57,"oldContent":"            child: Padding("},{"type":"DELETE","lineNumber":60,"oldContent":"              padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":63,"oldContent":"              child: Column("},{"type":"DELETE","lineNumber":65,"oldContent":"                mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":61,"content":"          SingleChildScrollView("},{"type":"INSERT","lineNumber":62,"content":"            child: Padding("},{"type":"INSERT","lineNumber":63,"content":"              padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":64,"content":"              child: Column("},{"type":"INSERT","lineNumber":65,"content":"                mainAxisAlignment: MainAxisAlignment.center,"},{"type":"MODIFY","lineNumber":138,"content":"                        ),","oldContent":"                        ),"},{"type":"MODIFY","lineNumber":142,"content":"","oldContent":""},{"type":"MODIFY","lineNumber":192,"content":"                        ),","oldContent":"                        ),"},{"type":"INSERT","lineNumber":193,"content":"                      ),"},{"type":"DELETE","lineNumber":197,"oldContent":"                      ),"},{"type":"MODIFY","lineNumber":197,"content":"              ),","oldContent":"              ),"},{"type":"MODIFY","lineNumber":200,"content":"          ","oldContent":"          "},{"type":"DELETE","lineNumber":210,"oldContent":"    );"},{"type":"DELETE","lineNumber":211,"oldContent":"  }"},{"type":"DELETE","lineNumber":214,"oldContent":"}"},{"type":"INSERT","lineNumber":211,"content":"    );"},{"type":"INSERT","lineNumber":212,"content":"  }"},{"type":"INSERT","lineNumber":213,"content":"}"}]},{"timestamp":1754456160845,"changes":[{"type":"DELETE","lineNumber":56,"oldContent":"          SingleChildScrollView("},{"type":"DELETE","lineNumber":58,"oldContent":"            child: Padding("},{"type":"DELETE","lineNumber":60,"oldContent":"              padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":61,"oldContent":"              child: Column("},{"type":"DELETE","lineNumber":63,"oldContent":"                mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":64,"oldContent":"      body: Stack("},{"type":"DELETE","lineNumber":65,"oldContent":"        children: ["},{"type":"DELETE","lineNumber":66,"oldContent":"                children: ["},{"type":"DELETE","lineNumber":67,"oldContent":"                  const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":68,"oldContent":"                  // Welcome text"},{"type":"DELETE","lineNumber":69,"oldContent":"                  const Text("},{"type":"DELETE","lineNumber":70,"oldContent":"                    'Welcome to Family Connect!',"},{"type":"DELETE","lineNumber":71,"oldContent":"                    style: TextStyle("},{"type":"DELETE","lineNumber":72,"oldContent":"                      fontSize: 24,"},{"type":"DELETE","lineNumber":73,"oldContent":"                      fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":59,"content":"        body: Stack("},{"type":"INSERT","lineNumber":60,"content":"          children: ["},{"type":"INSERT","lineNumber":61,"content":"            SingleChildScrollView("},{"type":"INSERT","lineNumber":62,"content":"              child: Padding("},{"type":"INSERT","lineNumber":63,"content":"                padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":64,"content":"                child: Column("},{"type":"INSERT","lineNumber":65,"content":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":66,"content":"                  children: ["},{"type":"INSERT","lineNumber":67,"content":"                    const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":68,"content":"                    // Welcome text"},{"type":"INSERT","lineNumber":69,"content":"                    const Text("},{"type":"INSERT","lineNumber":70,"content":"                      'Welcome to Family Connect!',"},{"type":"INSERT","lineNumber":71,"content":"                      style: TextStyle("},{"type":"INSERT","lineNumber":72,"content":"                        fontSize: 24,"},{"type":"INSERT","lineNumber":73,"content":"                        fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":74,"content":"                      ),"},{"type":"INSERT","lineNumber":75,"content":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":75,"oldContent":"                    textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":76,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":77,"oldContent":"                  "},{"type":"DELETE","lineNumber":78,"oldContent":"                  const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":79,"oldContent":"                  "},{"type":"DELETE","lineNumber":80,"oldContent":"                  const Text("},{"type":"DELETE","lineNumber":81,"oldContent":"                    'Get started by joining an existing family or creating a new one',"},{"type":"DELETE","lineNumber":82,"oldContent":"                    style: TextStyle("},{"type":"DELETE","lineNumber":83,"oldContent":"                      fontSize: 16,"},{"type":"DELETE","lineNumber":84,"oldContent":"                      color: Colors.grey,"},{"type":"INSERT","lineNumber":77,"content":"                    "},{"type":"INSERT","lineNumber":78,"content":"                    const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":79,"content":"                    "},{"type":"INSERT","lineNumber":80,"content":"                    const Text("},{"type":"INSERT","lineNumber":81,"content":"                      'Get started by joining an existing family or creating a new one',"},{"type":"INSERT","lineNumber":82,"content":"                      style: TextStyle("},{"type":"INSERT","lineNumber":83,"content":"                        fontSize: 16,"},{"type":"INSERT","lineNumber":84,"content":"                        color: Colors.grey,"},{"type":"INSERT","lineNumber":85,"content":"                      ),"},{"type":"INSERT","lineNumber":86,"content":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":86,"oldContent":"                    textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":87,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":88,"oldContent":"                  "},{"type":"DELETE","lineNumber":89,"oldContent":"                  const SizedBox(height: 48),"},{"type":"INSERT","lineNumber":88,"content":"                    "},{"type":"INSERT","lineNumber":89,"content":"                    const SizedBox(height: 48),"},{"type":"DELETE","lineNumber":91,"oldContent":"                  // Join Family Card"},{"type":"DELETE","lineNumber":92,"oldContent":"                  Card("},{"type":"DELETE","lineNumber":93,"oldContent":"                    elevation: 4,"},{"type":"DELETE","lineNumber":94,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":95,"oldContent":"                      borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":96,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":97,"oldContent":"                    child: InkWell("},{"type":"DELETE","lineNumber":98,"oldContent":"                      borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":99,"oldContent":"                      onTap: _isLoading"},{"type":"DELETE","lineNumber":100,"oldContent":"                          ? null"},{"type":"DELETE","lineNumber":101,"oldContent":"                          : () {"},{"type":"DELETE","lineNumber":102,"oldContent":"                              Navigator.pushNamed(context, AppConstants.joinFamilyRoute);"},{"type":"DELETE","lineNumber":103,"oldContent":"                            },"},{"type":"DELETE","lineNumber":104,"oldContent":"                      child: Opacity("},{"type":"DELETE","lineNumber":105,"oldContent":"                        opacity: _isLoading ? 0.6 : 1.0,"},{"type":"DELETE","lineNumber":106,"oldContent":"                        child: Padding("},{"type":"DELETE","lineNumber":107,"oldContent":"                          padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":108,"oldContent":"                          child: Column("},{"type":"DELETE","lineNumber":109,"oldContent":"                            children: ["},{"type":"DELETE","lineNumber":110,"oldContent":"                              Icon("},{"type":"DELETE","lineNumber":111,"oldContent":"                                Icons.group_add,"},{"type":"DELETE","lineNumber":112,"oldContent":"                                size: 48,"},{"type":"DELETE","lineNumber":113,"oldContent":"                                color: Colors.blue,"},{"type":"DELETE","lineNumber":114,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":115,"oldContent":"                              const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":116,"oldContent":"                              const Text("},{"type":"DELETE","lineNumber":117,"oldContent":"                                'Join a Family',"},{"type":"DELETE","lineNumber":118,"oldContent":"                                style: TextStyle("},{"type":"DELETE","lineNumber":119,"oldContent":"                                  fontSize: 20,"},{"type":"DELETE","lineNumber":120,"oldContent":"                                  fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":91,"content":"                    // Join Family Card"},{"type":"INSERT","lineNumber":92,"content":"                    Card("},{"type":"INSERT","lineNumber":93,"content":"                      elevation: 4,"},{"type":"INSERT","lineNumber":94,"content":"                      shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":95,"content":"                        borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":96,"content":"                      ),"},{"type":"INSERT","lineNumber":97,"content":"                      child: InkWell("},{"type":"INSERT","lineNumber":98,"content":"                        borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":99,"content":"                        onTap: _isLoading"},{"type":"INSERT","lineNumber":100,"content":"                            ? null"},{"type":"INSERT","lineNumber":101,"content":"                            : () {"},{"type":"INSERT","lineNumber":102,"content":"                                Navigator.pushNamed(context, AppConstants.joinFamilyRoute);"},{"type":"INSERT","lineNumber":103,"content":"                              },"},{"type":"INSERT","lineNumber":104,"content":"                        child: Opacity("},{"type":"INSERT","lineNumber":105,"content":"                          opacity: _isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":106,"content":"                          child: Padding("},{"type":"INSERT","lineNumber":107,"content":"                            padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":108,"content":"                            child: Column("},{"type":"INSERT","lineNumber":109,"content":"                              children: ["},{"type":"INSERT","lineNumber":110,"content":"                                Icon("},{"type":"INSERT","lineNumber":111,"content":"                                  Icons.group_add,"},{"type":"INSERT","lineNumber":112,"content":"                                  size: 48,"},{"type":"INSERT","lineNumber":113,"content":"                                  color: Colors.blue,"},{"type":"DELETE","lineNumber":122,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":123,"oldContent":"                              const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":124,"oldContent":"                              Text("},{"type":"DELETE","lineNumber":125,"oldContent":"                                'Join an existing family group using an invite code',"},{"type":"DELETE","lineNumber":126,"oldContent":"                                textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":127,"oldContent":"                                style: TextStyle("},{"type":"DELETE","lineNumber":128,"oldContent":"                                  color: Colors.grey[600],"},{"type":"DELETE","lineNumber":129,"oldContent":"                                  fontSize: 14,"},{"type":"DELETE","lineNumber":130,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":131,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":132,"oldContent":"                              if (_isLoading) ...["},{"type":"DELETE","lineNumber":134,"oldContent":"                                const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":116,"content":"                                const Text("},{"type":"INSERT","lineNumber":117,"content":"                                  'Join a Family',"},{"type":"INSERT","lineNumber":118,"content":"                                  style: TextStyle("},{"type":"INSERT","lineNumber":119,"content":"                                    fontSize: 20,"},{"type":"INSERT","lineNumber":120,"content":"                                    fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":121,"content":"                                  ),"},{"type":"INSERT","lineNumber":122,"content":"                                ),"},{"type":"INSERT","lineNumber":123,"content":"                                const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":124,"content":"                                Text("},{"type":"INSERT","lineNumber":125,"content":"                                  'Join an existing family group using an invite code',"},{"type":"INSERT","lineNumber":126,"content":"                                  textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":127,"content":"                                  style: TextStyle("},{"type":"INSERT","lineNumber":128,"content":"                                    color: Colors.grey[600],"},{"type":"INSERT","lineNumber":129,"content":"                                    fontSize: 14,"},{"type":"INSERT","lineNumber":130,"content":"                                  ),"},{"type":"INSERT","lineNumber":131,"content":"                                ),"},{"type":"INSERT","lineNumber":132,"content":"                                if (_isLoading) ...["},{"type":"INSERT","lineNumber":133,"content":"                                  const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":134,"content":"                                  const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":135,"content":"                                ],"},{"type":"DELETE","lineNumber":136,"oldContent":"                        ),"},{"type":"MODIFY","lineNumber":137,"content":"                            ),","oldContent":"                        ),"},{"type":"INSERT","lineNumber":139,"content":"                        ),"},{"type":"INSERT","lineNumber":141,"content":"                    ),"},{"type":"INSERT","lineNumber":143,"content":"                    const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":142,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":143,"oldContent":"                  const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":144,"oldContent":""},{"type":"DELETE","lineNumber":145,"oldContent":"                  // Create Family Card"},{"type":"DELETE","lineNumber":146,"oldContent":"                  Card("},{"type":"DELETE","lineNumber":147,"oldContent":"                    elevation: 4,"},{"type":"DELETE","lineNumber":148,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":149,"oldContent":"                      borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":150,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":151,"oldContent":"                    child: InkWell("},{"type":"DELETE","lineNumber":152,"oldContent":"                      borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":153,"oldContent":"                      onTap: _isLoading"},{"type":"DELETE","lineNumber":154,"oldContent":"                          ? null"},{"type":"DELETE","lineNumber":155,"oldContent":"                          : () {"},{"type":"DELETE","lineNumber":156,"oldContent":"                              Navigator.pushNamed(context, AppConstants.createFamilyRoute);"},{"type":"DELETE","lineNumber":157,"oldContent":"                            },"},{"type":"DELETE","lineNumber":158,"oldContent":"                      child: Opacity("},{"type":"DELETE","lineNumber":159,"oldContent":"                        opacity: _isLoading ? 0.6 : 1.0,"},{"type":"DELETE","lineNumber":160,"oldContent":"                        child: Padding("},{"type":"DELETE","lineNumber":161,"oldContent":"                          padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":162,"oldContent":"                          child: Column("},{"type":"DELETE","lineNumber":163,"oldContent":"                            children: ["},{"type":"DELETE","lineNumber":164,"oldContent":"                              Icon("},{"type":"DELETE","lineNumber":165,"oldContent":"                                Icons.add_circle_outline,"},{"type":"DELETE","lineNumber":166,"oldContent":"                                size: 48,"},{"type":"DELETE","lineNumber":167,"oldContent":"                                color: Theme.of(context).primaryColor,"},{"type":"DELETE","lineNumber":168,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":169,"oldContent":"                              const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":170,"oldContent":"                              const Text("},{"type":"DELETE","lineNumber":171,"oldContent":"                                'Create a Family',"},{"type":"DELETE","lineNumber":172,"oldContent":"                                style: TextStyle("},{"type":"DELETE","lineNumber":173,"oldContent":"                                  fontSize: 20,"},{"type":"DELETE","lineNumber":174,"oldContent":"                                  fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":145,"content":"                    // Create Family Card"},{"type":"INSERT","lineNumber":146,"content":"                    Card("},{"type":"INSERT","lineNumber":147,"content":"                      elevation: 4,"},{"type":"INSERT","lineNumber":148,"content":"                      shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":149,"content":"                        borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":150,"content":"                      ),"},{"type":"INSERT","lineNumber":151,"content":"                      child: InkWell("},{"type":"INSERT","lineNumber":152,"content":"                        borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":153,"content":"                        onTap: _isLoading"},{"type":"INSERT","lineNumber":154,"content":"                            ? null"},{"type":"INSERT","lineNumber":155,"content":"                            : () {"},{"type":"INSERT","lineNumber":156,"content":"                                Navigator.pushNamed(context, AppConstants.createFamilyRoute);"},{"type":"INSERT","lineNumber":157,"content":"                              },"},{"type":"INSERT","lineNumber":158,"content":"                        child: Opacity("},{"type":"INSERT","lineNumber":159,"content":"                          opacity: _isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":160,"content":"                          child: Padding("},{"type":"INSERT","lineNumber":161,"content":"                            padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":162,"content":"                            child: Column("},{"type":"INSERT","lineNumber":163,"content":"                              children: ["},{"type":"INSERT","lineNumber":164,"content":"                                Icon("},{"type":"INSERT","lineNumber":165,"content":"                                  Icons.add_circle_outline,"},{"type":"INSERT","lineNumber":166,"content":"                                  size: 48,"},{"type":"INSERT","lineNumber":167,"content":"                                  color: Theme.of(context).primaryColor,"},{"type":"DELETE","lineNumber":176,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":177,"oldContent":"                              const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":178,"oldContent":"                              Text("},{"type":"DELETE","lineNumber":179,"oldContent":"                                'Start a new family group and invite members',"},{"type":"DELETE","lineNumber":180,"oldContent":"                                textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":181,"oldContent":"                                style: TextStyle("},{"type":"DELETE","lineNumber":182,"oldContent":"                                  color: Colors.grey[600],"},{"type":"DELETE","lineNumber":183,"oldContent":"                                  fontSize: 14,"},{"type":"DELETE","lineNumber":184,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":185,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":186,"oldContent":"                              if (_isLoading) ...["},{"type":"DELETE","lineNumber":188,"oldContent":"                                const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":170,"content":"                                const Text("},{"type":"INSERT","lineNumber":171,"content":"                                  'Create a Family',"},{"type":"INSERT","lineNumber":172,"content":"                                  style: TextStyle("},{"type":"INSERT","lineNumber":173,"content":"                                    fontSize: 20,"},{"type":"INSERT","lineNumber":174,"content":"                                    fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":175,"content":"                                  ),"},{"type":"INSERT","lineNumber":176,"content":"                                ),"},{"type":"INSERT","lineNumber":177,"content":"                                const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":178,"content":"                                Text("},{"type":"INSERT","lineNumber":179,"content":"                                  'Start a new family group and invite members',"},{"type":"INSERT","lineNumber":180,"content":"                                  textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":181,"content":"                                  style: TextStyle("},{"type":"INSERT","lineNumber":182,"content":"                                    color: Colors.grey[600],"},{"type":"INSERT","lineNumber":183,"content":"                                    fontSize: 14,"},{"type":"INSERT","lineNumber":184,"content":"                                  ),"},{"type":"INSERT","lineNumber":185,"content":"                                ),"},{"type":"INSERT","lineNumber":186,"content":"                                if (_isLoading) ...["},{"type":"INSERT","lineNumber":187,"content":"                                  const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":188,"content":"                                  const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":189,"content":"                                ],"},{"type":"INSERT","lineNumber":191,"content":"                            ),"},{"type":"INSERT","lineNumber":192,"content":"                          ),"},{"type":"DELETE","lineNumber":192,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":193,"oldContent":"                          ),"},{"type":"MODIFY","lineNumber":196,"content":"                  ],","oldContent":"                  ),"},{"type":"INSERT","lineNumber":197,"content":"                ),"},{"type":"DELETE","lineNumber":197,"oldContent":"                ],"},{"type":"DELETE","lineNumber":198,"oldContent":"          "},{"type":"DELETE","lineNumber":199,"oldContent":"          "},{"type":"DELETE","lineNumber":200,"oldContent":"          ),"},{"type":"DELETE","lineNumber":201,"oldContent":"          // Loading overlay"},{"type":"DELETE","lineNumber":202,"oldContent":"          if (_isLoading)"},{"type":"DELETE","lineNumber":203,"oldContent":"            Container("},{"type":"DELETE","lineNumber":204,"oldContent":"              color: Colors.black.withOpacity(0.5),"},{"type":"DELETE","lineNumber":205,"oldContent":"              child: const Center("},{"type":"DELETE","lineNumber":206,"oldContent":"                child: CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":199,"content":"            ),"},{"type":"INSERT","lineNumber":200,"content":"            "},{"type":"INSERT","lineNumber":201,"content":"            // Loading overlay"},{"type":"INSERT","lineNumber":202,"content":"            if (_isLoading)"},{"type":"INSERT","lineNumber":203,"content":"              Container("},{"type":"INSERT","lineNumber":204,"content":"                color: Colors.black.withOpacity(0.5),"},{"type":"INSERT","lineNumber":205,"content":"                child: const Center("},{"type":"INSERT","lineNumber":206,"content":"                  child: CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":207,"content":"                ),"},{"type":"INSERT","lineNumber":209,"content":"          ],"},{"type":"INSERT","lineNumber":210,"content":"        ),"},{"type":"INSERT","lineNumber":211,"content":"      ),"},{"type":"DELETE","lineNumber":210,"oldContent":"            ),"},{"type":"DELETE","lineNumber":212,"oldContent":"        ],"},{"type":"DELETE","lineNumber":213,"oldContent":"      ),"}]},{"timestamp":1754457350564,"changes":[{"type":"DELETE","lineNumber":57,"oldContent":"        body: Stack("},{"type":"DELETE","lineNumber":59,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":60,"oldContent":"            SingleChildScrollView("},{"type":"DELETE","lineNumber":61,"oldContent":"              child: Padding("},{"type":"DELETE","lineNumber":63,"oldContent":"                padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":59,"content":"        body: LayoutBuilder("},{"type":"INSERT","lineNumber":60,"content":"          builder: (context, constraints) {"},{"type":"INSERT","lineNumber":61,"content":"            // Calculate padding based on screen width"},{"type":"INSERT","lineNumber":62,"content":"            final horizontalPadding = constraints.maxWidth > 600 "},{"type":"INSERT","lineNumber":63,"content":"                ? constraints.maxWidth * 0.15 "},{"type":"INSERT","lineNumber":64,"content":"                : 24.0;"},{"type":"INSERT","lineNumber":65,"content":"                "},{"type":"INSERT","lineNumber":66,"content":"            return Stack("},{"type":"INSERT","lineNumber":67,"content":"              children: ["},{"type":"INSERT","lineNumber":68,"content":"                SingleChildScrollView("},{"type":"INSERT","lineNumber":69,"content":"                  child: Padding("},{"type":"INSERT","lineNumber":70,"content":"                    padding: EdgeInsets.symmetric("},{"type":"INSERT","lineNumber":71,"content":"                      horizontal: horizontalPadding,"},{"type":"INSERT","lineNumber":72,"content":"                      vertical: 24.0,"},{"type":"INSERT","lineNumber":73,"content":"                    ),"},{"type":"DELETE","lineNumber":75,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":86,"content":"                    ),"},{"type":"DELETE","lineNumber":86,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":97,"content":"                    ),"},{"type":"INSERT","lineNumber":124,"content":"                                ),"},{"type":"INSERT","lineNumber":125,"content":"                                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":121,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":133,"oldContent":"                                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":141,"oldContent":""},{"type":"INSERT","lineNumber":154,"content":""},{"type":"INSERT","lineNumber":178,"content":"                                ),"},{"type":"INSERT","lineNumber":179,"content":"                                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":175,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":187,"oldContent":"                                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":191,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":193,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":203,"content":"                        ),"},{"type":"INSERT","lineNumber":204,"content":"                      ),"},{"type":"DELETE","lineNumber":196,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":207,"content":"                  ),"},{"type":"DELETE","lineNumber":199,"oldContent":"            ),"},{"type":"DELETE","lineNumber":200,"oldContent":"            "},{"type":"DELETE","lineNumber":201,"oldContent":"            // Loading overlay"},{"type":"DELETE","lineNumber":202,"oldContent":"            if (_isLoading)"},{"type":"DELETE","lineNumber":203,"oldContent":"              Container("},{"type":"DELETE","lineNumber":204,"oldContent":"                color: Colors.black.withOpacity(0.5),"},{"type":"DELETE","lineNumber":205,"oldContent":"                child: const Center("},{"type":"DELETE","lineNumber":206,"oldContent":"                  child: CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":207,"oldContent":"                ),"},{"type":"DELETE","lineNumber":208,"oldContent":"              ),"},{"type":"DELETE","lineNumber":209,"oldContent":"    );"},{"type":"DELETE","lineNumber":210,"oldContent":"          ],"},{"type":"DELETE","lineNumber":211,"oldContent":"  }"},{"type":"INSERT","lineNumber":209,"content":"                "},{"type":"INSERT","lineNumber":210,"content":"                // Loading overlay"},{"type":"INSERT","lineNumber":211,"content":"                if (_isLoading)"},{"type":"INSERT","lineNumber":212,"content":"                  Container("},{"type":"INSERT","lineNumber":213,"content":"                    color: Colors.black.withOpacity(0.5),"},{"type":"INSERT","lineNumber":214,"content":"                    child: const Center("},{"type":"INSERT","lineNumber":215,"content":"                      child: CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":216,"content":"                    ),"},{"type":"INSERT","lineNumber":217,"content":"                  ),"},{"type":"INSERT","lineNumber":218,"content":"              ],"},{"type":"INSERT","lineNumber":219,"content":"            );"},{"type":"INSERT","lineNumber":220,"content":"          },"},{"type":"INSERT","lineNumber":222,"content":"        ),"},{"type":"INSERT","lineNumber":224,"content":"    );"},{"type":"INSERT","lineNumber":225,"content":"  }"}]},{"timestamp":1754457571722,"changes":[{"type":"INSERT","lineNumber":58,"content":"        ),"},{"type":"DELETE","lineNumber":62,"oldContent":"        ),"},{"type":"DELETE","lineNumber":65,"oldContent":"                child: Column("},{"type":"DELETE","lineNumber":67,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":69,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":71,"oldContent":"                    const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":73,"oldContent":"                    // Welcome text"},{"type":"DELETE","lineNumber":75,"oldContent":"                    const Text("},{"type":"DELETE","lineNumber":77,"oldContent":"                      'Welcome to Family Connect!',"},{"type":"DELETE","lineNumber":79,"oldContent":"                      style: TextStyle("},{"type":"DELETE","lineNumber":81,"oldContent":"                        fontSize: 24,"},{"type":"DELETE","lineNumber":83,"oldContent":"                        fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":84,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":85,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":86,"oldContent":"                    "},{"type":"DELETE","lineNumber":87,"oldContent":"                    const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":88,"oldContent":"                    "},{"type":"DELETE","lineNumber":89,"oldContent":"                    const Text("},{"type":"DELETE","lineNumber":90,"oldContent":"                      'Get started by joining an existing family or creating a new one',"},{"type":"DELETE","lineNumber":91,"oldContent":"                      style: TextStyle("},{"type":"DELETE","lineNumber":92,"oldContent":"                        fontSize: 16,"},{"type":"DELETE","lineNumber":93,"oldContent":"                        color: Colors.grey,"},{"type":"DELETE","lineNumber":94,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":95,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":96,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":97,"oldContent":"                    "},{"type":"DELETE","lineNumber":98,"oldContent":"                    const SizedBox(height: 48),"},{"type":"DELETE","lineNumber":99,"oldContent":"            "},{"type":"DELETE","lineNumber":100,"oldContent":"                    // Join Family Card"},{"type":"DELETE","lineNumber":101,"oldContent":"                    Card("},{"type":"DELETE","lineNumber":102,"oldContent":"                      elevation: 4,"},{"type":"DELETE","lineNumber":103,"oldContent":"                      shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":104,"oldContent":"                        borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":105,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":106,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":107,"oldContent":"                      child: InkWell("},{"type":"DELETE","lineNumber":108,"oldContent":"                        borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":109,"oldContent":"                        onTap: _isLoading"},{"type":"DELETE","lineNumber":110,"oldContent":"                            ? null"},{"type":"DELETE","lineNumber":111,"oldContent":"                            : () {"},{"type":"DELETE","lineNumber":112,"oldContent":"                                Navigator.pushNamed(context, AppConstants.joinFamilyRoute);"},{"type":"DELETE","lineNumber":113,"oldContent":"                              },"},{"type":"DELETE","lineNumber":114,"oldContent":"                        child: Opacity("},{"type":"DELETE","lineNumber":115,"oldContent":"                          opacity: _isLoading ? 0.6 : 1.0,"},{"type":"DELETE","lineNumber":116,"oldContent":"                          child: Padding("},{"type":"DELETE","lineNumber":117,"oldContent":"                            padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":118,"oldContent":"                            child: Column("},{"type":"DELETE","lineNumber":119,"oldContent":"                              children: ["},{"type":"DELETE","lineNumber":120,"oldContent":"                                Icon("},{"type":"DELETE","lineNumber":121,"oldContent":"                                  Icons.group_add,"},{"type":"DELETE","lineNumber":122,"oldContent":"                                  size: 48,"},{"type":"DELETE","lineNumber":123,"oldContent":"                                  color: Colors.blue,"},{"type":"DELETE","lineNumber":124,"oldContent":"                                const Text("},{"type":"DELETE","lineNumber":125,"oldContent":"                                  'Join a Family',"},{"type":"DELETE","lineNumber":126,"oldContent":"                                  style: TextStyle("},{"type":"DELETE","lineNumber":127,"oldContent":"                                    fontSize: 20,"},{"type":"DELETE","lineNumber":128,"oldContent":"                                    fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":129,"oldContent":"                                  ),"},{"type":"INSERT","lineNumber":74,"content":"                    child: Column("},{"type":"INSERT","lineNumber":75,"content":"                      mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":76,"content":"                      children: ["},{"type":"INSERT","lineNumber":77,"content":"                        const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":78,"content":"                        // Welcome text"},{"type":"INSERT","lineNumber":79,"content":"                        const Text("},{"type":"INSERT","lineNumber":80,"content":"                          'Welcome to Family Connect!',"},{"type":"INSERT","lineNumber":81,"content":"                          style: TextStyle("},{"type":"INSERT","lineNumber":82,"content":"                            fontSize: 24,"},{"type":"INSERT","lineNumber":83,"content":"                            fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":84,"content":"                          ),"},{"type":"INSERT","lineNumber":85,"content":"                          textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":86,"content":"                        ),"},{"type":"INSERT","lineNumber":87,"content":"                        "},{"type":"INSERT","lineNumber":88,"content":"                        const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":89,"content":"                        "},{"type":"INSERT","lineNumber":90,"content":"                        const Text("},{"type":"INSERT","lineNumber":91,"content":"                          'Get started by joining an existing family or creating a new one',"},{"type":"INSERT","lineNumber":92,"content":"                          style: TextStyle("},{"type":"INSERT","lineNumber":93,"content":"                            fontSize: 16,"},{"type":"INSERT","lineNumber":94,"content":"                            color: Colors.grey,"},{"type":"INSERT","lineNumber":95,"content":"                          ),"},{"type":"INSERT","lineNumber":96,"content":"                          textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":97,"content":"                        ),"},{"type":"INSERT","lineNumber":98,"content":"                        "},{"type":"INSERT","lineNumber":99,"content":"                        const SizedBox(height: 48),"},{"type":"INSERT","lineNumber":100,"content":"                "},{"type":"INSERT","lineNumber":101,"content":"                        // Join Family Card"},{"type":"INSERT","lineNumber":102,"content":"                        Card("},{"type":"INSERT","lineNumber":103,"content":"                          elevation: 4,"},{"type":"INSERT","lineNumber":104,"content":"                          shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":105,"content":"                            borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":106,"content":"                          ),"},{"type":"INSERT","lineNumber":107,"content":"                          child: InkWell("},{"type":"INSERT","lineNumber":108,"content":"                            borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":109,"content":"                            onTap: _isLoading"},{"type":"INSERT","lineNumber":110,"content":"                                ? null"},{"type":"INSERT","lineNumber":111,"content":"                                : () {"},{"type":"INSERT","lineNumber":112,"content":"                                    Navigator.pushNamed(context, AppConstants.joinFamilyRoute);"},{"type":"INSERT","lineNumber":113,"content":"                                  },"},{"type":"INSERT","lineNumber":114,"content":"                            child: Opacity("},{"type":"INSERT","lineNumber":115,"content":"                              opacity: _isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":116,"content":"                              child: Padding("},{"type":"INSERT","lineNumber":117,"content":"                                padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":118,"content":"                                child: Column("},{"type":"INSERT","lineNumber":119,"content":"                                  children: ["},{"type":"INSERT","lineNumber":120,"content":"                                    const Icon("},{"type":"INSERT","lineNumber":121,"content":"                                      Icons.group_add,"},{"type":"INSERT","lineNumber":122,"content":"                                      size: 48,"},{"type":"INSERT","lineNumber":123,"content":"                                      color: Colors.blue,"},{"type":"INSERT","lineNumber":124,"content":"                                    ),"},{"type":"INSERT","lineNumber":125,"content":"                                    const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":126,"content":"                                    const Text("},{"type":"INSERT","lineNumber":127,"content":"                                      'Join a Family',"},{"type":"INSERT","lineNumber":128,"content":"                                      style: TextStyle("},{"type":"INSERT","lineNumber":129,"content":"                                        fontSize: 20,"},{"type":"INSERT","lineNumber":130,"content":"                                        fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":131,"content":"                                      ),"},{"type":"INSERT","lineNumber":132,"content":"                                    ),"},{"type":"INSERT","lineNumber":133,"content":"                                    const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":134,"content":"                                    Text("},{"type":"INSERT","lineNumber":135,"content":"                                      'Join an existing family group using an invite code',"},{"type":"INSERT","lineNumber":136,"content":"                                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":137,"content":"                                      style: TextStyle("},{"type":"INSERT","lineNumber":138,"content":"                                        color: Colors.grey[600],"},{"type":"INSERT","lineNumber":139,"content":"                                        fontSize: 14,"},{"type":"INSERT","lineNumber":140,"content":"                                      ),"},{"type":"INSERT","lineNumber":141,"content":"                                    ),"},{"type":"INSERT","lineNumber":142,"content":"                                    if (_isLoading) ...["},{"type":"INSERT","lineNumber":143,"content":"                                      const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":144,"content":"                                      const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":145,"content":"                                    ],"},{"type":"INSERT","lineNumber":146,"content":"                                  ],"},{"type":"DELETE","lineNumber":131,"oldContent":"                                const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":132,"oldContent":"                                Text("},{"type":"DELETE","lineNumber":133,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":134,"oldContent":"                                  'Join an existing family group using an invite code',"},{"type":"DELETE","lineNumber":135,"oldContent":"                                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":136,"oldContent":"                                  textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":137,"oldContent":"                                  style: TextStyle("},{"type":"DELETE","lineNumber":138,"oldContent":"                                    color: Colors.grey[600],"},{"type":"DELETE","lineNumber":139,"oldContent":"                                    fontSize: 14,"},{"type":"DELETE","lineNumber":140,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":141,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":142,"oldContent":"                                if (_isLoading) ...["},{"type":"DELETE","lineNumber":143,"oldContent":"                                  const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":144,"oldContent":"                                  const CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":145,"oldContent":"                                ],"},{"type":"DELETE","lineNumber":146,"oldContent":"                              ],"},{"type":"INSERT","lineNumber":148,"content":"                              ),"},{"type":"DELETE","lineNumber":150,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":151,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":153,"oldContent":"                    const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":154,"oldContent":"                    // Create Family Card"},{"type":"DELETE","lineNumber":155,"oldContent":"                    Card("},{"type":"DELETE","lineNumber":156,"oldContent":"                      elevation: 4,"},{"type":"DELETE","lineNumber":157,"oldContent":"                      shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":158,"oldContent":"                        borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":159,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":160,"oldContent":"                      child: InkWell("},{"type":"DELETE","lineNumber":161,"oldContent":"                        borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":162,"oldContent":"                        onTap: _isLoading"},{"type":"INSERT","lineNumber":153,"content":"                        const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":164,"oldContent":"                            ? null"},{"type":"DELETE","lineNumber":165,"oldContent":"                            : () {"},{"type":"DELETE","lineNumber":166,"oldContent":"                                Navigator.pushNamed(context, AppConstants.createFamilyRoute);"},{"type":"DELETE","lineNumber":167,"oldContent":"                              },"},{"type":"DELETE","lineNumber":168,"oldContent":"                        child: Opacity("},{"type":"DELETE","lineNumber":169,"oldContent":"                          opacity: _isLoading ? 0.6 : 1.0,"},{"type":"DELETE","lineNumber":170,"oldContent":"                          child: Padding("},{"type":"DELETE","lineNumber":171,"oldContent":"                            padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":172,"oldContent":"                            child: Column("},{"type":"DELETE","lineNumber":173,"oldContent":"                              children: ["},{"type":"DELETE","lineNumber":174,"oldContent":"                                Icon("},{"type":"DELETE","lineNumber":175,"oldContent":"                                  Icons.add_circle_outline,"},{"type":"DELETE","lineNumber":176,"oldContent":"                                  size: 48,"},{"type":"DELETE","lineNumber":177,"oldContent":"                                  color: Theme.of(context).primaryColor,"},{"type":"DELETE","lineNumber":178,"oldContent":"                                const Text("},{"type":"DELETE","lineNumber":179,"oldContent":"                                  'Create a Family',"},{"type":"DELETE","lineNumber":180,"oldContent":"                                  style: TextStyle("},{"type":"DELETE","lineNumber":181,"oldContent":"                                    fontSize: 20,"},{"type":"DELETE","lineNumber":182,"oldContent":"                                    fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":183,"oldContent":"                                  ),"},{"type":"INSERT","lineNumber":155,"content":"                        // Create Family Card"},{"type":"INSERT","lineNumber":156,"content":"                        Card("},{"type":"INSERT","lineNumber":157,"content":"                          elevation: 4,"},{"type":"INSERT","lineNumber":158,"content":"                          shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":159,"content":"                            borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":160,"content":"                          ),"},{"type":"INSERT","lineNumber":161,"content":"                          child: InkWell("},{"type":"INSERT","lineNumber":162,"content":"                            borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":163,"content":"                            onTap: _isLoading"},{"type":"INSERT","lineNumber":164,"content":"                                ? null"},{"type":"INSERT","lineNumber":165,"content":"                                : () {"},{"type":"INSERT","lineNumber":166,"content":"                                    Navigator.pushNamed(context, AppConstants.createFamilyRoute);"},{"type":"INSERT","lineNumber":167,"content":"                                  },"},{"type":"INSERT","lineNumber":168,"content":"                            child: Opacity("},{"type":"INSERT","lineNumber":169,"content":"                              opacity: _isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":170,"content":"                              child: Padding("},{"type":"INSERT","lineNumber":171,"content":"                                padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":172,"content":"                                child: Column("},{"type":"INSERT","lineNumber":173,"content":"                                  children: ["},{"type":"INSERT","lineNumber":174,"content":"                                    Icon("},{"type":"INSERT","lineNumber":175,"content":"                                      Icons.add_circle_outline,"},{"type":"INSERT","lineNumber":176,"content":"                                      size: 48,"},{"type":"INSERT","lineNumber":177,"content":"                                      color: Theme.of(context).primaryColor,"},{"type":"INSERT","lineNumber":178,"content":"                                    ),"},{"type":"INSERT","lineNumber":179,"content":"                                    const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":180,"content":"                                    const Text("},{"type":"INSERT","lineNumber":181,"content":"                                      'Create a Family',"},{"type":"INSERT","lineNumber":182,"content":"                                      style: TextStyle("},{"type":"INSERT","lineNumber":183,"content":"                                        fontSize: 20,"},{"type":"INSERT","lineNumber":184,"content":"                                        fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":185,"content":"                                      ),"},{"type":"INSERT","lineNumber":186,"content":"                                    ),"},{"type":"INSERT","lineNumber":187,"content":"                                    const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":188,"content":"                                    Text("},{"type":"INSERT","lineNumber":189,"content":"                                      'Start a new family group and invite members',"},{"type":"INSERT","lineNumber":190,"content":"                                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":191,"content":"                                      style: TextStyle("},{"type":"INSERT","lineNumber":192,"content":"                                        color: Colors.grey[600],"},{"type":"INSERT","lineNumber":193,"content":"                                        fontSize: 14,"},{"type":"INSERT","lineNumber":194,"content":"                                      ),"},{"type":"INSERT","lineNumber":195,"content":"                                    ),"},{"type":"INSERT","lineNumber":196,"content":"                                    if (_isLoading) ...["},{"type":"INSERT","lineNumber":197,"content":"                                      const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":198,"content":"                                      const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":199,"content":"                                    ],"},{"type":"INSERT","lineNumber":200,"content":"                                  ],"},{"type":"DELETE","lineNumber":185,"oldContent":"                                const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":186,"oldContent":"                                Text("},{"type":"DELETE","lineNumber":187,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":188,"oldContent":"                                  'Start a new family group and invite members',"},{"type":"DELETE","lineNumber":189,"oldContent":"                                const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":190,"oldContent":"                                  textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":191,"oldContent":"                                  style: TextStyle("},{"type":"DELETE","lineNumber":192,"oldContent":"                                    color: Colors.grey[600],"},{"type":"DELETE","lineNumber":193,"oldContent":"                                    fontSize: 14,"},{"type":"DELETE","lineNumber":194,"oldContent":"                                  ),"},{"type":"DELETE","lineNumber":195,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":196,"oldContent":"                                if (_isLoading) ...["},{"type":"DELETE","lineNumber":197,"oldContent":"                                  const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":198,"oldContent":"                                  const CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":199,"oldContent":"                                ],"},{"type":"DELETE","lineNumber":200,"oldContent":"                              ],"},{"type":"INSERT","lineNumber":202,"content":"                              ),"},{"type":"DELETE","lineNumber":203,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":204,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":205,"oldContent":"                ),"},{"type":"MODIFY","lineNumber":206,"content":"                      ],","oldContent":"                      ),"},{"type":"INSERT","lineNumber":207,"content":"                    ),"},{"type":"INSERT","lineNumber":209,"content":"                ),"},{"type":"DELETE","lineNumber":213,"oldContent":"        ),"},{"type":"DELETE","lineNumber":215,"oldContent":"      ),"},{"type":"DELETE","lineNumber":217,"oldContent":"}"},{"type":"DELETE","lineNumber":219,"oldContent":""},{"type":"DELETE","lineNumber":221,"oldContent":"  }"},{"type":"DELETE","lineNumber":223,"oldContent":"    );"},{"type":"DELETE","lineNumber":225,"oldContent":"        ),"},{"type":"INSERT","lineNumber":222,"content":"        ),"},{"type":"INSERT","lineNumber":223,"content":"        ),"},{"type":"INSERT","lineNumber":224,"content":"      ),"},{"type":"INSERT","lineNumber":225,"content":"    );"},{"type":"INSERT","lineNumber":226,"content":"  }"},{"type":"INSERT","lineNumber":227,"content":"}"},{"type":"INSERT","lineNumber":228,"content":""}]},{"timestamp":1754457653297,"changes":[{"type":"DELETE","lineNumber":69,"oldContent":"                    child: Column("},{"type":"INSERT","lineNumber":70,"content":"                    padding: EdgeInsets.symmetric("},{"type":"INSERT","lineNumber":71,"content":"                      horizontal: horizontalPadding,"},{"type":"INSERT","lineNumber":72,"content":"                      vertical: 24.0,"},{"type":"INSERT","lineNumber":73,"content":"                    ),"},{"type":"INSERT","lineNumber":74,"content":"                    child: Column("},{"type":"DELETE","lineNumber":73,"oldContent":"                    padding: EdgeInsets.symmetric("},{"type":"DELETE","lineNumber":76,"oldContent":"                      horizontal: horizontalPadding,"},{"type":"DELETE","lineNumber":79,"oldContent":"                      vertical: 24.0,"},{"type":"DELETE","lineNumber":82,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":131,"oldContent":"                                ),"},{"type":"MODIFY","lineNumber":147,"content":"                                ),","oldContent":"                            ),"},{"type":"INSERT","lineNumber":149,"content":"                            ),"},{"type":"INSERT","lineNumber":154,"content":""},{"type":"DELETE","lineNumber":163,"oldContent":""},{"type":"DELETE","lineNumber":185,"oldContent":"                                ),"},{"type":"MODIFY","lineNumber":201,"content":"                                ),","oldContent":"                            ),"},{"type":"INSERT","lineNumber":203,"content":"                            ),"},{"type":"INSERT","lineNumber":205,"content":"                        ),"},{"type":"DELETE","lineNumber":207,"oldContent":"                      ),"},{"type":"MODIFY","lineNumber":219,"content":"              ],","oldContent":"        ),"},{"type":"INSERT","lineNumber":220,"content":"            );"},{"type":"INSERT","lineNumber":221,"content":"          },"},{"type":"DELETE","lineNumber":222,"oldContent":"              ],"},{"type":"DELETE","lineNumber":225,"oldContent":"            );"},{"type":"DELETE","lineNumber":227,"oldContent":"          },"}]},{"timestamp":1754461932638,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:provider/provider.dart';","oldContent":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_bloc.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_event.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/bloc/family_state.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:family_tree_firebase/features/family/presentation/viewmodels/family_viewmodel.dart';"},{"type":"DELETE","lineNumber":15,"oldContent":"  bool _isLoading = false;"},{"type":"INSERT","lineNumber":13,"content":"  late FamilyViewModel _viewModel;"},{"type":"INSERT","lineNumber":14,"content":"  bool _isCreatingFamily = false;"},{"type":"INSERT","lineNumber":15,"content":"  final _formKey = GlobalKey<FormState>();"},{"type":"INSERT","lineNumber":16,"content":"  final _familyNameController = TextEditingController();"},{"type":"INSERT","lineNumber":17,"content":"  final _inviteCodeController = TextEditingController();"},{"type":"INSERT","lineNumber":19,"content":"  @override"},{"type":"INSERT","lineNumber":20,"content":"  void initState() {"},{"type":"INSERT","lineNumber":21,"content":"    super.initState();"},{"type":"INSERT","lineNumber":22,"content":"    _viewModel = context.read<FamilyViewModel>();"},{"type":"INSERT","lineNumber":23,"content":"    _viewModel.addListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":24,"content":"    // Check family status when the screen loads"},{"type":"INSERT","lineNumber":25,"content":"    _viewModel.checkFamilyStatus();"},{"type":"INSERT","lineNumber":26,"content":"  }"},{"type":"INSERT","lineNumber":27,"content":""},{"type":"INSERT","lineNumber":28,"content":"  @override"},{"type":"INSERT","lineNumber":29,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":30,"content":"    _familyNameController.dispose();"},{"type":"INSERT","lineNumber":31,"content":"    _inviteCodeController.dispose();"},{"type":"INSERT","lineNumber":32,"content":"    _viewModel.removeListener(_onViewModelChange);"},{"type":"INSERT","lineNumber":33,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":34,"content":"  }"},{"type":"INSERT","lineNumber":35,"content":""},{"type":"INSERT","lineNumber":36,"content":"  void _onViewModelChange() {"},{"type":"INSERT","lineNumber":37,"content":"    if (_viewModel.errorMessage != null && _viewModel.errorMessage!.isNotEmpty) {"},{"type":"INSERT","lineNumber":38,"content":"      _showErrorSnackBar(_viewModel.errorMessage!);"},{"type":"INSERT","lineNumber":39,"content":"      _viewModel.clearError();"},{"type":"INSERT","lineNumber":40,"content":"    }"},{"type":"INSERT","lineNumber":41,"content":"  }"},{"type":"INSERT","lineNumber":42,"content":""},{"type":"INSERT","lineNumber":44,"content":"    if (!mounted) return;"},{"type":"DELETE","lineNumber":31,"oldContent":"  @override"},{"type":"DELETE","lineNumber":32,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":33,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":34,"oldContent":"    // Reset any previous state when the screen is first loaded"},{"type":"DELETE","lineNumber":35,"oldContent":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"DELETE","lineNumber":36,"oldContent":"      context.read<FamilyBloc>().add(const ResetFamilyStateEvent());"},{"type":"INSERT","lineNumber":58,"content":"  void _toggleCreateFamily() {"},{"type":"INSERT","lineNumber":59,"content":"    setState(() {"},{"type":"INSERT","lineNumber":60,"content":"      _isCreatingFamily = !_isCreatingFamily;"},{"type":"INSERT","lineNumber":61,"content":"      _familyNameController.clear();"},{"type":"INSERT","lineNumber":62,"content":"      _inviteCodeController.clear();"},{"type":"INSERT","lineNumber":66,"content":"  Future<void> _createFamily() async {"},{"type":"INSERT","lineNumber":67,"content":"    if (!_formKey.currentState!.validate()) return;"},{"type":"INSERT","lineNumber":68,"content":"    "},{"type":"INSERT","lineNumber":69,"content":"    final success = await _viewModel.createNewFamily(_familyNameController.text);"},{"type":"INSERT","lineNumber":70,"content":"    if (success && mounted) {"},{"type":"INSERT","lineNumber":71,"content":"      Navigator.pushReplacementNamed(context, AppConstants.homeRoute);"},{"type":"INSERT","lineNumber":72,"content":"    }"},{"type":"INSERT","lineNumber":73,"content":"  }"},{"type":"INSERT","lineNumber":74,"content":""},{"type":"INSERT","lineNumber":75,"content":"  Future<void> _joinFamily() async {"},{"type":"INSERT","lineNumber":76,"content":"    if (!_formKey.currentState!.validate()) return;"},{"type":"INSERT","lineNumber":77,"content":"    "},{"type":"INSERT","lineNumber":78,"content":"    final isValid = await _viewModel.validateCode(_inviteCodeController.text);"},{"type":"INSERT","lineNumber":79,"content":"    if (isValid && _viewModel.inviteCode != null) {"},{"type":"INSERT","lineNumber":80,"content":"      final success = await _viewModel.joinExistingFamily(_viewModel.inviteCode!);"},{"type":"INSERT","lineNumber":81,"content":"      if (success && mounted) {"},{"type":"INSERT","lineNumber":82,"content":"        Navigator.pushReplacementNamed(context, AppConstants.homeRoute);"},{"type":"INSERT","lineNumber":83,"content":"      }"},{"type":"INSERT","lineNumber":84,"content":"    }"},{"type":"INSERT","lineNumber":85,"content":"  }"},{"type":"INSERT","lineNumber":86,"content":""},{"type":"DELETE","lineNumber":42,"oldContent":"    return BlocListener<FamilyBloc, FamilyState>("},{"type":"DELETE","lineNumber":43,"oldContent":"      listener: (context, state) {"},{"type":"DELETE","lineNumber":44,"oldContent":"        if (state is FamilyError) {"},{"type":"DELETE","lineNumber":45,"oldContent":"          _showErrorSnackBar(state.message);"},{"type":"DELETE","lineNumber":46,"oldContent":"          setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":47,"oldContent":"        } else if (state is FamilyLoading) {"},{"type":"DELETE","lineNumber":48,"oldContent":"          setState(() => _isLoading = true);"},{"type":"DELETE","lineNumber":49,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":50,"oldContent":"          setState(() => _isLoading = false);"},{"type":"DELETE","lineNumber":51,"oldContent":"        }"},{"type":"DELETE","lineNumber":52,"oldContent":"      },"},{"type":"DELETE","lineNumber":53,"oldContent":"      child: Scaffold("},{"type":"DELETE","lineNumber":54,"oldContent":"        appBar: AppBar("},{"type":"DELETE","lineNumber":55,"oldContent":"          title: const Text('Family Setup'),"},{"type":"DELETE","lineNumber":56,"oldContent":"          centerTitle: true,"},{"type":"DELETE","lineNumber":57,"oldContent":"          automaticallyImplyLeading: !_isLoading,"},{"type":"DELETE","lineNumber":58,"oldContent":"        ),"},{"type":"DELETE","lineNumber":59,"oldContent":"        body: LayoutBuilder("},{"type":"DELETE","lineNumber":60,"oldContent":"          builder: (context, constraints) {"},{"type":"DELETE","lineNumber":61,"oldContent":"            // Calculate padding based on screen width"},{"type":"DELETE","lineNumber":62,"oldContent":"            final horizontalPadding = constraints.maxWidth > 600 "},{"type":"DELETE","lineNumber":63,"oldContent":"                ? constraints.maxWidth * 0.15 "},{"type":"DELETE","lineNumber":64,"oldContent":"                : 24.0;"},{"type":"INSERT","lineNumber":89,"content":"    return Consumer<FamilyViewModel>("},{"type":"INSERT","lineNumber":90,"content":"      builder: (context, viewModel, _) {"},{"type":"INSERT","lineNumber":91,"content":"        return Scaffold("},{"type":"INSERT","lineNumber":92,"content":"          appBar: AppBar("},{"type":"INSERT","lineNumber":93,"content":"            title: const Text('Family Setup'),"},{"type":"INSERT","lineNumber":94,"content":"            centerTitle: true,"},{"type":"INSERT","lineNumber":95,"content":"            automaticallyImplyLeading: !viewModel.isLoading,"},{"type":"INSERT","lineNumber":96,"content":"          ),"},{"type":"INSERT","lineNumber":97,"content":"          body: LayoutBuilder("},{"type":"INSERT","lineNumber":98,"content":"            builder: (context, constraints) {"},{"type":"INSERT","lineNumber":99,"content":"              // Calculate padding based on screen width"},{"type":"INSERT","lineNumber":100,"content":"              final horizontalPadding = constraints.maxWidth > 600 "},{"type":"INSERT","lineNumber":101,"content":"                  ? constraints.maxWidth * 0.15 "},{"type":"INSERT","lineNumber":102,"content":"                  : 24.0;"},{"type":"INSERT","lineNumber":104,"content":"              return Stack("},{"type":"INSERT","lineNumber":105,"content":"                children: ["},{"type":"INSERT","lineNumber":106,"content":"                  SingleChildScrollView("},{"type":"INSERT","lineNumber":107,"content":"                    child: Padding("},{"type":"INSERT","lineNumber":108,"content":"                      padding: EdgeInsets.symmetric("},{"type":"INSERT","lineNumber":109,"content":"                        horizontal: horizontalPadding,"},{"type":"INSERT","lineNumber":110,"content":"                        vertical: 24.0,"},{"type":"INSERT","lineNumber":111,"content":"                      ),"},{"type":"INSERT","lineNumber":112,"content":"                      child: Column("},{"type":"INSERT","lineNumber":113,"content":"                        mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":114,"content":"                        children: ["},{"type":"INSERT","lineNumber":115,"content":"                          const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":116,"content":"                          // Welcome text"},{"type":"INSERT","lineNumber":117,"content":"                          const Text("},{"type":"INSERT","lineNumber":118,"content":"                            'Welcome to Family Connect!',"},{"type":"INSERT","lineNumber":119,"content":"                            style: TextStyle("},{"type":"INSERT","lineNumber":120,"content":"                              fontSize: 24,"},{"type":"INSERT","lineNumber":121,"content":"                              fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":122,"content":"                            ),"},{"type":"INSERT","lineNumber":123,"content":"                            textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":124,"content":"                          ),"},{"type":"INSERT","lineNumber":125,"content":"                          "},{"type":"INSERT","lineNumber":126,"content":"                          const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":127,"content":"                          "},{"type":"INSERT","lineNumber":128,"content":"                          const Text("},{"type":"INSERT","lineNumber":129,"content":"                            'Get started by joining an existing family or creating a new one',"},{"type":"INSERT","lineNumber":130,"content":"                            style: TextStyle("},{"type":"INSERT","lineNumber":131,"content":"                              fontSize: 16,"},{"type":"INSERT","lineNumber":132,"content":"                              color: Colors.grey,"},{"type":"INSERT","lineNumber":133,"content":"                            ),"},{"type":"INSERT","lineNumber":134,"content":"                            textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":135,"content":"                          ),"},{"type":"INSERT","lineNumber":136,"content":"                          "},{"type":"INSERT","lineNumber":137,"content":"                          const SizedBox(height: 48),"},{"type":"INSERT","lineNumber":138,"content":"                "},{"type":"INSERT","lineNumber":139,"content":"                          // Join Family Card"},{"type":"INSERT","lineNumber":140,"content":"                          Card("},{"type":"INSERT","lineNumber":141,"content":"                            elevation: 4,"},{"type":"INSERT","lineNumber":142,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":143,"content":"                              borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":144,"content":"                            ),"},{"type":"INSERT","lineNumber":145,"content":"                            child: InkWell("},{"type":"INSERT","lineNumber":146,"content":"                              borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":147,"content":"                              onTap: viewModel.isLoading"},{"type":"INSERT","lineNumber":148,"content":"                                  ? null"},{"type":"INSERT","lineNumber":149,"content":"                                  : () {"},{"type":"INSERT","lineNumber":150,"content":"                                      Navigator.pushNamed(context, AppConstants.joinFamilyRoute);"},{"type":"INSERT","lineNumber":151,"content":"                                    },"},{"type":"INSERT","lineNumber":152,"content":"                              child: Opacity("},{"type":"INSERT","lineNumber":153,"content":"                                opacity: viewModel.isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":154,"content":"                                child: Padding("},{"type":"INSERT","lineNumber":155,"content":"                                  padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":156,"content":"                                  child: Column("},{"type":"INSERT","lineNumber":157,"content":"                                    children: ["},{"type":"INSERT","lineNumber":158,"content":"                                      const Icon("},{"type":"INSERT","lineNumber":159,"content":"                                        Icons.group_add,"},{"type":"INSERT","lineNumber":160,"content":"                                        size: 48,"},{"type":"INSERT","lineNumber":161,"content":"                                        color: Colors.blue,"},{"type":"INSERT","lineNumber":162,"content":"                                      ),"},{"type":"INSERT","lineNumber":163,"content":"                                      const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":164,"content":"                                      const Text("},{"type":"INSERT","lineNumber":165,"content":"                                        'Join a Family',"},{"type":"INSERT","lineNumber":166,"content":"                                        style: TextStyle("},{"type":"INSERT","lineNumber":167,"content":"                                          fontSize: 20,"},{"type":"INSERT","lineNumber":168,"content":"                                          fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":169,"content":"                                        ),"},{"type":"INSERT","lineNumber":170,"content":"                                      ),"},{"type":"INSERT","lineNumber":171,"content":"                                      const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":172,"content":"                                      Text("},{"type":"INSERT","lineNumber":173,"content":"                                        'Join an existing family group using an invite code',"},{"type":"INSERT","lineNumber":174,"content":"                                        textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":175,"content":"                                        style: TextStyle("},{"type":"INSERT","lineNumber":176,"content":"                                          color: Colors.grey[600],"},{"type":"INSERT","lineNumber":177,"content":"                                          fontSize: 14,"},{"type":"INSERT","lineNumber":178,"content":"                                        ),"},{"type":"INSERT","lineNumber":179,"content":"                                      ),"},{"type":"INSERT","lineNumber":180,"content":"                                      if (viewModel.isLoading) ...["},{"type":"INSERT","lineNumber":181,"content":"                                        const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":182,"content":"                                        const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":183,"content":"                                      ],"},{"type":"INSERT","lineNumber":184,"content":"                                    ],"},{"type":"INSERT","lineNumber":185,"content":"                                  ),"},{"type":"INSERT","lineNumber":186,"content":"                                ),"},{"type":"INSERT","lineNumber":187,"content":"                              ),"},{"type":"INSERT","lineNumber":188,"content":"                            ),"},{"type":"INSERT","lineNumber":189,"content":"                          ),"},{"type":"INSERT","lineNumber":190,"content":""},{"type":"INSERT","lineNumber":191,"content":"                          const SizedBox(height: 24),"},{"type":"INSERT","lineNumber":192,"content":""},{"type":"INSERT","lineNumber":193,"content":"                          // Create Family Card"},{"type":"INSERT","lineNumber":194,"content":"                          Card("},{"type":"INSERT","lineNumber":195,"content":"                            elevation: 4,"},{"type":"INSERT","lineNumber":196,"content":"                            shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":197,"content":"                              borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":198,"content":"                            ),"},{"type":"INSERT","lineNumber":199,"content":"                            child: InkWell("},{"type":"INSERT","lineNumber":200,"content":"                              borderRadius: BorderRadius.circular(16.0),"},{"type":"INSERT","lineNumber":201,"content":"                              onTap: viewModel.isLoading"},{"type":"INSERT","lineNumber":202,"content":"                                  ? null"},{"type":"INSERT","lineNumber":203,"content":"                                  : () {"},{"type":"INSERT","lineNumber":204,"content":"                                      Navigator.pushNamed(context, AppConstants.createFamilyRoute);"},{"type":"INSERT","lineNumber":205,"content":"                                    },"},{"type":"INSERT","lineNumber":206,"content":"                              child: Opacity("},{"type":"INSERT","lineNumber":207,"content":"                                opacity: viewModel.isLoading ? 0.6 : 1.0,"},{"type":"INSERT","lineNumber":208,"content":"                                child: Padding("},{"type":"INSERT","lineNumber":209,"content":"                                  padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":210,"content":"                                  child: Column("},{"type":"INSERT","lineNumber":211,"content":"                                    children: ["},{"type":"INSERT","lineNumber":212,"content":"                                      Icon("},{"type":"INSERT","lineNumber":213,"content":"                                        Icons.add_circle_outline,"},{"type":"INSERT","lineNumber":214,"content":"                                        size: 48,"},{"type":"INSERT","lineNumber":215,"content":"                                        color: Theme.of(context).primaryColor,"},{"type":"INSERT","lineNumber":216,"content":"                                      ),"},{"type":"INSERT","lineNumber":217,"content":"                                      const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":218,"content":"                                      const Text("},{"type":"INSERT","lineNumber":219,"content":"                                        'Create a Family',"},{"type":"INSERT","lineNumber":220,"content":"                                        style: TextStyle("},{"type":"INSERT","lineNumber":221,"content":"                                          fontSize: 20,"},{"type":"INSERT","lineNumber":222,"content":"                                          fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":223,"content":"                                        ),"},{"type":"INSERT","lineNumber":224,"content":"                                      ),"},{"type":"INSERT","lineNumber":225,"content":"                                      const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":226,"content":"                                      Text("},{"type":"INSERT","lineNumber":227,"content":"                                        'Start a new family group and invite members',"},{"type":"INSERT","lineNumber":228,"content":"                                        textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":229,"content":"                                        style: TextStyle("},{"type":"INSERT","lineNumber":230,"content":"                                          color: Colors.grey[600],"},{"type":"INSERT","lineNumber":231,"content":"                                          fontSize: 14,"},{"type":"INSERT","lineNumber":232,"content":"                                        ),"},{"type":"INSERT","lineNumber":233,"content":"                                      ),"},{"type":"INSERT","lineNumber":234,"content":"                                      if (viewModel.isLoading) ...["},{"type":"INSERT","lineNumber":235,"content":"                                        const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":236,"content":"                                        const CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":237,"content":"                                      ],"},{"type":"INSERT","lineNumber":238,"content":"                                    ],"},{"type":"INSERT","lineNumber":239,"content":"                                  ),"},{"type":"INSERT","lineNumber":240,"content":"                                ),"},{"type":"INSERT","lineNumber":241,"content":"                              ),"},{"type":"INSERT","lineNumber":242,"content":"                            ),"},{"type":"INSERT","lineNumber":243,"content":"                          ),"},{"type":"INSERT","lineNumber":244,"content":"                        ],"},{"type":"INSERT","lineNumber":245,"content":"                      ),"},{"type":"INSERT","lineNumber":246,"content":"                    ),"},{"type":"INSERT","lineNumber":247,"content":"                  ),"},{"type":"INSERT","lineNumber":248,"content":"                "},{"type":"INSERT","lineNumber":249,"content":"                  // Loading overlay"},{"type":"INSERT","lineNumber":250,"content":"                  if (viewModel.isLoading)"},{"type":"INSERT","lineNumber":251,"content":"                    Container("},{"type":"INSERT","lineNumber":252,"content":"                      color: Colors.black.withOpacity(0.5),"},{"type":"INSERT","lineNumber":253,"content":"                      child: const Center("},{"type":"INSERT","lineNumber":254,"content":"                        child: CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":255,"content":"                      ),"},{"type":"INSERT","lineNumber":256,"content":"                    ),"},{"type":"INSERT","lineNumber":257,"content":"                ],"},{"type":"INSERT","lineNumber":258,"content":"              );"},{"type":"INSERT","lineNumber":259,"content":"            },"},{"type":"INSERT","lineNumber":260,"content":"          ),"},{"type":"INSERT","lineNumber":261,"content":"        );"},{"type":"INSERT","lineNumber":262,"content":"      },"},{"type":"DELETE","lineNumber":69,"oldContent":"                    padding: EdgeInsets.symmetric("},{"type":"INSERT","lineNumber":267,"content":"                    padding: EdgeInsets.symmetric("},{"type":"DELETE","lineNumber":72,"oldContent":"                      mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":74,"oldContent":"                      children: ["},{"type":"INSERT","lineNumber":272,"content":"                      mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":273,"content":"                      children: ["},{"type":"INSERT","lineNumber":343,"content":"                                  ],"},{"type":"DELETE","lineNumber":147,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":148,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":346,"content":"                            ),"},{"type":"INSERT","lineNumber":397,"content":"                                  ],"},{"type":"DELETE","lineNumber":201,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":202,"oldContent":"                            ),"},{"type":"INSERT","lineNumber":400,"content":"                            ),"},{"type":"DELETE","lineNumber":218,"oldContent":"        ),"},{"type":"INSERT","lineNumber":415,"content":"                  ),"},{"type":"DELETE","lineNumber":221,"oldContent":"        ),"},{"type":"INSERT","lineNumber":419,"content":"        ),"}]},{"timestamp":1754515756214,"changes":[{"type":"DELETE","lineNumber":11,"oldContent":"  late FamilyViewModel _viewModel;"},{"type":"MODIFY","lineNumber":13,"content":"  late FamilyViewModel _viewModel;","oldContent":"  bool _isCreatingFamily = false;"},{"type":"INSERT","lineNumber":14,"content":"  bool _isCreatingFamily = false;"},{"type":"DELETE","lineNumber":17,"oldContent":""},{"type":"DELETE","lineNumber":19,"oldContent":"  void _showErrorSnackBar(String message) {"},{"type":"DELETE","lineNumber":20,"oldContent":"    ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":18,"content":""},{"type":"DELETE","lineNumber":22,"oldContent":"      SnackBar("},{"type":"DELETE","lineNumber":24,"oldContent":"        content: Text(message),"},{"type":"DELETE","lineNumber":26,"oldContent":"        backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":28,"oldContent":"        behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":30,"oldContent":"        margin: const EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":32,"oldContent":"        shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":34,"oldContent":"          borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":36,"oldContent":"        ),"},{"type":"DELETE","lineNumber":38,"oldContent":"      ),"},{"type":"DELETE","lineNumber":40,"oldContent":"    );"},{"type":"DELETE","lineNumber":42,"oldContent":"  }"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"DELETE","lineNumber":52,"oldContent":"    });"},{"type":"DELETE","lineNumber":54,"oldContent":"  }"},{"type":"DELETE","lineNumber":56,"oldContent":""},{"type":"DELETE","lineNumber":58,"oldContent":"  @override"},{"type":"DELETE","lineNumber":60,"oldContent":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":43,"content":"  void _showErrorSnackBar(String message) {"},{"type":"INSERT","lineNumber":45,"content":"    ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":46,"content":"      SnackBar("},{"type":"INSERT","lineNumber":47,"content":"        content: Text(message),"},{"type":"INSERT","lineNumber":48,"content":"        backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":49,"content":"        behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":50,"content":"        margin: const EdgeInsets.all(16),"},{"type":"INSERT","lineNumber":51,"content":"        shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":52,"content":"          borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":53,"content":"        ),"},{"type":"INSERT","lineNumber":54,"content":"      ),"},{"type":"INSERT","lineNumber":55,"content":"    );"},{"type":"INSERT","lineNumber":56,"content":"  }"},{"type":"INSERT","lineNumber":57,"content":""},{"type":"DELETE","lineNumber":68,"oldContent":"                "},{"type":"INSERT","lineNumber":63,"content":"    });"},{"type":"INSERT","lineNumber":64,"content":"  }"},{"type":"INSERT","lineNumber":65,"content":""},{"type":"DELETE","lineNumber":70,"oldContent":"            return Stack("},{"type":"DELETE","lineNumber":72,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":74,"oldContent":"                SingleChildScrollView("},{"type":"DELETE","lineNumber":77,"oldContent":"                  child: Padding("},{"type":"DELETE","lineNumber":79,"oldContent":"                      horizontal: horizontalPadding,"},{"type":"DELETE","lineNumber":82,"oldContent":"                      vertical: 24.0,"},{"type":"DELETE","lineNumber":85,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":87,"oldContent":"                    child: Column("},{"type":"DELETE","lineNumber":89,"oldContent":"                        const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":91,"oldContent":"                        // Welcome text"},{"type":"DELETE","lineNumber":93,"oldContent":"                        const Text("},{"type":"DELETE","lineNumber":95,"oldContent":"                          'Welcome to Family Connect!',"},{"type":"DELETE","lineNumber":97,"oldContent":"                          style: TextStyle("},{"type":"DELETE","lineNumber":99,"oldContent":"                            fontSize: 24,"},{"type":"DELETE","lineNumber":101,"oldContent":"                            fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":103,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":105,"oldContent":"                          textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":107,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":108,"oldContent":"                        "},{"type":"DELETE","lineNumber":109,"oldContent":"                        const SizedBox(height: 8),"},{"type":"INSERT","lineNumber":87,"content":"  @override"},{"type":"INSERT","lineNumber":88,"content":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":111,"oldContent":"                        "},{"type":"DELETE","lineNumber":113,"oldContent":"                        const Text("},{"type":"DELETE","lineNumber":115,"oldContent":"                          'Get started by joining an existing family or creating a new one',"},{"type":"DELETE","lineNumber":117,"oldContent":"                          style: TextStyle("},{"type":"DELETE","lineNumber":119,"oldContent":"                            fontSize: 16,"},{"type":"DELETE","lineNumber":121,"oldContent":"                            color: Colors.grey,"},{"type":"DELETE","lineNumber":123,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":125,"oldContent":"                          textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":127,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":129,"oldContent":"                        "},{"type":"DELETE","lineNumber":131,"oldContent":"                        const SizedBox(height: 48),"},{"type":"DELETE","lineNumber":133,"oldContent":"                "},{"type":"DELETE","lineNumber":135,"oldContent":"                        // Join Family Card"},{"type":"DELETE","lineNumber":137,"oldContent":"                        Card("},{"type":"DELETE","lineNumber":138,"oldContent":"                          elevation: 4,"},{"type":"INSERT","lineNumber":103,"content":"                "},{"type":"DELETE","lineNumber":140,"oldContent":"                          shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":142,"oldContent":"                            borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":144,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":146,"oldContent":"                          child: InkWell("},{"type":"DELETE","lineNumber":148,"oldContent":"                            borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":150,"oldContent":"                            onTap: _isLoading"},{"type":"DELETE","lineNumber":152,"oldContent":"                                ? null"},{"type":"DELETE","lineNumber":154,"oldContent":"                                : () {"},{"type":"DELETE","lineNumber":156,"oldContent":"                                    Navigator.pushNamed(context, AppConstants.joinFamilyRoute);"},{"type":"DELETE","lineNumber":158,"oldContent":"                                  },"},{"type":"DELETE","lineNumber":160,"oldContent":"                            child: Opacity("},{"type":"DELETE","lineNumber":162,"oldContent":"                              opacity: _isLoading ? 0.6 : 1.0,"},{"type":"DELETE","lineNumber":164,"oldContent":"                              child: Padding("},{"type":"DELETE","lineNumber":166,"oldContent":"                                padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":168,"oldContent":"                                child: Column("},{"type":"DELETE","lineNumber":170,"oldContent":"                                  children: ["},{"type":"DELETE","lineNumber":172,"oldContent":"                                    const Icon("},{"type":"DELETE","lineNumber":174,"oldContent":"                                      Icons.group_add,"},{"type":"DELETE","lineNumber":176,"oldContent":"                                      size: 48,"},{"type":"DELETE","lineNumber":178,"oldContent":"                                      color: Colors.blue,"},{"type":"DELETE","lineNumber":180,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":182,"oldContent":"                                    const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":184,"oldContent":"                                    const Text("},{"type":"DELETE","lineNumber":186,"oldContent":"                                      'Join a Family',"},{"type":"DELETE","lineNumber":188,"oldContent":"                                      style: TextStyle("},{"type":"DELETE","lineNumber":190,"oldContent":"                                        fontSize: 20,"},{"type":"DELETE","lineNumber":192,"oldContent":"                                        fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":194,"oldContent":"                                      ),"},{"type":"DELETE","lineNumber":196,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":198,"oldContent":"                                    const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":200,"oldContent":"                                    Text("},{"type":"DELETE","lineNumber":202,"oldContent":"                                      'Join an existing family group using an invite code',"},{"type":"DELETE","lineNumber":204,"oldContent":"                                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":206,"oldContent":"                                      style: TextStyle("},{"type":"DELETE","lineNumber":208,"oldContent":"                                        color: Colors.grey[600],"},{"type":"DELETE","lineNumber":210,"oldContent":"                                        fontSize: 14,"},{"type":"DELETE","lineNumber":212,"oldContent":"                                      ),"},{"type":"DELETE","lineNumber":214,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":216,"oldContent":"                                    if (_isLoading) ...["},{"type":"DELETE","lineNumber":218,"oldContent":"                                      const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":220,"oldContent":"                                      const CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":222,"oldContent":"                                    ],"},{"type":"DELETE","lineNumber":224,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":228,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":230,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":232,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":234,"oldContent":""},{"type":"DELETE","lineNumber":236,"oldContent":"                        const SizedBox(height: 24),"},{"type":"DELETE","lineNumber":238,"oldContent":""},{"type":"DELETE","lineNumber":240,"oldContent":"                        // Create Family Card"},{"type":"DELETE","lineNumber":242,"oldContent":"                        Card("},{"type":"DELETE","lineNumber":244,"oldContent":"                          elevation: 4,"},{"type":"DELETE","lineNumber":246,"oldContent":"                          shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":248,"oldContent":"                            borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":250,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":252,"oldContent":"                          child: InkWell("},{"type":"DELETE","lineNumber":254,"oldContent":"                            borderRadius: BorderRadius.circular(16.0),"},{"type":"DELETE","lineNumber":256,"oldContent":"                            onTap: _isLoading"},{"type":"DELETE","lineNumber":258,"oldContent":"                                ? null"},{"type":"DELETE","lineNumber":260,"oldContent":"                                : () {"},{"type":"DELETE","lineNumber":262,"oldContent":"                                    Navigator.pushNamed(context, AppConstants.createFamilyRoute);"},{"type":"DELETE","lineNumber":264,"oldContent":"                                  },"},{"type":"DELETE","lineNumber":266,"oldContent":"                            child: Opacity("},{"type":"DELETE","lineNumber":268,"oldContent":"                              opacity: _isLoading ? 0.6 : 1.0,"},{"type":"DELETE","lineNumber":270,"oldContent":"                              child: Padding("},{"type":"DELETE","lineNumber":272,"oldContent":"                                padding: const EdgeInsets.all(24.0),"},{"type":"DELETE","lineNumber":274,"oldContent":"                                child: Column("},{"type":"DELETE","lineNumber":276,"oldContent":"                                  children: ["},{"type":"DELETE","lineNumber":278,"oldContent":"                                    Icon("},{"type":"DELETE","lineNumber":280,"oldContent":"                                      Icons.add_circle_outline,"},{"type":"DELETE","lineNumber":282,"oldContent":"                                      size: 48,"},{"type":"DELETE","lineNumber":284,"oldContent":"                                      color: Theme.of(context).primaryColor,"},{"type":"DELETE","lineNumber":286,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":288,"oldContent":"                                    const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":290,"oldContent":"                                    const Text("},{"type":"DELETE","lineNumber":292,"oldContent":"                                      'Create a Family',"},{"type":"DELETE","lineNumber":294,"oldContent":"                                      style: TextStyle("},{"type":"DELETE","lineNumber":296,"oldContent":"                                        fontSize: 20,"},{"type":"DELETE","lineNumber":298,"oldContent":"                                        fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":300,"oldContent":"                                      ),"},{"type":"DELETE","lineNumber":302,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":304,"oldContent":"                                    const SizedBox(height: 8),"},{"type":"DELETE","lineNumber":306,"oldContent":"                                    Text("},{"type":"DELETE","lineNumber":308,"oldContent":"                                      'Start a new family group and invite members',"},{"type":"DELETE","lineNumber":310,"oldContent":"                                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":312,"oldContent":"                                      style: TextStyle("},{"type":"DELETE","lineNumber":314,"oldContent":"                                        color: Colors.grey[600],"},{"type":"DELETE","lineNumber":316,"oldContent":"                                        fontSize: 14,"},{"type":"DELETE","lineNumber":318,"oldContent":"                                      ),"},{"type":"DELETE","lineNumber":320,"oldContent":"                                    ),"},{"type":"DELETE","lineNumber":322,"oldContent":"                                    if (_isLoading) ...["},{"type":"DELETE","lineNumber":324,"oldContent":"                                      const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":326,"oldContent":"                                      const CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":328,"oldContent":"                                    ],"},{"type":"DELETE","lineNumber":330,"oldContent":"                                ),"},{"type":"DELETE","lineNumber":334,"oldContent":"                              ),"},{"type":"DELETE","lineNumber":336,"oldContent":"                          ),"},{"type":"DELETE","lineNumber":338,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":340,"oldContent":"                      ],"},{"type":"DELETE","lineNumber":342,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":344,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":346,"oldContent":"                ),"},{"type":"DELETE","lineNumber":348,"oldContent":"                "},{"type":"DELETE","lineNumber":350,"oldContent":"                // Loading overlay"},{"type":"DELETE","lineNumber":352,"oldContent":"                if (_isLoading)"},{"type":"DELETE","lineNumber":354,"oldContent":"                  Container("},{"type":"DELETE","lineNumber":356,"oldContent":"                    color: Colors.black.withOpacity(0.5),"},{"type":"DELETE","lineNumber":358,"oldContent":"                    child: const Center("},{"type":"DELETE","lineNumber":360,"oldContent":"                      child: CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":362,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":365,"oldContent":"              ],"},{"type":"DELETE","lineNumber":367,"oldContent":"            );"},{"type":"DELETE","lineNumber":370,"oldContent":"          },"},{"type":"DELETE","lineNumber":372,"oldContent":"      ),"},{"type":"DELETE","lineNumber":374,"oldContent":"    );"},{"type":"DELETE","lineNumber":376,"oldContent":"  }"},{"type":"DELETE","lineNumber":378,"oldContent":"}"},{"type":"DELETE","lineNumber":380,"oldContent":""},{"type":"DELETE","lineNumber":382,"oldContent":"        ),"},{"type":"DELETE","lineNumber":384,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":386,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":388,"oldContent":"                                  ],"},{"type":"DELETE","lineNumber":390,"oldContent":"                            ),"},{"type":"DELETE","lineNumber":392,"oldContent":"                                  ],"},{"type":"DELETE","lineNumber":394,"oldContent":"                      children: ["},{"type":"DELETE","lineNumber":396,"oldContent":"                      mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":398,"oldContent":"                    padding: EdgeInsets.symmetric("},{"type":"DELETE","lineNumber":400,"oldContent":"      },"},{"type":"DELETE","lineNumber":402,"oldContent":"        );"},{"type":"DELETE","lineNumber":404,"oldContent":"          ),"},{"type":"DELETE","lineNumber":406,"oldContent":"            },"},{"type":"DELETE","lineNumber":408,"oldContent":"              );"},{"type":"DELETE","lineNumber":410,"oldContent":"                ],"},{"type":"DELETE","lineNumber":412,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":415,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":416,"oldContent":"                        child: CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":418,"oldContent":"                      child: const Center("},{"type":"DELETE","lineNumber":420,"oldContent":"                      color: Colors.black.withOpacity(0.5),"},{"type":"DELETE","lineNumber":422,"oldContent":"                    Container("},{"type":"INSERT","lineNumber":251,"content":"                    Container("},{"type":"INSERT","lineNumber":252,"content":"                      color: Colors.black.withOpacity(0.5),"},{"type":"INSERT","lineNumber":253,"content":"                      child: const Center("},{"type":"INSERT","lineNumber":254,"content":"                        child: CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":255,"content":"                      ),"},{"type":"INSERT","lineNumber":256,"content":"                    ),"},{"type":"INSERT","lineNumber":257,"content":"                ],"},{"type":"INSERT","lineNumber":258,"content":"              );"},{"type":"INSERT","lineNumber":259,"content":"            },"},{"type":"INSERT","lineNumber":260,"content":"          ),"},{"type":"INSERT","lineNumber":261,"content":"        );"},{"type":"INSERT","lineNumber":262,"content":"      },"},{"type":"INSERT","lineNumber":263,"content":"    );"},{"type":"INSERT","lineNumber":264,"content":"  }"},{"type":"INSERT","lineNumber":265,"content":"}"},{"type":"INSERT","lineNumber":266,"content":""}]},{"timestamp":1754515997966,"changes":[{"type":"INSERT","lineNumber":12,"content":"class _JoinOrCreateFamilyScreenState extends State<JoinOrCreateFamilyScreen> {"},{"type":"DELETE","lineNumber":14,"oldContent":"class _JoinOrCreateFamilyScreenState extends State<JoinOrCreateFamilyScreen> {"},{"type":"MODIFY","lineNumber":18,"content":"","oldContent":""},{"type":"DELETE","lineNumber":30,"oldContent":"  void _showErrorSnackBar(String message) {"},{"type":"DELETE","lineNumber":32,"oldContent":"    ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":34,"oldContent":"      SnackBar("},{"type":"DELETE","lineNumber":36,"oldContent":"        content: Text(message),"},{"type":"DELETE","lineNumber":38,"oldContent":"        backgroundColor: Colors.red,"},{"type":"DELETE","lineNumber":40,"oldContent":"        behavior: SnackBarBehavior.floating,"},{"type":"DELETE","lineNumber":42,"oldContent":"        margin: const EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":44,"oldContent":"        shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":46,"oldContent":"          borderRadius: BorderRadius.circular(8),"},{"type":"DELETE","lineNumber":47,"oldContent":"        ),"},{"type":"DELETE","lineNumber":49,"oldContent":"      ),"},{"type":"DELETE","lineNumber":50,"oldContent":"    );"},{"type":"DELETE","lineNumber":52,"oldContent":"  }"},{"type":"DELETE","lineNumber":53,"oldContent":""},{"type":"INSERT","lineNumber":43,"content":"  void _showErrorSnackBar(String message) {"},{"type":"DELETE","lineNumber":58,"oldContent":"    });"},{"type":"DELETE","lineNumber":59,"oldContent":"  void _toggleCreateFamily() {"},{"type":"INSERT","lineNumber":45,"content":"    ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":46,"content":"      SnackBar("},{"type":"INSERT","lineNumber":47,"content":"        content: Text(message),"},{"type":"INSERT","lineNumber":48,"content":"        backgroundColor: Colors.red,"},{"type":"INSERT","lineNumber":49,"content":"        behavior: SnackBarBehavior.floating,"},{"type":"INSERT","lineNumber":50,"content":"        margin: const EdgeInsets.all(16),"},{"type":"INSERT","lineNumber":51,"content":"        shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":52,"content":"          borderRadius: BorderRadius.circular(8),"},{"type":"INSERT","lineNumber":53,"content":"        ),"},{"type":"INSERT","lineNumber":54,"content":"      ),"},{"type":"INSERT","lineNumber":55,"content":"    );"},{"type":"DELETE","lineNumber":61,"oldContent":"    setState(() {"},{"type":"INSERT","lineNumber":58,"content":"  void _toggleCreateFamily() {"},{"type":"INSERT","lineNumber":59,"content":"    setState(() {"},{"type":"INSERT","lineNumber":63,"content":"    });"},{"type":"INSERT","lineNumber":64,"content":"  }"},{"type":"INSERT","lineNumber":65,"content":""},{"type":"DELETE","lineNumber":69,"oldContent":"    final success = await _viewModel.createNewFamily(_familyNameController.text);"},{"type":"DELETE","lineNumber":70,"oldContent":"    if (success && mounted) {"},{"type":"INSERT","lineNumber":69,"content":"    await _viewModel.createFamily(_familyNameController.text);"},{"type":"INSERT","lineNumber":70,"content":"    if (_viewModel.currentFamily != null && mounted) {"},{"type":"DELETE","lineNumber":77,"oldContent":"  @override"},{"type":"DELETE","lineNumber":78,"oldContent":"  Widget build(BuildContext context) {"},{"type":"MODIFY","lineNumber":87,"content":"  @override","oldContent":"                "},{"type":"INSERT","lineNumber":88,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":103,"content":"                "},{"type":"DELETE","lineNumber":161,"oldContent":"                    Container("},{"type":"DELETE","lineNumber":163,"oldContent":"                      color: Colors.black.withOpacity(0.5),"},{"type":"DELETE","lineNumber":164,"oldContent":"                      child: const Center("},{"type":"DELETE","lineNumber":166,"oldContent":"                        child: CircularProgressIndicator(),"},{"type":"DELETE","lineNumber":167,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":169,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":170,"oldContent":"                ],"},{"type":"DELETE","lineNumber":172,"oldContent":"              );"},{"type":"DELETE","lineNumber":173,"oldContent":"            },"},{"type":"DELETE","lineNumber":175,"oldContent":"          ),"},{"type":"DELETE","lineNumber":176,"oldContent":"        );"},{"type":"DELETE","lineNumber":178,"oldContent":"      },"},{"type":"DELETE","lineNumber":179,"oldContent":"    );"},{"type":"DELETE","lineNumber":181,"oldContent":"  }"},{"type":"DELETE","lineNumber":182,"oldContent":"}"},{"type":"DELETE","lineNumber":184,"oldContent":""},{"type":"INSERT","lineNumber":251,"content":"                    Container("},{"type":"INSERT","lineNumber":252,"content":"                      color: Colors.black.withOpacity(0.5),"},{"type":"INSERT","lineNumber":253,"content":"                      child: const Center("},{"type":"INSERT","lineNumber":254,"content":"                        child: CircularProgressIndicator(),"},{"type":"INSERT","lineNumber":255,"content":"                      ),"},{"type":"INSERT","lineNumber":256,"content":"                    ),"},{"type":"INSERT","lineNumber":257,"content":"                ],"},{"type":"INSERT","lineNumber":258,"content":"              );"},{"type":"INSERT","lineNumber":259,"content":"            },"},{"type":"INSERT","lineNumber":260,"content":"          ),"},{"type":"INSERT","lineNumber":261,"content":"        );"},{"type":"INSERT","lineNumber":262,"content":"      },"},{"type":"INSERT","lineNumber":263,"content":"    );"},{"type":"INSERT","lineNumber":264,"content":"  }"},{"type":"INSERT","lineNumber":265,"content":"}"},{"type":"INSERT","lineNumber":266,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/usecases/validate_invite_code.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/usecases/validate_invite_code.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:equatable/equatable.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/family/domain/repositories/family_repository.dart';\n\nclass ValidateInviteCode implements UseCase<bool, ValidateInviteCodeParams> {\n  final FamilyRepository repository;\n\n  const ValidateInviteCode(this.repository);\n\n  @override\n  Future<Either<Failure, bool>> call(ValidateInviteCodeParams params) async {\n    return await repository.validateInviteCode(params.inviteCode);\n  }\n}\n\nclass ValidateInviteCodeParams extends Equatable {\n  final String inviteCode;\n\n  const ValidateInviteCodeParams({required this.inviteCode});\n\n  @override\n  List<Object> get props => [inviteCode];\n  \n  @override\n  bool get stringify => true;\n}\n","baseTimestamp":1754455455677},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/bloc/family_bloc.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/bloc/family_bloc.dart","baseContent":"import 'dart:async';\n\nimport 'package:bloc/bloc.dart';\nimport 'package:equatable/equatable.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/family/domain/entities/family.dart';\nimport 'package:family_tree_firebase/features/family/domain/repositories/family_repository.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/create_family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/generate_invite_code.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/get_current_family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/join_family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/validate_invite_code.dart';\n\nimport 'family_event.dart';\nimport 'family_state.dart';\n\nclass FamilyBloc extends Bloc<FamilyEvent, FamilyState> {\n  final CreateFamily _createFamily;\n  final JoinFamily _joinFamily;\n  final GetCurrentFamily _getCurrentFamily;\n  final GenerateInviteCode _generateInviteCode;\n  final ValidateInviteCode _validateInviteCode;\n  \n  FamilyBloc({\n    required CreateFamily createFamily,\n    required JoinFamily joinFamily,\n    required GetCurrentFamily getCurrentFamily,\n    required GenerateInviteCode generateInviteCode,\n    required ValidateInviteCode validateInviteCode,\n  })  : _createFamily = createFamily,\n        _joinFamily = joinFamily,\n        _getCurrentFamily = getCurrentFamily,\n        _generateInviteCode = generateInviteCode,\n        _validateInviteCode = validateInviteCode,\n        super(const FamilyInitial()) {\n    on<CreateFamilyEvent>(_onCreateFamily);\n    on<JoinFamilyEvent>(_onJoinFamily);\n    on<LoadFamilyEvent>(_onLoadFamily);\n    on<GenerateInviteCodeEvent>(_onGenerateInviteCode);\n    on<ValidateInviteCodeEvent>(_onValidateInviteCode);\n    on<ResetFamilyStateEvent>(_onResetState);\n  }\n\n  Future<void> _onCreateFamily(\n    CreateFamilyEvent event,\n    Emitter<FamilyState> emit,\n  ) async {\n    emit(const FamilyLoading());\n    \n    final result = await _createFamily(CreateFamilyParams(\n      familyName: event.familyName,\n    ));\n    \n    result.fold(\n      (failure) => emit(FamilyError(message: _mapFailureToMessage(failure))),\n      (family) => emit(FamilyLoadSuccess(\n        family: family,\n        isNewlyCreated: true,\n      )),\n    );\n  }\n\n  Future<void> _onJoinFamily(\n    JoinFamilyEvent event,\n    Emitter<FamilyState> emit,\n  ) async {\n    emit(const FamilyLoading());\n    \n    final result = await _joinFamily(JoinFamilyParams(\n      inviteCode: event.inviteCode,\n    ));\n    \n    result.fold(\n      (failure) => emit(FamilyError(message: _mapFailureToMessage(failure))),\n      (family) => emit(FamilyLoadSuccess(family: family)),\n    );\n  }\n\n  Future<void> _onLoadFamily(\n    LoadFamilyEvent event,\n    Emitter<FamilyState> emit,\n  ) async {\n    emit(const FamilyLoading());\n    \n    final result = await _getCurrentFamily(NoParams());\n    \n    result.fold(\n      (failure) {\n        if (failure is NotFoundFailure) {\n          emit(const FamilyLoadEmpty());\n        } else {\n          emit(FamilyError(message: _mapFailureToMessage(failure)));\n        }\n      },\n      (family) => emit(FamilyLoadSuccess(family: family)),\n    );\n  }\n\n  Future<void> _onGenerateInviteCode(\n    GenerateInviteCodeEvent event,\n    Emitter<FamilyState> emit,\n  ) async {\n    final result = await _generateInviteCode(NoParams());\n    \n    result.fold(\n      (failure) => emit(FamilyError(message: _mapFailureToMessage(failure))),\n      (inviteCode) => emit(InviteCodeGenerated(\n        inviteCode: inviteCode,\n        expiresAt: DateTime.now().add(const Duration(days: 7)),\n      )),\n    );\n  }\n\n  Future<void> _onValidateInviteCode(\n    ValidateInviteCodeEvent event,\n    Emitter<FamilyState> emit,\n  ) async {\n    emit(InviteCodeValidating(event.inviteCode));\n    \n    final result = await _validateInviteCode(ValidateInviteCodeParams(\n      inviteCode: event.inviteCode,\n    ));\n    \n    result.fold(\n      (failure) => emit(FamilyError(message: _mapFailureToMessage(failure))),\n      (isValid) {\n        if (isValid) {\n          emit(InviteCodeValid(\n            inviteCode: event.inviteCode,\n            familyName: 'Family', // We don't have the family name here, it will be loaded when joining\n          ));\n        } else {\n          emit(FamilyError(message: 'Invalid or expired invite code'));\n        }\n      },\n    );\n  }\n\n  void _onResetState(\n    ResetFamilyStateEvent event,\n    Emitter<FamilyState> emit,\n  ) {\n    emit(const FamilyInitial());\n  }\n  \n  String _mapFailureToMessage(Failure failure) {\n    switch (failure.runtimeType) {\n      case ServerFailure:\n        return 'Server error occurred. Please try again later.';\n      case NetworkFailure:\n        return 'Network error. Please check your internet connection.';\n      case InvalidInviteCodeFailure:\n        return 'Invalid or expired invite code. Please check and try again.';\n      case AlreadyInFamilyFailure:\n        return 'You are already a member of a family.';\n      case PermissionDeniedFailure:\n        return 'You do not have permission to perform this action.';\n      case FamilyNotFoundFailure:\n        return 'Family not found. The family may have been deleted.';\n      default:\n        return 'An unexpected error occurred. Please try again.';\n    }\n  }\n}\n","baseTimestamp":1754455490997,"deltas":[{"timestamp":1754455593176,"changes":[{"type":"MODIFY","lineNumber":95,"content":"      (family) {","oldContent":"      (family) => emit(FamilyLoadSuccess(family: family)),"},{"type":"INSERT","lineNumber":96,"content":"        if (family != null) {"},{"type":"INSERT","lineNumber":97,"content":"          emit(FamilyLoadSuccess(family: family));"},{"type":"INSERT","lineNumber":98,"content":"        } else {"},{"type":"INSERT","lineNumber":99,"content":"          emit(const FamilyLoadEmpty());"},{"type":"INSERT","lineNumber":100,"content":"        }"},{"type":"INSERT","lineNumber":101,"content":"      },"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/usecases/create_family.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/usecases/create_family.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:equatable/equatable.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/family/domain/entities/family.dart';\nimport 'package:family_tree_firebase/features/family/domain/repositories/family_repository.dart';\n\nclass CreateFamily implements UseCase<Family, CreateFamilyParams> {\n  final FamilyRepository repository;\n\n  const CreateFamily(this.repository);\n\n  @override\n  Future<Either<Failure, Family>> call(CreateFamilyParams params) async {\n    // First, create the family and get the family ID\n    final result = await repository.createFamily(params.familyName);\n    \n    // Then, load the created family to get the full Family object\n    return result.fold(\n      (failure) => Left(failure),\n      (familyId) async {\n        final familyResult = await repository.getCurrentFamily();\n        return familyResult.fold(\n          (failure) => Left(failure),\n          (family) => family != null \n              ? Right(family) \n              : const Left(CacheFailure('Failed to load created family')),\n        );\n      },\n    );\n  }\n}\n\nclass CreateFamilyParams extends Equatable {\n  final String familyName;\n\n  const CreateFamilyParams({required this.familyName});\n\n  @override\n  List<Object> get props => [familyName];\n  \n  @override\n  bool get stringify => true;\n}\n","baseTimestamp":1754455526582},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/usecases/join_family.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/usecases/join_family.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:equatable/equatable.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/family/domain/entities/family.dart';\nimport 'package:family_tree_firebase/features/family/domain/repositories/family_repository.dart';\n\nclass JoinFamily implements UseCase<Family, JoinFamilyParams> {\n  final FamilyRepository repository;\n\n  JoinFamily(this.repository);\n\n  @override\n  Future<Either<Failure, Family>> call(JoinFamilyParams params) async {\n    return await repository.joinFamily(params.inviteCode);\n  }\n}\n\nclass JoinFamilyParams extends Equatable {\n  final String inviteCode;\n\n  const JoinFamilyParams({required this.inviteCode});\n\n  @override\n  List<Object> get props => [inviteCode];\n}\n","baseTimestamp":1754455741518},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/usecases/usecase.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/usecases/usecase.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:equatable/equatable.dart';\nimport '../error/failures.dart';\n\nabstract class UseCase<Type, Params> {\n  Future<Either<Failure, Type>> call(Params params);\n}\n\nclass NoParams extends Equatable {\n  @override\n  List<Object> get props => [];\n}\n","baseTimestamp":1754455777146},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/bloc/auth_event.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/bloc/auth_event.dart","baseContent":"import 'package:equatable/equatable.dart';\n\nabstract class AuthEvent extends Equatable {\n  const AuthEvent();\n\n  @override\n  List<Object?> get props => [];\n}\n\n// Check if user is signed in\nclass CheckAuthStatus extends AuthEvent {\n  const CheckAuthStatus();\n}\n\n// Sign in with email and password\nclass SignInWithEmailAndPassword extends AuthEvent {\n  final String email;\n  final String password;\n\n  const SignInWithEmailAndPassword({\n    required this.email,\n    required this.password,\n  });\n\n  @override\n  List<Object> get props => [email, password];\n}\n\n// Register with email and password\nclass RegisterWithEmailAndPassword extends AuthEvent {\n  final String email;\n  final String password;\n  final String displayName;\n  final String? phoneNumber;\n\n  const RegisterWithEmailAndPassword({\n    required this.email,\n    required this.password,\n    required this.displayName,\n    this.phoneNumber,\n  });\n\n  @override\n  List<Object?> get props => [email, password, displayName, phoneNumber];\n}\n\n// Sign in with Google\nclass SignInWithGoogle extends AuthEvent {\n  const SignInWithGoogle();\n}\n\n// Sign in with Apple\nclass SignInWithApple extends AuthEvent {\n  const SignInWithApple();\n}\n\n// Send OTP to phone number\nclass SendOtpToPhoneNumber extends AuthEvent {\n  final String phoneNumber;\n\n  const SendOtpToPhoneNumber(this.phoneNumber);\n\n  @override\n  List<Object> get props => [phoneNumber];\n}\n\n// Verify OTP\nclass VerifyOtp extends AuthEvent {\n  final String verificationId;\n  final String smsCode;\n\n  const VerifyOtp(this.verificationId, this.smsCode);\n\n  @override\n  List<Object> get props => [verificationId, smsCode];\n}\n\n// Sign out\nclass SignOut extends AuthEvent {\n  const SignOut();\n}\n\n// Send password reset email\nclass SendPasswordResetEmail extends AuthEvent {\n  final String email;\n\n  const SendPasswordResetEmail(this.email);\n\n  @override\n  List<Object> get props => [email];\n}\n\n// Delete account\nclass DeleteAccount extends AuthEvent {\n  const DeleteAccount();\n}\n","baseTimestamp":1754458347877},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/presentation/screens/home_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/presentation/screens/home_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:family_tree_firebase/core/constants/app_constants.dart';\nimport 'package:family_tree_firebase/features/home/domain/models/post_model.dart';\nimport 'package:family_tree_firebase/features/home/domain/models/story_model.dart';\nimport 'package:family_tree_firebase/features/home/presentation/widgets/post_widget.dart';\nimport 'package:family_tree_firebase/features/home/presentation/widgets/story_circle_widget.dart';\nimport 'package:family_tree_firebase/features/home/presentation/widgets/story_view_screen.dart';\n\nclass HomeScreen extends StatefulWidget {\n  const HomeScreen({super.key});\n\n  @override\n  State<HomeScreen> createState() => _HomeScreenState();\n}\n\nclass _HomeScreenState extends State<HomeScreen> {\n  // Temporary mock data - in a real app, this would come from a repository\n  final List<StoryModel> _stories = [\n    StoryModel(\n      id: '1',\n      userId: 'user1',\n      userName: 'John Doe',\n      userImageUrl: 'https://randomuser.me/api/portraits/men/1.jpg',\n      imageUrl: 'https://picsum.photos/400/800',\n      timestamp: DateTime.now().subtract(const Duration(hours: 2)),\n      isSeen: false,\n    ),\n    StoryModel(\n      id: '2',\n      userId: 'user2',\n      userName: 'Jane Smith',\n      userImageUrl: 'https://randomuser.me/api/portraits/women/1.jpg',\n      imageUrl: 'https://picsum.photos/400/801',\n      timestamp: DateTime.now().subtract(const Duration(hours: 1)),\n      isSeen: false,\n    ),\n    StoryModel(\n      id: '3',\n      userId: 'user3',\n      userName: 'Mike Johnson',\n      userImageUrl: 'https://randomuser.me/api/portraits/men/2.jpg',\n      imageUrl: 'https://picsum.photos/400/802',\n      timestamp: DateTime.now().subtract(const Duration(minutes: 30)),\n      isSeen: false,\n      isLive: true,\n    ),\n  ];\n\n  final List<PostModel> _posts = [\n    PostModel(\n      id: '1',\n      userId: 'user1',\n      userName: 'John Doe',\n      userImageUrl: 'https://randomuser.me/api/portraits/men/1.jpg',\n      imageUrl: 'https://picsum.photos/800/1000',\n      caption: 'Enjoying a beautiful day with family! 😊 #FamilyTime #Happy',\n      timestamp: DateTime.now().subtract(const Duration(hours: 3)),\n      likes: 42,\n      comments: [\n        CommentModel(\n          id: '1',\n          userId: 'user2',\n          userName: 'Jane Smith',\n          userImageUrl: 'https://randomuser.me/api/portraits/women/1.jpg',\n          text: 'Looks amazing! 😍',\n          timestamp: DateTime.now().subtract(const Duration(hours: 2)),\n        ),\n      ],\n    ),\n    PostModel(\n      id: '2',\n      userId: 'user3',\n      userName: 'Mike Johnson',\n      userImageUrl: 'https://randomuser.me/api/portraits/men/2.jpg',\n      imageUrl: 'https://picsum.photos/800/1001',\n      caption: 'Family reunion after so long! ❤️ #FamilyFirst',\n      timestamp: DateTime.now().subtract(const Duration(hours: 1)),\n      likes: 28,\n      comments: [],\n    ),\n  ];\n\n  void _viewStory(StoryModel story, int initialIndex) {\n    Navigator.push(\n      context,\n      MaterialPageRoute(\n        builder: (context) => StoryViewScreen(\n          stories: _stories,\n          initialIndex: initialIndex,\n        ),\n      ),\n    );\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text(\n          'Family Connect',\n          style: TextStyle(\n            fontWeight: FontWeight.bold,\n            fontSize: 24,\n          ),\n        ),\n        actions: [\n          IconButton(\n            icon: const Icon(Icons.notifications_outlined, size: 28),\n            onPressed: () {\n              // TODO: Navigate to notifications\n            },\n          ),\n          const SizedBox(width: 8),\n        ],\n      ),\n      body: RefreshIndicator(\n        onRefresh: () async {\n          // TODO: Implement refresh\n          await Future.delayed(const Duration(seconds: 1));\n        },\n        child: SingleChildScrollView(\n          physics: const AlwaysScrollableScrollPhysics(),\n          child: Column(\n            children: [\n              // Stories\n              SizedBox(\n                height: 100,\n                child: ListView.builder(\n                  scrollDirection: Axis.horizontal,\n                  padding: const EdgeInsets.symmetric(vertical: 12, horizontal: 8),\n                  itemCount: _stories.length,\n                  itemBuilder: (context, index) {\n                    final story = _stories[index];\n                    return Padding(\n                      padding: const EdgeInsets.symmetric(horizontal: 4),\n                      child: StoryCircleWidget(\n                        story: story,\n                        onTap: () => _viewStory(story, index),\n                      ),\n                    );\n                  },\n                ),\n              ),\n              \n              // Divider\n              const Divider(thickness: 8, height: 8, color: Colors.grey),\n              \n              // Posts\n              ListView.builder(\n                shrinkWrap: true,\n                physics: const NeverScrollableScrollPhysics(),\n                itemCount: _posts.length,\n                itemBuilder: (context, index) {\n                  return PostWidget(post: _posts[index]);\n                },\n              ),\n            ],\n          ),\n        ),\n      ),\n      bottomNavigationBar: BottomNavigationBar(\n        type: BottomNavigationBarType.fixed,\n        showSelectedLabels: false,\n        showUnselectedLabels: false,\n        items: const [\n          BottomNavigationBarItem(\n            icon: Icon(Icons.home_filled, size: 28),\n            label: 'Home',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.search, size: 28),\n            label: 'Search',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.add_box_outlined, size: 28),\n            label: 'Add',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.favorite_border, size: 28),\n            label: 'Activity',\n          ),\n          BottomNavigationBarItem(\n            icon: CircleAvatar(\n              radius: 14,\n              backgroundImage: NetworkImage(\n                'https://randomuser.me/api/portraits/men/1.jpg',\n              ),\n            ),\n            label: 'Profile',\n          ),\n        ],\n        currentIndex: 0,\n        onTap: (index) {\n          // TODO: Handle bottom navigation\n        },\n      ),\n    );\n  }\n}\n","baseTimestamp":1754459589474,"deltas":[{"timestamp":1754649690612,"changes":[{"type":"DELETE","lineNumber":12,"oldContent":"class HomeScreen extends StatelessWidget {"},{"type":"DELETE","lineNumber":14,"oldContent":"  const HomeScreen({Key? key}) : super(key: key);"},{"type":"DELETE","lineNumber":16,"oldContent":""},{"type":"INSERT","lineNumber":18,"content":"class HomeScreen extends StatelessWidget {"},{"type":"INSERT","lineNumber":19,"content":"  const HomeScreen({Key? key}) : super(key: key);"},{"type":"INSERT","lineNumber":20,"content":""},{"type":"MODIFY","lineNumber":22,"content":"  static final List<FamilyMember> familyMembers = [","oldContent":"  final List<FamilyMember> familyMembers = ["},{"type":"DELETE","lineNumber":31,"oldContent":"  final List<Map<String, dynamic>> quickActions = ["},{"type":"DELETE","lineNumber":32,"oldContent":"  // Build quick action button"},{"type":"INSERT","lineNumber":31,"content":"  static const List<Map<String, dynamic>> quickActions = ["},{"type":"DELETE","lineNumber":34,"oldContent":"  Widget _buildQuickAction({required IconData icon, required String label}) {"},{"type":"DELETE","lineNumber":36,"oldContent":"    return Column("},{"type":"INSERT","lineNumber":35,"content":"    {'icon': Icons.more_horiz, 'label': 'More'},"},{"type":"INSERT","lineNumber":36,"content":"  ];"},{"type":"INSERT","lineNumber":37,"content":""},{"type":"INSERT","lineNumber":38,"content":"  // Build quick action button"},{"type":"INSERT","lineNumber":39,"content":"  Widget _buildQuickAction({required IconData icon, required String label}) {"},{"type":"INSERT","lineNumber":40,"content":"    return Column("},{"type":"DELETE","lineNumber":40,"oldContent":"    {'icon': Icons.more_horiz, 'label': 'More'},"},{"type":"DELETE","lineNumber":42,"oldContent":"  ];"},{"type":"DELETE","lineNumber":45,"oldContent":""},{"type":"DELETE","lineNumber":48,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":50,"oldContent":"      backgroundColor: Colors.grey[50],"},{"type":"DELETE","lineNumber":52,"oldContent":"      appBar: AppBar("},{"type":"DELETE","lineNumber":54,"oldContent":"        backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":56,"oldContent":"        elevation: 1,"},{"type":"DELETE","lineNumber":59,"oldContent":"        leading: Padding("},{"type":"DELETE","lineNumber":61,"oldContent":"          padding: const EdgeInsets.all(8.0),"},{"type":"DELETE","lineNumber":63,"oldContent":"          child: CircleAvatar("},{"type":"DELETE","lineNumber":66,"oldContent":"            backgroundColor: Colors.grey[200],"},{"type":"DELETE","lineNumber":68,"oldContent":"            child: const Icon(Icons.person, color: Colors.grey),"},{"type":"DELETE","lineNumber":70,"oldContent":"        title: Column("},{"type":"DELETE","lineNumber":72,"oldContent":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":74,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":76,"oldContent":"            Text("},{"type":"DELETE","lineNumber":78,"oldContent":"              'Hello,',"},{"type":"DELETE","lineNumber":80,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":82,"oldContent":"                fontSize: 14,"},{"type":"DELETE","lineNumber":84,"oldContent":"                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":86,"oldContent":"              ),"},{"type":"DELETE","lineNumber":88,"oldContent":"            ),"},{"type":"DELETE","lineNumber":90,"oldContent":"            Text("},{"type":"DELETE","lineNumber":92,"oldContent":"              'John Doe',"},{"type":"DELETE","lineNumber":94,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":96,"oldContent":"                fontSize: 16,"},{"type":"DELETE","lineNumber":98,"oldContent":"                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":100,"oldContent":"                color: Colors.black,"},{"type":"DELETE","lineNumber":102,"oldContent":"              ),"},{"type":"DELETE","lineNumber":105,"oldContent":"            ),"},{"type":"DELETE","lineNumber":107,"oldContent":"          ],"},{"type":"DELETE","lineNumber":109,"oldContent":"                shape: BoxShape.circle(30 * size),"},{"type":"DELETE","lineNumber":110,"oldContent":"        ),"},{"type":"INSERT","lineNumber":80,"content":"                shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":112,"oldContent":"        actions: ["},{"type":"DELETE","lineNumber":114,"oldContent":"          IconButton("},{"type":"DELETE","lineNumber":116,"oldContent":"            icon: const Icon(Icons.notifications_none, color: Colors.black87, size: 28),"},{"type":"DELETE","lineNumber":118,"oldContent":"            onPressed: () {},"},{"type":"DELETE","lineNumber":120,"oldContent":"          ),"},{"type":"DELETE","lineNumber":122,"oldContent":"        ],"},{"type":"DELETE","lineNumber":124,"oldContent":"      ),"},{"type":"DELETE","lineNumber":126,"oldContent":"      body: SingleChildScrollView("},{"type":"DELETE","lineNumber":128,"oldContent":"        child: Column("},{"type":"DELETE","lineNumber":130,"oldContent":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":132,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":134,"oldContent":"            // Search Bar"},{"type":"DELETE","lineNumber":136,"oldContent":"            Padding("},{"type":"DELETE","lineNumber":138,"oldContent":"              padding: const EdgeInsets.all(16.0),"},{"type":"DELETE","lineNumber":140,"oldContent":"              child: Container("},{"type":"INSERT","lineNumber":96,"content":"                  ),"},{"type":"DELETE","lineNumber":142,"oldContent":"                padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"DELETE","lineNumber":145,"oldContent":"                decoration: BoxDecoration("},{"type":"DELETE","lineNumber":147,"oldContent":"                  color: Colors.white,"},{"type":"DELETE","lineNumber":149,"oldContent":"                  borderRadius: BorderRadius.circular(30),"},{"type":"DELETE","lineNumber":152,"oldContent":"                  border: Border.all(color: Colors.grey[300]!), "},{"type":"DELETE","lineNumber":154,"oldContent":"                  boxShadow: ["},{"type":"DELETE","lineNumber":156,"oldContent":"                    BoxShadow("},{"type":"DELETE","lineNumber":158,"oldContent":"                      color: Colors.grey.withOpacity(0.1),"},{"type":"DELETE","lineNumber":160,"oldContent":"                      blurRadius: 5,"},{"type":"DELETE","lineNumber":162,"oldContent":"                      offset: const Offset(0, 2),"},{"type":"DELETE","lineNumber":164,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":166,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":168,"oldContent":"                ),"},{"type":"DELETE","lineNumber":170,"oldContent":"                child: Row("},{"type":"DELETE","lineNumber":172,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":174,"oldContent":"                    const Icon(Icons.search, color: Colors.grey, size: 22),"},{"type":"DELETE","lineNumber":176,"oldContent":"                    const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":178,"oldContent":"                    Text("},{"type":"DELETE","lineNumber":180,"oldContent":"                      'Search...',"},{"type":"DELETE","lineNumber":182,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":184,"oldContent":"                        color: Colors.grey[500],"},{"type":"DELETE","lineNumber":186,"oldContent":"                        fontSize: 15,"},{"type":"DELETE","lineNumber":188,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":190,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":192,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":194,"oldContent":"                ),"},{"type":"DELETE","lineNumber":196,"oldContent":"              ),"},{"type":"DELETE","lineNumber":198,"oldContent":"            ),"},{"type":"DELETE","lineNumber":200,"oldContent":""},{"type":"DELETE","lineNumber":202,"oldContent":"            // Quick Actions"},{"type":"DELETE","lineNumber":204,"oldContent":"            Padding("},{"type":"DELETE","lineNumber":206,"oldContent":"              padding: const EdgeInsets.symmetric(horizontal: 16.0, vertical: 8),"},{"type":"DELETE","lineNumber":208,"oldContent":"              child: Row("},{"type":"DELETE","lineNumber":210,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"DELETE","lineNumber":212,"oldContent":"                children: quickActions.map((action) => _buildQuickAction("},{"type":"DELETE","lineNumber":214,"oldContent":"                  icon: action['icon'],"},{"type":"DELETE","lineNumber":216,"oldContent":"                  label: action['label'],"},{"type":"DELETE","lineNumber":218,"oldContent":"                )).toList(),"},{"type":"DELETE","lineNumber":220,"oldContent":"              ),"},{"type":"DELETE","lineNumber":222,"oldContent":"            ),"},{"type":"DELETE","lineNumber":225,"oldContent":""},{"type":"DELETE","lineNumber":228,"oldContent":"            // Family Tree Section"},{"type":"DELETE","lineNumber":231,"oldContent":"            Padding("},{"type":"DELETE","lineNumber":233,"oldContent":"              padding: const EdgeInsets.all(16.0),"},{"type":"INSERT","lineNumber":147,"content":"      backgroundColor: Colors.grey[50],"},{"type":"INSERT","lineNumber":148,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":149,"content":"        backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":150,"content":"        elevation: 1,"},{"type":"INSERT","lineNumber":151,"content":"        leading: Padding("},{"type":"INSERT","lineNumber":152,"content":"          padding: const EdgeInsets.all(8.0),"},{"type":"INSERT","lineNumber":153,"content":"          child: CircleAvatar("},{"type":"INSERT","lineNumber":154,"content":"            backgroundColor: Colors.grey[200],"},{"type":"INSERT","lineNumber":155,"content":"            child: const Icon(Icons.person, color: Colors.grey),"},{"type":"INSERT","lineNumber":156,"content":"          ),"},{"type":"INSERT","lineNumber":157,"content":"        ),"},{"type":"INSERT","lineNumber":158,"content":"        title: Column("},{"type":"INSERT","lineNumber":159,"content":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":160,"content":"          children: ["},{"type":"INSERT","lineNumber":161,"content":"            Text("},{"type":"INSERT","lineNumber":162,"content":"              'Hello,',"},{"type":"INSERT","lineNumber":163,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":164,"content":"                fontSize: 14,"},{"type":"INSERT","lineNumber":165,"content":"                color: Colors.grey[600],"},{"type":"INSERT","lineNumber":166,"content":"              ),"},{"type":"INSERT","lineNumber":167,"content":"            ),"},{"type":"INSERT","lineNumber":168,"content":"            Text("},{"type":"INSERT","lineNumber":169,"content":"              'John Doe',"},{"type":"INSERT","lineNumber":170,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":171,"content":"                fontSize: 16,"},{"type":"INSERT","lineNumber":172,"content":"                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":173,"content":"                color: Colors.black,"},{"type":"INSERT","lineNumber":174,"content":"              ),"},{"type":"INSERT","lineNumber":175,"content":"            ),"},{"type":"INSERT","lineNumber":176,"content":"          ],"},{"type":"INSERT","lineNumber":177,"content":"        ),"},{"type":"INSERT","lineNumber":178,"content":"        actions: ["},{"type":"INSERT","lineNumber":179,"content":"          IconButton("},{"type":"INSERT","lineNumber":180,"content":"            icon: const Icon(Icons.notifications_none, color: Colors.black87, size: 28),"},{"type":"INSERT","lineNumber":181,"content":"            onPressed: () {},"},{"type":"INSERT","lineNumber":182,"content":"          ),"},{"type":"INSERT","lineNumber":183,"content":"        ],"},{"type":"INSERT","lineNumber":184,"content":"      ),"},{"type":"INSERT","lineNumber":185,"content":"      body: SingleChildScrollView("},{"type":"INSERT","lineNumber":186,"content":"        child: Column("},{"type":"INSERT","lineNumber":187,"content":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":188,"content":"          children: ["},{"type":"INSERT","lineNumber":189,"content":"            // Search Bar"},{"type":"INSERT","lineNumber":190,"content":"            Padding("},{"type":"INSERT","lineNumber":191,"content":"              padding: const EdgeInsets.all(16.0),"},{"type":"INSERT","lineNumber":192,"content":"              child: Container("},{"type":"INSERT","lineNumber":193,"content":"                padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":194,"content":"                decoration: BoxDecoration("},{"type":"INSERT","lineNumber":195,"content":"                  color: Colors.white,"},{"type":"INSERT","lineNumber":196,"content":"                  borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":197,"content":"                  border: Border.all(color: Colors.grey[300]!), "},{"type":"INSERT","lineNumber":198,"content":"                  boxShadow: ["},{"type":"INSERT","lineNumber":199,"content":"                    BoxShadow("},{"type":"INSERT","lineNumber":200,"content":"                      color: Colors.grey.withOpacity(0.1),"},{"type":"INSERT","lineNumber":201,"content":"                      blurRadius: 5,"},{"type":"INSERT","lineNumber":202,"content":"                      offset: const Offset(0, 2),"},{"type":"INSERT","lineNumber":203,"content":"                    ),"},{"type":"INSERT","lineNumber":204,"content":"                  ],"},{"type":"INSERT","lineNumber":205,"content":"                ),"},{"type":"INSERT","lineNumber":206,"content":"                child: Row("},{"type":"INSERT","lineNumber":207,"content":"                  children: ["},{"type":"INSERT","lineNumber":208,"content":"                    const Icon(Icons.search, color: Colors.grey, size: 22),"},{"type":"INSERT","lineNumber":209,"content":"                    const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":210,"content":"                    Text("},{"type":"INSERT","lineNumber":211,"content":"                      'Search...',"},{"type":"INSERT","lineNumber":212,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":213,"content":"                        color: Colors.grey[500],"},{"type":"INSERT","lineNumber":214,"content":"                        fontSize: 15,"},{"type":"INSERT","lineNumber":215,"content":"                      ),"},{"type":"INSERT","lineNumber":216,"content":"                    ),"},{"type":"INSERT","lineNumber":217,"content":"                  ],"},{"type":"INSERT","lineNumber":218,"content":"                ),"},{"type":"INSERT","lineNumber":219,"content":"              ),"},{"type":"INSERT","lineNumber":220,"content":"            ),"},{"type":"INSERT","lineNumber":221,"content":""},{"type":"INSERT","lineNumber":222,"content":"            // Quick Actions"},{"type":"INSERT","lineNumber":223,"content":"            Padding("},{"type":"INSERT","lineNumber":224,"content":"              padding: const EdgeInsets.symmetric(horizontal: 16.0, vertical: 8),"},{"type":"INSERT","lineNumber":226,"content":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"INSERT","lineNumber":227,"content":"                children: quickActions.map((action) => _buildQuickAction("},{"type":"INSERT","lineNumber":228,"content":"                  icon: action['icon'],"},{"type":"INSERT","lineNumber":229,"content":"                  label: action['label'],"},{"type":"INSERT","lineNumber":230,"content":"                )).toList(),"},{"type":"INSERT","lineNumber":231,"content":"              ),"},{"type":"INSERT","lineNumber":232,"content":"            ),"},{"type":"INSERT","lineNumber":233,"content":""},{"type":"INSERT","lineNumber":234,"content":"            // Family Tree Section"},{"type":"INSERT","lineNumber":235,"content":"            Padding("},{"type":"INSERT","lineNumber":236,"content":"              padding: const EdgeInsets.all(16.0),"},{"type":"INSERT","lineNumber":237,"content":"              child: Row("},{"type":"INSERT","lineNumber":239,"content":"                children: ["},{"type":"INSERT","lineNumber":240,"content":"                  Text("},{"type":"INSERT","lineNumber":242,"content":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":239,"oldContent":"          ),"},{"type":"INSERT","lineNumber":244,"content":"                      fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":241,"oldContent":"        ),"},{"type":"INSERT","lineNumber":246,"content":"                  ),"},{"type":"INSERT","lineNumber":249,"content":"                    child: Text("},{"type":"INSERT","lineNumber":251,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":254,"content":"                      ),"},{"type":"INSERT","lineNumber":255,"content":"                    ),"},{"type":"INSERT","lineNumber":257,"content":"                ],"},{"type":"INSERT","lineNumber":258,"content":"              ),"},{"type":"INSERT","lineNumber":260,"content":""},{"type":"DELETE","lineNumber":279,"oldContent":""},{"type":"DELETE","lineNumber":280,"oldContent":"                children: ["},{"type":"DELETE","lineNumber":281,"oldContent":"}"},{"type":"DELETE","lineNumber":282,"oldContent":"                  Text("},{"type":"DELETE","lineNumber":283,"oldContent":"  }"},{"type":"DELETE","lineNumber":284,"oldContent":"    );"},{"type":"DELETE","lineNumber":285,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":286,"oldContent":"      ),"},{"type":"DELETE","lineNumber":287,"oldContent":"        ),"},{"type":"DELETE","lineNumber":288,"oldContent":"                      fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":289,"oldContent":"          ),"},{"type":"DELETE","lineNumber":290,"oldContent":"            ],"},{"type":"INSERT","lineNumber":291,"content":"                  "},{"type":"INSERT","lineNumber":292,"content":"                  // Bottom row (siblings)"},{"type":"INSERT","lineNumber":293,"content":"                  Row("},{"type":"INSERT","lineNumber":294,"content":"                    mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"INSERT","lineNumber":295,"content":"                    children: ["},{"type":"INSERT","lineNumber":296,"content":"                      _buildFamilyMember('Brother', 'Mike', 0.2),"},{"type":"INSERT","lineNumber":297,"content":"                      _buildFamilyMember('Sister', 'Emma', 0.2),"},{"type":"INSERT","lineNumber":298,"content":"                    ],"},{"type":"DELETE","lineNumber":292,"oldContent":"              _buildNavItem(Icons.person_outline, 'Profile'),"},{"type":"DELETE","lineNumber":293,"oldContent":"              _buildNavItem(Icons.chat_bubble_outline, 'Chat'),"},{"type":"DELETE","lineNumber":294,"oldContent":"              const SizedBox(width: 40), // Space for FAB"},{"type":"DELETE","lineNumber":295,"oldContent":"                    child: Text("},{"type":"DELETE","lineNumber":296,"oldContent":"              _buildNavItem(Icons.family_restroom, 'Family'),"},{"type":"DELETE","lineNumber":297,"oldContent":"              _buildNavItem(Icons.home_filled, 'Home', isSelected: true),"},{"type":"DELETE","lineNumber":298,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":299,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":300,"oldContent":"            mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"DELETE","lineNumber":301,"oldContent":"          child: Row("},{"type":"DELETE","lineNumber":302,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":303,"oldContent":"          notchMargin: 10,"},{"type":"DELETE","lineNumber":304,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":305,"oldContent":"          shape: const CircularNotchedRectangle(),"},{"type":"DELETE","lineNumber":306,"oldContent":"          color: Colors.white,"},{"type":"DELETE","lineNumber":308,"oldContent":"          height: 70,"},{"type":"DELETE","lineNumber":310,"oldContent":"        child: BottomAppBar("},{"type":"DELETE","lineNumber":311,"oldContent":"        ),"},{"type":"DELETE","lineNumber":312,"oldContent":""},{"type":"DELETE","lineNumber":313,"oldContent":"          ],"},{"type":"DELETE","lineNumber":315,"oldContent":"              offset: const Offset(0, -2),"},{"type":"DELETE","lineNumber":316,"oldContent":"              blurRadius: 5,"},{"type":"DELETE","lineNumber":317,"oldContent":"              spreadRadius: 1,"},{"type":"DELETE","lineNumber":318,"oldContent":"              color: Colors.grey.withOpacity(0.2),"},{"type":"DELETE","lineNumber":319,"oldContent":"            BoxShadow("},{"type":"DELETE","lineNumber":320,"oldContent":"          boxShadow: ["},{"type":"DELETE","lineNumber":321,"oldContent":"        decoration: BoxDecoration("},{"type":"DELETE","lineNumber":322,"oldContent":"      bottomNavigationBar: Container("},{"type":"DELETE","lineNumber":323,"oldContent":"      floatingActionButtonLocation: FloatingActionButtonLocation.centerDocked,"},{"type":"INSERT","lineNumber":303,"content":"          ],"},{"type":"INSERT","lineNumber":304,"content":"        ),"},{"type":"DELETE","lineNumber":325,"oldContent":"        child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"DELETE","lineNumber":326,"oldContent":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":327,"oldContent":"        onPressed: () {},"},{"type":"INSERT","lineNumber":307,"content":"        onPressed: () {},"},{"type":"INSERT","lineNumber":308,"content":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":309,"content":"        child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"DELETE","lineNumber":330,"oldContent":"        ),"},{"type":"DELETE","lineNumber":331,"oldContent":"          ],"},{"type":"INSERT","lineNumber":311,"content":"      floatingActionButtonLocation: FloatingActionButtonLocation.centerDocked,"},{"type":"INSERT","lineNumber":312,"content":"      bottomNavigationBar: Container("},{"type":"INSERT","lineNumber":313,"content":"        decoration: BoxDecoration("},{"type":"INSERT","lineNumber":314,"content":"          boxShadow: ["},{"type":"INSERT","lineNumber":315,"content":"            BoxShadow("},{"type":"INSERT","lineNumber":316,"content":"              color: Colors.grey.withOpacity(0.2),"},{"type":"INSERT","lineNumber":317,"content":"              spreadRadius: 1,"},{"type":"INSERT","lineNumber":318,"content":"              blurRadius: 5,"},{"type":"INSERT","lineNumber":319,"content":"              offset: const Offset(0, -2),"},{"type":"DELETE","lineNumber":333,"oldContent":"              ),"},{"type":"DELETE","lineNumber":334,"oldContent":"                ],"},{"type":"DELETE","lineNumber":335,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":336,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":337,"oldContent":"                      _buildFamilyMember('Sister', 'Emma', 0.2),"},{"type":"DELETE","lineNumber":338,"oldContent":"                      _buildFamilyMember('Brother', 'Mike', 0.2),"},{"type":"DELETE","lineNumber":339,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":340,"oldContent":"                    mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"DELETE","lineNumber":341,"oldContent":"                  Row("},{"type":"DELETE","lineNumber":342,"oldContent":"                  // Bottom row (siblings)"},{"type":"DELETE","lineNumber":343,"oldContent":"                  "},{"type":"INSERT","lineNumber":321,"content":"          ],"},{"type":"INSERT","lineNumber":322,"content":"        ),"},{"type":"INSERT","lineNumber":323,"content":"        child: BottomAppBar("},{"type":"INSERT","lineNumber":324,"content":"          height: 70,"},{"type":"INSERT","lineNumber":325,"content":"          color: Colors.white,"},{"type":"INSERT","lineNumber":326,"content":"          shape: const CircularNotchedRectangle(),"},{"type":"INSERT","lineNumber":327,"content":"          notchMargin: 10,"},{"type":"INSERT","lineNumber":328,"content":"          child: Row("},{"type":"INSERT","lineNumber":329,"content":"            mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"INSERT","lineNumber":330,"content":"            children: ["},{"type":"INSERT","lineNumber":331,"content":"              _buildNavItem(Icons.home_filled, 'Home', isSelected: true),"},{"type":"INSERT","lineNumber":332,"content":"              _buildNavItem(Icons.family_restroom, 'Family'),"},{"type":"INSERT","lineNumber":333,"content":"              const SizedBox(width: 40), // Space for FAB"},{"type":"INSERT","lineNumber":334,"content":"              _buildNavItem(Icons.chat_bubble_outline, 'Chat'),"},{"type":"INSERT","lineNumber":335,"content":"              _buildNavItem(Icons.person_outline, 'Profile'),"},{"type":"INSERT","lineNumber":336,"content":"            ],"},{"type":"INSERT","lineNumber":337,"content":"          ),"},{"type":"INSERT","lineNumber":338,"content":"        ),"},{"type":"INSERT","lineNumber":339,"content":"      ),"},{"type":"INSERT","lineNumber":340,"content":"    );"},{"type":"INSERT","lineNumber":341,"content":"  }"},{"type":"INSERT","lineNumber":342,"content":"}"},{"type":"INSERT","lineNumber":343,"content":""}]},{"timestamp":1754649720804,"changes":[{"type":"DELETE","lineNumber":15,"oldContent":"class HomeScreen extends StatelessWidget {"},{"type":"MODIFY","lineNumber":18,"content":"class HomeScreen extends StatelessWidget {","oldContent":"  const HomeScreen({Key? key}) : super(key: key);"},{"type":"INSERT","lineNumber":19,"content":"  const HomeScreen({Key? key}) : super(key: key);"},{"type":"MODIFY","lineNumber":31,"content":"  static const List<Map<String, Object>> quickActions = [","oldContent":"  static const List<Map<String, dynamic>> quickActions = ["},{"type":"DELETE","lineNumber":33,"oldContent":"    {'icon': Icons.more_horiz, 'label': 'More'},"},{"type":"DELETE","lineNumber":35,"oldContent":"  ];"},{"type":"DELETE","lineNumber":36,"oldContent":""},{"type":"INSERT","lineNumber":35,"content":"    {'icon': Icons.more_horiz, 'label': 'More'},"},{"type":"INSERT","lineNumber":36,"content":"  ] as List<Map<String, Object>>;"},{"type":"INSERT","lineNumber":37,"content":""},{"type":"INSERT","lineNumber":39,"content":"  Widget _buildQuickAction(IconData icon, String label) {"},{"type":"INSERT","lineNumber":40,"content":"    return Column("},{"type":"DELETE","lineNumber":40,"oldContent":"  Widget _buildQuickAction({required IconData icon, required String label}) {"},{"type":"DELETE","lineNumber":42,"oldContent":"    return Column("},{"type":"DELETE","lineNumber":65,"oldContent":"                shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":74,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":80,"content":"                shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":96,"content":"                  ),"},{"type":"INSERT","lineNumber":101,"content":"        ),"},{"type":"INSERT","lineNumber":102,"content":"        const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":103,"content":"        Text("},{"type":"INSERT","lineNumber":104,"content":"          name,"},{"type":"INSERT","lineNumber":105,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":106,"content":"            fontSize: 12,"},{"type":"INSERT","lineNumber":107,"content":"            fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":108,"content":"          ),"},{"type":"INSERT","lineNumber":109,"content":"        ),"},{"type":"INSERT","lineNumber":110,"content":"        Text("},{"type":"INSERT","lineNumber":111,"content":"          relation,"},{"type":"INSERT","lineNumber":112,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":113,"content":"            fontSize: 10,"},{"type":"INSERT","lineNumber":114,"content":"            color: Colors.grey[600],"},{"type":"INSERT","lineNumber":115,"content":"          ),"},{"type":"INSERT","lineNumber":116,"content":"        ),"},{"type":"INSERT","lineNumber":117,"content":"      ],"},{"type":"INSERT","lineNumber":118,"content":"    );"},{"type":"INSERT","lineNumber":119,"content":"  }"},{"type":"INSERT","lineNumber":120,"content":""},{"type":"INSERT","lineNumber":121,"content":"  // Build navigation item"},{"type":"INSERT","lineNumber":122,"content":"  Widget _buildNavItem(IconData icon, String label, {bool isSelected = false}) {"},{"type":"INSERT","lineNumber":123,"content":"    return Column("},{"type":"INSERT","lineNumber":124,"content":"      mainAxisSize: MainAxisSize.min,"},{"type":"INSERT","lineNumber":125,"content":"      children: ["},{"type":"INSERT","lineNumber":126,"content":"        Icon("},{"type":"INSERT","lineNumber":127,"content":"          icon,"},{"type":"INSERT","lineNumber":128,"content":"          color: isSelected ? const Color(0xFF6A11CB) : Colors.grey[600],"},{"type":"INSERT","lineNumber":129,"content":"          size: 24,"},{"type":"INSERT","lineNumber":130,"content":"        ),"},{"type":"INSERT","lineNumber":131,"content":"        const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":132,"content":"        Text("},{"type":"INSERT","lineNumber":133,"content":"          label,"},{"type":"INSERT","lineNumber":134,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":135,"content":"            fontSize: 10,"},{"type":"INSERT","lineNumber":136,"content":"            color: isSelected ? const Color(0xFF6A11CB) : Colors.grey[600],"},{"type":"INSERT","lineNumber":137,"content":"            fontWeight: isSelected ? FontWeight.w600 : FontWeight.normal,"},{"type":"INSERT","lineNumber":138,"content":"          ),"},{"type":"INSERT","lineNumber":139,"content":"        ),"},{"type":"INSERT","lineNumber":140,"content":"      ],"},{"type":"INSERT","lineNumber":141,"content":"    );"},{"type":"INSERT","lineNumber":142,"content":"  }"},{"type":"INSERT","lineNumber":143,"content":""},{"type":"INSERT","lineNumber":144,"content":"  @override"},{"type":"INSERT","lineNumber":145,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":146,"content":"    return Scaffold("},{"type":"DELETE","lineNumber":103,"oldContent":"        ),"},{"type":"DELETE","lineNumber":106,"oldContent":"        const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":108,"oldContent":"        Text("},{"type":"DELETE","lineNumber":111,"oldContent":"          name,"},{"type":"DELETE","lineNumber":114,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":117,"oldContent":"            fontSize: 12,"},{"type":"DELETE","lineNumber":120,"oldContent":"            fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":123,"oldContent":"          ),"},{"type":"DELETE","lineNumber":126,"oldContent":"        ),"},{"type":"DELETE","lineNumber":129,"oldContent":"        Text("},{"type":"DELETE","lineNumber":132,"oldContent":"          relation,"},{"type":"DELETE","lineNumber":135,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":138,"oldContent":"            fontSize: 10,"},{"type":"DELETE","lineNumber":141,"oldContent":"            color: Colors.grey[600],"},{"type":"DELETE","lineNumber":144,"oldContent":"          ),"},{"type":"DELETE","lineNumber":147,"oldContent":"        ),"},{"type":"DELETE","lineNumber":150,"oldContent":"      ],"},{"type":"DELETE","lineNumber":153,"oldContent":"    );"},{"type":"DELETE","lineNumber":156,"oldContent":"  }"},{"type":"DELETE","lineNumber":159,"oldContent":""},{"type":"DELETE","lineNumber":162,"oldContent":"  // Build navigation item"},{"type":"DELETE","lineNumber":165,"oldContent":"  Widget _buildNavItem(IconData icon, String label, {bool isSelected = false}) {"},{"type":"DELETE","lineNumber":168,"oldContent":"    return Column("},{"type":"DELETE","lineNumber":171,"oldContent":"      mainAxisSize: MainAxisSize.min,"},{"type":"DELETE","lineNumber":174,"oldContent":"      children: ["},{"type":"DELETE","lineNumber":177,"oldContent":"        Icon("},{"type":"DELETE","lineNumber":180,"oldContent":"          icon,"},{"type":"DELETE","lineNumber":183,"oldContent":"          color: isSelected ? const Color(0xFF6A11CB) : Colors.grey[600],"},{"type":"DELETE","lineNumber":186,"oldContent":"          size: 24,"},{"type":"DELETE","lineNumber":189,"oldContent":"        ),"},{"type":"DELETE","lineNumber":192,"oldContent":"        const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":195,"oldContent":"        Text("},{"type":"DELETE","lineNumber":198,"oldContent":"          label,"},{"type":"DELETE","lineNumber":201,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":204,"oldContent":"            fontSize: 10,"},{"type":"DELETE","lineNumber":207,"oldContent":"            color: isSelected ? const Color(0xFF6A11CB) : Colors.grey[600],"},{"type":"DELETE","lineNumber":210,"oldContent":"            fontWeight: isSelected ? FontWeight.w600 : FontWeight.normal,"},{"type":"DELETE","lineNumber":213,"oldContent":"          ),"},{"type":"DELETE","lineNumber":216,"oldContent":"        ),"},{"type":"DELETE","lineNumber":218,"oldContent":"      ],"},{"type":"INSERT","lineNumber":225,"content":"              child: Row("},{"type":"DELETE","lineNumber":220,"oldContent":"    );"},{"type":"DELETE","lineNumber":222,"oldContent":"  }"},{"type":"DELETE","lineNumber":223,"oldContent":"                  icon: action['icon'],"},{"type":"DELETE","lineNumber":224,"oldContent":"                  label: action['label'],"},{"type":"DELETE","lineNumber":225,"oldContent":""},{"type":"INSERT","lineNumber":228,"content":"                  action['icon'] as IconData,"},{"type":"INSERT","lineNumber":229,"content":"                  action['label'] as String,"},{"type":"DELETE","lineNumber":227,"oldContent":"  @override"},{"type":"DELETE","lineNumber":230,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":233,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":235,"oldContent":"              child: Row("},{"type":"DELETE","lineNumber":237,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":239,"oldContent":"                    'Your Family Tree',"},{"type":"DELETE","lineNumber":240,"oldContent":"                      fontSize: 18,"},{"type":"INSERT","lineNumber":238,"content":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":243,"oldContent":"                    ),"},{"type":"INSERT","lineNumber":241,"content":"                    'Your Family Tree',"},{"type":"INSERT","lineNumber":243,"content":"                      fontSize: 18,"},{"type":"INSERT","lineNumber":244,"content":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":245,"content":"                    ),"},{"type":"INSERT","lineNumber":246,"content":"                  ),"},{"type":"DELETE","lineNumber":247,"oldContent":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":249,"content":"                    child: Text("},{"type":"INSERT","lineNumber":251,"content":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":250,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":254,"content":"                      ),"},{"type":"INSERT","lineNumber":255,"content":"                    ),"},{"type":"INSERT","lineNumber":257,"content":"                ],"},{"type":"INSERT","lineNumber":258,"content":"              ),"},{"type":"DELETE","lineNumber":254,"oldContent":"                    child: Text("},{"type":"INSERT","lineNumber":260,"content":""},{"type":"DELETE","lineNumber":257,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":261,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":263,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":266,"oldContent":"                ],"},{"type":"DELETE","lineNumber":268,"oldContent":"              ),"},{"type":"DELETE","lineNumber":271,"oldContent":""},{"type":"DELETE","lineNumber":292,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":299,"content":"                  ),"},{"type":"INSERT","lineNumber":300,"content":"                ],"},{"type":"INSERT","lineNumber":301,"content":"              ),"},{"type":"INSERT","lineNumber":302,"content":"            ),"},{"type":"INSERT","lineNumber":305,"content":"      ),"},{"type":"INSERT","lineNumber":306,"content":"      floatingActionButton: FloatingActionButton("},{"type":"DELETE","lineNumber":303,"oldContent":"                ],"},{"type":"DELETE","lineNumber":306,"oldContent":"              ),"},{"type":"INSERT","lineNumber":310,"content":"      ),"},{"type":"DELETE","lineNumber":311,"oldContent":"            ),"},{"type":"INSERT","lineNumber":320,"content":"            ),"},{"type":"DELETE","lineNumber":321,"oldContent":"      ),"},{"type":"DELETE","lineNumber":326,"oldContent":"      floatingActionButton: FloatingActionButton("},{"type":"DELETE","lineNumber":328,"oldContent":"      ),"},{"type":"DELETE","lineNumber":332,"oldContent":"            ),"}]},{"timestamp":1754649765971,"changes":[{"type":"INSERT","lineNumber":6,"content":"class QuickAction {"},{"type":"INSERT","lineNumber":7,"content":"  final IconData icon;"},{"type":"INSERT","lineNumber":8,"content":"  final String label;"},{"type":"INSERT","lineNumber":9,"content":""},{"type":"INSERT","lineNumber":10,"content":"  const QuickAction({required this.icon, required this.label});"},{"type":"INSERT","lineNumber":11,"content":"}"},{"type":"INSERT","lineNumber":12,"content":""},{"type":"DELETE","lineNumber":16,"oldContent":"  const HomeScreen({Key? key}) : super(key: key);"},{"type":"INSERT","lineNumber":23,"content":"}"},{"type":"INSERT","lineNumber":24,"content":""},{"type":"DELETE","lineNumber":20,"oldContent":""},{"type":"DELETE","lineNumber":31,"oldContent":"  static const List<Map<String, Object>> quickActions = ["},{"type":"DELETE","lineNumber":32,"oldContent":"    {'icon': Icons.family_restroom, 'label': 'Family'},"},{"type":"DELETE","lineNumber":33,"oldContent":"    {'icon': Icons.person_add, 'label': 'Add Member'},"},{"type":"DELETE","lineNumber":34,"oldContent":"    {'icon': Icons.more_horiz, 'label': 'More'},"},{"type":"DELETE","lineNumber":35,"oldContent":"  ] as List<Map<String, Object>>;"},{"type":"INSERT","lineNumber":38,"content":"  static const List<QuickAction> quickActions = ["},{"type":"INSERT","lineNumber":39,"content":"    QuickAction(icon: Icons.family_restroom, label: 'Family'),"},{"type":"INSERT","lineNumber":40,"content":"    QuickAction(icon: Icons.person_add, label: 'Add Member'),"},{"type":"INSERT","lineNumber":41,"content":"    QuickAction(icon: Icons.search, label: 'Search'),"},{"type":"INSERT","lineNumber":42,"content":"    QuickAction(icon: Icons.more_horiz, label: 'More'),"},{"type":"INSERT","lineNumber":43,"content":"  ];"},{"type":"DELETE","lineNumber":37,"oldContent":"    {'icon': Icons.search, 'label': 'Search'},"},{"type":"DELETE","lineNumber":39,"oldContent":"  Widget _buildQuickAction(IconData icon, String label) {"},{"type":"DELETE","lineNumber":40,"oldContent":"      mainAxisSize: MainAxisSize.min,"},{"type":"INSERT","lineNumber":46,"content":"  Widget _buildQuickAction(QuickAction action) {"},{"type":"INSERT","lineNumber":48,"content":"      mainAxisSize: MainAxisSize.min,"},{"type":"DELETE","lineNumber":56,"oldContent":"          child: Icon(icon, color: const Color(0xFF6A11CB), size: 24),"},{"type":"INSERT","lineNumber":63,"content":"          child: Icon(action.icon, color: const Color(0xFF6A11CB), size: 24),"},{"type":"DELETE","lineNumber":78,"oldContent":"                shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":87,"content":"                shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":95,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":103,"content":"                  ),"},{"type":"DELETE","lineNumber":102,"oldContent":"      backgroundColor: Colors.grey[50],"},{"type":"DELETE","lineNumber":104,"oldContent":"      appBar: AppBar("},{"type":"DELETE","lineNumber":107,"oldContent":"        backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":109,"oldContent":"        elevation: 1,"},{"type":"DELETE","lineNumber":112,"oldContent":"        leading: Padding("},{"type":"DELETE","lineNumber":115,"oldContent":"          padding: const EdgeInsets.all(8.0),"},{"type":"DELETE","lineNumber":117,"oldContent":"          child: CircleAvatar("},{"type":"DELETE","lineNumber":120,"oldContent":"            backgroundColor: Colors.grey[200],"},{"type":"DELETE","lineNumber":122,"oldContent":"            child: const Icon(Icons.person, color: Colors.grey),"},{"type":"DELETE","lineNumber":125,"oldContent":"          ),"},{"type":"DELETE","lineNumber":127,"oldContent":"        ),"},{"type":"DELETE","lineNumber":130,"oldContent":"        title: Column("},{"type":"DELETE","lineNumber":132,"oldContent":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":135,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":137,"oldContent":"            Text("},{"type":"DELETE","lineNumber":140,"oldContent":"              'Hello,',"},{"type":"DELETE","lineNumber":142,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":145,"oldContent":"                fontSize: 14,"},{"type":"DELETE","lineNumber":147,"oldContent":"                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":150,"oldContent":"              ),"},{"type":"DELETE","lineNumber":152,"oldContent":"            ),"},{"type":"DELETE","lineNumber":155,"oldContent":"            Text("},{"type":"DELETE","lineNumber":157,"oldContent":"              'John Doe',"},{"type":"DELETE","lineNumber":160,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":162,"oldContent":"                fontSize: 16,"},{"type":"DELETE","lineNumber":165,"oldContent":"                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":167,"oldContent":"                color: Colors.black,"},{"type":"DELETE","lineNumber":170,"oldContent":"              ),"},{"type":"DELETE","lineNumber":172,"oldContent":"            ),"},{"type":"DELETE","lineNumber":175,"oldContent":"          ],"},{"type":"INSERT","lineNumber":154,"content":"      backgroundColor: Colors.grey[50],"},{"type":"INSERT","lineNumber":155,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":156,"content":"        backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":157,"content":"        elevation: 1,"},{"type":"INSERT","lineNumber":158,"content":"        leading: Padding("},{"type":"INSERT","lineNumber":159,"content":"          padding: const EdgeInsets.all(8.0),"},{"type":"INSERT","lineNumber":160,"content":"          child: CircleAvatar("},{"type":"INSERT","lineNumber":161,"content":"            backgroundColor: Colors.grey[200],"},{"type":"INSERT","lineNumber":162,"content":"            child: const Icon(Icons.person, color: Colors.grey),"},{"type":"INSERT","lineNumber":163,"content":"          ),"},{"type":"INSERT","lineNumber":165,"content":"        title: Column("},{"type":"INSERT","lineNumber":166,"content":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":167,"content":"          children: ["},{"type":"INSERT","lineNumber":168,"content":"            Text("},{"type":"INSERT","lineNumber":169,"content":"              'Hello,',"},{"type":"INSERT","lineNumber":170,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":171,"content":"                fontSize: 14,"},{"type":"INSERT","lineNumber":172,"content":"                color: Colors.grey[600],"},{"type":"INSERT","lineNumber":173,"content":"              ),"},{"type":"INSERT","lineNumber":174,"content":"            ),"},{"type":"INSERT","lineNumber":175,"content":"            Text("},{"type":"INSERT","lineNumber":176,"content":"              'John Doe',"},{"type":"INSERT","lineNumber":177,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":178,"content":"                fontSize: 16,"},{"type":"INSERT","lineNumber":179,"content":"                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":180,"content":"                color: Colors.black,"},{"type":"INSERT","lineNumber":181,"content":"              ),"},{"type":"INSERT","lineNumber":182,"content":"            ),"},{"type":"INSERT","lineNumber":183,"content":"          ],"},{"type":"INSERT","lineNumber":184,"content":"        ),"},{"type":"DELETE","lineNumber":225,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"DELETE","lineNumber":226,"oldContent":"                children: quickActions.map((action) => _buildQuickAction("},{"type":"DELETE","lineNumber":228,"oldContent":"                )).toList(),"},{"type":"DELETE","lineNumber":229,"oldContent":"                  action['icon'] as IconData,"},{"type":"INSERT","lineNumber":233,"content":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"INSERT","lineNumber":234,"content":"                children: quickActions.map((action) => _buildQuickAction(action)).toList(),"},{"type":"DELETE","lineNumber":231,"oldContent":"                  action['label'] as String,"},{"type":"DELETE","lineNumber":237,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":239,"oldContent":"                    'Your Family Tree',"},{"type":"INSERT","lineNumber":242,"content":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":245,"content":"                    'Your Family Tree',"},{"type":"INSERT","lineNumber":246,"content":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":244,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":246,"oldContent":"                  TextButton("},{"type":"INSERT","lineNumber":251,"content":"                  TextButton("},{"type":"DELETE","lineNumber":249,"oldContent":"                      'View All',"},{"type":"DELETE","lineNumber":251,"oldContent":"                        color: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":254,"content":"                      'View All',"},{"type":"INSERT","lineNumber":256,"content":"                        color: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":254,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":255,"oldContent":"            ),"},{"type":"DELETE","lineNumber":258,"oldContent":"            // Family Tree Visualization"},{"type":"DELETE","lineNumber":259,"oldContent":"            Container("},{"type":"INSERT","lineNumber":260,"content":"                  ),"},{"type":"INSERT","lineNumber":263,"content":"            ),"},{"type":"INSERT","lineNumber":264,"content":""},{"type":"INSERT","lineNumber":265,"content":"            // Family Tree Visualization"},{"type":"INSERT","lineNumber":266,"content":"            Container("},{"type":"DELETE","lineNumber":264,"oldContent":""},{"type":"DELETE","lineNumber":298,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":303,"content":"                  ),"},{"type":"DELETE","lineNumber":301,"oldContent":"          ],"},{"type":"DELETE","lineNumber":303,"oldContent":"        ),"},{"type":"INSERT","lineNumber":307,"content":"          ],"},{"type":"INSERT","lineNumber":308,"content":"        ),"},{"type":"INSERT","lineNumber":309,"content":"      ),"},{"type":"INSERT","lineNumber":310,"content":"      floatingActionButton: FloatingActionButton("},{"type":"DELETE","lineNumber":307,"oldContent":"      ),"},{"type":"DELETE","lineNumber":309,"oldContent":"      floatingActionButton: FloatingActionButton("},{"type":"INSERT","lineNumber":314,"content":"      ),"},{"type":"DELETE","lineNumber":313,"oldContent":"      ),"},{"type":"INSERT","lineNumber":324,"content":"            ),"},{"type":"DELETE","lineNumber":323,"oldContent":"            ),"}]},{"timestamp":1754649781026,"changes":[{"type":"DELETE","lineNumber":0,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_bloc.dart';"},{"type":"DELETE","lineNumber":1,"oldContent":"import 'package:firebase_auth/firebase_auth.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:flutter_bloc/flutter_bloc.dart';"},{"type":"DELETE","lineNumber":7,"oldContent":"class FamilyMember {"},{"type":"DELETE","lineNumber":9,"oldContent":"  final String name;"},{"type":"DELETE","lineNumber":11,"oldContent":"  final String? imageUrl;"},{"type":"DELETE","lineNumber":13,"oldContent":"  final String relation;"},{"type":"DELETE","lineNumber":15,"oldContent":""},{"type":"DELETE","lineNumber":17,"oldContent":"  FamilyMember({"},{"type":"INSERT","lineNumber":10,"content":"class FamilyMember {"},{"type":"INSERT","lineNumber":11,"content":"  final String name;"},{"type":"INSERT","lineNumber":12,"content":"  final String? imageUrl;"},{"type":"INSERT","lineNumber":13,"content":"  final String relation;"},{"type":"INSERT","lineNumber":14,"content":""},{"type":"INSERT","lineNumber":15,"content":"  FamilyMember({"},{"type":"INSERT","lineNumber":20,"content":"}"},{"type":"INSERT","lineNumber":21,"content":""},{"type":"DELETE","lineNumber":28,"oldContent":"}"},{"type":"DELETE","lineNumber":30,"oldContent":""},{"type":"DELETE","lineNumber":38,"oldContent":""},{"type":"DELETE","lineNumber":40,"oldContent":"  // Build quick action button"},{"type":"DELETE","lineNumber":44,"oldContent":"    return Column("},{"type":"DELETE","lineNumber":46,"oldContent":"      children: ["},{"type":"INSERT","lineNumber":41,"content":""},{"type":"INSERT","lineNumber":42,"content":"  // Build quick action button"},{"type":"INSERT","lineNumber":43,"content":"  Widget _buildQuickAction(QuickAction action) {"},{"type":"INSERT","lineNumber":44,"content":"    return Column("},{"type":"INSERT","lineNumber":45,"content":"      mainAxisSize: MainAxisSize.min,"},{"type":"INSERT","lineNumber":46,"content":"      children: ["},{"type":"DELETE","lineNumber":51,"oldContent":"  Widget _buildQuickAction(QuickAction action) {"},{"type":"DELETE","lineNumber":54,"oldContent":"      mainAxisSize: MainAxisSize.min,"},{"type":"INSERT","lineNumber":60,"content":"          child: Icon(action.icon, color: const Color(0xFF6A11CB), size: 24),"},{"type":"DELETE","lineNumber":66,"oldContent":"          label,"},{"type":"INSERT","lineNumber":64,"content":"          action.label,"},{"type":"DELETE","lineNumber":69,"oldContent":"          child: Icon(action.icon, color: const Color(0xFF6A11CB), size: 24),"},{"type":"INSERT","lineNumber":84,"content":"                shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":93,"oldContent":"                shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":100,"content":"                  ),"},{"type":"DELETE","lineNumber":108,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":140,"oldContent":"      backgroundColor: Colors.grey[50],"},{"type":"INSERT","lineNumber":138,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":139,"content":"            fontSize: 10,"},{"type":"INSERT","lineNumber":140,"content":"            color: isSelected ? const Color(0xFF6A11CB) : Colors.grey[600],"},{"type":"INSERT","lineNumber":141,"content":"            fontWeight: isSelected ? FontWeight.w600 : FontWeight.normal,"},{"type":"INSERT","lineNumber":142,"content":"          ),"},{"type":"INSERT","lineNumber":143,"content":"        ),"},{"type":"INSERT","lineNumber":144,"content":"      ],"},{"type":"INSERT","lineNumber":145,"content":"    );"},{"type":"INSERT","lineNumber":146,"content":"  }"},{"type":"INSERT","lineNumber":147,"content":""},{"type":"INSERT","lineNumber":148,"content":"  @override"},{"type":"INSERT","lineNumber":149,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":150,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":151,"content":"      backgroundColor: Colors.grey[50],"},{"type":"DELETE","lineNumber":144,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":147,"oldContent":"            fontSize: 10,"},{"type":"DELETE","lineNumber":149,"oldContent":"            color: isSelected ? const Color(0xFF6A11CB) : Colors.grey[600],"},{"type":"DELETE","lineNumber":152,"oldContent":"            fontWeight: isSelected ? FontWeight.w600 : FontWeight.normal,"},{"type":"DELETE","lineNumber":155,"oldContent":"          ),"},{"type":"DELETE","lineNumber":159,"oldContent":"      ],"},{"type":"DELETE","lineNumber":162,"oldContent":"    );"},{"type":"DELETE","lineNumber":164,"oldContent":"  }"},{"type":"DELETE","lineNumber":167,"oldContent":""},{"type":"DELETE","lineNumber":170,"oldContent":"  @override"},{"type":"DELETE","lineNumber":172,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":175,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":177,"oldContent":"        ),"},{"type":"DELETE","lineNumber":179,"oldContent":"        actions: ["},{"type":"DELETE","lineNumber":181,"oldContent":"          IconButton("},{"type":"DELETE","lineNumber":183,"oldContent":"            icon: const Icon(Icons.notifications_none, color: Colors.black87, size: 28),"},{"type":"DELETE","lineNumber":185,"oldContent":"            onPressed: () {},"},{"type":"DELETE","lineNumber":187,"oldContent":"          ),"},{"type":"DELETE","lineNumber":189,"oldContent":"        ],"},{"type":"INSERT","lineNumber":182,"content":"        actions: ["},{"type":"INSERT","lineNumber":183,"content":"          IconButton("},{"type":"INSERT","lineNumber":184,"content":"            icon: const Icon(Icons.notifications_none, color: Colors.black87, size: 28),"},{"type":"INSERT","lineNumber":185,"content":"            onPressed: () {},"},{"type":"INSERT","lineNumber":186,"content":"          ),"},{"type":"INSERT","lineNumber":187,"content":"        ],"},{"type":"INSERT","lineNumber":230,"content":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"INSERT","lineNumber":231,"content":"                children: quickActions.map((action) => _buildQuickAction(action)).toList(),"},{"type":"DELETE","lineNumber":235,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"DELETE","lineNumber":237,"oldContent":"                children: quickActions.map((action) => _buildQuickAction(action)).toList(),"},{"type":"INSERT","lineNumber":239,"content":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":244,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":242,"content":"                    'Your Family Tree',"},{"type":"INSERT","lineNumber":243,"content":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":247,"oldContent":"                    'Your Family Tree',"},{"type":"DELETE","lineNumber":249,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":248,"content":"                  TextButton("},{"type":"DELETE","lineNumber":253,"oldContent":"                  TextButton("},{"type":"DELETE","lineNumber":254,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":255,"oldContent":"                        fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":252,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":254,"content":"                        fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":263,"oldContent":"              height: 220,"},{"type":"DELETE","lineNumber":265,"oldContent":"              margin: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"DELETE","lineNumber":268,"oldContent":"              padding: const EdgeInsets.all(16),"},{"type":"INSERT","lineNumber":264,"content":"              height: 220,"},{"type":"INSERT","lineNumber":265,"content":"              margin: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"INSERT","lineNumber":266,"content":"              padding: const EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":294,"oldContent":"      ),"},{"type":"INSERT","lineNumber":291,"content":"                  _buildFamilyMember('You', 'Your Name', 0.3, isYou: true),"},{"type":"INSERT","lineNumber":300,"content":"                  ),"},{"type":"DELETE","lineNumber":305,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":307,"oldContent":"        onPressed: () {},"},{"type":"DELETE","lineNumber":308,"oldContent":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":311,"oldContent":"        child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"INSERT","lineNumber":308,"content":"        onPressed: () {},"},{"type":"INSERT","lineNumber":309,"content":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":310,"content":"        child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"INSERT","lineNumber":311,"content":"      ),"},{"type":"DELETE","lineNumber":317,"oldContent":"      ),"},{"type":"INSERT","lineNumber":321,"content":"            ),"},{"type":"DELETE","lineNumber":327,"oldContent":"            ),"},{"type":"DELETE","lineNumber":348,"oldContent":"                  "},{"type":"DELETE","lineNumber":349,"oldContent":"      ),"},{"type":"DELETE","lineNumber":350,"oldContent":"                  // Bottom row (siblings)"},{"type":"DELETE","lineNumber":351,"oldContent":"        child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"DELETE","lineNumber":352,"oldContent":"                  Row("},{"type":"DELETE","lineNumber":353,"oldContent":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":354,"oldContent":"                    mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"DELETE","lineNumber":355,"oldContent":"        onPressed: () {},"},{"type":"DELETE","lineNumber":356,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":357,"oldContent":"      floatingActionButton: FloatingActionButton("},{"type":"DELETE","lineNumber":358,"oldContent":"                      _buildFamilyMember('Brother', 'Mike', 0.2),"},{"type":"DELETE","lineNumber":359,"oldContent":"      ),"},{"type":"DELETE","lineNumber":360,"oldContent":"                      _buildFamilyMember('Sister', 'Emma', 0.2),"},{"type":"DELETE","lineNumber":361,"oldContent":"        ),"},{"type":"DELETE","lineNumber":362,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":363,"oldContent":"          ],"},{"type":"DELETE","lineNumber":364,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":365,"oldContent":"            ),"},{"type":"DELETE","lineNumber":366,"oldContent":"                ],"},{"type":"DELETE","lineNumber":367,"oldContent":"              ),"}]},{"timestamp":1754649877886,"changes":[{"type":"DELETE","lineNumber":5,"oldContent":"class FamilyMember {"},{"type":"INSERT","lineNumber":6,"content":""},{"type":"INSERT","lineNumber":7,"content":"  const QuickAction({required this.icon, required this.label});"},{"type":"INSERT","lineNumber":8,"content":"}"},{"type":"INSERT","lineNumber":9,"content":""},{"type":"INSERT","lineNumber":10,"content":"class FamilyMember {"},{"type":"DELETE","lineNumber":9,"oldContent":""},{"type":"DELETE","lineNumber":12,"oldContent":"  const QuickAction({required this.icon, required this.label});"},{"type":"DELETE","lineNumber":14,"oldContent":"}"},{"type":"DELETE","lineNumber":15,"oldContent":""},{"type":"DELETE","lineNumber":17,"oldContent":"}"},{"type":"DELETE","lineNumber":19,"oldContent":""},{"type":"INSERT","lineNumber":20,"content":"}"},{"type":"INSERT","lineNumber":21,"content":""},{"type":"DELETE","lineNumber":36,"oldContent":""},{"type":"DELETE","lineNumber":38,"oldContent":"  // Build quick action button"},{"type":"DELETE","lineNumber":40,"oldContent":"  Widget _buildQuickAction(QuickAction action) {"},{"type":"INSERT","lineNumber":39,"content":"    QuickAction(icon: Icons.more_horiz, label: 'More'),"},{"type":"INSERT","lineNumber":40,"content":"  ];"},{"type":"INSERT","lineNumber":41,"content":""},{"type":"INSERT","lineNumber":42,"content":"  // Build quick action button"},{"type":"INSERT","lineNumber":43,"content":"  Widget _buildQuickAction(QuickAction action) {"},{"type":"DELETE","lineNumber":44,"oldContent":"    QuickAction(icon: Icons.more_horiz, label: 'More'),"},{"type":"DELETE","lineNumber":46,"oldContent":"  ];"},{"type":"DELETE","lineNumber":57,"oldContent":"          child: Icon(action.icon, color: const Color(0xFF6A11CB), size: 24),"},{"type":"INSERT","lineNumber":60,"content":"          child: Icon(action.icon, color: const Color(0xFF6A11CB), size: 24),"},{"type":"DELETE","lineNumber":62,"oldContent":"          action.label,"},{"type":"INSERT","lineNumber":64,"content":"          action.label,"},{"type":"DELETE","lineNumber":81,"oldContent":"                shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":84,"content":"                shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":97,"oldContent":"                  ),"},{"type":"MODIFY","lineNumber":99,"content":"                    shape: BoxShape.circle,","oldContent":"                    shape: BoxShape.circle(12),"},{"type":"INSERT","lineNumber":100,"content":"                  ),"},{"type":"DELETE","lineNumber":135,"oldContent":"          style: GoogleFonts.poppins("},{"type":"MODIFY","lineNumber":137,"content":"          label,","oldContent":"            fontSize: 10,"},{"type":"INSERT","lineNumber":138,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":139,"content":"            fontSize: 10,"},{"type":"DELETE","lineNumber":141,"oldContent":"          label,"},{"type":"DELETE","lineNumber":143,"oldContent":"      appBar: AppBar("},{"type":"DELETE","lineNumber":145,"oldContent":"        backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":148,"oldContent":"        elevation: 1,"},{"type":"DELETE","lineNumber":150,"oldContent":"        leading: Padding("},{"type":"DELETE","lineNumber":153,"oldContent":"          padding: const EdgeInsets.all(8.0),"},{"type":"DELETE","lineNumber":156,"oldContent":"          child: CircleAvatar("},{"type":"INSERT","lineNumber":152,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":153,"content":"        backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":154,"content":"        elevation: 1,"},{"type":"INSERT","lineNumber":155,"content":"        leading: Padding("},{"type":"INSERT","lineNumber":156,"content":"          padding: const EdgeInsets.all(8.0),"},{"type":"INSERT","lineNumber":157,"content":"          child: CircleAvatar("},{"type":"DELETE","lineNumber":177,"oldContent":"        actions: ["},{"type":"INSERT","lineNumber":178,"content":"              ),"},{"type":"INSERT","lineNumber":179,"content":"            ),"},{"type":"INSERT","lineNumber":180,"content":"          ],"},{"type":"INSERT","lineNumber":181,"content":"        ),"},{"type":"INSERT","lineNumber":182,"content":"        actions: ["},{"type":"DELETE","lineNumber":181,"oldContent":"              ),"},{"type":"DELETE","lineNumber":184,"oldContent":"            ),"},{"type":"DELETE","lineNumber":186,"oldContent":"          ],"},{"type":"DELETE","lineNumber":187,"oldContent":"        ),"},{"type":"DELETE","lineNumber":227,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"DELETE","lineNumber":229,"oldContent":"                children: quickActions.map((action) => _buildQuickAction(action)).toList(),"},{"type":"INSERT","lineNumber":230,"content":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"INSERT","lineNumber":231,"content":"                children: quickActions.map((action) => _buildQuickAction(action)).toList(),"},{"type":"DELETE","lineNumber":236,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":240,"oldContent":"                    'Your Family Tree',"},{"type":"INSERT","lineNumber":239,"content":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"MODIFY","lineNumber":242,"content":"                    'Your Family Tree',","oldContent":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":243,"content":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":246,"oldContent":"                  TextButton("},{"type":"INSERT","lineNumber":248,"content":"                  TextButton("},{"type":"DELETE","lineNumber":250,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"MODIFY","lineNumber":252,"content":"                      style: GoogleFonts.poppins(","oldContent":"                        fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":254,"content":"                        fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":260,"oldContent":"              height: 220,"},{"type":"DELETE","lineNumber":262,"oldContent":"              margin: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"DELETE","lineNumber":263,"oldContent":"              padding: const EdgeInsets.all(16),"},{"type":"INSERT","lineNumber":264,"content":"              height: 220,"},{"type":"INSERT","lineNumber":265,"content":"              margin: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"INSERT","lineNumber":266,"content":"              padding: const EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":288,"oldContent":"                  _buildFamilyMember('You', 'Your Name', 0.3, isYou: true),"},{"type":"INSERT","lineNumber":291,"content":"                  _buildFamilyMember('You', 'Your Name', 0.3, isYou: true),"},{"type":"DELETE","lineNumber":297,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":300,"content":"                  ),"},{"type":"DELETE","lineNumber":304,"oldContent":"        onPressed: () {},"},{"type":"DELETE","lineNumber":305,"oldContent":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":307,"oldContent":"        child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"DELETE","lineNumber":310,"oldContent":"      ),"},{"type":"INSERT","lineNumber":308,"content":"        onPressed: () {},"},{"type":"INSERT","lineNumber":309,"content":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":310,"content":"        child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"INSERT","lineNumber":311,"content":"      ),"},{"type":"DELETE","lineNumber":318,"oldContent":"            ),"},{"type":"INSERT","lineNumber":321,"content":"            ),"}]},{"timestamp":1754649886328,"changes":[{"type":"MODIFY","lineNumber":6,"content":"","oldContent":""},{"type":"DELETE","lineNumber":8,"oldContent":"  final String name;"},{"type":"MODIFY","lineNumber":11,"content":"  final String name;","oldContent":"  final String? imageUrl;"},{"type":"INSERT","lineNumber":12,"content":"  final String? imageUrl;"},{"type":"DELETE","lineNumber":18,"oldContent":"}"},{"type":"MODIFY","lineNumber":20,"content":"}","oldContent":""},{"type":"INSERT","lineNumber":21,"content":""},{"type":"MODIFY","lineNumber":38,"content":"    QuickAction(icon: Icons.search, label: 'Search'),","oldContent":"    QuickAction(icon: Icons.more_horiz, label: 'More'),"},{"type":"INSERT","lineNumber":39,"content":"    QuickAction(icon: Icons.more_horiz, label: 'More'),"},{"type":"DELETE","lineNumber":41,"oldContent":"    QuickAction(icon: Icons.search, label: 'Search'),"},{"type":"MODIFY","lineNumber":44,"content":"    return Column(","oldContent":"    return Column("},{"type":"MODIFY","lineNumber":51,"content":"            shape: BoxShape.circle,","oldContent":"            shape: BoxShape.circle(),"},{"type":"MODIFY","lineNumber":60,"content":"          child: Icon(action.icon, color: const Color(0xFF6A11CB), size: 24),","oldContent":"          child: Icon(action.icon, color: const Color(0xFF6A11CB), size: 24),"},{"type":"MODIFY","lineNumber":64,"content":"          action.label,","oldContent":"          action.label,"},{"type":"MODIFY","lineNumber":84,"content":"                shape: BoxShape.circle,","oldContent":"                shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":98,"content":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":100,"oldContent":"                    shape: BoxShape.circle(12),"},{"type":"INSERT","lineNumber":136,"content":"        Text("},{"type":"DELETE","lineNumber":138,"oldContent":"        Text("},{"type":"DELETE","lineNumber":148,"oldContent":"      appBar: AppBar("},{"type":"INSERT","lineNumber":149,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":150,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":151,"content":"      backgroundColor: Colors.grey[50],"},{"type":"INSERT","lineNumber":152,"content":"      appBar: AppBar("},{"type":"DELETE","lineNumber":152,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":154,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":157,"oldContent":"      backgroundColor: Colors.grey[50],"},{"type":"MODIFY","lineNumber":178,"content":"              ),","oldContent":"              ),"},{"type":"DELETE","lineNumber":180,"oldContent":"          IconButton("},{"type":"DELETE","lineNumber":182,"oldContent":"            icon: const Icon(Icons.notifications_none, color: Colors.black87, size: 28),"},{"type":"INSERT","lineNumber":183,"content":"          IconButton("},{"type":"INSERT","lineNumber":184,"content":"            icon: const Icon(Icons.notifications_none, color: Colors.black87, size: 28),"},{"type":"DELETE","lineNumber":228,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"MODIFY","lineNumber":230,"content":"                mainAxisAlignment: MainAxisAlignment.spaceAround,","oldContent":"                children: quickActions.map((action) => _buildQuickAction(action)).toList(),"},{"type":"INSERT","lineNumber":231,"content":"                children: quickActions.map((action) => _buildQuickAction(action)).toList(),"},{"type":"MODIFY","lineNumber":239,"content":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,","oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":241,"content":"                  Text("},{"type":"DELETE","lineNumber":243,"oldContent":"                  Text("},{"type":"MODIFY","lineNumber":248,"content":"                  TextButton(","oldContent":"                  TextButton("},{"type":"DELETE","lineNumber":251,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":253,"oldContent":"                        fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":252,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":254,"content":"                        fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":261,"oldContent":"              height: 220,"},{"type":"DELETE","lineNumber":263,"oldContent":"              margin: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"DELETE","lineNumber":265,"oldContent":"              padding: const EdgeInsets.all(16),"},{"type":"INSERT","lineNumber":264,"content":"              height: 220,"},{"type":"INSERT","lineNumber":265,"content":"              margin: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"INSERT","lineNumber":266,"content":"              padding: const EdgeInsets.all(16),"},{"type":"MODIFY","lineNumber":291,"content":"                  _buildFamilyMember('You', 'Your Name', 0.3, isYou: true),","oldContent":"                  _buildFamilyMember('You', 'Your Name', 0.3, isYou: true),"},{"type":"MODIFY","lineNumber":300,"content":"                  ),","oldContent":"                  ),"},{"type":"DELETE","lineNumber":305,"oldContent":"        onPressed: () {},"},{"type":"MODIFY","lineNumber":307,"content":"      floatingActionButton: FloatingActionButton(","oldContent":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":308,"content":"        onPressed: () {},"},{"type":"INSERT","lineNumber":309,"content":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":311,"oldContent":"      floatingActionButton: FloatingActionButton("},{"type":"MODIFY","lineNumber":321,"content":"            ),","oldContent":"            ),"}]},{"timestamp":1754650180416,"changes":[{"type":"INSERT","lineNumber":5,"content":"  final String label;"},{"type":"DELETE","lineNumber":6,"oldContent":""},{"type":"MODIFY","lineNumber":9,"content":"","oldContent":"  final String? imageUrl;"},{"type":"INSERT","lineNumber":10,"content":"class FamilyMember {"},{"type":"DELETE","lineNumber":12,"oldContent":"class FamilyMember {"},{"type":"INSERT","lineNumber":19,"content":"  });"},{"type":"DELETE","lineNumber":21,"oldContent":"  });"},{"type":"MODIFY","lineNumber":37,"content":"    QuickAction(icon: Icons.person_add, label: 'Add Member'),","oldContent":"    QuickAction(icon: Icons.more_horiz, label: 'More'),"},{"type":"INSERT","lineNumber":43,"content":"  Widget _buildQuickAction(QuickAction action) {"},{"type":"DELETE","lineNumber":44,"oldContent":"    return Column("},{"type":"INSERT","lineNumber":59,"content":"          ),"},{"type":"DELETE","lineNumber":60,"oldContent":"          child: Icon(action.icon, color: const Color(0xFF6A11CB), size: 24),"},{"type":"INSERT","lineNumber":63,"content":"        Text("},{"type":"DELETE","lineNumber":64,"oldContent":"          action.label,"},{"type":"INSERT","lineNumber":83,"content":"              decoration: BoxDecoration("},{"type":"DELETE","lineNumber":84,"oldContent":"                shape: BoxShape.circle,"},{"type":"MODIFY","lineNumber":148,"content":"  // Build welcome overlay with buttons","oldContent":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":149,"content":"  Widget _buildWelcomeOverlay() {"},{"type":"INSERT","lineNumber":150,"content":"    return Container("},{"type":"INSERT","lineNumber":151,"content":"      width: double.infinity,"},{"type":"INSERT","lineNumber":152,"content":"      padding: const EdgeInsets.all(24),"},{"type":"INSERT","lineNumber":153,"content":"      decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":154,"content":"        gradient: LinearGradient("},{"type":"INSERT","lineNumber":155,"content":"          begin: Alignment.topCenter,"},{"type":"INSERT","lineNumber":156,"content":"          end: Alignment.bottomCenter,"},{"type":"INSERT","lineNumber":157,"content":"          colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"INSERT","lineNumber":158,"content":"        ),"},{"type":"INSERT","lineNumber":159,"content":"      ),"},{"type":"INSERT","lineNumber":160,"content":"      child: SafeArea("},{"type":"INSERT","lineNumber":161,"content":"        child: Column("},{"type":"INSERT","lineNumber":162,"content":"          mainAxisSize: MainAxisSize.min,"},{"type":"INSERT","lineNumber":163,"content":"          children: ["},{"type":"INSERT","lineNumber":164,"content":"            // App Logo and Title"},{"type":"INSERT","lineNumber":165,"content":"            Column("},{"type":"INSERT","lineNumber":166,"content":"              children: ["},{"type":"INSERT","lineNumber":167,"content":"                const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":168,"content":"                Image.asset("},{"type":"INSERT","lineNumber":169,"content":"                  'assets/images/Frame 2608805.png',"},{"type":"INSERT","lineNumber":170,"content":"                  width: 150,"},{"type":"INSERT","lineNumber":171,"content":"                  height: 150,"},{"type":"INSERT","lineNumber":172,"content":"                ),"},{"type":"INSERT","lineNumber":173,"content":"                const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":174,"content":"                Text("},{"type":"INSERT","lineNumber":175,"content":"                  'Welcome to Family Tree',"},{"type":"INSERT","lineNumber":176,"content":"                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":177,"content":"                    color: Colors.white,"},{"type":"INSERT","lineNumber":178,"content":"                    fontSize: 24,"},{"type":"INSERT","lineNumber":179,"content":"                    fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":180,"content":"                  ),"},{"type":"INSERT","lineNumber":181,"content":"                ),"},{"type":"INSERT","lineNumber":182,"content":"                const SizedBox(height: 10),"},{"type":"INSERT","lineNumber":183,"content":"                Padding("},{"type":"INSERT","lineNumber":184,"content":"                  padding: const EdgeInsets.symmetric(horizontal: 40.0),"},{"type":"INSERT","lineNumber":185,"content":"                  child: Text("},{"type":"INSERT","lineNumber":186,"content":"                    'Connect with your family and create your family tree',"},{"type":"INSERT","lineNumber":187,"content":"                    textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":188,"content":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":189,"content":"                      color: Colors.white.withOpacity(0.8),"},{"type":"INSERT","lineNumber":190,"content":"                      fontSize: 16,"},{"type":"INSERT","lineNumber":191,"content":"                    ),"},{"type":"INSERT","lineNumber":192,"content":"                  ),"},{"type":"INSERT","lineNumber":193,"content":"                ),"},{"type":"INSERT","lineNumber":194,"content":"              ],"},{"type":"INSERT","lineNumber":195,"content":"            ),"},{"type":"INSERT","lineNumber":196,"content":"            const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":197,"content":"            // Join Now Button"},{"type":"INSERT","lineNumber":198,"content":"            SizedBox("},{"type":"INSERT","lineNumber":199,"content":"              width: double.infinity,"},{"type":"INSERT","lineNumber":200,"content":"              child: ElevatedButton("},{"type":"INSERT","lineNumber":201,"content":"                onPressed: () {"},{"type":"INSERT","lineNumber":202,"content":"                  // TODO: Navigate to join screen"},{"type":"INSERT","lineNumber":203,"content":"                },"},{"type":"INSERT","lineNumber":204,"content":"                style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":205,"content":"                  backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":206,"content":"                  foregroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":207,"content":"                  padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":208,"content":"                  shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":209,"content":"                    borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":210,"content":"                  ),"},{"type":"INSERT","lineNumber":211,"content":"                  elevation: 0,"},{"type":"INSERT","lineNumber":212,"content":"                ),"},{"type":"INSERT","lineNumber":213,"content":"                child: Text("},{"type":"INSERT","lineNumber":214,"content":"                  'Join Now',"},{"type":"INSERT","lineNumber":215,"content":"                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":216,"content":"                    fontSize: 16,"},{"type":"INSERT","lineNumber":217,"content":"                    fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":218,"content":"                  ),"},{"type":"INSERT","lineNumber":219,"content":"                ),"},{"type":"INSERT","lineNumber":220,"content":"              ),"},{"type":"INSERT","lineNumber":221,"content":"            ),"},{"type":"INSERT","lineNumber":222,"content":"            const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":223,"content":"            // Create Now Button"},{"type":"INSERT","lineNumber":224,"content":"            SizedBox("},{"type":"INSERT","lineNumber":225,"content":"              width: double.infinity,"},{"type":"INSERT","lineNumber":226,"content":"              child: OutlinedButton("},{"type":"INSERT","lineNumber":227,"content":"                onPressed: () {"},{"type":"INSERT","lineNumber":228,"content":"                  // TODO: Navigate to create screen"},{"type":"INSERT","lineNumber":229,"content":"                },"},{"type":"INSERT","lineNumber":230,"content":"                style: OutlinedButton.styleFrom("},{"type":"INSERT","lineNumber":231,"content":"                  side: const BorderSide(color: Colors.white, width: 2),"},{"type":"INSERT","lineNumber":232,"content":"                  padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":233,"content":"                  shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":234,"content":"                    borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":235,"content":"                  ),"},{"type":"INSERT","lineNumber":236,"content":"                ),"},{"type":"INSERT","lineNumber":237,"content":"                child: Text("},{"type":"INSERT","lineNumber":238,"content":"                  'Create Now',"},{"type":"INSERT","lineNumber":239,"content":"                  style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":240,"content":"                    color: Colors.white,"},{"type":"INSERT","lineNumber":241,"content":"                    fontSize: 16,"},{"type":"INSERT","lineNumber":242,"content":"                    fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":243,"content":"                  ),"},{"type":"INSERT","lineNumber":244,"content":"                ),"},{"type":"INSERT","lineNumber":245,"content":"              ),"},{"type":"INSERT","lineNumber":246,"content":"            ),"},{"type":"INSERT","lineNumber":247,"content":"            const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":248,"content":"            // Already have an account"},{"type":"INSERT","lineNumber":249,"content":"            TextButton("},{"type":"INSERT","lineNumber":250,"content":"              onPressed: () {"},{"type":"INSERT","lineNumber":251,"content":"                // TODO: Navigate to login screen"},{"type":"INSERT","lineNumber":252,"content":"              },"},{"type":"INSERT","lineNumber":253,"content":"              child: Text("},{"type":"INSERT","lineNumber":254,"content":"                'Already have an account? Sign In',"},{"type":"INSERT","lineNumber":255,"content":"                style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":256,"content":"                  color: Colors.white,"},{"type":"INSERT","lineNumber":257,"content":"                  fontSize: 14,"},{"type":"INSERT","lineNumber":258,"content":"                  decoration: TextDecoration.underline,"},{"type":"INSERT","lineNumber":259,"content":"                ),"},{"type":"INSERT","lineNumber":260,"content":"              ),"},{"type":"INSERT","lineNumber":261,"content":"            ),"},{"type":"INSERT","lineNumber":262,"content":"            const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":263,"content":"          ],"},{"type":"INSERT","lineNumber":264,"content":"        ),"},{"type":"INSERT","lineNumber":265,"content":"      ),"},{"type":"INSERT","lineNumber":266,"content":"    );"},{"type":"INSERT","lineNumber":267,"content":"  }"},{"type":"INSERT","lineNumber":268,"content":""},{"type":"INSERT","lineNumber":270,"content":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":151,"oldContent":"        backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":153,"oldContent":"        elevation: 1,"},{"type":"INSERT","lineNumber":273,"content":"      body: Stack("},{"type":"INSERT","lineNumber":274,"content":"        children: ["},{"type":"INSERT","lineNumber":275,"content":"          // Main content"},{"type":"INSERT","lineNumber":276,"content":"          SingleChildScrollView("},{"type":"INSERT","lineNumber":277,"content":"            child: Column("},{"type":"INSERT","lineNumber":278,"content":"              children: ["},{"type":"INSERT","lineNumber":279,"content":"                // Welcome overlay (takes full height if no user, otherwise hidden)"},{"type":"INSERT","lineNumber":280,"content":"                _buildWelcomeOverlay(),"},{"type":"INSERT","lineNumber":281,"content":"                // Rest of your home screen content"},{"type":"INSERT","lineNumber":283,"content":"        backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":284,"content":"        elevation: 1,"},{"type":"INSERT","lineNumber":307,"content":"                color: Colors.black,"},{"type":"DELETE","lineNumber":178,"oldContent":"              ),"},{"type":"DELETE","lineNumber":181,"oldContent":"          IconButton("},{"type":"DELETE","lineNumber":183,"oldContent":"            icon: const Icon(Icons.notifications_none, color: Colors.black87, size: 28),"},{"type":"INSERT","lineNumber":313,"content":"          IconButton("},{"type":"INSERT","lineNumber":314,"content":"            icon: const Icon(Icons.notifications_none, color: Colors.black87, size: 28),"},{"type":"INSERT","lineNumber":359,"content":"              child: Row("},{"type":"DELETE","lineNumber":231,"oldContent":"              child: Row("},{"type":"INSERT","lineNumber":368,"content":"              child: Row("},{"type":"DELETE","lineNumber":239,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"INSERT","lineNumber":377,"content":"                  ),"},{"type":"DELETE","lineNumber":248,"oldContent":"                  TextButton("},{"type":"DELETE","lineNumber":251,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":253,"oldContent":"                        fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":382,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":384,"content":"                        fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":262,"oldContent":"              height: 220,"},{"type":"INSERT","lineNumber":393,"content":"            Container("},{"type":"INSERT","lineNumber":394,"content":"              height: 220,"},{"type":"DELETE","lineNumber":266,"oldContent":"            Container("},{"type":"INSERT","lineNumber":420,"content":"                  // Middle row (you)"},{"type":"DELETE","lineNumber":291,"oldContent":"                  _buildFamilyMember('You', 'Your Name', 0.3, isYou: true),"},{"type":"INSERT","lineNumber":429,"content":"                    ],"},{"type":"DELETE","lineNumber":300,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":436,"content":"      ),"},{"type":"DELETE","lineNumber":308,"oldContent":"      ),"},{"type":"DELETE","lineNumber":313,"oldContent":"      bottomNavigationBar: Container("},{"type":"DELETE","lineNumber":314,"oldContent":"        decoration: BoxDecoration("},{"type":"DELETE","lineNumber":315,"oldContent":"          boxShadow: ["},{"type":"DELETE","lineNumber":316,"oldContent":"            BoxShadow("},{"type":"DELETE","lineNumber":317,"oldContent":"              color: Colors.grey.withOpacity(0.2),"},{"type":"DELETE","lineNumber":318,"oldContent":"              spreadRadius: 1,"},{"type":"DELETE","lineNumber":319,"oldContent":"              blurRadius: 5,"},{"type":"INSERT","lineNumber":443,"content":"              ],"},{"type":"INSERT","lineNumber":445,"content":"          ),"},{"type":"INSERT","lineNumber":446,"content":"          // Bottom Navigation"},{"type":"INSERT","lineNumber":447,"content":"          Positioned("},{"type":"INSERT","lineNumber":448,"content":"            left: 0,"},{"type":"INSERT","lineNumber":449,"content":"            right: 0,"},{"type":"INSERT","lineNumber":450,"content":"            bottom: 0,"},{"type":"INSERT","lineNumber":451,"content":"            child: Container("},{"type":"INSERT","lineNumber":452,"content":"              decoration: BoxDecoration("},{"type":"INSERT","lineNumber":453,"content":"                boxShadow: ["},{"type":"INSERT","lineNumber":454,"content":"                  BoxShadow("},{"type":"INSERT","lineNumber":455,"content":"                    color: Colors.grey.withOpacity(0.2),"},{"type":"INSERT","lineNumber":456,"content":"                    spreadRadius: 1,"},{"type":"INSERT","lineNumber":457,"content":"                    blurRadius: 5,"},{"type":"INSERT","lineNumber":458,"content":"                    offset: const Offset(0, -2),"},{"type":"INSERT","lineNumber":459,"content":"                  ),"},{"type":"INSERT","lineNumber":460,"content":"                ],"},{"type":"INSERT","lineNumber":461,"content":"              ),"},{"type":"INSERT","lineNumber":462,"content":"              child: BottomAppBar("},{"type":"INSERT","lineNumber":463,"content":"                height: 70,"},{"type":"INSERT","lineNumber":464,"content":"                color: Colors.white,"},{"type":"INSERT","lineNumber":465,"content":"                shape: const CircularNotchedRectangle(),"},{"type":"INSERT","lineNumber":466,"content":"                notchMargin: 10,"},{"type":"INSERT","lineNumber":467,"content":"                child: Row("},{"type":"INSERT","lineNumber":468,"content":"                  mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"INSERT","lineNumber":469,"content":"                  children: ["},{"type":"INSERT","lineNumber":470,"content":"                    _buildNavItem(Icons.home_filled, 'Home', isSelected: true),"},{"type":"INSERT","lineNumber":471,"content":"                    _buildNavItem(Icons.family_restroom, 'Family'),"},{"type":"INSERT","lineNumber":472,"content":"                    const SizedBox(width: 40), // Space for FAB"},{"type":"INSERT","lineNumber":473,"content":"                    _buildNavItem(Icons.chat_bubble_outline, 'Chat'),"},{"type":"INSERT","lineNumber":474,"content":"                    _buildNavItem(Icons.person_outline, 'Profile'),"},{"type":"INSERT","lineNumber":475,"content":"                  ],"},{"type":"INSERT","lineNumber":476,"content":"                ),"},{"type":"INSERT","lineNumber":477,"content":"              ),"},{"type":"DELETE","lineNumber":322,"oldContent":"          ],"},{"type":"DELETE","lineNumber":323,"oldContent":"        ),"},{"type":"DELETE","lineNumber":324,"oldContent":"        child: BottomAppBar("},{"type":"DELETE","lineNumber":325,"oldContent":"          height: 70,"},{"type":"DELETE","lineNumber":326,"oldContent":"          color: Colors.white,"},{"type":"DELETE","lineNumber":327,"oldContent":"          shape: const CircularNotchedRectangle(),"},{"type":"DELETE","lineNumber":328,"oldContent":"          notchMargin: 10,"},{"type":"DELETE","lineNumber":329,"oldContent":"          child: Row("},{"type":"DELETE","lineNumber":330,"oldContent":"            mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"DELETE","lineNumber":331,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":332,"oldContent":"              _buildNavItem(Icons.home_filled, 'Home', isSelected: true),"},{"type":"DELETE","lineNumber":333,"oldContent":"              _buildNavItem(Icons.family_restroom, 'Family'),"},{"type":"DELETE","lineNumber":334,"oldContent":"              const SizedBox(width: 40), // Space for FAB"},{"type":"DELETE","lineNumber":335,"oldContent":"              _buildNavItem(Icons.chat_bubble_outline, 'Chat'),"},{"type":"DELETE","lineNumber":336,"oldContent":"              _buildNavItem(Icons.person_outline, 'Profile'),"},{"type":"DELETE","lineNumber":337,"oldContent":"            ],"},{"type":"DELETE","lineNumber":339,"oldContent":"        ),"},{"type":"INSERT","lineNumber":480,"content":"          // Floating Action Button"},{"type":"INSERT","lineNumber":481,"content":"          Positioned("},{"type":"INSERT","lineNumber":482,"content":"            left: 0,"},{"type":"INSERT","lineNumber":483,"content":"            right: 0,"},{"type":"INSERT","lineNumber":484,"content":"            bottom: 25,"},{"type":"INSERT","lineNumber":485,"content":"            child: FloatingActionButton("},{"type":"INSERT","lineNumber":486,"content":"              onPressed: () {},"},{"type":"INSERT","lineNumber":487,"content":"              backgroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":488,"content":"              child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"INSERT","lineNumber":489,"content":"            ),"},{"type":"INSERT","lineNumber":490,"content":"          ),"},{"type":"INSERT","lineNumber":491,"content":"        ],"}]},{"timestamp":1754650435569,"changes":[{"type":"DELETE","lineNumber":3,"oldContent":"class QuickAction {"},{"type":"DELETE","lineNumber":4,"oldContent":"  final IconData icon;"},{"type":"DELETE","lineNumber":5,"oldContent":"  final String label;"},{"type":"DELETE","lineNumber":6,"oldContent":""},{"type":"DELETE","lineNumber":7,"oldContent":"  const QuickAction({required this.icon, required this.label});"},{"type":"DELETE","lineNumber":8,"oldContent":"}"},{"type":"DELETE","lineNumber":9,"oldContent":""},{"type":"DELETE","lineNumber":10,"oldContent":"class FamilyMember {"},{"type":"DELETE","lineNumber":11,"oldContent":"  final String name;"},{"type":"DELETE","lineNumber":12,"oldContent":"  final String? imageUrl;"},{"type":"DELETE","lineNumber":13,"oldContent":"  final String relation;"},{"type":"DELETE","lineNumber":14,"oldContent":""},{"type":"DELETE","lineNumber":15,"oldContent":"  FamilyMember({"},{"type":"DELETE","lineNumber":16,"oldContent":"    required this.name,"},{"type":"DELETE","lineNumber":17,"oldContent":"    this.imageUrl,"},{"type":"DELETE","lineNumber":18,"oldContent":"    required this.relation,"},{"type":"DELETE","lineNumber":19,"oldContent":"  });"},{"type":"DELETE","lineNumber":20,"oldContent":"}"},{"type":"DELETE","lineNumber":21,"oldContent":""},{"type":"DELETE","lineNumber":25,"oldContent":"  // Sample family members data"},{"type":"DELETE","lineNumber":26,"oldContent":"  static final List<FamilyMember> familyMembers = ["},{"type":"DELETE","lineNumber":27,"oldContent":"    FamilyMember(name: 'You', relation: 'Me'),"},{"type":"DELETE","lineNumber":28,"oldContent":"    FamilyMember(name: 'John', relation: 'Father'),"},{"type":"DELETE","lineNumber":29,"oldContent":"    FamilyMember(name: 'Sarah', relation: 'Mother'),"},{"type":"DELETE","lineNumber":30,"oldContent":"    FamilyMember(name: 'Mike', relation: 'Brother'),"},{"type":"DELETE","lineNumber":31,"oldContent":"    FamilyMember(name: 'Emma', relation: 'Sister'),"},{"type":"DELETE","lineNumber":32,"oldContent":"  ];"},{"type":"DELETE","lineNumber":33,"oldContent":""},{"type":"DELETE","lineNumber":34,"oldContent":"  // Quick action items"},{"type":"DELETE","lineNumber":35,"oldContent":"  static const List<QuickAction> quickActions = ["},{"type":"DELETE","lineNumber":36,"oldContent":"    QuickAction(icon: Icons.family_restroom, label: 'Family'),"},{"type":"DELETE","lineNumber":37,"oldContent":"    QuickAction(icon: Icons.person_add, label: 'Add Member'),"},{"type":"DELETE","lineNumber":38,"oldContent":"    QuickAction(icon: Icons.search, label: 'Search'),"},{"type":"DELETE","lineNumber":39,"oldContent":"    QuickAction(icon: Icons.more_horiz, label: 'More'),"},{"type":"DELETE","lineNumber":40,"oldContent":"  ];"},{"type":"DELETE","lineNumber":41,"oldContent":""},{"type":"DELETE","lineNumber":42,"oldContent":"  // Build quick action button"},{"type":"DELETE","lineNumber":43,"oldContent":"  Widget _buildQuickAction(QuickAction action) {"},{"type":"DELETE","lineNumber":44,"oldContent":"    return Column("},{"type":"DELETE","lineNumber":45,"oldContent":"      mainAxisSize: MainAxisSize.min,"},{"type":"DELETE","lineNumber":46,"oldContent":"      children: ["},{"type":"DELETE","lineNumber":47,"oldContent":"        Container("},{"type":"DELETE","lineNumber":48,"oldContent":"          padding: const EdgeInsets.all(12),"},{"type":"DELETE","lineNumber":49,"oldContent":"          decoration: BoxDecoration("},{"type":"DELETE","lineNumber":50,"oldContent":"            color: Colors.white,"},{"type":"DELETE","lineNumber":51,"oldContent":"            shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":52,"oldContent":"            boxShadow: ["},{"type":"DELETE","lineNumber":53,"oldContent":"              BoxShadow("},{"type":"DELETE","lineNumber":54,"oldContent":"                color: Colors.grey.withOpacity(0.2),"},{"type":"DELETE","lineNumber":55,"oldContent":"                blurRadius: 5,"},{"type":"DELETE","lineNumber":56,"oldContent":"                offset: const Offset(0, 2),"},{"type":"DELETE","lineNumber":57,"oldContent":"              ),"},{"type":"DELETE","lineNumber":58,"oldContent":"            ],"},{"type":"INSERT","lineNumber":6,"content":"  // Build welcome screen with buttons"},{"type":"INSERT","lineNumber":7,"content":"  Widget _buildWelcomeScreen() {"},{"type":"INSERT","lineNumber":8,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":9,"content":"      body: Container("},{"type":"INSERT","lineNumber":10,"content":"        width: double.infinity,"},{"type":"INSERT","lineNumber":11,"content":"        padding: const EdgeInsets.all(24),"},{"type":"INSERT","lineNumber":12,"content":"        decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":13,"content":"          gradient: LinearGradient("},{"type":"INSERT","lineNumber":14,"content":"            begin: Alignment.topCenter,"},{"type":"INSERT","lineNumber":15,"content":"            end: Alignment.bottomCenter,"},{"type":"INSERT","lineNumber":16,"content":"            colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"DELETE","lineNumber":60,"oldContent":"          child: Icon(action.icon, color: const Color(0xFF6A11CB), size: 24),"},{"type":"DELETE","lineNumber":62,"oldContent":"        const SizedBox(height: 6),"},{"type":"DELETE","lineNumber":63,"oldContent":"        Text("},{"type":"DELETE","lineNumber":64,"oldContent":"          action.label,"},{"type":"DELETE","lineNumber":65,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":66,"oldContent":"            fontSize: 12,"},{"type":"DELETE","lineNumber":67,"oldContent":"            color: Colors.grey[700],"},{"type":"DELETE","lineNumber":68,"oldContent":"          ),"},{"type":"DELETE","lineNumber":69,"oldContent":"        ),"},{"type":"DELETE","lineNumber":70,"oldContent":"      ],"},{"type":"DELETE","lineNumber":71,"oldContent":"    );"},{"type":"DELETE","lineNumber":72,"oldContent":"  }"},{"type":"DELETE","lineNumber":73,"oldContent":""},{"type":"DELETE","lineNumber":74,"oldContent":"  // Build family member widget"},{"type":"DELETE","lineNumber":75,"oldContent":"  Widget _buildFamilyMember(String relation, String name, double size, {bool isYou = false}) {"},{"type":"DELETE","lineNumber":76,"oldContent":"    return Column("},{"type":"DELETE","lineNumber":77,"oldContent":"      children: ["},{"type":"DELETE","lineNumber":78,"oldContent":"        Stack("},{"type":"DELETE","lineNumber":79,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":80,"oldContent":"            Container("},{"type":"DELETE","lineNumber":81,"oldContent":"              width: 60 * size,"},{"type":"DELETE","lineNumber":82,"oldContent":"              height: 60 * size,"},{"type":"DELETE","lineNumber":83,"oldContent":"              decoration: BoxDecoration("},{"type":"DELETE","lineNumber":84,"oldContent":"                shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":85,"oldContent":"                color: isYou ? const Color(0xFF6A11CB) : Colors.grey[200],"},{"type":"INSERT","lineNumber":19,"content":"        child: SafeArea("},{"type":"INSERT","lineNumber":20,"content":"          child: Column("},{"type":"INSERT","lineNumber":21,"content":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":22,"content":"            children: ["},{"type":"INSERT","lineNumber":23,"content":"              // App Logo and Title"},{"type":"INSERT","lineNumber":24,"content":"              Column("},{"type":"INSERT","lineNumber":25,"content":"                children: ["},{"type":"INSERT","lineNumber":26,"content":"                  Image.asset("},{"type":"INSERT","lineNumber":27,"content":"                    'assets/images/Frame 2608805.png',"},{"type":"INSERT","lineNumber":28,"content":"                    width: 150,"},{"type":"INSERT","lineNumber":29,"content":"                    height: 150,"},{"type":"INSERT","lineNumber":30,"content":"                  ),"},{"type":"INSERT","lineNumber":31,"content":"                  const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":32,"content":"                  Text("},{"type":"INSERT","lineNumber":33,"content":"                    'Welcome to Family Tree',"},{"type":"INSERT","lineNumber":34,"content":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":35,"content":"                      color: Colors.white,"},{"type":"INSERT","lineNumber":36,"content":"                      fontSize: 24,"},{"type":"INSERT","lineNumber":37,"content":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":38,"content":"                    ),"},{"type":"INSERT","lineNumber":39,"content":"                  ),"},{"type":"INSERT","lineNumber":40,"content":"                  const SizedBox(height: 10),"},{"type":"INSERT","lineNumber":41,"content":"                  Padding("},{"type":"INSERT","lineNumber":42,"content":"                    padding: const EdgeInsets.symmetric(horizontal: 40.0),"},{"type":"INSERT","lineNumber":43,"content":"                    child: Text("},{"type":"INSERT","lineNumber":44,"content":"                      'Connect with your family and create your family tree',"},{"type":"INSERT","lineNumber":45,"content":"                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":46,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":47,"content":"                        color: Colors.white.withOpacity(0.8),"},{"type":"INSERT","lineNumber":48,"content":"                        fontSize: 16,"},{"type":"INSERT","lineNumber":49,"content":"                      ),"},{"type":"INSERT","lineNumber":50,"content":"                    ),"},{"type":"INSERT","lineNumber":51,"content":"                  ),"},{"type":"INSERT","lineNumber":52,"content":"                ],"},{"type":"DELETE","lineNumber":87,"oldContent":"              child: isYou "},{"type":"DELETE","lineNumber":88,"oldContent":"                  ? const Icon(Icons.person, color: Colors.white, size: 30)"},{"type":"DELETE","lineNumber":89,"oldContent":"                  : null,"},{"type":"DELETE","lineNumber":90,"oldContent":"            ),"},{"type":"DELETE","lineNumber":91,"oldContent":"            if (isYou)"},{"type":"DELETE","lineNumber":92,"oldContent":"              Positioned("},{"type":"DELETE","lineNumber":93,"oldContent":"                right: 0,"},{"type":"DELETE","lineNumber":94,"oldContent":"                bottom: 0,"},{"type":"DELETE","lineNumber":95,"oldContent":"                child: Container("},{"type":"DELETE","lineNumber":96,"oldContent":"                  padding: const EdgeInsets.all(4),"},{"type":"DELETE","lineNumber":97,"oldContent":"                  decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":54,"content":"              const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":55,"content":"              // Join Now Button"},{"type":"INSERT","lineNumber":56,"content":"              SizedBox("},{"type":"INSERT","lineNumber":57,"content":"                width: double.infinity,"},{"type":"INSERT","lineNumber":58,"content":"                child: ElevatedButton("},{"type":"INSERT","lineNumber":59,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":60,"content":"                    // TODO: Navigate to join screen"},{"type":"INSERT","lineNumber":61,"content":"                  },"},{"type":"INSERT","lineNumber":62,"content":"                  style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":63,"content":"                    backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":64,"content":"                    foregroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":65,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":66,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":67,"content":"                      borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":68,"content":"                    ),"},{"type":"INSERT","lineNumber":69,"content":"                    elevation: 0,"},{"type":"INSERT","lineNumber":70,"content":"                  ),"},{"type":"INSERT","lineNumber":71,"content":"                  child: Text("},{"type":"INSERT","lineNumber":72,"content":"                    'Join Now',"},{"type":"INSERT","lineNumber":73,"content":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":74,"content":"                      fontSize: 16,"},{"type":"INSERT","lineNumber":75,"content":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":76,"content":"                    ),"},{"type":"INSERT","lineNumber":77,"content":"                  ),"},{"type":"INSERT","lineNumber":78,"content":"                ),"},{"type":"INSERT","lineNumber":79,"content":"              ),"},{"type":"INSERT","lineNumber":80,"content":"              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":81,"content":"              // Create Now Button"},{"type":"INSERT","lineNumber":82,"content":"              SizedBox("},{"type":"INSERT","lineNumber":83,"content":"                width: double.infinity,"},{"type":"INSERT","lineNumber":84,"content":"                child: OutlinedButton("},{"type":"INSERT","lineNumber":85,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":86,"content":"                    // TODO: Navigate to create screen"},{"type":"INSERT","lineNumber":87,"content":"                  },"},{"type":"INSERT","lineNumber":88,"content":"                  style: OutlinedButton.styleFrom("},{"type":"INSERT","lineNumber":89,"content":"                    side: const BorderSide(color: Colors.white, width: 2),"},{"type":"INSERT","lineNumber":90,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":91,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":92,"content":"                      borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":93,"content":"                    ),"},{"type":"INSERT","lineNumber":94,"content":"                  ),"},{"type":"INSERT","lineNumber":95,"content":"                  child: Text("},{"type":"INSERT","lineNumber":96,"content":"                    'Create Now',"},{"type":"INSERT","lineNumber":97,"content":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":98,"content":"                      color: Colors.white,"},{"type":"INSERT","lineNumber":99,"content":"                      fontSize: 16,"},{"type":"INSERT","lineNumber":100,"content":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":101,"content":"                    ),"},{"type":"INSERT","lineNumber":102,"content":"                  ),"},{"type":"INSERT","lineNumber":103,"content":"                ),"},{"type":"INSERT","lineNumber":104,"content":"              ),"},{"type":"INSERT","lineNumber":105,"content":"              const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":106,"content":"              // Already have an account"},{"type":"INSERT","lineNumber":107,"content":"              TextButton("},{"type":"INSERT","lineNumber":108,"content":"                onPressed: () {"},{"type":"INSERT","lineNumber":109,"content":"                  // TODO: Navigate to login screen"},{"type":"INSERT","lineNumber":110,"content":"                },"},{"type":"INSERT","lineNumber":111,"content":"                child: Text("},{"type":"INSERT","lineNumber":112,"content":"                  'Already have an account? Sign In',"},{"type":"INSERT","lineNumber":113,"content":"                  style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":99,"oldContent":"                    shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":115,"content":"                    fontSize: 14,"},{"type":"INSERT","lineNumber":116,"content":"                    decoration: TextDecoration.underline,"},{"type":"DELETE","lineNumber":101,"oldContent":"                  child: const Icon(Icons.edit, size: 10, color: Color(0xFF6A11CB)),"},{"type":"DELETE","lineNumber":104,"oldContent":"          ],"},{"type":"DELETE","lineNumber":105,"oldContent":"        ),"},{"type":"DELETE","lineNumber":106,"oldContent":"        const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":107,"oldContent":"        Text("},{"type":"DELETE","lineNumber":108,"oldContent":"          name,"},{"type":"DELETE","lineNumber":109,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":110,"oldContent":"            fontSize: 12,"},{"type":"DELETE","lineNumber":111,"oldContent":"            fontWeight: FontWeight.w500,"},{"type":"INSERT","lineNumber":120,"content":"            ],"},{"type":"DELETE","lineNumber":114,"oldContent":"        Text("},{"type":"DELETE","lineNumber":115,"oldContent":"          relation,"},{"type":"DELETE","lineNumber":116,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":117,"oldContent":"            fontSize: 10,"},{"type":"DELETE","lineNumber":118,"oldContent":"            color: Colors.grey[600],"},{"type":"DELETE","lineNumber":119,"oldContent":"          ),"},{"type":"DELETE","lineNumber":120,"oldContent":"        ),"},{"type":"DELETE","lineNumber":121,"oldContent":"      ],"},{"type":"INSERT","lineNumber":123,"content":"      ),"},{"type":"DELETE","lineNumber":125,"oldContent":"  // Build navigation item"},{"type":"DELETE","lineNumber":126,"oldContent":"  Widget _buildNavItem(IconData icon, String label, {bool isSelected = false}) {"},{"type":"DELETE","lineNumber":127,"oldContent":"    return Column("},{"type":"DELETE","lineNumber":128,"oldContent":"      mainAxisSize: MainAxisSize.min,"},{"type":"DELETE","lineNumber":129,"oldContent":"      children: ["},{"type":"DELETE","lineNumber":130,"oldContent":"        Icon("},{"type":"DELETE","lineNumber":131,"oldContent":"          icon,"},{"type":"DELETE","lineNumber":132,"oldContent":"          color: isSelected ? const Color(0xFF6A11CB) : Colors.grey[600],"},{"type":"DELETE","lineNumber":133,"oldContent":"          size: 24,"},{"type":"DELETE","lineNumber":134,"oldContent":"        ),"},{"type":"DELETE","lineNumber":135,"oldContent":"        const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":136,"oldContent":"        Text("},{"type":"DELETE","lineNumber":137,"oldContent":"          label,"},{"type":"DELETE","lineNumber":138,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":139,"oldContent":"            fontSize: 10,"},{"type":"DELETE","lineNumber":140,"oldContent":"            color: isSelected ? const Color(0xFF6A11CB) : Colors.grey[600],"},{"type":"DELETE","lineNumber":141,"oldContent":"            fontWeight: isSelected ? FontWeight.w600 : FontWeight.normal,"},{"type":"DELETE","lineNumber":142,"oldContent":"          ),"},{"type":"DELETE","lineNumber":143,"oldContent":"        ),"},{"type":"DELETE","lineNumber":144,"oldContent":"      ],"},{"type":"DELETE","lineNumber":145,"oldContent":"    );"},{"type":"DELETE","lineNumber":146,"oldContent":"  }"},{"type":"DELETE","lineNumber":147,"oldContent":""},{"type":"DELETE","lineNumber":150,"oldContent":"  @override"},{"type":"DELETE","lineNumber":152,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":155,"oldContent":"      backgroundColor: Colors.grey[50],"},{"type":"DELETE","lineNumber":158,"oldContent":"      appBar: AppBar("},{"type":"DELETE","lineNumber":160,"oldContent":"        leading: Padding("},{"type":"DELETE","lineNumber":162,"oldContent":"          padding: const EdgeInsets.all(8.0),"},{"type":"DELETE","lineNumber":164,"oldContent":"          child: CircleAvatar("},{"type":"DELETE","lineNumber":166,"oldContent":"            backgroundColor: Colors.grey[200],"},{"type":"DELETE","lineNumber":168,"oldContent":"            child: const Icon(Icons.person, color: Colors.grey),"},{"type":"DELETE","lineNumber":170,"oldContent":"          ),"},{"type":"DELETE","lineNumber":172,"oldContent":"        ),"},{"type":"DELETE","lineNumber":174,"oldContent":"        title: Column("},{"type":"DELETE","lineNumber":176,"oldContent":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":178,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":180,"oldContent":"            Text("},{"type":"DELETE","lineNumber":182,"oldContent":"              'Hello,',"},{"type":"DELETE","lineNumber":184,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":186,"oldContent":"                fontSize: 14,"},{"type":"DELETE","lineNumber":188,"oldContent":"                color: Colors.grey[600],"},{"type":"DELETE","lineNumber":190,"oldContent":"              ),"},{"type":"DELETE","lineNumber":192,"oldContent":"            ),"},{"type":"DELETE","lineNumber":194,"oldContent":"            Text("},{"type":"DELETE","lineNumber":196,"oldContent":"              'John Doe',"},{"type":"DELETE","lineNumber":198,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":200,"oldContent":"                fontSize: 16,"},{"type":"DELETE","lineNumber":202,"oldContent":"                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":204,"oldContent":"              ),"},{"type":"DELETE","lineNumber":207,"oldContent":"            ),"},{"type":"DELETE","lineNumber":209,"oldContent":"          ],"},{"type":"DELETE","lineNumber":212,"oldContent":"        ),"},{"type":"DELETE","lineNumber":215,"oldContent":"        actions: ["},{"type":"DELETE","lineNumber":217,"oldContent":"            onPressed: () {},"},{"type":"DELETE","lineNumber":219,"oldContent":"          ),"},{"type":"DELETE","lineNumber":221,"oldContent":"        ],"},{"type":"DELETE","lineNumber":223,"oldContent":"      ),"},{"type":"DELETE","lineNumber":225,"oldContent":"      body: SingleChildScrollView("},{"type":"DELETE","lineNumber":227,"oldContent":"        child: Column("},{"type":"DELETE","lineNumber":229,"oldContent":"          crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":231,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":233,"oldContent":"            // Search Bar"},{"type":"DELETE","lineNumber":235,"oldContent":"            Padding("},{"type":"DELETE","lineNumber":237,"oldContent":"              padding: const EdgeInsets.all(16.0),"},{"type":"DELETE","lineNumber":239,"oldContent":"              child: Container("},{"type":"DELETE","lineNumber":241,"oldContent":"                padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"DELETE","lineNumber":243,"oldContent":"                decoration: BoxDecoration("},{"type":"DELETE","lineNumber":245,"oldContent":"                  color: Colors.white,"},{"type":"DELETE","lineNumber":247,"oldContent":"                  borderRadius: BorderRadius.circular(30),"},{"type":"DELETE","lineNumber":249,"oldContent":"                  border: Border.all(color: Colors.grey[300]!), "},{"type":"DELETE","lineNumber":251,"oldContent":"                  boxShadow: ["},{"type":"DELETE","lineNumber":253,"oldContent":"                    BoxShadow("},{"type":"DELETE","lineNumber":255,"oldContent":"                      color: Colors.grey.withOpacity(0.1),"},{"type":"DELETE","lineNumber":257,"oldContent":"                      blurRadius: 5,"},{"type":"DELETE","lineNumber":259,"oldContent":"                      offset: const Offset(0, 2),"},{"type":"DELETE","lineNumber":261,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":263,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":265,"oldContent":"                ),"},{"type":"DELETE","lineNumber":267,"oldContent":"                child: Row("},{"type":"DELETE","lineNumber":269,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":271,"oldContent":"                    const Icon(Icons.search, color: Colors.grey, size: 22),"},{"type":"DELETE","lineNumber":273,"oldContent":"                    const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":275,"oldContent":"                    Text("},{"type":"DELETE","lineNumber":277,"oldContent":"                      'Search...',"},{"type":"DELETE","lineNumber":279,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":281,"oldContent":"                        color: Colors.grey[500],"},{"type":"DELETE","lineNumber":283,"oldContent":"                        fontSize: 15,"},{"type":"DELETE","lineNumber":285,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":287,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":289,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":291,"oldContent":"                ),"},{"type":"DELETE","lineNumber":293,"oldContent":"              ),"},{"type":"DELETE","lineNumber":295,"oldContent":"            ),"},{"type":"DELETE","lineNumber":297,"oldContent":""},{"type":"DELETE","lineNumber":299,"oldContent":"            // Quick Actions"},{"type":"DELETE","lineNumber":301,"oldContent":"            Padding("},{"type":"DELETE","lineNumber":303,"oldContent":"              padding: const EdgeInsets.symmetric(horizontal: 16.0, vertical: 8),"},{"type":"DELETE","lineNumber":305,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"DELETE","lineNumber":307,"oldContent":"                children: quickActions.map((action) => _buildQuickAction(action)).toList(),"},{"type":"DELETE","lineNumber":310,"oldContent":"              ),"},{"type":"DELETE","lineNumber":312,"oldContent":"            ),"},{"type":"DELETE","lineNumber":314,"oldContent":""},{"type":"DELETE","lineNumber":316,"oldContent":"            // Family Tree Section"},{"type":"DELETE","lineNumber":318,"oldContent":"            Padding("},{"type":"DELETE","lineNumber":320,"oldContent":"              padding: const EdgeInsets.all(16.0),"},{"type":"DELETE","lineNumber":322,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceBetween,"},{"type":"DELETE","lineNumber":325,"oldContent":"                children: ["},{"type":"DELETE","lineNumber":327,"oldContent":"                  Text("},{"type":"DELETE","lineNumber":329,"oldContent":"                    'Your Family Tree',"},{"type":"DELETE","lineNumber":331,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":333,"oldContent":"                      fontSize: 18,"},{"type":"DELETE","lineNumber":335,"oldContent":"                      fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":337,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":339,"oldContent":"                  TextButton("},{"type":"DELETE","lineNumber":342,"oldContent":"                    onPressed: () {},"},{"type":"DELETE","lineNumber":344,"oldContent":"                    child: Text("},{"type":"DELETE","lineNumber":347,"oldContent":"                      'View All',"},{"type":"DELETE","lineNumber":350,"oldContent":"                        color: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":352,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":354,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":356,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":358,"oldContent":"                ],"},{"type":"DELETE","lineNumber":361,"oldContent":"              ),"},{"type":"DELETE","lineNumber":363,"oldContent":"            ),"},{"type":"DELETE","lineNumber":364,"oldContent":""},{"type":"DELETE","lineNumber":367,"oldContent":"            // Family Tree Visualization"},{"type":"DELETE","lineNumber":369,"oldContent":"              margin: const EdgeInsets.symmetric(horizontal: 16),"},{"type":"DELETE","lineNumber":371,"oldContent":"              padding: const EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":374,"oldContent":"              decoration: BoxDecoration("},{"type":"DELETE","lineNumber":376,"oldContent":"                color: Colors.white,"},{"type":"DELETE","lineNumber":377,"oldContent":"                borderRadius: BorderRadius.circular(16),"},{"type":"INSERT","lineNumber":248,"content":"  @override"},{"type":"DELETE","lineNumber":379,"oldContent":"                boxShadow: ["},{"type":"DELETE","lineNumber":380,"oldContent":"                  BoxShadow("},{"type":"DELETE","lineNumber":381,"oldContent":"                    color: Colors.grey.withOpacity(0.1),"},{"type":"DELETE","lineNumber":382,"oldContent":"      body: Stack("},{"type":"DELETE","lineNumber":383,"oldContent":"                    blurRadius: 10,"},{"type":"DELETE","lineNumber":384,"oldContent":"        children: ["},{"type":"DELETE","lineNumber":385,"oldContent":"                    offset: const Offset(0, 2),"},{"type":"DELETE","lineNumber":386,"oldContent":"          // Main content"},{"type":"DELETE","lineNumber":387,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":388,"oldContent":"          SingleChildScrollView("},{"type":"DELETE","lineNumber":389,"oldContent":"                ],"},{"type":"DELETE","lineNumber":390,"oldContent":"            child: Column("},{"type":"DELETE","lineNumber":391,"oldContent":"              ),"},{"type":"DELETE","lineNumber":392,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":393,"oldContent":"              child: Column("},{"type":"DELETE","lineNumber":394,"oldContent":"                // Welcome overlay (takes full height if no user, otherwise hidden)"},{"type":"DELETE","lineNumber":395,"oldContent":"                mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"DELETE","lineNumber":396,"oldContent":"                _buildWelcomeOverlay(),"},{"type":"DELETE","lineNumber":397,"oldContent":"                children: ["},{"type":"DELETE","lineNumber":398,"oldContent":"                // Rest of your home screen content"},{"type":"DELETE","lineNumber":399,"oldContent":"                  // Top row (parents)"},{"type":"DELETE","lineNumber":400,"oldContent":"                  Row("},{"type":"DELETE","lineNumber":401,"oldContent":"        backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":402,"oldContent":"                    mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"DELETE","lineNumber":403,"oldContent":"        elevation: 1,"},{"type":"DELETE","lineNumber":404,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":405,"oldContent":"                      _buildFamilyMember('Father', 'John', 0.2),"},{"type":"DELETE","lineNumber":406,"oldContent":"                      _buildFamilyMember('Mother', 'Sarah', 0.2),"},{"type":"DELETE","lineNumber":407,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":408,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":409,"oldContent":"                  "},{"type":"DELETE","lineNumber":410,"oldContent":"                  _buildFamilyMember('You', 'Your Name', 0.3, isYou: true),"},{"type":"DELETE","lineNumber":411,"oldContent":"                  "},{"type":"DELETE","lineNumber":412,"oldContent":"                  // Bottom row (siblings)"},{"type":"DELETE","lineNumber":413,"oldContent":"                  Row("},{"type":"DELETE","lineNumber":414,"oldContent":"                    mainAxisAlignment: MainAxisAlignment.spaceEvenly,"},{"type":"DELETE","lineNumber":415,"oldContent":"                    children: ["},{"type":"DELETE","lineNumber":416,"oldContent":"                      _buildFamilyMember('Brother', 'Mike', 0.2),"},{"type":"DELETE","lineNumber":417,"oldContent":"                      _buildFamilyMember('Sister', 'Emma', 0.2),"},{"type":"DELETE","lineNumber":418,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":419,"oldContent":"                ],"},{"type":"DELETE","lineNumber":420,"oldContent":"              ),"},{"type":"DELETE","lineNumber":421,"oldContent":"            ),"},{"type":"DELETE","lineNumber":422,"oldContent":"          ],"},{"type":"DELETE","lineNumber":423,"oldContent":"        ),"},{"type":"DELETE","lineNumber":424,"oldContent":"      floatingActionButton: FloatingActionButton("},{"type":"DELETE","lineNumber":425,"oldContent":"                color: Colors.black,"},{"type":"DELETE","lineNumber":426,"oldContent":"        onPressed: () {},"},{"type":"DELETE","lineNumber":427,"oldContent":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":428,"oldContent":"        child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"DELETE","lineNumber":429,"oldContent":"      ),"},{"type":"DELETE","lineNumber":430,"oldContent":"      floatingActionButtonLocation: FloatingActionButtonLocation.centerDocked,"},{"type":"DELETE","lineNumber":431,"oldContent":"          IconButton("},{"type":"DELETE","lineNumber":432,"oldContent":"            icon: const Icon(Icons.notifications_none, color: Colors.black87, size: 28),"},{"type":"DELETE","lineNumber":433,"oldContent":"            ),"},{"type":"DELETE","lineNumber":434,"oldContent":"            ),"},{"type":"DELETE","lineNumber":435,"oldContent":"          ),"},{"type":"DELETE","lineNumber":436,"oldContent":"      ),"},{"type":"DELETE","lineNumber":437,"oldContent":"    );"},{"type":"INSERT","lineNumber":250,"content":"    return _buildWelcomeScreen();"},{"type":"DELETE","lineNumber":441,"oldContent":"        ],"},{"type":"DELETE","lineNumber":442,"oldContent":"          ),"},{"type":"DELETE","lineNumber":443,"oldContent":"            ),"},{"type":"DELETE","lineNumber":444,"oldContent":"              child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"DELETE","lineNumber":445,"oldContent":"              backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":446,"oldContent":"              onPressed: () {},"},{"type":"DELETE","lineNumber":447,"oldContent":"            child: FloatingActionButton("},{"type":"DELETE","lineNumber":448,"oldContent":"            bottom: 25,"},{"type":"DELETE","lineNumber":449,"oldContent":"            right: 0,"},{"type":"DELETE","lineNumber":450,"oldContent":"            left: 0,"},{"type":"DELETE","lineNumber":451,"oldContent":"          Positioned("},{"type":"DELETE","lineNumber":452,"oldContent":"          // Floating Action Button"},{"type":"DELETE","lineNumber":453,"oldContent":"              ),"},{"type":"DELETE","lineNumber":454,"oldContent":"                ),"},{"type":"DELETE","lineNumber":455,"oldContent":"              child: Row("},{"type":"DELETE","lineNumber":456,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":457,"oldContent":"                    _buildNavItem(Icons.person_outline, 'Profile'),"},{"type":"DELETE","lineNumber":458,"oldContent":"                    _buildNavItem(Icons.chat_bubble_outline, 'Chat'),"},{"type":"DELETE","lineNumber":459,"oldContent":"                    const SizedBox(width: 40), // Space for FAB"},{"type":"DELETE","lineNumber":460,"oldContent":"                    _buildNavItem(Icons.family_restroom, 'Family'),"},{"type":"DELETE","lineNumber":461,"oldContent":"                    _buildNavItem(Icons.home_filled, 'Home', isSelected: true),"},{"type":"DELETE","lineNumber":462,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":463,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"DELETE","lineNumber":464,"oldContent":"                child: Row("},{"type":"DELETE","lineNumber":465,"oldContent":"              child: Row("},{"type":"DELETE","lineNumber":466,"oldContent":"                notchMargin: 10,"},{"type":"DELETE","lineNumber":467,"oldContent":"                shape: const CircularNotchedRectangle(),"},{"type":"DELETE","lineNumber":468,"oldContent":"                color: Colors.white,"},{"type":"DELETE","lineNumber":469,"oldContent":"                height: 70,"},{"type":"DELETE","lineNumber":470,"oldContent":"              child: BottomAppBar("},{"type":"DELETE","lineNumber":471,"oldContent":"              ),"},{"type":"DELETE","lineNumber":472,"oldContent":"                ],"},{"type":"DELETE","lineNumber":473,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":474,"oldContent":"                    offset: const Offset(0, -2),"},{"type":"DELETE","lineNumber":475,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":476,"oldContent":"                    blurRadius: 5,"},{"type":"DELETE","lineNumber":477,"oldContent":"                    spreadRadius: 1,"},{"type":"DELETE","lineNumber":478,"oldContent":"                    color: Colors.grey.withOpacity(0.2),"},{"type":"DELETE","lineNumber":479,"oldContent":"                  BoxShadow("},{"type":"DELETE","lineNumber":480,"oldContent":"                boxShadow: ["},{"type":"DELETE","lineNumber":481,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":482,"oldContent":"              decoration: BoxDecoration("},{"type":"DELETE","lineNumber":483,"oldContent":"            child: Container("},{"type":"DELETE","lineNumber":484,"oldContent":"                        fontWeight: FontWeight.w500,"},{"type":"DELETE","lineNumber":485,"oldContent":"            bottom: 0,"},{"type":"DELETE","lineNumber":486,"oldContent":"            right: 0,"},{"type":"DELETE","lineNumber":487,"oldContent":"            left: 0,"},{"type":"DELETE","lineNumber":488,"oldContent":"          Positioned("},{"type":"DELETE","lineNumber":489,"oldContent":"          // Bottom Navigation"},{"type":"DELETE","lineNumber":490,"oldContent":"          ),"},{"type":"DELETE","lineNumber":491,"oldContent":"              ],"},{"type":"DELETE","lineNumber":492,"oldContent":"      ),"},{"type":"DELETE","lineNumber":493,"oldContent":"                    ],"},{"type":"DELETE","lineNumber":494,"oldContent":"            Container("},{"type":"DELETE","lineNumber":495,"oldContent":"                  // Middle row (you)"},{"type":"DELETE","lineNumber":496,"oldContent":"              height: 220,"}]},{"timestamp":1754650625345,"changes":[{"type":"INSERT","lineNumber":3,"content":"class HomeScreen extends StatelessWidget {"},{"type":"INSERT","lineNumber":4,"content":"  const HomeScreen({Key? key}) : super(key: key);"},{"type":"INSERT","lineNumber":5,"content":""},{"type":"INSERT","lineNumber":17,"content":"          ),"},{"type":"INSERT","lineNumber":18,"content":"        ),"},{"type":"DELETE","lineNumber":18,"oldContent":"class HomeScreen extends StatelessWidget {"},{"type":"DELETE","lineNumber":20,"oldContent":"  const HomeScreen({Key? key}) : super(key: key);"},{"type":"DELETE","lineNumber":22,"oldContent":""},{"type":"INSERT","lineNumber":53,"content":"              ),"},{"type":"DELETE","lineNumber":57,"oldContent":"          ),"},{"type":"DELETE","lineNumber":60,"oldContent":"        ),"},{"type":"DELETE","lineNumber":86,"oldContent":"              ),"},{"type":"DELETE","lineNumber":99,"oldContent":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":102,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":106,"oldContent":"                ),"},{"type":"DELETE","lineNumber":108,"oldContent":"              ),"},{"type":"DELETE","lineNumber":117,"oldContent":"          ),"},{"type":"DELETE","lineNumber":119,"oldContent":"        ),"},{"type":"INSERT","lineNumber":114,"content":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":122,"oldContent":"            ],"},{"type":"DELETE","lineNumber":123,"oldContent":"    );"},{"type":"DELETE","lineNumber":124,"oldContent":"      ),"},{"type":"DELETE","lineNumber":125,"oldContent":"  }"},{"type":"DELETE","lineNumber":126,"oldContent":""},{"type":"DELETE","lineNumber":127,"oldContent":"  // Build welcome overlay with buttons"},{"type":"DELETE","lineNumber":128,"oldContent":"  Widget _buildWelcomeOverlay() {"},{"type":"DELETE","lineNumber":129,"oldContent":"    return Container("},{"type":"DELETE","lineNumber":130,"oldContent":"      width: double.infinity,"},{"type":"DELETE","lineNumber":131,"oldContent":"      padding: const EdgeInsets.all(24),"},{"type":"DELETE","lineNumber":132,"oldContent":"      decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":133,"oldContent":"        gradient: LinearGradient("},{"type":"DELETE","lineNumber":134,"oldContent":"          begin: Alignment.topCenter,"},{"type":"DELETE","lineNumber":135,"oldContent":"          end: Alignment.bottomCenter,"},{"type":"DELETE","lineNumber":136,"oldContent":"          colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"DELETE","lineNumber":137,"oldContent":"        ),"},{"type":"DELETE","lineNumber":138,"oldContent":"      ),"},{"type":"DELETE","lineNumber":139,"oldContent":"      child: SafeArea("},{"type":"DELETE","lineNumber":140,"oldContent":"        child: Column("},{"type":"DELETE","lineNumber":141,"oldContent":"          mainAxisSize: MainAxisSize.min,"},{"type":"DELETE","lineNumber":142,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":143,"oldContent":"            // App Logo and Title"},{"type":"DELETE","lineNumber":144,"oldContent":"            Column("},{"type":"DELETE","lineNumber":145,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":146,"oldContent":"                const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":147,"oldContent":"                Image.asset("},{"type":"DELETE","lineNumber":148,"oldContent":"                  'assets/images/Frame 2608805.png',"},{"type":"DELETE","lineNumber":149,"oldContent":"                  width: 150,"},{"type":"DELETE","lineNumber":150,"oldContent":"                  height: 150,"},{"type":"DELETE","lineNumber":151,"oldContent":"                ),"},{"type":"DELETE","lineNumber":152,"oldContent":"                const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":153,"oldContent":"                Text("},{"type":"DELETE","lineNumber":154,"oldContent":"                  'Welcome to Family Tree',"},{"type":"DELETE","lineNumber":155,"oldContent":"                  style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":156,"oldContent":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":157,"oldContent":"                    fontSize: 24,"},{"type":"DELETE","lineNumber":158,"oldContent":"                    fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":161,"oldContent":"                const SizedBox(height: 10),"},{"type":"DELETE","lineNumber":162,"oldContent":"                Padding("},{"type":"DELETE","lineNumber":163,"oldContent":"                  padding: const EdgeInsets.symmetric(horizontal: 40.0),"},{"type":"DELETE","lineNumber":164,"oldContent":"                  child: Text("},{"type":"DELETE","lineNumber":165,"oldContent":"                    'Connect with your family and create your family tree',"},{"type":"DELETE","lineNumber":166,"oldContent":"                    textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":167,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":168,"oldContent":"                      color: Colors.white.withOpacity(0.8),"},{"type":"DELETE","lineNumber":169,"oldContent":"                      fontSize: 16,"},{"type":"DELETE","lineNumber":170,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":171,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":172,"oldContent":"                ),"},{"type":"DELETE","lineNumber":173,"oldContent":"              ],"},{"type":"DELETE","lineNumber":174,"oldContent":"            ),"},{"type":"DELETE","lineNumber":175,"oldContent":"            const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":176,"oldContent":"            // Join Now Button"},{"type":"DELETE","lineNumber":177,"oldContent":"            SizedBox("},{"type":"DELETE","lineNumber":178,"oldContent":"              width: double.infinity,"},{"type":"DELETE","lineNumber":179,"oldContent":"              child: ElevatedButton("},{"type":"DELETE","lineNumber":180,"oldContent":"  @override"},{"type":"DELETE","lineNumber":181,"oldContent":"                onPressed: () {"},{"type":"DELETE","lineNumber":182,"oldContent":"    return _buildWelcomeScreen();"},{"type":"DELETE","lineNumber":183,"oldContent":"                  // TODO: Navigate to join screen"},{"type":"DELETE","lineNumber":184,"oldContent":"                },"},{"type":"DELETE","lineNumber":185,"oldContent":"                style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":186,"oldContent":"                  backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":187,"oldContent":"                  foregroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":188,"oldContent":"                  padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":189,"oldContent":"                  shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":190,"oldContent":"                    borderRadius: BorderRadius.circular(30),"},{"type":"DELETE","lineNumber":191,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":192,"oldContent":"                  elevation: 0,"},{"type":"DELETE","lineNumber":193,"oldContent":"                ),"},{"type":"DELETE","lineNumber":194,"oldContent":"                child: Text("},{"type":"DELETE","lineNumber":195,"oldContent":"                  'Join Now',"},{"type":"DELETE","lineNumber":196,"oldContent":"                  style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":197,"oldContent":"                    fontSize: 16,"},{"type":"DELETE","lineNumber":198,"oldContent":"                    fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":199,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":200,"oldContent":"                ),"},{"type":"DELETE","lineNumber":202,"oldContent":"            ),"},{"type":"DELETE","lineNumber":203,"oldContent":"            const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":204,"oldContent":"            // Create Now Button"},{"type":"DELETE","lineNumber":205,"oldContent":"            SizedBox("},{"type":"DELETE","lineNumber":206,"oldContent":"              width: double.infinity,"},{"type":"DELETE","lineNumber":207,"oldContent":"              child: OutlinedButton("},{"type":"DELETE","lineNumber":208,"oldContent":"                onPressed: () {"},{"type":"DELETE","lineNumber":209,"oldContent":"                  // TODO: Navigate to create screen"},{"type":"DELETE","lineNumber":210,"oldContent":"                },"},{"type":"DELETE","lineNumber":211,"oldContent":"                style: OutlinedButton.styleFrom("},{"type":"DELETE","lineNumber":212,"oldContent":"                  side: const BorderSide(color: Colors.white, width: 2),"},{"type":"DELETE","lineNumber":213,"oldContent":"                  padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":214,"oldContent":"                  shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":215,"oldContent":"                    borderRadius: BorderRadius.circular(30),"},{"type":"DELETE","lineNumber":216,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":217,"oldContent":"                ),"},{"type":"DELETE","lineNumber":218,"oldContent":"                child: Text("},{"type":"DELETE","lineNumber":219,"oldContent":"                  'Create Now',"},{"type":"DELETE","lineNumber":220,"oldContent":"                  style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":221,"oldContent":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":222,"oldContent":"                    fontSize: 16,"},{"type":"DELETE","lineNumber":223,"oldContent":"                    fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":224,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":225,"oldContent":"                ),"},{"type":"DELETE","lineNumber":226,"oldContent":"              ),"},{"type":"DELETE","lineNumber":227,"oldContent":"            ),"},{"type":"DELETE","lineNumber":228,"oldContent":"            const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":229,"oldContent":"            // Already have an account"},{"type":"DELETE","lineNumber":230,"oldContent":"            TextButton("},{"type":"DELETE","lineNumber":231,"oldContent":"              onPressed: () {"},{"type":"DELETE","lineNumber":232,"oldContent":"                // TODO: Navigate to login screen"},{"type":"DELETE","lineNumber":233,"oldContent":"              },"},{"type":"DELETE","lineNumber":234,"oldContent":"              child: Text("},{"type":"DELETE","lineNumber":235,"oldContent":"                'Already have an account? Sign In',"},{"type":"DELETE","lineNumber":236,"oldContent":"                style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":237,"oldContent":"                  color: Colors.white,"},{"type":"DELETE","lineNumber":238,"oldContent":"                  fontSize: 14,"},{"type":"DELETE","lineNumber":239,"oldContent":"                  decoration: TextDecoration.underline,"},{"type":"DELETE","lineNumber":240,"oldContent":"                ),"},{"type":"DELETE","lineNumber":241,"oldContent":"              ),"},{"type":"DELETE","lineNumber":242,"oldContent":"            ),"},{"type":"DELETE","lineNumber":243,"oldContent":"            const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":244,"oldContent":"          ],"},{"type":"INSERT","lineNumber":120,"content":"            ],"},{"type":"INSERT","lineNumber":121,"content":"          ),"},{"type":"INSERT","lineNumber":127,"content":""},{"type":"INSERT","lineNumber":128,"content":""},{"type":"INSERT","lineNumber":129,"content":"  @override"},{"type":"INSERT","lineNumber":131,"content":"    return _buildWelcomeScreen();"}]},{"timestamp":1754650858593,"changes":[{"type":"INSERT","lineNumber":2,"content":"import 'package:family_tree_firebase/features/family/presentation/screens/create_family_screen.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"  // Build welcome screen with buttons"},{"type":"MODIFY","lineNumber":7,"content":"  // Build welcome screen with buttons","oldContent":"  Widget _buildWelcomeScreen() {"},{"type":"INSERT","lineNumber":8,"content":"  Widget _buildWelcomeScreen() {"},{"type":"INSERT","lineNumber":18,"content":"          ),"},{"type":"INSERT","lineNumber":19,"content":"        ),"},{"type":"DELETE","lineNumber":20,"oldContent":"          ),"},{"type":"DELETE","lineNumber":22,"oldContent":"        ),"},{"type":"INSERT","lineNumber":54,"content":"              ),"},{"type":"DELETE","lineNumber":55,"oldContent":"              ),"},{"type":"DELETE","lineNumber":86,"oldContent":"                    // TODO: Navigate to create screen"},{"type":"INSERT","lineNumber":87,"content":"                    Navigator.push("},{"type":"INSERT","lineNumber":88,"content":"                      context,"},{"type":"INSERT","lineNumber":89,"content":"                      MaterialPageRoute("},{"type":"INSERT","lineNumber":90,"content":"                        builder: (context) => const CreateFamilyScreen(),"},{"type":"INSERT","lineNumber":91,"content":"                      ),"},{"type":"INSERT","lineNumber":92,"content":"                    );"},{"type":"DELETE","lineNumber":110,"oldContent":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":115,"oldContent":"            ],"},{"type":"INSERT","lineNumber":120,"content":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":117,"oldContent":"          ),"},{"type":"DELETE","lineNumber":119,"oldContent":""},{"type":"DELETE","lineNumber":120,"oldContent":""},{"type":"DELETE","lineNumber":121,"oldContent":"  @override"},{"type":"DELETE","lineNumber":122,"oldContent":"    return _buildWelcomeScreen();"},{"type":"INSERT","lineNumber":126,"content":"            ],"},{"type":"INSERT","lineNumber":127,"content":"          ),"},{"type":"INSERT","lineNumber":133,"content":""},{"type":"INSERT","lineNumber":134,"content":""},{"type":"INSERT","lineNumber":135,"content":"  @override"},{"type":"INSERT","lineNumber":137,"content":"    return _buildWelcomeScreen();"}]},{"timestamp":1754650919074,"changes":[{"type":"MODIFY","lineNumber":6,"content":"","oldContent":"  Widget _buildWelcomeScreen() {"},{"type":"DELETE","lineNumber":18,"oldContent":"        child: SafeArea("},{"type":"MODIFY","lineNumber":20,"content":"        child: SafeArea(","oldContent":"          child: Column("},{"type":"INSERT","lineNumber":21,"content":"          child: Column("},{"type":"MODIFY","lineNumber":55,"content":"              const SizedBox(height: 40),","oldContent":"              const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":83,"oldContent":"              SizedBox("},{"type":"DELETE","lineNumber":84,"oldContent":"                width: double.infinity,"},{"type":"DELETE","lineNumber":85,"oldContent":"                child: OutlinedButton("},{"type":"DELETE","lineNumber":86,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":87,"oldContent":"                    Navigator.push("},{"type":"DELETE","lineNumber":88,"oldContent":"                  },"},{"type":"DELETE","lineNumber":89,"oldContent":"                      context,"},{"type":"DELETE","lineNumber":90,"oldContent":"                  style: OutlinedButton.styleFrom("},{"type":"DELETE","lineNumber":91,"oldContent":"                      MaterialPageRoute("},{"type":"DELETE","lineNumber":92,"oldContent":"                    side: const BorderSide(color: Colors.white, width: 2),"},{"type":"DELETE","lineNumber":93,"oldContent":"                        builder: (context) => const CreateFamilyScreen(),"},{"type":"DELETE","lineNumber":94,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":83,"content":"              Builder("},{"type":"INSERT","lineNumber":84,"content":"                builder: (context) => SizedBox("},{"type":"INSERT","lineNumber":85,"content":"                  width: double.infinity,"},{"type":"INSERT","lineNumber":86,"content":"                  child: OutlinedButton("},{"type":"INSERT","lineNumber":87,"content":"                    onPressed: () {"},{"type":"INSERT","lineNumber":88,"content":"                      Navigator.push("},{"type":"INSERT","lineNumber":89,"content":"                        context,"},{"type":"INSERT","lineNumber":90,"content":"                        MaterialPageRoute("},{"type":"INSERT","lineNumber":91,"content":"                          builder: (context) => const CreateFamilyScreen(),"},{"type":"INSERT","lineNumber":92,"content":"                        ),"},{"type":"INSERT","lineNumber":93,"content":"                      );"},{"type":"INSERT","lineNumber":94,"content":"                    },"},{"type":"INSERT","lineNumber":95,"content":"                      style: OutlinedButton.styleFrom("},{"type":"INSERT","lineNumber":96,"content":"                        side: const BorderSide(color: Colors.white, width: 2),"},{"type":"INSERT","lineNumber":97,"content":"                        padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":98,"content":"                        shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":99,"content":"                          borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":100,"content":"                        ),"},{"type":"DELETE","lineNumber":96,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":97,"oldContent":"                    );"},{"type":"DELETE","lineNumber":98,"oldContent":"                      borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":102,"content":"                      child: Text("},{"type":"INSERT","lineNumber":103,"content":"                        'Create Now',"},{"type":"INSERT","lineNumber":104,"content":"                        style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":105,"content":"                          color: Colors.white,"},{"type":"INSERT","lineNumber":106,"content":"                          fontSize: 16,"},{"type":"INSERT","lineNumber":107,"content":"                          fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":108,"content":"                        ),"},{"type":"INSERT","lineNumber":109,"content":"                      ),"},{"type":"DELETE","lineNumber":101,"oldContent":"                  child: Text("},{"type":"DELETE","lineNumber":102,"oldContent":"                    'Create Now',"},{"type":"DELETE","lineNumber":103,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":104,"oldContent":"                      color: Colors.white,"},{"type":"DELETE","lineNumber":105,"oldContent":"                      fontSize: 16,"},{"type":"DELETE","lineNumber":106,"oldContent":"                      fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":107,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":108,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":110,"oldContent":"              ),"},{"type":"INSERT","lineNumber":122,"content":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":122,"oldContent":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":127,"oldContent":"        ),"},{"type":"INSERT","lineNumber":130,"content":"        ),"},{"type":"DELETE","lineNumber":133,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":134,"oldContent":"  }"},{"type":"DELETE","lineNumber":136,"oldContent":"}"},{"type":"MODIFY","lineNumber":138,"content":"  Widget build(BuildContext context) {","oldContent":""},{"type":"INSERT","lineNumber":140,"content":"  }"},{"type":"INSERT","lineNumber":141,"content":"}"},{"type":"INSERT","lineNumber":142,"content":""}]},{"timestamp":1754654794214,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:provider/provider.dart';","oldContent":"import 'package:family_tree_firebase/features/family/presentation/screens/create_family_screen.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_bloc.dart';"},{"type":"INSERT","lineNumber":4,"content":"import 'package:family_tree_firebase/features/posts/domain/models/post_model.dart';"},{"type":"INSERT","lineNumber":5,"content":"import 'package:family_tree_firebase/features/posts/data/services/post_service.dart';"},{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/stories/domain/models/story_model.dart';"},{"type":"INSERT","lineNumber":7,"content":"import 'package:family_tree_firebase/features/stories/data/services/story_service.dart';"},{"type":"DELETE","lineNumber":7,"oldContent":"  // Build welcome screen with buttons"},{"type":"DELETE","lineNumber":8,"oldContent":"  Widget _buildWelcomeScreen() {"},{"type":"INSERT","lineNumber":12,"content":"  final PostService _postService = PostService();"},{"type":"INSERT","lineNumber":13,"content":"  final StoryService _storyService = StoryService();"},{"type":"INSERT","lineNumber":14,"content":""},{"type":"INSERT","lineNumber":15,"content":"  @override"},{"type":"INSERT","lineNumber":16,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":17,"content":"    final authState = context.watch<AuthBloc>().state;"},{"type":"INSERT","lineNumber":18,"content":"    "},{"type":"INSERT","lineNumber":19,"content":"    // Show welcome screen if not authenticated"},{"type":"INSERT","lineNumber":20,"content":"    if (authState.status != AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":21,"content":"      return _buildWelcomeScreen();"},{"type":"INSERT","lineNumber":22,"content":"    }"},{"type":"INSERT","lineNumber":23,"content":""},{"type":"INSERT","lineNumber":24,"content":"    // Show home feed if authenticated"},{"type":"DELETE","lineNumber":10,"oldContent":"      body: Container("},{"type":"DELETE","lineNumber":11,"oldContent":"        width: double.infinity,"},{"type":"DELETE","lineNumber":12,"oldContent":"        padding: const EdgeInsets.all(24),"},{"type":"DELETE","lineNumber":13,"oldContent":"        decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":14,"oldContent":"          gradient: LinearGradient("},{"type":"DELETE","lineNumber":15,"oldContent":"            begin: Alignment.topCenter,"},{"type":"DELETE","lineNumber":16,"oldContent":"            end: Alignment.bottomCenter,"},{"type":"DELETE","lineNumber":17,"oldContent":"            colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"INSERT","lineNumber":26,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":27,"content":"        title: Text("},{"type":"INSERT","lineNumber":28,"content":"          'Family Feed',"},{"type":"INSERT","lineNumber":29,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":30,"content":"            fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":31,"content":"            color: Colors.black87,"},{"type":"DELETE","lineNumber":19,"oldContent":"        child: SafeArea("},{"type":"DELETE","lineNumber":20,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":22,"oldContent":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":23,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":24,"oldContent":"              // App Logo and Title"},{"type":"DELETE","lineNumber":25,"oldContent":"              Column("},{"type":"DELETE","lineNumber":26,"oldContent":"                children: ["},{"type":"DELETE","lineNumber":27,"oldContent":"                  Image.asset("},{"type":"DELETE","lineNumber":28,"oldContent":"                    'assets/images/Frame 2608805.png',"},{"type":"DELETE","lineNumber":29,"oldContent":"                    width: 150,"},{"type":"DELETE","lineNumber":30,"oldContent":"                    height: 150,"},{"type":"INSERT","lineNumber":34,"content":"        backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":35,"content":"        elevation: 0,"},{"type":"INSERT","lineNumber":36,"content":"      ),"},{"type":"INSERT","lineNumber":37,"content":"      body: SingleChildScrollView("},{"type":"INSERT","lineNumber":38,"content":"        child: Column("},{"type":"INSERT","lineNumber":39,"content":"          children: ["},{"type":"INSERT","lineNumber":40,"content":"            // Stories Section"},{"type":"INSERT","lineNumber":41,"content":"            _buildStoriesSection(),"},{"type":"INSERT","lineNumber":42,"content":"            const Divider(height: 1),"},{"type":"INSERT","lineNumber":43,"content":"            // Posts Feed"},{"type":"INSERT","lineNumber":44,"content":"            _buildPostsFeed(),"},{"type":"INSERT","lineNumber":45,"content":"          ],"},{"type":"INSERT","lineNumber":46,"content":"        ),"},{"type":"INSERT","lineNumber":47,"content":"      ),"},{"type":"INSERT","lineNumber":48,"content":"    );"},{"type":"INSERT","lineNumber":49,"content":"  }"},{"type":"INSERT","lineNumber":50,"content":""},{"type":"INSERT","lineNumber":51,"content":"  Widget _buildStoriesSection() {"},{"type":"INSERT","lineNumber":52,"content":"    return SizedBox("},{"type":"INSERT","lineNumber":53,"content":"      height: 100,"},{"type":"INSERT","lineNumber":54,"content":"      child: StreamBuilder<List<StoryModel>>("},{"type":"INSERT","lineNumber":55,"content":"        stream: _storyService.getFamilyStories(),"},{"type":"INSERT","lineNumber":56,"content":"        builder: (context, snapshot) {"},{"type":"INSERT","lineNumber":57,"content":"          if (snapshot.hasError) {"},{"type":"INSERT","lineNumber":58,"content":"            return Center(child: Text('Error loading stories'));"},{"type":"INSERT","lineNumber":59,"content":"          }"},{"type":"INSERT","lineNumber":60,"content":"          if (!snapshot.hasData) {"},{"type":"INSERT","lineNumber":61,"content":"            return const Center(child: CircularProgressIndicator());"},{"type":"INSERT","lineNumber":62,"content":"          }"},{"type":"INSERT","lineNumber":63,"content":"          final stories = snapshot.data!;"},{"type":"INSERT","lineNumber":64,"content":"          return ListView.builder("},{"type":"INSERT","lineNumber":65,"content":"            scrollDirection: Axis.horizontal,"},{"type":"INSERT","lineNumber":66,"content":"            itemCount: stories.length,"},{"type":"INSERT","lineNumber":67,"content":"            itemBuilder: (context, index) {"},{"type":"INSERT","lineNumber":68,"content":"              final story = stories[index];"},{"type":"INSERT","lineNumber":69,"content":"              return _buildStoryItem(story);"},{"type":"INSERT","lineNumber":70,"content":"            },"},{"type":"INSERT","lineNumber":71,"content":"          );"},{"type":"INSERT","lineNumber":72,"content":"        },"},{"type":"INSERT","lineNumber":73,"content":"      ),"},{"type":"INSERT","lineNumber":74,"content":"    );"},{"type":"INSERT","lineNumber":75,"content":"  }"},{"type":"INSERT","lineNumber":76,"content":""},{"type":"INSERT","lineNumber":77,"content":"  Widget _buildStoryItem(StoryModel story) {"},{"type":"INSERT","lineNumber":78,"content":"    return Padding("},{"type":"INSERT","lineNumber":79,"content":"      padding: const EdgeInsets.all(8.0),"},{"type":"INSERT","lineNumber":80,"content":"      child: Column("},{"type":"INSERT","lineNumber":81,"content":"        children: ["},{"type":"INSERT","lineNumber":82,"content":"          Container("},{"type":"INSERT","lineNumber":83,"content":"            width: 64,"},{"type":"INSERT","lineNumber":84,"content":"            height: 64,"},{"type":"INSERT","lineNumber":85,"content":"            decoration: BoxDecoration("},{"type":"INSERT","lineNumber":86,"content":"              shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":87,"content":"              border: Border.all("},{"type":"INSERT","lineNumber":88,"content":"                color: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":89,"content":"                width: 2,"},{"type":"INSERT","lineNumber":90,"content":"              ),"},{"type":"INSERT","lineNumber":91,"content":"              image: story.imageUrl != null"},{"type":"INSERT","lineNumber":92,"content":"                  ? DecorationImage("},{"type":"INSERT","lineNumber":93,"content":"                      image: NetworkImage(story.imageUrl!),"},{"type":"INSERT","lineNumber":94,"content":"                      fit: BoxFit.cover,"},{"type":"INSERT","lineNumber":95,"content":"                    )"},{"type":"INSERT","lineNumber":96,"content":"                  : null,"},{"type":"INSERT","lineNumber":97,"content":"            ),"},{"type":"INSERT","lineNumber":98,"content":"            child: story.imageUrl == null"},{"type":"INSERT","lineNumber":99,"content":"                ? const Icon(Icons.person, size: 30)"},{"type":"INSERT","lineNumber":100,"content":"                : null,"},{"type":"INSERT","lineNumber":101,"content":"          ),"},{"type":"INSERT","lineNumber":102,"content":"          const SizedBox(height: 4),"},{"type":"INSERT","lineNumber":103,"content":"          Text("},{"type":"INSERT","lineNumber":104,"content":"            story.userName.split(' ')[0],"},{"type":"INSERT","lineNumber":105,"content":"            style: GoogleFonts.poppins(fontSize: 12),"},{"type":"INSERT","lineNumber":106,"content":"          ),"},{"type":"INSERT","lineNumber":107,"content":"        ],"},{"type":"INSERT","lineNumber":108,"content":"      ),"},{"type":"INSERT","lineNumber":109,"content":"    );"},{"type":"INSERT","lineNumber":110,"content":"  }"},{"type":"INSERT","lineNumber":111,"content":""},{"type":"INSERT","lineNumber":112,"content":"  Widget _buildPostsFeed() {"},{"type":"INSERT","lineNumber":113,"content":"    return StreamBuilder<List<PostModel>>("},{"type":"INSERT","lineNumber":114,"content":"      stream: _postService.getFamilyPosts('familyId'), // TODO: Get actual familyId"},{"type":"INSERT","lineNumber":115,"content":"      builder: (context, snapshot) {"},{"type":"INSERT","lineNumber":116,"content":"        if (snapshot.hasError) {"},{"type":"INSERT","lineNumber":117,"content":"          return Center(child: Text('Error loading posts'));"},{"type":"INSERT","lineNumber":118,"content":"        }"},{"type":"INSERT","lineNumber":119,"content":"        if (!snapshot.hasData) {"},{"type":"INSERT","lineNumber":120,"content":"          return const Center(child: CircularProgressIndicator());"},{"type":"INSERT","lineNumber":121,"content":"        }"},{"type":"INSERT","lineNumber":122,"content":"        final posts = snapshot.data!;"},{"type":"INSERT","lineNumber":123,"content":"        return ListView.builder("},{"type":"INSERT","lineNumber":124,"content":"          shrinkWrap: true,"},{"type":"INSERT","lineNumber":125,"content":"          physics: const NeverScrollableScrollPhysics(),"},{"type":"INSERT","lineNumber":126,"content":"          itemCount: posts.length,"},{"type":"INSERT","lineNumber":127,"content":"          itemBuilder: (context, index) {"},{"type":"INSERT","lineNumber":128,"content":"            return _buildPostItem(posts[index]);"},{"type":"INSERT","lineNumber":129,"content":"          },"},{"type":"INSERT","lineNumber":130,"content":"        );"},{"type":"INSERT","lineNumber":131,"content":"      },"},{"type":"INSERT","lineNumber":132,"content":"    );"},{"type":"INSERT","lineNumber":133,"content":"  }"},{"type":"INSERT","lineNumber":134,"content":""},{"type":"INSERT","lineNumber":135,"content":"  Widget _buildPostItem(PostModel post) {"},{"type":"INSERT","lineNumber":136,"content":"    return Card("},{"type":"INSERT","lineNumber":137,"content":"      margin: const EdgeInsets.symmetric(vertical: 8, horizontal: 8),"},{"type":"INSERT","lineNumber":138,"content":"      child: Column("},{"type":"INSERT","lineNumber":139,"content":"        crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":140,"content":"        children: ["},{"type":"INSERT","lineNumber":141,"content":"          // Post Header"},{"type":"INSERT","lineNumber":142,"content":"          ListTile("},{"type":"INSERT","lineNumber":143,"content":"            leading: CircleAvatar("},{"type":"INSERT","lineNumber":144,"content":"              backgroundImage: post.userImageUrl != null"},{"type":"INSERT","lineNumber":145,"content":"                  ? NetworkImage(post.userImageUrl!)"},{"type":"INSERT","lineNumber":146,"content":"                  : null,"},{"type":"INSERT","lineNumber":147,"content":"              child: post.userImageUrl == null"},{"type":"INSERT","lineNumber":148,"content":"                  ? const Icon(Icons.person)"},{"type":"INSERT","lineNumber":149,"content":"                  : null,"},{"type":"INSERT","lineNumber":150,"content":"            ),"},{"type":"INSERT","lineNumber":151,"content":"            title: Text("},{"type":"INSERT","lineNumber":152,"content":"              post.userName,"},{"type":"INSERT","lineNumber":153,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":154,"content":"                fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":155,"content":"              ),"},{"type":"INSERT","lineNumber":156,"content":"            ),"},{"type":"INSERT","lineNumber":157,"content":"            subtitle: Text("},{"type":"INSERT","lineNumber":158,"content":"              '${post.createdAt.day}/${post.createdAt.month}/${post.createdAt.year}',"},{"type":"INSERT","lineNumber":159,"content":"              style: GoogleFonts.poppins(fontSize: 12),"},{"type":"INSERT","lineNumber":160,"content":"            ),"},{"type":"INSERT","lineNumber":161,"content":"          ),"},{"type":"INSERT","lineNumber":162,"content":"          "},{"type":"INSERT","lineNumber":163,"content":"          // Post Content"},{"type":"INSERT","lineNumber":164,"content":"          Padding("},{"type":"INSERT","lineNumber":165,"content":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":166,"content":"            child: Text(post.content),"},{"type":"INSERT","lineNumber":167,"content":"          ),"},{"type":"INSERT","lineNumber":168,"content":"          "},{"type":"INSERT","lineNumber":169,"content":"          // Post Images (if any)"},{"type":"INSERT","lineNumber":170,"content":"          if (post.imageUrls != null && post.imageUrls!.isNotEmpty)"},{"type":"INSERT","lineNumber":171,"content":"            SizedBox("},{"type":"INSERT","lineNumber":172,"content":"              height: 200,"},{"type":"INSERT","lineNumber":173,"content":"              child: PageView.builder("},{"type":"INSERT","lineNumber":174,"content":"                itemCount: post.imageUrls!.length,"},{"type":"INSERT","lineNumber":175,"content":"                itemBuilder: (context, index) {"},{"type":"INSERT","lineNumber":176,"content":"                  return Image.network("},{"type":"INSERT","lineNumber":177,"content":"                    post.imageUrls![index],"},{"type":"INSERT","lineNumber":178,"content":"                    fit: BoxFit.cover,"},{"type":"INSERT","lineNumber":179,"content":"                    width: double.infinity,"},{"type":"INSERT","lineNumber":180,"content":"                  );"},{"type":"INSERT","lineNumber":181,"content":"                },"},{"type":"INSERT","lineNumber":182,"content":"              ),"},{"type":"INSERT","lineNumber":183,"content":"            ),"},{"type":"INSERT","lineNumber":184,"content":"          "},{"type":"INSERT","lineNumber":185,"content":"          // Post Actions"},{"type":"INSERT","lineNumber":186,"content":"          Padding("},{"type":"INSERT","lineNumber":187,"content":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":188,"content":"            child: Row("},{"type":"INSERT","lineNumber":189,"content":"              children: ["},{"type":"INSERT","lineNumber":190,"content":"                IconButton("},{"type":"INSERT","lineNumber":191,"content":"                  icon: Icon("},{"type":"INSERT","lineNumber":192,"content":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":193,"content":"                        ? Icons.favorite"},{"type":"INSERT","lineNumber":194,"content":"                        : Icons.favorite_border,"},{"type":"INSERT","lineNumber":195,"content":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":196,"content":"                        ? Colors.red"},{"type":"INSERT","lineNumber":197,"content":"                        : null,"},{"type":"DELETE","lineNumber":32,"oldContent":"                  const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":33,"oldContent":"                  Text("},{"type":"DELETE","lineNumber":34,"oldContent":"                    'Welcome to Family Tree',"},{"type":"DELETE","lineNumber":35,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":36,"oldContent":"                      color: Colors.white,"},{"type":"DELETE","lineNumber":37,"oldContent":"                      fontSize: 24,"},{"type":"DELETE","lineNumber":38,"oldContent":"                      fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":39,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":40,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":41,"oldContent":"                  const SizedBox(height: 10),"},{"type":"DELETE","lineNumber":42,"oldContent":"                  Padding("},{"type":"DELETE","lineNumber":43,"oldContent":"                    padding: const EdgeInsets.symmetric(horizontal: 40.0),"},{"type":"DELETE","lineNumber":44,"oldContent":"                    child: Text("},{"type":"DELETE","lineNumber":45,"oldContent":"                      'Connect with your family and create your family tree',"},{"type":"DELETE","lineNumber":46,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":47,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":48,"oldContent":"                        color: Colors.white.withOpacity(0.8),"},{"type":"DELETE","lineNumber":49,"oldContent":"                        fontSize: 16,"},{"type":"DELETE","lineNumber":50,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":51,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":52,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":53,"oldContent":"                ],"},{"type":"DELETE","lineNumber":54,"oldContent":"              const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":55,"oldContent":"              const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":56,"oldContent":"              // Join Now Button"},{"type":"DELETE","lineNumber":57,"oldContent":"              SizedBox("},{"type":"DELETE","lineNumber":58,"oldContent":"                width: double.infinity,"},{"type":"DELETE","lineNumber":59,"oldContent":"                child: ElevatedButton("},{"type":"DELETE","lineNumber":61,"oldContent":"                    // TODO: Navigate to join screen"},{"type":"INSERT","lineNumber":200,"content":"                    // TODO: Implement like functionality"},{"type":"DELETE","lineNumber":63,"oldContent":"                  style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":64,"oldContent":"                    backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":65,"oldContent":"                    foregroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":66,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":67,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":68,"oldContent":"                      borderRadius: BorderRadius.circular(30),"},{"type":"DELETE","lineNumber":69,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":70,"oldContent":"                    elevation: 0,"},{"type":"DELETE","lineNumber":71,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":72,"oldContent":"                  child: Text("},{"type":"DELETE","lineNumber":73,"oldContent":"                    'Join Now',"},{"type":"DELETE","lineNumber":74,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":75,"oldContent":"                      fontSize: 16,"},{"type":"DELETE","lineNumber":76,"oldContent":"                      fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":77,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":78,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":80,"oldContent":"              ),"},{"type":"DELETE","lineNumber":81,"oldContent":"              const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":82,"oldContent":"              // Create Now Button"},{"type":"DELETE","lineNumber":83,"oldContent":"              Builder("},{"type":"DELETE","lineNumber":84,"oldContent":"                builder: (context) => SizedBox("},{"type":"DELETE","lineNumber":85,"oldContent":"                  width: double.infinity,"},{"type":"DELETE","lineNumber":86,"oldContent":"                  child: OutlinedButton("},{"type":"DELETE","lineNumber":87,"oldContent":"                    onPressed: () {"},{"type":"DELETE","lineNumber":88,"oldContent":"                      Navigator.push("},{"type":"DELETE","lineNumber":89,"oldContent":"                        context,"},{"type":"DELETE","lineNumber":90,"oldContent":"                        MaterialPageRoute("},{"type":"DELETE","lineNumber":91,"oldContent":"                          builder: (context) => const CreateFamilyScreen(),"},{"type":"DELETE","lineNumber":92,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":93,"oldContent":"                      );"},{"type":"DELETE","lineNumber":94,"oldContent":"                    },"},{"type":"DELETE","lineNumber":95,"oldContent":"                      style: OutlinedButton.styleFrom("},{"type":"DELETE","lineNumber":96,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":97,"oldContent":"                        side: const BorderSide(color: Colors.white, width: 2),"},{"type":"DELETE","lineNumber":98,"oldContent":"                        padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":99,"oldContent":"                        shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":100,"oldContent":"                          borderRadius: BorderRadius.circular(30),"},{"type":"DELETE","lineNumber":101,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":102,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":103,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":104,"oldContent":"                      child: Text("},{"type":"DELETE","lineNumber":105,"oldContent":"                        'Create Now',"},{"type":"DELETE","lineNumber":106,"oldContent":"                        style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":107,"oldContent":"                          color: Colors.white,"},{"type":"DELETE","lineNumber":108,"oldContent":"                          fontSize: 16,"},{"type":"DELETE","lineNumber":109,"oldContent":"                          fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":110,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":111,"oldContent":"                      ),"},{"type":"INSERT","lineNumber":203,"content":"                const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":204,"content":"                IconButton("},{"type":"INSERT","lineNumber":205,"content":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"INSERT","lineNumber":206,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":207,"content":"                    // TODO: Implement comment functionality"},{"type":"INSERT","lineNumber":208,"content":"                  },"},{"type":"DELETE","lineNumber":113,"oldContent":"              const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":114,"oldContent":"              // Already have an account"},{"type":"DELETE","lineNumber":115,"oldContent":"              TextButton("},{"type":"DELETE","lineNumber":116,"oldContent":"                onPressed: () {"},{"type":"DELETE","lineNumber":117,"oldContent":"                  // TODO: Navigate to login screen"},{"type":"DELETE","lineNumber":118,"oldContent":"                },"},{"type":"DELETE","lineNumber":119,"oldContent":"                child: Text("},{"type":"DELETE","lineNumber":120,"oldContent":"                  'Already have an account? Sign In',"},{"type":"DELETE","lineNumber":121,"oldContent":"                  style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":122,"oldContent":"                    fontSize: 14,"},{"type":"DELETE","lineNumber":123,"oldContent":"                    decoration: TextDecoration.underline,"},{"type":"DELETE","lineNumber":124,"oldContent":"                    color: Colors.white,"},{"type":"DELETE","lineNumber":125,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":210,"content":"                const Spacer(),"},{"type":"INSERT","lineNumber":211,"content":"                Text("},{"type":"INSERT","lineNumber":212,"content":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"INSERT","lineNumber":213,"content":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"DELETE","lineNumber":127,"oldContent":"              ),"},{"type":"DELETE","lineNumber":128,"oldContent":"            ],"},{"type":"INSERT","lineNumber":215,"content":"              ],"},{"type":"INSERT","lineNumber":216,"content":"            ),"},{"type":"INSERT","lineNumber":218,"content":"        ],"},{"type":"DELETE","lineNumber":131,"oldContent":"        ),"},{"type":"DELETE","lineNumber":134,"oldContent":""},{"type":"DELETE","lineNumber":135,"oldContent":""},{"type":"DELETE","lineNumber":136,"oldContent":""},{"type":"DELETE","lineNumber":137,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":138,"oldContent":"  @override"},{"type":"DELETE","lineNumber":139,"oldContent":"  }"},{"type":"DELETE","lineNumber":140,"oldContent":"    return _buildWelcomeScreen();"}]},{"timestamp":1754654824355,"changes":[{"type":"DELETE","lineNumber":4,"oldContent":""},{"type":"DELETE","lineNumber":6,"oldContent":"class HomeScreen extends StatelessWidget {"},{"type":"DELETE","lineNumber":8,"oldContent":"  const HomeScreen({Key? key}) : super(key: key);"},{"type":"DELETE","lineNumber":10,"oldContent":""},{"type":"DELETE","lineNumber":12,"oldContent":"    return Scaffold("},{"type":"INSERT","lineNumber":8,"content":""},{"type":"INSERT","lineNumber":9,"content":"class HomeScreen extends StatefulWidget {"},{"type":"INSERT","lineNumber":10,"content":"  const HomeScreen({Key? key}) : super(key: key);"},{"type":"INSERT","lineNumber":11,"content":""},{"type":"INSERT","lineNumber":12,"content":"  @override"},{"type":"INSERT","lineNumber":13,"content":"  State<HomeScreen> createState() => _HomeScreenState();"},{"type":"INSERT","lineNumber":14,"content":"}"},{"type":"INSERT","lineNumber":15,"content":""},{"type":"INSERT","lineNumber":16,"content":"class _HomeScreenState extends State<HomeScreen> {"},{"type":"INSERT","lineNumber":19,"content":"  String? _familyId;"},{"type":"INSERT","lineNumber":22,"content":"  void initState() {"},{"type":"INSERT","lineNumber":23,"content":"    super.initState();"},{"type":"INSERT","lineNumber":24,"content":"    // TODO: Get familyId from user data or family service"},{"type":"INSERT","lineNumber":25,"content":"    // _familyId = context.read<AuthBloc>().state.user?.familyId;"},{"type":"INSERT","lineNumber":26,"content":"  }"},{"type":"INSERT","lineNumber":27,"content":""},{"type":"INSERT","lineNumber":28,"content":"  @override"},{"type":"DELETE","lineNumber":20,"oldContent":"          ),"},{"type":"DELETE","lineNumber":24,"oldContent":"        ),"},{"type":"INSERT","lineNumber":38,"content":"    return Scaffold("},{"type":"DELETE","lineNumber":34,"oldContent":"                  ),"},{"type":"INSERT","lineNumber":45,"content":"          ),"},{"type":"INSERT","lineNumber":46,"content":"        ),"},{"type":"DELETE","lineNumber":56,"oldContent":"        stream: _storyService.getFamilyStories(),"},{"type":"INSERT","lineNumber":68,"content":"        stream: _familyId != null ? _storyService.getFamilyStories(_familyId!) : Stream.value([]),"},{"type":"DELETE","lineNumber":62,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":65,"oldContent":"                  },"},{"type":"DELETE","lineNumber":83,"oldContent":"                ),"},{"type":"DELETE","lineNumber":117,"oldContent":"                ),"},{"type":"DELETE","lineNumber":119,"oldContent":"      stream: _postService.getFamilyPosts('familyId'), // TODO: Get actual familyId"},{"type":"INSERT","lineNumber":127,"content":"      stream: _familyId != null ? _postService.getFamilyPosts(_familyId!) : Stream.value([]),"},{"type":"DELETE","lineNumber":132,"oldContent":"                ),"},{"type":"DELETE","lineNumber":136,"oldContent":"          ),"},{"type":"DELETE","lineNumber":138,"oldContent":"      ),"},{"type":"DELETE","lineNumber":141,"oldContent":"    );"},{"type":"DELETE","lineNumber":143,"oldContent":"  }"},{"type":"DELETE","lineNumber":152,"oldContent":"}"},{"type":"DELETE","lineNumber":154,"oldContent":""},{"type":"DELETE","lineNumber":156,"oldContent":"        ],"},{"type":"DELETE","lineNumber":158,"oldContent":"            ),"},{"type":"DELETE","lineNumber":160,"oldContent":"              ],"},{"type":"DELETE","lineNumber":162,"oldContent":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"DELETE","lineNumber":164,"oldContent":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"DELETE","lineNumber":166,"oldContent":"                Text("},{"type":"DELETE","lineNumber":168,"oldContent":"                const Spacer(),"},{"type":"DELETE","lineNumber":170,"oldContent":"                  },"},{"type":"DELETE","lineNumber":172,"oldContent":"                    // TODO: Implement comment functionality"},{"type":"DELETE","lineNumber":174,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":176,"oldContent":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"DELETE","lineNumber":178,"oldContent":"                IconButton("},{"type":"DELETE","lineNumber":180,"oldContent":"                const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":182,"oldContent":"                    // TODO: Implement like functionality"},{"type":"DELETE","lineNumber":184,"oldContent":"                        : null,"},{"type":"DELETE","lineNumber":186,"oldContent":"                        ? Colors.red"},{"type":"DELETE","lineNumber":188,"oldContent":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"DELETE","lineNumber":190,"oldContent":"                        : Icons.favorite_border,"},{"type":"DELETE","lineNumber":192,"oldContent":"                        ? Icons.favorite"},{"type":"DELETE","lineNumber":194,"oldContent":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"DELETE","lineNumber":196,"oldContent":"                  icon: Icon("},{"type":"DELETE","lineNumber":198,"oldContent":"                IconButton("},{"type":"DELETE","lineNumber":200,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":202,"oldContent":"            child: Row("},{"type":"DELETE","lineNumber":204,"oldContent":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"DELETE","lineNumber":206,"oldContent":"          Padding("},{"type":"DELETE","lineNumber":208,"oldContent":"          // Post Actions"},{"type":"DELETE","lineNumber":210,"oldContent":"          "},{"type":"DELETE","lineNumber":212,"oldContent":"            ),"},{"type":"DELETE","lineNumber":214,"oldContent":"              ),"},{"type":"DELETE","lineNumber":216,"oldContent":"                },"},{"type":"DELETE","lineNumber":218,"oldContent":"                  );"},{"type":"DELETE","lineNumber":220,"oldContent":"                    width: double.infinity,"},{"type":"DELETE","lineNumber":222,"oldContent":"                    fit: BoxFit.cover,"},{"type":"INSERT","lineNumber":191,"content":"                    fit: BoxFit.cover,"},{"type":"INSERT","lineNumber":192,"content":"                    width: double.infinity,"},{"type":"INSERT","lineNumber":193,"content":"                  );"},{"type":"INSERT","lineNumber":194,"content":"                },"},{"type":"INSERT","lineNumber":195,"content":"              ),"},{"type":"INSERT","lineNumber":196,"content":"            ),"},{"type":"INSERT","lineNumber":197,"content":"          "},{"type":"INSERT","lineNumber":198,"content":"          // Post Actions"},{"type":"INSERT","lineNumber":199,"content":"          Padding("},{"type":"INSERT","lineNumber":200,"content":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":201,"content":"            child: Row("},{"type":"INSERT","lineNumber":202,"content":"              children: ["},{"type":"INSERT","lineNumber":203,"content":"                IconButton("},{"type":"INSERT","lineNumber":204,"content":"                  icon: Icon("},{"type":"INSERT","lineNumber":205,"content":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":206,"content":"                        ? Icons.favorite"},{"type":"INSERT","lineNumber":207,"content":"                        : Icons.favorite_border,"},{"type":"INSERT","lineNumber":208,"content":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":209,"content":"                        ? Colors.red"},{"type":"INSERT","lineNumber":210,"content":"                        : null,"},{"type":"INSERT","lineNumber":211,"content":"                  ),"},{"type":"INSERT","lineNumber":212,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":213,"content":"                    // TODO: Implement like functionality"},{"type":"INSERT","lineNumber":214,"content":"                  },"},{"type":"INSERT","lineNumber":215,"content":"                ),"},{"type":"INSERT","lineNumber":216,"content":"                const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":217,"content":"                IconButton("},{"type":"INSERT","lineNumber":218,"content":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"INSERT","lineNumber":219,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":220,"content":"                    // TODO: Implement comment functionality"},{"type":"INSERT","lineNumber":221,"content":"                  },"},{"type":"INSERT","lineNumber":222,"content":"                ),"},{"type":"INSERT","lineNumber":223,"content":"                const Spacer(),"},{"type":"INSERT","lineNumber":224,"content":"                Text("},{"type":"INSERT","lineNumber":225,"content":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"INSERT","lineNumber":226,"content":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"INSERT","lineNumber":227,"content":"                ),"},{"type":"INSERT","lineNumber":228,"content":"              ],"},{"type":"INSERT","lineNumber":229,"content":"            ),"},{"type":"INSERT","lineNumber":230,"content":"          ),"},{"type":"INSERT","lineNumber":231,"content":"        ],"},{"type":"INSERT","lineNumber":232,"content":"      ),"},{"type":"INSERT","lineNumber":233,"content":"    );"},{"type":"INSERT","lineNumber":234,"content":"  }"},{"type":"INSERT","lineNumber":235,"content":"}"},{"type":"INSERT","lineNumber":236,"content":""}]},{"timestamp":1754654899586,"changes":[{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/stories/domain/models/story_model.dart';"},{"type":"INSERT","lineNumber":7,"content":"import 'package:family_tree_firebase/features/stories/data/services/story_service.dart';"},{"type":"INSERT","lineNumber":8,"content":"import 'package:family_tree_firebase/features/family/presentation/screens/create_family_screen.dart';"},{"type":"DELETE","lineNumber":8,"oldContent":"import 'package:family_tree_firebase/features/stories/domain/models/story_model.dart';"},{"type":"DELETE","lineNumber":11,"oldContent":"import 'package:family_tree_firebase/features/stories/data/services/story_service.dart';"},{"type":"DELETE","lineNumber":14,"oldContent":"  final PostService _postService = PostService();"},{"type":"INSERT","lineNumber":16,"content":""},{"type":"INSERT","lineNumber":17,"content":"class _HomeScreenState extends State<HomeScreen> {"},{"type":"INSERT","lineNumber":18,"content":"  final PostService _postService = PostService();"},{"type":"INSERT","lineNumber":20,"content":"  String? _familyId;"},{"type":"INSERT","lineNumber":22,"content":"  @override"},{"type":"INSERT","lineNumber":23,"content":"  void initState() {"},{"type":"INSERT","lineNumber":24,"content":"    super.initState();"},{"type":"INSERT","lineNumber":25,"content":"    // TODO: Get familyId from user data or family service"},{"type":"INSERT","lineNumber":26,"content":"    // _familyId = context.read<AuthBloc>().state.user?.familyId;"},{"type":"INSERT","lineNumber":27,"content":"  }"},{"type":"DELETE","lineNumber":19,"oldContent":"class _HomeScreenState extends State<HomeScreen> {"},{"type":"DELETE","lineNumber":23,"oldContent":"  String? _familyId;"},{"type":"DELETE","lineNumber":26,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":28,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":30,"oldContent":"    // TODO: Get familyId from user data or family service"},{"type":"DELETE","lineNumber":31,"oldContent":"    // _familyId = context.read<AuthBloc>().state.user?.familyId;"},{"type":"DELETE","lineNumber":33,"oldContent":"  }"},{"type":"DELETE","lineNumber":35,"oldContent":""},{"type":"DELETE","lineNumber":37,"oldContent":"  @override"},{"type":"INSERT","lineNumber":39,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":46,"content":"          ),"},{"type":"INSERT","lineNumber":47,"content":"        ),"},{"type":"DELETE","lineNumber":47,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":55,"oldContent":"          ),"},{"type":"DELETE","lineNumber":57,"oldContent":"        ),"},{"type":"INSERT","lineNumber":69,"content":"        stream: _familyId != null ? _storyService.getFamilyStories(_familyId!) : Stream.value([]),"},{"type":"DELETE","lineNumber":77,"oldContent":"        stream: _familyId != null ? _storyService.getFamilyStories(_familyId!) : Stream.value([]),"},{"type":"INSERT","lineNumber":128,"content":"      stream: _familyId != null ? _postService.getFamilyPosts(_familyId!) : Stream.value([]),"},{"type":"DELETE","lineNumber":134,"oldContent":"      stream: _familyId != null ? _postService.getFamilyPosts(_familyId!) : Stream.value([]),"},{"type":"INSERT","lineNumber":149,"content":"  Widget _buildWelcomeScreen() {"},{"type":"INSERT","lineNumber":150,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":151,"content":"      body: Container("},{"type":"INSERT","lineNumber":152,"content":"        width: double.infinity,"},{"type":"INSERT","lineNumber":153,"content":"        padding: const EdgeInsets.all(24),"},{"type":"INSERT","lineNumber":154,"content":"        decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":155,"content":"          gradient: LinearGradient("},{"type":"INSERT","lineNumber":156,"content":"            begin: Alignment.topCenter,"},{"type":"INSERT","lineNumber":157,"content":"            end: Alignment.bottomCenter,"},{"type":"INSERT","lineNumber":158,"content":"            colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"INSERT","lineNumber":159,"content":"          ),"},{"type":"INSERT","lineNumber":160,"content":"        ),"},{"type":"INSERT","lineNumber":161,"content":"        child: SafeArea("},{"type":"INSERT","lineNumber":162,"content":"          child: Column("},{"type":"INSERT","lineNumber":163,"content":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":164,"content":"            children: ["},{"type":"INSERT","lineNumber":165,"content":"              // App Logo and Title"},{"type":"INSERT","lineNumber":166,"content":"              Column("},{"type":"INSERT","lineNumber":167,"content":"                children: ["},{"type":"INSERT","lineNumber":168,"content":"                  // Replace with your app logo"},{"type":"INSERT","lineNumber":169,"content":"                  Container("},{"type":"INSERT","lineNumber":170,"content":"                    width: 150,"},{"type":"INSERT","lineNumber":171,"content":"                    height: 150,"},{"type":"INSERT","lineNumber":172,"content":"                    decoration: BoxDecoration("},{"type":"INSERT","lineNumber":173,"content":"                      color: Colors.white24,"},{"type":"INSERT","lineNumber":174,"content":"                      borderRadius: BorderRadius.circular(20),"},{"type":"INSERT","lineNumber":175,"content":"                    ),"},{"type":"INSERT","lineNumber":176,"content":"                    child: const Icon(Icons.family_restroom, size: 60, color: Colors.white),"},{"type":"INSERT","lineNumber":177,"content":"                  ),"},{"type":"INSERT","lineNumber":178,"content":"                  const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":179,"content":"                  Text("},{"type":"INSERT","lineNumber":180,"content":"                    'Welcome to Family Tree',"},{"type":"INSERT","lineNumber":181,"content":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":182,"content":"                      color: Colors.white,"},{"type":"INSERT","lineNumber":183,"content":"                      fontSize: 24,"},{"type":"INSERT","lineNumber":184,"content":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":185,"content":"                    ),"},{"type":"INSERT","lineNumber":186,"content":"                  ),"},{"type":"INSERT","lineNumber":187,"content":"                  const SizedBox(height: 10),"},{"type":"INSERT","lineNumber":188,"content":"                  Padding("},{"type":"INSERT","lineNumber":189,"content":"                    padding: const EdgeInsets.symmetric(horizontal: 40.0),"},{"type":"INSERT","lineNumber":190,"content":"                    child: Text("},{"type":"INSERT","lineNumber":191,"content":"                      'Connect with your family and create your family tree',"},{"type":"INSERT","lineNumber":192,"content":"                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":193,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":194,"content":"                        color: Colors.white.withOpacity(0.8),"},{"type":"INSERT","lineNumber":195,"content":"                        fontSize: 16,"},{"type":"INSERT","lineNumber":196,"content":"                      ),"},{"type":"INSERT","lineNumber":197,"content":"                    ),"},{"type":"INSERT","lineNumber":198,"content":"                  ),"},{"type":"INSERT","lineNumber":199,"content":"                ],"},{"type":"INSERT","lineNumber":200,"content":"              ),"},{"type":"INSERT","lineNumber":201,"content":"              const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":202,"content":"              // Join Now Button"},{"type":"INSERT","lineNumber":203,"content":"              SizedBox("},{"type":"INSERT","lineNumber":204,"content":"                width: double.infinity,"},{"type":"INSERT","lineNumber":205,"content":"                child: ElevatedButton("},{"type":"INSERT","lineNumber":206,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":207,"content":"                    // TODO: Navigate to join family screen"},{"type":"INSERT","lineNumber":208,"content":"                  },"},{"type":"INSERT","lineNumber":209,"content":"                  style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":210,"content":"                    backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":211,"content":"                    foregroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":212,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":213,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":214,"content":"                      borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":215,"content":"                    ),"},{"type":"INSERT","lineNumber":216,"content":"                    elevation: 0,"},{"type":"INSERT","lineNumber":217,"content":"                  ),"},{"type":"INSERT","lineNumber":218,"content":"                  child: Text("},{"type":"INSERT","lineNumber":219,"content":"                    'Join Now',"},{"type":"INSERT","lineNumber":220,"content":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":221,"content":"                      fontSize: 16,"},{"type":"INSERT","lineNumber":222,"content":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":223,"content":"                    ),"},{"type":"INSERT","lineNumber":224,"content":"                  ),"},{"type":"INSERT","lineNumber":225,"content":"                ),"},{"type":"INSERT","lineNumber":226,"content":"              ),"},{"type":"INSERT","lineNumber":227,"content":"              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":228,"content":"              // Create Now Button"},{"type":"INSERT","lineNumber":229,"content":"              SizedBox("},{"type":"INSERT","lineNumber":230,"content":"                width: double.infinity,"},{"type":"INSERT","lineNumber":231,"content":"                child: OutlinedButton("},{"type":"INSERT","lineNumber":232,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":233,"content":"                    Navigator.push("},{"type":"INSERT","lineNumber":234,"content":"                      context,"},{"type":"INSERT","lineNumber":235,"content":"                      MaterialPageRoute("},{"type":"INSERT","lineNumber":236,"content":"                        builder: (context) => const CreateFamilyScreen(),"},{"type":"INSERT","lineNumber":237,"content":"                      ),"},{"type":"INSERT","lineNumber":238,"content":"                    );"},{"type":"INSERT","lineNumber":239,"content":"                  },"},{"type":"INSERT","lineNumber":240,"content":"                  style: OutlinedButton.styleFrom("},{"type":"INSERT","lineNumber":241,"content":"                    side: const BorderSide(color: Colors.white, width: 2),"},{"type":"INSERT","lineNumber":242,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":243,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":244,"content":"                      borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":245,"content":"                    ),"},{"type":"INSERT","lineNumber":246,"content":"                  ),"},{"type":"INSERT","lineNumber":247,"content":"                  child: Text("},{"type":"INSERT","lineNumber":248,"content":"                    'Create Family',"},{"type":"INSERT","lineNumber":249,"content":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":250,"content":"                      color: Colors.white,"},{"type":"INSERT","lineNumber":251,"content":"                      fontSize: 16,"},{"type":"INSERT","lineNumber":252,"content":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":253,"content":"                    ),"},{"type":"INSERT","lineNumber":254,"content":"                  ),"},{"type":"INSERT","lineNumber":255,"content":"                ),"},{"type":"INSERT","lineNumber":256,"content":"              ),"},{"type":"INSERT","lineNumber":257,"content":"            ],"},{"type":"INSERT","lineNumber":258,"content":"          ),"},{"type":"INSERT","lineNumber":259,"content":"        ),"},{"type":"INSERT","lineNumber":260,"content":"      ),"},{"type":"INSERT","lineNumber":261,"content":"    );"},{"type":"INSERT","lineNumber":262,"content":"  }"},{"type":"INSERT","lineNumber":263,"content":""},{"type":"DELETE","lineNumber":174,"oldContent":"                    fit: BoxFit.cover,"},{"type":"INSERT","lineNumber":291,"content":"          "},{"type":"INSERT","lineNumber":292,"content":"          // Post Content"},{"type":"INSERT","lineNumber":293,"content":"          Padding("},{"type":"INSERT","lineNumber":294,"content":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":295,"content":"            child: Text(post.content),"},{"type":"INSERT","lineNumber":296,"content":"          ),"},{"type":"INSERT","lineNumber":297,"content":"          "},{"type":"INSERT","lineNumber":298,"content":"          // Post Images (if any)"},{"type":"INSERT","lineNumber":299,"content":"          if (post.imageUrls != null && post.imageUrls!.isNotEmpty)"},{"type":"INSERT","lineNumber":300,"content":"            SizedBox("},{"type":"INSERT","lineNumber":301,"content":"              height: 200,"},{"type":"INSERT","lineNumber":302,"content":"              child: PageView.builder("},{"type":"INSERT","lineNumber":303,"content":"                itemCount: post.imageUrls!.length,"},{"type":"INSERT","lineNumber":304,"content":"                itemBuilder: (context, index) {"},{"type":"INSERT","lineNumber":305,"content":"                  return Image.network("},{"type":"INSERT","lineNumber":306,"content":"                    post.imageUrls![index],"},{"type":"INSERT","lineNumber":307,"content":"                    fit: BoxFit.cover,"},{"type":"DELETE","lineNumber":178,"oldContent":"          "},{"type":"DELETE","lineNumber":181,"oldContent":"          // Post Content"},{"type":"DELETE","lineNumber":184,"oldContent":"          Padding("},{"type":"DELETE","lineNumber":188,"oldContent":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"DELETE","lineNumber":190,"oldContent":"            child: Text(post.content),"},{"type":"DELETE","lineNumber":193,"oldContent":"          ),"},{"type":"DELETE","lineNumber":196,"oldContent":"          "},{"type":"DELETE","lineNumber":199,"oldContent":"          // Post Images (if any)"},{"type":"DELETE","lineNumber":202,"oldContent":"          if (post.imageUrls != null && post.imageUrls!.isNotEmpty)"},{"type":"DELETE","lineNumber":205,"oldContent":"            SizedBox("},{"type":"DELETE","lineNumber":208,"oldContent":"              height: 200,"},{"type":"DELETE","lineNumber":211,"oldContent":"              child: PageView.builder("},{"type":"DELETE","lineNumber":214,"oldContent":"                itemCount: post.imageUrls!.length,"},{"type":"DELETE","lineNumber":217,"oldContent":"                itemBuilder: (context, index) {"},{"type":"DELETE","lineNumber":220,"oldContent":"                  return Image.network("},{"type":"DELETE","lineNumber":223,"oldContent":"                    post.imageUrls![index],"},{"type":"DELETE","lineNumber":225,"oldContent":""},{"type":"DELETE","lineNumber":227,"oldContent":"}"},{"type":"DELETE","lineNumber":229,"oldContent":"  }"},{"type":"DELETE","lineNumber":231,"oldContent":"    );"},{"type":"DELETE","lineNumber":233,"oldContent":"      ),"},{"type":"DELETE","lineNumber":235,"oldContent":"        ],"},{"type":"INSERT","lineNumber":347,"content":"        ],"},{"type":"INSERT","lineNumber":348,"content":"      ),"},{"type":"INSERT","lineNumber":349,"content":"    );"},{"type":"INSERT","lineNumber":350,"content":"  }"},{"type":"INSERT","lineNumber":351,"content":"}"},{"type":"INSERT","lineNumber":352,"content":""}]},{"timestamp":1754655274096,"changes":[{"type":"DELETE","lineNumber":7,"oldContent":""},{"type":"MODIFY","lineNumber":9,"content":"","oldContent":"class HomeScreen extends StatefulWidget {"},{"type":"INSERT","lineNumber":10,"content":"class HomeScreen extends StatefulWidget {"},{"type":"DELETE","lineNumber":17,"oldContent":"  final StoryService _storyService = StoryService();"},{"type":"DELETE","lineNumber":19,"oldContent":""},{"type":"DELETE","lineNumber":21,"oldContent":""},{"type":"INSERT","lineNumber":19,"content":"  final StoryService _storyService = StoryService();"},{"type":"INSERT","lineNumber":21,"content":""},{"type":"DELETE","lineNumber":24,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":25,"oldContent":"  @override"},{"type":"DELETE","lineNumber":26,"oldContent":"    final authState = context.watch<AuthBloc>().state;"},{"type":"INSERT","lineNumber":25,"content":"    // Get familyId from auth state"},{"type":"INSERT","lineNumber":26,"content":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"INSERT","lineNumber":27,"content":"      final authState = context.read<AuthBloc>().state;"},{"type":"INSERT","lineNumber":28,"content":"      if (authState.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":29,"content":"        _loadFamilyId();"},{"type":"INSERT","lineNumber":30,"content":"      }"},{"type":"INSERT","lineNumber":31,"content":"    });"},{"type":"INSERT","lineNumber":32,"content":"  }"},{"type":"INSERT","lineNumber":33,"content":""},{"type":"INSERT","lineNumber":34,"content":"  Future<void> _loadFamilyId() async {"},{"type":"INSERT","lineNumber":35,"content":"    try {"},{"type":"INSERT","lineNumber":36,"content":"      final userDoc = await FirebaseFirestore.instance"},{"type":"INSERT","lineNumber":37,"content":"          .collection('users')"},{"type":"INSERT","lineNumber":38,"content":"          .doc(FirebaseAuth.instance.currentUser?.uid)"},{"type":"INSERT","lineNumber":39,"content":"          .get();"},{"type":"INSERT","lineNumber":40,"content":"          "},{"type":"INSERT","lineNumber":41,"content":"      if (userDoc.exists && mounted) {"},{"type":"INSERT","lineNumber":42,"content":"        setState(() {"},{"type":"INSERT","lineNumber":43,"content":"          _familyId = userDoc.data()?['familyId'];"},{"type":"INSERT","lineNumber":44,"content":"        });"},{"type":"INSERT","lineNumber":45,"content":"      }"},{"type":"INSERT","lineNumber":46,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":47,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":48,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":49,"content":"          SnackBar(content: Text('Error loading family data: $e')),"},{"type":"INSERT","lineNumber":50,"content":"        );"},{"type":"INSERT","lineNumber":51,"content":"      }"},{"type":"INSERT","lineNumber":52,"content":"    }"},{"type":"INSERT","lineNumber":53,"content":"  }"},{"type":"INSERT","lineNumber":54,"content":""},{"type":"INSERT","lineNumber":55,"content":"  @override"},{"type":"INSERT","lineNumber":56,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":57,"content":"    final authState = context.watch<AuthBloc>().state;"},{"type":"DELETE","lineNumber":30,"oldContent":"    // TODO: Get familyId from user data or family service"},{"type":"DELETE","lineNumber":32,"oldContent":"    // _familyId = context.read<AuthBloc>().state.user?.familyId;"},{"type":"DELETE","lineNumber":33,"oldContent":"  }"},{"type":"INSERT","lineNumber":63,"content":"    "},{"type":"INSERT","lineNumber":64,"content":"    // Show loading indicator while checking family status"},{"type":"INSERT","lineNumber":65,"content":"    if (_familyId == null) {"},{"type":"INSERT","lineNumber":66,"content":"      return const Scaffold("},{"type":"INSERT","lineNumber":67,"content":"        body: Center(child: CircularProgressIndicator()),"},{"type":"INSERT","lineNumber":68,"content":"      );"},{"type":"INSERT","lineNumber":69,"content":"    }"},{"type":"INSERT","lineNumber":70,"content":"    "},{"type":"INSERT","lineNumber":71,"content":"    // Show family creation prompt if user is authenticated but has no family"},{"type":"INSERT","lineNumber":72,"content":"    if (_familyId == null || _familyId!.isEmpty) {"},{"type":"INSERT","lineNumber":73,"content":"      return _buildNoFamilyScreen();"},{"type":"INSERT","lineNumber":74,"content":"    }"},{"type":"DELETE","lineNumber":39,"oldContent":"      appBar: AppBar("},{"type":"INSERT","lineNumber":78,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":84,"content":"          ),"},{"type":"INSERT","lineNumber":85,"content":"        ),"},{"type":"DELETE","lineNumber":48,"oldContent":"          ),"},{"type":"DELETE","lineNumber":50,"oldContent":"        ),"},{"type":"DELETE","lineNumber":69,"oldContent":"        builder: (context, snapshot) {"},{"type":"INSERT","lineNumber":108,"content":"        builder: (context, snapshot) {"},{"type":"DELETE","lineNumber":128,"oldContent":"      builder: (context, snapshot) {"},{"type":"INSERT","lineNumber":167,"content":"      builder: (context, snapshot) {"},{"type":"DELETE","lineNumber":149,"oldContent":"  Widget _buildPostItem(PostModel post) {"},{"type":"INSERT","lineNumber":187,"content":"  Widget _buildNoFamilyScreen() {"},{"type":"INSERT","lineNumber":188,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":189,"content":"      body: Center("},{"type":"INSERT","lineNumber":190,"content":"        child: Padding("},{"type":"INSERT","lineNumber":191,"content":"          padding: const EdgeInsets.all(24.0),"},{"type":"INSERT","lineNumber":192,"content":"          child: Column("},{"type":"INSERT","lineNumber":193,"content":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":194,"content":"            children: ["},{"type":"INSERT","lineNumber":195,"content":"              const Icon("},{"type":"INSERT","lineNumber":196,"content":"                Icons.group_add,"},{"type":"INSERT","lineNumber":197,"content":"                size: 80,"},{"type":"INSERT","lineNumber":198,"content":"                color: Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":199,"content":"              ),"},{"type":"INSERT","lineNumber":200,"content":"              const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":201,"content":"              Text("},{"type":"INSERT","lineNumber":202,"content":"                'Join or Create a Family',"},{"type":"INSERT","lineNumber":203,"content":"                style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":204,"content":"                  fontSize: 24,"},{"type":"INSERT","lineNumber":205,"content":"                  fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":206,"content":"                ),"},{"type":"INSERT","lineNumber":207,"content":"                textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":208,"content":"              ),"},{"type":"INSERT","lineNumber":209,"content":"              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":210,"content":"              Text("},{"type":"INSERT","lineNumber":211,"content":"                'To start sharing moments with your family, you need to join an existing family or create a new one.',"},{"type":"INSERT","lineNumber":212,"content":"                style: GoogleFonts.poppins(fontSize: 16, color: Colors.grey[600]),"},{"type":"INSERT","lineNumber":213,"content":"                textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":214,"content":"              ),"},{"type":"INSERT","lineNumber":215,"content":"              const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":216,"content":"              SizedBox("},{"type":"INSERT","lineNumber":217,"content":"                width: double.infinity,"},{"type":"INSERT","lineNumber":218,"content":"                child: ElevatedButton("},{"type":"INSERT","lineNumber":219,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":220,"content":"                    // Navigate to join family screen"},{"type":"INSERT","lineNumber":221,"content":"                    // TODO: Implement join family navigation"},{"type":"INSERT","lineNumber":222,"content":"                  },"},{"type":"INSERT","lineNumber":223,"content":"                  style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":224,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":225,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":226,"content":"                      borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":227,"content":"                    ),"},{"type":"INSERT","lineNumber":228,"content":"                  ),"},{"type":"INSERT","lineNumber":229,"content":"                  child: const Text('Join Family'),"},{"type":"INSERT","lineNumber":230,"content":"                ),"},{"type":"INSERT","lineNumber":231,"content":"              ),"},{"type":"INSERT","lineNumber":232,"content":"              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":233,"content":"              SizedBox("},{"type":"INSERT","lineNumber":234,"content":"                width: double.infinity,"},{"type":"INSERT","lineNumber":235,"content":"                child: OutlinedButton("},{"type":"INSERT","lineNumber":236,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":237,"content":"                    Navigator.push("},{"type":"INSERT","lineNumber":238,"content":"                      context,"},{"type":"INSERT","lineNumber":239,"content":"                      MaterialPageRoute("},{"type":"INSERT","lineNumber":240,"content":"                        builder: (context) => const CreateFamilyScreen(),"},{"type":"INSERT","lineNumber":241,"content":"                      ),"},{"type":"INSERT","lineNumber":242,"content":"                    );"},{"type":"INSERT","lineNumber":243,"content":"                  },"},{"type":"INSERT","lineNumber":244,"content":"                  style: OutlinedButton.styleFrom("},{"type":"INSERT","lineNumber":245,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":246,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":247,"content":"                      borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":248,"content":"                    ),"},{"type":"INSERT","lineNumber":249,"content":"                    side: const BorderSide(color: Color(0xFF6A11CB)),"},{"type":"INSERT","lineNumber":250,"content":"                  ),"},{"type":"INSERT","lineNumber":251,"content":"                  child: const Text("},{"type":"INSERT","lineNumber":252,"content":"                    'Create Family',"},{"type":"INSERT","lineNumber":253,"content":"                    style: TextStyle(color: Color(0xFF6A11CB)),"},{"type":"INSERT","lineNumber":254,"content":"                  ),"},{"type":"INSERT","lineNumber":255,"content":"                ),"},{"type":"INSERT","lineNumber":256,"content":"              ),"},{"type":"INSERT","lineNumber":257,"content":"            ],"},{"type":"INSERT","lineNumber":258,"content":"          ),"},{"type":"INSERT","lineNumber":259,"content":"        ),"},{"type":"INSERT","lineNumber":260,"content":"      ),"},{"type":"INSERT","lineNumber":261,"content":"    );"},{"type":"INSERT","lineNumber":262,"content":"  }"},{"type":"INSERT","lineNumber":263,"content":""},{"type":"DELETE","lineNumber":151,"oldContent":"    return Card("},{"type":"DELETE","lineNumber":153,"oldContent":"      margin: const EdgeInsets.symmetric(vertical: 8, horizontal: 8),"},{"type":"DELETE","lineNumber":155,"oldContent":"      child: Column("},{"type":"DELETE","lineNumber":157,"oldContent":"        crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"DELETE","lineNumber":159,"oldContent":"        children: ["},{"type":"DELETE","lineNumber":161,"oldContent":"          // Post Header"},{"type":"DELETE","lineNumber":163,"oldContent":"          ListTile("},{"type":"DELETE","lineNumber":165,"oldContent":"            leading: CircleAvatar("},{"type":"DELETE","lineNumber":167,"oldContent":"              backgroundImage: post.userImageUrl != null"},{"type":"DELETE","lineNumber":169,"oldContent":"                  ? NetworkImage(post.userImageUrl!)"},{"type":"DELETE","lineNumber":171,"oldContent":"                  : null,"},{"type":"DELETE","lineNumber":173,"oldContent":"              child: post.userImageUrl == null"},{"type":"DELETE","lineNumber":175,"oldContent":"                  ? const Icon(Icons.person)"},{"type":"DELETE","lineNumber":177,"oldContent":"                  : null,"},{"type":"DELETE","lineNumber":179,"oldContent":"            ),"},{"type":"DELETE","lineNumber":181,"oldContent":"            title: Text("},{"type":"DELETE","lineNumber":183,"oldContent":"              post.userName,"},{"type":"DELETE","lineNumber":185,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":187,"oldContent":"                fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":189,"oldContent":"              ),"},{"type":"DELETE","lineNumber":191,"oldContent":"            ),"},{"type":"DELETE","lineNumber":193,"oldContent":"            subtitle: Text("},{"type":"DELETE","lineNumber":195,"oldContent":"              '${post.createdAt.day}/${post.createdAt.month}/${post.createdAt.year}',"},{"type":"DELETE","lineNumber":197,"oldContent":"              style: GoogleFonts.poppins(fontSize: 12),"},{"type":"DELETE","lineNumber":199,"oldContent":"            ),"},{"type":"DELETE","lineNumber":202,"oldContent":"          ),"},{"type":"DELETE","lineNumber":204,"oldContent":"                    width: double.infinity,"},{"type":"DELETE","lineNumber":206,"oldContent":"                  );"},{"type":"DELETE","lineNumber":209,"oldContent":"                },"},{"type":"DELETE","lineNumber":211,"oldContent":"              ),"},{"type":"DELETE","lineNumber":214,"oldContent":"            ),"},{"type":"DELETE","lineNumber":216,"oldContent":"          "},{"type":"DELETE","lineNumber":219,"oldContent":"          // Post Actions"},{"type":"DELETE","lineNumber":221,"oldContent":"          Padding("},{"type":"DELETE","lineNumber":223,"oldContent":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"DELETE","lineNumber":226,"oldContent":"            child: Row("},{"type":"DELETE","lineNumber":229,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":231,"oldContent":"                IconButton("},{"type":"DELETE","lineNumber":234,"oldContent":"                  icon: Icon("},{"type":"DELETE","lineNumber":236,"oldContent":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"DELETE","lineNumber":239,"oldContent":"                        ? Icons.favorite"},{"type":"DELETE","lineNumber":241,"oldContent":"                        : Icons.favorite_border,"},{"type":"DELETE","lineNumber":244,"oldContent":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"DELETE","lineNumber":246,"oldContent":"                        ? Colors.red"},{"type":"DELETE","lineNumber":249,"oldContent":"                        : null,"},{"type":"DELETE","lineNumber":251,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":254,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":256,"oldContent":"                    // TODO: Implement like functionality"},{"type":"DELETE","lineNumber":259,"oldContent":"                  },"},{"type":"DELETE","lineNumber":261,"oldContent":"                ),"},{"type":"DELETE","lineNumber":264,"oldContent":"                const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":266,"oldContent":"                IconButton("},{"type":"DELETE","lineNumber":269,"oldContent":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"DELETE","lineNumber":271,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":274,"oldContent":"                    // TODO: Implement comment functionality"},{"type":"DELETE","lineNumber":276,"oldContent":"                  },"},{"type":"DELETE","lineNumber":279,"oldContent":"                ),"},{"type":"DELETE","lineNumber":281,"oldContent":"                const Spacer(),"},{"type":"DELETE","lineNumber":284,"oldContent":"                Text("},{"type":"DELETE","lineNumber":287,"oldContent":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"DELETE","lineNumber":290,"oldContent":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"DELETE","lineNumber":293,"oldContent":"                ),"},{"type":"DELETE","lineNumber":296,"oldContent":"              ],"},{"type":"DELETE","lineNumber":299,"oldContent":"            ),"},{"type":"DELETE","lineNumber":302,"oldContent":"          ),"},{"type":"DELETE","lineNumber":304,"oldContent":""},{"type":"DELETE","lineNumber":306,"oldContent":"        ],"},{"type":"DELETE","lineNumber":308,"oldContent":"                },"},{"type":"DELETE","lineNumber":310,"oldContent":"      ),"},{"type":"DELETE","lineNumber":312,"oldContent":"        color: Colors.white,"},{"type":"DELETE","lineNumber":314,"oldContent":"    );"},{"type":"DELETE","lineNumber":316,"oldContent":"              ),"},{"type":"DELETE","lineNumber":318,"oldContent":"  }"},{"type":"DELETE","lineNumber":320,"oldContent":"              ],"},{"type":"DELETE","lineNumber":322,"oldContent":"}"},{"type":"DELETE","lineNumber":324,"oldContent":"            ),"},{"type":"DELETE","lineNumber":326,"oldContent":""},{"type":"DELETE","lineNumber":328,"oldContent":"      decoration: BoxDecoration("},{"type":"DELETE","lineNumber":330,"oldContent":"          "},{"type":"DELETE","lineNumber":332,"oldContent":"            ),"},{"type":"DELETE","lineNumber":334,"oldContent":"          // Post Actions"},{"type":"DELETE","lineNumber":336,"oldContent":"      padding: const EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":338,"oldContent":"          Padding("},{"type":"DELETE","lineNumber":340,"oldContent":"          ),"},{"type":"DELETE","lineNumber":342,"oldContent":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"DELETE","lineNumber":344,"oldContent":"      ),"},{"type":"DELETE","lineNumber":346,"oldContent":"            child: Row("},{"type":"DELETE","lineNumber":348,"oldContent":"      margin: const EdgeInsets.all(16),"},{"type":"DELETE","lineNumber":350,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":352,"oldContent":"        ],"},{"type":"DELETE","lineNumber":354,"oldContent":"                IconButton("},{"type":"DELETE","lineNumber":356,"oldContent":"    return Container("},{"type":"DELETE","lineNumber":357,"oldContent":"                  icon: Icon("},{"type":"DELETE","lineNumber":358,"oldContent":"      ),"},{"type":"DELETE","lineNumber":359,"oldContent":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"DELETE","lineNumber":360,"oldContent":"    "},{"type":"DELETE","lineNumber":361,"oldContent":"                        ? Icons.favorite"},{"type":"DELETE","lineNumber":362,"oldContent":"    );"},{"type":"DELETE","lineNumber":363,"oldContent":"                        : Icons.favorite_border,"},{"type":"DELETE","lineNumber":364,"oldContent":"    ];"},{"type":"DELETE","lineNumber":365,"oldContent":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"DELETE","lineNumber":366,"oldContent":"              ],"},{"type":"DELETE","lineNumber":367,"oldContent":"                        ? Colors.red"},{"type":"DELETE","lineNumber":368,"oldContent":"  }"},{"type":"DELETE","lineNumber":369,"oldContent":"                        : null,"},{"type":"DELETE","lineNumber":370,"oldContent":"      {'action': 'added', 'name': 'Sarah', 'relation': 'Sister', 'time': '2d ago'},"},{"type":"INSERT","lineNumber":379,"content":"  Widget _buildPostItem(PostModel post) {"},{"type":"INSERT","lineNumber":380,"content":"    return Card("},{"type":"INSERT","lineNumber":381,"content":"      margin: const EdgeInsets.symmetric(vertical: 8, horizontal: 8),"},{"type":"INSERT","lineNumber":382,"content":"      child: Column("},{"type":"INSERT","lineNumber":383,"content":"        crossAxisAlignment: CrossAxisAlignment.start,"},{"type":"INSERT","lineNumber":384,"content":"        children: ["},{"type":"INSERT","lineNumber":385,"content":"          // Post Header"},{"type":"INSERT","lineNumber":386,"content":"          ListTile("},{"type":"INSERT","lineNumber":387,"content":"            leading: CircleAvatar("},{"type":"INSERT","lineNumber":388,"content":"              backgroundImage: post.userImageUrl != null"},{"type":"INSERT","lineNumber":389,"content":"                  ? NetworkImage(post.userImageUrl!)"},{"type":"INSERT","lineNumber":390,"content":"                  : null,"},{"type":"INSERT","lineNumber":391,"content":"              child: post.userImageUrl == null"},{"type":"INSERT","lineNumber":392,"content":"                  ? const Icon(Icons.person)"},{"type":"INSERT","lineNumber":393,"content":"                  : null,"},{"type":"INSERT","lineNumber":394,"content":"            ),"},{"type":"INSERT","lineNumber":395,"content":"            title: Text("},{"type":"INSERT","lineNumber":396,"content":"              post.userName,"},{"type":"INSERT","lineNumber":397,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":398,"content":"                fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":399,"content":"              ),"},{"type":"INSERT","lineNumber":400,"content":"            ),"},{"type":"INSERT","lineNumber":401,"content":"            subtitle: Text("},{"type":"INSERT","lineNumber":402,"content":"              '${post.createdAt.day}/${post.createdAt.month}/${post.createdAt.year}',"},{"type":"INSERT","lineNumber":403,"content":"              style: GoogleFonts.poppins(fontSize: 12),"},{"type":"INSERT","lineNumber":404,"content":"            ),"},{"type":"DELETE","lineNumber":372,"oldContent":"  "},{"type":"DELETE","lineNumber":373,"oldContent":"                    // TODO: Implement like functionality"},{"type":"DELETE","lineNumber":374,"oldContent":"          // Bottom Navigation"},{"type":"DELETE","lineNumber":375,"oldContent":"      {'action': 'updated', 'name': 'Family Photo', 'relation': 'Album', 'time': '1d ago'},"},{"type":"DELETE","lineNumber":376,"oldContent":"          Positioned("},{"type":"DELETE","lineNumber":377,"oldContent":"                const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":378,"oldContent":"  Widget _buildPersonChip(String name) {"},{"type":"DELETE","lineNumber":379,"oldContent":"                IconButton("},{"type":"DELETE","lineNumber":380,"oldContent":"            left: 0,"},{"type":"DELETE","lineNumber":381,"oldContent":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"DELETE","lineNumber":382,"oldContent":"      {'action': 'added', 'name': 'John Doe', 'relation': 'Uncle', 'time': '2h ago'},"},{"type":"DELETE","lineNumber":383,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":385,"oldContent":"            right: 0,"},{"type":"DELETE","lineNumber":387,"oldContent":"                    // TODO: Implement comment functionality"},{"type":"DELETE","lineNumber":389,"oldContent":"    return Container("},{"type":"DELETE","lineNumber":391,"oldContent":"                  },"},{"type":"DELETE","lineNumber":393,"oldContent":"            bottom: 0,"},{"type":"DELETE","lineNumber":395,"oldContent":"    final activities = ["},{"type":"DELETE","lineNumber":397,"oldContent":"                const Spacer(),"},{"type":"DELETE","lineNumber":399,"oldContent":"            child: Container("},{"type":"DELETE","lineNumber":401,"oldContent":"                Text("},{"type":"DELETE","lineNumber":403,"oldContent":"      padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),"},{"type":"DELETE","lineNumber":405,"oldContent":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"DELETE","lineNumber":407,"oldContent":"              decoration: BoxDecoration("},{"type":"DELETE","lineNumber":409,"oldContent":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"DELETE","lineNumber":411,"oldContent":"  Widget _buildRecentActivity() {"},{"type":"DELETE","lineNumber":413,"oldContent":"                boxShadow: ["},{"type":"DELETE","lineNumber":415,"oldContent":"              ],"},{"type":"DELETE","lineNumber":417,"oldContent":"      decoration: BoxDecoration("},{"type":"INSERT","lineNumber":423,"content":"                    width: double.infinity,"},{"type":"INSERT","lineNumber":424,"content":"                  );"},{"type":"INSERT","lineNumber":425,"content":"                },"},{"type":"INSERT","lineNumber":426,"content":"              ),"},{"type":"DELETE","lineNumber":419,"oldContent":"                  BoxShadow("},{"type":"DELETE","lineNumber":420,"oldContent":"  "},{"type":"DELETE","lineNumber":421,"oldContent":"        ],"},{"type":"DELETE","lineNumber":422,"oldContent":"                    color: Colors.grey.withOpacity(0.2),"},{"type":"DELETE","lineNumber":423,"oldContent":"        color: Colors.grey[200],"},{"type":"DELETE","lineNumber":424,"oldContent":"                    spreadRadius: 1,"},{"type":"DELETE","lineNumber":425,"oldContent":"  }"},{"type":"DELETE","lineNumber":426,"oldContent":"                    blurRadius: 5,"},{"type":"DELETE","lineNumber":427,"oldContent":"        borderRadius: BorderRadius.circular(16),"},{"type":"DELETE","lineNumber":428,"oldContent":"                    offset: const Offset(0, -2),"},{"type":"DELETE","lineNumber":429,"oldContent":"    );"},{"type":"INSERT","lineNumber":428,"content":"          "},{"type":"INSERT","lineNumber":429,"content":"          // Post Actions"},{"type":"INSERT","lineNumber":430,"content":"          Padding("},{"type":"INSERT","lineNumber":431,"content":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":432,"content":"            child: Row("},{"type":"INSERT","lineNumber":433,"content":"              children: ["},{"type":"INSERT","lineNumber":434,"content":"                IconButton("},{"type":"INSERT","lineNumber":435,"content":"                  icon: Icon("},{"type":"INSERT","lineNumber":436,"content":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":437,"content":"                        ? Icons.favorite"},{"type":"INSERT","lineNumber":438,"content":"                        : Icons.favorite_border,"},{"type":"INSERT","lineNumber":439,"content":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":440,"content":"                        ? Colors.red"},{"type":"INSERT","lineNumber":441,"content":"                        : null,"},{"type":"DELETE","lineNumber":431,"oldContent":"      ),"},{"type":"DELETE","lineNumber":432,"oldContent":"                ],"},{"type":"DELETE","lineNumber":433,"oldContent":"      child: Text(name, style: const TextStyle(fontSize: 12)),"},{"type":"DELETE","lineNumber":434,"oldContent":"              ),"},{"type":"DELETE","lineNumber":435,"oldContent":"        ],"},{"type":"DELETE","lineNumber":436,"oldContent":"              child: BottomAppBar("},{"type":"DELETE","lineNumber":437,"oldContent":"          ),"},{"type":"DELETE","lineNumber":438,"oldContent":"                height: 70,"},{"type":"INSERT","lineNumber":443,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":444,"content":"                    // TODO: Implement like functionality"},{"type":"INSERT","lineNumber":445,"content":"                  },"},{"type":"INSERT","lineNumber":446,"content":"                ),"},{"type":"INSERT","lineNumber":447,"content":"                const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":448,"content":"                IconButton("},{"type":"INSERT","lineNumber":449,"content":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"INSERT","lineNumber":450,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":451,"content":"                    // TODO: Implement comment functionality"},{"type":"INSERT","lineNumber":452,"content":"                  },"},{"type":"INSERT","lineNumber":453,"content":"                ),"},{"type":"INSERT","lineNumber":454,"content":"                const Spacer(),"},{"type":"INSERT","lineNumber":455,"content":"                Text("},{"type":"INSERT","lineNumber":456,"content":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"INSERT","lineNumber":457,"content":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"INSERT","lineNumber":458,"content":"                ),"},{"type":"INSERT","lineNumber":459,"content":"              ],"},{"type":"DELETE","lineNumber":440,"oldContent":"                color: Colors.white,"},{"type":"DELETE","lineNumber":441,"oldContent":"              child: const Icon(Icons.add, color: Colors.white, size: 30),"},{"type":"DELETE","lineNumber":442,"oldContent":"                shape: const CircularNotchedRectangle(),"},{"type":"DELETE","lineNumber":443,"oldContent":"              backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":444,"oldContent":"                notchMargin: 10,"},{"type":"DELETE","lineNumber":445,"oldContent":"              onPressed: () {},"},{"type":"DELETE","lineNumber":446,"oldContent":"                child: Row("},{"type":"DELETE","lineNumber":447,"oldContent":"            child: FloatingActionButton("},{"type":"DELETE","lineNumber":448,"oldContent":"                  mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"DELETE","lineNumber":449,"oldContent":"            bottom: 25,"},{"type":"DELETE","lineNumber":450,"oldContent":"                  children: ["},{"type":"DELETE","lineNumber":451,"oldContent":"            right: 0,"},{"type":"DELETE","lineNumber":452,"oldContent":"                    _buildNavItem(Icons.home_filled, 'Home', isSelected: true),"},{"type":"DELETE","lineNumber":453,"oldContent":"            left: 0,"},{"type":"DELETE","lineNumber":454,"oldContent":"                    _buildNavItem(Icons.family_restroom, 'Family'),"},{"type":"DELETE","lineNumber":455,"oldContent":"          Positioned("},{"type":"DELETE","lineNumber":456,"oldContent":"                    const SizedBox(width: 40), // Space for FAB"},{"type":"INSERT","lineNumber":461,"content":"          ),"},{"type":"DELETE","lineNumber":458,"oldContent":"          // Floating Action Button"},{"type":"DELETE","lineNumber":460,"oldContent":"                    _buildNavItem(Icons.chat_bubble_outline, 'Chat'),"},{"type":"DELETE","lineNumber":462,"oldContent":"              ),"},{"type":"DELETE","lineNumber":464,"oldContent":"                    _buildNavItem(Icons.person_outline, 'Profile'),"},{"type":"DELETE","lineNumber":466,"oldContent":"                ),"},{"type":"DELETE","lineNumber":468,"oldContent":"                  ],"}]},{"timestamp":1754655289257,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:google_fonts/google_fonts.dart';","oldContent":"import 'package:family_tree_firebase/features/home/domain/models/story_model.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:cloud_firestore/cloud_firestore.dart';"},{"type":"INSERT","lineNumber":4,"content":"import 'package:firebase_auth/firebase_auth.dart';"},{"type":"INSERT","lineNumber":10,"content":"import 'package:family_tree_firebase/features/family/presentation/screens/create_family_screen.dart';"},{"type":"DELETE","lineNumber":10,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/screens/create_family_screen.dart';"},{"type":"DELETE","lineNumber":18,"oldContent":"  final StoryService _storyService = StoryService();"},{"type":"DELETE","lineNumber":20,"oldContent":""},{"type":"INSERT","lineNumber":21,"content":"  final StoryService _storyService = StoryService();"},{"type":"INSERT","lineNumber":23,"content":""},{"type":"INSERT","lineNumber":25,"content":"  void initState() {"},{"type":"INSERT","lineNumber":26,"content":"    super.initState();"},{"type":"DELETE","lineNumber":26,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":28,"oldContent":"    super.initState();"},{"type":"DELETE","lineNumber":30,"oldContent":"    "},{"type":"DELETE","lineNumber":33,"oldContent":"    // Show welcome screen if not authenticated"},{"type":"DELETE","lineNumber":37,"oldContent":"    if (authState.status != AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":39,"oldContent":"      return _buildWelcomeScreen();"},{"type":"DELETE","lineNumber":41,"oldContent":"    }"},{"type":"DELETE","lineNumber":43,"oldContent":""},{"type":"DELETE","lineNumber":45,"oldContent":"    // Show home feed if authenticated"},{"type":"DELETE","lineNumber":48,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":50,"oldContent":"        title: Text("},{"type":"DELETE","lineNumber":52,"oldContent":"          'Family Feed',"},{"type":"DELETE","lineNumber":54,"oldContent":"          style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":56,"oldContent":"            fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":58,"oldContent":"            color: Colors.black87,"},{"type":"DELETE","lineNumber":60,"oldContent":"        backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":62,"oldContent":"        elevation: 0,"},{"type":"DELETE","lineNumber":65,"oldContent":"      ),"},{"type":"DELETE","lineNumber":68,"oldContent":"      body: SingleChildScrollView("},{"type":"DELETE","lineNumber":70,"oldContent":"        child: Column("},{"type":"DELETE","lineNumber":72,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":74,"oldContent":"            // Stories Section"},{"type":"DELETE","lineNumber":76,"oldContent":"            _buildStoriesSection(),"},{"type":"DELETE","lineNumber":78,"oldContent":"            const Divider(height: 1),"},{"type":"INSERT","lineNumber":60,"content":"    "},{"type":"INSERT","lineNumber":61,"content":"    // Show welcome screen if not authenticated"},{"type":"INSERT","lineNumber":62,"content":"    if (authState.status != AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":63,"content":"      return _buildWelcomeScreen();"},{"type":"INSERT","lineNumber":64,"content":"    }"},{"type":"INSERT","lineNumber":65,"content":"    "},{"type":"INSERT","lineNumber":66,"content":"    // Show loading indicator while checking family status"},{"type":"INSERT","lineNumber":67,"content":"    if (_familyId == null) {"},{"type":"INSERT","lineNumber":68,"content":"      return const Scaffold("},{"type":"INSERT","lineNumber":69,"content":"        body: Center(child: CircularProgressIndicator()),"},{"type":"INSERT","lineNumber":70,"content":"      );"},{"type":"INSERT","lineNumber":71,"content":"    }"},{"type":"INSERT","lineNumber":72,"content":"    "},{"type":"INSERT","lineNumber":73,"content":"    // Show family creation prompt if user is authenticated but has no family"},{"type":"INSERT","lineNumber":74,"content":"    if (_familyId == null || _familyId!.isEmpty) {"},{"type":"INSERT","lineNumber":75,"content":"      return _buildNoFamilyScreen();"},{"type":"INSERT","lineNumber":76,"content":"    }"},{"type":"INSERT","lineNumber":77,"content":""},{"type":"INSERT","lineNumber":78,"content":"    // Show home feed if authenticated"},{"type":"INSERT","lineNumber":79,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":80,"content":"      appBar: AppBar("},{"type":"INSERT","lineNumber":81,"content":"        title: Text("},{"type":"INSERT","lineNumber":82,"content":"          'Family Feed',"},{"type":"INSERT","lineNumber":83,"content":"          style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":84,"content":"            fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":85,"content":"            color: Colors.black87,"},{"type":"INSERT","lineNumber":86,"content":"          ),"},{"type":"INSERT","lineNumber":87,"content":"        ),"},{"type":"INSERT","lineNumber":88,"content":"        backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":89,"content":"        elevation: 0,"},{"type":"INSERT","lineNumber":90,"content":"      ),"},{"type":"INSERT","lineNumber":91,"content":"      body: SingleChildScrollView("},{"type":"INSERT","lineNumber":92,"content":"        child: Column("},{"type":"INSERT","lineNumber":93,"content":"          children: ["},{"type":"INSERT","lineNumber":94,"content":"            // Stories Section"},{"type":"INSERT","lineNumber":95,"content":"            _buildStoriesSection(),"},{"type":"INSERT","lineNumber":96,"content":"            const Divider(height: 1),"},{"type":"DELETE","lineNumber":86,"oldContent":"    "},{"type":"DELETE","lineNumber":88,"oldContent":"    // Show loading indicator while checking family status"},{"type":"DELETE","lineNumber":90,"oldContent":"    if (_familyId == null) {"},{"type":"DELETE","lineNumber":92,"oldContent":"      return const Scaffold("},{"type":"DELETE","lineNumber":94,"oldContent":"        body: Center(child: CircularProgressIndicator()),"},{"type":"DELETE","lineNumber":96,"oldContent":"      );"},{"type":"DELETE","lineNumber":98,"oldContent":"    }"},{"type":"DELETE","lineNumber":99,"oldContent":"    "},{"type":"DELETE","lineNumber":101,"oldContent":"    // Show family creation prompt if user is authenticated but has no family"},{"type":"INSERT","lineNumber":110,"content":"        builder: (context, snapshot) {"},{"type":"DELETE","lineNumber":103,"oldContent":"    if (_familyId == null || _familyId!.isEmpty) {"},{"type":"DELETE","lineNumber":105,"oldContent":"      return _buildNoFamilyScreen();"},{"type":"DELETE","lineNumber":107,"oldContent":"    }"},{"type":"DELETE","lineNumber":112,"oldContent":"      appBar: AppBar("},{"type":"DELETE","lineNumber":119,"oldContent":"          ),"},{"type":"DELETE","lineNumber":121,"oldContent":"        ),"},{"type":"DELETE","lineNumber":145,"oldContent":"        builder: (context, snapshot) {"},{"type":"INSERT","lineNumber":169,"content":"      builder: (context, snapshot) {"},{"type":"DELETE","lineNumber":186,"oldContent":"  Widget _buildWelcomeScreen() {"},{"type":"DELETE","lineNumber":187,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":188,"oldContent":"      body: Container("},{"type":"DELETE","lineNumber":189,"oldContent":"        width: double.infinity,"},{"type":"DELETE","lineNumber":190,"oldContent":"        padding: const EdgeInsets.all(24),"},{"type":"DELETE","lineNumber":191,"oldContent":"        decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":192,"oldContent":"          gradient: LinearGradient("},{"type":"DELETE","lineNumber":193,"oldContent":"            begin: Alignment.topCenter,"},{"type":"DELETE","lineNumber":194,"oldContent":"            end: Alignment.bottomCenter,"},{"type":"DELETE","lineNumber":195,"oldContent":"      builder: (context, snapshot) {"},{"type":"DELETE","lineNumber":196,"oldContent":"            colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"DELETE","lineNumber":197,"oldContent":"          ),"},{"type":"DELETE","lineNumber":198,"oldContent":"        ),"},{"type":"DELETE","lineNumber":199,"oldContent":"        child: SafeArea("},{"type":"DELETE","lineNumber":200,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":201,"oldContent":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":202,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":203,"oldContent":"              // App Logo and Title"},{"type":"DELETE","lineNumber":204,"oldContent":"              Column("},{"type":"DELETE","lineNumber":205,"oldContent":"                children: ["},{"type":"DELETE","lineNumber":208,"oldContent":"                  // Replace with your app logo"},{"type":"DELETE","lineNumber":211,"oldContent":"                  Container("},{"type":"DELETE","lineNumber":214,"oldContent":"                    width: 150,"},{"type":"DELETE","lineNumber":217,"oldContent":"                    height: 150,"},{"type":"DELETE","lineNumber":220,"oldContent":"                    decoration: BoxDecoration("},{"type":"DELETE","lineNumber":223,"oldContent":"                      color: Colors.white24,"},{"type":"DELETE","lineNumber":226,"oldContent":"                      borderRadius: BorderRadius.circular(20),"},{"type":"DELETE","lineNumber":228,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":231,"oldContent":"                    child: const Icon(Icons.family_restroom, size: 60, color: Colors.white),"},{"type":"DELETE","lineNumber":234,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":237,"oldContent":"                  const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":239,"oldContent":"                  Text("},{"type":"DELETE","lineNumber":242,"oldContent":"                    'Welcome to Family Tree',"},{"type":"DELETE","lineNumber":245,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":247,"oldContent":"                      color: Colors.white,"},{"type":"DELETE","lineNumber":250,"oldContent":"                      fontSize: 24,"},{"type":"DELETE","lineNumber":253,"oldContent":"                      fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":255,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":258,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":261,"oldContent":"                  const SizedBox(height: 10),"},{"type":"DELETE","lineNumber":264,"oldContent":"                  Padding("},{"type":"DELETE","lineNumber":266,"oldContent":"                    padding: const EdgeInsets.symmetric(horizontal: 40.0),"},{"type":"DELETE","lineNumber":269,"oldContent":"                    child: Text("},{"type":"DELETE","lineNumber":271,"oldContent":"                      'Connect with your family and create your family tree',"},{"type":"DELETE","lineNumber":274,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":277,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":279,"oldContent":"                        color: Colors.white.withOpacity(0.8),"},{"type":"DELETE","lineNumber":282,"oldContent":"                        fontSize: 16,"},{"type":"DELETE","lineNumber":285,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":287,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":290,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":293,"oldContent":"                ],"},{"type":"DELETE","lineNumber":295,"oldContent":"              ),"},{"type":"DELETE","lineNumber":298,"oldContent":"              const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":301,"oldContent":"              // Join Now Button"},{"type":"DELETE","lineNumber":303,"oldContent":"              SizedBox("},{"type":"DELETE","lineNumber":306,"oldContent":"                width: double.infinity,"},{"type":"DELETE","lineNumber":309,"oldContent":"                child: ElevatedButton("},{"type":"DELETE","lineNumber":311,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":314,"oldContent":"                    // TODO: Navigate to join family screen"},{"type":"DELETE","lineNumber":317,"oldContent":"                  },"},{"type":"DELETE","lineNumber":319,"oldContent":"                  style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":322,"oldContent":"                    backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":325,"oldContent":"                    foregroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":266,"content":"  Widget _buildWelcomeScreen() {"},{"type":"INSERT","lineNumber":267,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":268,"content":"      body: Container("},{"type":"INSERT","lineNumber":269,"content":"        width: double.infinity,"},{"type":"INSERT","lineNumber":270,"content":"        padding: const EdgeInsets.all(24),"},{"type":"INSERT","lineNumber":271,"content":"        decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":272,"content":"          gradient: LinearGradient("},{"type":"INSERT","lineNumber":273,"content":"            begin: Alignment.topCenter,"},{"type":"INSERT","lineNumber":274,"content":"            end: Alignment.bottomCenter,"},{"type":"INSERT","lineNumber":275,"content":"            colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"INSERT","lineNumber":276,"content":"          ),"},{"type":"INSERT","lineNumber":277,"content":"        ),"},{"type":"INSERT","lineNumber":278,"content":"        child: SafeArea("},{"type":"INSERT","lineNumber":279,"content":"          child: Column("},{"type":"INSERT","lineNumber":280,"content":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":281,"content":"            children: ["},{"type":"INSERT","lineNumber":282,"content":"              // App Logo and Title"},{"type":"INSERT","lineNumber":283,"content":"              Column("},{"type":"INSERT","lineNumber":284,"content":"                children: ["},{"type":"INSERT","lineNumber":285,"content":"                  // Replace with your app logo"},{"type":"INSERT","lineNumber":286,"content":"                  Container("},{"type":"INSERT","lineNumber":287,"content":"                    width: 150,"},{"type":"INSERT","lineNumber":288,"content":"                    height: 150,"},{"type":"INSERT","lineNumber":289,"content":"                    decoration: BoxDecoration("},{"type":"INSERT","lineNumber":290,"content":"                      color: Colors.white24,"},{"type":"INSERT","lineNumber":291,"content":"                      borderRadius: BorderRadius.circular(20),"},{"type":"INSERT","lineNumber":292,"content":"                    ),"},{"type":"INSERT","lineNumber":293,"content":"                    child: const Icon(Icons.family_restroom, size: 60, color: Colors.white),"},{"type":"INSERT","lineNumber":294,"content":"                  ),"},{"type":"INSERT","lineNumber":295,"content":"                  const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":296,"content":"                  Text("},{"type":"INSERT","lineNumber":297,"content":"                    'Welcome to Family Tree',"},{"type":"INSERT","lineNumber":298,"content":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":299,"content":"                      color: Colors.white,"},{"type":"INSERT","lineNumber":300,"content":"                      fontSize: 24,"},{"type":"INSERT","lineNumber":301,"content":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":302,"content":"                    ),"},{"type":"INSERT","lineNumber":303,"content":"                  ),"},{"type":"INSERT","lineNumber":304,"content":"                  const SizedBox(height: 10),"},{"type":"INSERT","lineNumber":305,"content":"                  Padding("},{"type":"INSERT","lineNumber":306,"content":"                    padding: const EdgeInsets.symmetric(horizontal: 40.0),"},{"type":"INSERT","lineNumber":307,"content":"                    child: Text("},{"type":"INSERT","lineNumber":308,"content":"                      'Connect with your family and create your family tree',"},{"type":"INSERT","lineNumber":309,"content":"                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":310,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":311,"content":"                        color: Colors.white.withOpacity(0.8),"},{"type":"INSERT","lineNumber":312,"content":"                        fontSize: 16,"},{"type":"INSERT","lineNumber":313,"content":"                      ),"},{"type":"INSERT","lineNumber":314,"content":"                    ),"},{"type":"INSERT","lineNumber":315,"content":"                  ),"},{"type":"INSERT","lineNumber":316,"content":"                ],"},{"type":"INSERT","lineNumber":317,"content":"              ),"},{"type":"INSERT","lineNumber":318,"content":"              const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":319,"content":"              // Join Now Button"},{"type":"INSERT","lineNumber":320,"content":"              SizedBox("},{"type":"INSERT","lineNumber":321,"content":"                width: double.infinity,"},{"type":"INSERT","lineNumber":322,"content":"                child: ElevatedButton("},{"type":"INSERT","lineNumber":323,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":324,"content":"                    // TODO: Navigate to join family screen"},{"type":"INSERT","lineNumber":325,"content":"                  },"},{"type":"INSERT","lineNumber":326,"content":"                  style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":327,"content":"                    backgroundColor: Colors.white,"},{"type":"INSERT","lineNumber":328,"content":"                    foregroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":377,"oldContent":"          ),"},{"type":"DELETE","lineNumber":378,"oldContent":"                ),"},{"type":"MODIFY","lineNumber":379,"content":"  }","oldContent":"                        : null,"},{"type":"INSERT","lineNumber":380,"content":""},{"type":"DELETE","lineNumber":386,"oldContent":"          "},{"type":"DELETE","lineNumber":389,"oldContent":"                },"},{"type":"DELETE","lineNumber":392,"oldContent":"                    width: double.infinity,"},{"type":"DELETE","lineNumber":395,"oldContent":"              style: GoogleFonts.poppins(fontSize: 12),"},{"type":"DELETE","lineNumber":398,"oldContent":"            subtitle: Text("},{"type":"DELETE","lineNumber":401,"oldContent":"              ),"},{"type":"INSERT","lineNumber":400,"content":"                fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":401,"content":"              ),"},{"type":"INSERT","lineNumber":402,"content":"            ),"},{"type":"INSERT","lineNumber":403,"content":"            subtitle: Text("},{"type":"INSERT","lineNumber":404,"content":"              '${post.createdAt.day}/${post.createdAt.month}/${post.createdAt.year}',"},{"type":"INSERT","lineNumber":405,"content":"              style: GoogleFonts.poppins(fontSize: 12),"},{"type":"INSERT","lineNumber":406,"content":"            ),"},{"type":"INSERT","lineNumber":407,"content":"          ),"},{"type":"INSERT","lineNumber":408,"content":"          "},{"type":"INSERT","lineNumber":409,"content":"          // Post Content"},{"type":"INSERT","lineNumber":410,"content":"          Padding("},{"type":"INSERT","lineNumber":411,"content":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":412,"content":"            child: Text(post.content),"},{"type":"INSERT","lineNumber":413,"content":"          ),"},{"type":"INSERT","lineNumber":414,"content":"          "},{"type":"INSERT","lineNumber":415,"content":"          // Post Images (if any)"},{"type":"INSERT","lineNumber":416,"content":"          if (post.imageUrls != null && post.imageUrls!.isNotEmpty)"},{"type":"INSERT","lineNumber":417,"content":"            SizedBox("},{"type":"INSERT","lineNumber":418,"content":"              height: 200,"},{"type":"INSERT","lineNumber":419,"content":"              child: PageView.builder("},{"type":"INSERT","lineNumber":420,"content":"                itemCount: post.imageUrls!.length,"},{"type":"INSERT","lineNumber":421,"content":"                itemBuilder: (context, index) {"},{"type":"INSERT","lineNumber":422,"content":"                  return Image.network("},{"type":"INSERT","lineNumber":423,"content":"                    post.imageUrls![index],"},{"type":"INSERT","lineNumber":424,"content":"                    fit: BoxFit.cover,"},{"type":"INSERT","lineNumber":425,"content":"                    width: double.infinity,"},{"type":"INSERT","lineNumber":426,"content":"                  );"},{"type":"INSERT","lineNumber":427,"content":"                },"},{"type":"INSERT","lineNumber":428,"content":"              ),"},{"type":"INSERT","lineNumber":429,"content":"            ),"},{"type":"INSERT","lineNumber":430,"content":"          "},{"type":"INSERT","lineNumber":431,"content":"          // Post Actions"},{"type":"INSERT","lineNumber":432,"content":"          Padding("},{"type":"INSERT","lineNumber":433,"content":"            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),"},{"type":"INSERT","lineNumber":434,"content":"            child: Row("},{"type":"INSERT","lineNumber":435,"content":"              children: ["},{"type":"INSERT","lineNumber":436,"content":"                IconButton("},{"type":"INSERT","lineNumber":437,"content":"                  icon: Icon("},{"type":"INSERT","lineNumber":438,"content":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":439,"content":"                        ? Icons.favorite"},{"type":"INSERT","lineNumber":440,"content":"                        : Icons.favorite_border,"},{"type":"INSERT","lineNumber":441,"content":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":442,"content":"                        ? Colors.red"},{"type":"INSERT","lineNumber":443,"content":"                        : null,"},{"type":"INSERT","lineNumber":444,"content":"                  ),"},{"type":"INSERT","lineNumber":445,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":446,"content":"                    // TODO: Implement like functionality"},{"type":"INSERT","lineNumber":447,"content":"                  },"},{"type":"INSERT","lineNumber":448,"content":"                ),"},{"type":"INSERT","lineNumber":449,"content":"                const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":450,"content":"                IconButton("},{"type":"INSERT","lineNumber":451,"content":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"INSERT","lineNumber":452,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":453,"content":"                    // TODO: Implement comment functionality"},{"type":"INSERT","lineNumber":454,"content":"                  },"},{"type":"INSERT","lineNumber":455,"content":"                ),"},{"type":"INSERT","lineNumber":456,"content":"                const Spacer(),"},{"type":"INSERT","lineNumber":457,"content":"                Text("},{"type":"INSERT","lineNumber":458,"content":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"INSERT","lineNumber":459,"content":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"INSERT","lineNumber":460,"content":"                ),"},{"type":"INSERT","lineNumber":461,"content":"              ],"},{"type":"INSERT","lineNumber":462,"content":"            ),"},{"type":"INSERT","lineNumber":463,"content":"          ),"},{"type":"INSERT","lineNumber":464,"content":"        ],"},{"type":"INSERT","lineNumber":465,"content":"      ),"},{"type":"INSERT","lineNumber":466,"content":"    );"},{"type":"INSERT","lineNumber":467,"content":"  }"},{"type":"INSERT","lineNumber":468,"content":"}"},{"type":"INSERT","lineNumber":469,"content":""}]},{"timestamp":1754655304346,"changes":[{"type":"MODIFY","lineNumber":5,"content":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_bloc.dart';","oldContent":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_bloc.dart';"},{"type":"INSERT","lineNumber":10,"content":"import 'package:family_tree_firebase/features/family/presentation/screens/create_family_screen.dart';"},{"type":"DELETE","lineNumber":12,"oldContent":"import 'package:family_tree_firebase/features/family/presentation/screens/create_family_screen.dart';"},{"type":"MODIFY","lineNumber":24,"content":"  @override","oldContent":"  @override"},{"type":"INSERT","lineNumber":25,"content":"  void initState() {"},{"type":"INSERT","lineNumber":26,"content":"    super.initState();"},{"type":"DELETE","lineNumber":27,"oldContent":"  void initState() {"},{"type":"DELETE","lineNumber":29,"oldContent":"    super.initState();"},{"type":"INSERT","lineNumber":49,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":50,"content":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":51,"content":"          SnackBar(content: Text('Error loading family data: $e')),"},{"type":"INSERT","lineNumber":52,"content":"        );"},{"type":"INSERT","lineNumber":53,"content":"      }"},{"type":"INSERT","lineNumber":54,"content":"    }"},{"type":"INSERT","lineNumber":55,"content":"  }"},{"type":"INSERT","lineNumber":56,"content":""},{"type":"INSERT","lineNumber":57,"content":"  @override"},{"type":"INSERT","lineNumber":58,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":59,"content":"    final authState = context.watch<AuthBloc>().state;"},{"type":"DELETE","lineNumber":51,"oldContent":"      if (mounted) {"},{"type":"DELETE","lineNumber":54,"oldContent":"        ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":56,"oldContent":"          SnackBar(content: Text('Error loading family data: $e')),"},{"type":"DELETE","lineNumber":59,"oldContent":"        );"},{"type":"DELETE","lineNumber":61,"oldContent":"      }"},{"type":"DELETE","lineNumber":64,"oldContent":"    }"},{"type":"DELETE","lineNumber":67,"oldContent":"  }"},{"type":"DELETE","lineNumber":70,"oldContent":""},{"type":"DELETE","lineNumber":73,"oldContent":"  @override"},{"type":"DELETE","lineNumber":76,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":79,"oldContent":"    final authState = context.watch<AuthBloc>().state;"},{"type":"DELETE","lineNumber":81,"oldContent":"            // Posts Feed"},{"type":"DELETE","lineNumber":83,"oldContent":"            _buildPostsFeed(),"},{"type":"DELETE","lineNumber":85,"oldContent":"          ],"},{"type":"DELETE","lineNumber":87,"oldContent":"        ),"},{"type":"DELETE","lineNumber":89,"oldContent":"      ),"},{"type":"DELETE","lineNumber":91,"oldContent":"    );"},{"type":"DELETE","lineNumber":94,"oldContent":"  }"},{"type":"DELETE","lineNumber":97,"oldContent":""},{"type":"DELETE","lineNumber":100,"oldContent":"  Widget _buildStoriesSection() {"},{"type":"DELETE","lineNumber":103,"oldContent":"    return SizedBox("},{"type":"DELETE","lineNumber":106,"oldContent":"      height: 100,"},{"type":"INSERT","lineNumber":97,"content":"            // Posts Feed"},{"type":"INSERT","lineNumber":98,"content":"            _buildPostsFeed(),"},{"type":"INSERT","lineNumber":99,"content":"          ],"},{"type":"INSERT","lineNumber":100,"content":"        ),"},{"type":"INSERT","lineNumber":101,"content":"      ),"},{"type":"INSERT","lineNumber":102,"content":"    );"},{"type":"INSERT","lineNumber":103,"content":"  }"},{"type":"INSERT","lineNumber":104,"content":""},{"type":"INSERT","lineNumber":105,"content":"  Widget _buildStoriesSection() {"},{"type":"INSERT","lineNumber":106,"content":"    return SizedBox("},{"type":"INSERT","lineNumber":107,"content":"      height: 100,"},{"type":"INSERT","lineNumber":110,"content":"        builder: (context, snapshot) {"},{"type":"DELETE","lineNumber":115,"oldContent":"        builder: (context, snapshot) {"},{"type":"INSERT","lineNumber":169,"content":"      builder: (context, snapshot) {"},{"type":"DELETE","lineNumber":171,"oldContent":"      builder: (context, snapshot) {"},{"type":"INSERT","lineNumber":228,"content":"                      borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":229,"content":"                    ),"},{"type":"INSERT","lineNumber":230,"content":"                  ),"},{"type":"INSERT","lineNumber":231,"content":"                  child: const Text('Join Family'),"},{"type":"INSERT","lineNumber":232,"content":"                ),"},{"type":"INSERT","lineNumber":233,"content":"              ),"},{"type":"INSERT","lineNumber":234,"content":"              const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":235,"content":"              SizedBox("},{"type":"INSERT","lineNumber":236,"content":"                width: double.infinity,"},{"type":"INSERT","lineNumber":237,"content":"                child: OutlinedButton("},{"type":"INSERT","lineNumber":238,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":239,"content":"                    Navigator.push("},{"type":"INSERT","lineNumber":240,"content":"                      context,"},{"type":"INSERT","lineNumber":241,"content":"                      MaterialPageRoute("},{"type":"INSERT","lineNumber":242,"content":"                        builder: (context) => const CreateFamilyScreen(),"},{"type":"INSERT","lineNumber":243,"content":"                      ),"},{"type":"INSERT","lineNumber":244,"content":"                    );"},{"type":"INSERT","lineNumber":245,"content":"                  },"},{"type":"INSERT","lineNumber":246,"content":"                  style: OutlinedButton.styleFrom("},{"type":"INSERT","lineNumber":247,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":248,"content":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":249,"content":"                      borderRadius: BorderRadius.circular(30),"},{"type":"INSERT","lineNumber":250,"content":"                    ),"},{"type":"INSERT","lineNumber":251,"content":"                    side: const BorderSide(color: Color(0xFF6A11CB)),"},{"type":"INSERT","lineNumber":252,"content":"                  ),"},{"type":"INSERT","lineNumber":253,"content":"                  child: const Text("},{"type":"INSERT","lineNumber":254,"content":"                    'Create Family',"},{"type":"INSERT","lineNumber":255,"content":"                    style: TextStyle(color: Color(0xFF6A11CB)),"},{"type":"INSERT","lineNumber":256,"content":"                  ),"},{"type":"INSERT","lineNumber":257,"content":"                ),"},{"type":"INSERT","lineNumber":258,"content":"              ),"},{"type":"INSERT","lineNumber":259,"content":"            ],"},{"type":"INSERT","lineNumber":260,"content":"          ),"},{"type":"INSERT","lineNumber":261,"content":"        ),"},{"type":"INSERT","lineNumber":262,"content":"      ),"},{"type":"INSERT","lineNumber":263,"content":"    );"},{"type":"INSERT","lineNumber":264,"content":"  }"},{"type":"INSERT","lineNumber":265,"content":""},{"type":"INSERT","lineNumber":266,"content":"  Future<void> _showCreatePostDialog() async {"},{"type":"INSERT","lineNumber":267,"content":"    final TextEditingController _postController = TextEditingController();"},{"type":"INSERT","lineNumber":268,"content":"    "},{"type":"INSERT","lineNumber":269,"content":"    return showDialog("},{"type":"INSERT","lineNumber":270,"content":"      context: context,"},{"type":"INSERT","lineNumber":271,"content":"      builder: (context) {"},{"type":"INSERT","lineNumber":272,"content":"        return AlertDialog("},{"type":"INSERT","lineNumber":273,"content":"          title: const Text('Create Post'),"},{"type":"INSERT","lineNumber":274,"content":"          content: TextField("},{"type":"INSERT","lineNumber":275,"content":"            controller: _postController,"},{"type":"INSERT","lineNumber":276,"content":"            decoration: const InputDecoration("},{"type":"INSERT","lineNumber":277,"content":"              hintText: 'What\\'s on your mind?',"},{"type":"INSERT","lineNumber":278,"content":"              border: OutlineInputBorder(),"},{"type":"INSERT","lineNumber":279,"content":"            ),"},{"type":"INSERT","lineNumber":280,"content":"            maxLines: 4,"},{"type":"INSERT","lineNumber":281,"content":"          ),"},{"type":"INSERT","lineNumber":282,"content":"          actions: ["},{"type":"INSERT","lineNumber":283,"content":"            TextButton("},{"type":"INSERT","lineNumber":284,"content":"              onPressed: () => Navigator.pop(context),"},{"type":"INSERT","lineNumber":285,"content":"              child: const Text('Cancel'),"},{"type":"INSERT","lineNumber":286,"content":"            ),"},{"type":"INSERT","lineNumber":287,"content":"            ElevatedButton("},{"type":"INSERT","lineNumber":288,"content":"              onPressed: () async {"},{"type":"INSERT","lineNumber":289,"content":"                if (_postController.text.trim().isNotEmpty) {"},{"type":"INSERT","lineNumber":290,"content":"                  try {"},{"type":"INSERT","lineNumber":291,"content":"                    await _postService.createPost("},{"type":"INSERT","lineNumber":292,"content":"                      content: _postController.text.trim(),"},{"type":"INSERT","lineNumber":293,"content":"                      familyId: _familyId!,"},{"type":"INSERT","lineNumber":294,"content":"                    );"},{"type":"INSERT","lineNumber":295,"content":"                    if (mounted) {"},{"type":"INSERT","lineNumber":296,"content":"                      Navigator.pop(context);"},{"type":"INSERT","lineNumber":297,"content":"                      ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":298,"content":"                        const SnackBar(content: Text('Post created successfully!')),"},{"type":"INSERT","lineNumber":299,"content":"                      );"},{"type":"INSERT","lineNumber":300,"content":"                    }"},{"type":"INSERT","lineNumber":301,"content":"                  } catch (e) {"},{"type":"INSERT","lineNumber":302,"content":"                    if (mounted) {"},{"type":"INSERT","lineNumber":303,"content":"                      ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":304,"content":"                        SnackBar(content: Text('Error creating post: $e')),"},{"type":"INSERT","lineNumber":305,"content":"                      );"},{"type":"INSERT","lineNumber":306,"content":"                    }"},{"type":"INSERT","lineNumber":307,"content":"                  }"},{"type":"INSERT","lineNumber":308,"content":"                }"},{"type":"INSERT","lineNumber":309,"content":"              },"},{"type":"INSERT","lineNumber":310,"content":"              style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":311,"content":"                backgroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":312,"content":"              ),"},{"type":"INSERT","lineNumber":313,"content":"              child: const Text('Post'),"},{"type":"INSERT","lineNumber":314,"content":"            ),"},{"type":"INSERT","lineNumber":315,"content":"          ],"},{"type":"INSERT","lineNumber":316,"content":"        );"},{"type":"INSERT","lineNumber":317,"content":"      },"},{"type":"INSERT","lineNumber":318,"content":"    );"},{"type":"INSERT","lineNumber":319,"content":"  }"},{"type":"INSERT","lineNumber":320,"content":""},{"type":"DELETE","lineNumber":230,"oldContent":"                      borderRadius: BorderRadius.circular(30),"},{"type":"DELETE","lineNumber":232,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":235,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":238,"oldContent":"                  child: const Text('Join Family'),"},{"type":"DELETE","lineNumber":240,"oldContent":"                ),"},{"type":"DELETE","lineNumber":243,"oldContent":"              ),"},{"type":"DELETE","lineNumber":245,"oldContent":"              const SizedBox(height: 16),"},{"type":"DELETE","lineNumber":248,"oldContent":"              SizedBox("},{"type":"DELETE","lineNumber":251,"oldContent":"                width: double.infinity,"},{"type":"DELETE","lineNumber":253,"oldContent":"                child: OutlinedButton("},{"type":"DELETE","lineNumber":256,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":258,"oldContent":"                    Navigator.push("},{"type":"DELETE","lineNumber":261,"oldContent":"                      context,"},{"type":"DELETE","lineNumber":264,"oldContent":"                      MaterialPageRoute("},{"type":"DELETE","lineNumber":266,"oldContent":"                        builder: (context) => const CreateFamilyScreen(),"},{"type":"DELETE","lineNumber":269,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":271,"oldContent":"                    );"},{"type":"DELETE","lineNumber":274,"oldContent":"                  },"},{"type":"DELETE","lineNumber":277,"oldContent":"                  style: OutlinedButton.styleFrom("},{"type":"DELETE","lineNumber":279,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":282,"oldContent":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":284,"oldContent":"                      borderRadius: BorderRadius.circular(30),"},{"type":"DELETE","lineNumber":287,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":290,"oldContent":"                    side: const BorderSide(color: Color(0xFF6A11CB)),"},{"type":"DELETE","lineNumber":292,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":295,"oldContent":"                  child: const Text("},{"type":"DELETE","lineNumber":297,"oldContent":"                    'Create Family',"},{"type":"DELETE","lineNumber":300,"oldContent":"                    style: TextStyle(color: Color(0xFF6A11CB)),"},{"type":"DELETE","lineNumber":303,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":305,"oldContent":"                ),"},{"type":"DELETE","lineNumber":308,"oldContent":"              ),"},{"type":"DELETE","lineNumber":310,"oldContent":"            ],"},{"type":"DELETE","lineNumber":313,"oldContent":"          ),"},{"type":"DELETE","lineNumber":316,"oldContent":"        ),"},{"type":"DELETE","lineNumber":318,"oldContent":"      ),"},{"type":"DELETE","lineNumber":321,"oldContent":"    );"},{"type":"DELETE","lineNumber":323,"oldContent":"  }"},{"type":"DELETE","lineNumber":326,"oldContent":""},{"type":"DELETE","lineNumber":328,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":384,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":396,"oldContent":"                fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":452,"content":"            title: Text("},{"type":"INSERT","lineNumber":453,"content":"              post.userName,"},{"type":"INSERT","lineNumber":454,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":455,"content":"                fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":400,"oldContent":"            title: Text("},{"type":"DELETE","lineNumber":402,"oldContent":"              post.userName,"},{"type":"DELETE","lineNumber":404,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":406,"oldContent":""},{"type":"DELETE","lineNumber":408,"oldContent":"}"},{"type":"DELETE","lineNumber":410,"oldContent":"  }"},{"type":"DELETE","lineNumber":412,"oldContent":"    );"},{"type":"DELETE","lineNumber":414,"oldContent":"      ),"},{"type":"DELETE","lineNumber":416,"oldContent":"        ],"},{"type":"DELETE","lineNumber":418,"oldContent":"          ),"},{"type":"DELETE","lineNumber":420,"oldContent":"            ),"},{"type":"DELETE","lineNumber":422,"oldContent":"              ],"},{"type":"DELETE","lineNumber":424,"oldContent":"                ),"},{"type":"DELETE","lineNumber":426,"oldContent":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"DELETE","lineNumber":428,"oldContent":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"DELETE","lineNumber":430,"oldContent":"                Text("},{"type":"DELETE","lineNumber":432,"oldContent":"                const Spacer(),"},{"type":"DELETE","lineNumber":434,"oldContent":"                ),"},{"type":"DELETE","lineNumber":436,"oldContent":"                  },"},{"type":"DELETE","lineNumber":438,"oldContent":"                    // TODO: Implement comment functionality"},{"type":"DELETE","lineNumber":440,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":442,"oldContent":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"DELETE","lineNumber":444,"oldContent":"                IconButton("},{"type":"DELETE","lineNumber":446,"oldContent":"                const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":448,"oldContent":"                ),"},{"type":"DELETE","lineNumber":450,"oldContent":"                  },"},{"type":"DELETE","lineNumber":452,"oldContent":"                    // TODO: Implement like functionality"},{"type":"DELETE","lineNumber":454,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":456,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":458,"oldContent":"                        : null,"},{"type":"DELETE","lineNumber":460,"oldContent":"                        ? Colors.red"},{"type":"DELETE","lineNumber":462,"oldContent":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"DELETE","lineNumber":464,"oldContent":"                        : Icons.favorite_border,"},{"type":"DELETE","lineNumber":466,"oldContent":"                        ? Icons.favorite"},{"type":"DELETE","lineNumber":468,"oldContent":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":493,"content":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":494,"content":"                        ? Icons.favorite"},{"type":"INSERT","lineNumber":495,"content":"                        : Icons.favorite_border,"},{"type":"INSERT","lineNumber":496,"content":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":497,"content":"                        ? Colors.red"},{"type":"INSERT","lineNumber":498,"content":"                        : null,"},{"type":"INSERT","lineNumber":499,"content":"                  ),"},{"type":"INSERT","lineNumber":500,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":501,"content":"                    // TODO: Implement like functionality"},{"type":"INSERT","lineNumber":502,"content":"                  },"},{"type":"INSERT","lineNumber":503,"content":"                ),"},{"type":"INSERT","lineNumber":504,"content":"                const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":505,"content":"                IconButton("},{"type":"INSERT","lineNumber":506,"content":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"INSERT","lineNumber":507,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":508,"content":"                    // TODO: Implement comment functionality"},{"type":"INSERT","lineNumber":509,"content":"                  },"},{"type":"INSERT","lineNumber":510,"content":"                ),"},{"type":"INSERT","lineNumber":511,"content":"                const Spacer(),"},{"type":"INSERT","lineNumber":512,"content":"                Text("},{"type":"INSERT","lineNumber":513,"content":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"INSERT","lineNumber":514,"content":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"INSERT","lineNumber":515,"content":"                ),"},{"type":"INSERT","lineNumber":516,"content":"              ],"},{"type":"INSERT","lineNumber":517,"content":"            ),"},{"type":"INSERT","lineNumber":518,"content":"          ),"},{"type":"INSERT","lineNumber":519,"content":"        ],"},{"type":"INSERT","lineNumber":520,"content":"      ),"},{"type":"INSERT","lineNumber":521,"content":"    );"},{"type":"INSERT","lineNumber":522,"content":"  }"},{"type":"INSERT","lineNumber":523,"content":"}"},{"type":"INSERT","lineNumber":524,"content":""}]},{"timestamp":1754655319466,"changes":[{"type":"INSERT","lineNumber":4,"content":"import 'package:firebase_auth/firebase_auth.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_bloc.dart';"},{"type":"INSERT","lineNumber":23,"content":""},{"type":"DELETE","lineNumber":24,"oldContent":"  @override"},{"type":"MODIFY","lineNumber":27,"content":"    // Get familyId from auth state","oldContent":"    // Get familyId from auth state"},{"type":"DELETE","lineNumber":50,"oldContent":"    "},{"type":"DELETE","lineNumber":52,"oldContent":"    // Show welcome screen if not authenticated"},{"type":"DELETE","lineNumber":55,"oldContent":"    if (authState.status != AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":57,"oldContent":"      return _buildWelcomeScreen();"},{"type":"DELETE","lineNumber":60,"oldContent":"    }"},{"type":"DELETE","lineNumber":63,"oldContent":"    "},{"type":"DELETE","lineNumber":65,"oldContent":"    // Show loading indicator while checking family status"},{"type":"INSERT","lineNumber":60,"content":"    "},{"type":"INSERT","lineNumber":61,"content":"    // Show welcome screen if not authenticated"},{"type":"INSERT","lineNumber":62,"content":"    if (authState.status != AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":63,"content":"      return _buildWelcomeScreen();"},{"type":"INSERT","lineNumber":64,"content":"    }"},{"type":"INSERT","lineNumber":65,"content":"    "},{"type":"INSERT","lineNumber":66,"content":"    // Show loading indicator while checking family status"},{"type":"INSERT","lineNumber":90,"content":"      ),"},{"type":"INSERT","lineNumber":91,"content":"      body: SingleChildScrollView("},{"type":"INSERT","lineNumber":92,"content":"        child: Column("},{"type":"INSERT","lineNumber":93,"content":"          children: ["},{"type":"INSERT","lineNumber":94,"content":"            // Stories Section"},{"type":"INSERT","lineNumber":95,"content":"            _buildStoriesSection(),"},{"type":"INSERT","lineNumber":96,"content":"            const Divider(height: 1),"},{"type":"DELETE","lineNumber":92,"oldContent":"      ),"},{"type":"DELETE","lineNumber":94,"oldContent":"      body: SingleChildScrollView("},{"type":"DELETE","lineNumber":97,"oldContent":"        child: Column("},{"type":"INSERT","lineNumber":102,"content":"      floatingActionButton: FloatingActionButton("},{"type":"INSERT","lineNumber":103,"content":"        onPressed: _showCreatePostDialog,"},{"type":"INSERT","lineNumber":104,"content":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":105,"content":"        child: const Icon(Icons.add, color: Colors.white),"},{"type":"INSERT","lineNumber":106,"content":"      ),"},{"type":"DELETE","lineNumber":99,"oldContent":"          children: ["},{"type":"DELETE","lineNumber":102,"oldContent":"            // Stories Section"},{"type":"DELETE","lineNumber":104,"oldContent":"            _buildStoriesSection(),"},{"type":"DELETE","lineNumber":107,"oldContent":"            const Divider(height: 1),"},{"type":"DELETE","lineNumber":229,"oldContent":"  Widget _buildWelcomeScreen() {"},{"type":"DELETE","lineNumber":231,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":234,"oldContent":"      body: Container("},{"type":"DELETE","lineNumber":237,"oldContent":"        width: double.infinity,"},{"type":"DELETE","lineNumber":239,"oldContent":"        padding: const EdgeInsets.all(24),"},{"type":"DELETE","lineNumber":242,"oldContent":"        decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":244,"oldContent":"          gradient: LinearGradient("},{"type":"DELETE","lineNumber":247,"oldContent":"            begin: Alignment.topCenter,"},{"type":"DELETE","lineNumber":250,"oldContent":"            end: Alignment.bottomCenter,"},{"type":"DELETE","lineNumber":252,"oldContent":"            colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"DELETE","lineNumber":255,"oldContent":"          ),"},{"type":"DELETE","lineNumber":258,"oldContent":"        ),"},{"type":"DELETE","lineNumber":260,"oldContent":"        child: SafeArea("},{"type":"DELETE","lineNumber":263,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":265,"oldContent":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":268,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":271,"oldContent":"              // App Logo and Title"},{"type":"DELETE","lineNumber":273,"oldContent":"              Column("},{"type":"DELETE","lineNumber":276,"oldContent":"                children: ["},{"type":"DELETE","lineNumber":279,"oldContent":"                  // Replace with your app logo"},{"type":"DELETE","lineNumber":281,"oldContent":"                  Container("},{"type":"DELETE","lineNumber":284,"oldContent":"                    width: 150,"},{"type":"DELETE","lineNumber":286,"oldContent":"                    height: 150,"},{"type":"DELETE","lineNumber":289,"oldContent":"                    decoration: BoxDecoration("},{"type":"DELETE","lineNumber":292,"oldContent":"                      color: Colors.white24,"},{"type":"DELETE","lineNumber":294,"oldContent":"                      borderRadius: BorderRadius.circular(20),"},{"type":"DELETE","lineNumber":297,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":300,"oldContent":"                    child: const Icon(Icons.family_restroom, size: 60, color: Colors.white),"},{"type":"DELETE","lineNumber":302,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":305,"oldContent":"                  const SizedBox(height: 20),"},{"type":"DELETE","lineNumber":307,"oldContent":"                  Text("},{"type":"DELETE","lineNumber":310,"oldContent":"                    'Welcome to Family Tree',"},{"type":"DELETE","lineNumber":313,"oldContent":"                    style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":315,"oldContent":"                      color: Colors.white,"},{"type":"DELETE","lineNumber":318,"oldContent":"                      fontSize: 24,"},{"type":"DELETE","lineNumber":321,"oldContent":"                      fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":323,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":326,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":328,"oldContent":"                  const SizedBox(height: 10),"},{"type":"DELETE","lineNumber":331,"oldContent":"                  Padding("},{"type":"DELETE","lineNumber":334,"oldContent":"                    padding: const EdgeInsets.symmetric(horizontal: 40.0),"},{"type":"DELETE","lineNumber":336,"oldContent":"                    child: Text("},{"type":"DELETE","lineNumber":339,"oldContent":"                      'Connect with your family and create your family tree',"},{"type":"DELETE","lineNumber":342,"oldContent":"                      textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":344,"oldContent":"                      style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":347,"oldContent":"                        color: Colors.white.withOpacity(0.8),"},{"type":"DELETE","lineNumber":349,"oldContent":"                        fontSize: 16,"},{"type":"DELETE","lineNumber":352,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":355,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":357,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":360,"oldContent":"                ],"},{"type":"DELETE","lineNumber":364,"oldContent":"              ),"},{"type":"DELETE","lineNumber":365,"oldContent":"              const SizedBox(height: 40),"},{"type":"DELETE","lineNumber":368,"oldContent":"              // Join Now Button"},{"type":"DELETE","lineNumber":370,"oldContent":"              SizedBox("},{"type":"DELETE","lineNumber":373,"oldContent":"                width: double.infinity,"},{"type":"DELETE","lineNumber":376,"oldContent":"                child: ElevatedButton("},{"type":"INSERT","lineNumber":326,"content":"  Widget _buildWelcomeScreen() {"},{"type":"INSERT","lineNumber":327,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":328,"content":"      body: Container("},{"type":"INSERT","lineNumber":329,"content":"        width: double.infinity,"},{"type":"INSERT","lineNumber":330,"content":"        padding: const EdgeInsets.all(24),"},{"type":"INSERT","lineNumber":331,"content":"        decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":332,"content":"          gradient: LinearGradient("},{"type":"INSERT","lineNumber":333,"content":"            begin: Alignment.topCenter,"},{"type":"INSERT","lineNumber":334,"content":"            end: Alignment.bottomCenter,"},{"type":"INSERT","lineNumber":335,"content":"            colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"INSERT","lineNumber":336,"content":"          ),"},{"type":"INSERT","lineNumber":337,"content":"        ),"},{"type":"INSERT","lineNumber":338,"content":"        child: SafeArea("},{"type":"INSERT","lineNumber":339,"content":"          child: Column("},{"type":"INSERT","lineNumber":340,"content":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":341,"content":"            children: ["},{"type":"INSERT","lineNumber":342,"content":"              // App Logo and Title"},{"type":"INSERT","lineNumber":343,"content":"              Column("},{"type":"INSERT","lineNumber":344,"content":"                children: ["},{"type":"INSERT","lineNumber":345,"content":"                  // Replace with your app logo"},{"type":"INSERT","lineNumber":346,"content":"                  Container("},{"type":"INSERT","lineNumber":347,"content":"                    width: 150,"},{"type":"INSERT","lineNumber":348,"content":"                    height: 150,"},{"type":"INSERT","lineNumber":349,"content":"                    decoration: BoxDecoration("},{"type":"INSERT","lineNumber":350,"content":"                      color: Colors.white24,"},{"type":"INSERT","lineNumber":351,"content":"                      borderRadius: BorderRadius.circular(20),"},{"type":"INSERT","lineNumber":352,"content":"                    ),"},{"type":"INSERT","lineNumber":353,"content":"                    child: const Icon(Icons.family_restroom, size: 60, color: Colors.white),"},{"type":"INSERT","lineNumber":354,"content":"                  ),"},{"type":"INSERT","lineNumber":355,"content":"                  const SizedBox(height: 20),"},{"type":"INSERT","lineNumber":356,"content":"                  Text("},{"type":"INSERT","lineNumber":357,"content":"                    'Welcome to Family Tree',"},{"type":"INSERT","lineNumber":358,"content":"                    style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":359,"content":"                      color: Colors.white,"},{"type":"INSERT","lineNumber":360,"content":"                      fontSize: 24,"},{"type":"INSERT","lineNumber":361,"content":"                      fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":362,"content":"                    ),"},{"type":"INSERT","lineNumber":363,"content":"                  ),"},{"type":"INSERT","lineNumber":364,"content":"                  const SizedBox(height: 10),"},{"type":"INSERT","lineNumber":365,"content":"                  Padding("},{"type":"INSERT","lineNumber":366,"content":"                    padding: const EdgeInsets.symmetric(horizontal: 40.0),"},{"type":"INSERT","lineNumber":367,"content":"                    child: Text("},{"type":"INSERT","lineNumber":368,"content":"                      'Connect with your family and create your family tree',"},{"type":"INSERT","lineNumber":369,"content":"                      textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":370,"content":"                      style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":371,"content":"                        color: Colors.white.withOpacity(0.8),"},{"type":"INSERT","lineNumber":372,"content":"                        fontSize: 16,"},{"type":"INSERT","lineNumber":373,"content":"                      ),"},{"type":"INSERT","lineNumber":374,"content":"                    ),"},{"type":"INSERT","lineNumber":375,"content":"                  ),"},{"type":"INSERT","lineNumber":376,"content":"                ],"},{"type":"INSERT","lineNumber":377,"content":"              ),"},{"type":"INSERT","lineNumber":378,"content":"              const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":379,"content":"              // Join Now Button"},{"type":"INSERT","lineNumber":380,"content":"              SizedBox("},{"type":"INSERT","lineNumber":381,"content":"                width: double.infinity,"},{"type":"INSERT","lineNumber":382,"content":"                child: ElevatedButton("},{"type":"INSERT","lineNumber":389,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":438,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":457,"content":"            title: Text("},{"type":"INSERT","lineNumber":458,"content":"              post.userName,"},{"type":"INSERT","lineNumber":459,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":460,"content":"                fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":480,"oldContent":"            title: Text("},{"type":"DELETE","lineNumber":481,"oldContent":"              post.userName,"},{"type":"DELETE","lineNumber":483,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":484,"oldContent":"                fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":493,"oldContent":"                const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":495,"oldContent":"                ),"},{"type":"DELETE","lineNumber":497,"oldContent":"                  },"},{"type":"DELETE","lineNumber":499,"oldContent":"                    // TODO: Implement like functionality"},{"type":"DELETE","lineNumber":501,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":503,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":505,"oldContent":""},{"type":"DELETE","lineNumber":506,"oldContent":"}"},{"type":"DELETE","lineNumber":507,"oldContent":"  }"},{"type":"DELETE","lineNumber":508,"oldContent":"    );"},{"type":"DELETE","lineNumber":509,"oldContent":"      ),"},{"type":"DELETE","lineNumber":510,"oldContent":"        ],"},{"type":"DELETE","lineNumber":511,"oldContent":"          ),"},{"type":"DELETE","lineNumber":512,"oldContent":"            ),"},{"type":"DELETE","lineNumber":513,"oldContent":"              ],"},{"type":"DELETE","lineNumber":514,"oldContent":"                ),"},{"type":"DELETE","lineNumber":515,"oldContent":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"DELETE","lineNumber":516,"oldContent":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"DELETE","lineNumber":517,"oldContent":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"DELETE","lineNumber":518,"oldContent":"                        ? Icons.favorite"},{"type":"DELETE","lineNumber":519,"oldContent":"                Text("},{"type":"DELETE","lineNumber":520,"oldContent":"                        : Icons.favorite_border,"},{"type":"DELETE","lineNumber":521,"oldContent":"                const Spacer(),"},{"type":"DELETE","lineNumber":522,"oldContent":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"DELETE","lineNumber":523,"oldContent":"                ),"},{"type":"DELETE","lineNumber":524,"oldContent":"                        ? Colors.red"},{"type":"DELETE","lineNumber":525,"oldContent":"                  },"},{"type":"DELETE","lineNumber":526,"oldContent":"                        : null,"},{"type":"DELETE","lineNumber":527,"oldContent":"                    // TODO: Implement comment functionality"},{"type":"DELETE","lineNumber":530,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":531,"oldContent":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"DELETE","lineNumber":533,"oldContent":"                IconButton("},{"type":"INSERT","lineNumber":508,"content":"                ),"},{"type":"INSERT","lineNumber":510,"content":"                IconButton("},{"type":"INSERT","lineNumber":511,"content":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"INSERT","lineNumber":512,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":513,"content":"                    // TODO: Implement comment functionality"},{"type":"INSERT","lineNumber":514,"content":"                  },"},{"type":"INSERT","lineNumber":516,"content":"                const Spacer(),"},{"type":"INSERT","lineNumber":517,"content":"                Text("},{"type":"INSERT","lineNumber":518,"content":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"INSERT","lineNumber":519,"content":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"INSERT","lineNumber":520,"content":"                ),"},{"type":"INSERT","lineNumber":521,"content":"              ],"},{"type":"INSERT","lineNumber":522,"content":"            ),"},{"type":"INSERT","lineNumber":523,"content":"          ),"},{"type":"INSERT","lineNumber":524,"content":"        ],"},{"type":"INSERT","lineNumber":525,"content":"      ),"},{"type":"INSERT","lineNumber":526,"content":"    );"},{"type":"INSERT","lineNumber":527,"content":"  }"},{"type":"INSERT","lineNumber":528,"content":"}"},{"type":"INSERT","lineNumber":529,"content":""}]},{"timestamp":1754655379850,"changes":[{"type":"MODIFY","lineNumber":0,"content":"import 'package:flutter/material.dart';","oldContent":"import 'package:family_tree_firebase/features/home/domain/models/post_model.dart';"},{"type":"INSERT","lineNumber":26,"content":"    super.initState();"},{"type":"DELETE","lineNumber":27,"oldContent":"    // Get familyId from auth state"},{"type":"INSERT","lineNumber":56,"content":""},{"type":"INSERT","lineNumber":57,"content":"  @override"},{"type":"INSERT","lineNumber":58,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":59,"content":"    final authState = context.watch<AuthBloc>().state;"},{"type":"DELETE","lineNumber":58,"oldContent":""},{"type":"DELETE","lineNumber":60,"oldContent":"  @override"},{"type":"DELETE","lineNumber":63,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":66,"oldContent":"    final authState = context.watch<AuthBloc>().state;"},{"type":"DELETE","lineNumber":91,"oldContent":"            // Posts Feed"},{"type":"DELETE","lineNumber":93,"oldContent":"            _buildPostsFeed(),"},{"type":"DELETE","lineNumber":96,"oldContent":"          ],"},{"type":"DELETE","lineNumber":99,"oldContent":"        ),"},{"type":"INSERT","lineNumber":97,"content":"            // Posts Feed"},{"type":"INSERT","lineNumber":98,"content":"            _buildPostsFeed(),"},{"type":"INSERT","lineNumber":99,"content":"          ],"},{"type":"INSERT","lineNumber":100,"content":"        ),"},{"type":"DELETE","lineNumber":102,"oldContent":"    );"},{"type":"DELETE","lineNumber":103,"oldContent":"  }"},{"type":"DELETE","lineNumber":104,"oldContent":""},{"type":"DELETE","lineNumber":107,"oldContent":"  Widget _buildStoriesSection() {"},{"type":"DELETE","lineNumber":110,"oldContent":"    return SizedBox("},{"type":"INSERT","lineNumber":107,"content":"    );"},{"type":"INSERT","lineNumber":108,"content":"  }"},{"type":"INSERT","lineNumber":109,"content":""},{"type":"INSERT","lineNumber":110,"content":"  Widget _buildStoriesSection() {"},{"type":"INSERT","lineNumber":111,"content":"    return SizedBox("},{"type":"DELETE","lineNumber":227,"oldContent":"                    // Navigate to join family screen"},{"type":"DELETE","lineNumber":228,"oldContent":"                    // TODO: Implement join family navigation"},{"type":"INSERT","lineNumber":227,"content":"                    Navigator.push("},{"type":"INSERT","lineNumber":228,"content":"                      context,"},{"type":"INSERT","lineNumber":229,"content":"                      MaterialPageRoute("},{"type":"INSERT","lineNumber":230,"content":"                        builder: (context) => const JoinFamilyScreen(),"},{"type":"INSERT","lineNumber":231,"content":"                      ),"},{"type":"INSERT","lineNumber":232,"content":"                    );"},{"type":"INSERT","lineNumber":298,"content":"                if (_postController.text.trim().isNotEmpty) {"},{"type":"INSERT","lineNumber":299,"content":"                  try {"},{"type":"INSERT","lineNumber":300,"content":"                    await _postService.createPost("},{"type":"INSERT","lineNumber":301,"content":"                      content: _postController.text.trim(),"},{"type":"INSERT","lineNumber":302,"content":"                      familyId: _familyId!,"},{"type":"INSERT","lineNumber":303,"content":"                    );"},{"type":"INSERT","lineNumber":304,"content":"                    if (mounted) {"},{"type":"INSERT","lineNumber":305,"content":"                      Navigator.pop(context);"},{"type":"INSERT","lineNumber":306,"content":"                      ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":307,"content":"                        const SnackBar(content: Text('Post created successfully!')),"},{"type":"INSERT","lineNumber":308,"content":"                      );"},{"type":"INSERT","lineNumber":309,"content":"                    }"},{"type":"INSERT","lineNumber":310,"content":"                  } catch (e) {"},{"type":"INSERT","lineNumber":311,"content":"                    if (mounted) {"},{"type":"INSERT","lineNumber":312,"content":"                      ScaffoldMessenger.of(context).showSnackBar("},{"type":"INSERT","lineNumber":313,"content":"                        SnackBar(content: Text('Error creating post: $e')),"},{"type":"INSERT","lineNumber":314,"content":"                      );"},{"type":"INSERT","lineNumber":315,"content":"                    }"},{"type":"INSERT","lineNumber":316,"content":"                  }"},{"type":"INSERT","lineNumber":317,"content":"                }"},{"type":"INSERT","lineNumber":318,"content":"              },"},{"type":"INSERT","lineNumber":319,"content":"              style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":320,"content":"                backgroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":321,"content":"              ),"},{"type":"INSERT","lineNumber":322,"content":"              child: const Text('Post'),"},{"type":"INSERT","lineNumber":323,"content":"            ),"},{"type":"INSERT","lineNumber":324,"content":"          ],"},{"type":"INSERT","lineNumber":325,"content":"        );"},{"type":"INSERT","lineNumber":326,"content":"      },"},{"type":"INSERT","lineNumber":327,"content":"    );"},{"type":"INSERT","lineNumber":328,"content":"  }"},{"type":"INSERT","lineNumber":329,"content":""},{"type":"DELETE","lineNumber":296,"oldContent":"                if (_postController.text.trim().isNotEmpty) {"},{"type":"DELETE","lineNumber":299,"oldContent":"                  try {"},{"type":"DELETE","lineNumber":301,"oldContent":"                    await _postService.createPost("},{"type":"DELETE","lineNumber":304,"oldContent":"                      content: _postController.text.trim(),"},{"type":"DELETE","lineNumber":306,"oldContent":"                      familyId: _familyId!,"},{"type":"DELETE","lineNumber":309,"oldContent":"                    );"},{"type":"DELETE","lineNumber":312,"oldContent":"                    if (mounted) {"},{"type":"DELETE","lineNumber":314,"oldContent":"                      Navigator.pop(context);"},{"type":"DELETE","lineNumber":317,"oldContent":"                      ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":319,"oldContent":"                        const SnackBar(content: Text('Post created successfully!')),"},{"type":"DELETE","lineNumber":322,"oldContent":"                      );"},{"type":"DELETE","lineNumber":325,"oldContent":"                    }"},{"type":"DELETE","lineNumber":327,"oldContent":"                  } catch (e) {"},{"type":"DELETE","lineNumber":330,"oldContent":"                    if (mounted) {"},{"type":"DELETE","lineNumber":333,"oldContent":"                      ScaffoldMessenger.of(context).showSnackBar("},{"type":"DELETE","lineNumber":335,"oldContent":"                        SnackBar(content: Text('Error creating post: $e')),"},{"type":"DELETE","lineNumber":338,"oldContent":"                      );"},{"type":"DELETE","lineNumber":340,"oldContent":"                    }"},{"type":"DELETE","lineNumber":343,"oldContent":"                  }"},{"type":"DELETE","lineNumber":346,"oldContent":"                }"},{"type":"DELETE","lineNumber":348,"oldContent":"              },"},{"type":"DELETE","lineNumber":351,"oldContent":"              style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":353,"oldContent":"                backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":355,"oldContent":"              ),"},{"type":"DELETE","lineNumber":359,"oldContent":"              child: const Text('Post'),"},{"type":"DELETE","lineNumber":361,"oldContent":"            ),"},{"type":"DELETE","lineNumber":364,"oldContent":"          ],"},{"type":"DELETE","lineNumber":367,"oldContent":"        );"},{"type":"DELETE","lineNumber":369,"oldContent":"      },"},{"type":"DELETE","lineNumber":372,"oldContent":"    );"},{"type":"DELETE","lineNumber":374,"oldContent":"  }"},{"type":"DELETE","lineNumber":377,"oldContent":""},{"type":"DELETE","lineNumber":379,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":381,"oldContent":"                    // TODO: Navigate to join family screen"},{"type":"DELETE","lineNumber":383,"oldContent":"                  },"},{"type":"DELETE","lineNumber":385,"oldContent":"                  style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":387,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":388,"content":"                    // TODO: Navigate to join family screen"},{"type":"INSERT","lineNumber":389,"content":"                  },"},{"type":"INSERT","lineNumber":390,"content":"                  style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":393,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":394,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":461,"content":"            title: Text("},{"type":"INSERT","lineNumber":462,"content":"              post.userName,"},{"type":"INSERT","lineNumber":463,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":464,"content":"                fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":462,"oldContent":"            title: Text("},{"type":"DELETE","lineNumber":464,"oldContent":"              post.userName,"},{"type":"DELETE","lineNumber":466,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":468,"oldContent":"                fontWeight: FontWeight.w600,"},{"type":"INSERT","lineNumber":508,"content":"                  ),"},{"type":"INSERT","lineNumber":509,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":510,"content":"                    // TODO: Implement like functionality"},{"type":"INSERT","lineNumber":511,"content":"                  },"},{"type":"INSERT","lineNumber":513,"content":"                const SizedBox(width: 8),"},{"type":"INSERT","lineNumber":519,"content":"                ),"},{"type":"DELETE","lineNumber":523,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":525,"oldContent":"          ),"},{"type":"DELETE","lineNumber":526,"oldContent":"                    // TODO: Implement like functionality"},{"type":"DELETE","lineNumber":527,"oldContent":"                  },"},{"type":"DELETE","lineNumber":528,"oldContent":"                ),"},{"type":"DELETE","lineNumber":529,"oldContent":"                ),"},{"type":"DELETE","lineNumber":530,"oldContent":"                  style: GoogleFonts.poppins(fontSize: 12, color: Colors.grey),"},{"type":"DELETE","lineNumber":531,"oldContent":"                const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":532,"oldContent":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"DELETE","lineNumber":533,"oldContent":"                IconButton("},{"type":"DELETE","lineNumber":534,"oldContent":"                Text("},{"type":"DELETE","lineNumber":535,"oldContent":"                  icon: const Icon(Icons.comment_outlined),"},{"type":"DELETE","lineNumber":536,"oldContent":"                const Spacer(),"},{"type":"DELETE","lineNumber":537,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":538,"oldContent":"                ),"},{"type":"DELETE","lineNumber":539,"oldContent":"                    // TODO: Implement comment functionality"},{"type":"DELETE","lineNumber":540,"oldContent":"                  },"}]},{"timestamp":1754655394899,"changes":[{"type":"INSERT","lineNumber":11,"content":"import 'package:family_tree_firebase/features/family/presentation/screens/join_family_screen.dart';"},{"type":"DELETE","lineNumber":57,"oldContent":"    "},{"type":"DELETE","lineNumber":59,"oldContent":"    // Show welcome screen if not authenticated"},{"type":"INSERT","lineNumber":61,"content":"    "},{"type":"INSERT","lineNumber":62,"content":"    // Show welcome screen if not authenticated"},{"type":"DELETE","lineNumber":94,"oldContent":"            // Posts Feed"},{"type":"DELETE","lineNumber":96,"oldContent":"            _buildPostsFeed(),"},{"type":"INSERT","lineNumber":97,"content":"            const Divider(height: 1),"},{"type":"INSERT","lineNumber":98,"content":"            // Posts Feed"},{"type":"INSERT","lineNumber":99,"content":"            _buildPostsFeed(),"},{"type":"DELETE","lineNumber":100,"oldContent":"            const Divider(height: 1),"},{"type":"INSERT","lineNumber":105,"content":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":106,"content":"        child: const Icon(Icons.add, color: Colors.white),"},{"type":"INSERT","lineNumber":107,"content":"      ),"},{"type":"DELETE","lineNumber":106,"oldContent":"        backgroundColor: const Color(0xFF6A11CB),"},{"type":"DELETE","lineNumber":108,"oldContent":"        child: const Icon(Icons.add, color: Colors.white),"},{"type":"DELETE","lineNumber":111,"oldContent":"      ),"},{"type":"DELETE","lineNumber":230,"oldContent":"                  },"},{"type":"DELETE","lineNumber":232,"oldContent":"                  style: ElevatedButton.styleFrom("},{"type":"MODIFY","lineNumber":234,"content":"                  },","oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":235,"content":"                  style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":236,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"DELETE","lineNumber":298,"oldContent":"  Widget _buildWelcomeScreen() {"},{"type":"DELETE","lineNumber":299,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":300,"oldContent":"      body: Container("},{"type":"DELETE","lineNumber":302,"oldContent":"        width: double.infinity,"},{"type":"DELETE","lineNumber":305,"oldContent":"        padding: const EdgeInsets.all(24),"},{"type":"DELETE","lineNumber":308,"oldContent":"        decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":310,"oldContent":"          gradient: LinearGradient("},{"type":"DELETE","lineNumber":313,"oldContent":"            begin: Alignment.topCenter,"},{"type":"DELETE","lineNumber":316,"oldContent":"            end: Alignment.bottomCenter,"},{"type":"DELETE","lineNumber":318,"oldContent":"            colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"DELETE","lineNumber":321,"oldContent":"          ),"},{"type":"DELETE","lineNumber":323,"oldContent":"        ),"},{"type":"DELETE","lineNumber":326,"oldContent":"        child: SafeArea("},{"type":"DELETE","lineNumber":329,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":331,"oldContent":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":334,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":337,"oldContent":"              // App Logo and Title"},{"type":"DELETE","lineNumber":339,"oldContent":"              Column("},{"type":"DELETE","lineNumber":342,"oldContent":"                children: ["},{"type":"DELETE","lineNumber":344,"oldContent":"                  // Replace with your app logo"},{"type":"DELETE","lineNumber":347,"oldContent":"                  Container("},{"type":"DELETE","lineNumber":350,"oldContent":"                    width: 150,"},{"type":"INSERT","lineNumber":331,"content":"  Widget _buildWelcomeScreen() {"},{"type":"INSERT","lineNumber":332,"content":"    return Scaffold("},{"type":"INSERT","lineNumber":333,"content":"      body: Container("},{"type":"INSERT","lineNumber":334,"content":"        width: double.infinity,"},{"type":"INSERT","lineNumber":335,"content":"        padding: const EdgeInsets.all(24),"},{"type":"INSERT","lineNumber":336,"content":"        decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":337,"content":"          gradient: LinearGradient("},{"type":"INSERT","lineNumber":338,"content":"            begin: Alignment.topCenter,"},{"type":"INSERT","lineNumber":339,"content":"            end: Alignment.bottomCenter,"},{"type":"INSERT","lineNumber":340,"content":"            colors: [Color(0xFF6A11CB), Color(0x996A11CB)],"},{"type":"INSERT","lineNumber":341,"content":"          ),"},{"type":"INSERT","lineNumber":342,"content":"        ),"},{"type":"INSERT","lineNumber":343,"content":"        child: SafeArea("},{"type":"INSERT","lineNumber":344,"content":"          child: Column("},{"type":"INSERT","lineNumber":345,"content":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":346,"content":"            children: ["},{"type":"INSERT","lineNumber":347,"content":"              // App Logo and Title"},{"type":"INSERT","lineNumber":348,"content":"              Column("},{"type":"INSERT","lineNumber":349,"content":"                children: ["},{"type":"INSERT","lineNumber":350,"content":"                  // Replace with your app logo"},{"type":"INSERT","lineNumber":351,"content":"                  Container("},{"type":"INSERT","lineNumber":352,"content":"                    width: 150,"},{"type":"DELETE","lineNumber":388,"oldContent":"                    backgroundColor: Colors.white,"},{"type":"DELETE","lineNumber":390,"oldContent":"                    foregroundColor: const Color(0xFF6A11CB),"},{"type":"MODIFY","lineNumber":392,"content":"                    backgroundColor: Colors.white,","oldContent":"                    shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":393,"content":"                    foregroundColor: const Color(0xFF6A11CB),"},{"type":"INSERT","lineNumber":394,"content":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":395,"content":"                    shape: RoundedRectangleBorder("},{"type":"DELETE","lineNumber":397,"oldContent":"                    padding: const EdgeInsets.symmetric(vertical: 16),"},{"type":"INSERT","lineNumber":462,"content":"            title: Text("},{"type":"INSERT","lineNumber":463,"content":"              post.userName,"},{"type":"INSERT","lineNumber":464,"content":"              style: GoogleFonts.poppins("},{"type":"INSERT","lineNumber":465,"content":"                fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":465,"oldContent":"            title: Text("},{"type":"DELETE","lineNumber":467,"oldContent":"              post.userName,"},{"type":"DELETE","lineNumber":468,"oldContent":"              style: GoogleFonts.poppins("},{"type":"DELETE","lineNumber":470,"oldContent":"                fontWeight: FontWeight.w600,"},{"type":"DELETE","lineNumber":502,"oldContent":"}"},{"type":"DELETE","lineNumber":503,"oldContent":"    );"},{"type":"DELETE","lineNumber":504,"oldContent":"        ],"},{"type":"DELETE","lineNumber":505,"oldContent":"            ),"},{"type":"INSERT","lineNumber":503,"content":"                    post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":504,"content":"                        ? Icons.favorite"},{"type":"INSERT","lineNumber":505,"content":"                        : Icons.favorite_border,"},{"type":"INSERT","lineNumber":506,"content":"                    color: post.likedBy.contains('userId') // TODO: Use actual userId"},{"type":"INSERT","lineNumber":507,"content":"                        ? Colors.red"},{"type":"INSERT","lineNumber":508,"content":"                        : null,"},{"type":"INSERT","lineNumber":509,"content":"                  ),"},{"type":"INSERT","lineNumber":510,"content":"                  onPressed: () {"},{"type":"INSERT","lineNumber":511,"content":"                    // TODO: Implement like functionality"},{"type":"INSERT","lineNumber":512,"content":"                  },"},{"type":"DELETE","lineNumber":507,"oldContent":"                  '${post.likesCount} likes • ${post.commentsCount} comments',"},{"type":"DELETE","lineNumber":508,"oldContent":"                ),"},{"type":"INSERT","lineNumber":514,"content":"                const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":512,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":514,"oldContent":"                  onPressed: () {"},{"type":"DELETE","lineNumber":516,"oldContent":"                    // TODO: Implement like functionality"},{"type":"INSERT","lineNumber":520,"content":"                ),"},{"type":"DELETE","lineNumber":518,"oldContent":"                  },"},{"type":"DELETE","lineNumber":521,"oldContent":"                const SizedBox(width: 8),"},{"type":"DELETE","lineNumber":528,"oldContent":"                ),"},{"type":"INSERT","lineNumber":533,"content":"}"},{"type":"INSERT","lineNumber":534,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/presentation/widgets/post_widget.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/presentation/widgets/post_widget.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:family_tree_firebase/features/home/domain/models/post_model.dart';\nimport 'package:timeago/timeago.dart' as timeago;\n\nclass PostWidget extends StatefulWidget {\n  final PostModel post;\n  final VoidCallback onLike;\n  final Function(String) onComment;\n\n  const PostWidget({\n    super.key,\n    required this.post,\n    required this.onLike,\n    required this.onComment,\n  });\n\n  @override\n  State<PostWidget> createState() => _PostWidgetState();\n}\n\nclass _PostWidgetState extends State<PostWidget> {\n  bool _isLiked = false;\n  bool _isBookmarked = false;\n  bool _showFullCaption = false;\n  final TextEditingController _commentController = TextEditingController();\n\n  @override\n  void initState() {\n    super.initState();\n    // Initialize timeago\n    timeago.setLocaleMessages('en', timeago.EnMessages());\n  }\n\n  @override\n  void dispose() {\n    _commentController.dispose();\n    super.dispose();\n  }\n\n  void _toggleLike() {\n    widget.onLike();\n  }\n\n  void _toggleBookmark() {\n    setState(() {\n      _isBookmarked = !_isBookmarked;\n    });\n  }\n\n  void _toggleCaption() {\n    setState(() {\n      _showFullCaption = !_showFullCaption;\n    });\n  }\n\n  void _addComment() {\n    if (_commentController.text.trim().isEmpty) return;\n    \n    widget.onComment(_commentController.text.trim());\n    _commentController.clear();\n    FocusScope.of(context).unfocus();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n    \n    return Column(\n      crossAxisAlignment: CrossAxisAlignment.start,\n      children: [\n        // Header with user info and options\n        Padding(\n          padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),\n          child: Row(\n            children: [\n              // User avatar\n              CircleAvatar(\n                radius: 16,\n                backgroundImage: NetworkImage(widget.post.userImageUrl),\n              ),\n              \n              const SizedBox(width: 12),\n              \n              // Username\n              Text(\n                widget.post.userName,\n                style: const TextStyle(\n                  fontWeight: FontWeight.w600,\n                ),\n              ),\n              \n              const Spacer(),\n              \n              // Options button\n              IconButton(\n                icon: const Icon(Icons.more_vert),\n                onPressed: () {\n                  // TODO: Show post options\n                },\n                padding: EdgeInsets.zero,\n                constraints: const BoxConstraints(),\n              ),\n            ],\n          ),\n        ),\n        \n        // Post image\n        AspectRatio(\n          aspectRatio: 1.0,\n          child: Image.network(\n            widget.post.imageUrl,\n            fit: BoxFit.cover,\n            width: double.infinity,\n          ),\n        ),\n        \n        // Action buttons\n        Padding(\n          padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 4),\n          child: Row(\n            children: [\n              // Like button\n              IconButton(\n                icon: Icon(\n                  widget.post.isLiked ? Icons.favorite : Icons.favorite_border,\n                  color: widget.post.isLiked ? Colors.red : null,\n                  size: 28,\n                ),\n                onPressed: _toggleLike,\n              ),\n              \n              // Comment button\n              IconButton(\n                icon: const Icon(Icons.chat_bubble_outline, size: 26),\n                onPressed: () {\n                  // Focus comment field\n                  FocusScope.of(context).requestFocus(FocusNode());\n                  showModalBottomSheet(\n                    context: context,\n                    builder: (context) => _buildCommentSheet(),\n                    isScrollControlled: true,\n                  );\n                },\n              ),\n              \n              // Share button\n              IconButton(\n                icon: const Icon(Icons.send_outlined, size: 26),\n                onPressed: () {\n                  // TODO: Implement share\n                },\n              ),\n              \n              const Spacer(),\n              \n              // Bookmark button\n              IconButton(\n                icon: Icon(\n                  _isBookmarked ? Icons.bookmark : Icons.bookmark_border,\n                  size: 28,\n                ),\n                onPressed: _toggleBookmark,\n              ),\n            ],\n          ),\n        ),\n        \n        // Likes count\n        Padding(\n          padding: const EdgeInsets.symmetric(horizontal: 16),\n          child: Text(\n            '${widget.post.likes + (_isLiked ? 1 : 0)} likes',\n            style: const TextStyle(\n              fontWeight: FontWeight.bold,\n            ),\n          ),\n        ),\n        \n        // Caption\n        Padding(\n          padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 4),\n          child: GestureDetector(\n            onTap: _toggleCaption,\n            child: Text.rich(\n              TextSpan(\n                children: [\n                  TextSpan(\n                    text: '${widget.post.userName} ',\n                    style: const TextStyle(fontWeight: FontWeight.bold),\n                  ),\n                  TextSpan(\n                    text: _showFullCaption \n                        ? widget.post.caption \n                        : '${widget.post.caption.substring(0, widget.post.caption.length > 100 ? 100 : widget.post.caption.length)}${widget.post.caption.length > 100 ? '...' : ''}',\n                  ),\n                  if (widget.post.caption.length > 100) ...[\n                    TextSpan(\n                      text: _showFullCaption ? ' less' : ' more',\n                      style: TextStyle(\n                        color: theme.textTheme.bodySmall?.color,\n                        fontWeight: FontWeight.w500,\n                      ),\n                    ),\n                  ],\n                ],\n              ),\n            ),\n          ),\n        ),\n        \n        // View all comments\n        if (widget.post.comments.isNotEmpty) ...[\n          Padding(\n            padding: const EdgeInsets.symmetric(horizontal: 16),\n            child: Text(\n              'View all ${widget.post.comments.length} comments',\n              style: TextStyle(\n                color: theme.textTheme.bodySmall?.color,\n              ),\n            ),\n          ),\n        ],\n        \n        // Time ago\n        Padding(\n          padding: const EdgeInsets.fromLTRB(16, 4, 16, 8),\n          child: Text(\n            timeago.format(widget.post.timestamp, locale: 'en'),\n            style: TextStyle(\n              color: theme.textTheme.bodySmall?.color,\n              fontSize: 12,\n            ),\n          ),\n        ),\n        \n        // Add comment\n        Padding(\n          padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n          child: Row(\n            children: [\n              // User avatar\n              CircleAvatar(\n                radius: 14,\n                backgroundImage: NetworkImage(\n                  'https://randomuser.me/api/portraits/men/1.jpg', // Current user's avatar\n                ),\n              ),\n              \n              const SizedBox(width: 12),\n              \n              // Comment input\n              Expanded(\n                child: TextField(\n                  controller: _commentController,\n                  decoration: InputDecoration(\n                    hintText: 'Add a comment...',\n                    border: InputBorder.none,\n                    contentPadding: EdgeInsets.zero,\n                    isDense: true,\n                  ),\n                  onSubmitted: (_) => _addComment(),\n                ),\n              ),\n              \n              // Post button\n              TextButton(\n                onPressed: _addComment,\n                child: const Text(\n                  'Post',\n                  style: TextStyle(\n                    color: Colors.blue,\n                    fontWeight: FontWeight.bold,\n                  ),\n                ),\n              ),\n            ],\n          ),\n        ),\n      ],\n    );\n  }\n}\n","baseTimestamp":1754460186776,"deltas":[{"timestamp":1754516299092,"changes":[{"type":"INSERT","lineNumber":63,"content":"  Widget _buildCommentSheet() {"},{"type":"INSERT","lineNumber":64,"content":"    // TODO: Implement comment sheet UI"},{"type":"INSERT","lineNumber":65,"content":"    return Container();"},{"type":"INSERT","lineNumber":66,"content":"  }"},{"type":"INSERT","lineNumber":67,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/domain/models/post_model.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/domain/models/post_model.dart","baseContent":"class PostModel {\n  final String id;\n  final String userId;\n  final String userName;\n  final String userImageUrl;\n  final String imageUrl;\n  final String caption;\n  final DateTime timestamp;\n  final int likes;\n  final bool isLiked;\n  final List<CommentModel> comments;\n\n  PostModel({\n    required this.id,\n    required this.userId,\n    required this.userName,\n    required this.userImageUrl,\n    required this.imageUrl,\n    required this.caption,\n    required this.timestamp,\n    this.likes = 0,\n    this.isLiked = false,\n    this.comments = const [],\n  });\n\n  // Create a copy of the post with updated fields\n  PostModel copyWith({\n    String? id,\n    String? userId,\n    String? userName,\n    String? userImageUrl,\n    String? imageUrl,\n    String? caption,\n    DateTime? timestamp,\n    int? likes,\n    bool? isLiked,\n    List<CommentModel>? comments,\n  }) {\n    return PostModel(\n      id: id ?? this.id,\n      userId: userId ?? this.userId,\n      userName: userName ?? this.userName,\n      userImageUrl: userImageUrl ?? this.userImageUrl,\n      imageUrl: imageUrl ?? this.imageUrl,\n      caption: caption ?? this.caption,\n      timestamp: timestamp ?? this.timestamp,\n      likes: likes ?? this.likes,\n      isLiked: isLiked ?? this.isLiked,\n      comments: comments ?? this.comments,\n    );\n  }\n\n  // Helper method to format the time since the post was created\n  String get timeAgo {\n    final now = DateTime.now();\n    final difference = now.difference(timestamp);\n\n    if (difference.inDays > 365) {\n      return '${(difference.inDays / 365).floor()}y';\n    } else if (difference.inDays > 30) {\n      return '${(difference.inDays / 30).floor()}mo';\n    } else if (difference.inDays > 0) {\n      return '${difference.inDays}d';\n    } else if (difference.inHours > 0) {\n      return '${difference.inHours}h';\n    } else if (difference.inMinutes > 0) {\n      return '${difference.inMinutes}m';\n    } else {\n      return 'just now';\n    }\n  }\n}\n\nclass CommentModel {\n  final String id;\n  final String userId;\n  final String userName;\n  final String userImageUrl;\n  final String text;\n  final DateTime timestamp;\n\n  CommentModel({\n    required this.id,\n    required this.userId,\n    required this.userName,\n    required this.userImageUrl,\n    required this.text,\n    required this.timestamp,\n  });\n\n  String get timeAgo {\n    final now = DateTime.now();\n    final difference = now.difference(timestamp);\n\n    if (difference.inDays > 0) {\n      return '${difference.inDays}d';\n    } else if (difference.inHours > 0) {\n      return '${difference.inHours}h';\n    } else if (difference.inMinutes > 0) {\n      return '${difference.inMinutes}m';\n    } else {\n      return 'just now';\n    }\n  }\n}\n","baseTimestamp":1754460211088,"deltas":[{"timestamp":1754516373247,"changes":[{"type":"MODIFY","lineNumber":0,"content":"import 'package:family_tree_firebase/features/home/domain/models/comment_model.dart' as P;","oldContent":"class PostModel {"},{"type":"INSERT","lineNumber":1,"content":"import 'package:equatable/equatable.dart';"},{"type":"INSERT","lineNumber":2,"content":""},{"type":"INSERT","lineNumber":3,"content":"class PostModel extends Equatable {"},{"type":"DELETE","lineNumber":10,"oldContent":"  final List<CommentModel> comments;"},{"type":"INSERT","lineNumber":13,"content":"  final List<P.CommentModel> comments;"},{"type":"DELETE","lineNumber":36,"oldContent":"    List<CommentModel>? comments,"},{"type":"INSERT","lineNumber":39,"content":"    List<P.CommentModel>? comments,"},{"type":"DELETE","lineNumber":71,"oldContent":"}"},{"type":"DELETE","lineNumber":73,"oldContent":"class CommentModel {"},{"type":"DELETE","lineNumber":74,"oldContent":"  final String id;"},{"type":"DELETE","lineNumber":75,"oldContent":"  final String userId;"},{"type":"DELETE","lineNumber":76,"oldContent":"  final String userName;"},{"type":"DELETE","lineNumber":77,"oldContent":"  final String userImageUrl;"},{"type":"DELETE","lineNumber":78,"oldContent":"  final String text;"},{"type":"DELETE","lineNumber":79,"oldContent":"  final DateTime timestamp;"},{"type":"DELETE","lineNumber":80,"oldContent":""},{"type":"DELETE","lineNumber":81,"oldContent":"  CommentModel({"},{"type":"DELETE","lineNumber":82,"oldContent":"    required this.id,"},{"type":"DELETE","lineNumber":83,"oldContent":"    required this.userId,"},{"type":"DELETE","lineNumber":84,"oldContent":"    required this.userName,"},{"type":"DELETE","lineNumber":85,"oldContent":"    required this.userImageUrl,"},{"type":"DELETE","lineNumber":86,"oldContent":"    required this.text,"},{"type":"DELETE","lineNumber":87,"oldContent":"    required this.timestamp,"},{"type":"DELETE","lineNumber":88,"oldContent":"  });"},{"type":"DELETE","lineNumber":89,"oldContent":""},{"type":"DELETE","lineNumber":90,"oldContent":"  String get timeAgo {"},{"type":"DELETE","lineNumber":91,"oldContent":"    final now = DateTime.now();"},{"type":"DELETE","lineNumber":92,"oldContent":"    final difference = now.difference(timestamp);"},{"type":"DELETE","lineNumber":93,"oldContent":""},{"type":"DELETE","lineNumber":94,"oldContent":"    if (difference.inDays > 0) {"},{"type":"DELETE","lineNumber":95,"oldContent":"      return '${difference.inDays}d';"},{"type":"DELETE","lineNumber":96,"oldContent":"    } else if (difference.inHours > 0) {"},{"type":"DELETE","lineNumber":97,"oldContent":"      return '${difference.inHours}h';"},{"type":"DELETE","lineNumber":98,"oldContent":"    } else if (difference.inMinutes > 0) {"},{"type":"DELETE","lineNumber":99,"oldContent":"      return '${difference.inMinutes}m';"},{"type":"DELETE","lineNumber":100,"oldContent":"    } else {"},{"type":"DELETE","lineNumber":101,"oldContent":"      return 'just now';"},{"type":"DELETE","lineNumber":102,"oldContent":"    }"},{"type":"DELETE","lineNumber":103,"oldContent":"  }"},{"type":"INSERT","lineNumber":75,"content":"  @override"},{"type":"INSERT","lineNumber":76,"content":"  List<Object?> get props => [id, userId, userName, userImageUrl, imageUrl, caption, timestamp, likes, isLiked, comments];"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/di/injection_container.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/di/injection_container.dart","baseContent":"import 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:get_it/get_it.dart';\nimport 'package:injectable/injectable.dart';\n\nimport '../../features/auth/di/auth_injection_container.dart' as auth_di;\nimport '../../features/family/di/family_injection_container.dart' as family_di;\n\nfinal sl = GetIt.instance;\n\n@injectableInit\nFuture<void> init() async {\n  // Initialize Firebase services if not already registered\n  if (!sl.isRegistered<FirebaseAuth>()) {\n    sl.registerLazySingleton(() => FirebaseAuth.instance);\n  }\n  \n  if (!sl.isRegistered<FirebaseFirestore>()) {\n    sl.registerLazySingleton(() => FirebaseFirestore.instance);\n  }\n\n  // Initialize authentication dependencies\n  await auth_di.initAuthFeature();\n  \n  // Initialize family dependencies\n  await family_di.initFamilyFeature();\n  \n  // Initialize other features' dependencies here\n  \n  // Initialize other core dependencies\n  await _initCoreDependencies();\n}\n\nFuture<void> _initCoreDependencies() async {\n  // Register core dependencies here\n  // Example:\n  // sl.registerLazySingleton(() => NetworkInfoImpl(sl()));\n}\n","baseTimestamp":1754470332037,"deltas":[{"timestamp":1754470917886,"changes":[{"type":"INSERT","lineNumber":7,"content":"import '../../features/splash/di/splash_injection_container.dart' as splash_di;"},{"type":"INSERT","lineNumber":28,"content":"  // Initialize splash dependencies"},{"type":"INSERT","lineNumber":29,"content":"  await splash_di.initSplashFeature();"},{"type":"INSERT","lineNumber":30,"content":"  "}]},{"timestamp":1754476903620,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'dart:io';"},{"type":"INSERT","lineNumber":1,"content":""},{"type":"INSERT","lineNumber":3,"content":"import 'package:connectivity_plus/connectivity_plus.dart';"},{"type":"INSERT","lineNumber":7,"content":"import 'package:shared_preferences/shared_preferences.dart';"},{"type":"INSERT","lineNumber":9,"content":"import '../../core/network/network_info.dart';"},{"type":"INSERT","lineNumber":10,"content":"import '../../core/network/network_info_impl.dart';"},{"type":"INSERT","lineNumber":11,"content":"import '../../core/utils/navigation_service.dart';"},{"type":"INSERT","lineNumber":12,"content":"import '../../core/utils/shared_prefs_manager.dart';"},{"type":"DELETE","lineNumber":28,"oldContent":"  // Initialize other features' dependencies here"},{"type":"DELETE","lineNumber":30,"oldContent":"  "},{"type":"DELETE","lineNumber":32,"oldContent":"  // Initialize other core dependencies"},{"type":"INSERT","lineNumber":39,"content":"  // Initialize other features' dependencies here"},{"type":"INSERT","lineNumber":40,"content":"  "},{"type":"INSERT","lineNumber":41,"content":"  // Initialize other core dependencies"},{"type":"DELETE","lineNumber":38,"oldContent":"  // Register core dependencies here"},{"type":"DELETE","lineNumber":39,"oldContent":"  // Example:"},{"type":"DELETE","lineNumber":40,"oldContent":"  // sl.registerLazySingleton(() => NetworkInfoImpl(sl()));"},{"type":"INSERT","lineNumber":46,"content":"  // Core - Utils"},{"type":"INSERT","lineNumber":47,"content":"  sl.registerLazySingleton(() => NavigationService());"},{"type":"INSERT","lineNumber":48,"content":"  "},{"type":"INSERT","lineNumber":49,"content":"  // Core - Network"},{"type":"INSERT","lineNumber":50,"content":"  sl.registerLazySingleton<NetworkInfo>("},{"type":"INSERT","lineNumber":51,"content":"    () => NetworkInfoImpl(connectivity: sl(), sharedPreferences: sl()),"},{"type":"INSERT","lineNumber":52,"content":"  );"},{"type":"INSERT","lineNumber":53,"content":"  "},{"type":"INSERT","lineNumber":54,"content":"  // External"},{"type":"INSERT","lineNumber":55,"content":"  if (!sl.isRegistered<Connectivity>()) {"},{"type":"INSERT","lineNumber":56,"content":"    sl.registerLazySingleton(() => Connectivity());"},{"type":"INSERT","lineNumber":57,"content":"  }"},{"type":"INSERT","lineNumber":58,"content":"  "},{"type":"INSERT","lineNumber":59,"content":"  if (!sl.isRegistered<SharedPreferences>()) {"},{"type":"INSERT","lineNumber":60,"content":"    final sharedPreferences = await SharedPreferences.getInstance();"},{"type":"INSERT","lineNumber":61,"content":"    sl.registerLazySingleton(() => sharedPreferences);"},{"type":"INSERT","lineNumber":62,"content":"  }"},{"type":"INSERT","lineNumber":63,"content":"  "},{"type":"INSERT","lineNumber":64,"content":"  // Initialize SharedPrefsManager"},{"type":"INSERT","lineNumber":65,"content":"  final sharedPrefsManager = SharedPrefsManager(sharedPreferences: sl());"},{"type":"INSERT","lineNumber":66,"content":"  await sharedPrefsManager.init();"},{"type":"INSERT","lineNumber":67,"content":"  sl.registerLazySingleton<SharedPrefsManager>(() => sharedPrefsManager);"}]},{"timestamp":1754511640639,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:cloud_firestore/cloud_firestore.dart';","oldContent":"import 'package:cloud_firestore/cloud_firestore.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:connectivity_plus/connectivity_plus.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:connectivity_plus/connectivity_plus.dart';"},{"type":"INSERT","lineNumber":7,"content":"import 'package:shared_preferences/shared_preferences.dart';"},{"type":"INSERT","lineNumber":9,"content":"import '../../core/network/network_info.dart';"},{"type":"INSERT","lineNumber":10,"content":"import '../../core/network/network_info_impl.dart';"},{"type":"INSERT","lineNumber":11,"content":"import '../../core/utils/navigation_service.dart';"},{"type":"INSERT","lineNumber":12,"content":"import '../../core/utils/shared_prefs_manager.dart';"},{"type":"DELETE","lineNumber":10,"oldContent":"import 'package:shared_preferences/shared_preferences.dart';"},{"type":"DELETE","lineNumber":13,"oldContent":"import '../../core/network/network_info.dart';"},{"type":"DELETE","lineNumber":15,"oldContent":"import '../../core/network/network_info_impl.dart';"},{"type":"DELETE","lineNumber":17,"oldContent":"import '../../core/utils/navigation_service.dart';"},{"type":"DELETE","lineNumber":19,"oldContent":"import '../../core/utils/shared_prefs_manager.dart';"},{"type":"DELETE","lineNumber":39,"oldContent":"  await _initCoreDependencies();"},{"type":"DELETE","lineNumber":40,"oldContent":"}"},{"type":"DELETE","lineNumber":41,"oldContent":""},{"type":"MODIFY","lineNumber":42,"content":"  await _initCoreDependencies();","oldContent":"Future<void> _initCoreDependencies() async {"},{"type":"DELETE","lineNumber":48,"oldContent":"  sl.registerLazySingleton<SharedPrefsManager>(() => sharedPrefsManager);"},{"type":"DELETE","lineNumber":49,"oldContent":"  await sharedPrefsManager.init();"},{"type":"DELETE","lineNumber":50,"oldContent":"  final sharedPrefsManager = SharedPrefsManager(sharedPreferences: sl());"},{"type":"INSERT","lineNumber":45,"content":"Future<void> _initCoreDependencies() async {"},{"type":"DELETE","lineNumber":52,"oldContent":"  // Initialize SharedPrefsManager"},{"type":"DELETE","lineNumber":54,"oldContent":"  "},{"type":"DELETE","lineNumber":55,"oldContent":"  "},{"type":"DELETE","lineNumber":56,"oldContent":"  }"},{"type":"DELETE","lineNumber":58,"oldContent":"    sl.registerLazySingleton(() => sharedPreferences);"},{"type":"DELETE","lineNumber":60,"oldContent":"    final sharedPreferences = await SharedPreferences.getInstance();"},{"type":"DELETE","lineNumber":61,"oldContent":"    () => NetworkInfoImpl(connectivity: sl(), sharedPreferences: sl()),"},{"type":"DELETE","lineNumber":62,"oldContent":"  if (!sl.isRegistered<SharedPreferences>()) {"},{"type":"INSERT","lineNumber":50,"content":"        () => NetworkInfoImpl(connectivity: sl()),"},{"type":"DELETE","lineNumber":64,"oldContent":"  "},{"type":"DELETE","lineNumber":65,"oldContent":"  "},{"type":"DELETE","lineNumber":66,"oldContent":"  }"},{"type":"DELETE","lineNumber":67,"oldContent":"  // External"},{"type":"DELETE","lineNumber":68,"oldContent":"    sl.registerLazySingleton(() => Connectivity());"},{"type":"INSERT","lineNumber":52,"content":""},{"type":"INSERT","lineNumber":53,"content":"// External"},{"type":"INSERT","lineNumber":55,"content":"    sl.registerLazySingleton(() => Connectivity());"},{"type":"INSERT","lineNumber":56,"content":"  }"},{"type":"INSERT","lineNumber":57,"content":""},{"type":"INSERT","lineNumber":58,"content":"// Initialize SharedPreferences"},{"type":"INSERT","lineNumber":59,"content":"  final sharedPreferences = await SharedPreferences.getInstance();"},{"type":"INSERT","lineNumber":60,"content":"  if (!sl.isRegistered<SharedPreferences>()) {"},{"type":"INSERT","lineNumber":61,"content":"    sl.registerLazySingleton(() => sharedPreferences);"},{"type":"INSERT","lineNumber":62,"content":"  }"},{"type":"INSERT","lineNumber":63,"content":""},{"type":"INSERT","lineNumber":64,"content":"// Initialize SharedPrefsManager"},{"type":"INSERT","lineNumber":65,"content":"  await SharedPrefsManager.init();"},{"type":"INSERT","lineNumber":66,"content":"  sl.registerLazySingleton<SharedPrefsManager>(() => SharedPrefsManager());"}]},{"timestamp":1754511651259,"changes":[{"type":"INSERT","lineNumber":1,"content":""},{"type":"DELETE","lineNumber":2,"oldContent":"import 'package:cloud_firestore/cloud_firestore.dart';"},{"type":"DELETE","lineNumber":9,"oldContent":"import '../../features/auth/di/auth_injection_container.dart' as auth_di;"},{"type":"DELETE","lineNumber":11,"oldContent":"import '../../features/family/di/family_injection_container.dart' as family_di;"},{"type":"MODIFY","lineNumber":13,"content":"import '../../features/auth/di/auth_injection_container.dart' as auth_di;","oldContent":"import '../../features/splash/di/splash_injection_container.dart' as splash_di;"},{"type":"INSERT","lineNumber":14,"content":"import '../../features/family/di/family_injection_container.dart' as family_di;"},{"type":"INSERT","lineNumber":15,"content":"import '../../features/splash/di/splash_injection_container.dart' as splash_di;"},{"type":"DELETE","lineNumber":39,"oldContent":"  await _initCoreDependencies();"},{"type":"MODIFY","lineNumber":42,"content":"  await _initCoreDependencies();","oldContent":"Future<void> _initCoreDependencies() async {"},{"type":"DELETE","lineNumber":46,"oldContent":"        () => NetworkInfoImpl(connectivity: sl()),"},{"type":"INSERT","lineNumber":45,"content":"Future<void> _initCoreDependencies() async {"},{"type":"DELETE","lineNumber":48,"oldContent":""},{"type":"DELETE","lineNumber":49,"oldContent":"// External"},{"type":"DELETE","lineNumber":51,"oldContent":"    sl.registerLazySingleton(() => Connectivity());"},{"type":"DELETE","lineNumber":52,"oldContent":"  }"},{"type":"DELETE","lineNumber":53,"oldContent":""},{"type":"INSERT","lineNumber":48,"content":"  "},{"type":"DELETE","lineNumber":55,"oldContent":"// Initialize SharedPreferences"},{"type":"DELETE","lineNumber":56,"oldContent":"  final sharedPreferences = await SharedPreferences.getInstance();"},{"type":"INSERT","lineNumber":51,"content":"    () => NetworkInfoImpl(connectivity: sl(), sharedPreferences: sl()),"},{"type":"INSERT","lineNumber":52,"content":"  );"},{"type":"INSERT","lineNumber":53,"content":"  "},{"type":"INSERT","lineNumber":54,"content":"  // External"},{"type":"INSERT","lineNumber":55,"content":"  if (!sl.isRegistered<Connectivity>()) {"},{"type":"INSERT","lineNumber":56,"content":"    sl.registerLazySingleton(() => Connectivity());"},{"type":"INSERT","lineNumber":57,"content":"  }"},{"type":"INSERT","lineNumber":58,"content":"  "},{"type":"INSERT","lineNumber":60,"content":"    final sharedPreferences = await SharedPreferences.getInstance();"},{"type":"INSERT","lineNumber":63,"content":"  "},{"type":"INSERT","lineNumber":64,"content":"  // Initialize SharedPrefsManager"},{"type":"INSERT","lineNumber":65,"content":"  final sharedPrefsManager = SharedPrefsManager(sharedPreferences: sl());"},{"type":"INSERT","lineNumber":66,"content":"  await sharedPrefsManager.init();"},{"type":"INSERT","lineNumber":67,"content":"  sl.registerLazySingleton<SharedPrefsManager>(() => sharedPrefsManager);"},{"type":"INSERT","lineNumber":68,"content":"}"},{"type":"DELETE","lineNumber":62,"oldContent":"  );"},{"type":"DELETE","lineNumber":63,"oldContent":"// Initialize SharedPrefsManager"},{"type":"DELETE","lineNumber":64,"oldContent":"  await SharedPrefsManager.init();"},{"type":"DELETE","lineNumber":65,"oldContent":"  sl.registerLazySingleton<SharedPrefsManager>(() => SharedPrefsManager());"},{"type":"DELETE","lineNumber":66,"oldContent":"  if (!sl.isRegistered<Connectivity>()) {"}]},{"timestamp":1754511668793,"changes":[{"type":"INSERT","lineNumber":11,"content":"import '../../core/utils/navigation_service.dart';"},{"type":"INSERT","lineNumber":12,"content":"import '../../core/utils/shared_prefs_manager.dart';"},{"type":"DELETE","lineNumber":14,"oldContent":"import '../../features/splash/di/splash_injection_container.dart' as splash_di;"},{"type":"DELETE","lineNumber":15,"oldContent":"import '../../core/utils/shared_prefs_manager.dart';"},{"type":"MODIFY","lineNumber":42,"content":"  await _initCoreDependencies();","oldContent":"  await _initCoreDependencies();"},{"type":"MODIFY","lineNumber":45,"content":"Future<void> _initCoreDependencies() async {","oldContent":"Future<void> _initCoreDependencies() async {"},{"type":"DELETE","lineNumber":47,"oldContent":"  "},{"type":"DELETE","lineNumber":49,"oldContent":"    () => NetworkInfoImpl(connectivity: sl(), sharedPreferences: sl()),"},{"type":"DELETE","lineNumber":50,"oldContent":"  );"},{"type":"DELETE","lineNumber":53,"oldContent":"  // Core - Network"},{"type":"DELETE","lineNumber":57,"oldContent":"  sl.registerLazySingleton<NetworkInfo>("},{"type":"INSERT","lineNumber":54,"content":"  // Initialize SharedPreferences"},{"type":"INSERT","lineNumber":55,"content":"  final sharedPreferences = await SharedPreferences.getInstance();"},{"type":"DELETE","lineNumber":61,"oldContent":"    final sharedPreferences = await SharedPreferences.getInstance();"},{"type":"DELETE","lineNumber":63,"oldContent":""},{"type":"INSERT","lineNumber":60,"content":"  // Core - Network"},{"type":"INSERT","lineNumber":61,"content":"  sl.registerLazySingleton<NetworkInfo>("},{"type":"INSERT","lineNumber":62,"content":"    () => NetworkInfoImpl(connectivity: sl()),"},{"type":"INSERT","lineNumber":63,"content":"  );"},{"type":"INSERT","lineNumber":64,"content":"  "},{"type":"DELETE","lineNumber":66,"oldContent":"  final sharedPrefsManager = SharedPrefsManager(sharedPreferences: sl());"},{"type":"DELETE","lineNumber":67,"oldContent":"  await sharedPrefsManager.init();"},{"type":"DELETE","lineNumber":68,"oldContent":"  sl.registerLazySingleton<SharedPrefsManager>(() => sharedPrefsManager);"},{"type":"INSERT","lineNumber":66,"content":"  await SharedPrefsManager.init();"},{"type":"INSERT","lineNumber":67,"content":"  sl.registerLazySingleton<SharedPrefsManager>(() => SharedPrefsManager());"},{"type":"INSERT","lineNumber":69,"content":""}]},{"timestamp":1754598194409,"changes":[{"type":"MODIFY","lineNumber":13,"content":"import '../../features/auth/di/auth_injection_container.dart' as auth_di;","oldContent":"import '../../features/auth/di/auth_injection_container.dart' as auth_di;"},{"type":"INSERT","lineNumber":15,"content":"import '../../features/home/di/home_injection_container.dart' as home_di;"},{"type":"INSERT","lineNumber":37,"content":"  // Initialize home dependencies"},{"type":"INSERT","lineNumber":38,"content":"  await home_di.initHomeFeature();"},{"type":"INSERT","lineNumber":39,"content":"  "},{"type":"INSERT","lineNumber":45,"content":"  // Initialize other core dependencies"},{"type":"DELETE","lineNumber":42,"oldContent":"  await _initCoreDependencies();"},{"type":"INSERT","lineNumber":48,"content":""},{"type":"DELETE","lineNumber":45,"oldContent":"Future<void> _initCoreDependencies() async {"},{"type":"DELETE","lineNumber":50,"oldContent":"  // Initialize SharedPreferences"},{"type":"DELETE","lineNumber":52,"oldContent":"  final sharedPreferences = await SharedPreferences.getInstance();"},{"type":"INSERT","lineNumber":58,"content":"  // Initialize SharedPreferences"},{"type":"INSERT","lineNumber":59,"content":"  final sharedPreferences = await SharedPreferences.getInstance();"},{"type":"DELETE","lineNumber":57,"oldContent":"  // Core - Network"},{"type":"INSERT","lineNumber":62,"content":"  }"},{"type":"INSERT","lineNumber":63,"content":"  "},{"type":"INSERT","lineNumber":64,"content":"  // Core - Network"},{"type":"DELETE","lineNumber":61,"oldContent":"  }"},{"type":"DELETE","lineNumber":64,"oldContent":"  "},{"type":"DELETE","lineNumber":68,"oldContent":""},{"type":"INSERT","lineNumber":73,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/splash/presentation/screens/splash_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/splash/presentation/screens/splash_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:lottie/lottie.dart';\nimport 'package:provider/provider.dart';\nimport 'package:family_tree_firebase/core/constants/app_constants.dart';\nimport 'package:family_tree_firebase/features/splash/presentation/viewmodels/splash_viewmodel.dart';\n\nclass SplashScreen extends StatefulWidget {\n  const SplashScreen({super.key});\n\n  @override\n  State<SplashScreen> createState() => _SplashScreenState();\n}\n\nclass _SplashScreenState extends State<SplashScreen> with SingleTickerProviderStateMixin {\n  late final AnimationController _animationController;\n  late final SplashViewModel _viewModel;\n\n  @override\n  void initState() {\n    super.initState();\n    _animationController = AnimationController(\n      vsync: this,\n      duration: const Duration(seconds: 2),\n    );\n    _viewModel = context.read<SplashViewModel>();\n    _navigateToNextScreen();\n  }\n\n  Future<void> _navigateToNextScreen() async {\n    final isAuthenticated = await _viewModel.checkAuthentication();\n    if (mounted) {\n      Navigator.pushReplacementNamed(\n        context,\n        isAuthenticated \n            ? AppConstants.homeRoute \n            : AppConstants.loginRoute,\n      );\n    }\n  }\n\n  @override\n  void dispose() {\n    _animationController.dispose();\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      backgroundColor: Colors.white,\n      body: Center(\n        child: Column(\n          mainAxisAlignment: MainAxisAlignment.center,\n          children: [\n            // Logo and App Name\n            Hero(\n              tag: 'app-logo',\n              child: Column(\n                children: [\n                  // Replace with your app logo\n                  Container(\n                    width: 150,\n                    height: 150,\n                    decoration: BoxDecoration(\n                      color: Colors.red[100],\n                      shape: BoxShape.circle,\n                    ),\n                    child: const Icon(\n                      Icons.family_restroom,\n                      size: 100,\n                      color: Colors.red,\n                    ),\n                  ),\n                  const SizedBox(height: 20),\n                  const Text(\n                    'Family Connect',\n                    style: TextStyle(\n                      fontSize: 28,\n                      fontWeight: FontWeight.bold,\n                      color: Colors.black87,\n                    ),\n                  ),\n                ],\n              ),\n            ),\n            const SizedBox(height: 50),\n            // Loading animation\n            SizedBox(\n              width: 100,\n              height: 100,\n              child: Lottie.asset(\n                'assets/animations/loading_animation.json',\n                controller: _animationController,\n                onLoaded: (composition) {\n                  _animationController\n                    ..duration = composition.duration\n                    ..repeat();\n                },\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n","baseTimestamp":1754470879709,"deltas":[{"timestamp":1754592199268,"changes":[{"type":"MODIFY","lineNumber":23,"content":"    )..forward();","oldContent":"    );"},{"type":"MODIFY","lineNumber":25,"content":"    // Delay the navigation check until after the first frame is rendered","oldContent":"    _navigateToNextScreen();"},{"type":"INSERT","lineNumber":26,"content":"    WidgetsBinding.instance.addPostFrameCallback((_) {"},{"type":"INSERT","lineNumber":27,"content":"      _navigateToNextScreen();"},{"type":"INSERT","lineNumber":28,"content":"    });"},{"type":"DELETE","lineNumber":29,"oldContent":"    final isAuthenticated = await _viewModel.checkAuthentication();"},{"type":"DELETE","lineNumber":30,"oldContent":"    if (mounted) {"},{"type":"DELETE","lineNumber":31,"oldContent":"      Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":32,"oldContent":"        context,"},{"type":"DELETE","lineNumber":33,"oldContent":"        isAuthenticated "},{"type":"DELETE","lineNumber":34,"oldContent":"            ? AppConstants.homeRoute "},{"type":"DELETE","lineNumber":35,"oldContent":"            : AppConstants.loginRoute,"},{"type":"DELETE","lineNumber":36,"oldContent":"      );"},{"type":"INSERT","lineNumber":32,"content":"    try {"},{"type":"INSERT","lineNumber":33,"content":"      final isAuthenticated = await _viewModel.checkAuthentication();"},{"type":"INSERT","lineNumber":34,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":35,"content":"        await Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":36,"content":"          context,"},{"type":"INSERT","lineNumber":37,"content":"          isAuthenticated "},{"type":"INSERT","lineNumber":38,"content":"              ? AppConstants.homeRoute "},{"type":"INSERT","lineNumber":39,"content":"              : AppConstants.loginRoute,"},{"type":"INSERT","lineNumber":40,"content":"        );"},{"type":"INSERT","lineNumber":41,"content":"      }"},{"type":"INSERT","lineNumber":42,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":43,"content":"      if (mounted) {"},{"type":"INSERT","lineNumber":44,"content":"        // In case of any error, navigate to login screen"},{"type":"INSERT","lineNumber":45,"content":"        await Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":46,"content":"          context,"},{"type":"INSERT","lineNumber":47,"content":"          AppConstants.loginRoute,"},{"type":"INSERT","lineNumber":48,"content":"        );"},{"type":"INSERT","lineNumber":49,"content":"      }"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/di/auth_injection_container.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/di/auth_injection_container.dart","baseContent":"import 'package:firebase_auth/firebase_auth.dart';\nimport 'package:get_it/get_it.dart';\nimport 'package:google_sign_in/google_sign_in.dart';\nimport 'package:sign_in_with_apple/sign_in_with_apple.dart';\n\nimport '../data/datasources/auth_remote_data_source.dart';\nimport '../data/datasources/auth_remote_data_source_impl.dart';\nimport '../data/repositories/auth_repository_impl.dart';\nimport '../domain/repositories/auth_repository.dart';\nimport '../domain/usecases/check_auth_status.dart';\nimport '../domain/usecases/delete_account.dart';\nimport '../domain/usecases/register_with_email_and_password.dart';\nimport '../domain/usecases/send_otp_to_phone_number.dart';\nimport '../domain/usecases/send_password_reset_email.dart';\nimport '../domain/usecases/sign_in_with_apple.dart';\nimport '../domain/usecases/sign_in_with_email_and_password.dart';\nimport '../domain/usecases/sign_in_with_google.dart';\nimport '../domain/usecases/sign_out.dart';\nimport '../domain/usecases/verify_otp.dart';\nimport '../presentation/viewmodels/auth_viewmodel.dart';\n\nfinal sl = GetIt.instance;\n\nFuture<void> initAuthFeature() async {\n  // ViewModel\n  sl.registerFactory(\n    () => AuthViewModel(\n      checkAuthStatus: sl(),\n      signInWithEmailAndPassword: sl(),\n      registerWithEmailAndPassword: sl(),\n      signInWithGoogle: sl(),\n      signInWithApple: sl(),\n      sendOtpToPhoneNumber: sl(),\n      verifyOtp: sl(),\n      signOut: sl(),\n      sendPasswordResetEmail: sl(),\n      deleteAccount: sl(),\n    ),\n  );\n\n  // Use cases\n  sl.registerLazySingleton(() => CheckAuthStatus(sl()));\n  sl.registerLazySingleton(() => SignInWithEmailAndPassword(sl()));\n  sl.registerLazySingleton(() => RegisterWithEmailAndPassword(sl()));\n  sl.registerLazySingleton(() => SignInWithGoogle(sl()));\n  sl.registerLazySingleton(() => SignInWithApple(sl()));\n  sl.registerLazySingleton(() => SendOtpToPhoneNumber(sl()));\n  sl.registerLazySingleton(() => VerifyOtp(sl()));\n  sl.registerLazySingleton(() => SignOut(sl()));\n  sl.registerLazySingleton(() => SendPasswordResetEmail(sl()));\n  sl.registerLazySingleton(() => DeleteAccount(sl()));\n\n  // Repository\n  sl.registerLazySingleton<AuthRepository>(\n    () => AuthRepositoryImpl(remoteDataSource: sl()),\n  );\n\n  // Data sources\n  sl.registerLazySingleton<AuthRemoteDataSource>(\n    () => AuthRemoteDataSourceImpl(\n      firebaseAuth: sl(),\n      googleSignIn: sl(),\n    ),\n  );\n\n  // External\n  if (!sl.isRegistered<FirebaseAuth>()) {\n    sl.registerLazySingleton(() => FirebaseAuth.instance);\n  }\n  \n  if (!sl.isRegistered<GoogleSignIn>()) {\n    sl.registerLazySingleton(() => GoogleSignIn.standard());\n  }\n  \n  if (!sl.isRegistered<AppleIDAuthorizationScopes>()) {\n    sl.registerLazySingleton(() => AppleIDAuthorizationScopes(\n      email: [],\n      fullName: [],\n    ));\n  }\n}\n","baseTimestamp":1754471916067,"deltas":[{"timestamp":1754512214589,"changes":[{"type":"MODIFY","lineNumber":3,"content":"import 'package:sign_in_with_apple/sign_in_with_apple.dart' hide SignInWithApple;","oldContent":"import 'package:sign_in_with_apple/sign_in_with_apple.dart';"}]},{"timestamp":1754516286180,"changes":[{"type":"DELETE","lineNumber":73,"oldContent":"  "},{"type":"DELETE","lineNumber":74,"oldContent":"  if (!sl.isRegistered<AppleIDAuthorizationScopes>()) {"},{"type":"DELETE","lineNumber":75,"oldContent":"    sl.registerLazySingleton(() => AppleIDAuthorizationScopes("},{"type":"DELETE","lineNumber":76,"oldContent":"      email: [],"},{"type":"DELETE","lineNumber":77,"oldContent":"      fullName: [],"},{"type":"DELETE","lineNumber":78,"oldContent":"    ));"},{"type":"DELETE","lineNumber":79,"oldContent":"  }"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/injection_container.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/injection_container.dart","baseContent":"import 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:get_it/get_it.dart';\nimport 'package:family_tree_firebase/features/family/data/datasources/family_remote_data_source.dart';\nimport 'package:family_tree_firebase/features/family/data/repositories/family_repository_impl.dart';\nimport 'package:family_tree_firebase/features/family/domain/repositories/family_repository.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/create_family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/generate_invite_code.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/get_current_family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/join_family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/validate_invite_code.dart';\nimport 'package:family_tree_firebase/features/family/presentation/viewmodels/family_viewmodel.dart';\n\nfinal sl = GetIt.instance;\n\nFuture<void> init() async {\n  // External\n  sl.registerLazySingleton(() => FirebaseFirestore.instance);\n  sl.registerLazySingleton(() => FirebaseAuth.instance);\n  \n  // Data sources\n  sl.registerLazySingleton<FamilyRemoteDataSource>(\n    () => FamilyRemoteDataSourceImpl(\n      firestore: sl(),\n      firebaseAuth: sl(),\n    ),\n  );\n  \n  // Repository\n  sl.registerLazySingleton<FamilyRepository>(\n    () => FamilyRepositoryImpl(\n      remoteDataSource: sl(),\n      firebaseAuth: sl(),\n    ),\n  );\n  \n  // Use cases\n  sl.registerLazySingleton(() => CreateFamily(sl()));\n  sl.registerLazySingleton(() => JoinFamily(sl()));\n  sl.registerLazySingleton(() => GetCurrentFamily(sl()));\n  sl.registerLazySingleton(() => GenerateInviteCode(sl()));\n  sl.registerLazySingleton(() => ValidateInviteCode(sl()));\n  \n  // ViewModel\n  sl.registerFactory(\n    () => FamilyViewModel(\n      createFamily: sl(),\n      joinFamily: sl(),\n      getCurrentFamily: sl(),\n      generateInviteCode: sl(),\n      validateInviteCode: sl(),\n    ),\n  );\n}\n","baseTimestamp":1754474379638},"/Users/rathin/Desktop/My_projects/family_tree_firebase/features/home/presentation/viewmodels/home_viewmodel.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/features/home/presentation/viewmodels/home_viewmodel.dart","baseContent":"import 'package:flutter/foundation.dart';\nimport 'package:family_tree_firebase/core/base/base_viewmodel.dart';\nimport 'package:family_tree_firebase/features/home/domain/models/post_model.dart';\nimport 'package:family_tree_firebase/features/home/domain/models/story_model.dart';\n\nclass HomeViewModel extends BaseViewModel {\n  List<StoryModel> _stories = [];\n  List<PostModel> _posts = [];\n  int _currentStoryIndex = 0;\n  bool _isLoadingStories = false;\n  bool _isLoadingPosts = false;\n  bool _hasError = false;\n  String? _errorMessage;\n\n  List<StoryModel> get stories => _stories;\n  List<PostModel> get posts => _posts;\n  int get currentStoryIndex => _currentStoryIndex;\n  bool get isLoadingStories => _isLoadingStories;\n  bool get isLoadingPosts => _isLoadingPosts;\n  bool get hasError => _hasError;\n  String? get errorMessage => _errorMessage;\n\n  // Initialize with mock data (in a real app, this would come from a repository)\n  Future<void> loadInitialData() async {\n    await Future.wait([\n      _loadStories(),\n      _loadPosts(),\n    ]);\n  }\n\n  Future<void> _loadStories() async {\n    try {\n      _hasError = false;\n      _errorMessage = null;\n      _isLoadingStories = true;\n      notifyListeners();\n\n      // Simulate network delay\n      await Future.delayed(const Duration(milliseconds: 500));\n\n      // Mock data - in a real app, this would come from a repository\n      _stories = [\n        StoryModel(\n          id: '1',\n          userId: 'user1',\n          userName: 'John Doe',\n          userImageUrl: 'https://randomuser.me/api/portraits/men/1.jpg',\n          imageUrl: 'https://picsum.photos/400/800',\n          timestamp: DateTime.now().subtract(const Duration(hours: 2)),\n          isSeen: false,\n        ),\n        // Add more mock stories...\n      ];\n    } catch (e) {\n      setError('Failed to load stories');\n    } finally {\n      _isLoadingStories = false;\n      notifyListeners();\n    }\n  }\n\n  Future<void> _loadPosts() async {\n    try {\n      _hasError = false;\n      _errorMessage = null;\n      _isLoadingPosts = true;\n      notifyListeners();\n\n      // Simulate network delay\n      await Future.delayed(const Duration(milliseconds: 800));\n\n      // Mock data - in a real app, this would come from a repository\n      _posts = [\n        PostModel(\n          id: '1',\n          userId: 'user1',\n          userName: 'John Doe',\n          userImageUrl: 'https://randomuser.me/api/portraits/men/1.jpg',\n          imageUrl: 'https://picsum.photos/800/1000',\n          caption: 'Enjoying a beautiful day with family! 😊 #FamilyTime #Happy',\n          timestamp: DateTime.now().subtract(const Duration(hours: 3)),\n          likes: 42,\n          comments: [],\n        ),\n        // Add more mock posts...\n      ];\n    } catch (e) {\n      setError('Failed to load posts');\n    } finally {\n      _isLoadingPosts = false;\n      notifyListeners();\n    }\n  }\n\n  void setCurrentStoryIndex(int index) {\n    _currentStoryIndex = index;\n    notifyListeners();\n  }\n\n  Future<void> likePost(String postId) async {\n    try {\n      final postIndex = _posts.indexWhere((post) => post.id == postId);\n      if (postIndex != -1) {\n        final post = _posts[postIndex];\n        _posts[postIndex] = post.copyWith(\n          likes: post.likes + 1,\n          isLiked: true,\n        );\n        notifyListeners();\n      }\n    } catch (e) {\n      setError('Failed to like post');\n    }\n  }\n\n  Future<void> addComment(String postId, String comment) async {\n    try {\n      final postIndex = _posts.indexWhere((post) => post.id == postId);\n      if (postIndex != -1) {\n        final post = _posts[postIndex];\n        final newComment = CommentModel(\n          id: DateTime.now().millisecondsSinceEpoch.toString(),\n          userId: 'current_user_id', // In a real app, get from auth\n          userName: 'Current User',\n          userImageUrl: 'https://randomuser.me/api/portraits/men/3.jpg',\n          text: comment,\n          timestamp: DateTime.now(),\n        );\n        \n        _posts[postIndex] = post.copyWith(\n          comments: [...post.comments, newComment],\n        );\n        notifyListeners();\n      }\n    } catch (e) {\n      setError('Failed to add comment');\n    }\n  }\n}\n","baseTimestamp":1754474780370,"deltas":[{"timestamp":1754475872332,"changes":[{"type":"DELETE","lineNumber":0,"oldContent":"import 'package:flutter/foundation.dart';"},{"type":"INSERT","lineNumber":4,"content":"/// ViewModel for the Home screen that manages the state and business logic"},{"type":"DELETE","lineNumber":11,"oldContent":"  bool _hasError = false;"},{"type":"MODIFY","lineNumber":12,"content":"  // Getters for the view to access the state","oldContent":"  String? _errorMessage;"},{"type":"DELETE","lineNumber":19,"oldContent":"  bool get hasError => _hasError;"},{"type":"DELETE","lineNumber":20,"oldContent":"  String? get errorMessage => _errorMessage;"},{"type":"DELETE","lineNumber":22,"oldContent":"  // Initialize with mock data (in a real app, this would come from a repository)"},{"type":"INSERT","lineNumber":19,"content":"  /// Loads the initial data for the home screen"},{"type":"INSERT","lineNumber":20,"content":"  /// This would typically be called when the home screen is first loaded"},{"type":"DELETE","lineNumber":24,"oldContent":"    await Future.wait(["},{"type":"DELETE","lineNumber":25,"oldContent":"      _loadStories(),"},{"type":"DELETE","lineNumber":26,"oldContent":"      _loadPosts(),"},{"type":"DELETE","lineNumber":27,"oldContent":"    ]);"},{"type":"INSERT","lineNumber":22,"content":"    try {"},{"type":"INSERT","lineNumber":23,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":24,"content":"      await Future.wait(["},{"type":"INSERT","lineNumber":25,"content":"        _loadStories(),"},{"type":"INSERT","lineNumber":26,"content":"        _loadPosts(),"},{"type":"INSERT","lineNumber":27,"content":"      ]);"},{"type":"INSERT","lineNumber":28,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":29,"content":"      setError(message: 'Failed to load home data: ${e.toString()}');"},{"type":"INSERT","lineNumber":30,"content":"    } finally {"},{"type":"INSERT","lineNumber":31,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":32,"content":"    }"},{"type":"INSERT","lineNumber":35,"content":"  /// Loads the stories for the home screen"},{"type":"INSERT","lineNumber":36,"content":"  /// In a real app, this would fetch data from a repository"},{"type":"DELETE","lineNumber":32,"oldContent":"      _hasError = false;"},{"type":"DELETE","lineNumber":33,"oldContent":"      _errorMessage = null;"},{"type":"DELETE","lineNumber":51,"oldContent":"        // Add more mock stories..."},{"type":"INSERT","lineNumber":56,"content":"        StoryModel("},{"type":"INSERT","lineNumber":57,"content":"          id: '2',"},{"type":"INSERT","lineNumber":58,"content":"          userId: 'user2',"},{"type":"INSERT","lineNumber":59,"content":"          userName: 'Jane Smith',"},{"type":"INSERT","lineNumber":60,"content":"          userImageUrl: 'https://randomuser.me/api/portraits/women/1.jpg',"},{"type":"INSERT","lineNumber":61,"content":"          imageUrl: 'https://picsum.photos/400/801',"},{"type":"INSERT","lineNumber":62,"content":"          timestamp: DateTime.now().subtract(const Duration(hours: 1)),"},{"type":"INSERT","lineNumber":63,"content":"          isSeen: false,"},{"type":"INSERT","lineNumber":64,"content":"        ),"},{"type":"INSERT","lineNumber":65,"content":"        // Add more mock stories as needed"},{"type":"DELETE","lineNumber":54,"oldContent":"      setError('Failed to load stories');"},{"type":"INSERT","lineNumber":68,"content":"      setError(message: 'Failed to load stories: ${e.toString()}');"},{"type":"INSERT","lineNumber":69,"content":"      rethrow;"},{"type":"INSERT","lineNumber":76,"content":"  /// Loads the posts for the home screen"},{"type":"INSERT","lineNumber":77,"content":"  /// In a real app, this would fetch data from a repository"},{"type":"DELETE","lineNumber":63,"oldContent":"      _hasError = false;"},{"type":"DELETE","lineNumber":64,"oldContent":"      _errorMessage = null;"},{"type":"DELETE","lineNumber":84,"oldContent":"        // Add more mock posts..."},{"type":"INSERT","lineNumber":99,"content":"        PostModel("},{"type":"INSERT","lineNumber":100,"content":"          id: '2',"},{"type":"INSERT","lineNumber":101,"content":"          userId: 'user2',"},{"type":"INSERT","lineNumber":102,"content":"          userName: 'Jane Smith',"},{"type":"INSERT","lineNumber":103,"content":"          userImageUrl: 'https://randomuser.me/api/portraits/women/1.jpg',"},{"type":"INSERT","lineNumber":104,"content":"          imageUrl: 'https://picsum.photos/800/1001',"},{"type":"INSERT","lineNumber":105,"content":"          caption: 'Family reunion 2023! So much fun with everyone! 🎉',"},{"type":"INSERT","lineNumber":106,"content":"          timestamp: DateTime.now().subtract(const Duration(hours: 5)),"},{"type":"INSERT","lineNumber":107,"content":"          likes: 128,"},{"type":"INSERT","lineNumber":108,"content":"          comments: [],"},{"type":"INSERT","lineNumber":109,"content":"        ),"},{"type":"INSERT","lineNumber":110,"content":"        // Add more mock posts as needed"},{"type":"DELETE","lineNumber":87,"oldContent":"      setError('Failed to load posts');"},{"type":"INSERT","lineNumber":113,"content":"      setError(message: 'Failed to load posts: ${e.toString()}');"},{"type":"INSERT","lineNumber":114,"content":"      rethrow;"},{"type":"INSERT","lineNumber":121,"content":"  /// Updates the current story index when the user swipes through stories"},{"type":"DELETE","lineNumber":95,"oldContent":"    _currentStoryIndex = index;"},{"type":"DELETE","lineNumber":96,"oldContent":"    notifyListeners();"},{"type":"INSERT","lineNumber":123,"content":"    if (index >= 0 && index < _stories.length) {"},{"type":"INSERT","lineNumber":124,"content":"      _currentStoryIndex = index;"},{"type":"INSERT","lineNumber":125,"content":"      "},{"type":"INSERT","lineNumber":126,"content":"      // Mark the story as seen"},{"type":"INSERT","lineNumber":127,"content":"      if (!_stories[index].isSeen) {"},{"type":"INSERT","lineNumber":128,"content":"        _stories[index] = _stories[index].copyWith(isSeen: true);"},{"type":"INSERT","lineNumber":129,"content":"      }"},{"type":"INSERT","lineNumber":130,"content":"      "},{"type":"INSERT","lineNumber":131,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":132,"content":"    }"},{"type":"INSERT","lineNumber":135,"content":"  /// Toggles the like status of a post"},{"type":"INSERT","lineNumber":136,"content":"  /// In a real app, this would make an API call to update the like status"},{"type":"INSERT","lineNumber":139,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":140,"content":"      "},{"type":"INSERT","lineNumber":141,"content":"      // Simulate network delay"},{"type":"INSERT","lineNumber":142,"content":"      await Future.delayed(const Duration(milliseconds: 300));"},{"type":"INSERT","lineNumber":143,"content":"      "},{"type":"INSERT","lineNumber":144,"content":"      // Find the post and toggle its like status"},{"type":"INSERT","lineNumber":148,"content":"        final isLiked = post.isLiked;"},{"type":"INSERT","lineNumber":149,"content":"        "},{"type":"INSERT","lineNumber":151,"content":"          isLiked: !isLiked,"},{"type":"INSERT","lineNumber":152,"content":"          likes: isLiked ? post.likes - 1 : post.likes + 1,"},{"type":"INSERT","lineNumber":153,"content":"        );"},{"type":"INSERT","lineNumber":154,"content":"        "},{"type":"INSERT","lineNumber":155,"content":"        notifyListeners();"},{"type":"INSERT","lineNumber":156,"content":"      }"},{"type":"INSERT","lineNumber":157,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":158,"content":"      setError(message: 'Failed to update like status');"},{"type":"INSERT","lineNumber":159,"content":"      rethrow;"},{"type":"INSERT","lineNumber":160,"content":"    } finally {"},{"type":"INSERT","lineNumber":161,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":162,"content":"    }"},{"type":"INSERT","lineNumber":163,"content":"    try {"},{"type":"INSERT","lineNumber":164,"content":"      final postIndex = _posts.indexWhere((post) => post.id == postId);"},{"type":"INSERT","lineNumber":165,"content":"      if (postIndex != -1) {"},{"type":"INSERT","lineNumber":166,"content":"        final post = _posts[postIndex];"},{"type":"INSERT","lineNumber":167,"content":"        _posts[postIndex] = post.copyWith("}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/viewmodels/family_viewmodel.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/presentation/viewmodels/family_viewmodel.dart","baseContent":"import 'package:flutter/foundation.dart';\nimport 'package:family_tree_firebase/core/base/base_viewmodel.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/features/family/domain/entities/family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/create_family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/generate_invite_code.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/get_current_family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/join_family.dart';\nimport 'package:family_tree_firebase/features/family/domain/usecases/validate_invite_code.dart';\n\nclass FamilyViewModel extends BaseViewModel {\n  final CreateFamily createFamily;\n  final JoinFamily joinFamily;\n  final GetCurrentFamily getCurrentFamily;\n  final GenerateInviteCode generateInviteCode;\n  final ValidateInviteCode validateInviteCode;\n\n  Family? _currentFamily;\n  String? _generatedInviteCode;\n  String? _errorMessage;\n  bool _isLoading = false;\n  bool _isInviteCodeValid = false;\n\n  Family? get currentFamily => _currentFamily;\n  String? get generatedInviteCode => _generatedInviteCode;\n  String? get errorMessage => _errorMessage;\n  bool get isInviteCodeValid => _isInviteCodeValid;\n  @override\n  bool get isLoading => _isLoading;\n\n  FamilyViewModel({\n    required this.createFamily,\n    required this.joinFamily,\n    required this.getCurrentFamily,\n    required this.generateInviteCode,\n    required this.validateInviteCode,\n  });\n\n  // Create a new family\n  Future<bool> createNewFamily(String familyName) async {\n    setLoading(true);\n    try {\n      final result = await createFamily(CreateFamilyParams(name: familyName));\n      return result.fold(\n        (failure) {\n          _errorMessage = failure.message;\n          notifyListeners();\n          return false;\n        },\n        (family) {\n          _currentFamily = family;\n          notifyListeners();\n          return true;\n        },\n      );\n    } catch (e) {\n      _errorMessage = 'Failed to create family: $e';\n      notifyListeners();\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Join an existing family\n  Future<bool> joinFamily(String inviteCode) async {\n    setLoading(true);\n    try {\n      final result = await joinFamily(JoinFamilyParams(inviteCode: inviteCode));\n      return result.fold(\n        (failure) {\n          _errorMessage = failure.message;\n          notifyListeners();\n          return false;\n        },\n        (family) {\n          _currentFamily = family;\n          notifyListeners();\n          return true;\n        },\n      );\n    } catch (e) {\n      _errorMessage = 'Failed to join family: $e';\n      notifyListeners();\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Get current user's family\n  Future<void> loadCurrentFamily() async {\n    setLoading(true);\n    try {\n      final result = await getCurrentFamily(NoParams());\n      result.fold(\n        (failure) {\n          _errorMessage = failure.message;\n          _currentFamily = null;\n        },\n        (family) {\n          _currentFamily = family;\n          _errorMessage = null;\n        },\n      );\n      notifyListeners();\n    } catch (e) {\n      _errorMessage = 'Failed to load family: $e';\n      _currentFamily = null;\n      notifyListeners();\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Generate a new invite code\n  Future<String?> generateNewInviteCode() async {\n    setLoading(true);\n    try {\n      final result = await generateInviteCode(NoParams());\n      return result.fold(\n        (failure) {\n          _errorMessage = failure.message;\n          _generatedInviteCode = null;\n          notifyListeners();\n          return null;\n        },\n        (inviteCode) {\n          _generatedInviteCode = inviteCode;\n          _errorMessage = null;\n          notifyListeners();\n          return inviteCode;\n        },\n      );\n    } catch (e) {\n      _errorMessage = 'Failed to generate invite code: $e';\n      _generatedInviteCode = null;\n      notifyListeners();\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Validate an invite code\n  Future<bool> checkInviteCode(String inviteCode) async {\n    setLoading(true);\n    try {\n      final result = await validateInviteCode(\n        ValidateInviteCodeParams(inviteCode: inviteCode),\n      );\n      return result.fold(\n        (failure) {\n          _errorMessage = failure.message;\n          _isInviteCodeValid = false;\n          notifyListeners();\n          return false;\n        },\n        (isValid) {\n          _isInviteCodeValid = isValid;\n          _errorMessage = isValid ? null : 'Invalid invite code';\n          notifyListeners();\n          return isValid;\n        },\n      );\n    } catch (e) {\n      _errorMessage = 'Failed to validate invite code: $e';\n      _isInviteCodeValid = false;\n      notifyListeners();\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Clear error message\n  void clearError() {\n    _errorMessage = null;\n    notifyListeners();\n  }\n\n  @override\n  void setLoading(bool loading) {\n    _isLoading = loading;\n    notifyListeners();\n  }\n\n  @override\n  void setError({bool hasError = true, String? message}) {\n    _errorMessage = message;\n    notifyListeners();\n  }\n}\n","baseTimestamp":1754478577409,"deltas":[{"timestamp":1754478640285,"changes":[{"type":"MODIFY","lineNumber":65,"content":"  Future<bool> joinFamilyWithCode(String inviteCode) async {","oldContent":"  Future<bool> joinFamily(String inviteCode) async {"}]},{"timestamp":1754515733696,"changes":[{"type":"INSERT","lineNumber":19,"content":"  String? _inviteCode;"},{"type":"INSERT","lineNumber":26,"content":"  String? get inviteCode => _inviteCode;"},{"type":"INSERT","lineNumber":177,"content":"  // Check family status"},{"type":"INSERT","lineNumber":178,"content":"  Future<void> checkFamilyStatus() async {"},{"type":"INSERT","lineNumber":179,"content":"    // TODO: Implement family status check"},{"type":"INSERT","lineNumber":180,"content":"    print('Checking family status...');"},{"type":"INSERT","lineNumber":181,"content":"  }"},{"type":"INSERT","lineNumber":182,"content":""},{"type":"INSERT","lineNumber":183,"content":"  // Validate invite code"},{"type":"INSERT","lineNumber":184,"content":"  Future<bool> validateCode(String code) async {"},{"type":"INSERT","lineNumber":185,"content":"    // TODO: Implement invite code validation"},{"type":"INSERT","lineNumber":186,"content":"    print('Validating code: $code');"},{"type":"INSERT","lineNumber":187,"content":"    return true;"},{"type":"INSERT","lineNumber":188,"content":"  }"},{"type":"INSERT","lineNumber":189,"content":""},{"type":"INSERT","lineNumber":190,"content":"  // Join existing family"},{"type":"INSERT","lineNumber":191,"content":"  Future<bool> joinExistingFamily(String inviteCode) async {"},{"type":"INSERT","lineNumber":192,"content":"    // TODO: Implement join family logic"},{"type":"INSERT","lineNumber":193,"content":"    print('Joining family with code: $inviteCode');"},{"type":"INSERT","lineNumber":194,"content":"    return true;"},{"type":"INSERT","lineNumber":195,"content":"  }"},{"type":"INSERT","lineNumber":196,"content":""},{"type":"INSERT","lineNumber":197,"content":"  // Create family"},{"type":"INSERT","lineNumber":198,"content":"  Future<void> createFamily(String familyName) async {"},{"type":"INSERT","lineNumber":199,"content":"    setState(ViewState.busy);"},{"type":"INSERT","lineNumber":200,"content":"    setLoading(true);"},{"type":"INSERT","lineNumber":201,"content":"    try {"},{"type":"INSERT","lineNumber":202,"content":"      final result = await createFamily(CreateFamilyParams(name: familyName));"},{"type":"INSERT","lineNumber":203,"content":"      result.fold("},{"type":"INSERT","lineNumber":204,"content":"        (failure) {"},{"type":"INSERT","lineNumber":205,"content":"          _errorMessage = failure.message;"},{"type":"INSERT","lineNumber":206,"content":"          _currentFamily = null;"},{"type":"INSERT","lineNumber":207,"content":"        },"},{"type":"INSERT","lineNumber":208,"content":"        (family) {"},{"type":"INSERT","lineNumber":209,"content":"          _currentFamily = family;"},{"type":"INSERT","lineNumber":210,"content":"          _errorMessage = null;"},{"type":"INSERT","lineNumber":211,"content":"        },"},{"type":"INSERT","lineNumber":212,"content":"      );"},{"type":"INSERT","lineNumber":213,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":214,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":215,"content":"      _errorMessage = 'Failed to create family: $e';"},{"type":"INSERT","lineNumber":216,"content":"      _currentFamily = null;"},{"type":"INSERT","lineNumber":217,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":218,"content":"    } finally {"},{"type":"INSERT","lineNumber":219,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":220,"content":"    }"},{"type":"INSERT","lineNumber":221,"content":"  }"},{"type":"INSERT","lineNumber":222,"content":""}]},{"timestamp":1754515962103,"changes":[{"type":"MODIFY","lineNumber":11,"content":"  final CreateFamily _createFamily;","oldContent":"  final CreateFamily createFamily;"},{"type":"MODIFY","lineNumber":14,"content":"  final GenerateInviteCode _generateInviteCode;","oldContent":"  final GenerateInviteCode generateInviteCode;"},{"type":"MODIFY","lineNumber":27,"content":"  String? get errorMessage => _errorMessage;","oldContent":"  String? get errorMessage => _errorMessage;"},{"type":"MODIFY","lineNumber":33,"content":"    required this._createFamily,","oldContent":"    required this.createFamily,"},{"type":"MODIFY","lineNumber":36,"content":"    required this._generateInviteCode,","oldContent":"    required this.generateInviteCode,"},{"type":"MODIFY","lineNumber":44,"content":"      final result = await _createFamily(CreateFamilyParams(familyName: familyName));","oldContent":"      final result = await createFamily(CreateFamilyParams(name: familyName));"},{"type":"MODIFY","lineNumber":118,"content":"  Future<void> generateInviteCode(String familyId) async {","oldContent":"  Future<String?> generateNewInviteCode() async {"},{"type":"DELETE","lineNumber":120,"oldContent":"    try {"},{"type":"DELETE","lineNumber":121,"oldContent":"      final result = await generateInviteCode(NoParams());"},{"type":"DELETE","lineNumber":122,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":123,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":124,"oldContent":"          _errorMessage = failure.message;"},{"type":"DELETE","lineNumber":125,"oldContent":"          _generatedInviteCode = null;"},{"type":"DELETE","lineNumber":126,"oldContent":"          notifyListeners();"},{"type":"DELETE","lineNumber":127,"oldContent":"          return null;"},{"type":"DELETE","lineNumber":128,"oldContent":"        },"},{"type":"DELETE","lineNumber":129,"oldContent":"        (inviteCode) {"},{"type":"DELETE","lineNumber":130,"oldContent":"          _generatedInviteCode = inviteCode;"},{"type":"DELETE","lineNumber":131,"oldContent":"          _errorMessage = null;"},{"type":"DELETE","lineNumber":132,"oldContent":"          notifyListeners();"},{"type":"DELETE","lineNumber":133,"oldContent":"          return inviteCode;"},{"type":"DELETE","lineNumber":134,"oldContent":"        },"},{"type":"DELETE","lineNumber":135,"oldContent":"      );"},{"type":"DELETE","lineNumber":136,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":137,"oldContent":"      _errorMessage = 'Failed to generate invite code: $e';"},{"type":"DELETE","lineNumber":138,"oldContent":"      _generatedInviteCode = null;"},{"type":"DELETE","lineNumber":139,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":140,"oldContent":"      return null;"},{"type":"DELETE","lineNumber":141,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":142,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":143,"oldContent":"    }"},{"type":"INSERT","lineNumber":120,"content":"    final result = await _generateInviteCode(familyId);"},{"type":"INSERT","lineNumber":121,"content":"    result.fold("},{"type":"INSERT","lineNumber":122,"content":"      (failure) => _errorMessage = failure.message,"},{"type":"INSERT","lineNumber":123,"content":"      (code) => _generatedInviteCode = code,"},{"type":"INSERT","lineNumber":124,"content":"    );"},{"type":"INSERT","lineNumber":125,"content":"    setLoading(false);"},{"type":"DELETE","lineNumber":177,"oldContent":"  // Clear error message"},{"type":"DELETE","lineNumber":178,"oldContent":"  void clearError() {"},{"type":"DELETE","lineNumber":180,"oldContent":"    _errorMessage = null;"},{"type":"DELETE","lineNumber":182,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":184,"oldContent":"  }"},{"type":"DELETE","lineNumber":186,"oldContent":""},{"type":"DELETE","lineNumber":188,"oldContent":"  @override"},{"type":"DELETE","lineNumber":190,"oldContent":"  void setLoading(bool loading) {"},{"type":"DELETE","lineNumber":192,"oldContent":"    _isLoading = loading;"},{"type":"DELETE","lineNumber":194,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":196,"oldContent":"  }"},{"type":"DELETE","lineNumber":198,"oldContent":""},{"type":"DELETE","lineNumber":200,"oldContent":"  @override"},{"type":"DELETE","lineNumber":202,"oldContent":"  void setError({bool hasError = true, String? message}) {"},{"type":"DELETE","lineNumber":204,"oldContent":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":206,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":208,"oldContent":"  }"},{"type":"DELETE","lineNumber":210,"oldContent":"}"},{"type":"DELETE","lineNumber":212,"oldContent":""},{"type":"DELETE","lineNumber":214,"oldContent":""},{"type":"DELETE","lineNumber":216,"oldContent":"  }"},{"type":"DELETE","lineNumber":218,"oldContent":"    }"},{"type":"DELETE","lineNumber":220,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":222,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":223,"oldContent":"    setState(ViewState.busy);"},{"type":"DELETE","lineNumber":224,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":226,"oldContent":"      _currentFamily = null;"},{"type":"DELETE","lineNumber":228,"oldContent":"      _errorMessage = 'Failed to create family: $e';"},{"type":"DELETE","lineNumber":229,"oldContent":"      final result = await createFamily(CreateFamilyParams(name: familyName));"},{"type":"DELETE","lineNumber":230,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":183,"content":"      final result = await _createFamily(CreateFamilyParams(familyName: familyName));"},{"type":"DELETE","lineNumber":232,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":234,"oldContent":"      );"},{"type":"DELETE","lineNumber":236,"oldContent":"        },"},{"type":"DELETE","lineNumber":238,"oldContent":"          _errorMessage = null;"},{"type":"DELETE","lineNumber":240,"oldContent":"          _currentFamily = family;"},{"type":"INSERT","lineNumber":190,"content":"          _currentFamily = family;"},{"type":"INSERT","lineNumber":191,"content":"          _errorMessage = null;"},{"type":"INSERT","lineNumber":192,"content":"        },"},{"type":"INSERT","lineNumber":193,"content":"      );"},{"type":"INSERT","lineNumber":194,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":195,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":196,"content":"      _errorMessage = 'Failed to create family: $e';"},{"type":"INSERT","lineNumber":197,"content":"      _currentFamily = null;"},{"type":"INSERT","lineNumber":198,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":199,"content":"    } finally {"},{"type":"INSERT","lineNumber":200,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":201,"content":"    }"},{"type":"INSERT","lineNumber":202,"content":"  }"},{"type":"INSERT","lineNumber":203,"content":""},{"type":"INSERT","lineNumber":204,"content":"  // Clear error message"},{"type":"INSERT","lineNumber":205,"content":"  void clearError() {"},{"type":"INSERT","lineNumber":206,"content":"    _errorMessage = null;"},{"type":"INSERT","lineNumber":207,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":208,"content":"  }"},{"type":"INSERT","lineNumber":209,"content":""},{"type":"INSERT","lineNumber":210,"content":"  @override"},{"type":"INSERT","lineNumber":211,"content":"  void setLoading(bool loading) {"},{"type":"INSERT","lineNumber":212,"content":"    _isLoading = loading;"},{"type":"INSERT","lineNumber":213,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":214,"content":"  }"},{"type":"INSERT","lineNumber":215,"content":""},{"type":"INSERT","lineNumber":216,"content":"  @override"},{"type":"INSERT","lineNumber":217,"content":"  void setError({bool hasError = true, String? message}) {"},{"type":"INSERT","lineNumber":218,"content":"    _errorMessage = message;"},{"type":"INSERT","lineNumber":219,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":220,"content":"  }"},{"type":"INSERT","lineNumber":221,"content":"}"},{"type":"INSERT","lineNumber":222,"content":""}]},{"timestamp":1754516276572,"changes":[{"type":"INSERT","lineNumber":26,"content":"  String? get inviteCode => _inviteCode;"},{"type":"DELETE","lineNumber":27,"oldContent":"  String? get errorMessage => _errorMessage;"},{"type":"MODIFY","lineNumber":33,"content":"    required CreateFamily createFamily,","oldContent":"    required this._createFamily,"},{"type":"MODIFY","lineNumber":36,"content":"    required GenerateInviteCode generateInviteCode,","oldContent":"    required this._generateInviteCode,"},{"type":"MODIFY","lineNumber":38,"content":"  })  : _createFamily = createFamily,","oldContent":"  });"},{"type":"INSERT","lineNumber":39,"content":"        _generateInviteCode = generateInviteCode;"},{"type":"MODIFY","lineNumber":94,"content":"  Future<void> fetchCurrentFamily() async {","oldContent":"  Future<void> loadCurrentFamily() async {"},{"type":"DELETE","lineNumber":95,"oldContent":"    try {"},{"type":"DELETE","lineNumber":96,"oldContent":"      final result = await getCurrentFamily(NoParams());"},{"type":"DELETE","lineNumber":97,"oldContent":"      result.fold("},{"type":"DELETE","lineNumber":98,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":99,"oldContent":"          _errorMessage = failure.message;"},{"type":"DELETE","lineNumber":100,"oldContent":"          _currentFamily = null;"},{"type":"DELETE","lineNumber":101,"oldContent":"        },"},{"type":"DELETE","lineNumber":102,"oldContent":"        (family) {"},{"type":"DELETE","lineNumber":103,"oldContent":"          _currentFamily = family;"},{"type":"DELETE","lineNumber":104,"oldContent":"          _errorMessage = null;"},{"type":"DELETE","lineNumber":105,"oldContent":"        },"},{"type":"DELETE","lineNumber":106,"oldContent":"      );"},{"type":"DELETE","lineNumber":107,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":108,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":109,"oldContent":"      _errorMessage = 'Failed to load family: $e';"},{"type":"DELETE","lineNumber":110,"oldContent":"      _currentFamily = null;"},{"type":"DELETE","lineNumber":111,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":112,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":113,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":114,"oldContent":"    }"},{"type":"INSERT","lineNumber":96,"content":"    final result = await getCurrentFamily(NoParams());"},{"type":"INSERT","lineNumber":97,"content":"    result.fold("},{"type":"INSERT","lineNumber":98,"content":"      (failure) {"},{"type":"INSERT","lineNumber":99,"content":"        _errorMessage = failure.message;"},{"type":"INSERT","lineNumber":100,"content":"        _currentFamily = null;"},{"type":"INSERT","lineNumber":101,"content":"      },"},{"type":"INSERT","lineNumber":102,"content":"      (family) {"},{"type":"INSERT","lineNumber":103,"content":"        _currentFamily = family;"},{"type":"INSERT","lineNumber":104,"content":"        _errorMessage = null;"},{"type":"INSERT","lineNumber":105,"content":"      },"},{"type":"INSERT","lineNumber":106,"content":"    );"},{"type":"INSERT","lineNumber":107,"content":"    setLoading(false);"},{"type":"DELETE","lineNumber":120,"oldContent":"    final result = await _generateInviteCode(familyId);"},{"type":"INSERT","lineNumber":113,"content":"    final result = await _generateInviteCode(GenerateInviteCodeParams(familyId: familyId));"},{"type":"DELETE","lineNumber":161,"oldContent":"      final result = await _createFamily(CreateFamilyParams(familyName: familyName));"},{"type":"INSERT","lineNumber":158,"content":"  // Validate invite code"},{"type":"INSERT","lineNumber":159,"content":"  Future<bool> validateCode(String code) async {"},{"type":"INSERT","lineNumber":160,"content":"    // TODO: Implement invite code validation"},{"type":"INSERT","lineNumber":161,"content":"    print('Validating code: $code');"},{"type":"INSERT","lineNumber":162,"content":"    return true;"},{"type":"INSERT","lineNumber":163,"content":"  }"},{"type":"INSERT","lineNumber":164,"content":""},{"type":"INSERT","lineNumber":165,"content":"  // Join existing family"},{"type":"INSERT","lineNumber":166,"content":"  Future<bool> joinExistingFamily(String inviteCode) async {"},{"type":"INSERT","lineNumber":167,"content":"    // TODO: Implement join family logic"},{"type":"INSERT","lineNumber":168,"content":"    print('Joining family with code: $inviteCode');"},{"type":"INSERT","lineNumber":169,"content":"    return true;"},{"type":"INSERT","lineNumber":170,"content":"  }"},{"type":"INSERT","lineNumber":171,"content":""},{"type":"INSERT","lineNumber":172,"content":"  // Create family"},{"type":"INSERT","lineNumber":173,"content":"  Future<void> createFamily(String familyName) async {"},{"type":"INSERT","lineNumber":174,"content":"    setLoading(true);"},{"type":"INSERT","lineNumber":175,"content":"    try {"},{"type":"INSERT","lineNumber":176,"content":"      final result = await _createFamily(CreateFamilyParams(familyName: familyName));"},{"type":"INSERT","lineNumber":177,"content":"      result.fold("},{"type":"INSERT","lineNumber":178,"content":"        (failure) {"},{"type":"INSERT","lineNumber":179,"content":"          _errorMessage = failure.message;"},{"type":"INSERT","lineNumber":180,"content":"          _currentFamily = null;"},{"type":"INSERT","lineNumber":181,"content":"        },"},{"type":"INSERT","lineNumber":182,"content":"        (family) {"},{"type":"DELETE","lineNumber":168,"oldContent":"  // Validate invite code"},{"type":"DELETE","lineNumber":171,"oldContent":"  Future<bool> validateCode(String code) async {"},{"type":"DELETE","lineNumber":174,"oldContent":"    // TODO: Implement invite code validation"},{"type":"DELETE","lineNumber":177,"oldContent":"    print('Validating code: $code');"},{"type":"DELETE","lineNumber":180,"oldContent":"    return true;"},{"type":"DELETE","lineNumber":184,"oldContent":"  }"},{"type":"DELETE","lineNumber":186,"oldContent":""},{"type":"DELETE","lineNumber":189,"oldContent":"  // Join existing family"},{"type":"DELETE","lineNumber":192,"oldContent":"  Future<bool> joinExistingFamily(String inviteCode) async {"},{"type":"DELETE","lineNumber":195,"oldContent":"    // TODO: Implement join family logic"},{"type":"DELETE","lineNumber":198,"oldContent":"    print('Joining family with code: $inviteCode');"},{"type":"DELETE","lineNumber":201,"oldContent":"    return true;"},{"type":"DELETE","lineNumber":204,"oldContent":"  }"},{"type":"DELETE","lineNumber":207,"oldContent":""},{"type":"DELETE","lineNumber":210,"oldContent":"  // Create family"},{"type":"DELETE","lineNumber":213,"oldContent":"  Future<void> createFamily(String familyName) async {"},{"type":"DELETE","lineNumber":215,"oldContent":"    setLoading(true);"},{"type":"DELETE","lineNumber":216,"oldContent":"    try {"},{"type":"DELETE","lineNumber":217,"oldContent":"      result.fold("},{"type":"DELETE","lineNumber":218,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":219,"oldContent":"          _errorMessage = failure.message;"},{"type":"DELETE","lineNumber":220,"oldContent":"          _currentFamily = null;"},{"type":"DELETE","lineNumber":221,"oldContent":"        },"},{"type":"DELETE","lineNumber":222,"oldContent":"        (family) {"}]},{"timestamp":1754516343705,"changes":[{"type":"MODIFY","lineNumber":37,"content":"    required this.validateInviteCode, required Object checkFamilyMembership,","oldContent":"    required this.validateInviteCode,"},{"type":"DELETE","lineNumber":94,"oldContent":"  Future<void> loadCurrentFamily() async {"},{"type":"INSERT","lineNumber":95,"content":"    setLoading(true);"},{"type":"DELETE","lineNumber":108,"oldContent":"    final result = await _generateInviteCode(GenerateInviteCodeParams(familyId: familyId));"},{"type":"INSERT","lineNumber":113,"content":"    final result = await _generateInviteCode(GenerateInviteCodeParams(familyId: familyId));"},{"type":"DELETE","lineNumber":151,"oldContent":"  // Validate invite code"},{"type":"DELETE","lineNumber":153,"oldContent":"  Future<bool> validateCode(String code) async {"},{"type":"DELETE","lineNumber":155,"oldContent":"    // TODO: Implement invite code validation"},{"type":"DELETE","lineNumber":157,"oldContent":"    print('Validating code: $code');"},{"type":"DELETE","lineNumber":158,"oldContent":"    return true;"},{"type":"DELETE","lineNumber":160,"oldContent":"  }"},{"type":"INSERT","lineNumber":156,"content":"  }"},{"type":"INSERT","lineNumber":158,"content":"  // Validate invite code"},{"type":"INSERT","lineNumber":159,"content":"  Future<bool> validateCode(String code) async {"},{"type":"INSERT","lineNumber":160,"content":"    // TODO: Implement invite code validation"},{"type":"INSERT","lineNumber":161,"content":"    print('Validating code: $code');"},{"type":"INSERT","lineNumber":162,"content":"    return true;"},{"type":"MODIFY","lineNumber":165,"content":"  // Join existing family","oldContent":"  // Join existing family"},{"type":"DELETE","lineNumber":167,"oldContent":"          _currentFamily = family;"},{"type":"DELETE","lineNumber":169,"oldContent":"          _errorMessage = null;"},{"type":"DELETE","lineNumber":172,"oldContent":"        },"},{"type":"DELETE","lineNumber":174,"oldContent":"      );"},{"type":"DELETE","lineNumber":177,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":179,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":182,"oldContent":"      _errorMessage = 'Failed to create family: $e';"},{"type":"DELETE","lineNumber":184,"oldContent":"      _currentFamily = null;"},{"type":"DELETE","lineNumber":187,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":189,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":192,"oldContent":"      setLoading(false);"},{"type":"INSERT","lineNumber":183,"content":"          _currentFamily = family;"},{"type":"INSERT","lineNumber":184,"content":"          _errorMessage = null;"},{"type":"INSERT","lineNumber":185,"content":"        },"},{"type":"INSERT","lineNumber":186,"content":"      );"},{"type":"INSERT","lineNumber":187,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":188,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":189,"content":"      _errorMessage = 'Failed to create family: $e';"},{"type":"INSERT","lineNumber":190,"content":"      _currentFamily = null;"},{"type":"INSERT","lineNumber":191,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":192,"content":"    } finally {"},{"type":"INSERT","lineNumber":193,"content":"      setLoading(false);"}]},{"timestamp":1754516352415,"changes":[{"type":"INSERT","lineNumber":10,"content":"import '../../../../core/usecases/usecase.dart';"},{"type":"INSERT","lineNumber":11,"content":""},{"type":"DELETE","lineNumber":94,"oldContent":"    setLoading(true);"},{"type":"INSERT","lineNumber":97,"content":"    setLoading(true);"},{"type":"DELETE","lineNumber":112,"oldContent":"    final result = await _generateInviteCode(GenerateInviteCodeParams(familyId: familyId));"},{"type":"INSERT","lineNumber":115,"content":"    final result = await _generateInviteCode(GenerateInviteCodeParams(familyId: familyId));"},{"type":"DELETE","lineNumber":153,"oldContent":"  }"},{"type":"INSERT","lineNumber":156,"content":"    // TODO: Implement family status check"},{"type":"INSERT","lineNumber":157,"content":"    print('Checking family status...');"},{"type":"INSERT","lineNumber":158,"content":"  }"},{"type":"INSERT","lineNumber":159,"content":""},{"type":"DELETE","lineNumber":157,"oldContent":"    // TODO: Implement family status check"},{"type":"DELETE","lineNumber":160,"oldContent":"    print('Checking family status...');"},{"type":"DELETE","lineNumber":162,"oldContent":""},{"type":"INSERT","lineNumber":166,"content":""},{"type":"DELETE","lineNumber":165,"oldContent":"  // Join existing family"},{"type":"DELETE","lineNumber":176,"oldContent":"          _currentFamily = family;"},{"type":"INSERT","lineNumber":179,"content":"      result.fold("},{"type":"INSERT","lineNumber":180,"content":"        (failure) {"},{"type":"INSERT","lineNumber":181,"content":"          _errorMessage = failure.message;"},{"type":"INSERT","lineNumber":182,"content":"          _currentFamily = null;"},{"type":"INSERT","lineNumber":183,"content":"        },"},{"type":"INSERT","lineNumber":184,"content":"        (family) {"},{"type":"INSERT","lineNumber":185,"content":"          _currentFamily = family;"},{"type":"DELETE","lineNumber":180,"oldContent":"      result.fold("},{"type":"DELETE","lineNumber":182,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":185,"oldContent":"          _errorMessage = failure.message;"},{"type":"DELETE","lineNumber":188,"oldContent":"          _currentFamily = null;"},{"type":"DELETE","lineNumber":190,"oldContent":"        },"},{"type":"DELETE","lineNumber":193,"oldContent":"        (family) {"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/viewmodels/auth_viewmodel.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/viewmodels/auth_viewmodel.dart","baseContent":"import 'package:flutter/foundation.dart';\nimport 'package:family_tree_firebase/core/base/base_viewmodel.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/features/auth/domain/entities/user_entity.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/check_auth_status.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/delete_account.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/register_with_email_and_password.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/send_otp_to_phone_number.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/send_password_reset_email.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/sign_in_with_apple.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/sign_in_with_email_and_password.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/sign_in_with_google.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/sign_out.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/verify_otp.dart';\n\nclass AuthViewModel extends BaseViewModel {\n  final CheckAuthStatus checkAuthStatus;\n  final SignInWithEmailAndPassword signInWithEmailAndPassword;\n  final RegisterWithEmailAndPassword registerWithEmailAndPassword;\n  final SignInWithGoogle signInWithGoogle;\n  final SignInWithApple signInWithApple;\n  final SendOtpToPhoneNumber sendOtpToPhoneNumber;\n  final VerifyOtp verifyOtp;\n  final SignOut signOut;\n  final SendPasswordResetEmail sendPasswordResetEmail;\n  final DeleteAccount deleteAccount;\n\n  UserEntity? _currentUser;\n  bool _isLoading = false;\n  String? _errorMessage;\n  String? _verificationId;\n\n  UserEntity? get currentUser => _currentUser;\n  bool get isAuthenticated => _currentUser != null;\n  @override\n  bool get isLoading => _isLoading;\n  String? get errorMessage => _errorMessage;\n  String? get verificationId => _verificationId;\n\n  AuthViewModel({\n    required this.checkAuthStatus,\n    required this.signInWithEmailAndPassword,\n    required this.registerWithEmailAndPassword,\n    required this.signInWithGoogle,\n    required this.signInWithApple,\n    required this.sendOtpToPhoneNumber,\n    required this.verifyOtp,\n    required this.signOut,\n    required this.sendPasswordResetEmail,\n    required this.deleteAccount,\n  });\n\n  // Check if user is already authenticated\n  Future<void> checkAuthenticationStatus() async {\n    try {\n      setLoading(true);\n      final result = await checkAuthStatus(NoParams());\n      result.fold(\n        (failure) => setError(failure.message),\n        (user) => _currentUser = user,\n      );\n    } catch (e) {\n      setError('Failed to check authentication status');\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Sign in with email and password\n  Future<bool> signInWithEmail(String email, String password) async {\n    try {\n      setLoading(true);\n      final result = await signInWithEmailAndPassword(\n        SignInWithEmailAndPasswordParams(email: email, password: password),\n      );\n      return result.fold(\n        (failure) {\n          setError(failure.message);\n          return false;\n        },\n        (user) {\n          _currentUser = user;\n          return true;\n        },\n      );\n    } catch (e) {\n      setError('Failed to sign in with email and password');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Register with email and password\n  Future<bool> registerWithEmail({\n    required String email,\n    required String password,\n    required String name,\n    String? phone,\n  }) async {\n    try {\n      setLoading(true);\n      final result = await registerWithEmailAndPassword(\n        RegisterWithEmailAndPasswordParams(\n          email: email,\n          password: password,\n          name: name,\n          phone: phone,\n        ),\n      );\n      return result.fold(\n        (failure) {\n          setError(failure.message);\n          return false;\n        },\n        (user) {\n          _currentUser = user;\n          return true;\n        },\n      );\n    } catch (e) {\n      setError('Failed to register with email and password');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Sign in with Google\n  Future<bool> signInWithGoogleAccount() async {\n    try {\n      setLoading(true);\n      final result = await signInWithGoogle(NoParams());\n      return result.fold(\n        (failure) {\n          setError(failure.message);\n          return false;\n        },\n        (user) {\n          _currentUser = user;\n          return true;\n        },\n      );\n    } catch (e) {\n      setError('Failed to sign in with Google');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Sign in with Apple\n  Future<bool> signInWithAppleAccount() async {\n    try {\n      setLoading(true);\n      final result = await signInWithApple(NoParams());\n      return result.fold(\n        (failure) {\n          setError(failure.message);\n          return false;\n        },\n        (user) {\n          _currentUser = user;\n          return true;\n        },\n      );\n    } catch (e) {\n      setError('Failed to sign in with Apple');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Send OTP to phone number\n  Future<bool> sendOtp(String phoneNumber) async {\n    try {\n      setLoading(true);\n      final result = await sendOtpToPhoneNumber(\n        SendOtpToPhoneNumberParams(phoneNumber: phoneNumber),\n      );\n      return result.fold(\n        (failure) {\n          setError(failure.message);\n          return false;\n        },\n        (verificationId) {\n          _verificationId = verificationId;\n          return true;\n        },\n      );\n    } catch (e) {\n      setError('Failed to send OTP');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Verify OTP\n  Future<bool> verifyOtpCode(String smsCode) async {\n    if (_verificationId == null) {\n      setError('No verification in progress');\n      return false;\n    }\n\n    try {\n      setLoading(true);\n      final result = await verifyOtp(\n        VerifyOtpParams(\n          verificationId: _verificationId!,\n          smsCode: smsCode,\n        ),\n      );\n      return result.fold(\n        (failure) {\n          setError(failure.message);\n          return false;\n        },\n        (user) {\n          _currentUser = user;\n          return true;\n        },\n      );\n    } catch (e) {\n      setError('Failed to verify OTP');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Sign out\n  Future<bool> signOutUser() async {\n    try {\n      setLoading(true);\n      final result = await signOut(NoParams());\n      return result.fold(\n        (failure) {\n          setError(failure.message);\n          return false;\n        },\n        (_) {\n          _currentUser = null;\n          return true;\n        },\n      );\n    } catch (e) {\n      setError('Failed to sign out');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Send password reset email\n  Future<bool> sendPasswordResetEmailTo(String email) async {\n    try {\n      setLoading(true);\n      final result = await sendPasswordResetEmail(\n        SendPasswordResetEmailParams(email: email),\n      );\n      return result.fold(\n        (failure) {\n          setError(failure.message);\n          return false;\n        },\n        (_) => true,\n      );\n    } catch (e) {\n      setError('Failed to send password reset email');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Delete account\n  Future<bool> deleteUserAccount() async {\n    try {\n      setLoading(true);\n      final result = await deleteAccount(NoParams());\n      return result.fold(\n        (failure) {\n          setError(failure.message);\n          return false;\n        },\n        (_) {\n          _currentUser = null;\n          return true;\n        },\n      );\n    } catch (e) {\n      setError('Failed to delete account');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  @override\n  void setLoading(bool isLoading) {\n    _isLoading = isLoading;\n    notifyListeners();\n  }\n\n  @override\n  void setError({bool hasError = true, String? message}) {\n    _errorMessage = message;\n    notifyListeners();\n  }\n}\n","baseTimestamp":1754479371760,"deltas":[{"timestamp":1754609981303,"changes":[{"type":"DELETE","lineNumber":134,"oldContent":"          password: password,"},{"type":"DELETE","lineNumber":136,"oldContent":"          phoneNumber: phone?.trim(),"},{"type":"INSERT","lineNumber":135,"content":"          password: password,"},{"type":"INSERT","lineNumber":137,"content":"          phoneNumber: phone?.trim(),"},{"type":"DELETE","lineNumber":142,"oldContent":"          print('Registration failed with error: ${failure.message}');"},{"type":"DELETE","lineNumber":144,"oldContent":"          "},{"type":"INSERT","lineNumber":143,"content":"          print('Registration failed with error: ${failure.message}');"},{"type":"INSERT","lineNumber":145,"content":"          "},{"type":"INSERT","lineNumber":179,"content":"                "},{"type":"INSERT","lineNumber":180,"content":"                // Clear any existing verification ID"},{"type":"INSERT","lineNumber":181,"content":"                _verificationId = null;"},{"type":"INSERT","lineNumber":182,"content":"                "},{"type":"INSERT","lineNumber":183,"content":"                // Send OTP"},{"type":"DELETE","lineNumber":180,"oldContent":"                if (!otpSent) {"},{"type":"INSERT","lineNumber":185,"content":"                "},{"type":"INSERT","lineNumber":186,"content":"                if (!otpSent || _verificationId == null) {"},{"type":"INSERT","lineNumber":188,"content":"                  if (_verificationId == null) {"},{"type":"INSERT","lineNumber":189,"content":"                    print('Verification ID is null after sending OTP');"},{"type":"INSERT","lineNumber":190,"content":"                  }"},{"type":"INSERT","lineNumber":194,"content":"                "},{"type":"INSERT","lineNumber":196,"content":"                print('Verification ID: $_verificationId');"},{"type":"INSERT","lineNumber":202,"content":"              print('Current user is null after registration');"},{"type":"DELETE","lineNumber":194,"oldContent":"          } catch (e) {"},{"type":"INSERT","lineNumber":206,"content":"          } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":208,"content":"            print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":288,"oldContent":"      setError(message: 'No verification in progress');"},{"type":"INSERT","lineNumber":302,"content":"      setError(message: 'No verification in progress');"},{"type":"DELETE","lineNumber":292,"oldContent":"    try {"},{"type":"INSERT","lineNumber":306,"content":"    try {"},{"type":"DELETE","lineNumber":300,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":302,"oldContent":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":315,"content":"        (failure) {"},{"type":"INSERT","lineNumber":316,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":305,"oldContent":"        (user) {"},{"type":"INSERT","lineNumber":319,"content":"        (user) {"},{"type":"DELETE","lineNumber":309,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":311,"oldContent":"      setError(message: 'Failed to verify OTP: $e');"},{"type":"DELETE","lineNumber":314,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":326,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":327,"content":"      setError(message: 'Failed to verify OTP: $e');"},{"type":"DELETE","lineNumber":317,"oldContent":"    }"},{"type":"INSERT","lineNumber":329,"content":"    } finally {"},{"type":"INSERT","lineNumber":331,"content":"    }"},{"type":"DELETE","lineNumber":401,"oldContent":"  void setErrorSilently({String? message}) {"},{"type":"INSERT","lineNumber":416,"content":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":406,"oldContent":"  }"},{"type":"INSERT","lineNumber":420,"content":"  }"}]},{"timestamp":1754610004310,"changes":[{"type":"MODIFY","lineNumber":62,"content":"        (failure) => setError(message: failure.message),","oldContent":"        (failure) => setError(failure.message),"},{"type":"INSERT","lineNumber":64,"content":"          _currentUser = user;"},{"type":"INSERT","lineNumber":65,"content":"          resetError();"},{"type":"INSERT","lineNumber":66,"content":"        },"},{"type":"DELETE","lineNumber":65,"oldContent":"      setError('Failed to check authentication status');"},{"type":"DELETE","lineNumber":66,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":67,"oldContent":"      );"},{"type":"INSERT","lineNumber":72,"content":"    }"},{"type":"INSERT","lineNumber":73,"content":"  }"},{"type":"INSERT","lineNumber":74,"content":""},{"type":"DELETE","lineNumber":81,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":84,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":84,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":85,"oldContent":"          _currentUser = user;"},{"type":"DELETE","lineNumber":86,"oldContent":"          return true;"},{"type":"MODIFY","lineNumber":87,"content":"        (user) {","oldContent":"        },"},{"type":"INSERT","lineNumber":90,"content":"          return true;"},{"type":"INSERT","lineNumber":91,"content":"        },"},{"type":"INSERT","lineNumber":92,"content":"      );"},{"type":"DELETE","lineNumber":91,"oldContent":"      setError('Failed to sign in with email and password');"},{"type":"DELETE","lineNumber":92,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":93,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":96,"content":"    } finally {"},{"type":"INSERT","lineNumber":97,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":98,"content":"    }"},{"type":"DELETE","lineNumber":106,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":107,"oldContent":"      final result = await registerWithEmailAndPassword("},{"type":"DELETE","lineNumber":108,"oldContent":"        RegisterWithEmailAndPasswordParams("},{"type":"DELETE","lineNumber":134,"oldContent":"          password: password,"},{"type":"DELETE","lineNumber":136,"oldContent":"          phoneNumber: phone?.trim(),"},{"type":"INSERT","lineNumber":135,"content":"          password: password,"},{"type":"INSERT","lineNumber":137,"content":"          phoneNumber: phone?.trim(),"},{"type":"DELETE","lineNumber":142,"oldContent":"          print('Registration failed with error: ${failure.message}');"},{"type":"DELETE","lineNumber":144,"oldContent":"          "},{"type":"INSERT","lineNumber":143,"content":"          print('Registration failed with error: ${failure.message}');"},{"type":"INSERT","lineNumber":145,"content":"          "},{"type":"DELETE","lineNumber":180,"oldContent":"                final otpSent = await sendOtp(phone.trim());"},{"type":"DELETE","lineNumber":183,"oldContent":"                  print('Failed to send OTP to $phone');"},{"type":"DELETE","lineNumber":185,"oldContent":"                  setError(message: 'Registration successful but failed to send OTP');"},{"type":"INSERT","lineNumber":184,"content":"                final otpSent = await sendOtp(phone.trim());"},{"type":"INSERT","lineNumber":185,"content":"                "},{"type":"INSERT","lineNumber":186,"content":"                if (!otpSent || _verificationId == null) {"},{"type":"INSERT","lineNumber":187,"content":"                  print('Failed to send OTP to $phone');"},{"type":"INSERT","lineNumber":188,"content":"                  if (_verificationId == null) {"},{"type":"INSERT","lineNumber":189,"content":"                    print('Verification ID is null after sending OTP');"},{"type":"INSERT","lineNumber":190,"content":"                  }"},{"type":"INSERT","lineNumber":191,"content":"                  setError(message: 'Registration successful but failed to send OTP');"},{"type":"DELETE","lineNumber":191,"oldContent":"                if (!otpSent || _verificationId == null) {"},{"type":"INSERT","lineNumber":196,"content":"                print('Verification ID: $_verificationId');"},{"type":"DELETE","lineNumber":194,"oldContent":"                  if (_verificationId == null) {"},{"type":"DELETE","lineNumber":196,"oldContent":"                    print('Verification ID is null after sending OTP');"},{"type":"DELETE","lineNumber":198,"oldContent":"                  }"},{"type":"INSERT","lineNumber":202,"content":"              print('Current user is null after registration');"},{"type":"DELETE","lineNumber":203,"oldContent":"                "},{"type":"INSERT","lineNumber":206,"content":"          } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":205,"oldContent":"                print('Verification ID: $_verificationId');"},{"type":"INSERT","lineNumber":208,"content":"            print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":212,"oldContent":"              print('Current user is null after registration');"},{"type":"DELETE","lineNumber":217,"oldContent":"          } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":220,"oldContent":"            print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":257,"oldContent":"          _currentUser = user;"},{"type":"MODIFY","lineNumber":257,"content":"          return false;","oldContent":"          return true;"},{"type":"INSERT","lineNumber":259,"content":"        (user) {"},{"type":"INSERT","lineNumber":262,"content":"          return true;"},{"type":"INSERT","lineNumber":263,"content":"        },"},{"type":"INSERT","lineNumber":264,"content":"      );"},{"type":"DELETE","lineNumber":263,"oldContent":"      setError('Failed to sign in with Apple');"},{"type":"INSERT","lineNumber":266,"content":"      setError(message: 'Failed to sign in with Apple: $e');"},{"type":"DELETE","lineNumber":266,"oldContent":"      setError(message: 'Failed to sign in with Apple: $e');"},{"type":"INSERT","lineNumber":269,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":276,"content":"      print('Sending OTP to: $phoneNumber');"},{"type":"INSERT","lineNumber":278,"content":"      "},{"type":"INSERT","lineNumber":279,"content":"      // Clear any existing verification ID"},{"type":"INSERT","lineNumber":280,"content":"      _verificationId = null;"},{"type":"INSERT","lineNumber":281,"content":"      "},{"type":"DELETE","lineNumber":277,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":278,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":279,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":285,"content":"      "},{"type":"INSERT","lineNumber":286,"content":"      return await result.fold("},{"type":"INSERT","lineNumber":287,"content":"        (failure) async {"},{"type":"INSERT","lineNumber":288,"content":"          print('Failed to send OTP. Error: ${failure.message}');"},{"type":"INSERT","lineNumber":289,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":282,"oldContent":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":292,"content":"        (verificationId) async {"},{"type":"INSERT","lineNumber":293,"content":"          if (verificationId == null || verificationId.isEmpty) {"},{"type":"INSERT","lineNumber":294,"content":"            print('Received empty verification ID');"},{"type":"INSERT","lineNumber":295,"content":"            setError(message: 'Failed to send OTP: Empty verification ID received');"},{"type":"INSERT","lineNumber":296,"content":"            return false;"},{"type":"INSERT","lineNumber":297,"content":"          }"},{"type":"INSERT","lineNumber":298,"content":"          "},{"type":"INSERT","lineNumber":299,"content":"          print('OTP sent successfully. Verification ID: $verificationId');"},{"type":"INSERT","lineNumber":301,"content":"          resetError();"},{"type":"DELETE","lineNumber":287,"oldContent":"          resetError();"},{"type":"DELETE","lineNumber":288,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":289,"oldContent":"      setError('Failed to send OTP');"},{"type":"INSERT","lineNumber":305,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":306,"content":"      print('Exception in sendOtp:');"},{"type":"INSERT","lineNumber":307,"content":"      print('Error: $e');"},{"type":"INSERT","lineNumber":308,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":309,"content":"      setError(message: 'Failed to send OTP: ${e.toString()}');"},{"type":"DELETE","lineNumber":292,"oldContent":"      setError(message: 'Failed to send OTP: $e');"},{"type":"INSERT","lineNumber":312,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":299,"oldContent":"      setError('No verification in progress');"},{"type":"DELETE","lineNumber":300,"oldContent":"  Future<bool> verifyOtpCode(String smsCode) async {"},{"type":"DELETE","lineNumber":301,"oldContent":"    if (_verificationId == null) {"},{"type":"INSERT","lineNumber":319,"content":"      setError(message: 'No verification in progress');"},{"type":"DELETE","lineNumber":303,"oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":321,"content":"    }"},{"type":"INSERT","lineNumber":323,"content":"    try {"},{"type":"DELETE","lineNumber":312,"oldContent":"      setError(message: 'No verification in progress');"},{"type":"INSERT","lineNumber":332,"content":"        (failure) {"},{"type":"INSERT","lineNumber":333,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":315,"oldContent":"    try {"},{"type":"INSERT","lineNumber":336,"content":"        (user) {"},{"type":"DELETE","lineNumber":322,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":324,"oldContent":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":343,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":344,"content":"      setError(message: 'Failed to verify OTP: $e');"},{"type":"INSERT","lineNumber":346,"content":"    } finally {"},{"type":"DELETE","lineNumber":327,"oldContent":"        (user) {"},{"type":"INSERT","lineNumber":348,"content":"    }"},{"type":"INSERT","lineNumber":349,"content":"  }"},{"type":"INSERT","lineNumber":350,"content":""},{"type":"INSERT","lineNumber":351,"content":"  // Sign out"},{"type":"DELETE","lineNumber":334,"oldContent":"          setError(failure.message);"},{"type":"DELETE","lineNumber":335,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":358,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":337,"oldContent":"      setError(message: 'Failed to verify OTP: $e');"},{"type":"DELETE","lineNumber":339,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":340,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":361,"content":"        (_) {"},{"type":"DELETE","lineNumber":342,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":343,"oldContent":"    }"},{"type":"DELETE","lineNumber":344,"oldContent":"        },"},{"type":"DELETE","lineNumber":345,"oldContent":"      );"},{"type":"INSERT","lineNumber":367,"content":"      );"},{"type":"INSERT","lineNumber":368,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":369,"content":"      setError(message: 'Failed to sign out: $e');"},{"type":"DELETE","lineNumber":352,"oldContent":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":372,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":365,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":385,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":368,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":369,"oldContent":"      );"},{"type":"DELETE","lineNumber":370,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":397,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":398,"content":"    }"},{"type":"INSERT","lineNumber":399,"content":"  }"},{"type":"DELETE","lineNumber":388,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":408,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":391,"oldContent":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":411,"content":"        (_) {"},{"type":"DELETE","lineNumber":393,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":394,"oldContent":"        },"},{"type":"DELETE","lineNumber":395,"oldContent":"      );"},{"type":"INSERT","lineNumber":417,"content":"      );"},{"type":"INSERT","lineNumber":418,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":419,"content":"      setError(message: 'Failed to delete account: $e');"},{"type":"DELETE","lineNumber":402,"oldContent":"      setError(message: 'Failed to delete account: $e');"},{"type":"INSERT","lineNumber":422,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":407,"oldContent":"  void setLoading(bool isLoading) {"},{"type":"DELETE","lineNumber":408,"oldContent":"    _isLoading = isLoading;"},{"type":"DELETE","lineNumber":409,"oldContent":"    notifyListeners();"},{"type":"INSERT","lineNumber":433,"content":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":419,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":421,"oldContent":"  }"},{"type":"DELETE","lineNumber":422,"oldContent":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":423,"oldContent":"  }"},{"type":"DELETE","lineNumber":424,"oldContent":"  void setErrorSilently({String? message}) {"},{"type":"INSERT","lineNumber":438,"content":"}"},{"type":"INSERT","lineNumber":439,"content":""}]},{"timestamp":1754610105673,"changes":[{"type":"MODIFY","lineNumber":16,"content":"import '../../../../core/usecases/usecase.dart';","oldContent":"class AuthViewModel extends BaseViewModel {"},{"type":"INSERT","lineNumber":18,"content":"class AuthViewModel extends BaseViewModel {"},{"type":"INSERT","lineNumber":20,"content":"  final SignInWithEmailAndPassword signInWithEmailAndPassword;"},{"type":"INSERT","lineNumber":32,"content":"  bool _hasError = false;"},{"type":"DELETE","lineNumber":32,"oldContent":"  bool _hasError = false;"},{"type":"DELETE","lineNumber":60,"oldContent":"        (failure) => setError(failure.message),"},{"type":"DELETE","lineNumber":61,"oldContent":"        (user) => _currentUser = user,"},{"type":"DELETE","lineNumber":65,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":68,"oldContent":""},{"type":"INSERT","lineNumber":67,"content":"      );"},{"type":"INSERT","lineNumber":68,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":73,"oldContent":"    try {"},{"type":"MODIFY","lineNumber":75,"content":"  // Sign in with email and password","oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":76,"content":"  Future<bool> signInWithEmail(String email, String password) async {"},{"type":"INSERT","lineNumber":77,"content":"    try {"},{"type":"INSERT","lineNumber":78,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":82,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":84,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":86,"content":"        },"},{"type":"DELETE","lineNumber":85,"oldContent":"          _currentUser = user;"},{"type":"DELETE","lineNumber":86,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":87,"oldContent":"        (user) {"},{"type":"DELETE","lineNumber":91,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":93,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":97,"oldContent":"  // Register with email and password"},{"type":"MODIFY","lineNumber":99,"content":"  }","oldContent":"  Future<bool> registerWithEmail({"},{"type":"INSERT","lineNumber":100,"content":""},{"type":"INSERT","lineNumber":101,"content":"  // Register with email and password"},{"type":"INSERT","lineNumber":102,"content":"  Future<bool> registerWithEmail({"},{"type":"DELETE","lineNumber":107,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":108,"oldContent":"      final result = await registerWithEmailAndPassword("},{"type":"DELETE","lineNumber":134,"oldContent":"          password: password,"},{"type":"DELETE","lineNumber":136,"oldContent":"          phoneNumber: phone?.trim(),"},{"type":"INSERT","lineNumber":135,"content":"          password: password,"},{"type":"INSERT","lineNumber":137,"content":"          phoneNumber: phone?.trim(),"},{"type":"DELETE","lineNumber":142,"oldContent":"          print('Registration failed with error: ${failure.message}');"},{"type":"DELETE","lineNumber":144,"oldContent":"          "},{"type":"INSERT","lineNumber":143,"content":"          print('Registration failed with error: ${failure.message}');"},{"type":"INSERT","lineNumber":145,"content":"          "},{"type":"INSERT","lineNumber":182,"content":"                "},{"type":"INSERT","lineNumber":183,"content":"                // Send OTP"},{"type":"DELETE","lineNumber":184,"oldContent":"                "},{"type":"DELETE","lineNumber":186,"oldContent":"                // Send OTP"},{"type":"DELETE","lineNumber":188,"oldContent":"                  return false;"},{"type":"DELETE","lineNumber":190,"oldContent":"                }"},{"type":"DELETE","lineNumber":192,"oldContent":"                "},{"type":"DELETE","lineNumber":194,"oldContent":"                print('OTP sent successfully to $phone');"},{"type":"INSERT","lineNumber":192,"content":"                  return false;"},{"type":"INSERT","lineNumber":193,"content":"                }"},{"type":"INSERT","lineNumber":194,"content":"                "},{"type":"INSERT","lineNumber":195,"content":"                print('OTP sent successfully to $phone');"},{"type":"INSERT","lineNumber":196,"content":"                print('Verification ID: $_verificationId');"},{"type":"DELETE","lineNumber":199,"oldContent":"                print('Verification ID: $_verificationId');"},{"type":"INSERT","lineNumber":202,"content":"              print('Current user is null after registration');"},{"type":"DELETE","lineNumber":204,"oldContent":"              print('Current user is null after registration');"},{"type":"MODIFY","lineNumber":207,"content":"            print('Error after registration: $e');","oldContent":"            print('Error after registration: $e');"},{"type":"INSERT","lineNumber":208,"content":"            print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":210,"oldContent":"            print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":258,"content":"        },"},{"type":"DELETE","lineNumber":259,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":263,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":265,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":266,"content":"      setError(message: 'Failed to sign in with Apple: $e');"},{"type":"INSERT","lineNumber":267,"content":"      return false;"},{"type":"INSERT","lineNumber":268,"content":"    } finally {"},{"type":"DELETE","lineNumber":268,"oldContent":"      setError(message: 'Failed to sign in with Apple: $e');"},{"type":"INSERT","lineNumber":271,"content":"  }"},{"type":"DELETE","lineNumber":271,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":274,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":275,"oldContent":"      final result = await sendOtpToPhoneNumber("},{"type":"DELETE","lineNumber":276,"oldContent":"        SendOtpToPhoneNumberParams(phoneNumber: phoneNumber),"},{"type":"DELETE","lineNumber":277,"oldContent":"      );"},{"type":"DELETE","lineNumber":278,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":280,"oldContent":"        (failure) {"},{"type":"INSERT","lineNumber":277,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":284,"oldContent":"        (verificationId) {"},{"type":"DELETE","lineNumber":286,"oldContent":"          _verificationId = verificationId;"},{"type":"DELETE","lineNumber":287,"oldContent":"        },"},{"type":"INSERT","lineNumber":282,"content":"      final result = await sendOtpToPhoneNumber("},{"type":"INSERT","lineNumber":283,"content":"        SendOtpToPhoneNumberParams(phoneNumber: phoneNumber),"},{"type":"DELETE","lineNumber":290,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":292,"oldContent":"      setError('Failed to send OTP');"},{"type":"DELETE","lineNumber":296,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":297,"oldContent":"    }"},{"type":"INSERT","lineNumber":290,"content":"          return false;"},{"type":"INSERT","lineNumber":291,"content":"        },"},{"type":"DELETE","lineNumber":300,"oldContent":""},{"type":"DELETE","lineNumber":302,"oldContent":"  // Verify OTP"},{"type":"DELETE","lineNumber":304,"oldContent":"  Future<bool> verifyOtpCode(String smsCode) async {"},{"type":"DELETE","lineNumber":306,"oldContent":"    if (_verificationId == null) {"},{"type":"DELETE","lineNumber":308,"oldContent":"      setError('No verification in progress');"},{"type":"DELETE","lineNumber":310,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":300,"content":"          _verificationId = verificationId;"},{"type":"INSERT","lineNumber":302,"content":"          return true;"},{"type":"INSERT","lineNumber":303,"content":"        },"},{"type":"INSERT","lineNumber":304,"content":"      );"},{"type":"INSERT","lineNumber":305,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":306,"content":"      print('Exception in sendOtp:');"},{"type":"INSERT","lineNumber":307,"content":"      print('Error: $e');"},{"type":"INSERT","lineNumber":308,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":309,"content":"      setError(message: 'Failed to send OTP: ${e.toString()}');"},{"type":"INSERT","lineNumber":311,"content":"    } finally {"},{"type":"INSERT","lineNumber":312,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":313,"content":"    }"},{"type":"INSERT","lineNumber":314,"content":"  }"},{"type":"DELETE","lineNumber":315,"oldContent":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":316,"content":"  // Verify OTP"},{"type":"INSERT","lineNumber":317,"content":"  Future<bool> verifyOtpCode(String smsCode) async {"},{"type":"INSERT","lineNumber":318,"content":"    if (_verificationId == null || _verificationId!.isEmpty) {"},{"type":"INSERT","lineNumber":319,"content":"      setError(message: 'No verification in progress. Please request a new OTP.');"},{"type":"INSERT","lineNumber":320,"content":"      return false;"},{"type":"INSERT","lineNumber":321,"content":"    }"},{"type":"INSERT","lineNumber":322,"content":""},{"type":"INSERT","lineNumber":323,"content":"    // Validate OTP format (6 digits)"},{"type":"INSERT","lineNumber":324,"content":"    final otpRegex = RegExp(r'^\\d{6}$');"},{"type":"INSERT","lineNumber":325,"content":"    if (!otpRegex.hasMatch(smsCode)) {"},{"type":"INSERT","lineNumber":326,"content":"      setError(message: 'Please enter a valid 6-digit OTP');"},{"type":"INSERT","lineNumber":327,"content":"      return false;"},{"type":"INSERT","lineNumber":328,"content":"    }"},{"type":"INSERT","lineNumber":329,"content":""},{"type":"INSERT","lineNumber":330,"content":"    try {"},{"type":"INSERT","lineNumber":331,"content":"      print('Verifying OTP with verification ID: $_verificationId');"},{"type":"DELETE","lineNumber":317,"oldContent":"      print('Exception in sendOtp:');"},{"type":"INSERT","lineNumber":333,"content":"      "},{"type":"DELETE","lineNumber":319,"oldContent":"      print('Error: $e');"},{"type":"DELETE","lineNumber":321,"oldContent":"      print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":323,"oldContent":"      setError(message: 'Failed to send OTP: ${e.toString()}');"},{"type":"DELETE","lineNumber":327,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":328,"oldContent":"      return result.fold("},{"type":"INSERT","lineNumber":340,"content":"      "},{"type":"INSERT","lineNumber":341,"content":"      return await result.fold("},{"type":"INSERT","lineNumber":342,"content":"        (failure) async {"},{"type":"INSERT","lineNumber":343,"content":"          print('OTP verification failed: ${failure.message}');"},{"type":"INSERT","lineNumber":344,"content":"          String errorMessage = 'Failed to verify OTP';"},{"type":"INSERT","lineNumber":345,"content":"          "},{"type":"INSERT","lineNumber":346,"content":"          // Map specific error codes to user-friendly messages"},{"type":"INSERT","lineNumber":347,"content":"          if (failure.message.contains('invalid-verification-code')) {"},{"type":"INSERT","lineNumber":348,"content":"            errorMessage = 'Invalid verification code. Please try again.';"},{"type":"INSERT","lineNumber":349,"content":"          } else if (failure.message.contains('session-expired')) {"},{"type":"INSERT","lineNumber":350,"content":"            errorMessage = 'The verification code has expired. Please request a new one.';"},{"type":"INSERT","lineNumber":351,"content":"          } else if (failure.message.contains('too-many-requests')) {"},{"type":"INSERT","lineNumber":352,"content":"            errorMessage = 'Too many attempts. Please try again later.';"},{"type":"INSERT","lineNumber":353,"content":"          } else {"},{"type":"INSERT","lineNumber":354,"content":"            errorMessage = 'Failed to verify OTP: ${failure.message}';"},{"type":"INSERT","lineNumber":355,"content":"          }"},{"type":"INSERT","lineNumber":356,"content":"          "},{"type":"INSERT","lineNumber":357,"content":"          setError(message: errorMessage);"},{"type":"INSERT","lineNumber":360,"content":"        (user) async {"},{"type":"INSERT","lineNumber":361,"content":"          print('OTP verification successful');"},{"type":"DELETE","lineNumber":332,"oldContent":"          _verificationId = null; // Clear verification ID after successful verification"},{"type":"DELETE","lineNumber":333,"oldContent":"      setError(message: 'No verification in progress');"},{"type":"INSERT","lineNumber":363,"content":"          "},{"type":"INSERT","lineNumber":364,"content":"          // Clear verification ID after successful verification"},{"type":"INSERT","lineNumber":365,"content":"          _verificationId = null;"},{"type":"INSERT","lineNumber":366,"content":"          "},{"type":"INSERT","lineNumber":367,"content":"          // Update the current user data"},{"type":"INSERT","lineNumber":368,"content":"          final currentUser = FirebaseAuth.instance.currentUser;"},{"type":"INSERT","lineNumber":369,"content":"          if (currentUser != null) {"},{"type":"INSERT","lineNumber":370,"content":"            _currentUser = UserEntity("},{"type":"INSERT","lineNumber":371,"content":"              id: currentUser.uid,"},{"type":"INSERT","lineNumber":372,"content":"              email: currentUser.email,"},{"type":"INSERT","lineNumber":373,"content":"              displayName: currentUser.displayName,"},{"type":"INSERT","lineNumber":374,"content":"              phoneNumber: currentUser.phoneNumber,"},{"type":"INSERT","lineNumber":375,"content":"              photoUrl: currentUser.photoURL,"},{"type":"INSERT","lineNumber":376,"content":"              isEmailVerified: currentUser.emailVerified,"},{"type":"INSERT","lineNumber":377,"content":"            );"},{"type":"INSERT","lineNumber":378,"content":"          }"},{"type":"INSERT","lineNumber":379,"content":"          "},{"type":"DELETE","lineNumber":336,"oldContent":"    }"},{"type":"DELETE","lineNumber":338,"oldContent":"    try {"},{"type":"INSERT","lineNumber":384,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":385,"content":"      print('Unexpected error in verifyOtpCode:');"},{"type":"INSERT","lineNumber":386,"content":"      print('Error: $e');"},{"type":"INSERT","lineNumber":387,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":388,"content":"      "},{"type":"INSERT","lineNumber":389,"content":"      setError(message: 'An unexpected error occurred. Please try again.');"},{"type":"INSERT","lineNumber":391,"content":"    } finally {"},{"type":"INSERT","lineNumber":393,"content":"    }"},{"type":"INSERT","lineNumber":394,"content":"  }"},{"type":"INSERT","lineNumber":395,"content":""},{"type":"INSERT","lineNumber":396,"content":"  // Sign out"},{"type":"INSERT","lineNumber":397,"content":"  Future<bool> signOutUser() async {"},{"type":"INSERT","lineNumber":398,"content":"    try {"},{"type":"DELETE","lineNumber":346,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":347,"oldContent":"          setError(failure.message);"},{"type":"DELETE","lineNumber":350,"oldContent":"        (user) {"},{"type":"INSERT","lineNumber":405,"content":"        },"},{"type":"DELETE","lineNumber":353,"oldContent":"        },"},{"type":"DELETE","lineNumber":354,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":355,"oldContent":"      setError(message: 'Failed to verify OTP: $e');"},{"type":"DELETE","lineNumber":356,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":359,"oldContent":"    }"},{"type":"DELETE","lineNumber":361,"oldContent":"  }"},{"type":"DELETE","lineNumber":363,"oldContent":""},{"type":"INSERT","lineNumber":412,"content":"      );"},{"type":"INSERT","lineNumber":413,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":414,"content":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":415,"content":"      return false;"},{"type":"INSERT","lineNumber":416,"content":"    } finally {"},{"type":"DELETE","lineNumber":365,"oldContent":"  // Sign out"},{"type":"INSERT","lineNumber":419,"content":"  }"},{"type":"DELETE","lineNumber":372,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":376,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":379,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":430,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":381,"oldContent":"        (_) => true,"},{"type":"DELETE","lineNumber":382,"oldContent":"      );"},{"type":"DELETE","lineNumber":383,"oldContent":"      );"},{"type":"DELETE","lineNumber":384,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":385,"oldContent":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":432,"content":"        },"},{"type":"DELETE","lineNumber":387,"oldContent":"      setLoading(false);"},{"type":"INSERT","lineNumber":442,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":443,"content":"    }"},{"type":"INSERT","lineNumber":444,"content":"  }"},{"type":"INSERT","lineNumber":445,"content":""},{"type":"INSERT","lineNumber":446,"content":"  // Delete account"},{"type":"DELETE","lineNumber":401,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":403,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":453,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":455,"content":"        },"},{"type":"DELETE","lineNumber":407,"oldContent":"        },"},{"type":"DELETE","lineNumber":409,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":411,"oldContent":"    }"},{"type":"DELETE","lineNumber":413,"oldContent":"  }"},{"type":"INSERT","lineNumber":462,"content":"      );"},{"type":"INSERT","lineNumber":463,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":464,"content":"      setError(message: 'Failed to delete account: $e');"},{"type":"INSERT","lineNumber":465,"content":"      return false;"},{"type":"INSERT","lineNumber":466,"content":"    } finally {"},{"type":"INSERT","lineNumber":469,"content":"  }"},{"type":"DELETE","lineNumber":419,"oldContent":"  void setLoading(bool isLoading) {"},{"type":"DELETE","lineNumber":420,"oldContent":"    _isLoading = isLoading;"},{"type":"DELETE","lineNumber":421,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":423,"oldContent":"        (_) {"},{"type":"INSERT","lineNumber":478,"content":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":430,"oldContent":"      );"},{"type":"DELETE","lineNumber":432,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":434,"oldContent":"      setError(message: 'Failed to delete account: $e');"},{"type":"INSERT","lineNumber":482,"content":"  }"},{"type":"INSERT","lineNumber":483,"content":"}"},{"type":"DELETE","lineNumber":436,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":437,"oldContent":"  void setErrorSilently({String? message}) {"}]},{"timestamp":1754613755437,"changes":[{"type":"MODIFY","lineNumber":21,"content":"  final RegisterWithEmailAndPassword registerWithEmailAndPassword;","oldContent":"  final RegisterWithEmailAndPassword registerWithEmailAndPassword;"},{"type":"INSERT","lineNumber":32,"content":"  bool _hasError = false;"},{"type":"DELETE","lineNumber":34,"oldContent":"  bool _hasError = false;"},{"type":"MODIFY","lineNumber":67,"content":"      );","oldContent":"      );"},{"type":"DELETE","lineNumber":70,"oldContent":""},{"type":"DELETE","lineNumber":71,"oldContent":"  // Sign in with email and password"},{"type":"INSERT","lineNumber":70,"content":"    } finally {"},{"type":"INSERT","lineNumber":71,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":74,"oldContent":"  // Sign in with email and password"},{"type":"MODIFY","lineNumber":75,"content":"  // Sign in with email and passwordr","oldContent":"  Future<bool> signInWithEmail(String email, String password) async {"},{"type":"INSERT","lineNumber":76,"content":"  Future<bool> signInWithEmail(String email, String password) async {"},{"type":"MODIFY","lineNumber":79,"content":"      final result = await signInWithEmailAndPassword(","oldContent":"      final result = await signInWithEmailAndPassword("},{"type":"DELETE","lineNumber":84,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":86,"oldContent":"        (user) {"},{"type":"INSERT","lineNumber":85,"content":"          return false;"},{"type":"INSERT","lineNumber":87,"content":"        (user) {"},{"type":"MODIFY","lineNumber":89,"content":"          resetError();","oldContent":"      return false;"},{"type":"MODIFY","lineNumber":93,"content":"    } catch (e) {","oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":98,"content":"    }"},{"type":"DELETE","lineNumber":100,"oldContent":"    }"},{"type":"MODIFY","lineNumber":103,"content":"    required String email,","oldContent":"    required String password,"},{"type":"INSERT","lineNumber":104,"content":"    required String password,"},{"type":"DELETE","lineNumber":108,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":134,"oldContent":"          password: password,"},{"type":"DELETE","lineNumber":136,"oldContent":"          phoneNumber: phone?.trim(),"},{"type":"INSERT","lineNumber":135,"content":"          password: password,"},{"type":"INSERT","lineNumber":137,"content":"          phoneNumber: phone?.trim(),"},{"type":"DELETE","lineNumber":142,"oldContent":"          print('Registration failed with error: ${failure.message}');"},{"type":"DELETE","lineNumber":144,"oldContent":"          "},{"type":"INSERT","lineNumber":143,"content":"          print('Registration failed with error: ${failure.message}');"},{"type":"INSERT","lineNumber":145,"content":"          "},{"type":"MODIFY","lineNumber":184,"content":"                final otpSent = await sendOtp(phone.trim());","oldContent":"                final otpSent = await sendOtp(phone.trim());"},{"type":"INSERT","lineNumber":190,"content":"                  }"},{"type":"INSERT","lineNumber":191,"content":"                  setError(message: 'Registration successful but failed to send OTP');"},{"type":"DELETE","lineNumber":192,"oldContent":"                  }"},{"type":"DELETE","lineNumber":195,"oldContent":"                  setError(message: 'Registration successful but failed to send OTP');"},{"type":"INSERT","lineNumber":206,"content":"          } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":207,"oldContent":"            print('Error after registration: $e');"},{"type":"MODIFY","lineNumber":265,"content":"    } catch (e) {","oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":267,"oldContent":""},{"type":"DELETE","lineNumber":269,"oldContent":"  Future<bool> sendOtp(String phoneNumber) async {"},{"type":"DELETE","lineNumber":271,"oldContent":"    try {"},{"type":"DELETE","lineNumber":272,"oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":269,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":270,"content":"    }"},{"type":"DELETE","lineNumber":274,"oldContent":"      final result = await sendOtpToPhoneNumber("},{"type":"DELETE","lineNumber":275,"oldContent":"      );"},{"type":"DELETE","lineNumber":276,"oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":272,"content":""},{"type":"INSERT","lineNumber":273,"content":"  // Send OTP to phone number"},{"type":"INSERT","lineNumber":274,"content":"  Future<bool> sendOtp(String phoneNumber) async {"},{"type":"INSERT","lineNumber":275,"content":"    try {"},{"type":"INSERT","lineNumber":277,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":279,"oldContent":"      final result = await sendOtpToPhoneNumber("},{"type":"DELETE","lineNumber":281,"oldContent":"        SendOtpToPhoneNumberParams(phoneNumber: phoneNumber),"},{"type":"DELETE","lineNumber":284,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":282,"content":"      final result = await sendOtpToPhoneNumber("},{"type":"INSERT","lineNumber":283,"content":"        SendOtpToPhoneNumberParams(phoneNumber: phoneNumber),"},{"type":"INSERT","lineNumber":284,"content":"      );"},{"type":"DELETE","lineNumber":286,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":287,"oldContent":"        },"},{"type":"INSERT","lineNumber":290,"content":"          return false;"},{"type":"INSERT","lineNumber":291,"content":"        },"},{"type":"MODIFY","lineNumber":295,"content":"            setError(message: 'Failed to send OTP: Empty verification ID received');","oldContent":"          _verificationId = verificationId;"},{"type":"INSERT","lineNumber":296,"content":"            return false;"},{"type":"INSERT","lineNumber":297,"content":"          }"},{"type":"INSERT","lineNumber":298,"content":"          "},{"type":"INSERT","lineNumber":299,"content":"          print('OTP sent successfully. Verification ID: $verificationId');"},{"type":"INSERT","lineNumber":300,"content":"          _verificationId = verificationId;"},{"type":"INSERT","lineNumber":301,"content":"          resetError();"},{"type":"DELETE","lineNumber":298,"oldContent":"            setError(message: 'Failed to send OTP: Empty verification ID received');"},{"type":"DELETE","lineNumber":301,"oldContent":"            return false;"},{"type":"DELETE","lineNumber":304,"oldContent":"          }"},{"type":"DELETE","lineNumber":307,"oldContent":"          "},{"type":"INSERT","lineNumber":310,"content":"      return false;"},{"type":"DELETE","lineNumber":309,"oldContent":"          print('OTP sent successfully. Verification ID: $verificationId');"},{"type":"DELETE","lineNumber":311,"oldContent":"          resetError();"},{"type":"DELETE","lineNumber":313,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":317,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":320,"oldContent":"      final result = await verifyOtp("},{"type":"DELETE","lineNumber":323,"oldContent":"        VerifyOtpParams("},{"type":"DELETE","lineNumber":326,"oldContent":"          verificationId: _verificationId!,"},{"type":"DELETE","lineNumber":329,"oldContent":"          smsCode: smsCode,"},{"type":"DELETE","lineNumber":331,"oldContent":"        ),"},{"type":"DELETE","lineNumber":333,"oldContent":"      );"},{"type":"DELETE","lineNumber":337,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":339,"oldContent":"        },"},{"type":"DELETE","lineNumber":341,"oldContent":"          _currentUser = user as UserEntity?;"},{"type":"INSERT","lineNumber":332,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":343,"oldContent":"          resetError();"},{"type":"DELETE","lineNumber":344,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":345,"oldContent":"        },"},{"type":"INSERT","lineNumber":334,"content":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":335,"content":"        VerifyOtpParams("},{"type":"INSERT","lineNumber":336,"content":"          verificationId: _verificationId!,"},{"type":"INSERT","lineNumber":337,"content":"          smsCode: smsCode,"},{"type":"INSERT","lineNumber":338,"content":"        ),"},{"type":"DELETE","lineNumber":348,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":350,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":352,"oldContent":"        },"},{"type":"DELETE","lineNumber":354,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":356,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":358,"oldContent":"        },"},{"type":"DELETE","lineNumber":362,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":364,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":367,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":369,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":375,"oldContent":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"DELETE","lineNumber":376,"oldContent":"          resetError();"},{"type":"INSERT","lineNumber":358,"content":"          return false;"},{"type":"INSERT","lineNumber":359,"content":"        },"},{"type":"DELETE","lineNumber":378,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":380,"oldContent":"        },"},{"type":"INSERT","lineNumber":362,"content":"          _currentUser = user as UserEntity?;"},{"type":"DELETE","lineNumber":383,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":386,"oldContent":"      final result = await sendPasswordResetEmail("},{"type":"DELETE","lineNumber":388,"oldContent":"        SendPasswordResetEmailParams(email: email),"},{"type":"DELETE","lineNumber":390,"oldContent":"      );"},{"type":"DELETE","lineNumber":392,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":394,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":396,"oldContent":"        },"},{"type":"DELETE","lineNumber":399,"oldContent":"        (_) => true,"},{"type":"DELETE","lineNumber":401,"oldContent":"      );"},{"type":"DELETE","lineNumber":403,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":406,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":408,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":410,"oldContent":"    }"},{"type":"INSERT","lineNumber":380,"content":"          resetError();"},{"type":"INSERT","lineNumber":381,"content":"          return true;"},{"type":"INSERT","lineNumber":382,"content":"        },"},{"type":"INSERT","lineNumber":383,"content":"      );"},{"type":"DELETE","lineNumber":414,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":417,"oldContent":"          resetError();"},{"type":"INSERT","lineNumber":390,"content":"      return false;"},{"type":"INSERT","lineNumber":391,"content":"    } finally {"},{"type":"INSERT","lineNumber":392,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":393,"content":"    }"},{"type":"INSERT","lineNumber":394,"content":"  }"},{"type":"INSERT","lineNumber":395,"content":""},{"type":"INSERT","lineNumber":396,"content":"  // Sign out"},{"type":"INSERT","lineNumber":397,"content":"  Future<bool> signOutUser() async {"},{"type":"INSERT","lineNumber":398,"content":"    try {"},{"type":"INSERT","lineNumber":399,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":400,"content":"      final result = await signOut(NoParams());"},{"type":"INSERT","lineNumber":401,"content":"      return result.fold("},{"type":"INSERT","lineNumber":402,"content":"        (failure) {"},{"type":"INSERT","lineNumber":403,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":404,"content":"          return false;"},{"type":"INSERT","lineNumber":405,"content":"        },"},{"type":"INSERT","lineNumber":406,"content":"        (_) {"},{"type":"INSERT","lineNumber":407,"content":"          _currentUser = null;"},{"type":"INSERT","lineNumber":408,"content":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"INSERT","lineNumber":409,"content":"          resetError();"},{"type":"DELETE","lineNumber":421,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":414,"content":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":415,"content":"      return false;"},{"type":"INSERT","lineNumber":416,"content":"    } finally {"},{"type":"INSERT","lineNumber":417,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":425,"oldContent":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"DELETE","lineNumber":427,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":429,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":430,"oldContent":"  // Sign out"},{"type":"INSERT","lineNumber":421,"content":"  // Send password reset email"},{"type":"INSERT","lineNumber":422,"content":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"INSERT","lineNumber":423,"content":"    try {"},{"type":"INSERT","lineNumber":424,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":425,"content":"      final result = await sendPasswordResetEmail("},{"type":"INSERT","lineNumber":426,"content":"        SendPasswordResetEmailParams(email: email),"},{"type":"INSERT","lineNumber":427,"content":"      );"},{"type":"INSERT","lineNumber":428,"content":"      return result.fold("},{"type":"INSERT","lineNumber":429,"content":"        (failure) {"},{"type":"INSERT","lineNumber":430,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":432,"oldContent":"  Future<bool> signOutUser() async {"},{"type":"MODIFY","lineNumber":434,"content":"          resetError();","oldContent":"    try {"},{"type":"INSERT","lineNumber":436,"content":"        },"},{"type":"MODIFY","lineNumber":438,"content":"    } catch (e) {","oldContent":"      setError('Failed to delete account');"},{"type":"INSERT","lineNumber":439,"content":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"INSERT","lineNumber":440,"content":"      return false;"},{"type":"INSERT","lineNumber":441,"content":"    } finally {"},{"type":"DELETE","lineNumber":440,"oldContent":"        },"},{"type":"INSERT","lineNumber":443,"content":"    }"},{"type":"INSERT","lineNumber":444,"content":"  }"},{"type":"DELETE","lineNumber":442,"oldContent":"  @override"},{"type":"INSERT","lineNumber":446,"content":"  // Delete account"},{"type":"INSERT","lineNumber":447,"content":"  Future<bool> deleteUserAccount() async {"},{"type":"INSERT","lineNumber":448,"content":"    try {"},{"type":"INSERT","lineNumber":449,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":450,"content":"      final result = await deleteAccount(NoParams());"},{"type":"INSERT","lineNumber":451,"content":"      return result.fold("},{"type":"INSERT","lineNumber":452,"content":"        (failure) {"},{"type":"INSERT","lineNumber":453,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":454,"content":"          return false;"},{"type":"INSERT","lineNumber":455,"content":"        },"},{"type":"INSERT","lineNumber":456,"content":"        (_) {"},{"type":"INSERT","lineNumber":457,"content":"          _currentUser = null;"},{"type":"DELETE","lineNumber":445,"oldContent":"      );"},{"type":"DELETE","lineNumber":447,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":448,"oldContent":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":462,"content":"      );"},{"type":"INSERT","lineNumber":463,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":464,"content":"      setError(message: 'Failed to delete account: $e');"},{"type":"DELETE","lineNumber":451,"oldContent":"  void setError({bool hasError = true, String? message}) {"},{"type":"DELETE","lineNumber":453,"oldContent":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":454,"oldContent":"    notifyListeners();"},{"type":"INSERT","lineNumber":467,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":468,"content":"    }"},{"type":"DELETE","lineNumber":456,"oldContent":"  }"},{"type":"INSERT","lineNumber":470,"content":""},{"type":"INSERT","lineNumber":471,"content":"  @override"},{"type":"INSERT","lineNumber":478,"content":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":464,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":466,"oldContent":"        },"},{"type":"INSERT","lineNumber":481,"content":"    // Don't call notifyListeners() here"},{"type":"DELETE","lineNumber":468,"oldContent":"  }"},{"type":"DELETE","lineNumber":470,"oldContent":"  }"},{"type":"DELETE","lineNumber":471,"oldContent":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":472,"oldContent":"  }"},{"type":"DELETE","lineNumber":473,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":474,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":475,"oldContent":"    }"},{"type":"DELETE","lineNumber":476,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":477,"oldContent":"  }"},{"type":"DELETE","lineNumber":478,"oldContent":"      setError(message: 'Failed to delete account: $e');"},{"type":"DELETE","lineNumber":480,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":481,"oldContent":"  // Delete account"},{"type":"DELETE","lineNumber":482,"oldContent":"      );"},{"type":"DELETE","lineNumber":483,"oldContent":"        },"},{"type":"DELETE","lineNumber":484,"oldContent":"          setError(message: failure.message);"}]},{"timestamp":1754613770758,"changes":[{"type":"MODIFY","lineNumber":17,"content":"","oldContent":"  final CheckAuthStatus checkAuthStatus;"},{"type":"INSERT","lineNumber":19,"content":"  final CheckAuthStatus checkAuthStatus;"},{"type":"DELETE","lineNumber":21,"oldContent":"  final RegisterWithEmailAndPassword registerWithEmailAndPassword;"},{"type":"INSERT","lineNumber":35,"content":"  bool _isOtpVerified = false;"},{"type":"INSERT","lineNumber":41,"content":"  bool get isOtpVerified => _isOtpVerified;"},{"type":"DELETE","lineNumber":63,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":65,"content":"        (user) {"},{"type":"INSERT","lineNumber":68,"content":"        },"},{"type":"DELETE","lineNumber":67,"oldContent":"      );"},{"type":"DELETE","lineNumber":69,"oldContent":""},{"type":"INSERT","lineNumber":71,"content":"      setError(message: 'Failed to check authentication status: $e');"},{"type":"INSERT","lineNumber":76,"content":""},{"type":"DELETE","lineNumber":76,"oldContent":""},{"type":"INSERT","lineNumber":80,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":79,"oldContent":"      final result = await signInWithEmailAndPassword("},{"type":"DELETE","lineNumber":84,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":86,"oldContent":"        (user) {"},{"type":"INSERT","lineNumber":87,"content":"          return false;"},{"type":"DELETE","lineNumber":88,"oldContent":"      setError('Failed to sign in with email and password');"},{"type":"INSERT","lineNumber":89,"content":"        (user) {"},{"type":"INSERT","lineNumber":90,"content":"          _currentUser = user as UserEntity?;"},{"type":"INSERT","lineNumber":94,"content":"      );"},{"type":"DELETE","lineNumber":93,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":95,"oldContent":""},{"type":"INSERT","lineNumber":97,"content":"      return false;"},{"type":"DELETE","lineNumber":102,"oldContent":"    required String password,"},{"type":"INSERT","lineNumber":104,"content":"  Future<bool> registerWithEmail({"},{"type":"DELETE","lineNumber":134,"oldContent":"          password: password,"},{"type":"DELETE","lineNumber":136,"oldContent":"          phoneNumber: phone?.trim(),"},{"type":"INSERT","lineNumber":137,"content":"          password: password,"},{"type":"INSERT","lineNumber":139,"content":"          phoneNumber: phone?.trim(),"},{"type":"DELETE","lineNumber":142,"oldContent":"          print('Registration failed with error: ${failure.message}');"},{"type":"DELETE","lineNumber":144,"oldContent":"          "},{"type":"INSERT","lineNumber":145,"content":"          print('Registration failed with error: ${failure.message}');"},{"type":"INSERT","lineNumber":147,"content":"          "},{"type":"INSERT","lineNumber":185,"content":"                // Send OTP"},{"type":"DELETE","lineNumber":184,"oldContent":"                final otpSent = await sendOtp(phone.trim());"},{"type":"DELETE","lineNumber":191,"oldContent":"                  return false;"},{"type":"INSERT","lineNumber":194,"content":"                  return false;"},{"type":"DELETE","lineNumber":260,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":261,"oldContent":"    }"},{"type":"INSERT","lineNumber":262,"content":"          _currentUser = user as UserEntity?;"},{"type":"INSERT","lineNumber":263,"content":"          resetError();"},{"type":"INSERT","lineNumber":266,"content":"      );"},{"type":"DELETE","lineNumber":265,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":270,"content":"    } finally {"},{"type":"DELETE","lineNumber":270,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":273,"content":"  }"},{"type":"DELETE","lineNumber":273,"oldContent":"  }"},{"type":"DELETE","lineNumber":276,"oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":279,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":280,"oldContent":"      final result = await sendOtpToPhoneNumber("},{"type":"DELETE","lineNumber":282,"oldContent":"        SendOtpToPhoneNumberParams(phoneNumber: phoneNumber),"},{"type":"INSERT","lineNumber":284,"content":"      final result = await sendOtpToPhoneNumber("},{"type":"INSERT","lineNumber":285,"content":"        SendOtpToPhoneNumberParams(phoneNumber: phoneNumber),"},{"type":"DELETE","lineNumber":288,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":290,"oldContent":"        },"},{"type":"INSERT","lineNumber":292,"content":"          return false;"},{"type":"INSERT","lineNumber":293,"content":"        },"},{"type":"DELETE","lineNumber":294,"oldContent":"          _verificationId = verificationId;"},{"type":"INSERT","lineNumber":296,"content":"            print('Received empty verification ID');"},{"type":"DELETE","lineNumber":297,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":299,"oldContent":"        },"},{"type":"DELETE","lineNumber":302,"oldContent":"      );"},{"type":"MODIFY","lineNumber":304,"content":"          return true;","oldContent":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":305,"content":"        },"},{"type":"INSERT","lineNumber":306,"content":"      );"},{"type":"INSERT","lineNumber":307,"content":"    } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":310,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":313,"content":"    } finally {"},{"type":"DELETE","lineNumber":326,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":328,"oldContent":"      final result = await verifyOtp("},{"type":"DELETE","lineNumber":330,"oldContent":"        VerifyOtpParams("},{"type":"DELETE","lineNumber":332,"oldContent":"          verificationId: _verificationId!,"},{"type":"DELETE","lineNumber":334,"oldContent":"          smsCode: smsCode,"},{"type":"DELETE","lineNumber":335,"oldContent":"        ),"},{"type":"INSERT","lineNumber":334,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":336,"content":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":337,"content":"        VerifyOtpParams("},{"type":"INSERT","lineNumber":338,"content":"          verificationId: _verificationId!,"},{"type":"INSERT","lineNumber":339,"content":"          smsCode: smsCode,"},{"type":"INSERT","lineNumber":340,"content":"        ),"},{"type":"DELETE","lineNumber":346,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":347,"oldContent":"        },"},{"type":"DELETE","lineNumber":351,"oldContent":"          _currentUser = user as UserEntity?;"},{"type":"INSERT","lineNumber":360,"content":"          return false;"},{"type":"INSERT","lineNumber":361,"content":"        },"},{"type":"DELETE","lineNumber":363,"oldContent":"          resetError();"},{"type":"MODIFY","lineNumber":364,"content":"          _currentUser = user as UserEntity?;","oldContent":"          return true;"},{"type":"DELETE","lineNumber":366,"oldContent":"        },"},{"type":"DELETE","lineNumber":368,"oldContent":"      );"},{"type":"INSERT","lineNumber":371,"content":"          if (currentUser != null) {"},{"type":"INSERT","lineNumber":372,"content":"            _currentUser = UserEntity("},{"type":"INSERT","lineNumber":373,"content":"              id: currentUser.uid,"},{"type":"INSERT","lineNumber":374,"content":"              email: currentUser.email,"},{"type":"INSERT","lineNumber":375,"content":"              displayName: currentUser.displayName,"},{"type":"INSERT","lineNumber":376,"content":"              phoneNumber: currentUser.phoneNumber,"},{"type":"INSERT","lineNumber":377,"content":"              photoUrl: currentUser.photoURL,"},{"type":"INSERT","lineNumber":378,"content":"              isEmailVerified: currentUser.emailVerified,"},{"type":"INSERT","lineNumber":379,"content":"            );"},{"type":"INSERT","lineNumber":380,"content":"          }"},{"type":"INSERT","lineNumber":381,"content":"          "},{"type":"INSERT","lineNumber":382,"content":"          resetError();"},{"type":"INSERT","lineNumber":383,"content":"          return true;"},{"type":"INSERT","lineNumber":384,"content":"        },"},{"type":"INSERT","lineNumber":385,"content":"      );"},{"type":"INSERT","lineNumber":386,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":387,"content":"      print('Unexpected error in verifyOtpCode:');"},{"type":"INSERT","lineNumber":388,"content":"      print('Error: $e');"},{"type":"INSERT","lineNumber":389,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":390,"content":"      "},{"type":"INSERT","lineNumber":391,"content":"      setError(message: 'An unexpected error occurred. Please try again.');"},{"type":"DELETE","lineNumber":375,"oldContent":"          if (currentUser != null) {"},{"type":"DELETE","lineNumber":378,"oldContent":"            _currentUser = UserEntity("},{"type":"INSERT","lineNumber":397,"content":"  "},{"type":"INSERT","lineNumber":398,"content":"  Future<bool> verifyOtp({required String verificationId, required String smsCode}) async {"},{"type":"INSERT","lineNumber":399,"content":"    try {"},{"type":"INSERT","lineNumber":400,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":401,"content":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":402,"content":"        VerifyOtpParams("},{"type":"INSERT","lineNumber":403,"content":"          verificationId: verificationId,"},{"type":"INSERT","lineNumber":404,"content":"          smsCode: smsCode,"},{"type":"INSERT","lineNumber":405,"content":"        ),"},{"type":"INSERT","lineNumber":406,"content":"      );"},{"type":"INSERT","lineNumber":407,"content":"      "},{"type":"INSERT","lineNumber":408,"content":"      return result.fold("},{"type":"INSERT","lineNumber":409,"content":"        (failure) {"},{"type":"INSERT","lineNumber":410,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":411,"content":"          return false;"},{"type":"INSERT","lineNumber":412,"content":"        },"},{"type":"INSERT","lineNumber":413,"content":"        (user) {"},{"type":"INSERT","lineNumber":414,"content":"          _currentUser = user;"},{"type":"INSERT","lineNumber":415,"content":"          _isOtpVerified = true;"},{"type":"INSERT","lineNumber":416,"content":"          clearError();"},{"type":"INSERT","lineNumber":417,"content":"          return true;"},{"type":"INSERT","lineNumber":418,"content":"        },"},{"type":"INSERT","lineNumber":419,"content":"      );"},{"type":"INSERT","lineNumber":420,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":421,"content":"      setError(message: 'Failed to verify OTP: $e');"},{"type":"INSERT","lineNumber":422,"content":"      return false;"},{"type":"INSERT","lineNumber":423,"content":"    } finally {"},{"type":"INSERT","lineNumber":424,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":425,"content":"    }"},{"type":"INSERT","lineNumber":426,"content":"  }"},{"type":"INSERT","lineNumber":427,"content":"  "},{"type":"INSERT","lineNumber":428,"content":"  Future<bool> updateUserPhoneNumber(String phoneNumber) async {"},{"type":"INSERT","lineNumber":429,"content":"    try {"},{"type":"INSERT","lineNumber":430,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":431,"content":"      final user = FirebaseAuth.instance.currentUser;"},{"type":"INSERT","lineNumber":432,"content":"      if (user != null) {"},{"type":"INSERT","lineNumber":433,"content":"        // Update phone number in Firebase Auth"},{"type":"INSERT","lineNumber":434,"content":"        await user.updatePhoneNumber(phoneNumber);"},{"type":"INSERT","lineNumber":435,"content":"        "},{"type":"INSERT","lineNumber":436,"content":"        // Update user entity"},{"type":"INSERT","lineNumber":437,"content":"        _currentUser = _currentUser?.copyWith(phoneNumber: phoneNumber);"},{"type":"INSERT","lineNumber":438,"content":"        notifyListeners();"},{"type":"INSERT","lineNumber":439,"content":"        return true;"},{"type":"INSERT","lineNumber":440,"content":"      }"},{"type":"INSERT","lineNumber":441,"content":"      return false;"},{"type":"INSERT","lineNumber":442,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":443,"content":"      setError(message: 'Failed to update phone number: $e');"},{"type":"INSERT","lineNumber":444,"content":"      return false;"},{"type":"INSERT","lineNumber":445,"content":"    } finally {"},{"type":"INSERT","lineNumber":446,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":447,"content":"    }"},{"type":"INSERT","lineNumber":448,"content":"  }"},{"type":"DELETE","lineNumber":381,"oldContent":"              id: currentUser.uid,"},{"type":"DELETE","lineNumber":384,"oldContent":"              email: currentUser.email,"},{"type":"DELETE","lineNumber":386,"oldContent":"              displayName: currentUser.displayName,"},{"type":"DELETE","lineNumber":389,"oldContent":"              phoneNumber: currentUser.phoneNumber,"},{"type":"DELETE","lineNumber":392,"oldContent":"              photoUrl: currentUser.photoURL,"},{"type":"DELETE","lineNumber":395,"oldContent":"              isEmailVerified: currentUser.emailVerified,"},{"type":"DELETE","lineNumber":397,"oldContent":"            );"},{"type":"DELETE","lineNumber":400,"oldContent":"          }"},{"type":"DELETE","lineNumber":403,"oldContent":"          "},{"type":"DELETE","lineNumber":404,"oldContent":"    } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":405,"oldContent":"      print('Unexpected error in verifyOtpCode:');"},{"type":"DELETE","lineNumber":406,"oldContent":"      print('Error: $e');"},{"type":"INSERT","lineNumber":464,"content":"          return true;"},{"type":"INSERT","lineNumber":465,"content":"        },"},{"type":"INSERT","lineNumber":466,"content":"      );"},{"type":"INSERT","lineNumber":467,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":409,"oldContent":"      print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":411,"oldContent":"      "},{"type":"DELETE","lineNumber":413,"oldContent":"      setError(message: 'An unexpected error occurred. Please try again.');"},{"type":"DELETE","lineNumber":414,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":415,"oldContent":"        },"},{"type":"INSERT","lineNumber":472,"content":"    }"},{"type":"INSERT","lineNumber":473,"content":"  }"},{"type":"INSERT","lineNumber":474,"content":""},{"type":"DELETE","lineNumber":418,"oldContent":"      );"},{"type":"DELETE","lineNumber":420,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":422,"oldContent":"    }"},{"type":"DELETE","lineNumber":425,"oldContent":"  }"},{"type":"DELETE","lineNumber":428,"oldContent":""},{"type":"DELETE","lineNumber":431,"oldContent":"          return true;"},{"type":"INSERT","lineNumber":485,"content":"          return false;"},{"type":"INSERT","lineNumber":487,"content":"        (_) {"},{"type":"DELETE","lineNumber":434,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":489,"content":"          return true;"},{"type":"DELETE","lineNumber":436,"oldContent":"      setError('Failed to delete account');"},{"type":"DELETE","lineNumber":437,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":491,"content":"      );"},{"type":"DELETE","lineNumber":440,"oldContent":"    }"},{"type":"DELETE","lineNumber":443,"oldContent":""},{"type":"INSERT","lineNumber":496,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":445,"oldContent":"  void setError({bool hasError = true, String? message}) {"},{"type":"DELETE","lineNumber":447,"oldContent":"          resetError();"},{"type":"INSERT","lineNumber":499,"content":""},{"type":"DELETE","lineNumber":449,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":453,"oldContent":"        },"},{"type":"DELETE","lineNumber":455,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":458,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":462,"oldContent":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":465,"oldContent":"  void setError({bool hasError = true, String? message}) {"},{"type":"DELETE","lineNumber":466,"oldContent":"    _hasError = hasError;"},{"type":"DELETE","lineNumber":467,"oldContent":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":468,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":469,"oldContent":"  }"},{"type":"INSERT","lineNumber":512,"content":"          _verificationId = null; // Clear any verification ID on account deletion"},{"type":"INSERT","lineNumber":513,"content":"          resetError();"},{"type":"INSERT","lineNumber":514,"content":"          return true;"},{"type":"INSERT","lineNumber":515,"content":"        },"},{"type":"DELETE","lineNumber":471,"oldContent":"    // Don't call notifyListeners() here"},{"type":"DELETE","lineNumber":473,"oldContent":"    _hasError = true;"},{"type":"DELETE","lineNumber":475,"oldContent":"  }"},{"type":"INSERT","lineNumber":519,"content":"      return false;"},{"type":"INSERT","lineNumber":520,"content":"    } finally {"},{"type":"DELETE","lineNumber":477,"oldContent":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":479,"oldContent":"}"},{"type":"INSERT","lineNumber":523,"content":"  }"},{"type":"INSERT","lineNumber":526,"content":"  void setError({String message = 'An error occurred'}) {"},{"type":"INSERT","lineNumber":527,"content":"    _hasError = true;"},{"type":"INSERT","lineNumber":528,"content":"    _errorMessage = message;"},{"type":"INSERT","lineNumber":529,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":530,"content":"  }"},{"type":"INSERT","lineNumber":531,"content":"  "},{"type":"INSERT","lineNumber":532,"content":"  void clearError() {"},{"type":"INSERT","lineNumber":533,"content":"    _hasError = false;"},{"type":"INSERT","lineNumber":534,"content":"    _errorMessage = null;"},{"type":"INSERT","lineNumber":535,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":536,"content":"  }"},{"type":"INSERT","lineNumber":537,"content":"  "},{"type":"INSERT","lineNumber":538,"content":"  void resetVerificationState() {"},{"type":"INSERT","lineNumber":539,"content":"    _isOtpVerified = false;"},{"type":"INSERT","lineNumber":540,"content":"    _verificationId = null;"},{"type":"INSERT","lineNumber":541,"content":"    clearError();"},{"type":"INSERT","lineNumber":542,"content":"  }"},{"type":"INSERT","lineNumber":543,"content":"  "},{"type":"INSERT","lineNumber":545,"content":"    _hasError = true;"},{"type":"INSERT","lineNumber":546,"content":"    _errorMessage = message;"},{"type":"INSERT","lineNumber":547,"content":"  }"},{"type":"INSERT","lineNumber":548,"content":"}"},{"type":"DELETE","lineNumber":484,"oldContent":"    // Don't call notifyListeners() here"}]},{"timestamp":1754613785706,"changes":[{"type":"MODIFY","lineNumber":42,"content":"  String? get errorMessage => _errorMessage;","oldContent":"  String? get errorMessage => _errorMessage;"},{"type":"MODIFY","lineNumber":66,"content":"          _currentUser = user;","oldContent":"          _currentUser = user;"},{"type":"MODIFY","lineNumber":69,"content":"      );","oldContent":"      );"},{"type":"MODIFY","lineNumber":72,"content":"    } finally {","oldContent":"    } finally {"},{"type":"INSERT","lineNumber":76,"content":""},{"type":"DELETE","lineNumber":78,"oldContent":""},{"type":"MODIFY","lineNumber":81,"content":"      final result = await signInWithEmailAndPassword(","oldContent":"      final result = await signInWithEmailAndPassword("},{"type":"MODIFY","lineNumber":91,"content":"          resetError();","oldContent":"          resetError();"},{"type":"MODIFY","lineNumber":95,"content":"    } catch (e) {","oldContent":"    } catch (e) {"},{"type":"MODIFY","lineNumber":98,"content":"    } finally {","oldContent":"    } finally {"},{"type":"MODIFY","lineNumber":105,"content":"    required String email,","oldContent":"    required String email,"},{"type":"MODIFY","lineNumber":140,"content":"        ),","oldContent":"        ),"},{"type":"MODIFY","lineNumber":148,"content":"          // Map Firebase Auth error codes to user-friendly messages","oldContent":"          // Map Firebase Auth error codes to user-friendly messages"},{"type":"MODIFY","lineNumber":186,"content":"                final otpSent = await sendOtp(phone.trim());","oldContent":"                final otpSent = await sendOtp(phone.trim());"},{"type":"MODIFY","lineNumber":195,"content":"                }","oldContent":"                }"},{"type":"MODIFY","lineNumber":264,"content":"          return true;","oldContent":"          return true;"},{"type":"MODIFY","lineNumber":267,"content":"    } catch (e) {","oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":270,"content":"    } finally {"},{"type":"DELETE","lineNumber":272,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":273,"content":"  }"},{"type":"DELETE","lineNumber":275,"oldContent":"  }"},{"type":"MODIFY","lineNumber":280,"content":"      ","oldContent":"      "},{"type":"MODIFY","lineNumber":286,"content":"      );","oldContent":"      );"},{"type":"MODIFY","lineNumber":294,"content":"        (verificationId) async {","oldContent":"        (verificationId) async {"},{"type":"MODIFY","lineNumber":297,"content":"            setError(message: 'Failed to send OTP: Empty verification ID received');","oldContent":"            setError(message: 'Failed to send OTP: Empty verification ID received');"},{"type":"INSERT","lineNumber":303,"content":"          resetError();"},{"type":"DELETE","lineNumber":305,"oldContent":"          resetError();"},{"type":"MODIFY","lineNumber":308,"content":"      print('Exception in sendOtp:');","oldContent":"      print('Exception in sendOtp:');"},{"type":"MODIFY","lineNumber":314,"content":"      setLoading(false);","oldContent":"      setLoading(false);"},{"type":"INSERT","lineNumber":332,"content":"    try {"},{"type":"INSERT","lineNumber":333,"content":"      print('Verifying OTP with verification ID: $_verificationId');"},{"type":"INSERT","lineNumber":335,"content":"      "},{"type":"DELETE","lineNumber":334,"oldContent":"    try {"},{"type":"DELETE","lineNumber":336,"oldContent":"      print('Verifying OTP with verification ID: $_verificationId');"},{"type":"DELETE","lineNumber":338,"oldContent":"      "},{"type":"MODIFY","lineNumber":341,"content":"      );","oldContent":"      );"},{"type":"MODIFY","lineNumber":360,"content":"          return false;","oldContent":"          return false;"},{"type":"DELETE","lineNumber":369,"oldContent":"          if (currentUser != null) {"},{"type":"MODIFY","lineNumber":371,"content":"          if (currentUser != null) {","oldContent":"            _currentUser = UserEntity("},{"type":"INSERT","lineNumber":372,"content":"            _currentUser = UserEntity("},{"type":"DELETE","lineNumber":374,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":376,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":379,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":381,"oldContent":"    }"},{"type":"DELETE","lineNumber":384,"oldContent":"  }"},{"type":"DELETE","lineNumber":386,"oldContent":""},{"type":"DELETE","lineNumber":389,"oldContent":"  // Sign out"},{"type":"DELETE","lineNumber":391,"oldContent":"  Future<bool> signOutUser() async {"},{"type":"DELETE","lineNumber":394,"oldContent":"    try {"},{"type":"DELETE","lineNumber":397,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":399,"oldContent":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":402,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":403,"oldContent":"      setError(message: 'An unexpected error occurred. Please try again.');"},{"type":"DELETE","lineNumber":404,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":405,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":406,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":407,"oldContent":"        },"},{"type":"DELETE","lineNumber":408,"oldContent":"  "},{"type":"DELETE","lineNumber":409,"oldContent":"  Future<bool> verifyOtp({required String verificationId, required String smsCode}) async {"},{"type":"DELETE","lineNumber":410,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":412,"oldContent":"          _currentUser = null;"},{"type":"DELETE","lineNumber":415,"oldContent":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"DELETE","lineNumber":417,"oldContent":"          resetError();"},{"type":"DELETE","lineNumber":423,"oldContent":"      setError(message: 'Failed to sign out: $e');"},{"type":"DELETE","lineNumber":425,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":428,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":431,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":432,"oldContent":"        (user) {"},{"type":"DELETE","lineNumber":433,"oldContent":"          _currentUser = user;"},{"type":"INSERT","lineNumber":405,"content":"        (_) {"},{"type":"DELETE","lineNumber":436,"oldContent":"  // Send password reset email"},{"type":"DELETE","lineNumber":438,"oldContent":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"DELETE","lineNumber":441,"oldContent":"    try {"},{"type":"INSERT","lineNumber":412,"content":"      setError(message: 'An unexpected error occurred. Please try again.');"},{"type":"DELETE","lineNumber":444,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":447,"oldContent":"      final result = await sendPasswordResetEmail("},{"type":"DELETE","lineNumber":449,"oldContent":"        SendPasswordResetEmailParams(email: email),"},{"type":"DELETE","lineNumber":452,"oldContent":"      );"},{"type":"DELETE","lineNumber":454,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":457,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":459,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":462,"oldContent":"      );"},{"type":"DELETE","lineNumber":464,"oldContent":"          resetError();"},{"type":"DELETE","lineNumber":467,"oldContent":"        },"},{"type":"DELETE","lineNumber":471,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":473,"oldContent":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"DELETE","lineNumber":476,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":478,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":481,"oldContent":"    }"},{"type":"DELETE","lineNumber":484,"oldContent":"  }"},{"type":"DELETE","lineNumber":487,"oldContent":"  // Delete account"},{"type":"DELETE","lineNumber":488,"oldContent":"  Future<bool> deleteUserAccount() async {"},{"type":"INSERT","lineNumber":441,"content":""},{"type":"INSERT","lineNumber":442,"content":"  // Sign out"},{"type":"INSERT","lineNumber":443,"content":"  Future<bool> signOutUser() async {"},{"type":"DELETE","lineNumber":491,"oldContent":"      final result = await deleteAccount(NoParams());"},{"type":"INSERT","lineNumber":446,"content":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":498,"oldContent":"          return true;"},{"type":"INSERT","lineNumber":454,"content":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"INSERT","lineNumber":455,"content":"          resetError();"},{"type":"INSERT","lineNumber":456,"content":"          return true;"},{"type":"DELETE","lineNumber":503,"oldContent":"      );"},{"type":"INSERT","lineNumber":460,"content":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":461,"content":"      return false;"},{"type":"INSERT","lineNumber":462,"content":"    } finally {"},{"type":"INSERT","lineNumber":463,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":505,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":508,"oldContent":"      setError(message: 'Failed to delete account: $e');"},{"type":"INSERT","lineNumber":467,"content":"  // Send password reset email"},{"type":"INSERT","lineNumber":468,"content":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"INSERT","lineNumber":469,"content":"    try {"},{"type":"INSERT","lineNumber":470,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":471,"content":"      final result = await sendPasswordResetEmail("},{"type":"INSERT","lineNumber":472,"content":"        SendPasswordResetEmailParams(email: email),"},{"type":"INSERT","lineNumber":473,"content":"      );"},{"type":"INSERT","lineNumber":474,"content":"      return result.fold("},{"type":"INSERT","lineNumber":475,"content":"        (failure) {"},{"type":"INSERT","lineNumber":476,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":477,"content":"          return false;"},{"type":"INSERT","lineNumber":478,"content":"        },"},{"type":"INSERT","lineNumber":479,"content":"        (_) {"},{"type":"INSERT","lineNumber":480,"content":"          resetError();"},{"type":"INSERT","lineNumber":481,"content":"          return true;"},{"type":"INSERT","lineNumber":482,"content":"        },"},{"type":"INSERT","lineNumber":483,"content":"      );"},{"type":"INSERT","lineNumber":484,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":485,"content":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"INSERT","lineNumber":486,"content":"      return false;"},{"type":"INSERT","lineNumber":487,"content":"    } finally {"},{"type":"INSERT","lineNumber":490,"content":"  }"},{"type":"DELETE","lineNumber":512,"oldContent":"  @override"},{"type":"DELETE","lineNumber":513,"oldContent":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":514,"oldContent":""},{"type":"INSERT","lineNumber":492,"content":"  // Delete account"},{"type":"INSERT","lineNumber":493,"content":"  Future<bool> deleteUserAccount() async {"},{"type":"INSERT","lineNumber":494,"content":"    try {"},{"type":"INSERT","lineNumber":495,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":496,"content":"      final result = await deleteAccount(NoParams());"},{"type":"INSERT","lineNumber":497,"content":"      return result.fold("},{"type":"INSERT","lineNumber":498,"content":"        (failure) {"},{"type":"INSERT","lineNumber":499,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":516,"oldContent":"}"},{"type":"DELETE","lineNumber":517,"oldContent":"  }"},{"type":"INSERT","lineNumber":501,"content":"        },"},{"type":"DELETE","lineNumber":519,"oldContent":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":520,"oldContent":"    _hasError = true;"},{"type":"INSERT","lineNumber":503,"content":"          _currentUser = null;"},{"type":"INSERT","lineNumber":504,"content":"          _verificationId = null; // Clear any verification ID on account deletion"},{"type":"INSERT","lineNumber":505,"content":"          resetError();"},{"type":"DELETE","lineNumber":522,"oldContent":"  "},{"type":"DELETE","lineNumber":523,"oldContent":"  }"},{"type":"INSERT","lineNumber":507,"content":"        },"},{"type":"DELETE","lineNumber":525,"oldContent":"    clearError();"},{"type":"DELETE","lineNumber":526,"oldContent":"    _verificationId = null;"},{"type":"DELETE","lineNumber":527,"oldContent":"    _isOtpVerified = false;"},{"type":"DELETE","lineNumber":528,"oldContent":"  void resetVerificationState() {"},{"type":"DELETE","lineNumber":529,"oldContent":"  "},{"type":"INSERT","lineNumber":509,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":510,"content":"      setError(message: 'Failed to delete account: $e');"},{"type":"INSERT","lineNumber":511,"content":"      return false;"},{"type":"INSERT","lineNumber":512,"content":"    } finally {"},{"type":"INSERT","lineNumber":514,"content":"    }"},{"type":"DELETE","lineNumber":532,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":533,"oldContent":"    _errorMessage = null;"},{"type":"DELETE","lineNumber":535,"oldContent":"    _hasError = false;"},{"type":"INSERT","lineNumber":517,"content":"  @override"},{"type":"INSERT","lineNumber":518,"content":"  void setError({bool hasError = true, String? message}) {"},{"type":"INSERT","lineNumber":519,"content":"    _hasError = hasError;"},{"type":"INSERT","lineNumber":520,"content":"    _errorMessage = message;"},{"type":"INSERT","lineNumber":521,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":522,"content":"  }"},{"type":"INSERT","lineNumber":523,"content":"  "},{"type":"INSERT","lineNumber":525,"content":"    _hasError = false;"},{"type":"INSERT","lineNumber":526,"content":"    _errorMessage = null;"},{"type":"INSERT","lineNumber":527,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":528,"content":"  }"},{"type":"INSERT","lineNumber":530,"content":"  void resetVerificationState() {"},{"type":"INSERT","lineNumber":531,"content":"    _isOtpVerified = false;"},{"type":"INSERT","lineNumber":532,"content":"    _verificationId = null;"},{"type":"INSERT","lineNumber":533,"content":"    clearError();"},{"type":"DELETE","lineNumber":539,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":540,"oldContent":"    _errorMessage = message;"},{"type":"INSERT","lineNumber":535,"content":"  "},{"type":"INSERT","lineNumber":536,"content":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":542,"oldContent":"  void setError({String message = 'An error occurred'}) {"},{"type":"INSERT","lineNumber":538,"content":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":544,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":545,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":546,"oldContent":"        },"},{"type":"DELETE","lineNumber":547,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":548,"oldContent":"          _verificationId = null; // Clear any verification ID on account deletion"},{"type":"DELETE","lineNumber":549,"oldContent":"          resetError();"},{"type":"INSERT","lineNumber":540,"content":"}"},{"type":"INSERT","lineNumber":541,"content":""}]},{"timestamp":1754613954890,"changes":[{"type":"INSERT","lineNumber":36,"content":""},{"type":"INSERT","lineNumber":41,"content":"  bool get isOtpVerified => _isOtpVerified;"},{"type":"DELETE","lineNumber":42,"oldContent":"  String? get errorMessage => _errorMessage;"},{"type":"DELETE","lineNumber":63,"oldContent":"        (failure) => setError(failure.message),"},{"type":"INSERT","lineNumber":65,"content":"        (user) {"},{"type":"DELETE","lineNumber":66,"oldContent":"          _currentUser = user;"},{"type":"INSERT","lineNumber":68,"content":"        },"},{"type":"DELETE","lineNumber":69,"oldContent":"      );"},{"type":"INSERT","lineNumber":71,"content":"      setError(message: 'Failed to check authentication status: $e');"},{"type":"DELETE","lineNumber":72,"oldContent":"    } finally {"},{"type":"MODIFY","lineNumber":80,"content":"      setLoading(true);","oldContent":"        SignInWithEmailAndPasswordParams(email: email, password: password),"},{"type":"INSERT","lineNumber":82,"content":"        SignInWithEmailAndPasswordParams(email: email, password: password),"},{"type":"DELETE","lineNumber":85,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":90,"content":"          _currentUser = user as UserEntity?;"},{"type":"DELETE","lineNumber":91,"oldContent":"          resetError();"},{"type":"INSERT","lineNumber":94,"content":"      );"},{"type":"DELETE","lineNumber":95,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":97,"content":"      return false;"},{"type":"DELETE","lineNumber":98,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":104,"content":"  Future<bool> registerWithEmail({"},{"type":"DELETE","lineNumber":105,"oldContent":"    required String email,"},{"type":"INSERT","lineNumber":107,"content":"    required String name,"},{"type":"DELETE","lineNumber":110,"oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":139,"content":"          phoneNumber: phone?.trim(),"},{"type":"DELETE","lineNumber":140,"oldContent":"        ),"},{"type":"INSERT","lineNumber":147,"content":"          "},{"type":"DELETE","lineNumber":148,"oldContent":"          // Map Firebase Auth error codes to user-friendly messages"},{"type":"INSERT","lineNumber":185,"content":"                // Send OTP"},{"type":"DELETE","lineNumber":186,"oldContent":"                final otpSent = await sendOtp(phone.trim());"},{"type":"INSERT","lineNumber":194,"content":"                  return false;"},{"type":"DELETE","lineNumber":195,"oldContent":"                }"},{"type":"INSERT","lineNumber":263,"content":"          resetError();"},{"type":"DELETE","lineNumber":264,"oldContent":"          return true;"},{"type":"INSERT","lineNumber":266,"content":"      );"},{"type":"DELETE","lineNumber":267,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":279,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":280,"oldContent":"      "},{"type":"INSERT","lineNumber":285,"content":"        SendOtpToPhoneNumberParams(phoneNumber: phoneNumber),"},{"type":"DELETE","lineNumber":286,"oldContent":"      );"},{"type":"INSERT","lineNumber":293,"content":"        },"},{"type":"DELETE","lineNumber":294,"oldContent":"        (verificationId) async {"},{"type":"INSERT","lineNumber":296,"content":"            print('Received empty verification ID');"},{"type":"DELETE","lineNumber":297,"oldContent":"            setError(message: 'Failed to send OTP: Empty verification ID received');"},{"type":"INSERT","lineNumber":307,"content":"    } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":308,"oldContent":"      print('Exception in sendOtp:');"},{"type":"INSERT","lineNumber":313,"content":"    } finally {"},{"type":"DELETE","lineNumber":314,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":333,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":335,"oldContent":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":334,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":336,"content":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":340,"content":"        ),"},{"type":"DELETE","lineNumber":341,"oldContent":"      );"},{"type":"INSERT","lineNumber":359,"content":"          setError(message: errorMessage);"},{"type":"DELETE","lineNumber":360,"oldContent":"          return false;"},{"type":"INSERT","lineNumber":370,"content":"          final currentUser = FirebaseAuth.instance.currentUser;"},{"type":"DELETE","lineNumber":372,"oldContent":"          final currentUser = FirebaseAuth.instance.currentUser;"},{"type":"DELETE","lineNumber":386,"oldContent":"    } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":387,"oldContent":"      print('Unexpected error in verifyOtpCode:');"},{"type":"DELETE","lineNumber":388,"oldContent":"      print('Error: $e');"},{"type":"DELETE","lineNumber":389,"oldContent":"      print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":390,"oldContent":"      "},{"type":"DELETE","lineNumber":391,"oldContent":"        (_) {"},{"type":"INSERT","lineNumber":386,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":387,"content":"      setError(message: 'Failed to verify OTP: $e');"},{"type":"INSERT","lineNumber":388,"content":"      return false;"},{"type":"INSERT","lineNumber":389,"content":"    } finally {"},{"type":"INSERT","lineNumber":390,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":391,"content":"    }"},{"type":"INSERT","lineNumber":392,"content":"  }"},{"type":"INSERT","lineNumber":393,"content":"  "},{"type":"INSERT","lineNumber":394,"content":"  Future<bool> updateUserPhoneNumber(String phoneNumber) async {"},{"type":"DELETE","lineNumber":393,"oldContent":"      setError(message: 'An unexpected error occurred. Please try again.');"},{"type":"DELETE","lineNumber":395,"oldContent":"      final result = await verifyOtp("},{"type":"DELETE","lineNumber":396,"oldContent":"        VerifyOtpParams("},{"type":"DELETE","lineNumber":397,"oldContent":"          verificationId: verificationId,"},{"type":"DELETE","lineNumber":398,"oldContent":"          smsCode: smsCode,"},{"type":"DELETE","lineNumber":399,"oldContent":"        ),"},{"type":"DELETE","lineNumber":400,"oldContent":"      );"},{"type":"DELETE","lineNumber":401,"oldContent":"      "},{"type":"INSERT","lineNumber":397,"content":"      final user = FirebaseAuth.instance.currentUser;"},{"type":"INSERT","lineNumber":398,"content":"      if (user != null) {"},{"type":"INSERT","lineNumber":399,"content":"        // In a real app, you would need to verify the phone number first"},{"type":"INSERT","lineNumber":400,"content":"        // and then update it using the verification process"},{"type":"INSERT","lineNumber":401,"content":"        // For now, we'll just update the user entity"},{"type":"INSERT","lineNumber":402,"content":"        _currentUser = _currentUser?.copyWith(phoneNumber: phoneNumber);"},{"type":"INSERT","lineNumber":403,"content":"        notifyListeners();"},{"type":"INSERT","lineNumber":404,"content":"        return true;"},{"type":"INSERT","lineNumber":405,"content":"      }"},{"type":"INSERT","lineNumber":406,"content":"      return false;"},{"type":"INSERT","lineNumber":407,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":408,"content":"      setError(message: 'Failed to update phone number: $e');"},{"type":"INSERT","lineNumber":409,"content":"      return false;"},{"type":"INSERT","lineNumber":410,"content":"    } finally {"},{"type":"INSERT","lineNumber":411,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":412,"content":"    }"},{"type":"INSERT","lineNumber":413,"content":"  }"},{"type":"INSERT","lineNumber":414,"content":""},{"type":"INSERT","lineNumber":415,"content":"  // Sign out"},{"type":"INSERT","lineNumber":416,"content":"  Future<bool> signOutUser() async {"},{"type":"INSERT","lineNumber":417,"content":"    try {"},{"type":"INSERT","lineNumber":418,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":419,"content":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":407,"oldContent":"          _isOtpVerified = true;"},{"type":"DELETE","lineNumber":408,"oldContent":"          clearError();"},{"type":"INSERT","lineNumber":425,"content":"        (_) {"},{"type":"INSERT","lineNumber":426,"content":"          _currentUser = null;"},{"type":"INSERT","lineNumber":427,"content":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"INSERT","lineNumber":428,"content":"          resetError();"},{"type":"DELETE","lineNumber":412,"oldContent":""},{"type":"DELETE","lineNumber":413,"oldContent":"  // Sign out"},{"type":"DELETE","lineNumber":415,"oldContent":"  Future<bool> signOutUser() async {"},{"type":"DELETE","lineNumber":416,"oldContent":"      setError(message: 'Failed to verify OTP: $e');"},{"type":"INSERT","lineNumber":433,"content":"      setError(message: 'Failed to sign out: $e');"},{"type":"DELETE","lineNumber":418,"oldContent":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":423,"oldContent":"  "},{"type":"DELETE","lineNumber":424,"oldContent":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"DELETE","lineNumber":425,"oldContent":"          resetError();"},{"type":"DELETE","lineNumber":426,"oldContent":"  Future<bool> updateUserPhoneNumber(String phoneNumber) async {"},{"type":"DELETE","lineNumber":427,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":428,"oldContent":"    try {"},{"type":"DELETE","lineNumber":429,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":430,"oldContent":"      setError(message: 'Failed to sign out: $e');"},{"type":"DELETE","lineNumber":431,"oldContent":"      final user = FirebaseAuth.instance.currentUser;"},{"type":"DELETE","lineNumber":432,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":433,"oldContent":"      if (user != null) {"},{"type":"DELETE","lineNumber":434,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":435,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":436,"oldContent":"        // Update phone number in Firebase Auth"},{"type":"DELETE","lineNumber":437,"oldContent":"        await user.updatePhoneNumber(phoneNumber);"},{"type":"MODIFY","lineNumber":439,"content":"","oldContent":"        "},{"type":"DELETE","lineNumber":441,"oldContent":"        // Update user entity"},{"type":"DELETE","lineNumber":443,"oldContent":"        _currentUser = _currentUser?.copyWith(phoneNumber: phoneNumber);"},{"type":"DELETE","lineNumber":445,"oldContent":"        notifyListeners();"},{"type":"DELETE","lineNumber":448,"oldContent":"        return true;"},{"type":"DELETE","lineNumber":451,"oldContent":"      }"},{"type":"DELETE","lineNumber":453,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":456,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":459,"oldContent":"      setError(message: 'Failed to update phone number: $e');"},{"type":"DELETE","lineNumber":461,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":464,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":466,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":469,"oldContent":"    }"},{"type":"DELETE","lineNumber":471,"oldContent":"  }"},{"type":"DELETE","lineNumber":473,"oldContent":"    try {"},{"type":"INSERT","lineNumber":461,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":462,"content":"    }"},{"type":"DELETE","lineNumber":475,"oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":464,"content":""},{"type":"DELETE","lineNumber":477,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":479,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":481,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":483,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":485,"oldContent":"        },"},{"type":"DELETE","lineNumber":487,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":490,"oldContent":"          _currentUser = null;"},{"type":"INSERT","lineNumber":473,"content":"          return false;"},{"type":"DELETE","lineNumber":492,"oldContent":"        },"},{"type":"DELETE","lineNumber":493,"oldContent":"      );"},{"type":"DELETE","lineNumber":494,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":475,"content":"        (_) {"},{"type":"DELETE","lineNumber":497,"oldContent":"    }"},{"type":"DELETE","lineNumber":499,"oldContent":"  }"},{"type":"INSERT","lineNumber":479,"content":"          return true;"},{"type":"DELETE","lineNumber":501,"oldContent":""},{"type":"INSERT","lineNumber":481,"content":"      );"},{"type":"DELETE","lineNumber":503,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":505,"oldContent":"    }"},{"type":"DELETE","lineNumber":507,"oldContent":""},{"type":"INSERT","lineNumber":486,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":510,"oldContent":"          return false;"},{"type":"INSERT","lineNumber":488,"content":"  }"},{"type":"INSERT","lineNumber":489,"content":""},{"type":"DELETE","lineNumber":513,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":517,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":520,"oldContent":"      );"},{"type":"INSERT","lineNumber":497,"content":"  void clearError() {"},{"type":"INSERT","lineNumber":502,"content":"  "},{"type":"DELETE","lineNumber":526,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":528,"oldContent":"  }"},{"type":"DELETE","lineNumber":531,"oldContent":""},{"type":"INSERT","lineNumber":507,"content":"  }"},{"type":"DELETE","lineNumber":534,"oldContent":"  void clearError() {"},{"type":"DELETE","lineNumber":535,"oldContent":"  "},{"type":"INSERT","lineNumber":510,"content":"    _hasError = true;"},{"type":"DELETE","lineNumber":540,"oldContent":"    _hasError = true;"},{"type":"DELETE","lineNumber":541,"oldContent":"  }"}]},{"timestamp":1754614397661,"changes":[{"type":"MODIFY","lineNumber":42,"content":"  String? get errorMessage => _errorMessage;","oldContent":"  String? get errorMessage => _errorMessage;"},{"type":"DELETE","lineNumber":333,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":335,"oldContent":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":334,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":336,"content":"      final result = await verifyOtp("},{"type":"DELETE","lineNumber":393,"oldContent":"    try {"},{"type":"INSERT","lineNumber":395,"content":"    try {"},{"type":"DELETE","lineNumber":398,"oldContent":"      if (user != null) {"},{"type":"DELETE","lineNumber":399,"oldContent":"        // In a real app, you would need to verify the phone number first"},{"type":"DELETE","lineNumber":400,"oldContent":"        // and then update it using the verification process"},{"type":"DELETE","lineNumber":401,"oldContent":"        // For now, we'll just update the user entity"},{"type":"DELETE","lineNumber":402,"oldContent":"        _currentUser = _currentUser?.copyWith(phoneNumber: phoneNumber);"},{"type":"DELETE","lineNumber":403,"oldContent":"      return result.fold("},{"type":"INSERT","lineNumber":398,"content":"      "},{"type":"INSERT","lineNumber":399,"content":"      if (user == null) {"},{"type":"INSERT","lineNumber":400,"content":"        setError(message: 'No authenticated user found');"},{"type":"INSERT","lineNumber":401,"content":"        return false;"},{"type":"INSERT","lineNumber":402,"content":"      }"},{"type":"INSERT","lineNumber":403,"content":"      "},{"type":"INSERT","lineNumber":404,"content":"      // Update the user's phone number in Firebase Auth"},{"type":"INSERT","lineNumber":405,"content":"      try {"},{"type":"INSERT","lineNumber":406,"content":"        // First, verify the phone number is in the correct format"},{"type":"INSERT","lineNumber":407,"content":"        final formattedPhone = phoneNumber.startsWith('+') "},{"type":"INSERT","lineNumber":408,"content":"            ? phoneNumber "},{"type":"INSERT","lineNumber":409,"content":"            : '+$phoneNumber';"},{"type":"INSERT","lineNumber":410,"content":"            "},{"type":"INSERT","lineNumber":411,"content":"        // Update the user's phone number in Firestore or your database"},{"type":"INSERT","lineNumber":412,"content":"        // This is where you would typically update the user's profile"},{"type":"INSERT","lineNumber":413,"content":"        // with the verified phone number"},{"type":"INSERT","lineNumber":414,"content":"        await user.updatePhoneNumber(null); // This would be the phone auth credential"},{"type":"INSERT","lineNumber":415,"content":"        "},{"type":"INSERT","lineNumber":416,"content":"        // Update the local user entity"},{"type":"INSERT","lineNumber":417,"content":"        _currentUser = _currentUser?.copyWith(phoneNumber: formattedPhone);"},{"type":"DELETE","lineNumber":405,"oldContent":"        (failure) {"},{"type":"INSERT","lineNumber":419,"content":"        "},{"type":"INSERT","lineNumber":420,"content":"        print('Successfully updated phone number to: $formattedPhone');"},{"type":"DELETE","lineNumber":407,"oldContent":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":422,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":423,"content":"        print('Error updating phone number: $e');"},{"type":"INSERT","lineNumber":424,"content":"        print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":425,"content":"        setError(message: 'Failed to update phone number: ${e.toString()}');"},{"type":"INSERT","lineNumber":426,"content":"        return false;"},{"type":"DELETE","lineNumber":409,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":410,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":411,"oldContent":"        },"},{"type":"DELETE","lineNumber":413,"oldContent":"      setError(message: 'Failed to update phone number: $e');"},{"type":"INSERT","lineNumber":429,"content":"      print('Unexpected error in updateUserPhoneNumber: $e');"},{"type":"INSERT","lineNumber":430,"content":"      setError(message: 'An unexpected error occurred');"},{"type":"DELETE","lineNumber":415,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":417,"oldContent":"        },"},{"type":"DELETE","lineNumber":419,"oldContent":"      );"},{"type":"DELETE","lineNumber":423,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":427,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":430,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":431,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":432,"oldContent":"    }"},{"type":"DELETE","lineNumber":433,"oldContent":"  }"},{"type":"INSERT","lineNumber":442,"content":"      return result.fold("},{"type":"INSERT","lineNumber":443,"content":"        (failure) {"},{"type":"INSERT","lineNumber":444,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":445,"content":"          return false;"},{"type":"INSERT","lineNumber":446,"content":"        },"},{"type":"INSERT","lineNumber":451,"content":"          return true;"},{"type":"INSERT","lineNumber":452,"content":"        },"},{"type":"INSERT","lineNumber":453,"content":"      );"},{"type":"INSERT","lineNumber":454,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":439,"oldContent":"        "},{"type":"INSERT","lineNumber":456,"content":"      return false;"},{"type":"INSERT","lineNumber":457,"content":"    } finally {"},{"type":"INSERT","lineNumber":458,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":459,"content":"    }"},{"type":"INSERT","lineNumber":460,"content":"  }"},{"type":"INSERT","lineNumber":462,"content":"  // Send password reset email"},{"type":"DELETE","lineNumber":454,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":455,"oldContent":"    }"},{"type":"DELETE","lineNumber":458,"oldContent":""},{"type":"DELETE","lineNumber":464,"oldContent":"          return false;"},{"type":"INSERT","lineNumber":483,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":484,"content":"    }"},{"type":"DELETE","lineNumber":466,"oldContent":"        (_) {"},{"type":"INSERT","lineNumber":486,"content":""},{"type":"DELETE","lineNumber":469,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":471,"oldContent":"      );"},{"type":"DELETE","lineNumber":474,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":476,"oldContent":"  }"},{"type":"DELETE","lineNumber":478,"oldContent":""},{"type":"INSERT","lineNumber":495,"content":"          return false;"},{"type":"INSERT","lineNumber":497,"content":"        (_) {"},{"type":"DELETE","lineNumber":483,"oldContent":"  void clearError() {"},{"type":"INSERT","lineNumber":501,"content":"          return true;"},{"type":"DELETE","lineNumber":486,"oldContent":"  "},{"type":"INSERT","lineNumber":503,"content":"      );"},{"type":"DELETE","lineNumber":490,"oldContent":"  }"},{"type":"INSERT","lineNumber":508,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":493,"oldContent":"    _hasError = true;"},{"type":"INSERT","lineNumber":510,"content":"  }"},{"type":"INSERT","lineNumber":511,"content":""},{"type":"INSERT","lineNumber":519,"content":"  void clearError() {"},{"type":"INSERT","lineNumber":524,"content":"  "},{"type":"INSERT","lineNumber":529,"content":"  }"},{"type":"INSERT","lineNumber":532,"content":"    _hasError = true;"}]},{"timestamp":1754614884011,"changes":[{"type":"INSERT","lineNumber":41,"content":"  bool get isOtpVerified => _isOtpVerified;"},{"type":"DELETE","lineNumber":42,"oldContent":"  String? get errorMessage => _errorMessage;"},{"type":"MODIFY","lineNumber":96,"content":"      setError(message: 'Failed to sign in with email and password: $e');","oldContent":"  // Register with email and password"},{"type":"DELETE","lineNumber":333,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":335,"oldContent":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":334,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":336,"content":"      final result = await verifyOtp("},{"type":"MODIFY","lineNumber":395,"content":"    try {","oldContent":"    try {"},{"type":"DELETE","lineNumber":404,"oldContent":"      // Update the user's phone number in Firebase Auth"},{"type":"DELETE","lineNumber":405,"oldContent":"        notifyListeners();"},{"type":"DELETE","lineNumber":406,"oldContent":"      try {"},{"type":"DELETE","lineNumber":407,"oldContent":"        // First, verify the phone number is in the correct format"},{"type":"DELETE","lineNumber":408,"oldContent":"        return true;"},{"type":"DELETE","lineNumber":409,"oldContent":"        final formattedPhone = phoneNumber.startsWith('+') "},{"type":"DELETE","lineNumber":410,"oldContent":"            ? phoneNumber "},{"type":"INSERT","lineNumber":404,"content":"      // First, verify the phone number is in the correct format"},{"type":"INSERT","lineNumber":405,"content":"      final formattedPhone = phoneNumber.startsWith('+') "},{"type":"INSERT","lineNumber":406,"content":"          ? phoneNumber "},{"type":"INSERT","lineNumber":407,"content":"          : '+$phoneNumber';"},{"type":"INSERT","lineNumber":408,"content":"      "},{"type":"INSERT","lineNumber":409,"content":"      // First, send OTP to verify the phone number"},{"type":"INSERT","lineNumber":410,"content":"      final otpSent = await sendOtp(formattedPhone);"},{"type":"INSERT","lineNumber":411,"content":"      "},{"type":"INSERT","lineNumber":412,"content":"      if (!otpSent || _verificationId == null) {"},{"type":"INSERT","lineNumber":413,"content":"        setError(message: 'Failed to send verification code');"},{"type":"INSERT","lineNumber":414,"content":"        return false;"},{"type":"DELETE","lineNumber":412,"oldContent":"            : '+$phoneNumber';"},{"type":"DELETE","lineNumber":413,"oldContent":"            "},{"type":"DELETE","lineNumber":414,"oldContent":"        // Update the user's phone number in Firestore or your database"},{"type":"DELETE","lineNumber":415,"oldContent":"        // This is where you would typically update the user's profile"},{"type":"DELETE","lineNumber":416,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":417,"oldContent":"        // with the verified phone number"},{"type":"DELETE","lineNumber":418,"oldContent":"        await user.updatePhoneNumber(null); // This would be the phone auth credential"},{"type":"INSERT","lineNumber":416,"content":"      "},{"type":"INSERT","lineNumber":417,"content":"      // In a real app, you would:"},{"type":"INSERT","lineNumber":418,"content":"      // 1. Show a dialog to enter the OTP"},{"type":"INSERT","lineNumber":419,"content":"      // 2. Verify the OTP using verifyOtpCode()"},{"type":"INSERT","lineNumber":420,"content":"      // 3. Then update the phone number with the credential"},{"type":"INSERT","lineNumber":421,"content":"      "},{"type":"INSERT","lineNumber":422,"content":"      // For now, we'll just update the phone number in the user entity"},{"type":"INSERT","lineNumber":423,"content":"      // without Firebase Auth verification"},{"type":"INSERT","lineNumber":424,"content":"      _currentUser = _currentUser?.copyWith(phoneNumber: formattedPhone);"},{"type":"INSERT","lineNumber":425,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":426,"content":"      "},{"type":"INSERT","lineNumber":427,"content":"      print('Successfully updated phone number to: $formattedPhone');"},{"type":"INSERT","lineNumber":428,"content":"      return true;"},{"type":"INSERT","lineNumber":429,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":430,"content":"      print('Error updating phone number: $e');"},{"type":"INSERT","lineNumber":431,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":432,"content":"      setError(message: 'Failed to update phone number: ${e.toString()}');"},{"type":"DELETE","lineNumber":420,"oldContent":"        "},{"type":"DELETE","lineNumber":421,"oldContent":"        // Update the local user entity"},{"type":"DELETE","lineNumber":423,"oldContent":"        _currentUser = _currentUser?.copyWith(phoneNumber: formattedPhone);"},{"type":"DELETE","lineNumber":425,"oldContent":"        "},{"type":"DELETE","lineNumber":426,"oldContent":"        print('Successfully updated phone number to: $formattedPhone');"},{"type":"DELETE","lineNumber":429,"oldContent":"      } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":431,"oldContent":"        print('Error updating phone number: $e');"},{"type":"DELETE","lineNumber":432,"oldContent":"        print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":434,"oldContent":"        setError(message: 'Failed to update phone number: ${e.toString()}');"},{"type":"DELETE","lineNumber":436,"oldContent":"        return false;"},{"type":"DELETE","lineNumber":439,"oldContent":"      print('Unexpected error in updateUserPhoneNumber: $e');"},{"type":"DELETE","lineNumber":441,"oldContent":"      setError(message: 'An unexpected error occurred');"},{"type":"INSERT","lineNumber":444,"content":"      return result.fold("},{"type":"INSERT","lineNumber":445,"content":"        (failure) {"},{"type":"INSERT","lineNumber":446,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":447,"content":"          return false;"},{"type":"INSERT","lineNumber":448,"content":"        },"},{"type":"INSERT","lineNumber":453,"content":"          return true;"},{"type":"INSERT","lineNumber":454,"content":"        },"},{"type":"INSERT","lineNumber":455,"content":"      );"},{"type":"INSERT","lineNumber":456,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":458,"content":"      return false;"},{"type":"INSERT","lineNumber":459,"content":"    } finally {"},{"type":"INSERT","lineNumber":460,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":461,"content":"    }"},{"type":"INSERT","lineNumber":462,"content":"  }"},{"type":"INSERT","lineNumber":464,"content":"  // Send password reset email"},{"type":"DELETE","lineNumber":449,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":451,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":453,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":455,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":457,"oldContent":"        },"},{"type":"DELETE","lineNumber":463,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":465,"oldContent":"        },"},{"type":"DELETE","lineNumber":467,"oldContent":"      );"},{"type":"DELETE","lineNumber":469,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":470,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":472,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":474,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":475,"oldContent":"    }"},{"type":"DELETE","lineNumber":477,"oldContent":"  }"},{"type":"DELETE","lineNumber":480,"oldContent":"  // Send password reset email"},{"type":"INSERT","lineNumber":485,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":486,"content":"    }"},{"type":"INSERT","lineNumber":488,"content":""},{"type":"INSERT","lineNumber":497,"content":"          return false;"},{"type":"INSERT","lineNumber":499,"content":"        (_) {"},{"type":"DELETE","lineNumber":495,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":496,"oldContent":"    }"},{"type":"INSERT","lineNumber":503,"content":"          return true;"},{"type":"DELETE","lineNumber":499,"oldContent":""},{"type":"INSERT","lineNumber":505,"content":"      );"},{"type":"INSERT","lineNumber":510,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":512,"content":"  }"},{"type":"INSERT","lineNumber":513,"content":""},{"type":"DELETE","lineNumber":506,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":509,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":514,"oldContent":"          return true;"},{"type":"INSERT","lineNumber":521,"content":"  void clearError() {"},{"type":"DELETE","lineNumber":517,"oldContent":"      );"},{"type":"INSERT","lineNumber":526,"content":"  "},{"type":"DELETE","lineNumber":523,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":525,"oldContent":"  "},{"type":"INSERT","lineNumber":532,"content":"  "},{"type":"DELETE","lineNumber":528,"oldContent":""},{"type":"INSERT","lineNumber":534,"content":"    _hasError = true;"},{"type":"DELETE","lineNumber":533,"oldContent":"    _hasError = true;"},{"type":"DELETE","lineNumber":534,"oldContent":"  }"},{"type":"DELETE","lineNumber":535,"oldContent":"  "},{"type":"DELETE","lineNumber":536,"oldContent":"  void clearError() {"}]},{"timestamp":1754615244075,"changes":[{"type":"MODIFY","lineNumber":111,"content":"      print('Starting registration for email: $email');","oldContent":"        ),"},{"type":"MODIFY","lineNumber":114,"content":"      ","oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":333,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":335,"oldContent":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":334,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":336,"content":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":394,"content":"  Future<bool> updateUserPhoneNumber(String phoneNumber, {String? smsCode, bool isVerification = false}) async {"},{"type":"DELETE","lineNumber":395,"oldContent":"    try {"},{"type":"DELETE","lineNumber":409,"oldContent":"      // First, send OTP to verify the phone number"},{"type":"DELETE","lineNumber":410,"oldContent":"      final otpSent = await sendOtp(formattedPhone);"},{"type":"DELETE","lineNumber":411,"oldContent":"      "},{"type":"INSERT","lineNumber":409,"content":"      // If this is the verification step (after OTP is entered)"},{"type":"INSERT","lineNumber":410,"content":"      if (isVerification && smsCode != null) {"},{"type":"INSERT","lineNumber":411,"content":"        try {"},{"type":"INSERT","lineNumber":412,"content":"          // Create a PhoneAuthCredential with the verification ID and SMS code"},{"type":"INSERT","lineNumber":413,"content":"          final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":414,"content":"            verificationId: _verificationId!,"},{"type":"INSERT","lineNumber":415,"content":"            smsCode: smsCode,"},{"type":"INSERT","lineNumber":416,"content":"          );"},{"type":"INSERT","lineNumber":417,"content":"          "},{"type":"INSERT","lineNumber":418,"content":"          // Link the phone credential to the user"},{"type":"INSERT","lineNumber":419,"content":"          await user.updatePhoneNumber(credential);"},{"type":"INSERT","lineNumber":420,"content":"          "},{"type":"INSERT","lineNumber":421,"content":"          // Update the local user entity"},{"type":"INSERT","lineNumber":422,"content":"          _currentUser = _currentUser?.copyWith(phoneNumber: formattedPhone);"},{"type":"INSERT","lineNumber":423,"content":"          notifyListeners();"},{"type":"INSERT","lineNumber":424,"content":"          "},{"type":"INSERT","lineNumber":425,"content":"          print('Successfully updated phone number to: $formattedPhone');"},{"type":"INSERT","lineNumber":426,"content":"          return true;"},{"type":"INSERT","lineNumber":427,"content":"          "},{"type":"INSERT","lineNumber":428,"content":"        } catch (e) {"},{"type":"INSERT","lineNumber":429,"content":"          print('Error verifying OTP: $e');"},{"type":"INSERT","lineNumber":430,"content":"          setError(message: 'Invalid verification code. Please try again.');"},{"type":"INSERT","lineNumber":431,"content":"          return false;"},{"type":"INSERT","lineNumber":432,"content":"        }"},{"type":"INSERT","lineNumber":433,"content":"      } "},{"type":"INSERT","lineNumber":434,"content":"      // If this is the initial step to send OTP"},{"type":"INSERT","lineNumber":435,"content":"      else {"},{"type":"INSERT","lineNumber":436,"content":"        final otpSent = await sendOtp(formattedPhone);"},{"type":"INSERT","lineNumber":437,"content":"        "},{"type":"INSERT","lineNumber":438,"content":"        if (!otpSent || _verificationId == null) {"},{"type":"INSERT","lineNumber":439,"content":"          setError(message: 'Failed to send verification code');"},{"type":"INSERT","lineNumber":440,"content":"          return false;"},{"type":"INSERT","lineNumber":441,"content":"        }"},{"type":"INSERT","lineNumber":442,"content":"        "},{"type":"INSERT","lineNumber":443,"content":"        // Return true to indicate OTP was sent successfully"},{"type":"INSERT","lineNumber":444,"content":"        // The UI should now prompt for OTP entry"},{"type":"INSERT","lineNumber":445,"content":"        return true;"},{"type":"DELETE","lineNumber":413,"oldContent":"      if (!otpSent || _verificationId == null) {"},{"type":"DELETE","lineNumber":414,"oldContent":"        setError(message: 'Failed to send verification code');"},{"type":"DELETE","lineNumber":415,"oldContent":"        return false;"},{"type":"DELETE","lineNumber":416,"oldContent":"      "},{"type":"DELETE","lineNumber":417,"oldContent":"      // In a real app, you would:"},{"type":"DELETE","lineNumber":418,"oldContent":"      // 1. Show a dialog to enter the OTP"},{"type":"DELETE","lineNumber":419,"oldContent":"      // 2. Verify the OTP using verifyOtpCode()"},{"type":"INSERT","lineNumber":447,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":448,"content":"      print('Error updating phone number: $e');"},{"type":"INSERT","lineNumber":449,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":450,"content":"      setError(message: 'Failed to update phone number: ${e.toString()}');"},{"type":"DELETE","lineNumber":421,"oldContent":"      // 3. Then update the phone number with the credential"},{"type":"DELETE","lineNumber":422,"oldContent":"      "},{"type":"DELETE","lineNumber":423,"oldContent":"      // For now, we'll just update the phone number in the user entity"},{"type":"DELETE","lineNumber":425,"oldContent":"      // without Firebase Auth verification"},{"type":"DELETE","lineNumber":426,"oldContent":"      _currentUser = _currentUser?.copyWith(phoneNumber: formattedPhone);"},{"type":"DELETE","lineNumber":428,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":429,"oldContent":"      "},{"type":"DELETE","lineNumber":430,"oldContent":"      print('Successfully updated phone number to: $formattedPhone');"},{"type":"DELETE","lineNumber":432,"oldContent":"      return true;"},{"type":"DELETE","lineNumber":434,"oldContent":"    } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":435,"oldContent":"      print('Error updating phone number: $e');"},{"type":"DELETE","lineNumber":437,"oldContent":"      print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":438,"oldContent":"      setError(message: 'Failed to update phone number: ${e.toString()}');"},{"type":"INSERT","lineNumber":462,"content":"      return result.fold("},{"type":"INSERT","lineNumber":463,"content":"        (failure) {"},{"type":"INSERT","lineNumber":464,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":465,"content":"          return false;"},{"type":"INSERT","lineNumber":466,"content":"        },"},{"type":"DELETE","lineNumber":446,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":448,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":450,"oldContent":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":471,"content":"          return true;"},{"type":"INSERT","lineNumber":472,"content":"        },"},{"type":"INSERT","lineNumber":473,"content":"      );"},{"type":"INSERT","lineNumber":474,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":452,"oldContent":"          return false;"},{"type":"INSERT","lineNumber":476,"content":"      return false;"},{"type":"INSERT","lineNumber":477,"content":"    } finally {"},{"type":"INSERT","lineNumber":478,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":479,"content":"    }"},{"type":"INSERT","lineNumber":480,"content":"  }"},{"type":"DELETE","lineNumber":454,"oldContent":"        },"},{"type":"INSERT","lineNumber":482,"content":"  // Send password reset email"},{"type":"DELETE","lineNumber":458,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":459,"oldContent":"        },"},{"type":"DELETE","lineNumber":461,"oldContent":"      );"},{"type":"DELETE","lineNumber":462,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":464,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":466,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":468,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":470,"oldContent":"    }"},{"type":"DELETE","lineNumber":472,"oldContent":"  }"},{"type":"DELETE","lineNumber":474,"oldContent":"  // Send password reset email"},{"type":"INSERT","lineNumber":503,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":504,"content":"    }"},{"type":"INSERT","lineNumber":506,"content":""},{"type":"DELETE","lineNumber":487,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":489,"oldContent":"    }"},{"type":"DELETE","lineNumber":492,"oldContent":""},{"type":"INSERT","lineNumber":515,"content":"          return false;"},{"type":"INSERT","lineNumber":517,"content":"        (_) {"},{"type":"DELETE","lineNumber":500,"oldContent":"          return false;"},{"type":"INSERT","lineNumber":521,"content":"          return true;"},{"type":"DELETE","lineNumber":503,"oldContent":"        (_) {"},{"type":"INSERT","lineNumber":523,"content":"      );"},{"type":"DELETE","lineNumber":507,"oldContent":"          return true;"},{"type":"INSERT","lineNumber":528,"content":"      setLoading(false);"},{"type":"DELETE","lineNumber":510,"oldContent":"      );"},{"type":"INSERT","lineNumber":530,"content":"  }"},{"type":"INSERT","lineNumber":531,"content":""},{"type":"DELETE","lineNumber":514,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":518,"oldContent":"  }"},{"type":"DELETE","lineNumber":519,"oldContent":""},{"type":"INSERT","lineNumber":539,"content":"  void clearError() {"},{"type":"INSERT","lineNumber":544,"content":"  "},{"type":"DELETE","lineNumber":526,"oldContent":"  void clearError() {"},{"type":"DELETE","lineNumber":530,"oldContent":"  "},{"type":"INSERT","lineNumber":550,"content":"  "},{"type":"DELETE","lineNumber":533,"oldContent":"    _errorMessage = message;"},{"type":"INSERT","lineNumber":553,"content":"    _errorMessage = message;"},{"type":"INSERT","lineNumber":554,"content":"  }"},{"type":"DELETE","lineNumber":536,"oldContent":"  "},{"type":"DELETE","lineNumber":538,"oldContent":"    _hasError = true;"}]},{"timestamp":1754615643161,"changes":[{"type":"INSERT","lineNumber":133,"content":"      // Format phone number if provided"},{"type":"INSERT","lineNumber":134,"content":"      String? formattedPhone;"},{"type":"INSERT","lineNumber":135,"content":"      if (phone != null && phone.isNotEmpty) {"},{"type":"INSERT","lineNumber":136,"content":"        formattedPhone = phone.startsWith('+') ? phone : '+91$phone';"},{"type":"INSERT","lineNumber":137,"content":"      }"},{"type":"INSERT","lineNumber":138,"content":"      "},{"type":"DELETE","lineNumber":139,"oldContent":"          phoneNumber: phone?.trim(),"},{"type":"INSERT","lineNumber":145,"content":"          phoneNumber: formattedPhone,"},{"type":"DELETE","lineNumber":171,"oldContent":"                email: currentUser.email,"},{"type":"DELETE","lineNumber":172,"oldContent":"                displayName: currentUser.displayName,"},{"type":"DELETE","lineNumber":173,"oldContent":"                phoneNumber: currentUser.phoneNumber,"},{"type":"DELETE","lineNumber":174,"oldContent":"                photoUrl: currentUser.photoURL,"},{"type":"INSERT","lineNumber":177,"content":"                email: currentUser.email ?? '',"},{"type":"INSERT","lineNumber":178,"content":"                name: name,"},{"type":"INSERT","lineNumber":179,"content":"                phone: formattedPhone,"},{"type":"INSERT","lineNumber":181,"content":"                createdAt: DateTime.now(),"},{"type":"INSERT","lineNumber":182,"content":"                updatedAt: DateTime.now(),"},{"type":"DELETE","lineNumber":178,"oldContent":"              // If phone number was provided, send OTP"},{"type":"DELETE","lineNumber":179,"oldContent":"              if (phone != null && phone.trim().isNotEmpty) {"},{"type":"DELETE","lineNumber":180,"oldContent":"                print('Sending OTP to phone: $phone');"},{"type":"DELETE","lineNumber":181,"oldContent":"                "},{"type":"DELETE","lineNumber":182,"oldContent":"                // Clear any existing verification ID"},{"type":"DELETE","lineNumber":183,"oldContent":"                _verificationId = null;"},{"type":"DELETE","lineNumber":184,"oldContent":"                "},{"type":"DELETE","lineNumber":185,"oldContent":"                // Send OTP"},{"type":"DELETE","lineNumber":186,"oldContent":"                final otpSent = await sendOtp(phone.trim());"},{"type":"DELETE","lineNumber":187,"oldContent":"                "},{"type":"DELETE","lineNumber":188,"oldContent":"                if (!otpSent || _verificationId == null) {"},{"type":"DELETE","lineNumber":189,"oldContent":"                  print('Failed to send OTP to $phone');"},{"type":"DELETE","lineNumber":190,"oldContent":"                  if (_verificationId == null) {"},{"type":"DELETE","lineNumber":191,"oldContent":"                    print('Verification ID is null after sending OTP');"},{"type":"DELETE","lineNumber":192,"oldContent":"                  }"},{"type":"DELETE","lineNumber":193,"oldContent":"                  setError(message: 'Registration successful but failed to send OTP');"},{"type":"DELETE","lineNumber":194,"oldContent":"                  return false;"},{"type":"DELETE","lineNumber":195,"oldContent":"                }"},{"type":"DELETE","lineNumber":196,"oldContent":"                "},{"type":"INSERT","lineNumber":185,"content":"              // Save user data to Firestore"},{"type":"INSERT","lineNumber":186,"content":"              await _saveUserToFirestore(_currentUser!);"},{"type":"DELETE","lineNumber":333,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":335,"oldContent":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":324,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":326,"content":"      final result = await verifyOtp("},{"type":"DELETE","lineNumber":413,"oldContent":"      }"},{"type":"DELETE","lineNumber":422,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":427,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":431,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":436,"oldContent":"    }"},{"type":"DELETE","lineNumber":439,"oldContent":"  }"},{"type":"DELETE","lineNumber":443,"oldContent":""},{"type":"DELETE","lineNumber":447,"oldContent":"  // Sign out"},{"type":"DELETE","lineNumber":449,"oldContent":"  Future<bool> signOutUser() async {"},{"type":"DELETE","lineNumber":451,"oldContent":"    try {"},{"type":"DELETE","lineNumber":453,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":455,"oldContent":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":457,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":459,"oldContent":"          _currentUser = null;"},{"type":"INSERT","lineNumber":436,"content":"      }"},{"type":"DELETE","lineNumber":461,"oldContent":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"DELETE","lineNumber":464,"oldContent":"          resetError();"},{"type":"DELETE","lineNumber":466,"oldContent":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":441,"content":"      return false;"},{"type":"INSERT","lineNumber":442,"content":"    } finally {"},{"type":"INSERT","lineNumber":443,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":444,"content":"    }"},{"type":"INSERT","lineNumber":445,"content":"  }"},{"type":"DELETE","lineNumber":468,"oldContent":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"INSERT","lineNumber":447,"content":"  // Sign out"},{"type":"INSERT","lineNumber":448,"content":"  Future<bool> signOutUser() async {"},{"type":"DELETE","lineNumber":471,"oldContent":"      final result = await sendPasswordResetEmail("},{"type":"INSERT","lineNumber":451,"content":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":474,"oldContent":"        SendPasswordResetEmailParams(email: email),"},{"type":"DELETE","lineNumber":477,"oldContent":"      );"},{"type":"DELETE","lineNumber":479,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":480,"oldContent":"        (failure) {"},{"type":"INSERT","lineNumber":457,"content":"        (_) {"},{"type":"INSERT","lineNumber":458,"content":"          _currentUser = null;"},{"type":"INSERT","lineNumber":459,"content":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"INSERT","lineNumber":460,"content":"          resetError();"},{"type":"DELETE","lineNumber":482,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":485,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":487,"oldContent":"        },"},{"type":"INSERT","lineNumber":465,"content":"      setError(message: 'Failed to sign out: $e');"},{"type":"DELETE","lineNumber":489,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":491,"oldContent":"          resetError();"},{"type":"DELETE","lineNumber":493,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":495,"oldContent":"        },"},{"type":"INSERT","lineNumber":471,"content":""},{"type":"INSERT","lineNumber":472,"content":"  // Send password reset email"},{"type":"INSERT","lineNumber":473,"content":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"INSERT","lineNumber":474,"content":"    try {"},{"type":"INSERT","lineNumber":475,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":476,"content":"      final result = await sendPasswordResetEmail("},{"type":"INSERT","lineNumber":477,"content":"        SendPasswordResetEmailParams(email: email),"},{"type":"INSERT","lineNumber":479,"content":"      return result.fold("},{"type":"INSERT","lineNumber":480,"content":"        (failure) {"},{"type":"INSERT","lineNumber":481,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":482,"content":"          return false;"},{"type":"INSERT","lineNumber":483,"content":"        },"},{"type":"INSERT","lineNumber":484,"content":"        (_) {"},{"type":"INSERT","lineNumber":485,"content":"          resetError();"},{"type":"INSERT","lineNumber":486,"content":"          return true;"},{"type":"INSERT","lineNumber":487,"content":"        },"},{"type":"INSERT","lineNumber":488,"content":"      );"},{"type":"DELETE","lineNumber":499,"oldContent":"  // Send password reset email"},{"type":"INSERT","lineNumber":493,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":494,"content":"    }"},{"type":"INSERT","lineNumber":496,"content":""},{"type":"INSERT","lineNumber":505,"content":"          return false;"},{"type":"INSERT","lineNumber":507,"content":"        (_) {"},{"type":"INSERT","lineNumber":511,"content":"          return true;"},{"type":"DELETE","lineNumber":517,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":518,"oldContent":"    }"},{"type":"INSERT","lineNumber":513,"content":"      );"},{"type":"DELETE","lineNumber":521,"oldContent":""},{"type":"INSERT","lineNumber":518,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":520,"content":"  }"},{"type":"INSERT","lineNumber":521,"content":""},{"type":"DELETE","lineNumber":528,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":531,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":534,"oldContent":"          return true;"},{"type":"INSERT","lineNumber":529,"content":"  void clearError() {"},{"type":"DELETE","lineNumber":537,"oldContent":"      );"},{"type":"INSERT","lineNumber":534,"content":"  "},{"type":"DELETE","lineNumber":542,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":546,"oldContent":""},{"type":"DELETE","lineNumber":547,"oldContent":"  }"},{"type":"INSERT","lineNumber":540,"content":"  "},{"type":"INSERT","lineNumber":543,"content":"    _errorMessage = message;"},{"type":"INSERT","lineNumber":544,"content":"  }"},{"type":"DELETE","lineNumber":552,"oldContent":"  void clearError() {"},{"type":"DELETE","lineNumber":553,"oldContent":"  }"},{"type":"DELETE","lineNumber":554,"oldContent":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":555,"oldContent":"  "},{"type":"DELETE","lineNumber":556,"oldContent":"  "}]},{"timestamp":1754615659011,"changes":[{"type":"INSERT","lineNumber":1,"content":"import 'package:firebase_auth/firebase_auth.dart';"},{"type":"DELETE","lineNumber":15,"oldContent":"class AuthViewModel extends BaseViewModel {"},{"type":"INSERT","lineNumber":20,"content":"  final SignInWithEmailAndPassword signInWithEmailAndPassword;"},{"type":"DELETE","lineNumber":31,"oldContent":"  String? _errorMessage;"},{"type":"INSERT","lineNumber":33,"content":"  String? _errorMessage;"},{"type":"DELETE","lineNumber":34,"oldContent":""},{"type":"INSERT","lineNumber":37,"content":"  UserEntity? get currentUser => _currentUser;"},{"type":"DELETE","lineNumber":40,"oldContent":"  String? get errorMessage => _errorMessage;"},{"type":"INSERT","lineNumber":42,"content":"  String? get errorMessage => _errorMessage;"},{"type":"DELETE","lineNumber":63,"oldContent":"        (failure) => setError(failure.message),"},{"type":"INSERT","lineNumber":83,"content":"      );"},{"type":"DELETE","lineNumber":85,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":108,"content":"    String? phone,"},{"type":"DELETE","lineNumber":110,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":134,"oldContent":"      print('Calling registerWithEmailAndPassword...');"},{"type":"DELETE","lineNumber":136,"oldContent":"      final result = await registerWithEmailAndPassword("},{"type":"DELETE","lineNumber":138,"oldContent":"        RegisterWithEmailAndPasswordParams("},{"type":"DELETE","lineNumber":140,"oldContent":"          email: email.trim(),"},{"type":"DELETE","lineNumber":142,"oldContent":"          password: password,"},{"type":"INSERT","lineNumber":139,"content":"      print('Calling registerWithEmailAndPassword...');"},{"type":"INSERT","lineNumber":140,"content":"      final result = await registerWithEmailAndPassword("},{"type":"INSERT","lineNumber":141,"content":"        RegisterWithEmailAndPasswordParams("},{"type":"INSERT","lineNumber":142,"content":"          email: email.trim(),"},{"type":"INSERT","lineNumber":143,"content":"          password: password,"},{"type":"INSERT","lineNumber":145,"content":"          phoneNumber: formattedPhone,"},{"type":"DELETE","lineNumber":150,"oldContent":"          phoneNumber: formattedPhone,"},{"type":"DELETE","lineNumber":177,"oldContent":"                isEmailVerified: currentUser.emailVerified,"},{"type":"DELETE","lineNumber":178,"oldContent":"              );"},{"type":"MODIFY","lineNumber":180,"content":"                isEmailVerified: currentUser.emailVerified,","oldContent":"              "},{"type":"INSERT","lineNumber":183,"content":"              );"},{"type":"INSERT","lineNumber":184,"content":"              "},{"type":"DELETE","lineNumber":187,"oldContent":"                print('OTP sent successfully to $phone');"},{"type":"DELETE","lineNumber":188,"oldContent":"                print('Verification ID: $_verificationId');"},{"type":"DELETE","lineNumber":189,"oldContent":"              }"},{"type":"INSERT","lineNumber":188,"content":"              // Send email verification"},{"type":"INSERT","lineNumber":189,"content":"              await _sendEmailVerification(currentUser);"},{"type":"INSERT","lineNumber":190,"content":"              "},{"type":"INSERT","lineNumber":191,"content":"              notifyListeners();"},{"type":"INSERT","lineNumber":192,"content":"              return true;"},{"type":"INSERT","lineNumber":193,"content":"              "},{"type":"DELETE","lineNumber":314,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":317,"oldContent":"      final result = await verifyOtp("},{"type":"INSERT","lineNumber":327,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":329,"content":"      final result = await verifyOtp("},{"type":"DELETE","lineNumber":422,"oldContent":"      }"},{"type":"DELETE","lineNumber":426,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":428,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":430,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":431,"oldContent":"    }"},{"type":"DELETE","lineNumber":433,"oldContent":"  }"},{"type":"DELETE","lineNumber":436,"oldContent":"  // Sign out"},{"type":"DELETE","lineNumber":437,"oldContent":"  Future<bool> signOutUser() async {"},{"type":"DELETE","lineNumber":440,"oldContent":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":444,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":445,"oldContent":"          _currentUser = null;"},{"type":"DELETE","lineNumber":447,"oldContent":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"DELETE","lineNumber":448,"oldContent":"          resetError();"},{"type":"INSERT","lineNumber":439,"content":"      }"},{"type":"DELETE","lineNumber":452,"oldContent":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":444,"content":"      return false;"},{"type":"INSERT","lineNumber":445,"content":"    } finally {"},{"type":"INSERT","lineNumber":446,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":447,"content":"    }"},{"type":"INSERT","lineNumber":448,"content":"  }"},{"type":"INSERT","lineNumber":450,"content":"  // Sign out"},{"type":"INSERT","lineNumber":451,"content":"  Future<bool> signOutUser() async {"},{"type":"INSERT","lineNumber":454,"content":"      final result = await signOut(NoParams());"},{"type":"INSERT","lineNumber":455,"content":"      return result.fold("},{"type":"INSERT","lineNumber":456,"content":"        (failure) {"},{"type":"INSERT","lineNumber":457,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":458,"content":"          return false;"},{"type":"INSERT","lineNumber":459,"content":"        },"},{"type":"INSERT","lineNumber":460,"content":"        (_) {"},{"type":"INSERT","lineNumber":461,"content":"          _currentUser = null;"},{"type":"INSERT","lineNumber":462,"content":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"INSERT","lineNumber":463,"content":"          resetError();"},{"type":"INSERT","lineNumber":464,"content":"          return true;"},{"type":"INSERT","lineNumber":465,"content":"        },"},{"type":"INSERT","lineNumber":466,"content":"      );"},{"type":"INSERT","lineNumber":467,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":468,"content":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":469,"content":"      return false;"},{"type":"INSERT","lineNumber":470,"content":"    } finally {"},{"type":"INSERT","lineNumber":471,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":472,"content":"    }"},{"type":"INSERT","lineNumber":473,"content":"  }"},{"type":"DELETE","lineNumber":459,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":461,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":464,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":466,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":468,"oldContent":"        },"},{"type":"INSERT","lineNumber":481,"content":"      );"},{"type":"DELETE","lineNumber":472,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":475,"oldContent":"        },"},{"type":"DELETE","lineNumber":477,"oldContent":"      );"},{"type":"DELETE","lineNumber":480,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":492,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":493,"content":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"DELETE","lineNumber":486,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":488,"oldContent":"    }"},{"type":"DELETE","lineNumber":489,"oldContent":""},{"type":"DELETE","lineNumber":491,"oldContent":"      );"},{"type":"DELETE","lineNumber":492,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":493,"oldContent":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"DELETE","lineNumber":494,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":495,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":496,"oldContent":"  }"},{"type":"INSERT","lineNumber":499,"content":""},{"type":"DELETE","lineNumber":498,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":501,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":506,"oldContent":"          return true;"},{"type":"INSERT","lineNumber":508,"content":"          return false;"},{"type":"DELETE","lineNumber":509,"oldContent":"      );"},{"type":"INSERT","lineNumber":510,"content":"        (_) {"},{"type":"INSERT","lineNumber":514,"content":"          return true;"},{"type":"DELETE","lineNumber":514,"oldContent":"      setLoading(false);"},{"type":"INSERT","lineNumber":516,"content":"      );"},{"type":"DELETE","lineNumber":516,"oldContent":"  }"},{"type":"DELETE","lineNumber":518,"oldContent":""},{"type":"INSERT","lineNumber":521,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":523,"content":"  }"},{"type":"INSERT","lineNumber":524,"content":""},{"type":"DELETE","lineNumber":525,"oldContent":"  void clearError() {"},{"type":"DELETE","lineNumber":530,"oldContent":"  "},{"type":"INSERT","lineNumber":532,"content":"  void clearError() {"},{"type":"DELETE","lineNumber":538,"oldContent":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":540,"oldContent":"  }"},{"type":"INSERT","lineNumber":543,"content":"  "},{"type":"DELETE","lineNumber":544,"oldContent":"  void setError({String message = 'An error occurred'}) {"},{"type":"INSERT","lineNumber":545,"content":"    _hasError = true;"},{"type":"INSERT","lineNumber":546,"content":"    _errorMessage = message;"},{"type":"INSERT","lineNumber":547,"content":"  }"}]},{"timestamp":1754615689516,"changes":[{"type":"DELETE","lineNumber":0,"oldContent":"import 'package:flutter/foundation.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:family_tree_firebase/core/error/failures.dart';"},{"type":"DELETE","lineNumber":112,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":113,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":110,"content":"      print('Name: $name');"},{"type":"INSERT","lineNumber":111,"content":"      print('Phone: $phone');"},{"type":"DELETE","lineNumber":115,"oldContent":"        (user) {"},{"type":"DELETE","lineNumber":116,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":117,"oldContent":"      );"},{"type":"DELETE","lineNumber":118,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":119,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":120,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":121,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":122,"oldContent":"  }"},{"type":"DELETE","lineNumber":123,"oldContent":"  // Sign in with Google"},{"type":"DELETE","lineNumber":124,"oldContent":"    try {"},{"type":"DELETE","lineNumber":125,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":126,"oldContent":"      final result = await signInWithGoogle(NoParams());"},{"type":"DELETE","lineNumber":127,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":128,"oldContent":"          setError(failure.message);"},{"type":"INSERT","lineNumber":113,"content":"      // Validate inputs"},{"type":"INSERT","lineNumber":114,"content":"      if (email.isEmpty || !email.contains('@')) {"},{"type":"INSERT","lineNumber":115,"content":"        setError(message: 'Please enter a valid email address');"},{"type":"INSERT","lineNumber":116,"content":"        return false;"},{"type":"INSERT","lineNumber":119,"content":"      if (password.isEmpty || password.length < 6) {"},{"type":"INSERT","lineNumber":120,"content":"        setError(message: 'Password must be at least 6 characters');"},{"type":"INSERT","lineNumber":121,"content":"        return false;"},{"type":"INSERT","lineNumber":122,"content":"      }"},{"type":"INSERT","lineNumber":123,"content":"      "},{"type":"INSERT","lineNumber":124,"content":"      if (name.isEmpty) {"},{"type":"INSERT","lineNumber":125,"content":"        setError(message: 'Please enter your name');"},{"type":"INSERT","lineNumber":126,"content":"        return false;"},{"type":"INSERT","lineNumber":127,"content":"      }"},{"type":"INSERT","lineNumber":128,"content":"      "},{"type":"DELETE","lineNumber":136,"oldContent":"      print('Calling registerWithEmailAndPassword...');"},{"type":"INSERT","lineNumber":135,"content":"      }"},{"type":"INSERT","lineNumber":136,"content":"      "},{"type":"INSERT","lineNumber":137,"content":"      print('Calling registerWithEmailAndPassword...');"},{"type":"DELETE","lineNumber":140,"oldContent":"      }"},{"type":"DELETE","lineNumber":143,"oldContent":"      "},{"type":"DELETE","lineNumber":144,"oldContent":"        },"},{"type":"INSERT","lineNumber":142,"content":"          displayName: name.trim(),"},{"type":"DELETE","lineNumber":149,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":150,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":147,"content":"      return await result.fold("},{"type":"INSERT","lineNumber":148,"content":"        (failure) async {"},{"type":"DELETE","lineNumber":152,"oldContent":"      setLoading(false);"},{"type":"INSERT","lineNumber":150,"content":"          String errorMessage = 'Registration failed';"},{"type":"DELETE","lineNumber":154,"oldContent":"    }"},{"type":"DELETE","lineNumber":155,"oldContent":"  }"},{"type":"DELETE","lineNumber":156,"oldContent":""},{"type":"DELETE","lineNumber":157,"oldContent":"  // Sign in with Apple"},{"type":"DELETE","lineNumber":158,"oldContent":"  Future<bool> signInWithAppleAccount() async {"},{"type":"DELETE","lineNumber":159,"oldContent":"    try {"},{"type":"DELETE","lineNumber":160,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":161,"oldContent":"      final result = await signInWithApple(NoParams());"},{"type":"INSERT","lineNumber":152,"content":"          // Map Firebase Auth error codes to user-friendly messages"},{"type":"INSERT","lineNumber":153,"content":"          if (failure.message.contains('email-already-in-use')) {"},{"type":"INSERT","lineNumber":154,"content":"            errorMessage = 'This email is already registered. Please sign in instead.';"},{"type":"INSERT","lineNumber":155,"content":"          } else if (failure.message.contains('invalid-email')) {"},{"type":"INSERT","lineNumber":156,"content":"            errorMessage = 'Please enter a valid email address';"},{"type":"INSERT","lineNumber":157,"content":"          } else if (failure.message.contains('weak-password')) {"},{"type":"INSERT","lineNumber":158,"content":"            errorMessage = 'Password is too weak. Please choose a stronger password.';"},{"type":"INSERT","lineNumber":159,"content":"          } else if (failure.message.contains('network-request-failed')) {"},{"type":"INSERT","lineNumber":163,"content":"          setError(message: errorMessage);"},{"type":"DELETE","lineNumber":167,"oldContent":"        (user) {"},{"type":"DELETE","lineNumber":168,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":169,"oldContent":"      );"},{"type":"DELETE","lineNumber":170,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":171,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":172,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":173,"oldContent":"    }"},{"type":"DELETE","lineNumber":174,"oldContent":""},{"type":"DELETE","lineNumber":175,"oldContent":"  Future<bool> sendOtp(String phoneNumber) async {"},{"type":"DELETE","lineNumber":176,"oldContent":"    try {"},{"type":"INSERT","lineNumber":166,"content":"        (_) async {"},{"type":"INSERT","lineNumber":167,"content":"          try {"},{"type":"INSERT","lineNumber":168,"content":"            // After successful registration, get the current user"},{"type":"INSERT","lineNumber":169,"content":"            final currentUser = FirebaseAuth.instance.currentUser;"},{"type":"INSERT","lineNumber":170,"content":"            print('Registration successful for user: ${currentUser?.email}');"},{"type":"INSERT","lineNumber":171,"content":"            "},{"type":"INSERT","lineNumber":172,"content":"            if (currentUser != null) {"},{"type":"INSERT","lineNumber":173,"content":"              _currentUser = UserEntity("},{"type":"INSERT","lineNumber":174,"content":"                id: currentUser.uid,"},{"type":"DELETE","lineNumber":178,"oldContent":"                isEmailVerified: currentUser.emailVerified,"},{"type":"DELETE","lineNumber":181,"oldContent":"              );"},{"type":"INSERT","lineNumber":178,"content":"                isEmailVerified: currentUser.emailVerified,"},{"type":"DELETE","lineNumber":183,"oldContent":"              "},{"type":"INSERT","lineNumber":181,"content":"              );"},{"type":"INSERT","lineNumber":182,"content":"              "},{"type":"INSERT","lineNumber":185,"content":"              "},{"type":"DELETE","lineNumber":190,"oldContent":"              "},{"type":"DELETE","lineNumber":192,"oldContent":"              resetError();"},{"type":"DELETE","lineNumber":194,"oldContent":"              return true;"},{"type":"INSERT","lineNumber":192,"content":"              resetError();"},{"type":"INSERT","lineNumber":193,"content":"              return true;"},{"type":"MODIFY","lineNumber":326,"content":"      ","oldContent":"      "},{"type":"INSERT","lineNumber":327,"content":"      final result = await verifyOtp("},{"type":"DELETE","lineNumber":331,"oldContent":"      final result = await verifyOtp("},{"type":"DELETE","lineNumber":434,"oldContent":"      }"},{"type":"INSERT","lineNumber":436,"content":"        return true;"},{"type":"INSERT","lineNumber":437,"content":"      }"},{"type":"INSERT","lineNumber":438,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":439,"content":"      print('Error updating phone number: $e');"},{"type":"INSERT","lineNumber":440,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":441,"content":"      setError(message: 'Failed to update phone number: ${e.toString()}');"},{"type":"DELETE","lineNumber":442,"oldContent":"        return true;"},{"type":"DELETE","lineNumber":445,"oldContent":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":447,"content":""},{"type":"DELETE","lineNumber":447,"oldContent":"      print('Error updating phone number: $e');"},{"type":"DELETE","lineNumber":449,"oldContent":"      print('Stack trace: $stackTrace');"},{"type":"MODIFY","lineNumber":450,"content":"    try {","oldContent":"      setError(message: 'Failed to update phone number: ${e.toString()}');"},{"type":"INSERT","lineNumber":451,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":452,"oldContent":""},{"type":"DELETE","lineNumber":454,"oldContent":"    try {"},{"type":"DELETE","lineNumber":456,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":458,"oldContent":""},{"type":"DELETE","lineNumber":460,"oldContent":"  // Send password reset email"},{"type":"DELETE","lineNumber":463,"oldContent":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"DELETE","lineNumber":466,"oldContent":"    try {"},{"type":"DELETE","lineNumber":468,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":471,"oldContent":"      final result = await sendPasswordResetEmail("},{"type":"DELETE","lineNumber":474,"oldContent":"        SendPasswordResetEmailParams(email: email),"},{"type":"DELETE","lineNumber":477,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":479,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":481,"oldContent":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":472,"content":""},{"type":"INSERT","lineNumber":473,"content":"  // Send password reset email"},{"type":"INSERT","lineNumber":474,"content":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"INSERT","lineNumber":475,"content":"    try {"},{"type":"INSERT","lineNumber":476,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":477,"content":"      final result = await sendPasswordResetEmail("},{"type":"INSERT","lineNumber":478,"content":"        SendPasswordResetEmailParams(email: email),"},{"type":"INSERT","lineNumber":479,"content":"      );"},{"type":"INSERT","lineNumber":480,"content":"      return result.fold("},{"type":"INSERT","lineNumber":481,"content":"        (failure) {"},{"type":"INSERT","lineNumber":482,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":489,"oldContent":"      );"},{"type":"INSERT","lineNumber":490,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":491,"content":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"DELETE","lineNumber":497,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":498,"oldContent":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"MODIFY","lineNumber":498,"content":"  // Delete account","oldContent":"  // Delete account"},{"type":"DELETE","lineNumber":514,"oldContent":"        },"},{"type":"DELETE","lineNumber":516,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":513,"content":"        },"},{"type":"INSERT","lineNumber":515,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":523,"oldContent":"  @override"},{"type":"DELETE","lineNumber":525,"oldContent":"  void setError({bool hasError = true, String? message}) {"},{"type":"INSERT","lineNumber":523,"content":"  @override"},{"type":"INSERT","lineNumber":524,"content":"  void setError({bool hasError = true, String? message}) {"},{"type":"MODIFY","lineNumber":531,"content":"    _hasError = false;","oldContent":"    _hasError = false;"},{"type":"DELETE","lineNumber":546,"oldContent":"  }"},{"type":"DELETE","lineNumber":548,"oldContent":"  "},{"type":"INSERT","lineNumber":546,"content":"}"},{"type":"INSERT","lineNumber":547,"content":""}]},{"timestamp":1754615704838,"changes":[{"type":"DELETE","lineNumber":108,"oldContent":"      print('Name: $name');"},{"type":"MODIFY","lineNumber":110,"content":"      print('Name: $name');","oldContent":"      print('Phone: $phone');"},{"type":"INSERT","lineNumber":111,"content":"      print('Phone: $phone');"},{"type":"INSERT","lineNumber":112,"content":"      "},{"type":"DELETE","lineNumber":114,"oldContent":"      "},{"type":"INSERT","lineNumber":117,"content":"      }"},{"type":"INSERT","lineNumber":118,"content":"      "},{"type":"DELETE","lineNumber":127,"oldContent":"      }"},{"type":"DELETE","lineNumber":128,"oldContent":"      "},{"type":"DELETE","lineNumber":133,"oldContent":"      }"},{"type":"INSERT","lineNumber":134,"content":"        formattedPhone = phone.startsWith('+') ? phone : '+91$phone';"},{"type":"INSERT","lineNumber":135,"content":"      }"},{"type":"DELETE","lineNumber":137,"oldContent":"        formattedPhone = phone.startsWith('+') ? phone : '+91$phone';"},{"type":"MODIFY","lineNumber":142,"content":"          displayName: name.trim(),","oldContent":"          displayName: name.trim(),"},{"type":"DELETE","lineNumber":145,"oldContent":"      return await result.fold("},{"type":"DELETE","lineNumber":147,"oldContent":"        (failure) async {"},{"type":"DELETE","lineNumber":149,"oldContent":"          String errorMessage = 'Registration failed';"},{"type":"INSERT","lineNumber":147,"content":"      return await result.fold("},{"type":"INSERT","lineNumber":148,"content":"        (failure) async {"},{"type":"INSERT","lineNumber":150,"content":"          String errorMessage = 'Registration failed';"},{"type":"INSERT","lineNumber":151,"content":"          "},{"type":"DELETE","lineNumber":153,"oldContent":"          "},{"type":"DELETE","lineNumber":161,"oldContent":"          setError(message: errorMessage);"},{"type":"DELETE","lineNumber":164,"oldContent":"        (failure) {"},{"type":"INSERT","lineNumber":163,"content":"          setError(message: errorMessage);"},{"type":"INSERT","lineNumber":164,"content":"          return false;"},{"type":"INSERT","lineNumber":165,"content":"        },"},{"type":"DELETE","lineNumber":166,"oldContent":"          setError(failure.message);"},{"type":"DELETE","lineNumber":176,"oldContent":"                isEmailVerified: currentUser.emailVerified,"},{"type":"DELETE","lineNumber":179,"oldContent":"              );"},{"type":"DELETE","lineNumber":180,"oldContent":"              "},{"type":"INSERT","lineNumber":178,"content":"                isEmailVerified: currentUser.emailVerified,"},{"type":"INSERT","lineNumber":181,"content":"              );"},{"type":"INSERT","lineNumber":185,"content":"              "},{"type":"DELETE","lineNumber":190,"oldContent":"              resetError();"},{"type":"MODIFY","lineNumber":192,"content":"              resetError();","oldContent":"              return true;"},{"type":"INSERT","lineNumber":193,"content":"              return true;"},{"type":"DELETE","lineNumber":206,"oldContent":"      setError('Failed to send OTP');"},{"type":"DELETE","lineNumber":207,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":208,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":209,"oldContent":"  }"},{"type":"DELETE","lineNumber":210,"oldContent":"  // Verify OTP"},{"type":"DELETE","lineNumber":211,"oldContent":"  Future<bool> verifyOtpCode(String smsCode) async {"},{"type":"INSERT","lineNumber":206,"content":"      );"},{"type":"INSERT","lineNumber":207,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":208,"content":"      print('Unexpected error during registration:');"},{"type":"INSERT","lineNumber":209,"content":"      print('Error: $e');"},{"type":"INSERT","lineNumber":210,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":211,"content":"      setError(message: 'An unexpected error occurred. Please try again.');"},{"type":"MODIFY","lineNumber":222,"content":"      final result = await signInWithGoogle(NoParams());","oldContent":"        ),"},{"type":"INSERT","lineNumber":225,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":227,"oldContent":"          _currentUser = user;"},{"type":"INSERT","lineNumber":228,"content":"        (user) {"},{"type":"INSERT","lineNumber":229,"content":"          _currentUser = user as UserEntity?;"},{"type":"INSERT","lineNumber":230,"content":"          resetError();"},{"type":"INSERT","lineNumber":232,"content":"        },"},{"type":"INSERT","lineNumber":235,"content":"      setError(message: 'Failed to sign in with Google: $e');"},{"type":"DELETE","lineNumber":232,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":233,"oldContent":"  }"},{"type":"DELETE","lineNumber":234,"oldContent":"  // Sign out"},{"type":"DELETE","lineNumber":235,"oldContent":"    try {"},{"type":"DELETE","lineNumber":236,"oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":324,"content":"      print('Verifying OTP with verification ID: $_verificationId');"},{"type":"INSERT","lineNumber":325,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":326,"oldContent":"      "},{"type":"DELETE","lineNumber":327,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":433,"oldContent":"        return true;"},{"type":"DELETE","lineNumber":435,"oldContent":"      }"},{"type":"DELETE","lineNumber":437,"oldContent":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":436,"content":"        return true;"},{"type":"INSERT","lineNumber":437,"content":"      }"},{"type":"INSERT","lineNumber":438,"content":"    } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":440,"oldContent":"      return false;"},{"type":"MODIFY","lineNumber":442,"content":"      return false;","oldContent":"    } finally {"},{"type":"INSERT","lineNumber":443,"content":"    } finally {"},{"type":"DELETE","lineNumber":447,"oldContent":"  // Sign out"},{"type":"INSERT","lineNumber":448,"content":"  // Send email verification to the user"},{"type":"INSERT","lineNumber":449,"content":"  Future<void> _sendEmailVerification(User user) async {"},{"type":"INSERT","lineNumber":450,"content":"    try {"},{"type":"INSERT","lineNumber":451,"content":"      await user.sendEmailVerification();"},{"type":"INSERT","lineNumber":452,"content":"      print('Email verification sent to ${user.email}');"},{"type":"INSERT","lineNumber":453,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":454,"content":"      print('Error sending email verification: $e');"},{"type":"INSERT","lineNumber":455,"content":"      // Continue even if email verification fails"},{"type":"INSERT","lineNumber":456,"content":"    }"},{"type":"INSERT","lineNumber":457,"content":"  }"},{"type":"INSERT","lineNumber":458,"content":""},{"type":"INSERT","lineNumber":459,"content":"  // Sign out"},{"type":"DELETE","lineNumber":464,"oldContent":""},{"type":"DELETE","lineNumber":466,"oldContent":"  // Send password reset email"},{"type":"INSERT","lineNumber":477,"content":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":478,"content":"      return false;"},{"type":"INSERT","lineNumber":479,"content":"    } finally {"},{"type":"INSERT","lineNumber":480,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":481,"content":"    }"},{"type":"INSERT","lineNumber":482,"content":"  }"},{"type":"INSERT","lineNumber":483,"content":""},{"type":"INSERT","lineNumber":484,"content":"  // Send password reset email"},{"type":"DELETE","lineNumber":470,"oldContent":"      setError(message: 'Failed to sign out: $e');"},{"type":"DELETE","lineNumber":472,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":475,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":478,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":481,"oldContent":"    }"},{"type":"DELETE","lineNumber":482,"oldContent":"  }"},{"type":"DELETE","lineNumber":488,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":490,"oldContent":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"INSERT","lineNumber":501,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":502,"content":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"DELETE","lineNumber":497,"oldContent":"  // Delete account"},{"type":"INSERT","lineNumber":509,"content":"  // Delete account"},{"type":"DELETE","lineNumber":511,"oldContent":"        },"},{"type":"DELETE","lineNumber":513,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":524,"content":"        },"},{"type":"INSERT","lineNumber":526,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":521,"oldContent":"  @override"},{"type":"DELETE","lineNumber":522,"oldContent":"  void setError({bool hasError = true, String? message}) {"},{"type":"INSERT","lineNumber":534,"content":"  @override"},{"type":"INSERT","lineNumber":535,"content":"  void setError({bool hasError = true, String? message}) {"},{"type":"DELETE","lineNumber":529,"oldContent":"    _hasError = false;"},{"type":"DELETE","lineNumber":530,"oldContent":"    _hasError = false;"},{"type":"INSERT","lineNumber":540,"content":"  "},{"type":"INSERT","lineNumber":542,"content":"    _hasError = false;"},{"type":"INSERT","lineNumber":553,"content":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":543,"oldContent":"    _hasError = true;"},{"type":"DELETE","lineNumber":544,"oldContent":"}"},{"type":"DELETE","lineNumber":545,"oldContent":""},{"type":"INSERT","lineNumber":557,"content":"}"},{"type":"INSERT","lineNumber":558,"content":""}]},{"timestamp":1754615751232,"changes":[{"type":"INSERT","lineNumber":109,"content":"      print('Starting registration for email: $email');"},{"type":"DELETE","lineNumber":111,"oldContent":"      print('Starting registration for email: $email');"},{"type":"MODIFY","lineNumber":119,"content":"      if (password.isEmpty || password.length < 6) {","oldContent":"      if (password.isEmpty || password.length < 6) {"},{"type":"MODIFY","lineNumber":134,"content":"        formattedPhone = phone.startsWith('+') ? phone : '+91$phone';","oldContent":"        formattedPhone = phone.startsWith('+') ? phone : '+91$phone';"},{"type":"INSERT","lineNumber":141,"content":"          password: password,"},{"type":"DELETE","lineNumber":142,"oldContent":"          displayName: name.trim(),"},{"type":"INSERT","lineNumber":146,"content":"      "},{"type":"DELETE","lineNumber":148,"oldContent":"      "},{"type":"MODIFY","lineNumber":150,"content":"          String errorMessage = 'Registration failed';","oldContent":"          String errorMessage = 'Registration failed';"},{"type":"MODIFY","lineNumber":161,"content":"          }","oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":162,"content":"          "},{"type":"DELETE","lineNumber":163,"oldContent":"      final result = await signInWithApple(NoParams());"},{"type":"DELETE","lineNumber":177,"oldContent":"                isEmailVerified: currentUser.emailVerified,"},{"type":"DELETE","lineNumber":179,"oldContent":"              );"},{"type":"INSERT","lineNumber":178,"content":"                isEmailVerified: currentUser.emailVerified,"},{"type":"INSERT","lineNumber":181,"content":"              );"},{"type":"MODIFY","lineNumber":185,"content":"              ","oldContent":"              "},{"type":"INSERT","lineNumber":191,"content":"              "},{"type":"DELETE","lineNumber":193,"oldContent":"              "},{"type":"DELETE","lineNumber":212,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":213,"oldContent":"        VerifyOtpParams("},{"type":"DELETE","lineNumber":214,"oldContent":"          verificationId: _verificationId!,"},{"type":"DELETE","lineNumber":215,"oldContent":"        ),"},{"type":"INSERT","lineNumber":212,"content":"      return false;"},{"type":"INSERT","lineNumber":213,"content":"    } finally {"},{"type":"INSERT","lineNumber":214,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":215,"content":"    }"},{"type":"INSERT","lineNumber":223,"content":"      return result.fold("},{"type":"INSERT","lineNumber":224,"content":"        (failure) {"},{"type":"INSERT","lineNumber":225,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":225,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":227,"oldContent":"          _currentUser = user;"},{"type":"DELETE","lineNumber":228,"oldContent":"        (user) {"},{"type":"DELETE","lineNumber":229,"oldContent":"        },"},{"type":"DELETE","lineNumber":231,"oldContent":"      );"},{"type":"DELETE","lineNumber":233,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":234,"oldContent":"      setError('Failed to verify OTP');"},{"type":"INSERT","lineNumber":231,"content":"          return true;"},{"type":"INSERT","lineNumber":233,"content":"      );"},{"type":"INSERT","lineNumber":234,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":236,"content":"      return false;"},{"type":"MODIFY","lineNumber":245,"content":"      setLoading(true);","oldContent":"      final result = await signOut(NoParams());"},{"type":"INSERT","lineNumber":246,"content":"      final result = await signInWithApple(NoParams());"},{"type":"DELETE","lineNumber":247,"oldContent":"          setError(failure.message);"},{"type":"DELETE","lineNumber":248,"oldContent":"        },"},{"type":"MODIFY","lineNumber":248,"content":"        (failure) {","oldContent":"        (_) {"},{"type":"INSERT","lineNumber":249,"content":"          setError(message: failure.message);"},{"type":"MODIFY","lineNumber":286,"content":"          if (verificationId.isEmpty) {","oldContent":"          if (verificationId == null || verificationId.isEmpty) {"},{"type":"MODIFY","lineNumber":326,"content":"      ","oldContent":"      "},{"type":"DELETE","lineNumber":434,"oldContent":"        return true;"},{"type":"INSERT","lineNumber":435,"content":"        // The UI should now prompt for OTP entry"},{"type":"INSERT","lineNumber":436,"content":"        return true;"},{"type":"DELETE","lineNumber":438,"oldContent":"        // The UI should now prompt for OTP entry"},{"type":"INSERT","lineNumber":441,"content":"      setError(message: 'Failed to update phone number: ${e.toString()}');"},{"type":"DELETE","lineNumber":443,"oldContent":"      setError(message: 'Failed to update phone number: ${e.toString()}');"},{"type":"MODIFY","lineNumber":448,"content":"  // Send email verification to the user","oldContent":"  // Send email verification to the user"},{"type":"DELETE","lineNumber":450,"oldContent":"  Future<bool> signOutUser() async {"},{"type":"DELETE","lineNumber":452,"oldContent":"    try {"},{"type":"DELETE","lineNumber":454,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":456,"oldContent":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":458,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":460,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":462,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":464,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":466,"oldContent":"        },"},{"type":"DELETE","lineNumber":468,"oldContent":"        (_) {"},{"type":"INSERT","lineNumber":460,"content":"  Future<bool> signOutUser() async {"},{"type":"INSERT","lineNumber":461,"content":"    try {"},{"type":"INSERT","lineNumber":462,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":463,"content":"      final result = await signOut(NoParams());"},{"type":"INSERT","lineNumber":464,"content":"      return result.fold("},{"type":"INSERT","lineNumber":465,"content":"        (failure) {"},{"type":"INSERT","lineNumber":466,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":467,"content":"          return false;"},{"type":"INSERT","lineNumber":468,"content":"        },"},{"type":"INSERT","lineNumber":469,"content":"        (_) {"},{"type":"INSERT","lineNumber":477,"content":"      setError(message: 'Failed to sign out: $e');"},{"type":"INSERT","lineNumber":478,"content":"      return false;"},{"type":"INSERT","lineNumber":479,"content":"    } finally {"},{"type":"INSERT","lineNumber":480,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":481,"content":"    }"},{"type":"INSERT","lineNumber":482,"content":"  }"},{"type":"INSERT","lineNumber":483,"content":""},{"type":"INSERT","lineNumber":484,"content":"  // Send password reset email"},{"type":"DELETE","lineNumber":483,"oldContent":"      setError(message: 'Failed to sign out: $e');"},{"type":"DELETE","lineNumber":485,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":486,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":488,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":490,"oldContent":"    }"},{"type":"DELETE","lineNumber":491,"oldContent":"  }"},{"type":"DELETE","lineNumber":492,"oldContent":""},{"type":"DELETE","lineNumber":494,"oldContent":"  // Send password reset email"},{"type":"INSERT","lineNumber":501,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":502,"content":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"INSERT","lineNumber":509,"content":"  // Delete account"},{"type":"DELETE","lineNumber":509,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":511,"oldContent":"      setError(message: 'Failed to send password reset email: $e');"},{"type":"DELETE","lineNumber":519,"oldContent":"  // Delete account"},{"type":"INSERT","lineNumber":524,"content":"        },"},{"type":"INSERT","lineNumber":526,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":531,"oldContent":"        },"},{"type":"INSERT","lineNumber":534,"content":"  @override"},{"type":"INSERT","lineNumber":535,"content":"  void setError({bool hasError = true, String? message}) {"},{"type":"DELETE","lineNumber":534,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":540,"content":"  "},{"type":"INSERT","lineNumber":542,"content":"    _hasError = false;"},{"type":"DELETE","lineNumber":541,"oldContent":"  @override"},{"type":"DELETE","lineNumber":543,"oldContent":"  void setError({bool hasError = true, String? message}) {"},{"type":"DELETE","lineNumber":549,"oldContent":"  "},{"type":"DELETE","lineNumber":552,"oldContent":"    _hasError = false;"},{"type":"MODIFY","lineNumber":553,"content":"  void setErrorSilently({String? message}) {","oldContent":"  }"},{"type":"INSERT","lineNumber":554,"content":"    _hasError = true;"},{"type":"DELETE","lineNumber":556,"oldContent":""},{"type":"MODIFY","lineNumber":558,"content":"","oldContent":"  void setErrorSilently({String? message}) {"}]},{"timestamp":1754615814177,"changes":[{"type":"INSERT","lineNumber":118,"content":"      "},{"type":"DELETE","lineNumber":119,"oldContent":"      if (password.isEmpty || password.length < 6) {"},{"type":"INSERT","lineNumber":133,"content":"      if (phone != null && phone.isNotEmpty) {"},{"type":"DELETE","lineNumber":134,"oldContent":"        formattedPhone = phone.startsWith('+') ? phone : '+91$phone';"},{"type":"MODIFY","lineNumber":145,"content":"      );","oldContent":"        (user) {"},{"type":"INSERT","lineNumber":149,"content":"          print('Registration failed with error: ${failure.message}');"},{"type":"DELETE","lineNumber":150,"oldContent":"          String errorMessage = 'Registration failed';"},{"type":"MODIFY","lineNumber":160,"content":"            errorMessage = 'Network error. Please check your internet connection.';","oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":175,"oldContent":"                email: currentUser.email ?? '',"},{"type":"DELETE","lineNumber":176,"oldContent":"                name: name,"},{"type":"INSERT","lineNumber":175,"content":"                email: currentUser.email,"},{"type":"INSERT","lineNumber":176,"content":"                displayName: name,"},{"type":"INSERT","lineNumber":177,"content":"                phoneNumber: formattedPhone,"},{"type":"DELETE","lineNumber":178,"oldContent":"                phone: formattedPhone,"},{"type":"DELETE","lineNumber":179,"oldContent":"                createdAt: DateTime.now(),"},{"type":"DELETE","lineNumber":181,"oldContent":"                updatedAt: DateTime.now(),"},{"type":"INSERT","lineNumber":182,"content":"              await _saveUserDataToFirestore(_currentUser!);"},{"type":"DELETE","lineNumber":185,"oldContent":"              "},{"type":"DELETE","lineNumber":200,"oldContent":"      setError('Failed to send OTP');"},{"type":"INSERT","lineNumber":198,"content":"            print('Error after registration: $e');"},{"type":"DELETE","lineNumber":202,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":203,"oldContent":"      setLoading(false);"},{"type":"DELETE","lineNumber":204,"oldContent":"  }"},{"type":"DELETE","lineNumber":205,"oldContent":""},{"type":"INSERT","lineNumber":200,"content":"            setError(message: 'Registration completed but failed to initialize user session');"},{"type":"INSERT","lineNumber":201,"content":"            return false;"},{"type":"INSERT","lineNumber":202,"content":"          }"},{"type":"INSERT","lineNumber":203,"content":"        },"},{"type":"DELETE","lineNumber":220,"oldContent":"      );"},{"type":"DELETE","lineNumber":221,"oldContent":"      return result.fold("},{"type":"INSERT","lineNumber":218,"content":"    try {"},{"type":"INSERT","lineNumber":219,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":224,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":226,"oldContent":"        },"},{"type":"INSERT","lineNumber":224,"content":"          return false;"},{"type":"INSERT","lineNumber":225,"content":"        },"},{"type":"MODIFY","lineNumber":229,"content":"          return true;","oldContent":"          return true;"},{"type":"INSERT","lineNumber":230,"content":"        },"},{"type":"DELETE","lineNumber":234,"oldContent":"        },"},{"type":"DELETE","lineNumber":235,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":237,"oldContent":""},{"type":"DELETE","lineNumber":238,"oldContent":"  Future<bool> signOutUser() async {"},{"type":"DELETE","lineNumber":239,"oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":234,"content":"      return false;"},{"type":"INSERT","lineNumber":235,"content":"    } finally {"},{"type":"INSERT","lineNumber":236,"content":"      setLoading(false);"},{"type":"INSERT","lineNumber":237,"content":"    }"},{"type":"DELETE","lineNumber":247,"oldContent":"          return false;"},{"type":"INSERT","lineNumber":245,"content":"      return result.fold("},{"type":"DELETE","lineNumber":249,"oldContent":"          _currentUser = null;"},{"type":"INSERT","lineNumber":247,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":323,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":326,"oldContent":"      "},{"type":"MODIFY","lineNumber":433,"content":"        // The UI should now prompt for OTP entry","oldContent":"        // The UI should now prompt for OTP entry"},{"type":"INSERT","lineNumber":445,"content":""},{"type":"INSERT","lineNumber":446,"content":"  // Save user data to Firestore"},{"type":"INSERT","lineNumber":447,"content":"  Future<void> _saveUserDataToFirestore(UserEntity user) async {"},{"type":"INSERT","lineNumber":448,"content":"    try {"},{"type":"INSERT","lineNumber":449,"content":"      final userDoc = FirebaseFirestore.instance.collection('users').doc(user.id);"},{"type":"INSERT","lineNumber":450,"content":"      await userDoc.set({"},{"type":"INSERT","lineNumber":451,"content":"        'id': user.id,"},{"type":"INSERT","lineNumber":452,"content":"        'email': user.email,"},{"type":"INSERT","lineNumber":453,"content":"        'displayName': user.displayName,"},{"type":"INSERT","lineNumber":454,"content":"        'phoneNumber': user.phoneNumber,"},{"type":"INSERT","lineNumber":455,"content":"        'isEmailVerified': user.isEmailVerified,"},{"type":"INSERT","lineNumber":456,"content":"        'createdAt': FieldValue.serverTimestamp(),"},{"type":"INSERT","lineNumber":457,"content":"        'updatedAt': FieldValue.serverTimestamp(),"},{"type":"INSERT","lineNumber":458,"content":"      });"},{"type":"INSERT","lineNumber":459,"content":"      print('User data saved to Firestore');"},{"type":"INSERT","lineNumber":460,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":461,"content":"      print('Error saving user data to Firestore: $e');"},{"type":"INSERT","lineNumber":462,"content":"      rethrow;"},{"type":"INSERT","lineNumber":463,"content":"    }"},{"type":"INSERT","lineNumber":464,"content":"  }"},{"type":"INSERT","lineNumber":465,"content":""},{"type":"DELETE","lineNumber":448,"oldContent":"  // Send email verification to the user"},{"type":"INSERT","lineNumber":473,"content":"      // Continue even if email verification fails"},{"type":"INSERT","lineNumber":474,"content":"    }"},{"type":"INSERT","lineNumber":475,"content":"  }"},{"type":"INSERT","lineNumber":476,"content":""},{"type":"INSERT","lineNumber":477,"content":"  // Sign out"},{"type":"DELETE","lineNumber":457,"oldContent":"      // Continue even if email verification fails"},{"type":"DELETE","lineNumber":460,"oldContent":"    }"},{"type":"DELETE","lineNumber":463,"oldContent":"  }"},{"type":"DELETE","lineNumber":466,"oldContent":""},{"type":"DELETE","lineNumber":469,"oldContent":"  // Sign out"},{"type":"DELETE","lineNumber":478,"oldContent":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"DELETE","lineNumber":480,"oldContent":"    try {"},{"type":"DELETE","lineNumber":482,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":484,"oldContent":"      final result = await sendPasswordResetEmail("},{"type":"DELETE","lineNumber":486,"oldContent":"        SendPasswordResetEmailParams(email: email),"},{"type":"DELETE","lineNumber":488,"oldContent":"      );"},{"type":"INSERT","lineNumber":503,"content":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"INSERT","lineNumber":504,"content":"    try {"},{"type":"INSERT","lineNumber":505,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":506,"content":"      final result = await sendPasswordResetEmail("},{"type":"INSERT","lineNumber":507,"content":"        SendPasswordResetEmailParams(email: email),"},{"type":"INSERT","lineNumber":508,"content":"      );"},{"type":"DELETE","lineNumber":502,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":521,"content":"      return false;"},{"type":"INSERT","lineNumber":527,"content":"  // Delete account"},{"type":"DELETE","lineNumber":511,"oldContent":"  // Delete account"},{"type":"DELETE","lineNumber":526,"oldContent":"      setError(message: 'Failed to delete account: $e');"},{"type":"INSERT","lineNumber":545,"content":"      setError(message: 'Failed to delete account: $e');"},{"type":"DELETE","lineNumber":534,"oldContent":"    _hasError = hasError;"},{"type":"INSERT","lineNumber":554,"content":"    _hasError = hasError;"},{"type":"INSERT","lineNumber":558,"content":"  "},{"type":"INSERT","lineNumber":560,"content":"    _hasError = false;"},{"type":"DELETE","lineNumber":542,"oldContent":"  "},{"type":"DELETE","lineNumber":544,"oldContent":"    _hasError = false;"}]},{"timestamp":1754615844573,"changes":[{"type":"INSERT","lineNumber":1,"content":"import 'package:cloud_firestore/cloud_firestore.dart';"},{"type":"DELETE","lineNumber":129,"oldContent":"  Future<bool> signInWithGoogleAccount() async {"},{"type":"INSERT","lineNumber":130,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":144,"oldContent":"        (user) {"},{"type":"INSERT","lineNumber":145,"content":"        ),"},{"type":"DELETE","lineNumber":180,"oldContent":"              await _saveUserDataToFirestore(_currentUser!);"},{"type":"INSERT","lineNumber":183,"content":"              await _saveUserDataToFirestore(_currentUser!);"},{"type":"MODIFY","lineNumber":193,"content":"            } else {","oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":194,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":195,"content":"              setError(message: 'Registration failed. Please try again.');"},{"type":"DELETE","lineNumber":196,"oldContent":"            print('Error after registration: $e');"},{"type":"INSERT","lineNumber":199,"content":"            print('Error after registration: $e');"},{"type":"INSERT","lineNumber":200,"content":"            print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":201,"oldContent":"            print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":215,"oldContent":"          verificationId: _verificationId!,"},{"type":"INSERT","lineNumber":216,"content":""},{"type":"INSERT","lineNumber":217,"content":"  // Sign in with Google"},{"type":"INSERT","lineNumber":218,"content":"  Future<bool> signInWithGoogleAccount() async {"},{"type":"DELETE","lineNumber":217,"oldContent":"          smsCode: smsCode,"},{"type":"DELETE","lineNumber":219,"oldContent":"      );"},{"type":"DELETE","lineNumber":222,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":223,"oldContent":"        },"},{"type":"INSERT","lineNumber":225,"content":"          return false;"},{"type":"INSERT","lineNumber":226,"content":"        },"},{"type":"INSERT","lineNumber":228,"content":"          _currentUser = user as UserEntity?;"},{"type":"INSERT","lineNumber":229,"content":"          resetError();"},{"type":"DELETE","lineNumber":229,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":230,"oldContent":"          resetError();"},{"type":"INSERT","lineNumber":234,"content":"      setError(message: 'Failed to sign in with Google: $e');"},{"type":"DELETE","lineNumber":236,"oldContent":"      setError(message: 'Failed to sign in with Google: $e');"},{"type":"DELETE","lineNumber":241,"oldContent":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":242,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":243,"oldContent":"      return result.fold("},{"type":"INSERT","lineNumber":242,"content":"  Future<bool> signInWithAppleAccount() async {"},{"type":"INSERT","lineNumber":243,"content":"    try {"},{"type":"MODIFY","lineNumber":246,"content":"      return result.fold(","oldContent":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":248,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":321,"oldContent":"      setLoading(true);"},{"type":"INSERT","lineNumber":324,"content":"      setLoading(true);"},{"type":"DELETE","lineNumber":431,"oldContent":"        // The UI should now prompt for OTP entry"},{"type":"MODIFY","lineNumber":432,"content":"        ","oldContent":"        // The UI should now prompt for OTP entry"},{"type":"INSERT","lineNumber":434,"content":"        // The UI should now prompt for OTP entry"},{"type":"DELETE","lineNumber":443,"oldContent":""},{"type":"DELETE","lineNumber":445,"oldContent":"  // Save user data to Firestore"},{"type":"INSERT","lineNumber":446,"content":""},{"type":"INSERT","lineNumber":447,"content":"  // Save user data to Firestore"},{"type":"DELETE","lineNumber":448,"oldContent":"  // Send email verification to the user"},{"type":"DELETE","lineNumber":451,"oldContent":"  Future<void> _sendEmailVerification(User user) async {"},{"type":"DELETE","lineNumber":453,"oldContent":"    try {"},{"type":"DELETE","lineNumber":455,"oldContent":"      await user.sendEmailVerification();"},{"type":"DELETE","lineNumber":457,"oldContent":"      print('Email verification sent to ${user.email}');"},{"type":"DELETE","lineNumber":459,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":461,"oldContent":"      print('Error sending email verification: $e');"},{"type":"DELETE","lineNumber":463,"oldContent":"  Future<bool> signOutUser() async {"},{"type":"DELETE","lineNumber":465,"oldContent":"    try {"},{"type":"DELETE","lineNumber":468,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":470,"oldContent":"      final result = await signOut(NoParams());"},{"type":"DELETE","lineNumber":473,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":475,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":478,"oldContent":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":467,"content":"  // Send email verification to the user"},{"type":"INSERT","lineNumber":468,"content":"  Future<void> _sendEmailVerification(User user) async {"},{"type":"INSERT","lineNumber":469,"content":"    try {"},{"type":"INSERT","lineNumber":470,"content":"      await user.sendEmailVerification();"},{"type":"INSERT","lineNumber":471,"content":"      print('Email verification sent to ${user.email}');"},{"type":"INSERT","lineNumber":472,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":473,"content":"      print('Error sending email verification: $e');"},{"type":"INSERT","lineNumber":474,"content":"      // Continue even if email verification fails"},{"type":"INSERT","lineNumber":475,"content":"    }"},{"type":"INSERT","lineNumber":476,"content":"  }"},{"type":"INSERT","lineNumber":477,"content":""},{"type":"INSERT","lineNumber":478,"content":"  // Sign out"},{"type":"INSERT","lineNumber":479,"content":"  Future<bool> signOutUser() async {"},{"type":"INSERT","lineNumber":480,"content":"    try {"},{"type":"INSERT","lineNumber":481,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":482,"content":"      final result = await signOut(NoParams());"},{"type":"INSERT","lineNumber":483,"content":"      return result.fold("},{"type":"INSERT","lineNumber":484,"content":"        (failure) {"},{"type":"INSERT","lineNumber":485,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":486,"oldContent":"      // Continue even if email verification fails"},{"type":"DELETE","lineNumber":488,"oldContent":"    }"},{"type":"DELETE","lineNumber":490,"oldContent":"  }"},{"type":"DELETE","lineNumber":492,"oldContent":""},{"type":"DELETE","lineNumber":494,"oldContent":"  // Sign out"},{"type":"INSERT","lineNumber":504,"content":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"INSERT","lineNumber":505,"content":"    try {"},{"type":"INSERT","lineNumber":506,"content":"      setLoading(true);"},{"type":"INSERT","lineNumber":507,"content":"      final result = await sendPasswordResetEmail("},{"type":"INSERT","lineNumber":508,"content":"        SendPasswordResetEmailParams(email: email),"},{"type":"INSERT","lineNumber":509,"content":"      );"},{"type":"DELETE","lineNumber":514,"oldContent":"  Future<bool> sendPasswordResetEmailTo(String email) async {"},{"type":"DELETE","lineNumber":516,"oldContent":"    try {"},{"type":"INSERT","lineNumber":522,"content":"      return false;"},{"type":"DELETE","lineNumber":518,"oldContent":"      setLoading(true);"},{"type":"DELETE","lineNumber":520,"oldContent":"      final result = await sendPasswordResetEmail("},{"type":"DELETE","lineNumber":522,"oldContent":"        SendPasswordResetEmailParams(email: email),"},{"type":"DELETE","lineNumber":524,"oldContent":"      );"},{"type":"INSERT","lineNumber":528,"content":"  // Delete account"},{"type":"DELETE","lineNumber":537,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":543,"oldContent":"  // Delete account"},{"type":"INSERT","lineNumber":546,"content":"      setError(message: 'Failed to delete account: $e');"},{"type":"INSERT","lineNumber":555,"content":"    _hasError = hasError;"},{"type":"INSERT","lineNumber":559,"content":"  "},{"type":"INSERT","lineNumber":561,"content":"    _hasError = false;"},{"type":"DELETE","lineNumber":559,"oldContent":"      setError(message: 'Failed to delete account: $e');"},{"type":"DELETE","lineNumber":564,"oldContent":"    _hasError = true;"},{"type":"INSERT","lineNumber":568,"content":"    _verificationId = null;"},{"type":"INSERT","lineNumber":569,"content":"    clearError();"},{"type":"DELETE","lineNumber":566,"oldContent":"  }"},{"type":"DELETE","lineNumber":569,"oldContent":"    _hasError = hasError;"},{"type":"DELETE","lineNumber":574,"oldContent":"  "},{"type":"DELETE","lineNumber":576,"oldContent":"    _hasError = false;"}]},{"timestamp":1754616008799,"changes":[{"type":"INSERT","lineNumber":188,"content":"              resetError();"},{"type":"DELETE","lineNumber":190,"oldContent":"              "},{"type":"DELETE","lineNumber":191,"oldContent":"              resetError();"},{"type":"DELETE","lineNumber":192,"oldContent":"              return true;"},{"type":"DELETE","lineNumber":193,"oldContent":"      );"},{"type":"INSERT","lineNumber":192,"content":"              print('Current user is null after registration');"},{"type":"DELETE","lineNumber":199,"oldContent":"            print('Error after registration: $e');"},{"type":"DELETE","lineNumber":200,"oldContent":"            setError(message: 'Registration completed but failed to initialize user session');"},{"type":"INSERT","lineNumber":197,"content":"            print('Error after registration:');"},{"type":"INSERT","lineNumber":198,"content":"            print(e);"},{"type":"INSERT","lineNumber":199,"content":"            print(stackTrace);"},{"type":"INSERT","lineNumber":200,"content":"            setError(message: 'An error occurred during registration. Please try again.');"},{"type":"INSERT","lineNumber":202,"content":"            setError(message: 'Registration completed but failed to initialize user session');"},{"type":"DELETE","lineNumber":215,"oldContent":"          verificationId: _verificationId!,"},{"type":"INSERT","lineNumber":216,"content":"  }"},{"type":"DELETE","lineNumber":217,"oldContent":"    try {"},{"type":"INSERT","lineNumber":220,"content":"    try {"},{"type":"DELETE","lineNumber":224,"oldContent":"          return false;"},{"type":"INSERT","lineNumber":226,"content":"          return false;"},{"type":"DELETE","lineNumber":228,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":230,"oldContent":"        },"},{"type":"INSERT","lineNumber":231,"content":"          return true;"},{"type":"INSERT","lineNumber":232,"content":"        },"},{"type":"DELETE","lineNumber":234,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":236,"content":"      return false;"},{"type":"DELETE","lineNumber":240,"oldContent":"    try {"},{"type":"MODIFY","lineNumber":241,"content":"","oldContent":"      final result = await signOut(NoParams());"},{"type":"INSERT","lineNumber":242,"content":"  // Sign in with Apple"},{"type":"DELETE","lineNumber":307,"oldContent":"      setLoading(false);"},{"type":"INSERT","lineNumber":308,"content":""},{"type":"DELETE","lineNumber":445,"oldContent":""},{"type":"INSERT","lineNumber":447,"content":""},{"type":"DELETE","lineNumber":459,"oldContent":"  // Send email verification to the user"},{"type":"INSERT","lineNumber":461,"content":"      print('User data saved to Firestore');"},{"type":"INSERT","lineNumber":462,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":463,"content":"      print('Error saving user data to Firestore: $e');"},{"type":"INSERT","lineNumber":464,"content":"      rethrow;"},{"type":"INSERT","lineNumber":465,"content":"    }"},{"type":"INSERT","lineNumber":466,"content":"  }"},{"type":"INSERT","lineNumber":467,"content":""},{"type":"INSERT","lineNumber":468,"content":"  // Send email verification to the user"},{"type":"DELETE","lineNumber":463,"oldContent":"      print('User data saved to Firestore');"},{"type":"DELETE","lineNumber":467,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":468,"oldContent":"      print('Error saving user data to Firestore: $e');"},{"type":"DELETE","lineNumber":471,"oldContent":"      rethrow;"},{"type":"DELETE","lineNumber":474,"oldContent":"    }"},{"type":"DELETE","lineNumber":476,"oldContent":"  }"},{"type":"DELETE","lineNumber":479,"oldContent":""},{"type":"DELETE","lineNumber":481,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":483,"oldContent":"        },"},{"type":"DELETE","lineNumber":485,"oldContent":"        (_) {"},{"type":"DELETE","lineNumber":487,"oldContent":"          _currentUser = null;"},{"type":"DELETE","lineNumber":489,"oldContent":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"INSERT","lineNumber":487,"content":"          return false;"},{"type":"INSERT","lineNumber":488,"content":"        },"},{"type":"INSERT","lineNumber":489,"content":"        (_) {"},{"type":"INSERT","lineNumber":490,"content":"          _currentUser = null;"},{"type":"INSERT","lineNumber":491,"content":"          _verificationId = null; // Clear any verification ID on sign out"},{"type":"DELETE","lineNumber":504,"oldContent":"      return result.fold("},{"type":"DELETE","lineNumber":506,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":508,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":510,"oldContent":"          return false;"},{"type":"DELETE","lineNumber":512,"oldContent":"        },"},{"type":"DELETE","lineNumber":514,"oldContent":"        (_) {"},{"type":"INSERT","lineNumber":511,"content":"      return result.fold("},{"type":"INSERT","lineNumber":512,"content":"        (failure) {"},{"type":"INSERT","lineNumber":513,"content":"          setError(message: failure.message);"},{"type":"INSERT","lineNumber":514,"content":"          return false;"},{"type":"INSERT","lineNumber":515,"content":"        },"},{"type":"INSERT","lineNumber":516,"content":"        (_) {"},{"type":"INSERT","lineNumber":523,"content":"      return false;"},{"type":"DELETE","lineNumber":525,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":529,"content":"  // Delete account"},{"type":"DELETE","lineNumber":530,"oldContent":"  // Delete account"},{"type":"DELETE","lineNumber":546,"oldContent":"      return false;"},{"type":"INSERT","lineNumber":548,"content":"      return false;"},{"type":"INSERT","lineNumber":556,"content":"    _hasError = hasError;"},{"type":"DELETE","lineNumber":557,"oldContent":"    _hasError = hasError;"},{"type":"INSERT","lineNumber":560,"content":"  "},{"type":"INSERT","lineNumber":562,"content":"    _hasError = false;"},{"type":"DELETE","lineNumber":562,"oldContent":"  "},{"type":"DELETE","lineNumber":564,"oldContent":"    _hasError = false;"},{"type":"DELETE","lineNumber":566,"oldContent":"    _hasError = true;"},{"type":"INSERT","lineNumber":567,"content":"  void resetVerificationState() {"},{"type":"INSERT","lineNumber":568,"content":"    _isOtpVerified = false;"},{"type":"INSERT","lineNumber":569,"content":"    _verificationId = null;"},{"type":"INSERT","lineNumber":570,"content":"    clearError();"},{"type":"DELETE","lineNumber":568,"oldContent":"  void clearError() {"},{"type":"DELETE","lineNumber":570,"oldContent":"    _verificationId = null;"},{"type":"DELETE","lineNumber":572,"oldContent":"    clearError();"}]},{"timestamp":1754616039780,"changes":[{"type":"MODIFY","lineNumber":131,"content":"      ","oldContent":"    try {"},{"type":"DELETE","lineNumber":139,"oldContent":"      final result = await registerWithEmailAndPassword("},{"type":"DELETE","lineNumber":140,"oldContent":"        RegisterWithEmailAndPasswordParams("},{"type":"DELETE","lineNumber":141,"oldContent":"          email: email.trim(),"},{"type":"DELETE","lineNumber":142,"oldContent":"          password: password,"},{"type":"DELETE","lineNumber":143,"oldContent":"          displayName: name.trim(),"},{"type":"DELETE","lineNumber":144,"oldContent":"          phoneNumber: formattedPhone,"},{"type":"DELETE","lineNumber":145,"oldContent":"        ),"},{"type":"DELETE","lineNumber":146,"oldContent":"      );"},{"type":"DELETE","lineNumber":147,"oldContent":"      "},{"type":"DELETE","lineNumber":148,"oldContent":"      return await result.fold("},{"type":"INSERT","lineNumber":139,"content":"      try {"},{"type":"INSERT","lineNumber":140,"content":"        final result = await registerWithEmailAndPassword("},{"type":"INSERT","lineNumber":141,"content":"          RegisterWithEmailAndPasswordParams("},{"type":"INSERT","lineNumber":142,"content":"            email: email.trim(),"},{"type":"INSERT","lineNumber":143,"content":"            password: password,"},{"type":"INSERT","lineNumber":144,"content":"            displayName: name.trim(),"},{"type":"INSERT","lineNumber":145,"content":"            phoneNumber: formattedPhone,"},{"type":"INSERT","lineNumber":146,"content":"          ),"},{"type":"INSERT","lineNumber":147,"content":"        );"},{"type":"INSERT","lineNumber":148,"content":"        "},{"type":"INSERT","lineNumber":149,"content":"        return await result.fold("},{"type":"DELETE","lineNumber":191,"oldContent":"              print('Current user is null after registration');"},{"type":"INSERT","lineNumber":193,"content":"              print('Current user is null after registration');"},{"type":"INSERT","lineNumber":196,"content":"            }"},{"type":"INSERT","lineNumber":197,"content":"          } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":196,"oldContent":"      setError('Failed to send OTP');"},{"type":"DELETE","lineNumber":198,"oldContent":"          } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":200,"content":"            print('Stack trace:');"},{"type":"DELETE","lineNumber":200,"oldContent":"            setError(message: 'An error occurred during registration. Please try again.');"},{"type":"DELETE","lineNumber":201,"oldContent":"            print('Stack trace: $stackTrace');"},{"type":"MODIFY","lineNumber":202,"content":"            setError(message: 'Registration completed but failed to initialize user session. Please try logging in.');","oldContent":"            setError(message: 'Registration completed but failed to initialize user session');"},{"type":"MODIFY","lineNumber":231,"content":"          return true;","oldContent":"          return true;"},{"type":"MODIFY","lineNumber":332,"content":"      );","oldContent":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":462,"oldContent":"  Future<void> _sendEmailVerification(User user) async {"},{"type":"DELETE","lineNumber":464,"oldContent":"    try {"},{"type":"DELETE","lineNumber":467,"oldContent":"      await user.sendEmailVerification();"},{"type":"DELETE","lineNumber":469,"oldContent":"      print('Email verification sent to ${user.email}');"},{"type":"DELETE","lineNumber":471,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":469,"content":"  Future<void> _sendEmailVerification(User user) async {"},{"type":"INSERT","lineNumber":470,"content":"    try {"},{"type":"INSERT","lineNumber":471,"content":"      await user.sendEmailVerification();"},{"type":"INSERT","lineNumber":472,"content":"      print('Email verification sent to ${user.email}');"},{"type":"INSERT","lineNumber":473,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":485,"content":"        (failure) {"},{"type":"INSERT","lineNumber":486,"content":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":487,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":490,"oldContent":"          setError(message: failure.message);"},{"type":"DELETE","lineNumber":508,"oldContent":"      return result.fold("},{"type":"INSERT","lineNumber":509,"content":"        SendPasswordResetEmailParams(email: email),"},{"type":"INSERT","lineNumber":510,"content":"      );"},{"type":"INSERT","lineNumber":511,"content":"      return result.fold("},{"type":"DELETE","lineNumber":512,"oldContent":"        SendPasswordResetEmailParams(email: email),"},{"type":"DELETE","lineNumber":515,"oldContent":"      );"},{"type":"MODIFY","lineNumber":524,"content":"    } finally {","oldContent":"    } finally {"},{"type":"MODIFY","lineNumber":530,"content":"  Future<bool> deleteUserAccount() async {","oldContent":"  Future<bool> deleteUserAccount() async {"},{"type":"MODIFY","lineNumber":557,"content":"    _errorMessage = message;","oldContent":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":560,"oldContent":"  void clearError() {"},{"type":"DELETE","lineNumber":562,"oldContent":"    _hasError = true;"},{"type":"DELETE","lineNumber":563,"oldContent":"  }"},{"type":"INSERT","lineNumber":561,"content":"  void clearError() {"},{"type":"INSERT","lineNumber":563,"content":"    _errorMessage = null;"},{"type":"INSERT","lineNumber":564,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":565,"content":"  }"},{"type":"DELETE","lineNumber":566,"oldContent":"  "},{"type":"DELETE","lineNumber":568,"oldContent":""},{"type":"MODIFY","lineNumber":571,"content":"  }","oldContent":"  "},{"type":"INSERT","lineNumber":572,"content":"  "},{"type":"INSERT","lineNumber":576,"content":"  }"},{"type":"INSERT","lineNumber":577,"content":"}"},{"type":"DELETE","lineNumber":577,"oldContent":"  void setErrorSilently({String? message}) {"},{"type":"DELETE","lineNumber":578,"oldContent":"    _hasError = false;"}]},{"timestamp":1754616055051,"changes":[{"type":"MODIFY","lineNumber":150,"content":"          (failure) async {","oldContent":"        (failure) async {"},{"type":"DELETE","lineNumber":195,"oldContent":"      setError('Failed to send OTP');"},{"type":"DELETE","lineNumber":196,"oldContent":"            print('Error after registration:');"},{"type":"INSERT","lineNumber":195,"content":"              return false;"},{"type":"INSERT","lineNumber":198,"content":"            print('Error after registration:');"},{"type":"MODIFY","lineNumber":201,"content":"            print(stackTrace);","oldContent":"            print(stackTrace);"},{"type":"INSERT","lineNumber":207,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":208,"content":"        print('Unexpected error during registration:');"},{"type":"INSERT","lineNumber":209,"content":"        print(e);"},{"type":"INSERT","lineNumber":210,"content":"        print('Stack trace:');"},{"type":"INSERT","lineNumber":211,"content":"        print(stackTrace);"},{"type":"INSERT","lineNumber":212,"content":"        setError(message: 'An unexpected error occurred during registration. Please try again.');"},{"type":"INSERT","lineNumber":213,"content":"        return false;"},{"type":"INSERT","lineNumber":214,"content":"      }"},{"type":"INSERT","lineNumber":238,"content":"          resetError();"},{"type":"DELETE","lineNumber":231,"oldContent":"          return true;"},{"type":"DELETE","lineNumber":240,"oldContent":"    try {"},{"type":"INSERT","lineNumber":248,"content":"  }"},{"type":"INSERT","lineNumber":474,"content":"  }"},{"type":"INSERT","lineNumber":475,"content":""},{"type":"INSERT","lineNumber":476,"content":"  // Send email verification to the user"},{"type":"DELETE","lineNumber":468,"oldContent":"  }"},{"type":"DELETE","lineNumber":471,"oldContent":""},{"type":"DELETE","lineNumber":473,"oldContent":"  // Send email verification to the user"},{"type":"DELETE","lineNumber":486,"oldContent":"          return false;"},{"type":"INSERT","lineNumber":495,"content":"          return false;"},{"type":"DELETE","lineNumber":508,"oldContent":"        SendPasswordResetEmailParams(email: email),"},{"type":"INSERT","lineNumber":517,"content":"        SendPasswordResetEmailParams(email: email),"},{"type":"DELETE","lineNumber":511,"oldContent":"        (failure) {"},{"type":"INSERT","lineNumber":520,"content":"        (failure) {"},{"type":"INSERT","lineNumber":531,"content":"      return false;"},{"type":"DELETE","lineNumber":524,"oldContent":"    } finally {"},{"type":"INSERT","lineNumber":537,"content":"  // Delete account"},{"type":"DELETE","lineNumber":530,"oldContent":"  Future<bool> deleteUserAccount() async {"},{"type":"INSERT","lineNumber":564,"content":"    _hasError = hasError;"},{"type":"DELETE","lineNumber":557,"oldContent":"    _errorMessage = message;"},{"type":"DELETE","lineNumber":560,"oldContent":"  void clearError() {"},{"type":"INSERT","lineNumber":569,"content":"  void clearError() {"},{"type":"INSERT","lineNumber":570,"content":"    _hasError = false;"},{"type":"DELETE","lineNumber":564,"oldContent":"    _hasError = false;"},{"type":"DELETE","lineNumber":566,"oldContent":"  }"},{"type":"INSERT","lineNumber":574,"content":"  "},{"type":"INSERT","lineNumber":578,"content":"    clearError();"},{"type":"DELETE","lineNumber":572,"oldContent":"    clearError();"},{"type":"DELETE","lineNumber":577,"oldContent":""},{"type":"INSERT","lineNumber":586,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/utils/shared_prefs_manager.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/utils/shared_prefs_manager.dart","baseContent":"import 'package:shared_preferences/shared_preferences.dart';\n\n/// A service class to handle all shared preferences operations\nclass SharedPrefsManager {\n  static SharedPrefsManager? _instance;\n  static SharedPreferences? _prefs;\n\n  // Private constructor\n  SharedPrefsManager._();\n\n  // Factory constructor to return the same instance (singleton)\n  factory SharedPrefsManager() {\n    _instance ??= SharedPrefsManager._();\n    return _instance!;\n  }\n\n  /// Initialize SharedPreferences\n  static Future<void> init() async {\n    _prefs = await SharedPreferences.getInstance();\n  }\n\n  // Generic getter with proper type handling\n  T _getValue<T>(String key, T defaultValue) {\n    if (_prefs == null) return defaultValue;\n    \n    try {\n      switch (T) {\n        case String:\n          final value = _prefs!.getString(key) as T?;\n          return value ?? defaultValue;\n        case int:\n          final value = _prefs!.getInt(key) as T?;\n          return value ?? defaultValue;\n        case bool:\n          final value = _prefs!.getBool(key) as T?;\n          return value ?? defaultValue;\n        case double:\n          final value = _prefs!.getDouble(key) as T?;\n          return value ?? defaultValue;\n        case const (List<String>):\n          final value = _prefs!.getStringList(key) as T?;\n          return value ?? defaultValue;\n        default:\n          return defaultValue;\n      }\n    } catch (e) {\n      return defaultValue;\n    }\n  }\n\n  // Generic setter with proper type checking\n  Future<bool> _setValue<T>(String key, T value) async {\n    if (_prefs == null) return false;\n    \n    try {\n      if (T == String && value is String) {\n        return await _prefs!.setString(key, value);\n      } else if (T == int && value is int) {\n        return await _prefs!.setInt(key, value);\n      } else if (T == bool && value is bool) {\n        return await _prefs!.setBool(key, value);\n      } else if (T == double && value is double) {\n        return await _prefs!.setDouble(key, value);\n      } else if (T == List<String> && value is List<String>) {\n        return await _prefs!.setStringList(key, value);\n      } else {\n        return false;\n      }\n    } catch (e) {\n      return false;\n    }\n  }\n\n  // Auth related methods with proper null safety\n  Future<bool> setAccessToken(String token) => _setValue<String>('access_token', token);\n  String get accessToken => _getValue<String>('access_token', '');\n\n  Future<bool> setRefreshToken(String token) => _setValue<String>('refresh_token', token);\n  String get refreshToken => _getValue<String>('refresh_token', '');\n\n  Future<bool> setUserId(String userId) => _setValue<String>('user_id', userId);\n  String get userId => _getValue<String>('user_id', '');\n\n  Future<bool> setUserEmail(String email) => _setValue<String>('user_email', email);\n  String get userEmail => _getValue<String>('user_email', '');\n\n  Future<bool> setUserName(String name) => _setValue<String>('user_name', name);\n  String get userName => _getValue<String>('user_name', '');\n\n  Future<bool> setUserPhone(String phone) => _setValue<String>('user_phone', phone);\n  String get userPhone => _getValue<String>('user_phone', '');\n\n  Future<bool> setUserProfilePic(String url) => _setValue<String>('user_profile_pic', url);\n  String get userProfilePic => _getValue<String>('user_profile_pic', '');\n\n  // App settings\n  Future<bool> setDarkMode(bool isDark) => _setValue<bool>('is_dark_mode', isDark);\n  bool get isDarkMode => _getValue<bool>('is_dark_mode', false);\n\n  Future<bool> setFirstLaunch(bool isFirstLaunch) => _setValue<bool>('is_first_launch', isFirstLaunch);\n  bool get isFirstLaunch => _getValue<bool>('is_first_launch', true);\n\n  // Family related\n  Future<bool> setFamilyId(String familyId) => _setValue<String>('family_id', familyId);\n  String get familyId => _getValue<String>('family_id', '');\n\n  Future<bool> setFamilyName(String name) => _setValue<String>('family_name', name);\n  String get familyName => _getValue<String>('family_name', '');\n\n  // Clear all data (logout)\n  Future<bool> clearAll() async {\n    if (_prefs == null) return false;\n    return await _prefs!.clear();\n  }\n\n  // Clear specific data\n  Future<bool> clearKey(String key) async {\n    if (_prefs == null) return false;\n    return await _prefs!.remove(key);\n  }\n}\n","baseTimestamp":1754479582933,"deltas":[{"timestamp":1754481995705,"changes":[{"type":"MODIFY","lineNumber":109,"content":"  /// Clear all data in shared preferences","oldContent":"  // Clear all data (logout)"},{"type":"DELETE","lineNumber":111,"oldContent":"    if (_prefs == null) return false;"},{"type":"DELETE","lineNumber":112,"oldContent":"    return await _prefs!.clear();"},{"type":"INSERT","lineNumber":111,"content":"    try {"},{"type":"INSERT","lineNumber":112,"content":"      return await _prefs!.clear();"},{"type":"INSERT","lineNumber":113,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":114,"content":"      return false;"},{"type":"INSERT","lineNumber":115,"content":"    }"},{"type":"DELETE","lineNumber":118,"oldContent":"    return await _prefs!.remove(key);"},{"type":"INSERT","lineNumber":121,"content":"    try {"},{"type":"INSERT","lineNumber":122,"content":"      return await _prefs!.remove(key);"},{"type":"INSERT","lineNumber":123,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":124,"content":"      return false;"},{"type":"INSERT","lineNumber":125,"content":"    }"}]},{"timestamp":1754511904499,"changes":[{"type":"MODIFY","lineNumber":55,"content":"      if (value is String) {","oldContent":"      if (T == String && value is String) {"},{"type":"MODIFY","lineNumber":57,"content":"      } else if (value is int) {","oldContent":"      } else if (T == int && value is int) {"},{"type":"MODIFY","lineNumber":59,"content":"      } else if (value is bool) {","oldContent":"      } else if (T == bool && value is bool) {"},{"type":"MODIFY","lineNumber":61,"content":"      } else if (value is double) {","oldContent":"      } else if (T == double && value is double) {"},{"type":"MODIFY","lineNumber":63,"content":"      } else if (value is List<String>) {","oldContent":"      } else if (T == List<String> && value is List<String>) {"},{"type":"DELETE","lineNumber":114,"oldContent":"  }"},{"type":"MODIFY","lineNumber":116,"content":"  }","oldContent":""},{"type":"INSERT","lineNumber":117,"content":""},{"type":"DELETE","lineNumber":121,"oldContent":"  }"},{"type":"DELETE","lineNumber":122,"oldContent":"}"},{"type":"DELETE","lineNumber":124,"oldContent":""},{"type":"MODIFY","lineNumber":125,"content":"    }","oldContent":"    }"},{"type":"INSERT","lineNumber":126,"content":"  }"},{"type":"INSERT","lineNumber":127,"content":"}"},{"type":"INSERT","lineNumber":128,"content":""}]},{"timestamp":1754511947881,"changes":[{"type":"DELETE","lineNumber":26,"oldContent":"      switch (T) {"},{"type":"DELETE","lineNumber":27,"oldContent":"        case String:"},{"type":"DELETE","lineNumber":28,"oldContent":"          final value = _prefs!.getString(key) as T?;"},{"type":"DELETE","lineNumber":29,"oldContent":"          return value ?? defaultValue;"},{"type":"DELETE","lineNumber":30,"oldContent":"        case int:"},{"type":"DELETE","lineNumber":31,"oldContent":"          final value = _prefs!.getInt(key) as T?;"},{"type":"DELETE","lineNumber":32,"oldContent":"          return value ?? defaultValue;"},{"type":"DELETE","lineNumber":33,"oldContent":"        case bool:"},{"type":"DELETE","lineNumber":34,"oldContent":"          final value = _prefs!.getBool(key) as T?;"},{"type":"DELETE","lineNumber":35,"oldContent":"          return value ?? defaultValue;"},{"type":"DELETE","lineNumber":36,"oldContent":"        case double:"},{"type":"DELETE","lineNumber":37,"oldContent":"          final value = _prefs!.getDouble(key) as T?;"},{"type":"DELETE","lineNumber":38,"oldContent":"          return value ?? defaultValue;"},{"type":"DELETE","lineNumber":39,"oldContent":"        case const (List<String>):"},{"type":"DELETE","lineNumber":40,"oldContent":"          final value = _prefs!.getStringList(key) as T?;"},{"type":"DELETE","lineNumber":41,"oldContent":"          return value ?? defaultValue;"},{"type":"DELETE","lineNumber":42,"oldContent":"        default:"},{"type":"DELETE","lineNumber":43,"oldContent":"          return defaultValue;"},{"type":"INSERT","lineNumber":26,"content":"      if (T == String) {"},{"type":"INSERT","lineNumber":27,"content":"        return (_prefs!.getString(key) as T?) ?? defaultValue;"},{"type":"INSERT","lineNumber":28,"content":"      } else if (T == int) {"},{"type":"INSERT","lineNumber":29,"content":"        return (_prefs!.getInt(key) as T?) ?? defaultValue;"},{"type":"INSERT","lineNumber":30,"content":"      } else if (T == bool) {"},{"type":"INSERT","lineNumber":31,"content":"        return (_prefs!.getBool(key) as T?) ?? defaultValue;"},{"type":"INSERT","lineNumber":32,"content":"      } else if (T == double) {"},{"type":"INSERT","lineNumber":33,"content":"        return (_prefs!.getDouble(key) as T?) ?? defaultValue;"},{"type":"INSERT","lineNumber":34,"content":"      } else if (T == List<String>) {"},{"type":"INSERT","lineNumber":35,"content":"        return (_prefs!.getStringList(key) as T?) ?? defaultValue;"},{"type":"INSERT","lineNumber":36,"content":"      } else {"},{"type":"INSERT","lineNumber":37,"content":"        return defaultValue;"},{"type":"INSERT","lineNumber":109,"content":"    }"},{"type":"DELETE","lineNumber":117,"oldContent":"    }"},{"type":"INSERT","lineNumber":116,"content":"      return await _prefs!.remove(key);"},{"type":"INSERT","lineNumber":117,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":118,"content":"      return false;"},{"type":"DELETE","lineNumber":124,"oldContent":"    }"},{"type":"DELETE","lineNumber":126,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":128,"oldContent":"      return false;"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/utils/navigation_service.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/utils/navigation_service.dart","baseContent":"import 'package:flutter/material.dart';\n\n/// A service that handles navigation between screens in the app.\n///\n/// This service provides a global [GlobalKey] for the [NavigatorState] and\n/// helper methods to navigate between screens.\nclass NavigationService {\n  static final NavigationService _instance = NavigationService._internal();\n  \n  /// The global key for the navigator\n  final GlobalKey<NavigatorState> navigatorKey = GlobalKey<NavigatorState>();\n\n  /// Private constructor for the singleton pattern\n  NavigationService();\n\n  /// Get the current [BuildContext]\n  BuildContext? get currentContext => navigatorKey.currentContext;\n\n  /// Get the current [NavigatorState]\n  NavigatorState? get _navigator => navigatorKey.currentState;\n\n  /// Navigate to a named route\n  ///\n  /// [routeName] The name of the route to navigate to\n  /// [arguments] Optional arguments to pass to the route\n  /// Returns a [Future] that completes when the pushed route is popped\n  Future<T?> navigateTo<T extends Object?>(String routeName, {Object? arguments}) {\n    if (_navigator == null) {\n      return Future.value(null);\n    }\n    return _navigator!.pushNamed<T>(\n      routeName,\n      arguments: arguments,\n    );\n  }\n\n  /// Navigate to a named route and remove all previous routes\n  ///\n  /// [routeName] The name of the route to navigate to\n  /// [arguments] Optional arguments to pass to the route\n  /// [predicate] Optional predicate to determine which routes to remove\n  /// Returns a [Future] that completes when the pushed route is popped\n  Future<T?> navigateToAndRemoveUntil<T extends Object?>(\n    String routeName, {\n    Object? arguments,\n    bool Function(Route<dynamic>)? predicate,\n  }) {\n    if (_navigator == null) {\n      return Future.value(null);\n    }\n    return _navigator!.pushNamedAndRemoveUntil<T>(\n      routeName,\n      predicate ?? (route) => false,\n      arguments: arguments,\n    );\n  }\n\n  /// Navigate to a named route and remove the current route\n  ///\n  /// [routeName] The name of the route to navigate to\n  /// [arguments] Optional arguments to pass to the route\n  /// [result] Optional result to return when the previous route is popped\n  /// Returns a [Future] that completes when the pushed route is popped\n  Future<T?> navigateToAndReplace<T extends Object?, TO extends Object?>(\n    String routeName, {\n    Object? arguments,\n    TO? result,\n  }) {\n    if (_navigator == null) {\n      return Future.value(null);\n    }\n    return _navigator!.pushReplacementNamed<T, TO>(\n      routeName,\n      arguments: arguments,\n      result: result,\n    );\n  }\n\n  /// Go back to the previous screen\n  void goBack<T extends Object?>([T? result]) {\n    if (_navigator?.canPop() ?? false) {\n      _navigator?.pop<T>(result);\n    }\n  }\n\n  /// Show a dialog with the given widget\n  ///\n  /// [builder] A builder that returns the dialog widget\n  /// [barrierDismissible] Whether the dialog can be dismissed by tapping outside\n  /// [barrierColor] The color of the barrier\n  /// [useSafeArea] Whether to wrap the dialog in a SafeArea\n  /// [useRootNavigator] Whether to use the root navigator\n  /// [routeSettings] Optional route settings\n  /// Returns a [Future] that resolves when the dialog is dismissed\n  Future<T?> showDialog<T>({\n    required WidgetBuilder builder,\n    bool barrierDismissible = true,\n    Color? barrierColor = Colors.black54,\n    bool useSafeArea = true,\n    bool useRootNavigator = true,\n    RouteSettings? routeSettings,\n  }) async {\n    final context = currentContext;\n    if (context == null) return null;\n    \n    return await showDialog<T>(\n      context: context,\n      builder: builder,\n      barrierDismissible: barrierDismissible,\n      barrierColor: barrierColor,\n      useSafeArea: useSafeArea,\n      useRootNavigator: useRootNavigator,\n      routeSettings: routeSettings,\n    );\n  }\n\n  /// Show a bottom sheet with the given widget\n  ///\n  /// [builder] A builder that returns the bottom sheet widget\n  /// [isScrollControlled] Whether the bottom sheet should take up the full screen height\n  /// [useRootNavigator] Whether to use the root navigator\n  /// [isDismissible] Whether the bottom sheet can be dismissed by swiping down\n  /// [enableDrag] Whether the bottom sheet can be dragged up and down\n  /// [backgroundColor] The background color of the bottom sheet\n  /// [elevation] The elevation of the bottom sheet\n  /// [shape] The shape of the bottom sheet\n  /// [clipBehavior] The clip behavior of the bottom sheet\n  /// [constraints] Optional constraints for the bottom sheet\n  /// [routeSettings] Optional route settings\n  /// Returns a [Future] that resolves when the bottom sheet is dismissed\n  Future<T?> showBottomSheet<T>({\n    required WidgetBuilder builder,\n    bool isScrollControlled = false,\n    bool useRootNavigator = false,\n    bool isDismissible = true,\n    bool enableDrag = true,\n    Color? backgroundColor,\n    double? elevation,\n    ShapeBorder? shape,\n    Clip? clipBehavior = Clip.none,\n    BoxConstraints? constraints,\n    RouteSettings? routeSettings,\n  }) async {\n    final context = currentContext;\n    if (context == null) return null;\n    \n    return await showModalBottomSheet<T>(\n      context: context,\n      builder: builder,\n      isScrollControlled: isScrollControlled,\n      useRootNavigator: useRootNavigator,\n      isDismissible: isDismissible,\n      enableDrag: enableDrag,\n      backgroundColor: backgroundColor,\n      elevation: elevation,\n      shape: shape,\n      clipBehavior: clipBehavior,\n      constraints: constraints,\n      routeSettings: routeSettings,\n    );\n  }\n\n  /// Show a snackbar with the given message\n  void showSnackBar({\n    required String message,\n    Duration duration = const Duration(seconds: 4),\n    SnackBarAction? action,\n    SnackBarBehavior behavior = SnackBarBehavior.fixed,\n    DismissDirection dismissDirection = DismissDirection.down,\n    EdgeInsetsGeometry? margin,\n    EdgeInsetsGeometry? padding,\n    double? width,\n    ShapeBorder? shape,\n    Color? backgroundColor,\n    double? elevation,\n    double? actionOverflowThreshold,\n    Color? closeIconColor,\n    bool? showCloseIcon,\n    VoidCallback? onVisible,\n  }) {\n    final context = currentContext;\n    if (context == null) return;\n    \n    ScaffoldMessenger.of(context).showSnackBar(\n      SnackBar(\n        content: Text(message),\n        duration: duration,\n        action: action,\n        behavior: behavior,\n        dismissDirection: dismissDirection,\n        margin: margin,\n        padding: padding,\n        width: width,\n        shape: shape,\n        backgroundColor: backgroundColor,\n        elevation: elevation,\n        actionOverflowThreshold: actionOverflowThreshold,\n        closeIconColor: closeIconColor,\n        showCloseIcon: showCloseIcon,\n      ),\n    );\n  }\n}\n","baseTimestamp":1754479807311,"deltas":[{"timestamp":1754481915396,"changes":[{"type":"INSERT","lineNumber":12,"content":"  /// Factory constructor to return the same instance"},{"type":"INSERT","lineNumber":13,"content":"  factory NavigationService() => _instance;"},{"type":"INSERT","lineNumber":14,"content":"  "},{"type":"DELETE","lineNumber":13,"oldContent":"  NavigationService();"},{"type":"INSERT","lineNumber":16,"content":"  NavigationService._internal();"}]},{"timestamp":1754510936834,"changes":[{"type":"MODIFY","lineNumber":10,"content":"  static final GlobalKey<NavigatorState> navigatorKey = GlobalKey<NavigatorState>();","oldContent":"  final GlobalKey<NavigatorState> navigatorKey = GlobalKey<NavigatorState>();"},{"type":"DELETE","lineNumber":13,"oldContent":"  /// Private constructor for the singleton pattern"},{"type":"INSERT","lineNumber":15,"content":"  /// Private constructor for the singleton pattern"},{"type":"INSERT","lineNumber":16,"content":"  NavigationService._internal();"},{"type":"DELETE","lineNumber":18,"oldContent":"  NavigationService._internal();"}]},{"timestamp":1754511804045,"changes":[{"type":"MODIFY","lineNumber":15,"content":"  /// Private constructor for the singleton pattern","oldContent":"  /// Private constructor for the singleton pattern"},{"type":"MODIFY","lineNumber":103,"content":"    RouteSettings? routeSettings, required BuildContext context,","oldContent":"    RouteSettings? routeSettings,"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/domain/usecases/like_post.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/domain/usecases/like_post.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/usecases/usecase.dart';\n\nimport '../repositories/post_repository.dart';\n\nclass LikePost implements UseCase<Unit, LikePostParams> {\n  final PostRepository repository;\n\n  const LikePost(this.repository);\n\n  @override\n  Future<Either<Failure, Unit>> call(LikePostParams params) async {\n    return await repository.likePost(\n      postId: params.postId,\n      userId: params.userId,\n    );\n  }\n}\n\nclass LikePostParams {\n  final String postId;\n  final String userId;\n\n  const LikePostParams({\n    required this.postId,\n    required this.userId,\n  });\n}\n","baseTimestamp":1754480329758},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/domain/usecases/add_comment.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/domain/usecases/add_comment.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/home/domain/entities/comment.dart';\n\nimport '../repositories/post_repository.dart';\n\nclass AddComment implements UseCase<Comment, AddCommentParams> {\n  final PostRepository repository;\n\n  const AddComment(this.repository);\n\n  @override\n  Future<Either<Failure, Comment>> call(AddCommentParams params) async {\n    return await repository.addComment(\n      postId: params.postId,\n      userId: params.userId,\n      content: params.content,\n      userName: params.userName,\n      userAvatar: params.userAvatar,\n    );\n  }\n}\n\nclass AddCommentParams {\n  final String postId;\n  final String userId;\n  final String content;\n  final String userName;\n  final String? userAvatar;\n\n  const AddCommentParams({\n    required this.postId,\n    required this.userId,\n    required this.content,\n    required this.userName,\n    this.userAvatar,\n  });\n}\n","baseTimestamp":1754480336932},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/presentation/viewmodels/home_viewmodel.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/presentation/viewmodels/home_viewmodel.dart","baseContent":"import 'dart:async';\nimport 'package:flutter/foundation.dart';\nimport 'package:family_tree_firebase/core/base/base_viewmodel.dart';\nimport 'package:family_tree_firebase/features/home/domain/models/post_model.dart';\nimport 'package:family_tree_firebase/features/home/domain/models/story_model.dart';\nimport 'package:family_tree_firebase/features/home/domain/usecases/get_posts.dart';\nimport 'package:family_tree_firebase/features/home/domain/usecases/get_stories.dart';\nimport 'package:family_tree_firebase/features/home/domain/usecases/like_post.dart';\nimport 'package:family_tree_firebase/features/home/domain/usecases/add_comment.dart';\n\nclass HomeViewModel extends BaseViewModel {\n  final GetPosts getPosts;\n  final GetStories getStories;\n  final LikePost likePostUseCase;\n  final AddComment addCommentUseCase;\n\n  List<PostModel> _posts = [];\n  List<StoryModel> _stories = [];\n  bool _isLoadingPosts = false;\n  bool _isLoadingStories = false;\n  String? _errorMessage;\n\n  List<PostModel> get posts => _posts;\n  List<StoryModel> get stories => _stories;\n  bool get isLoadingPosts => _isLoadingPosts;\n  bool get isLoadingStories => _isLoadingStories;\n  bool get hasError => _errorMessage != null;\n  String? get errorMessage => _errorMessage;\n\n  HomeViewModel({\n    required this.getPosts,\n    required this.getStories,\n    required this.likePostUseCase,\n    required this.addCommentUseCase,\n  });\n\n  Future<void> loadInitialData() async {\n    await Future.wait([\n      loadPosts(),\n      loadStories(),\n    ]);\n  }\n\n  Future<void> loadPosts() async {\n    _isLoadingPosts = true;\n    notifyListeners();\n\n    try {\n      final result = await getPosts(NoParams());\n      result.fold(\n        (failure) {\n          _errorMessage = failure.message;\n          _posts = [];\n        },\n        (posts) {\n          _posts = posts;\n          _errorMessage = null;\n        },\n      );\n    } catch (e) {\n      _errorMessage = 'Failed to load posts: $e';\n      _posts = [];\n    } finally {\n      _isLoadingPosts = false;\n      notifyListeners();\n    }\n  }\n\n  Future<void> loadStories() async {\n    _isLoadingStories = true;\n    notifyListeners();\n\n    try {\n      final result = await getStories(NoParams());\n      result.fold(\n        (failure) {\n          _errorMessage = failure.message;\n          _stories = [];\n        },\n        (stories) {\n          _stories = stories;\n          _errorMessage = null;\n        },\n      );\n    } catch (e) {\n      _errorMessage = 'Failed to load stories: $e';\n      _stories = [];\n    } finally {\n      _isLoadingStories = false;\n      notifyListeners();\n    }\n  }\n\n  Future<void> likePost(String postId) async {\n    try {\n      final result = await likePostUseCase(LikePostParams(postId: postId));\n      result.fold(\n        (failure) => _errorMessage = failure.message,\n        (success) {\n          final index = _posts.indexWhere((post) => post.id == postId);\n          if (index != -1) {\n            final post = _posts[index];\n            _posts[index] = post.copyWith(\n              isLiked: !post.isLiked,\n              likes: post.isLiked ? post.likes - 1 : post.likes + 1,\n            );\n            _errorMessage = null;\n            notifyListeners();\n          }\n        },\n      );\n    } catch (e) {\n      _errorMessage = 'Failed to like post: $e';\n      notifyListeners();\n    }\n  }\n\n  Future<void> addComment(String postId, String comment) async {\n    try {\n      final result = await addCommentUseCase(\n        AddCommentParams(postId: postId, comment: comment),\n      );\n      \n      result.fold(\n        (failure) => _errorMessage = failure.message,\n        (comment) {\n          final index = _posts.indexWhere((post) => post.id == postId);\n          if (index != -1) {\n            final post = _posts[index];\n            final updatedComments = List<Comment>.from(post.comments)..add(comment);\n            _posts[index] = post.copyWith(comments: updatedComments);\n            _errorMessage = null;\n            notifyListeners();\n          }\n        },\n      );\n    } catch (e) {\n      _errorMessage = 'Failed to add comment: $e';\n      notifyListeners();\n    }\n  }\n\n  String _mapFailureToMessage(Failure failure) {\n    // Map different failure types to user-friendly messages\n    return failure.toString();\n  }\n\n  void setCurrentUser(String userId) {\n    _currentUserId = userId;\n    notifyListeners();\n  }\n\n  @override\n  void dispose() {\n    // Clean up any resources if needed\n    _posts.clear();\n    _stories.clear();\n    super.dispose();\n  }\n}\n","baseTimestamp":1754480554344,"deltas":[{"timestamp":1754481847449,"changes":[{"type":"MODIFY","lineNumber":144,"content":"    if (failure is ServerFailure) {","oldContent":"    return failure.toString();"},{"type":"INSERT","lineNumber":145,"content":"      return failure.message ?? 'Server error occurred';"},{"type":"INSERT","lineNumber":146,"content":"    } else if (failure is NetworkFailure) {"},{"type":"INSERT","lineNumber":147,"content":"      return failure.message ?? 'Network error occurred';"},{"type":"INSERT","lineNumber":148,"content":"    } else if (failure is CacheFailure) {"},{"type":"INSERT","lineNumber":149,"content":"      return 'Cache error occurred';"},{"type":"INSERT","lineNumber":150,"content":"    } else {"},{"type":"INSERT","lineNumber":151,"content":"      return 'An unexpected error occurred';"},{"type":"INSERT","lineNumber":152,"content":"    }"},{"type":"INSERT","lineNumber":159,"content":"  "},{"type":"INSERT","lineNumber":160,"content":"  Future<void> loadInitialData() async {"},{"type":"INSERT","lineNumber":161,"content":"    await Future.wait(["},{"type":"INSERT","lineNumber":162,"content":"      loadPosts(),"},{"type":"INSERT","lineNumber":163,"content":"      loadStories(),"},{"type":"INSERT","lineNumber":164,"content":"    ]);"},{"type":"INSERT","lineNumber":165,"content":"  }"}]},{"timestamp":1754482719374,"changes":[{"type":"INSERT","lineNumber":21,"content":"  String? _currentUserId;"},{"type":"INSERT","lineNumber":27,"content":"  @override"},{"type":"INSERT","lineNumber":29,"content":"  @override"},{"type":"INSERT","lineNumber":31,"content":"  String? get currentUserId => _currentUserId;"},{"type":"DELETE","lineNumber":146,"oldContent":"  }"},{"type":"DELETE","lineNumber":148,"oldContent":""},{"type":"DELETE","lineNumber":150,"oldContent":"  void setCurrentUser(String userId) {"},{"type":"DELETE","lineNumber":152,"oldContent":"    _currentUserId = userId;"},{"type":"DELETE","lineNumber":154,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":156,"oldContent":"  }"},{"type":"DELETE","lineNumber":158,"oldContent":""},{"type":"INSERT","lineNumber":157,"content":"  }"},{"type":"INSERT","lineNumber":158,"content":""},{"type":"INSERT","lineNumber":159,"content":"  void setCurrentUser(String userId) {"},{"type":"INSERT","lineNumber":160,"content":"    _currentUserId = userId;"},{"type":"INSERT","lineNumber":161,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":162,"content":"  }"},{"type":"INSERT","lineNumber":163,"content":"  "},{"type":"INSERT","lineNumber":164,"content":"  Future<void> loadInitialData() async {"},{"type":"INSERT","lineNumber":165,"content":"    await Future.wait(["},{"type":"INSERT","lineNumber":166,"content":"      loadPosts(),"},{"type":"INSERT","lineNumber":167,"content":"      loadStories(),"},{"type":"INSERT","lineNumber":168,"content":"    ]);"},{"type":"INSERT","lineNumber":169,"content":"  }"},{"type":"INSERT","lineNumber":170,"content":""},{"type":"DELETE","lineNumber":167,"oldContent":"  "},{"type":"DELETE","lineNumber":169,"oldContent":"  Future<void> loadInitialData() async {"},{"type":"DELETE","lineNumber":171,"oldContent":"    await Future.wait(["},{"type":"DELETE","lineNumber":172,"oldContent":"  }"},{"type":"DELETE","lineNumber":173,"oldContent":"      loadPosts(),"},{"type":"DELETE","lineNumber":174,"oldContent":"    ]);"},{"type":"DELETE","lineNumber":175,"oldContent":"      loadStories(),"}]},{"timestamp":1754482735743,"changes":[{"type":"INSERT","lineNumber":27,"content":"  @override"},{"type":"INSERT","lineNumber":31,"content":"  String? get currentUserId => _currentUserId;"},{"type":"DELETE","lineNumber":31,"oldContent":"  @override"},{"type":"DELETE","lineNumber":34,"oldContent":"  String? get currentUserId => _currentUserId;"},{"type":"MODIFY","lineNumber":59,"content":"          _posts = posts.cast<PostModel>();","oldContent":"          _posts = posts;"},{"type":"MODIFY","lineNumber":156,"content":"    }","oldContent":"  }"},{"type":"INSERT","lineNumber":157,"content":"  }"},{"type":"DELETE","lineNumber":159,"oldContent":"    }"},{"type":"DELETE","lineNumber":161,"oldContent":"  @override"},{"type":"DELETE","lineNumber":163,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":165,"oldContent":"    // Clean up any resources if needed"},{"type":"DELETE","lineNumber":167,"oldContent":"    _posts.clear();"},{"type":"DELETE","lineNumber":169,"oldContent":"    _stories.clear();"},{"type":"DELETE","lineNumber":171,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":173,"oldContent":"  }"},{"type":"DELETE","lineNumber":176,"oldContent":"}"},{"type":"INSERT","lineNumber":171,"content":"  @override"},{"type":"INSERT","lineNumber":172,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":173,"content":"    // Clean up any resources if needed"},{"type":"INSERT","lineNumber":174,"content":"    _posts.clear();"},{"type":"INSERT","lineNumber":175,"content":"    _stories.clear();"},{"type":"INSERT","lineNumber":176,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":177,"content":"  }"},{"type":"INSERT","lineNumber":178,"content":"}"}]},{"timestamp":1754482744256,"changes":[{"type":"INSERT","lineNumber":10,"content":"import '../../../../core/usecases/no_params.dart';"},{"type":"INSERT","lineNumber":11,"content":""},{"type":"DELETE","lineNumber":31,"oldContent":""},{"type":"INSERT","lineNumber":34,"content":""},{"type":"DELETE","lineNumber":155,"oldContent":"  }"},{"type":"INSERT","lineNumber":157,"content":"      return 'An unexpected error occurred';"},{"type":"INSERT","lineNumber":168,"content":"      loadPosts(),"},{"type":"INSERT","lineNumber":169,"content":"      loadStories(),"},{"type":"INSERT","lineNumber":170,"content":"    ]);"},{"type":"INSERT","lineNumber":171,"content":"  }"},{"type":"INSERT","lineNumber":172,"content":""},{"type":"DELETE","lineNumber":168,"oldContent":"      loadPosts(),"},{"type":"DELETE","lineNumber":171,"oldContent":"      loadStories(),"},{"type":"DELETE","lineNumber":173,"oldContent":"    ]);"},{"type":"DELETE","lineNumber":176,"oldContent":"  }"},{"type":"DELETE","lineNumber":179,"oldContent":""}]},{"timestamp":1754482947138,"changes":[{"type":"MODIFY","lineNumber":12,"content":"class HomeViewModel extends BaseViewModel {","oldContent":"class HomeViewModel extends BaseViewModel {"},{"type":"MODIFY","lineNumber":35,"content":"  HomeViewModel({","oldContent":"  HomeViewModel({"},{"type":"MODIFY","lineNumber":40,"content":"    String? currentUserId,","oldContent":"  });"},{"type":"INSERT","lineNumber":41,"content":"  }) : _currentUserId = currentUserId {"},{"type":"INSERT","lineNumber":42,"content":"    loadInitialData();"},{"type":"INSERT","lineNumber":43,"content":"  }"},{"type":"DELETE","lineNumber":157,"oldContent":"    }"},{"type":"INSERT","lineNumber":161,"content":"    }"},{"type":"DELETE","lineNumber":168,"oldContent":"  @override"},{"type":"DELETE","lineNumber":169,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":172,"oldContent":"    // Clean up any resources if needed"},{"type":"DELETE","lineNumber":174,"oldContent":"    _posts.clear();"},{"type":"INSERT","lineNumber":176,"content":"  @override"},{"type":"INSERT","lineNumber":177,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":178,"content":"    // Clean up any resources if needed"},{"type":"INSERT","lineNumber":179,"content":"    _posts.clear();"}]},{"timestamp":1754483296293,"changes":[{"type":"MODIFY","lineNumber":10,"content":"import 'package:family_tree_firebase/core/usecases/usecase.dart';","oldContent":"import '../../../../core/usecases/no_params.dart';"},{"type":"INSERT","lineNumber":11,"content":"import 'package:family_tree_firebase/core/error/failures.dart';"},{"type":"INSERT","lineNumber":12,"content":""},{"type":"DELETE","lineNumber":12,"oldContent":"class HomeViewModel extends BaseViewModel {"},{"type":"INSERT","lineNumber":35,"content":""},{"type":"DELETE","lineNumber":35,"oldContent":"  HomeViewModel({"},{"type":"DELETE","lineNumber":42,"oldContent":""},{"type":"DELETE","lineNumber":44,"oldContent":"  Future<void> loadInitialData() async {"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"INSERT","lineNumber":46,"content":"  Future<void> loadInitialData() async {"},{"type":"INSERT","lineNumber":162,"content":"    }"},{"type":"DELETE","lineNumber":163,"oldContent":"    }"},{"type":"DELETE","lineNumber":169,"oldContent":"  Future<void> loadInitialData() async {"},{"type":"DELETE","lineNumber":170,"oldContent":"    await Future.wait(["},{"type":"DELETE","lineNumber":171,"oldContent":"      loadPosts(),"},{"type":"DELETE","lineNumber":172,"oldContent":"      loadStories(),"},{"type":"DELETE","lineNumber":173,"oldContent":"    ]);"},{"type":"DELETE","lineNumber":174,"oldContent":"  }"},{"type":"DELETE","lineNumber":176,"oldContent":""},{"type":"DELETE","lineNumber":178,"oldContent":"    _stories.clear();"},{"type":"DELETE","lineNumber":180,"oldContent":"    super.dispose();"},{"type":"INSERT","lineNumber":174,"content":"    _stories.clear();"},{"type":"INSERT","lineNumber":175,"content":"    super.dispose();"}]},{"timestamp":1754483500958,"changes":[{"type":"INSERT","lineNumber":4,"content":"import 'package:family_tree_firebase/features/home/domain/entities/story.dart';"},{"type":"DELETE","lineNumber":12,"oldContent":"class HomeViewModel extends BaseViewModel {"},{"type":"INSERT","lineNumber":14,"content":"class HomeViewModel extends BaseViewModel {"},{"type":"DELETE","lineNumber":35,"oldContent":"  HomeViewModel({"},{"type":"INSERT","lineNumber":37,"content":"  HomeViewModel({"},{"type":"DELETE","lineNumber":44,"oldContent":""},{"type":"INSERT","lineNumber":46,"content":""},{"type":"INSERT","lineNumber":79,"content":"  // Map Story entity to StoryModel"},{"type":"INSERT","lineNumber":80,"content":"  StoryModel _mapStoryToModel(Story story) {"},{"type":"INSERT","lineNumber":81,"content":"    // Get the first media item (or use a default if empty)"},{"type":"INSERT","lineNumber":82,"content":"    final media = story.media.isNotEmpty ? story.media.first : null;"},{"type":"INSERT","lineNumber":83,"content":"    final isImage = media?.type == 'image';"},{"type":"INSERT","lineNumber":84,"content":"    "},{"type":"INSERT","lineNumber":85,"content":"    return StoryModel("},{"type":"INSERT","lineNumber":86,"content":"      id: story.id,"},{"type":"INSERT","lineNumber":87,"content":"      userId: story.userId,"},{"type":"INSERT","lineNumber":88,"content":"      userName: story.userName,"},{"type":"INSERT","lineNumber":89,"content":"      userImageUrl: story.userAvatar ?? '',"},{"type":"INSERT","lineNumber":90,"content":"      imageUrl: isImage ? media?.url : null,"},{"type":"INSERT","lineNumber":91,"content":"      videoUrl: isImage ? null : media?.url,"},{"type":"INSERT","lineNumber":92,"content":"      isSeen: story.viewers.contains(_currentUserId) || story.isViewed,"},{"type":"INSERT","lineNumber":93,"content":"      timestamp: story.timestamp,"},{"type":"INSERT","lineNumber":94,"content":"    );"},{"type":"INSERT","lineNumber":95,"content":"  }"},{"type":"INSERT","lineNumber":96,"content":""},{"type":"DELETE","lineNumber":86,"oldContent":"          _errorMessage = failure.message;"},{"type":"INSERT","lineNumber":105,"content":"          _errorMessage = _mapFailureToMessage(failure);"},{"type":"DELETE","lineNumber":90,"oldContent":"          _stories = stories;"},{"type":"INSERT","lineNumber":109,"content":"          _stories = stories.map(_mapStoryToModel).toList();"},{"type":"DELETE","lineNumber":162,"oldContent":"  }"},{"type":"INSERT","lineNumber":182,"content":"  }"},{"type":"DELETE","lineNumber":170,"oldContent":"    _stories.clear();"},{"type":"DELETE","lineNumber":171,"oldContent":"    super.dispose();"},{"type":"INSERT","lineNumber":193,"content":"    _stories.clear();"},{"type":"INSERT","lineNumber":194,"content":"    super.dispose();"}]},{"timestamp":1754483630092,"changes":[{"type":"MODIFY","lineNumber":4,"content":"import 'package:family_tree_firebase/features/home/domain/entities/comment.dart';","oldContent":"import 'package:family_tree_firebase/features/home/domain/entities/story.dart';"},{"type":"INSERT","lineNumber":5,"content":"import 'package:family_tree_firebase/features/home/domain/models/comment_model.dart';"},{"type":"DELETE","lineNumber":79,"oldContent":"  Future<void> loadStories() async {"},{"type":"DELETE","lineNumber":81,"oldContent":"    _isLoadingStories = true;"},{"type":"DELETE","lineNumber":83,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":85,"oldContent":""},{"type":"DELETE","lineNumber":87,"oldContent":"    try {"},{"type":"DELETE","lineNumber":89,"oldContent":"      final result = await getStories(NoParams());"},{"type":"DELETE","lineNumber":91,"oldContent":"      result.fold("},{"type":"DELETE","lineNumber":93,"oldContent":"        (failure) {"},{"type":"DELETE","lineNumber":96,"oldContent":"          _stories = [];"},{"type":"DELETE","lineNumber":98,"oldContent":"        },"},{"type":"DELETE","lineNumber":100,"oldContent":"        (stories) {"},{"type":"DELETE","lineNumber":103,"oldContent":"          _errorMessage = null;"},{"type":"DELETE","lineNumber":105,"oldContent":"        },"},{"type":"DELETE","lineNumber":107,"oldContent":"      );"},{"type":"DELETE","lineNumber":109,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":111,"oldContent":"      _errorMessage = 'Failed to load stories: $e';"},{"type":"INSERT","lineNumber":98,"content":"  Future<void> loadStories() async {"},{"type":"INSERT","lineNumber":99,"content":"    _isLoadingStories = true;"},{"type":"INSERT","lineNumber":100,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":101,"content":""},{"type":"INSERT","lineNumber":102,"content":"    try {"},{"type":"INSERT","lineNumber":103,"content":"      final result = await getStories(NoParams());"},{"type":"INSERT","lineNumber":104,"content":"      result.fold("},{"type":"INSERT","lineNumber":105,"content":"        (failure) {"},{"type":"INSERT","lineNumber":106,"content":"          _errorMessage = _mapFailureToMessage(failure);"},{"type":"INSERT","lineNumber":107,"content":"          _stories = [];"},{"type":"INSERT","lineNumber":108,"content":"        },"},{"type":"INSERT","lineNumber":109,"content":"        (stories) {"},{"type":"INSERT","lineNumber":110,"content":"          _stories = stories.map(_mapStoryToModel).toList();"},{"type":"INSERT","lineNumber":111,"content":"          _errorMessage = null;"},{"type":"INSERT","lineNumber":112,"content":"        },"},{"type":"INSERT","lineNumber":113,"content":"      );"},{"type":"INSERT","lineNumber":114,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":115,"content":"      _errorMessage = 'Failed to load stories: $e';"},{"type":"DELETE","lineNumber":122,"oldContent":"          _errorMessage = _mapFailureToMessage(failure);"},{"type":"DELETE","lineNumber":127,"oldContent":"          _stories = stories.map(_mapStoryToModel).toList();"},{"type":"MODIFY","lineNumber":147,"content":"  // Map Comment entity to CommentModel","oldContent":"  Future<void> addComment(String postId, String comment) async {"},{"type":"INSERT","lineNumber":148,"content":"  CommentModel _mapCommentToModel(Comment comment) {"},{"type":"INSERT","lineNumber":149,"content":"    return CommentModel("},{"type":"INSERT","lineNumber":150,"content":"      id: comment.id,"},{"type":"INSERT","lineNumber":151,"content":"      userId: comment.userId,"},{"type":"INSERT","lineNumber":152,"content":"      userName: comment.userName,"},{"type":"INSERT","lineNumber":153,"content":"      userImageUrl: comment.userAvatar ?? '',"},{"type":"INSERT","lineNumber":154,"content":"      text: comment.content,"},{"type":"INSERT","lineNumber":155,"content":"      timestamp: comment.timestamp,"},{"type":"INSERT","lineNumber":156,"content":"    );"},{"type":"INSERT","lineNumber":157,"content":"  }"},{"type":"INSERT","lineNumber":158,"content":""},{"type":"INSERT","lineNumber":159,"content":"  Future<void> addComment(String postId, String content) async {"},{"type":"INSERT","lineNumber":160,"content":"    if (_currentUserId == null) {"},{"type":"INSERT","lineNumber":161,"content":"      _errorMessage = 'User not authenticated';"},{"type":"INSERT","lineNumber":162,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":163,"content":"      return;"},{"type":"INSERT","lineNumber":164,"content":"    }"},{"type":"INSERT","lineNumber":165,"content":""},{"type":"DELETE","lineNumber":149,"oldContent":"        AddCommentParams(postId: postId, comment: comment),"},{"type":"INSERT","lineNumber":168,"content":"        AddCommentParams("},{"type":"INSERT","lineNumber":169,"content":"          postId: postId,"},{"type":"INSERT","lineNumber":170,"content":"          userId: _currentUserId!,"},{"type":"INSERT","lineNumber":171,"content":"          content: content,"},{"type":"INSERT","lineNumber":172,"content":"          userName: 'Current User', // This should be replaced with actual user name"},{"type":"INSERT","lineNumber":173,"content":"          userAvatar: null, // This should be replaced with actual user avatar"},{"type":"INSERT","lineNumber":174,"content":"        ),"},{"type":"DELETE","lineNumber":153,"oldContent":"        (failure) => _errorMessage = failure.message,"},{"type":"INSERT","lineNumber":178,"content":"        (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"DELETE","lineNumber":158,"oldContent":"            final updatedComments = List<Comment>.from(post.comments)..add(comment);"},{"type":"DELETE","lineNumber":159,"oldContent":"            _posts[index] = post.copyWith(comments: updatedComments);"},{"type":"INSERT","lineNumber":183,"content":"            final commentModel = _mapCommentToModel(comment);"},{"type":"INSERT","lineNumber":184,"content":"            final updatedComments = List<CommentModel>.from(post.comments)..add(commentModel);"},{"type":"INSERT","lineNumber":185,"content":"            _posts[index] = post.copyWith("},{"type":"INSERT","lineNumber":186,"content":"              comments: updatedComments,"},{"type":"INSERT","lineNumber":187,"content":"              commentCount: post.commentCount + 1,"},{"type":"INSERT","lineNumber":188,"content":"            );"},{"type":"INSERT","lineNumber":211,"content":"  }"},{"type":"INSERT","lineNumber":222,"content":"    _stories.clear();"},{"type":"INSERT","lineNumber":223,"content":"    super.dispose();"},{"type":"DELETE","lineNumber":195,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":196,"oldContent":"    _stories.clear();"},{"type":"DELETE","lineNumber":197,"oldContent":"  }"}]},{"timestamp":1754483909314,"changes":[{"type":"INSERT","lineNumber":90,"content":"      userImageUrl: story.userAvatar ?? '',"},{"type":"INSERT","lineNumber":91,"content":"      imageUrl: isImage ? media?.url : null,"},{"type":"INSERT","lineNumber":92,"content":"      videoUrl: isImage ? null : media?.url,"},{"type":"INSERT","lineNumber":93,"content":"      isSeen: story.viewers.contains(_currentUserId) || story.isViewed,"},{"type":"INSERT","lineNumber":94,"content":"      timestamp: story.timestamp,"},{"type":"INSERT","lineNumber":95,"content":"    );"},{"type":"INSERT","lineNumber":96,"content":"  }"},{"type":"INSERT","lineNumber":97,"content":""},{"type":"DELETE","lineNumber":92,"oldContent":"      userImageUrl: story.userAvatar ?? '',"},{"type":"DELETE","lineNumber":95,"oldContent":"      imageUrl: isImage ? media?.url : null,"},{"type":"DELETE","lineNumber":97,"oldContent":"      videoUrl: isImage ? null : media?.url,"},{"type":"DELETE","lineNumber":100,"oldContent":"      isSeen: story.viewers.contains(_currentUserId) || story.isViewed,"},{"type":"DELETE","lineNumber":103,"oldContent":"      timestamp: story.timestamp,"},{"type":"DELETE","lineNumber":106,"oldContent":"    );"},{"type":"DELETE","lineNumber":109,"oldContent":"  }"},{"type":"DELETE","lineNumber":112,"oldContent":""},{"type":"DELETE","lineNumber":114,"oldContent":"      _stories = [];"},{"type":"MODIFY","lineNumber":116,"content":"      _stories = [];","oldContent":"    } finally {"},{"type":"INSERT","lineNumber":117,"content":"    } finally {"},{"type":"INSERT","lineNumber":124,"content":"    if (_currentUserId == null) {"},{"type":"INSERT","lineNumber":125,"content":"      _errorMessage = 'User not authenticated';"},{"type":"INSERT","lineNumber":126,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":127,"content":"      return;"},{"type":"INSERT","lineNumber":128,"content":"    }"},{"type":"INSERT","lineNumber":129,"content":""},{"type":"DELETE","lineNumber":125,"oldContent":"      final result = await likePostUseCase(LikePostParams(postId: postId));"},{"type":"INSERT","lineNumber":131,"content":"      final result = await likePostUseCase("},{"type":"INSERT","lineNumber":132,"content":"        LikePostParams("},{"type":"INSERT","lineNumber":133,"content":"          postId: postId,"},{"type":"INSERT","lineNumber":134,"content":"          userId: _currentUserId!,"},{"type":"INSERT","lineNumber":135,"content":"        ),"},{"type":"INSERT","lineNumber":136,"content":"      );"},{"type":"INSERT","lineNumber":137,"content":"      "},{"type":"DELETE","lineNumber":127,"oldContent":"        (failure) => _errorMessage = failure.message,"},{"type":"INSERT","lineNumber":139,"content":"        (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"DELETE","lineNumber":147,"oldContent":"  Future<void> addComment(String postId, String comment) async {"},{"type":"DELETE","lineNumber":150,"oldContent":"      final result = await addCommentUseCase("},{"type":"DELETE","lineNumber":153,"oldContent":"      );"},{"type":"DELETE","lineNumber":155,"oldContent":"      "},{"type":"DELETE","lineNumber":157,"oldContent":"      result.fold("},{"type":"DELETE","lineNumber":160,"oldContent":"        (comment) {"},{"type":"DELETE","lineNumber":162,"oldContent":"          final index = _posts.indexWhere((post) => post.id == postId);"},{"type":"DELETE","lineNumber":164,"oldContent":"          if (index != -1) {"},{"type":"DELETE","lineNumber":166,"oldContent":"            final post = _posts[index];"},{"type":"DELETE","lineNumber":170,"oldContent":"            _errorMessage = null;"},{"type":"DELETE","lineNumber":172,"oldContent":"            notifyListeners();"},{"type":"DELETE","lineNumber":174,"oldContent":"          }"},{"type":"DELETE","lineNumber":176,"oldContent":"        },"},{"type":"MODIFY","lineNumber":178,"content":"    try {","oldContent":"      );"},{"type":"INSERT","lineNumber":179,"content":"      final result = await addCommentUseCase("},{"type":"INSERT","lineNumber":180,"content":"        AddCommentParams("},{"type":"INSERT","lineNumber":181,"content":"          postId: postId,"},{"type":"INSERT","lineNumber":182,"content":"          userId: _currentUserId!,"},{"type":"INSERT","lineNumber":183,"content":"          content: content,"},{"type":"INSERT","lineNumber":184,"content":"          userName: 'Current User', // This should be replaced with actual user name"},{"type":"INSERT","lineNumber":185,"content":"          userAvatar: null, // This should be replaced with actual user avatar"},{"type":"INSERT","lineNumber":186,"content":"        ),"},{"type":"INSERT","lineNumber":187,"content":"      );"},{"type":"INSERT","lineNumber":188,"content":"      "},{"type":"INSERT","lineNumber":189,"content":"      result.fold("},{"type":"INSERT","lineNumber":190,"content":"        (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"INSERT","lineNumber":191,"content":"        (comment) {"},{"type":"INSERT","lineNumber":192,"content":"          final index = _posts.indexWhere((post) => post.id == postId);"},{"type":"INSERT","lineNumber":193,"content":"          if (index != -1) {"},{"type":"INSERT","lineNumber":194,"content":"            final post = _posts[index];"},{"type":"INSERT","lineNumber":195,"content":"            final commentModel = _mapCommentToModel(comment);"},{"type":"INSERT","lineNumber":196,"content":"            final updatedComments = List<CommentModel>.from(post.comments)..add(commentModel);"},{"type":"INSERT","lineNumber":197,"content":"            _posts[index] = post.copyWith("},{"type":"INSERT","lineNumber":198,"content":"              comments: updatedComments,"},{"type":"INSERT","lineNumber":199,"content":"              commentCount: post.commentCount + 1,"},{"type":"INSERT","lineNumber":200,"content":"            );"},{"type":"INSERT","lineNumber":201,"content":"            _errorMessage = null;"},{"type":"INSERT","lineNumber":202,"content":"            notifyListeners();"},{"type":"INSERT","lineNumber":203,"content":"          }"},{"type":"INSERT","lineNumber":204,"content":"        },"},{"type":"INSERT","lineNumber":205,"content":"      );"},{"type":"DELETE","lineNumber":183,"oldContent":"        AddCommentParams("},{"type":"DELETE","lineNumber":185,"oldContent":"          postId: postId,"},{"type":"DELETE","lineNumber":187,"oldContent":"          userId: _currentUserId!,"},{"type":"DELETE","lineNumber":189,"oldContent":"          content: content,"},{"type":"DELETE","lineNumber":191,"oldContent":"          userName: 'Current User', // This should be replaced with actual user name"},{"type":"DELETE","lineNumber":193,"oldContent":"          userAvatar: null, // This should be replaced with actual user avatar"},{"type":"DELETE","lineNumber":195,"oldContent":"        ),"},{"type":"DELETE","lineNumber":200,"oldContent":"        (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"INSERT","lineNumber":223,"content":"  }"},{"type":"DELETE","lineNumber":206,"oldContent":"            final commentModel = _mapCommentToModel(comment);"},{"type":"DELETE","lineNumber":208,"oldContent":"            final updatedComments = List<CommentModel>.from(post.comments)..add(commentModel);"},{"type":"DELETE","lineNumber":210,"oldContent":"            _posts[index] = post.copyWith("},{"type":"DELETE","lineNumber":212,"oldContent":"              comments: updatedComments,"},{"type":"DELETE","lineNumber":214,"oldContent":"              commentCount: post.commentCount + 1,"},{"type":"DELETE","lineNumber":216,"oldContent":"            );"},{"type":"INSERT","lineNumber":234,"content":"    _stories.clear();"},{"type":"INSERT","lineNumber":235,"content":"    super.dispose();"},{"type":"DELETE","lineNumber":224,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":225,"oldContent":"    _stories.clear();"},{"type":"DELETE","lineNumber":226,"oldContent":"  }"}]},{"timestamp":1754515440674,"changes":[{"type":"INSERT","lineNumber":15,"content":"import '../../domain/entities/story.dart';"},{"type":"INSERT","lineNumber":16,"content":""},{"type":"DELETE","lineNumber":91,"oldContent":"  Future<void> loadStories() async {"},{"type":"DELETE","lineNumber":93,"oldContent":"    _isLoadingStories = true;"},{"type":"DELETE","lineNumber":96,"oldContent":"    notifyListeners();"},{"type":"DELETE","lineNumber":98,"oldContent":""},{"type":"DELETE","lineNumber":101,"oldContent":"    try {"},{"type":"INSERT","lineNumber":100,"content":"  Future<void> loadStories() async {"},{"type":"INSERT","lineNumber":101,"content":"    _isLoadingStories = true;"},{"type":"INSERT","lineNumber":102,"content":"    notifyListeners();"},{"type":"INSERT","lineNumber":103,"content":""},{"type":"INSERT","lineNumber":104,"content":"    try {"},{"type":"INSERT","lineNumber":117,"content":"      _errorMessage = 'Failed to load stories: $e';"},{"type":"DELETE","lineNumber":117,"oldContent":"      _errorMessage = 'Failed to load stories: $e';"},{"type":"DELETE","lineNumber":125,"oldContent":"    try {"},{"type":"DELETE","lineNumber":128,"oldContent":"      result.fold("},{"type":"DELETE","lineNumber":131,"oldContent":"        (success) {"},{"type":"INSERT","lineNumber":132,"content":"    try {"},{"type":"INSERT","lineNumber":133,"content":"      final result = await likePostUseCase("},{"type":"INSERT","lineNumber":134,"content":"        LikePostParams("},{"type":"INSERT","lineNumber":135,"content":"          postId: postId,"},{"type":"INSERT","lineNumber":136,"content":"          userId: _currentUserId!,"},{"type":"INSERT","lineNumber":137,"content":"        ),"},{"type":"INSERT","lineNumber":138,"content":"      );"},{"type":"INSERT","lineNumber":139,"content":"      "},{"type":"INSERT","lineNumber":140,"content":"      result.fold("},{"type":"INSERT","lineNumber":141,"content":"        (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"INSERT","lineNumber":142,"content":"        (success) {"},{"type":"DELETE","lineNumber":135,"oldContent":"      final result = await likePostUseCase("},{"type":"DELETE","lineNumber":137,"oldContent":"        LikePostParams("},{"type":"DELETE","lineNumber":139,"oldContent":"          postId: postId,"},{"type":"DELETE","lineNumber":141,"oldContent":"          userId: _currentUserId!,"},{"type":"DELETE","lineNumber":143,"oldContent":"        ),"},{"type":"DELETE","lineNumber":145,"oldContent":"      );"},{"type":"DELETE","lineNumber":147,"oldContent":"      "},{"type":"DELETE","lineNumber":150,"oldContent":"        (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"INSERT","lineNumber":179,"content":""},{"type":"DELETE","lineNumber":179,"oldContent":""},{"type":"DELETE","lineNumber":181,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":183,"oldContent":"      _errorMessage = 'Failed to add comment: $e';"},{"type":"DELETE","lineNumber":185,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":188,"oldContent":"    }"},{"type":"DELETE","lineNumber":191,"oldContent":"  }"},{"type":"DELETE","lineNumber":194,"oldContent":""},{"type":"DELETE","lineNumber":197,"oldContent":"  String _mapFailureToMessage(Failure failure) {"},{"type":"DELETE","lineNumber":200,"oldContent":"    // Map different failure types to user-friendly messages"},{"type":"DELETE","lineNumber":203,"oldContent":"    if (failure is ServerFailure) {"},{"type":"DELETE","lineNumber":206,"oldContent":"      return failure.message ?? 'Server error occurred';"},{"type":"DELETE","lineNumber":208,"oldContent":"    } else if (failure is NetworkFailure) {"},{"type":"DELETE","lineNumber":210,"oldContent":"      return failure.message ?? 'Network error occurred';"},{"type":"DELETE","lineNumber":212,"oldContent":"    } else if (failure is CacheFailure) {"},{"type":"DELETE","lineNumber":215,"oldContent":"      return 'Cache error occurred';"},{"type":"DELETE","lineNumber":217,"oldContent":"    } else {"},{"type":"DELETE","lineNumber":219,"oldContent":"      return 'An unexpected error occurred';"},{"type":"DELETE","lineNumber":221,"oldContent":"    }"},{"type":"INSERT","lineNumber":208,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":209,"content":"      _errorMessage = 'Failed to add comment: $e';"},{"type":"INSERT","lineNumber":210,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":211,"content":"    }"},{"type":"INSERT","lineNumber":212,"content":"  }"},{"type":"INSERT","lineNumber":214,"content":"  String _mapFailureToMessage(Failure failure) {"},{"type":"INSERT","lineNumber":215,"content":"    // Map different failure types to user-friendly messages"},{"type":"INSERT","lineNumber":216,"content":"    if (failure is ServerFailure) {"},{"type":"INSERT","lineNumber":217,"content":"      return failure.message ?? 'Server error occurred';"},{"type":"INSERT","lineNumber":218,"content":"    } else if (failure is NetworkFailure) {"},{"type":"INSERT","lineNumber":219,"content":"      return failure.message ?? 'Network error occurred';"},{"type":"INSERT","lineNumber":220,"content":"    } else if (failure is CacheFailure) {"},{"type":"INSERT","lineNumber":221,"content":"      return 'Cache error occurred';"},{"type":"INSERT","lineNumber":222,"content":"    } else {"},{"type":"INSERT","lineNumber":223,"content":"      return 'An unexpected error occurred';"},{"type":"INSERT","lineNumber":224,"content":"    }"},{"type":"INSERT","lineNumber":225,"content":"  }"},{"type":"INSERT","lineNumber":226,"content":""},{"type":"INSERT","lineNumber":236,"content":"    _stories.clear();"},{"type":"INSERT","lineNumber":237,"content":"    super.dispose();"},{"type":"DELETE","lineNumber":235,"oldContent":"  }"},{"type":"DELETE","lineNumber":237,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":238,"oldContent":"    _stories.clear();"}]},{"timestamp":1754515447319,"changes":[{"type":"MODIFY","lineNumber":3,"content":"import 'package:family_tree_firebase/features/home/domain/models/post_model.dart' hide CommentModel;","oldContent":"import 'package:family_tree_firebase/features/home/domain/models/post_model.dart';"},{"type":"MODIFY","lineNumber":17,"content":"class HomeViewModel extends BaseViewModel {","oldContent":"class HomeViewModel extends BaseViewModel {"},{"type":"DELETE","lineNumber":98,"oldContent":"  Future<void> loadStories() async {"},{"type":"INSERT","lineNumber":99,"content":""},{"type":"INSERT","lineNumber":100,"content":"  Future<void> loadStories() async {"},{"type":"DELETE","lineNumber":103,"oldContent":""},{"type":"MODIFY","lineNumber":105,"content":"      final result = await getStories(NoParams());","oldContent":"      final result = await getStories(NoParams());"},{"type":"INSERT","lineNumber":117,"content":"      _errorMessage = 'Failed to load stories: $e';"},{"type":"DELETE","lineNumber":119,"oldContent":"      _errorMessage = 'Failed to load stories: $e';"},{"type":"MODIFY","lineNumber":132,"content":"    try {","oldContent":"    try {"},{"type":"DELETE","lineNumber":134,"oldContent":"          final index = _posts.indexWhere((post) => post.id == postId);"},{"type":"DELETE","lineNumber":136,"oldContent":"          if (index != -1) {"},{"type":"DELETE","lineNumber":139,"oldContent":"            final post = _posts[index];"},{"type":"DELETE","lineNumber":142,"oldContent":"            _posts[index] = post.copyWith("},{"type":"DELETE","lineNumber":145,"oldContent":"              isLiked: !post.isLiked,"},{"type":"INSERT","lineNumber":143,"content":"          final index = _posts.indexWhere((post) => post.id == postId);"},{"type":"INSERT","lineNumber":144,"content":"          if (index != -1) {"},{"type":"INSERT","lineNumber":145,"content":"            final post = _posts[index];"},{"type":"INSERT","lineNumber":146,"content":"            _posts[index] = post.copyWith("},{"type":"INSERT","lineNumber":147,"content":"              isLiked: !post.isLiked,"},{"type":"INSERT","lineNumber":179,"content":""},{"type":"DELETE","lineNumber":181,"oldContent":""},{"type":"INSERT","lineNumber":200,"content":"              comments: updatedComments,"},{"type":"INSERT","lineNumber":201,"content":"              commentCount: post.commentCount + 1,"},{"type":"INSERT","lineNumber":202,"content":"            );"},{"type":"INSERT","lineNumber":203,"content":"            _errorMessage = null;"},{"type":"INSERT","lineNumber":204,"content":"            notifyListeners();"},{"type":"INSERT","lineNumber":205,"content":"          }"},{"type":"INSERT","lineNumber":206,"content":"        },"},{"type":"INSERT","lineNumber":207,"content":"      );"},{"type":"DELETE","lineNumber":202,"oldContent":"              comments: updatedComments,"},{"type":"DELETE","lineNumber":205,"oldContent":"              commentCount: post.commentCount + 1,"},{"type":"DELETE","lineNumber":207,"oldContent":"            );"},{"type":"INSERT","lineNumber":213,"content":""},{"type":"DELETE","lineNumber":209,"oldContent":"            _errorMessage = null;"},{"type":"DELETE","lineNumber":212,"oldContent":"            notifyListeners();"},{"type":"DELETE","lineNumber":215,"oldContent":"          }"},{"type":"DELETE","lineNumber":218,"oldContent":"        },"},{"type":"DELETE","lineNumber":221,"oldContent":"      );"},{"type":"DELETE","lineNumber":223,"oldContent":""},{"type":"DELETE","lineNumber":225,"oldContent":"  void setCurrentUser(String userId) {"},{"type":"MODIFY","lineNumber":227,"content":"  void setCurrentUser(String userId) {","oldContent":"    _currentUserId = userId;"},{"type":"INSERT","lineNumber":228,"content":"    _currentUserId = userId;"},{"type":"INSERT","lineNumber":236,"content":"    _stories.clear();"},{"type":"INSERT","lineNumber":237,"content":"    super.dispose();"},{"type":"DELETE","lineNumber":238,"oldContent":"    _stories.clear();"},{"type":"DELETE","lineNumber":240,"oldContent":"    super.dispose();"}]},{"timestamp":1754515512358,"changes":[{"type":"INSERT","lineNumber":16,"content":""},{"type":"DELETE","lineNumber":17,"oldContent":"class HomeViewModel extends BaseViewModel {"},{"type":"MODIFY","lineNumber":99,"content":"","oldContent":""},{"type":"INSERT","lineNumber":104,"content":"    try {"},{"type":"DELETE","lineNumber":105,"oldContent":"      final result = await getStories(NoParams());"},{"type":"INSERT","lineNumber":131,"content":""},{"type":"DELETE","lineNumber":132,"oldContent":"    try {"},{"type":"DELETE","lineNumber":139,"oldContent":"          final index = _posts.indexWhere((post) => post.id == postId);"},{"type":"MODIFY","lineNumber":141,"content":"        (failure) => _errorMessage = _mapFailureToMessage(failure),","oldContent":"          if (index != -1) {"},{"type":"INSERT","lineNumber":142,"content":"        (success) {"},{"type":"INSERT","lineNumber":143,"content":"          final index = _posts.indexWhere((post) => post.id == postId);"},{"type":"INSERT","lineNumber":144,"content":"          if (index != -1) {"},{"type":"DELETE","lineNumber":145,"oldContent":"        (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"DELETE","lineNumber":147,"oldContent":"        (success) {"},{"type":"DELETE","lineNumber":201,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":202,"oldContent":"              commentCount: post.commentCount + 1,"},{"type":"DELETE","lineNumber":203,"oldContent":"      _errorMessage = 'Failed to add comment: $e';"},{"type":"INSERT","lineNumber":201,"content":"              // commentCount: post.commentCount + 1, // Remove or fix if PostModel does not have commentCount"},{"type":"DELETE","lineNumber":206,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":208,"oldContent":"    }"},{"type":"DELETE","lineNumber":211,"oldContent":"  }"},{"type":"INSERT","lineNumber":208,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":209,"content":"      _errorMessage = 'Failed to add comment: $e';"},{"type":"INSERT","lineNumber":210,"content":"      notifyListeners();"},{"type":"INSERT","lineNumber":211,"content":"    }"},{"type":"INSERT","lineNumber":212,"content":"  }"},{"type":"INSERT","lineNumber":213,"content":""},{"type":"DELETE","lineNumber":216,"oldContent":""},{"type":"INSERT","lineNumber":226,"content":""},{"type":"DELETE","lineNumber":228,"oldContent":""},{"type":"MODIFY","lineNumber":238,"content":"  }","oldContent":"  }"}]},{"timestamp":1754515701749,"changes":[{"type":"MODIFY","lineNumber":5,"content":"import 'package:family_tree_firebase/features/home/domain/models/comment_model.dart' as P;","oldContent":"import 'package:family_tree_firebase/features/home/domain/models/comment_model.dart';"},{"type":"INSERT","lineNumber":98,"content":"  }"},{"type":"DELETE","lineNumber":99,"oldContent":""},{"type":"INSERT","lineNumber":140,"content":"      result.fold("},{"type":"DELETE","lineNumber":142,"oldContent":"      result.fold("},{"type":"MODIFY","lineNumber":145,"content":"            final post = _posts[index];","oldContent":"            final post = _posts[index];"},{"type":"DELETE","lineNumber":162,"oldContent":"  CommentModel _mapCommentToModel(Comment comment) {"},{"type":"MODIFY","lineNumber":162,"content":"  P.CommentModel _mapCommentToModel(Comment comment) {","oldContent":"    return CommentModel("},{"type":"INSERT","lineNumber":163,"content":"    return P.CommentModel("},{"type":"MODIFY","lineNumber":198,"content":"            final updatedComments = List<P.CommentModel>.from(post.comments)..add(commentModel);","oldContent":"            final updatedComments = List<CommentModel>.from(post.comments)..add(commentModel);"},{"type":"MODIFY","lineNumber":200,"content":"              comments: updatedComments.map((c) => c as P.CommentModel).toList(),","oldContent":"              comments: updatedComments,"},{"type":"INSERT","lineNumber":205,"content":"          }"},{"type":"INSERT","lineNumber":206,"content":"        },"},{"type":"INSERT","lineNumber":207,"content":"      );"},{"type":"DELETE","lineNumber":207,"oldContent":"          }"},{"type":"DELETE","lineNumber":209,"oldContent":"        },"},{"type":"DELETE","lineNumber":212,"oldContent":"      );"},{"type":"INSERT","lineNumber":237,"content":"    super.dispose();"},{"type":"DELETE","lineNumber":238,"oldContent":"  }"}]},{"timestamp":1754516381845,"changes":[{"type":"INSERT","lineNumber":144,"content":"          if (index != -1) {"},{"type":"DELETE","lineNumber":145,"oldContent":"            final post = _posts[index];"},{"type":"MODIFY","lineNumber":163,"content":"    return P.CommentModel(","oldContent":"    return CommentModel("},{"type":"DELETE","lineNumber":166,"oldContent":"      userName: comment.userName,"},{"type":"DELETE","lineNumber":167,"oldContent":"      userImageUrl: comment.userAvatar ?? '',"},{"type":"DELETE","lineNumber":168,"oldContent":"      text: comment.content,"},{"type":"DELETE","lineNumber":169,"oldContent":"      timestamp: comment.timestamp,"},{"type":"INSERT","lineNumber":166,"content":"      content: comment.content,"},{"type":"INSERT","lineNumber":167,"content":"      createdAt: comment.createdAt,"},{"type":"DELETE","lineNumber":174,"oldContent":"    if (_currentUserId == null) {"},{"type":"DELETE","lineNumber":175,"oldContent":"      _errorMessage = 'User not authenticated';"},{"type":"DELETE","lineNumber":176,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":177,"oldContent":"      return;"},{"type":"DELETE","lineNumber":178,"oldContent":"    }"},{"type":"DELETE","lineNumber":179,"oldContent":""},{"type":"DELETE","lineNumber":180,"oldContent":"    try {"},{"type":"DELETE","lineNumber":181,"oldContent":"      final result = await addCommentUseCase("},{"type":"DELETE","lineNumber":182,"oldContent":"        AddCommentParams("},{"type":"DELETE","lineNumber":183,"oldContent":"          postId: postId,"},{"type":"DELETE","lineNumber":184,"oldContent":"          userId: _currentUserId!,"},{"type":"DELETE","lineNumber":185,"oldContent":"          content: content,"},{"type":"DELETE","lineNumber":186,"oldContent":"          userName: 'Current User', // This should be replaced with actual user name"},{"type":"DELETE","lineNumber":187,"oldContent":"          userAvatar: null, // This should be replaced with actual user avatar"},{"type":"DELETE","lineNumber":188,"oldContent":"        ),"},{"type":"DELETE","lineNumber":189,"oldContent":"      );"},{"type":"DELETE","lineNumber":190,"oldContent":"      "},{"type":"DELETE","lineNumber":191,"oldContent":"      result.fold("},{"type":"DELETE","lineNumber":192,"oldContent":"        (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"DELETE","lineNumber":193,"oldContent":"        (comment) {"},{"type":"DELETE","lineNumber":194,"oldContent":"          final index = _posts.indexWhere((post) => post.id == postId);"},{"type":"DELETE","lineNumber":195,"oldContent":"          if (index != -1) {"},{"type":"DELETE","lineNumber":196,"oldContent":"            final post = _posts[index];"},{"type":"DELETE","lineNumber":197,"oldContent":"            final commentModel = _mapCommentToModel(comment);"},{"type":"DELETE","lineNumber":198,"oldContent":"            final updatedComments = List<P.CommentModel>.from(post.comments)..add(commentModel);"},{"type":"DELETE","lineNumber":199,"oldContent":"            _posts[index] = post.copyWith("},{"type":"DELETE","lineNumber":200,"oldContent":"              comments: updatedComments.map((c) => c as P.CommentModel).toList(),"},{"type":"DELETE","lineNumber":201,"oldContent":"              // commentCount: post.commentCount + 1, // Remove or fix if PostModel does not have commentCount"},{"type":"DELETE","lineNumber":202,"oldContent":"            );"},{"type":"DELETE","lineNumber":203,"oldContent":"            _errorMessage = null;"},{"type":"DELETE","lineNumber":204,"oldContent":"            notifyListeners();"},{"type":"DELETE","lineNumber":205,"oldContent":"          }"},{"type":"DELETE","lineNumber":206,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":207,"oldContent":"        },"},{"type":"DELETE","lineNumber":208,"oldContent":"      _errorMessage = 'Failed to add comment: $e';"},{"type":"DELETE","lineNumber":209,"oldContent":"      );"},{"type":"DELETE","lineNumber":210,"oldContent":"      notifyListeners();"},{"type":"DELETE","lineNumber":211,"oldContent":"    }"},{"type":"INSERT","lineNumber":172,"content":"    final result = await addCommentUseCase("},{"type":"INSERT","lineNumber":173,"content":"      AddCommentParams("},{"type":"INSERT","lineNumber":174,"content":"        postId: postId,"},{"type":"INSERT","lineNumber":175,"content":"        userId: _currentUserId!,"},{"type":"INSERT","lineNumber":176,"content":"        content: content,"},{"type":"INSERT","lineNumber":177,"content":"        userName: 'Current User', // This should be replaced with actual user name"},{"type":"INSERT","lineNumber":178,"content":"        userAvatar: null, // This should be replaced with actual user avatar"},{"type":"INSERT","lineNumber":179,"content":"      ),"},{"type":"INSERT","lineNumber":180,"content":"    );"},{"type":"INSERT","lineNumber":181,"content":"    "},{"type":"INSERT","lineNumber":182,"content":"    result.fold("},{"type":"INSERT","lineNumber":183,"content":"      (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"INSERT","lineNumber":184,"content":"      (newComment) {"},{"type":"INSERT","lineNumber":185,"content":"        final postIndex = _posts.indexWhere((p) => p.id == postId);"},{"type":"INSERT","lineNumber":186,"content":"        if (postIndex != -1) {"},{"type":"INSERT","lineNumber":187,"content":"          final post = _posts[postIndex];"},{"type":"INSERT","lineNumber":188,"content":"          final updatedComments = List<P.CommentModel>.from(post.comments)..add(newComment);"},{"type":"INSERT","lineNumber":189,"content":"          _posts[postIndex] = post.copyWith(comments: updatedComments);"},{"type":"INSERT","lineNumber":190,"content":"          _errorMessage = null;"},{"type":"INSERT","lineNumber":191,"content":"          notifyListeners();"},{"type":"INSERT","lineNumber":192,"content":"        }"},{"type":"INSERT","lineNumber":193,"content":"      },"},{"type":"INSERT","lineNumber":194,"content":"    );"}]},{"timestamp":1754516474746,"changes":[{"type":"INSERT","lineNumber":166,"content":"      userName: comment.userName,"},{"type":"INSERT","lineNumber":167,"content":"      userAvatar: comment.userAvatar,"},{"type":"DELETE","lineNumber":167,"oldContent":"      createdAt: comment.createdAt,"},{"type":"INSERT","lineNumber":169,"content":"      timestamp: comment.createdAt,"},{"type":"DELETE","lineNumber":170,"oldContent":"    final result = await addCommentUseCase("},{"type":"DELETE","lineNumber":172,"oldContent":"      AddCommentParams("},{"type":"INSERT","lineNumber":174,"content":"    final result = await addCommentUseCase("},{"type":"INSERT","lineNumber":175,"content":"      AddCommentParams("},{"type":"DELETE","lineNumber":183,"oldContent":"      (failure) => _errorMessage = _mapFailureToMessage(failure),"},{"type":"INSERT","lineNumber":185,"content":"      (failure) => _errorMessage = failure.message,"},{"type":"DELETE","lineNumber":188,"oldContent":"          final updatedComments = List<P.CommentModel>.from(post.comments)..add(newComment);"},{"type":"INSERT","lineNumber":190,"content":"          final newCommentModel = _mapCommentToModel(newComment);"},{"type":"INSERT","lineNumber":191,"content":"          final updatedComments = List<P.CommentModel>.from(post.comments)..add(newCommentModel);"},{"type":"DELETE","lineNumber":190,"oldContent":"          _errorMessage = null;"}]},{"timestamp":1754516732653,"changes":[{"type":"DELETE","lineNumber":167,"oldContent":"      content: comment.content,"},{"type":"DELETE","lineNumber":168,"oldContent":"      userAvatar: comment.userAvatar,"},{"type":"DELETE","lineNumber":169,"oldContent":"    );"},{"type":"INSERT","lineNumber":167,"content":"      userImageUrl: comment.userAvatar ?? '',"},{"type":"INSERT","lineNumber":168,"content":"      text: comment.content,"},{"type":"INSERT","lineNumber":170,"content":"    );"},{"type":"MODIFY","lineNumber":176,"content":"        postId: postId,","oldContent":"        postId: postId,"},{"type":"MODIFY","lineNumber":186,"content":"      (newComment) {","oldContent":"      (newComment) {"},{"type":"DELETE","lineNumber":190,"oldContent":"          _posts[postIndex] = post.copyWith(comments: updatedComments);"},{"type":"INSERT","lineNumber":192,"content":"          _posts[postIndex] = post.copyWith(comments: updatedComments);"}]},{"timestamp":1754516860571,"changes":[{"type":"INSERT","lineNumber":169,"content":"      timestamp: comment.timestamp,"},{"type":"DELETE","lineNumber":170,"oldContent":"      timestamp: comment.createdAt,"},{"type":"INSERT","lineNumber":175,"content":"      AddCommentParams("},{"type":"DELETE","lineNumber":176,"oldContent":"        postId: postId,"},{"type":"INSERT","lineNumber":185,"content":"      (failure) => _errorMessage = failure.message,"},{"type":"DELETE","lineNumber":186,"oldContent":"      (newComment) {"},{"type":"MODIFY","lineNumber":192,"content":"          _posts[postIndex] = post.copyWith(comments: updatedComments);","oldContent":"          _posts[postIndex] = post.copyWith(comments: updatedComments);"}]},{"timestamp":1754517003241,"changes":[{"type":"INSERT","lineNumber":191,"content":"          final updatedComments = List<P.CommentModel>.from(post.comments)..add(newCommentModel);"},{"type":"DELETE","lineNumber":192,"oldContent":"          _posts[postIndex] = post.copyWith(comments: updatedComments);"},{"type":"INSERT","lineNumber":217,"content":"  void init() {"},{"type":"INSERT","lineNumber":218,"content":"    // Initialization logic can be added here."},{"type":"INSERT","lineNumber":219,"content":"  }"},{"type":"INSERT","lineNumber":220,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/data/datasources/family_remote_data_source_impl.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/data/datasources/family_remote_data_source_impl.dart","baseContent":"import 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:family_tree_firebase/core/error/exceptions.dart';\nimport 'package:family_tree_firebase/features/family/data/models/family_model.dart';\nimport 'package:family_tree_firebase/features/family/domain/entities/family.dart';\n\nabstract class FamilyRemoteDataSource {\n  Future<Family> createFamily(String name, String adminId);\n  Future<Family> joinFamily(String inviteCode, String userId);\n  Future<Family?> getFamily(String familyId);\n  Future<bool> checkFamilyMembership(String userId);\n  Future<String> generateInviteCode(String familyId);\n  Future<bool> validateInviteCode(String inviteCode);\n}\n\nclass FamilyRemoteDataSourceImpl implements FamilyRemoteDataSource {\n  final FirebaseFirestore firestore;\n  final FirebaseAuth firebaseAuth;\n\n  FamilyRemoteDataSourceImpl({\n    required this.firestore,\n    required this.firebaseAuth,\n  });\n\n  @override\n  Future<Family> createFamily(String name, String adminId) async {\n    try {\n      // First create the family document\n      final familyDoc = firestore.collection('families').doc();\n      final family = FamilyModel(\n        id: familyDoc.id,\n        name: name,\n        adminId: adminId,\n        memberIds: [adminId],\n        createdAt: DateTime.now(),\n        updatedAt: DateTime.now(),\n      );\n\n      await familyDoc.set(family.toDocument());\n\n      // Update user's family reference\n      await firestore.collection('users').doc(adminId).update({\n        'familyId': family.id,\n        'updatedAt': FieldValue.serverTimestamp(),\n      });\n\n      return family;\n    } catch (e) {\n      throw ServerException('Failed to create family: $e');\n    }\n  }\n\n  @override\n  Future<Family> joinFamily(String inviteCode, String userId) async {\n    try {\n      // Find family by invite code\n      final familyQuery = await firestore\n          .collection('families')\n          .where('inviteCode', isEqualTo: inviteCode)\n          .limit(1)\n          .get();\n\n      if (familyQuery.docs.isEmpty) {\n        throw NotFoundException(message: 'Invalid invite code');\n      }\n\n      final familyDoc = familyQuery.docs.first;\n      final family = FamilyModel.fromDocument(familyDoc.data(), familyDoc.id);\n\n      // Check if user is already a member\n      if (family.memberIds.contains(userId)) {\n        return family;\n      }\n\n      // Add user to family members\n      await familyDoc.reference.update({\n        'memberIds': FieldValue.arrayUnion([userId]),\n        'updatedAt': FieldValue.serverTimestamp(),\n      });\n\n      // Update user's family reference\n      await firestore.collection('users').doc(userId).update({\n        'familyId': family.id,\n        'updatedAt': FieldValue.serverTimestamp(),\n      });\n\n      return family.copyWith(\n        memberIds: [...family.memberIds, userId],\n      );\n    } catch (e) {\n      throw ServerException('Failed to join family: $e');\n    }\n  }\n\n  @override\n  Future<Family?> getFamily(String familyId) async {\n    try {\n      final doc = await firestore.collection('families').doc(familyId).get();\n      if (!doc.exists) {\n        return null;\n      }\n      return FamilyModel.fromDocument(doc.data()!, doc.id);\n    } catch (e) {\n      throw ServerException('Failed to get family: $e');\n    }\n  }\n\n  @override\n  Future<bool> checkFamilyMembership(String userId) async {\n    try {\n      final userDoc = await firestore.collection('users').doc(userId).get();\n      final familyId = userDoc.data()?['familyId'] as String?;\n      return familyId != null && familyId.isNotEmpty;\n    } catch (e) {\n      throw ServerException('Failed to check family membership: $e');\n    }\n  }\n\n  @override\n  Future<String> generateInviteCode(String familyId) async {\n    try {\n      // Generate a random 8-character alphanumeric code\n      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n      final random = DateTime.now().millisecondsSinceEpoch;\n      final code = String.fromCharCodes(\n        Iterable.generate(\n          8,\n          (index) => chars.codeUnitAt((random + index) % chars.length),\n        ),\n      );\n\n      // Save the invite code\n      await firestore.collection('families').doc(familyId).update({\n        'inviteCode': code,\n        'updatedAt': FieldValue.serverTimestamp(),\n      });\n\n      return code;\n    } catch (e) {\n      throw ServerException('Failed to generate invite code: $e');\n    }\n  }\n\n  @override\n  Future<bool> validateInviteCode(String inviteCode) async {\n    try {\n      final result = await firestore\n          .collection('families')\n          .where('inviteCode', isEqualTo: inviteCode)\n          .limit(1)\n          .get();\n\n      return result.docs.isNotEmpty;\n    } catch (e) {\n      throw ServerException('Failed to validate invite code: $e');\n    }\n  }\n}\n","baseTimestamp":1754485139999,"deltas":[{"timestamp":1754513951105,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'dart:developer' as developer;"},{"type":"INSERT","lineNumber":1,"content":""},{"type":"INSERT","lineNumber":4,"content":"import 'package:injectable/injectable.dart';"},{"type":"INSERT","lineNumber":5,"content":""},{"type":"INSERT","lineNumber":29,"content":"  @transactional"},{"type":"DELETE","lineNumber":27,"oldContent":"      // First create the family document"},{"type":"DELETE","lineNumber":28,"oldContent":"      final familyDoc = firestore.collection('families').doc();"},{"type":"DELETE","lineNumber":29,"oldContent":"      final now = DateTime.now();"},{"type":"DELETE","lineNumber":30,"oldContent":"      "},{"type":"DELETE","lineNumber":31,"oldContent":"      final family = FamilyModel("},{"type":"DELETE","lineNumber":32,"oldContent":"        id: familyDoc.id,"},{"type":"DELETE","lineNumber":33,"oldContent":"        name: name,"},{"type":"DELETE","lineNumber":34,"oldContent":"        createdBy: adminId,"},{"type":"DELETE","lineNumber":35,"oldContent":"        createdAt: now,"},{"type":"DELETE","lineNumber":36,"oldContent":"        memberIds: [adminId],"},{"type":"DELETE","lineNumber":37,"oldContent":"        memberJoinDates: {adminId: now},"},{"type":"DELETE","lineNumber":38,"oldContent":"      );"},{"type":"INSERT","lineNumber":32,"content":"      // Input validation"},{"type":"INSERT","lineNumber":33,"content":"      if (name.isEmpty) {"},{"type":"INSERT","lineNumber":34,"content":"        throw const ServerException('Family name cannot be empty');"},{"type":"INSERT","lineNumber":35,"content":"      }"},{"type":"INSERT","lineNumber":36,"content":"      if (adminId.isEmpty) {"},{"type":"INSERT","lineNumber":37,"content":"        throw const ServerException('Admin ID cannot be empty');"},{"type":"INSERT","lineNumber":38,"content":"      }"},{"type":"MODIFY","lineNumber":40,"content":"      // Check if user already has a family","oldContent":"      await familyDoc.set(family.toJson());"},{"type":"INSERT","lineNumber":41,"content":"      final userDoc = await firestore.collection('users').doc(adminId).get();"},{"type":"INSERT","lineNumber":42,"content":"      if (userDoc.exists && userDoc.data()?['familyId'] != null) {"},{"type":"INSERT","lineNumber":43,"content":"        throw const ServerException('User already belongs to a family');"},{"type":"INSERT","lineNumber":44,"content":"      }"},{"type":"DELETE","lineNumber":42,"oldContent":"      // Update user's family reference"},{"type":"DELETE","lineNumber":43,"oldContent":"      await firestore.collection('users').doc(adminId).update({"},{"type":"DELETE","lineNumber":44,"oldContent":"        'familyId': family.id,"},{"type":"DELETE","lineNumber":45,"oldContent":"      });"},{"type":"INSERT","lineNumber":46,"content":"      // Create the family document within a transaction"},{"type":"INSERT","lineNumber":47,"content":"      return await firestore.runTransaction<Family>((transaction) async {"},{"type":"INSERT","lineNumber":48,"content":"        final familyDoc = firestore.collection('families').doc();"},{"type":"INSERT","lineNumber":49,"content":"        final now = DateTime.now();"},{"type":"INSERT","lineNumber":50,"content":"        "},{"type":"INSERT","lineNumber":51,"content":"        final family = FamilyModel("},{"type":"INSERT","lineNumber":52,"content":"          id: familyDoc.id,"},{"type":"INSERT","lineNumber":53,"content":"          name: name.trim(),"},{"type":"INSERT","lineNumber":54,"content":"          createdBy: adminId,"},{"type":"INSERT","lineNumber":55,"content":"          createdAt: now,"},{"type":"INSERT","lineNumber":56,"content":"          memberIds: [adminId],"},{"type":"INSERT","lineNumber":57,"content":"          memberJoinDates: {adminId: now},"},{"type":"INSERT","lineNumber":58,"content":"        );"},{"type":"DELETE","lineNumber":47,"oldContent":"      throw const ServerException('Failed to create family');"},{"type":"DELETE","lineNumber":48,"oldContent":"      return family;"},{"type":"INSERT","lineNumber":60,"content":"        // Set family document"},{"type":"INSERT","lineNumber":61,"content":"        transaction.set(familyDoc, family.toJson());"},{"type":"INSERT","lineNumber":62,"content":""},{"type":"INSERT","lineNumber":63,"content":"        // Update user's family reference"},{"type":"INSERT","lineNumber":64,"content":"        transaction.update("},{"type":"INSERT","lineNumber":65,"content":"          firestore.collection('users').doc(adminId),"},{"type":"INSERT","lineNumber":66,"content":"          {'familyId': family.id},"},{"type":"INSERT","lineNumber":67,"content":"        );"},{"type":"INSERT","lineNumber":68,"content":""},{"type":"INSERT","lineNumber":69,"content":"        return family;"},{"type":"INSERT","lineNumber":70,"content":"      });"},{"type":"INSERT","lineNumber":71,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":72,"content":"      developer.log('Firebase error creating family: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":73,"content":"      throw const ServerException('Failed to create family. Please try again.');"},{"type":"INSERT","lineNumber":75,"content":"      developer.log('Unexpected error creating family: $e');"},{"type":"INSERT","lineNumber":76,"content":"      rethrow;"},{"type":"DELETE","lineNumber":62,"oldContent":"        throw const ServerException('Invalid invite code');"},{"type":"INSERT","lineNumber":91,"content":"        throw const ServerException('Invalid invite code');"},{"type":"DELETE","lineNumber":94,"oldContent":"      throw const ServerException('Failed to join family');"},{"type":"INSERT","lineNumber":123,"content":"      throw const ServerException('Failed to join family');"},{"type":"DELETE","lineNumber":110,"oldContent":"      throw const ServerException('Failed to get family');"},{"type":"INSERT","lineNumber":139,"content":"      throw const ServerException('Failed to get family');"},{"type":"DELETE","lineNumber":121,"oldContent":"      throw const ServerException('Failed to check family membership');"},{"type":"INSERT","lineNumber":150,"content":"      throw const ServerException('Failed to check family membership');"},{"type":"DELETE","lineNumber":144,"oldContent":"        'inviteCodeExpiresAt': expiresAt,"},{"type":"DELETE","lineNumber":145,"oldContent":"        'inviteCodeExpiresAt': expiresAt,"},{"type":"INSERT","lineNumber":171,"content":"      await firestore.collection('families').doc(familyId).update({"},{"type":"INSERT","lineNumber":173,"content":"        'inviteCodeExpiresAt': expiresAt,"},{"type":"DELETE","lineNumber":149,"oldContent":"      throw const ServerException('Failed to generate invite code');"},{"type":"INSERT","lineNumber":178,"content":"      throw const ServerException('Failed to generate invite code');"},{"type":"DELETE","lineNumber":164,"oldContent":"      throw const ServerException('Failed to validate invite code');"},{"type":"INSERT","lineNumber":193,"content":"      throw const ServerException('Failed to validate invite code');"}]},{"timestamp":1754513980808,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:cloud_firestore/cloud_firestore.dart';","oldContent":"import 'package:cloud_firestore/cloud_firestore.dart';"},{"type":"INSERT","lineNumber":4,"content":"import 'package:injectable/injectable.dart';"},{"type":"INSERT","lineNumber":5,"content":""},{"type":"DELETE","lineNumber":6,"oldContent":"import 'package:injectable/injectable.dart';"},{"type":"DELETE","lineNumber":9,"oldContent":""},{"type":"INSERT","lineNumber":29,"content":"  @transactional"},{"type":"DELETE","lineNumber":31,"oldContent":"  @transactional"},{"type":"DELETE","lineNumber":42,"oldContent":""},{"type":"MODIFY","lineNumber":46,"content":"      // Create the family document within a transaction","oldContent":"      // Create the family document within a transaction"},{"type":"DELETE","lineNumber":51,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":53,"oldContent":"    }"},{"type":"DELETE","lineNumber":55,"oldContent":"  }"},{"type":"DELETE","lineNumber":57,"oldContent":""},{"type":"DELETE","lineNumber":59,"oldContent":"  @override"},{"type":"DELETE","lineNumber":61,"oldContent":"  Future<Family> joinFamily(String inviteCode, String userId) async {"},{"type":"DELETE","lineNumber":63,"oldContent":"    try {"},{"type":"DELETE","lineNumber":65,"oldContent":"      // Find family by invite code"},{"type":"DELETE","lineNumber":67,"oldContent":"      final familyQuery = await firestore"},{"type":"DELETE","lineNumber":69,"oldContent":"          .collection('families')"},{"type":"DELETE","lineNumber":70,"oldContent":"          .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"INSERT","lineNumber":59,"content":""},{"type":"DELETE","lineNumber":72,"oldContent":"          .limit(1)"},{"type":"DELETE","lineNumber":74,"oldContent":"          .get();"},{"type":"DELETE","lineNumber":77,"oldContent":""},{"type":"DELETE","lineNumber":79,"oldContent":"      if (familyQuery.docs.isEmpty) {"},{"type":"DELETE","lineNumber":81,"oldContent":"      }"},{"type":"DELETE","lineNumber":83,"oldContent":""},{"type":"DELETE","lineNumber":85,"oldContent":"      final familyDoc = familyQuery.docs.first;"},{"type":"DELETE","lineNumber":87,"oldContent":"      final family = FamilyModel.fromJson({"},{"type":"DELETE","lineNumber":89,"oldContent":"        ...familyDoc.data(),"},{"type":"DELETE","lineNumber":91,"oldContent":"        'id': familyDoc.id,"},{"type":"DELETE","lineNumber":93,"oldContent":"      });"},{"type":"DELETE","lineNumber":95,"oldContent":""},{"type":"DELETE","lineNumber":97,"oldContent":"      // Check if user is already a member"},{"type":"DELETE","lineNumber":98,"oldContent":"      if (family.memberIds.contains(userId)) {"},{"type":"INSERT","lineNumber":74,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":100,"oldContent":"        return family;"},{"type":"INSERT","lineNumber":77,"content":"    }"},{"type":"INSERT","lineNumber":78,"content":"  }"},{"type":"INSERT","lineNumber":79,"content":""},{"type":"INSERT","lineNumber":80,"content":"  @override"},{"type":"INSERT","lineNumber":81,"content":"  @transactional"},{"type":"INSERT","lineNumber":82,"content":"  Future<Family> joinFamily(String inviteCode, String userId) async {"},{"type":"INSERT","lineNumber":83,"content":"    try {"},{"type":"INSERT","lineNumber":84,"content":"      // Input validation"},{"type":"INSERT","lineNumber":85,"content":"      if (inviteCode.isEmpty) {"},{"type":"INSERT","lineNumber":86,"content":"        throw const ServerException('Invite code cannot be empty');"},{"type":"INSERT","lineNumber":88,"content":"      if (userId.isEmpty) {"},{"type":"INSERT","lineNumber":89,"content":"        throw const ServerException('User ID cannot be empty');"},{"type":"INSERT","lineNumber":90,"content":"      }"},{"type":"DELETE","lineNumber":104,"oldContent":"      final now = DateTime.now();"},{"type":"DELETE","lineNumber":105,"oldContent":"      "},{"type":"DELETE","lineNumber":106,"oldContent":"      // Add user to family members"},{"type":"DELETE","lineNumber":107,"oldContent":"      await familyDoc.reference.update({"},{"type":"DELETE","lineNumber":108,"oldContent":"        'memberIds': FieldValue.arrayUnion([userId]),"},{"type":"DELETE","lineNumber":109,"oldContent":"        'memberJoinDates.${userId}': now,"},{"type":"DELETE","lineNumber":110,"oldContent":"      });"},{"type":"INSERT","lineNumber":92,"content":"      // Check if user already has a family"},{"type":"INSERT","lineNumber":93,"content":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"INSERT","lineNumber":94,"content":"      if (userDoc.exists && userDoc.data()?['familyId'] != null) {"},{"type":"INSERT","lineNumber":95,"content":"        throw const ServerException('You already belong to a family');"},{"type":"INSERT","lineNumber":96,"content":"      }"},{"type":"DELETE","lineNumber":112,"oldContent":"      // Update user's family reference"},{"type":"DELETE","lineNumber":113,"oldContent":"      await firestore.collection('users').doc(userId).update({"},{"type":"DELETE","lineNumber":114,"oldContent":"        'familyId': family.id,"},{"type":"DELETE","lineNumber":115,"oldContent":"      });"},{"type":"INSERT","lineNumber":98,"content":"      // Find family by invite code within a transaction"},{"type":"INSERT","lineNumber":99,"content":"      return await firestore.runTransaction<Family>((transaction) async {"},{"type":"INSERT","lineNumber":100,"content":"        final familyQuery = await transaction.get("},{"type":"INSERT","lineNumber":101,"content":"          firestore"},{"type":"INSERT","lineNumber":102,"content":"              .collection('families')"},{"type":"INSERT","lineNumber":103,"content":"              .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"INSERT","lineNumber":104,"content":"              .limit(1),"},{"type":"INSERT","lineNumber":105,"content":"        );"},{"type":"DELETE","lineNumber":117,"oldContent":"        throw const ServerException('Invalid invite code');"},{"type":"DELETE","lineNumber":118,"oldContent":"      return family.copyWith("},{"type":"DELETE","lineNumber":119,"oldContent":"        memberIds: [...family.memberIds, userId],"},{"type":"DELETE","lineNumber":120,"oldContent":"        memberJoinDates: {...family.memberJoinDates, userId: now},"},{"type":"DELETE","lineNumber":121,"oldContent":"      );"},{"type":"INSERT","lineNumber":107,"content":"        if (familyQuery.docs.isEmpty) {"},{"type":"INSERT","lineNumber":108,"content":"          throw const ServerException('Invalid or expired invite code');"},{"type":"INSERT","lineNumber":109,"content":"        }"},{"type":"INSERT","lineNumber":110,"content":""},{"type":"INSERT","lineNumber":111,"content":"        final familyDoc = familyQuery.docs.first;"},{"type":"INSERT","lineNumber":112,"content":"        final familyData = familyDoc.data() as Map<String, dynamic>;"},{"type":"INSERT","lineNumber":113,"content":"        "},{"type":"INSERT","lineNumber":114,"content":"        // Check if invite code is expired"},{"type":"INSERT","lineNumber":115,"content":"        final expiresAt = familyData['inviteCodeExpiresAt'] as Timestamp?;"},{"type":"INSERT","lineNumber":116,"content":"        if (expiresAt != null && expiresAt.toDate().isBefore(DateTime.now())) {"},{"type":"INSERT","lineNumber":117,"content":"          // Clean up expired code"},{"type":"INSERT","lineNumber":118,"content":"          transaction.update(familyDoc.reference, {"},{"type":"INSERT","lineNumber":119,"content":"            'currentInviteCode': null,"},{"type":"INSERT","lineNumber":120,"content":"            'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":121,"content":"          });"},{"type":"INSERT","lineNumber":122,"content":"          throw const ServerException('Invite code has expired');"},{"type":"INSERT","lineNumber":123,"content":"        }"},{"type":"INSERT","lineNumber":124,"content":""},{"type":"INSERT","lineNumber":125,"content":"        final family = FamilyModel.fromJson({"},{"type":"INSERT","lineNumber":126,"content":"          ...familyData,"},{"type":"INSERT","lineNumber":127,"content":"          'id': familyDoc.id,"},{"type":"INSERT","lineNumber":128,"content":"        });"},{"type":"INSERT","lineNumber":129,"content":""},{"type":"INSERT","lineNumber":130,"content":"        // Check if user is already a member"},{"type":"INSERT","lineNumber":131,"content":"        if (family.memberIds.contains(userId)) {"},{"type":"INSERT","lineNumber":132,"content":"          return family;"},{"type":"INSERT","lineNumber":133,"content":"        }"},{"type":"INSERT","lineNumber":134,"content":""},{"type":"INSERT","lineNumber":135,"content":"        final now = DateTime.now();"},{"type":"INSERT","lineNumber":136,"content":"        "},{"type":"INSERT","lineNumber":137,"content":"        // Add user to family members"},{"type":"INSERT","lineNumber":138,"content":"        transaction.update(familyDoc.reference, {"},{"type":"INSERT","lineNumber":139,"content":"          'memberIds': FieldValue.arrayUnion([userId]),"},{"type":"INSERT","lineNumber":140,"content":"          'memberJoinDates.${userId}': now,"},{"type":"INSERT","lineNumber":141,"content":"        });"},{"type":"INSERT","lineNumber":142,"content":""},{"type":"INSERT","lineNumber":143,"content":"        // Update user's family reference"},{"type":"INSERT","lineNumber":144,"content":"        transaction.update("},{"type":"INSERT","lineNumber":145,"content":"          firestore.collection('users').doc(userId),"},{"type":"INSERT","lineNumber":146,"content":"          {'familyId': family.id},"},{"type":"INSERT","lineNumber":147,"content":"        );"},{"type":"INSERT","lineNumber":148,"content":""},{"type":"INSERT","lineNumber":149,"content":"        return family.copyWith("},{"type":"INSERT","lineNumber":150,"content":"          memberIds: [...family.memberIds, userId],"},{"type":"INSERT","lineNumber":151,"content":"          memberJoinDates: {...family.memberJoinDates, userId: now},"},{"type":"INSERT","lineNumber":152,"content":"        );"},{"type":"INSERT","lineNumber":153,"content":"      });"},{"type":"INSERT","lineNumber":154,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":155,"content":"      developer.log('Firebase error joining family: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":156,"content":"      throw const ServerException('Failed to join family. Please try again.');"},{"type":"INSERT","lineNumber":157,"content":"    } on ServerException {"},{"type":"INSERT","lineNumber":158,"content":"      rethrow;"},{"type":"INSERT","lineNumber":160,"content":"      developer.log('Unexpected error joining family: $e');"},{"type":"INSERT","lineNumber":161,"content":"      throw const ServerException('An unexpected error occurred');"},{"type":"INSERT","lineNumber":177,"content":"      throw const ServerException('Failed to get family');"},{"type":"DELETE","lineNumber":147,"oldContent":"      throw const ServerException('Failed to join family');"},{"type":"INSERT","lineNumber":188,"content":"      throw const ServerException('Failed to check family membership');"},{"type":"DELETE","lineNumber":164,"oldContent":"      throw const ServerException('Failed to get family');"},{"type":"INSERT","lineNumber":209,"content":"      await firestore.collection('families').doc(familyId).update({"},{"type":"INSERT","lineNumber":211,"content":"        'inviteCodeExpiresAt': expiresAt,"},{"type":"DELETE","lineNumber":173,"oldContent":"      throw const ServerException('Failed to check family membership');"},{"type":"INSERT","lineNumber":216,"content":"      throw const ServerException('Failed to generate invite code');"},{"type":"INSERT","lineNumber":231,"content":"      throw const ServerException('Failed to validate invite code');"},{"type":"DELETE","lineNumber":194,"oldContent":"      await firestore.collection('families').doc(familyId).update({"},{"type":"DELETE","lineNumber":195,"oldContent":"      throw const ServerException('Failed to validate invite code');"},{"type":"DELETE","lineNumber":196,"oldContent":"      throw const ServerException('Failed to generate invite code');"},{"type":"DELETE","lineNumber":197,"oldContent":"        'inviteCodeExpiresAt': expiresAt,"}]},{"timestamp":1754513993981,"changes":[{"type":"INSERT","lineNumber":1,"content":""},{"type":"DELETE","lineNumber":2,"oldContent":"import 'package:cloud_firestore/cloud_firestore.dart';"},{"type":"MODIFY","lineNumber":6,"content":"import 'package:family_tree_firebase/core/error/exceptions.dart';","oldContent":"import 'package:family_tree_firebase/core/error/exceptions.dart';"},{"type":"MODIFY","lineNumber":46,"content":"      // Create the family document within a transaction","oldContent":"      // Create the family document within a transaction"},{"type":"DELETE","lineNumber":54,"oldContent":""},{"type":"INSERT","lineNumber":59,"content":""},{"type":"DELETE","lineNumber":62,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":64,"content":"        transaction.update("},{"type":"INSERT","lineNumber":65,"content":"          firestore.collection('users').doc(adminId),"},{"type":"INSERT","lineNumber":66,"content":"          {'familyId': family.id},"},{"type":"INSERT","lineNumber":67,"content":"        );"},{"type":"INSERT","lineNumber":68,"content":""},{"type":"INSERT","lineNumber":69,"content":"        return family;"},{"type":"INSERT","lineNumber":70,"content":"      });"},{"type":"INSERT","lineNumber":71,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":72,"content":"      developer.log('Firebase error creating family: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":73,"content":"      throw const ServerException('Failed to create family. Please try again.');"},{"type":"INSERT","lineNumber":74,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":75,"content":"      developer.log('Unexpected error creating family: $e');"},{"type":"INSERT","lineNumber":76,"content":"      rethrow;"},{"type":"DELETE","lineNumber":67,"oldContent":"        transaction.update("},{"type":"DELETE","lineNumber":70,"oldContent":"          firestore.collection('users').doc(adminId),"},{"type":"DELETE","lineNumber":73,"oldContent":"          {'familyId': family.id},"},{"type":"DELETE","lineNumber":76,"oldContent":"        );"},{"type":"DELETE","lineNumber":79,"oldContent":""},{"type":"INSERT","lineNumber":87,"content":"      }"},{"type":"DELETE","lineNumber":81,"oldContent":"        return family;"},{"type":"DELETE","lineNumber":84,"oldContent":"      });"},{"type":"INSERT","lineNumber":91,"content":""},{"type":"DELETE","lineNumber":86,"oldContent":"    } on FirebaseException catch (e) {"},{"type":"DELETE","lineNumber":89,"oldContent":"      developer.log('Firebase error creating family: ${e.message}', error: e);"},{"type":"DELETE","lineNumber":92,"oldContent":"      throw const ServerException('Failed to create family. Please try again.');"},{"type":"INSERT","lineNumber":97,"content":""},{"type":"DELETE","lineNumber":95,"oldContent":"      developer.log('Unexpected error creating family: $e');"},{"type":"DELETE","lineNumber":98,"oldContent":"      rethrow;"},{"type":"DELETE","lineNumber":100,"oldContent":"      }"},{"type":"DELETE","lineNumber":102,"oldContent":""},{"type":"INSERT","lineNumber":106,"content":""},{"type":"DELETE","lineNumber":110,"oldContent":""},{"type":"DELETE","lineNumber":116,"oldContent":""},{"type":"DELETE","lineNumber":123,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":125,"oldContent":"    }"},{"type":"DELETE","lineNumber":127,"oldContent":"  }"},{"type":"DELETE","lineNumber":129,"oldContent":""},{"type":"DELETE","lineNumber":131,"oldContent":"  @override"},{"type":"DELETE","lineNumber":133,"oldContent":"  Future<Family?> getFamily(String familyId) async {"},{"type":"DELETE","lineNumber":135,"oldContent":"    try {"},{"type":"DELETE","lineNumber":137,"oldContent":"      final doc = await firestore.collection('families').doc(familyId).get();"},{"type":"DELETE","lineNumber":139,"oldContent":"      if (!doc.exists) {"},{"type":"DELETE","lineNumber":141,"oldContent":"        return null;"},{"type":"DELETE","lineNumber":143,"oldContent":"      }"},{"type":"DELETE","lineNumber":145,"oldContent":"      return FamilyModel.fromJson({"},{"type":"DELETE","lineNumber":147,"oldContent":"        ...doc.data()!,"},{"type":"DELETE","lineNumber":149,"oldContent":"        'id': doc.id,"},{"type":"DELETE","lineNumber":151,"oldContent":"      });"},{"type":"DELETE","lineNumber":153,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":155,"oldContent":"    }"},{"type":"DELETE","lineNumber":157,"oldContent":"  }"},{"type":"DELETE","lineNumber":159,"oldContent":""},{"type":"DELETE","lineNumber":161,"oldContent":"  @override"},{"type":"DELETE","lineNumber":163,"oldContent":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"DELETE","lineNumber":165,"oldContent":"    try {"},{"type":"DELETE","lineNumber":167,"oldContent":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"DELETE","lineNumber":169,"oldContent":"      final familyId = userDoc.data()?['familyId'] as String?;"},{"type":"DELETE","lineNumber":171,"oldContent":"      return familyId != null && familyId.isNotEmpty;"},{"type":"DELETE","lineNumber":174,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":176,"oldContent":"    }"},{"type":"DELETE","lineNumber":178,"oldContent":"  }"},{"type":"DELETE","lineNumber":180,"oldContent":""},{"type":"DELETE","lineNumber":182,"oldContent":"  @override"},{"type":"DELETE","lineNumber":184,"oldContent":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"DELETE","lineNumber":186,"oldContent":"    try {"},{"type":"DELETE","lineNumber":188,"oldContent":"      // Generate a random 8-character alphanumeric code"},{"type":"DELETE","lineNumber":190,"oldContent":"      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';"},{"type":"DELETE","lineNumber":192,"oldContent":"      final random = DateTime.now().millisecondsSinceEpoch;"},{"type":"INSERT","lineNumber":159,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":160,"content":"      developer.log('Unexpected error joining family: $e');"},{"type":"INSERT","lineNumber":161,"content":"      throw const ServerException('An unexpected error occurred');"},{"type":"INSERT","lineNumber":162,"content":"    }"},{"type":"INSERT","lineNumber":163,"content":"  }"},{"type":"INSERT","lineNumber":164,"content":""},{"type":"INSERT","lineNumber":165,"content":"  @override"},{"type":"INSERT","lineNumber":166,"content":"  Future<Family?> getFamily(String familyId) async {"},{"type":"INSERT","lineNumber":167,"content":"    try {"},{"type":"INSERT","lineNumber":168,"content":"      // Input validation"},{"type":"INSERT","lineNumber":169,"content":"      if (familyId.isEmpty) {"},{"type":"INSERT","lineNumber":170,"content":"        developer.log('Attempted to get family with empty ID');"},{"type":"INSERT","lineNumber":171,"content":"        return null;"},{"type":"INSERT","lineNumber":172,"content":"      }"},{"type":"INSERT","lineNumber":173,"content":""},{"type":"INSERT","lineNumber":174,"content":"      // Get document with server timestamp"},{"type":"INSERT","lineNumber":175,"content":"      final doc = await firestore"},{"type":"INSERT","lineNumber":176,"content":"          .collection('families')"},{"type":"INSERT","lineNumber":177,"content":"          .doc(familyId)"},{"type":"INSERT","lineNumber":178,"content":"          .get(const GetOptions(source: Source.server));"},{"type":"INSERT","lineNumber":179,"content":"      "},{"type":"INSERT","lineNumber":180,"content":"      if (!doc.exists) {"},{"type":"INSERT","lineNumber":181,"content":"        developer.log('Family not found with ID: $familyId');"},{"type":"INSERT","lineNumber":182,"content":"        return null;"},{"type":"INSERT","lineNumber":183,"content":"      }"},{"type":"INSERT","lineNumber":184,"content":""},{"type":"INSERT","lineNumber":185,"content":"      try {"},{"type":"INSERT","lineNumber":186,"content":"        final familyData = doc.data();"},{"type":"INSERT","lineNumber":187,"content":"        if (familyData == null) {"},{"type":"INSERT","lineNumber":188,"content":"          developer.log('Family data is null for ID: $familyId');"},{"type":"INSERT","lineNumber":189,"content":"          return null;"},{"type":"INSERT","lineNumber":190,"content":"        }"},{"type":"INSERT","lineNumber":191,"content":""},{"type":"INSERT","lineNumber":192,"content":"        return FamilyModel.fromJson({"},{"type":"INSERT","lineNumber":193,"content":"          ...familyData,"},{"type":"INSERT","lineNumber":194,"content":"          'id': doc.id,"},{"type":"INSERT","lineNumber":195,"content":"        });"},{"type":"INSERT","lineNumber":196,"content":"      } on FormatException catch (e) {"},{"type":"INSERT","lineNumber":197,"content":"        developer.log('Error parsing family data: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":198,"content":"        throw const ServerException('Invalid family data format');"},{"type":"INSERT","lineNumber":199,"content":"      }"},{"type":"INSERT","lineNumber":200,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":201,"content":"      developer.log('Firebase error getting family: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":202,"content":"      throw const ServerException('Failed to retrieve family information');"},{"type":"INSERT","lineNumber":203,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":204,"content":"      developer.log('Unexpected error getting family: $e');"},{"type":"INSERT","lineNumber":205,"content":"      rethrow;"},{"type":"INSERT","lineNumber":206,"content":"    }"},{"type":"INSERT","lineNumber":207,"content":"  }"},{"type":"INSERT","lineNumber":208,"content":""},{"type":"INSERT","lineNumber":209,"content":"  @override"},{"type":"INSERT","lineNumber":210,"content":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"INSERT","lineNumber":211,"content":"    try {"},{"type":"INSERT","lineNumber":212,"content":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"INSERT","lineNumber":213,"content":"      final familyId = userDoc.data()?['familyId'] as String?;"},{"type":"INSERT","lineNumber":214,"content":"      return familyId != null && familyId.isNotEmpty;"},{"type":"INSERT","lineNumber":215,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":216,"content":"      throw const ServerException('Failed to check family membership');"},{"type":"INSERT","lineNumber":217,"content":"    }"},{"type":"INSERT","lineNumber":218,"content":"  }"},{"type":"INSERT","lineNumber":219,"content":""},{"type":"INSERT","lineNumber":220,"content":"  @override"},{"type":"INSERT","lineNumber":221,"content":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"INSERT","lineNumber":222,"content":"    try {"},{"type":"INSERT","lineNumber":223,"content":"      // Generate a random 8-character alphanumeric code"},{"type":"INSERT","lineNumber":224,"content":"      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';"},{"type":"INSERT","lineNumber":225,"content":"      final random = DateTime.now().millisecondsSinceEpoch;"},{"type":"DELETE","lineNumber":196,"oldContent":"      developer.log('Unexpected error joining family: $e');"},{"type":"DELETE","lineNumber":198,"oldContent":"      throw const ServerException('An unexpected error occurred');"},{"type":"INSERT","lineNumber":237,"content":"      await firestore.collection('families').doc(familyId).update({"},{"type":"INSERT","lineNumber":239,"content":"        'inviteCodeExpiresAt': expiresAt,"},{"type":"INSERT","lineNumber":244,"content":"      throw const ServerException('Failed to generate invite code');"},{"type":"DELETE","lineNumber":213,"oldContent":"      throw const ServerException('Failed to get family');"},{"type":"DELETE","lineNumber":225,"oldContent":"      throw const ServerException('Failed to check family membership');"},{"type":"INSERT","lineNumber":259,"content":"      throw const ServerException('Failed to validate invite code');"},{"type":"DELETE","lineNumber":232,"oldContent":"      throw const ServerException('Failed to validate invite code');"},{"type":"DELETE","lineNumber":233,"oldContent":"      throw const ServerException('Failed to generate invite code');"},{"type":"DELETE","lineNumber":234,"oldContent":"        'inviteCodeExpiresAt': expiresAt,"},{"type":"DELETE","lineNumber":235,"oldContent":"      await firestore.collection('families').doc(familyId).update({"}]},{"timestamp":1754514029647,"changes":[{"type":"INSERT","lineNumber":5,"content":""},{"type":"DELETE","lineNumber":6,"oldContent":"import 'package:family_tree_firebase/core/error/exceptions.dart';"},{"type":"INSERT","lineNumber":45,"content":""},{"type":"DELETE","lineNumber":46,"oldContent":"      // Create the family document within a transaction"},{"type":"MODIFY","lineNumber":59,"content":"","oldContent":""},{"type":"MODIFY","lineNumber":64,"content":"        transaction.update(","oldContent":"        transaction.update("},{"type":"DELETE","lineNumber":66,"oldContent":"    }"},{"type":"DELETE","lineNumber":68,"oldContent":"  }"},{"type":"DELETE","lineNumber":71,"oldContent":""},{"type":"DELETE","lineNumber":73,"oldContent":"  @override"},{"type":"DELETE","lineNumber":76,"oldContent":"  @transactional"},{"type":"DELETE","lineNumber":78,"oldContent":"  Future<Family> joinFamily(String inviteCode, String userId) async {"},{"type":"DELETE","lineNumber":81,"oldContent":"    try {"},{"type":"DELETE","lineNumber":83,"oldContent":"      // Input validation"},{"type":"INSERT","lineNumber":77,"content":"    }"},{"type":"INSERT","lineNumber":78,"content":"  }"},{"type":"INSERT","lineNumber":79,"content":""},{"type":"INSERT","lineNumber":80,"content":"  @override"},{"type":"INSERT","lineNumber":81,"content":"  @transactional"},{"type":"INSERT","lineNumber":82,"content":"  Future<Family> joinFamily(String inviteCode, String userId) async {"},{"type":"INSERT","lineNumber":83,"content":"    try {"},{"type":"INSERT","lineNumber":84,"content":"      // Input validation"},{"type":"INSERT","lineNumber":87,"content":"      }"},{"type":"INSERT","lineNumber":91,"content":""},{"type":"DELETE","lineNumber":91,"oldContent":"      }"},{"type":"DELETE","lineNumber":95,"oldContent":""},{"type":"INSERT","lineNumber":97,"content":""},{"type":"DELETE","lineNumber":100,"oldContent":""},{"type":"MODIFY","lineNumber":107,"content":"        if (familyQuery.docs.isEmpty) {","oldContent":"        if (familyQuery.docs.isEmpty) {"},{"type":"INSERT","lineNumber":141,"content":"        });"},{"type":"INSERT","lineNumber":142,"content":""},{"type":"INSERT","lineNumber":143,"content":"        // Update user's family reference"},{"type":"INSERT","lineNumber":144,"content":"        transaction.update("},{"type":"INSERT","lineNumber":145,"content":"          firestore.collection('users').doc(userId),"},{"type":"INSERT","lineNumber":146,"content":"          {'familyId': family.id},"},{"type":"INSERT","lineNumber":147,"content":"        );"},{"type":"INSERT","lineNumber":148,"content":""},{"type":"INSERT","lineNumber":149,"content":"        return family.copyWith("},{"type":"INSERT","lineNumber":150,"content":"          memberIds: [...family.memberIds, userId],"},{"type":"INSERT","lineNumber":151,"content":"          memberJoinDates: {...family.memberJoinDates, userId: now},"},{"type":"INSERT","lineNumber":152,"content":"        );"},{"type":"INSERT","lineNumber":153,"content":"      });"},{"type":"INSERT","lineNumber":154,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":155,"content":"      developer.log('Firebase error joining family: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":156,"content":"      throw const ServerException('Failed to join family. Please try again.');"},{"type":"INSERT","lineNumber":157,"content":"    } on ServerException {"},{"type":"INSERT","lineNumber":158,"content":"      rethrow;"},{"type":"DELETE","lineNumber":143,"oldContent":"        });"},{"type":"DELETE","lineNumber":146,"oldContent":""},{"type":"DELETE","lineNumber":149,"oldContent":"        // Update user's family reference"},{"type":"DELETE","lineNumber":152,"oldContent":"        transaction.update("},{"type":"DELETE","lineNumber":155,"oldContent":"          firestore.collection('users').doc(userId),"},{"type":"DELETE","lineNumber":158,"oldContent":"          {'familyId': family.id},"},{"type":"DELETE","lineNumber":161,"oldContent":"        );"},{"type":"DELETE","lineNumber":163,"oldContent":""},{"type":"DELETE","lineNumber":166,"oldContent":"        return family.copyWith("},{"type":"DELETE","lineNumber":169,"oldContent":"          memberIds: [...family.memberIds, userId],"},{"type":"DELETE","lineNumber":172,"oldContent":"          memberJoinDates: {...family.memberJoinDates, userId: now},"},{"type":"DELETE","lineNumber":175,"oldContent":"        );"},{"type":"DELETE","lineNumber":178,"oldContent":"      });"},{"type":"DELETE","lineNumber":181,"oldContent":"    } on FirebaseException catch (e) {"},{"type":"DELETE","lineNumber":184,"oldContent":"      developer.log('Firebase error joining family: ${e.message}', error: e);"},{"type":"DELETE","lineNumber":187,"oldContent":"      throw const ServerException('Failed to join family. Please try again.');"},{"type":"DELETE","lineNumber":190,"oldContent":"    } on ServerException {"},{"type":"DELETE","lineNumber":193,"oldContent":"      rethrow;"},{"type":"DELETE","lineNumber":195,"oldContent":"      final code = String.fromCharCodes("},{"type":"DELETE","lineNumber":197,"oldContent":"        Iterable.generate("},{"type":"DELETE","lineNumber":200,"oldContent":"          8,"},{"type":"DELETE","lineNumber":203,"oldContent":"          (index) => chars.codeUnitAt((random + index) % chars.length),"},{"type":"DELETE","lineNumber":205,"oldContent":"        ),"},{"type":"DELETE","lineNumber":207,"oldContent":"      );"},{"type":"DELETE","lineNumber":209,"oldContent":""},{"type":"DELETE","lineNumber":211,"oldContent":"      // Set the invite code to expire in 7 days"},{"type":"DELETE","lineNumber":213,"oldContent":"      final expiresAt = DateTime.now().add(const Duration(days: 7));"},{"type":"DELETE","lineNumber":215,"oldContent":""},{"type":"DELETE","lineNumber":217,"oldContent":"      // Save the invite code"},{"type":"DELETE","lineNumber":219,"oldContent":"        'currentInviteCode': code,"},{"type":"DELETE","lineNumber":221,"oldContent":"      });"},{"type":"DELETE","lineNumber":223,"oldContent":""},{"type":"DELETE","lineNumber":225,"oldContent":"      return code;"},{"type":"INSERT","lineNumber":212,"content":"      // Input validation"},{"type":"INSERT","lineNumber":213,"content":"      if (userId.isEmpty) {"},{"type":"INSERT","lineNumber":214,"content":"        developer.log('checkFamilyMembership called with empty user ID');"},{"type":"INSERT","lineNumber":215,"content":"        return false;"},{"type":"INSERT","lineNumber":216,"content":"      }"},{"type":"INSERT","lineNumber":217,"content":""},{"type":"INSERT","lineNumber":218,"content":"      // Get user document with server timestamp"},{"type":"INSERT","lineNumber":219,"content":"      final userDoc = await firestore"},{"type":"INSERT","lineNumber":220,"content":"          .collection('users')"},{"type":"INSERT","lineNumber":221,"content":"          .doc(userId)"},{"type":"INSERT","lineNumber":222,"content":"          .get(const GetOptions(source: Source.server));"},{"type":"INSERT","lineNumber":223,"content":"      "},{"type":"INSERT","lineNumber":224,"content":"      if (!userDoc.exists) {"},{"type":"INSERT","lineNumber":225,"content":"        developer.log('User not found with ID: $userId');"},{"type":"INSERT","lineNumber":226,"content":"        return false;"},{"type":"INSERT","lineNumber":227,"content":"      }"},{"type":"INSERT","lineNumber":228,"content":""},{"type":"INSERT","lineNumber":229,"content":"      final userData = userDoc.data();"},{"type":"INSERT","lineNumber":230,"content":"      if (userData == null) {"},{"type":"INSERT","lineNumber":231,"content":"        developer.log('User data is null for ID: $userId');"},{"type":"INSERT","lineNumber":232,"content":"        return false;"},{"type":"INSERT","lineNumber":233,"content":"      }"},{"type":"INSERT","lineNumber":234,"content":""},{"type":"INSERT","lineNumber":235,"content":"      final familyId = userData['familyId'] as String?;"},{"type":"INSERT","lineNumber":236,"content":"      final hasFamily = familyId != null && familyId.isNotEmpty;"},{"type":"INSERT","lineNumber":237,"content":"      "},{"type":"INSERT","lineNumber":238,"content":"      if (hasFamily) {"},{"type":"INSERT","lineNumber":239,"content":"        developer.log('User $userId is a member of family $familyId');"},{"type":"INSERT","lineNumber":240,"content":"      } else {"},{"type":"INSERT","lineNumber":241,"content":"        developer.log('User $userId is not a member of any family');"},{"type":"INSERT","lineNumber":242,"content":"      }"},{"type":"INSERT","lineNumber":243,"content":"      "},{"type":"INSERT","lineNumber":244,"content":"      return hasFamily;"},{"type":"INSERT","lineNumber":245,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":246,"content":"      developer.log("},{"type":"INSERT","lineNumber":247,"content":"        'Firebase error checking family membership: ${e.message}',"},{"type":"INSERT","lineNumber":248,"content":"        error: e,"},{"type":"INSERT","lineNumber":249,"content":"      );"},{"type":"INSERT","lineNumber":250,"content":"      rethrow;"},{"type":"DELETE","lineNumber":228,"oldContent":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"INSERT","lineNumber":252,"content":"      developer.log('Unexpected error checking family membership: $e');"},{"type":"INSERT","lineNumber":253,"content":"      rethrow;"},{"type":"DELETE","lineNumber":230,"oldContent":"      final familyId = userDoc.data()?['familyId'] as String?;"},{"type":"DELETE","lineNumber":231,"oldContent":"      return familyId != null && familyId.isNotEmpty;"},{"type":"DELETE","lineNumber":233,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":235,"oldContent":"      throw const ServerException('Failed to check family membership');"},{"type":"INSERT","lineNumber":258,"content":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"INSERT","lineNumber":259,"content":"    try {"},{"type":"INSERT","lineNumber":260,"content":"      // Generate a random 8-character alphanumeric code"},{"type":"INSERT","lineNumber":261,"content":"      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';"},{"type":"INSERT","lineNumber":262,"content":"      final random = DateTime.now().millisecondsSinceEpoch;"},{"type":"INSERT","lineNumber":263,"content":"      final code = String.fromCharCodes("},{"type":"INSERT","lineNumber":264,"content":"        Iterable.generate("},{"type":"INSERT","lineNumber":265,"content":"          8,"},{"type":"INSERT","lineNumber":266,"content":"          (index) => chars.codeUnitAt((random + index) % chars.length),"},{"type":"INSERT","lineNumber":267,"content":"        ),"},{"type":"INSERT","lineNumber":268,"content":"      );"},{"type":"INSERT","lineNumber":269,"content":""},{"type":"INSERT","lineNumber":270,"content":"      // Set the invite code to expire in 7 days"},{"type":"INSERT","lineNumber":271,"content":"      final expiresAt = DateTime.now().add(const Duration(days: 7));"},{"type":"INSERT","lineNumber":272,"content":""},{"type":"INSERT","lineNumber":273,"content":"      // Save the invite code"},{"type":"INSERT","lineNumber":274,"content":"      await firestore.collection('families').doc(familyId).update({"},{"type":"INSERT","lineNumber":275,"content":"        'currentInviteCode': code,"},{"type":"INSERT","lineNumber":276,"content":"        'inviteCodeExpiresAt': expiresAt,"},{"type":"INSERT","lineNumber":277,"content":"      });"},{"type":"INSERT","lineNumber":278,"content":""},{"type":"INSERT","lineNumber":279,"content":"      return code;"},{"type":"INSERT","lineNumber":280,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":281,"content":"      throw const ServerException('Failed to generate invite code');"},{"type":"DELETE","lineNumber":238,"oldContent":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"DELETE","lineNumber":240,"oldContent":"    try {"},{"type":"DELETE","lineNumber":242,"oldContent":"      final result = await firestore"},{"type":"INSERT","lineNumber":286,"content":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"INSERT","lineNumber":287,"content":"    try {"},{"type":"INSERT","lineNumber":288,"content":"      final result = await firestore"},{"type":"DELETE","lineNumber":245,"oldContent":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"DELETE","lineNumber":247,"oldContent":"    try {"},{"type":"DELETE","lineNumber":249,"oldContent":"      // Generate a random 8-character alphanumeric code"},{"type":"DELETE","lineNumber":251,"oldContent":"      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';"},{"type":"DELETE","lineNumber":253,"oldContent":"      final random = DateTime.now().millisecondsSinceEpoch;"},{"type":"INSERT","lineNumber":296,"content":"      throw const ServerException('Failed to validate invite code');"},{"type":"DELETE","lineNumber":260,"oldContent":"      throw const ServerException('Failed to validate invite code');"},{"type":"DELETE","lineNumber":261,"oldContent":"      await firestore.collection('families').doc(familyId).update({"},{"type":"DELETE","lineNumber":262,"oldContent":"      throw const ServerException('Failed to generate invite code');"},{"type":"DELETE","lineNumber":263,"oldContent":"        'inviteCodeExpiresAt': expiresAt,"}]},{"timestamp":1754514041557,"changes":[{"type":"INSERT","lineNumber":58,"content":"        );"},{"type":"DELETE","lineNumber":59,"oldContent":""},{"type":"INSERT","lineNumber":63,"content":"        // Update user's family reference"},{"type":"DELETE","lineNumber":64,"oldContent":"        transaction.update("},{"type":"DELETE","lineNumber":72,"oldContent":"    }"},{"type":"INSERT","lineNumber":73,"content":"      throw const ServerException('Failed to create family. Please try again.');"},{"type":"INSERT","lineNumber":74,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":75,"content":"      developer.log('Unexpected error creating family: $e');"},{"type":"INSERT","lineNumber":76,"content":"      rethrow;"},{"type":"INSERT","lineNumber":77,"content":"    }"},{"type":"DELETE","lineNumber":76,"oldContent":"      throw const ServerException('Failed to create family. Please try again.');"},{"type":"DELETE","lineNumber":78,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":81,"oldContent":"      developer.log('Unexpected error creating family: $e');"},{"type":"DELETE","lineNumber":84,"oldContent":"      rethrow;"},{"type":"MODIFY","lineNumber":92,"content":"      // Check if user already has a family","oldContent":"      // Check if user already has a family"},{"type":"INSERT","lineNumber":106,"content":""},{"type":"DELETE","lineNumber":107,"oldContent":"        if (familyQuery.docs.isEmpty) {"},{"type":"DELETE","lineNumber":142,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":144,"oldContent":"      developer.log('Unexpected error joining family: $e');"},{"type":"DELETE","lineNumber":147,"oldContent":"      throw const ServerException('An unexpected error occurred');"},{"type":"DELETE","lineNumber":149,"oldContent":"    }"},{"type":"DELETE","lineNumber":152,"oldContent":"  }"},{"type":"DELETE","lineNumber":154,"oldContent":""},{"type":"DELETE","lineNumber":157,"oldContent":"  @override"},{"type":"DELETE","lineNumber":159,"oldContent":"  Future<Family?> getFamily(String familyId) async {"},{"type":"DELETE","lineNumber":162,"oldContent":"    try {"},{"type":"DELETE","lineNumber":164,"oldContent":"      // Input validation"},{"type":"DELETE","lineNumber":167,"oldContent":"      if (familyId.isEmpty) {"},{"type":"DELETE","lineNumber":169,"oldContent":"        developer.log('Attempted to get family with empty ID');"},{"type":"INSERT","lineNumber":159,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":160,"content":"      developer.log('Unexpected error joining family: $e');"},{"type":"INSERT","lineNumber":161,"content":"      throw const ServerException('An unexpected error occurred');"},{"type":"INSERT","lineNumber":162,"content":"    }"},{"type":"INSERT","lineNumber":163,"content":"  }"},{"type":"INSERT","lineNumber":164,"content":""},{"type":"INSERT","lineNumber":165,"content":"  @override"},{"type":"INSERT","lineNumber":166,"content":"  Future<Family?> getFamily(String familyId) async {"},{"type":"INSERT","lineNumber":167,"content":"    try {"},{"type":"INSERT","lineNumber":168,"content":"      // Input validation"},{"type":"INSERT","lineNumber":169,"content":"      if (familyId.isEmpty) {"},{"type":"INSERT","lineNumber":170,"content":"        developer.log('Attempted to get family with empty ID');"},{"type":"DELETE","lineNumber":204,"oldContent":"      // Input validation"},{"type":"INSERT","lineNumber":205,"content":"      rethrow;"},{"type":"INSERT","lineNumber":206,"content":"    }"},{"type":"INSERT","lineNumber":207,"content":"  }"},{"type":"INSERT","lineNumber":208,"content":""},{"type":"INSERT","lineNumber":209,"content":"  @override"},{"type":"INSERT","lineNumber":210,"content":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"INSERT","lineNumber":211,"content":"    try {"},{"type":"INSERT","lineNumber":212,"content":"      // Input validation"},{"type":"DELETE","lineNumber":208,"oldContent":"      rethrow;"},{"type":"DELETE","lineNumber":211,"oldContent":"    }"},{"type":"DELETE","lineNumber":214,"oldContent":"  }"},{"type":"DELETE","lineNumber":217,"oldContent":""},{"type":"DELETE","lineNumber":220,"oldContent":"  @override"},{"type":"DELETE","lineNumber":223,"oldContent":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"DELETE","lineNumber":226,"oldContent":"    try {"},{"type":"DELETE","lineNumber":228,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":231,"oldContent":"    }"},{"type":"DELETE","lineNumber":235,"oldContent":"  }"},{"type":"DELETE","lineNumber":238,"oldContent":""},{"type":"DELETE","lineNumber":241,"oldContent":"  @override"},{"type":"DELETE","lineNumber":243,"oldContent":"    }"},{"type":"DELETE","lineNumber":246,"oldContent":"  }"},{"type":"DELETE","lineNumber":249,"oldContent":""},{"type":"DELETE","lineNumber":252,"oldContent":"  @override"},{"type":"DELETE","lineNumber":254,"oldContent":"          .collection('families')"},{"type":"DELETE","lineNumber":257,"oldContent":"          .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"DELETE","lineNumber":260,"oldContent":"          .limit(1)"},{"type":"DELETE","lineNumber":263,"oldContent":"          .get();"},{"type":"INSERT","lineNumber":251,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":265,"oldContent":""},{"type":"DELETE","lineNumber":267,"oldContent":"      return result.docs.isNotEmpty;"},{"type":"DELETE","lineNumber":268,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":256,"content":""},{"type":"INSERT","lineNumber":257,"content":"  @override"},{"type":"INSERT","lineNumber":258,"content":"  @transactional"},{"type":"DELETE","lineNumber":272,"oldContent":"}"},{"type":"INSERT","lineNumber":261,"content":"      // Input validation"},{"type":"INSERT","lineNumber":262,"content":"      if (familyId.isEmpty) {"},{"type":"INSERT","lineNumber":263,"content":"        throw const ServerException('Family ID cannot be empty');"},{"type":"INSERT","lineNumber":264,"content":"      }"},{"type":"DELETE","lineNumber":276,"oldContent":"      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';"},{"type":"INSERT","lineNumber":267,"content":"      const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // Exclude similar-looking characters"},{"type":"DELETE","lineNumber":280,"oldContent":"      throw const ServerException('Failed to validate invite code');"},{"type":"DELETE","lineNumber":282,"oldContent":"      final result = await firestore"},{"type":"DELETE","lineNumber":284,"oldContent":"    try {"},{"type":"DELETE","lineNumber":286,"oldContent":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"DELETE","lineNumber":288,"oldContent":"      throw const ServerException('Failed to generate invite code');"},{"type":"DELETE","lineNumber":290,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":292,"oldContent":"      return code;"},{"type":"INSERT","lineNumber":278,"content":"      final expiresAtTimestamp = Timestamp.fromDate(expiresAt);"},{"type":"INSERT","lineNumber":280,"content":"      // Use a transaction to ensure data consistency"},{"type":"INSERT","lineNumber":281,"content":"      await firestore.runTransaction((transaction) async {"},{"type":"INSERT","lineNumber":282,"content":"        // Verify family exists"},{"type":"INSERT","lineNumber":283,"content":"        final familyDoc = await transaction.get("},{"type":"INSERT","lineNumber":284,"content":"          firestore.collection('families').doc(familyId),"},{"type":"INSERT","lineNumber":285,"content":"        );"},{"type":"INSERT","lineNumber":287,"content":"        if (!familyDoc.exists) {"},{"type":"INSERT","lineNumber":288,"content":"          throw const ServerException('Family not found');"},{"type":"INSERT","lineNumber":289,"content":"        }"},{"type":"INSERT","lineNumber":290,"content":""},{"type":"INSERT","lineNumber":291,"content":"        // Update the family document with the new invite code"},{"type":"INSERT","lineNumber":292,"content":"        transaction.update("},{"type":"INSERT","lineNumber":293,"content":"          firestore.collection('families').doc(familyId),"},{"type":"INSERT","lineNumber":294,"content":"          {"},{"type":"INSERT","lineNumber":295,"content":"            'currentInviteCode': code,"},{"type":"INSERT","lineNumber":296,"content":"            'inviteCodeExpiresAt': expiresAtTimestamp,"},{"type":"INSERT","lineNumber":297,"content":"            'lastInviteCodeGeneratedAt': FieldValue.serverTimestamp(),"},{"type":"INSERT","lineNumber":298,"content":"          },"},{"type":"INSERT","lineNumber":299,"content":"        );"},{"type":"DELETE","lineNumber":297,"oldContent":"      // Save the invite code"},{"type":"DELETE","lineNumber":298,"oldContent":"        'inviteCodeExpiresAt': expiresAt,"},{"type":"DELETE","lineNumber":299,"oldContent":"      await firestore.collection('families').doc(familyId).update({"},{"type":"DELETE","lineNumber":300,"oldContent":"        'currentInviteCode': code,"},{"type":"INSERT","lineNumber":301,"content":""},{"type":"INSERT","lineNumber":302,"content":"      developer.log('Generated invite code for family $familyId');"},{"type":"INSERT","lineNumber":303,"content":"      return code;"},{"type":"INSERT","lineNumber":304,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":305,"content":"      developer.log('Firebase error generating invite code: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":306,"content":"      throw const ServerException('Failed to generate invite code. Please try again.');"},{"type":"INSERT","lineNumber":307,"content":"    } on ServerException {"},{"type":"INSERT","lineNumber":308,"content":"      rethrow;"},{"type":"INSERT","lineNumber":309,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":310,"content":"      developer.log('Unexpected error generating invite code: $e');"},{"type":"INSERT","lineNumber":311,"content":"      throw const ServerException('An unexpected error occurred');"},{"type":"INSERT","lineNumber":312,"content":"    }"},{"type":"INSERT","lineNumber":313,"content":"  }"},{"type":"INSERT","lineNumber":314,"content":""},{"type":"INSERT","lineNumber":315,"content":"  @override"},{"type":"INSERT","lineNumber":316,"content":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"INSERT","lineNumber":317,"content":"    try {"},{"type":"INSERT","lineNumber":318,"content":"      final result = await firestore"},{"type":"INSERT","lineNumber":319,"content":"          .collection('families')"},{"type":"INSERT","lineNumber":320,"content":"          .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"INSERT","lineNumber":321,"content":"          .limit(1)"},{"type":"INSERT","lineNumber":322,"content":"          .get();"},{"type":"INSERT","lineNumber":323,"content":""},{"type":"INSERT","lineNumber":324,"content":"      return result.docs.isNotEmpty;"},{"type":"INSERT","lineNumber":325,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":326,"content":"      throw const ServerException('Failed to validate invite code');"},{"type":"INSERT","lineNumber":327,"content":"    }"},{"type":"INSERT","lineNumber":328,"content":"  }"},{"type":"INSERT","lineNumber":329,"content":"}"},{"type":"INSERT","lineNumber":330,"content":""}]},{"timestamp":1754514051641,"changes":[{"type":"MODIFY","lineNumber":73,"content":"      throw const ServerException('Failed to create family. Please try again.');","oldContent":"      throw const ServerException('Failed to create family. Please try again.');"},{"type":"DELETE","lineNumber":75,"oldContent":"  }"},{"type":"DELETE","lineNumber":77,"oldContent":""},{"type":"INSERT","lineNumber":78,"content":"  }"},{"type":"INSERT","lineNumber":79,"content":""},{"type":"INSERT","lineNumber":91,"content":""},{"type":"DELETE","lineNumber":92,"oldContent":"      // Check if user already has a family"},{"type":"INSERT","lineNumber":152,"content":"        );"},{"type":"INSERT","lineNumber":153,"content":"      });"},{"type":"INSERT","lineNumber":154,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":155,"content":"      developer.log('Firebase error joining family: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":156,"content":"      throw const ServerException('Failed to join family. Please try again.');"},{"type":"INSERT","lineNumber":157,"content":"    } on ServerException {"},{"type":"INSERT","lineNumber":158,"content":"      rethrow;"},{"type":"DELETE","lineNumber":154,"oldContent":"        );"},{"type":"DELETE","lineNumber":156,"oldContent":"      });"},{"type":"DELETE","lineNumber":159,"oldContent":"    } on FirebaseException catch (e) {"},{"type":"DELETE","lineNumber":162,"oldContent":"      developer.log('Firebase error joining family: ${e.message}', error: e);"},{"type":"DELETE","lineNumber":164,"oldContent":"      throw const ServerException('Failed to join family. Please try again.');"},{"type":"DELETE","lineNumber":167,"oldContent":"    } on ServerException {"},{"type":"DELETE","lineNumber":170,"oldContent":"      rethrow;"},{"type":"MODIFY","lineNumber":205,"content":"      rethrow;","oldContent":"      rethrow;"},{"type":"DELETE","lineNumber":207,"oldContent":"      if (userId.isEmpty) {"},{"type":"DELETE","lineNumber":209,"oldContent":"        developer.log('checkFamilyMembership called with empty user ID');"},{"type":"DELETE","lineNumber":212,"oldContent":"        return false;"},{"type":"DELETE","lineNumber":214,"oldContent":"      }"},{"type":"INSERT","lineNumber":213,"content":"      if (userId.isEmpty) {"},{"type":"INSERT","lineNumber":214,"content":"        developer.log('checkFamilyMembership called with empty user ID');"},{"type":"INSERT","lineNumber":215,"content":"        return false;"},{"type":"INSERT","lineNumber":216,"content":"      }"},{"type":"DELETE","lineNumber":243,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":247,"oldContent":""},{"type":"DELETE","lineNumber":249,"oldContent":"  @override"},{"type":"DELETE","lineNumber":250,"oldContent":"  @transactional"},{"type":"DELETE","lineNumber":253,"oldContent":"      // Input validation"},{"type":"DELETE","lineNumber":255,"oldContent":"      if (familyId.isEmpty) {"},{"type":"DELETE","lineNumber":257,"oldContent":"        throw const ServerException('Family ID cannot be empty');"},{"type":"DELETE","lineNumber":258,"oldContent":"      }"},{"type":"INSERT","lineNumber":251,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":261,"oldContent":"      const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // Exclude similar-looking characters"},{"type":"INSERT","lineNumber":256,"content":""},{"type":"INSERT","lineNumber":257,"content":"  @override"},{"type":"INSERT","lineNumber":258,"content":"  @transactional"},{"type":"INSERT","lineNumber":261,"content":"      // Input validation"},{"type":"INSERT","lineNumber":262,"content":"      if (familyId.isEmpty) {"},{"type":"INSERT","lineNumber":263,"content":"        throw const ServerException('Family ID cannot be empty');"},{"type":"INSERT","lineNumber":264,"content":"      }"},{"type":"INSERT","lineNumber":267,"content":"      const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // Exclude similar-looking characters"},{"type":"DELETE","lineNumber":269,"oldContent":"      final expiresAtTimestamp = Timestamp.fromDate(expiresAt);"},{"type":"INSERT","lineNumber":271,"content":"          8,"},{"type":"INSERT","lineNumber":272,"content":"          (index) => chars.codeUnitAt((random + index) % chars.length),"},{"type":"INSERT","lineNumber":273,"content":"        ),"},{"type":"INSERT","lineNumber":274,"content":"      );"},{"type":"INSERT","lineNumber":275,"content":""},{"type":"INSERT","lineNumber":276,"content":"      // Set the invite code to expire in 7 days"},{"type":"INSERT","lineNumber":277,"content":"      final expiresAt = DateTime.now().add(const Duration(days: 7));"},{"type":"INSERT","lineNumber":278,"content":"      final expiresAtTimestamp = Timestamp.fromDate(expiresAt);"},{"type":"INSERT","lineNumber":279,"content":""},{"type":"DELETE","lineNumber":274,"oldContent":"          8,"},{"type":"DELETE","lineNumber":277,"oldContent":"          (index) => chars.codeUnitAt((random + index) % chars.length),"},{"type":"DELETE","lineNumber":280,"oldContent":"        ),"},{"type":"INSERT","lineNumber":286,"content":""},{"type":"DELETE","lineNumber":282,"oldContent":"      );"},{"type":"DELETE","lineNumber":286,"oldContent":""},{"type":"DELETE","lineNumber":288,"oldContent":"      // Set the invite code to expire in 7 days"},{"type":"DELETE","lineNumber":291,"oldContent":"      final expiresAt = DateTime.now().add(const Duration(days: 7));"},{"type":"DELETE","lineNumber":293,"oldContent":""},{"type":"DELETE","lineNumber":295,"oldContent":""},{"type":"DELETE","lineNumber":297,"oldContent":"      });"},{"type":"INSERT","lineNumber":300,"content":"      });"},{"type":"DELETE","lineNumber":302,"oldContent":""},{"type":"DELETE","lineNumber":304,"oldContent":"}"},{"type":"DELETE","lineNumber":306,"oldContent":"  }"},{"type":"DELETE","lineNumber":308,"oldContent":"    }"},{"type":"DELETE","lineNumber":310,"oldContent":"      throw const ServerException('Failed to validate invite code');"},{"type":"DELETE","lineNumber":312,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":314,"oldContent":"      return result.docs.isNotEmpty;"},{"type":"DELETE","lineNumber":316,"oldContent":""},{"type":"DELETE","lineNumber":318,"oldContent":"          .get();"},{"type":"DELETE","lineNumber":320,"oldContent":"          .limit(1)"},{"type":"DELETE","lineNumber":322,"oldContent":"          .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"DELETE","lineNumber":324,"oldContent":"          .collection('families')"},{"type":"DELETE","lineNumber":326,"oldContent":"      final result = await firestore"},{"type":"DELETE","lineNumber":328,"oldContent":"    try {"},{"type":"INSERT","lineNumber":317,"content":"    try {"},{"type":"INSERT","lineNumber":318,"content":"      // Input validation"},{"type":"INSERT","lineNumber":319,"content":"      if (inviteCode.isEmpty) {"},{"type":"INSERT","lineNumber":320,"content":"        developer.log('Attempted to validate empty invite code');"},{"type":"INSERT","lineNumber":321,"content":"        return false;"},{"type":"INSERT","lineNumber":322,"content":"      }"},{"type":"INSERT","lineNumber":323,"content":""},{"type":"INSERT","lineNumber":324,"content":"      final now = DateTime.now();"},{"type":"INSERT","lineNumber":325,"content":"      "},{"type":"INSERT","lineNumber":326,"content":"      // Query with server timestamp and check for non-expired codes"},{"type":"INSERT","lineNumber":327,"content":"      final result = await firestore"},{"type":"INSERT","lineNumber":328,"content":"          .collection('families')"},{"type":"INSERT","lineNumber":329,"content":"          .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"INSERT","lineNumber":330,"content":"          .where('inviteCodeExpiresAt', isGreaterThan: now)"},{"type":"INSERT","lineNumber":331,"content":"          .limit(1)"},{"type":"INSERT","lineNumber":332,"content":"          .get(const GetOptions(source: Source.server));"},{"type":"INSERT","lineNumber":333,"content":""},{"type":"INSERT","lineNumber":334,"content":"      if (result.docs.isEmpty) {"},{"type":"INSERT","lineNumber":335,"content":"        developer.log('No valid family found for invite code: $inviteCode');"},{"type":"INSERT","lineNumber":336,"content":"        return false;"},{"type":"INSERT","lineNumber":337,"content":"      }"},{"type":"INSERT","lineNumber":338,"content":""},{"type":"INSERT","lineNumber":339,"content":"      // Additional verification of expiration (in case of clock skew)"},{"type":"INSERT","lineNumber":340,"content":"      final familyData = result.docs.first.data();"},{"type":"INSERT","lineNumber":341,"content":"      final expiresAt = familyData['inviteCodeExpiresAt'] as Timestamp?;"},{"type":"INSERT","lineNumber":342,"content":"      "},{"type":"INSERT","lineNumber":343,"content":"      if (expiresAt == null) {"},{"type":"INSERT","lineNumber":344,"content":"        developer.log('Invite code has no expiration date: $inviteCode');"},{"type":"INSERT","lineNumber":345,"content":"        return false;"},{"type":"INSERT","lineNumber":346,"content":"      }"},{"type":"INSERT","lineNumber":347,"content":""},{"type":"INSERT","lineNumber":348,"content":"      if (expiresAt.toDate().isBefore(now)) {"},{"type":"INSERT","lineNumber":349,"content":"        // Clean up expired code"},{"type":"INSERT","lineNumber":350,"content":"        await result.docs.first.reference.update({"},{"type":"INSERT","lineNumber":351,"content":"          'currentInviteCode': null,"},{"type":"INSERT","lineNumber":352,"content":"          'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":353,"content":"        });"},{"type":"INSERT","lineNumber":354,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":355,"content":"        return false;"},{"type":"INSERT","lineNumber":356,"content":"      }"},{"type":"INSERT","lineNumber":357,"content":""},{"type":"INSERT","lineNumber":358,"content":"      developer.log('Valid invite code found: $inviteCode');"},{"type":"INSERT","lineNumber":359,"content":"      return true;"},{"type":"INSERT","lineNumber":360,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":361,"content":"      developer.log('Firebase error validating invite code: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":362,"content":"      // Don't expose internal errors to the user"},{"type":"INSERT","lineNumber":363,"content":"      return false;"},{"type":"INSERT","lineNumber":364,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":365,"content":"      developer.log('Unexpected error validating invite code: $e');"},{"type":"INSERT","lineNumber":366,"content":"      return false;"},{"type":"INSERT","lineNumber":367,"content":"    }"},{"type":"INSERT","lineNumber":368,"content":"  }"},{"type":"INSERT","lineNumber":369,"content":"}"},{"type":"INSERT","lineNumber":370,"content":""}]},{"timestamp":1754514098442,"changes":[{"type":"MODIFY","lineNumber":57,"content":"          memberJoinDates: {adminId: now}, adminId: '', updatedAt: null,","oldContent":"          memberJoinDates: {adminId: now},"},{"type":"INSERT","lineNumber":72,"content":"      developer.log('Firebase error creating family: ${e.message}', error: e);"},{"type":"DELETE","lineNumber":73,"oldContent":"      throw const ServerException('Failed to create family. Please try again.');"},{"type":"DELETE","lineNumber":76,"oldContent":"  }"},{"type":"MODIFY","lineNumber":78,"content":"  }","oldContent":""},{"type":"INSERT","lineNumber":79,"content":""},{"type":"DELETE","lineNumber":153,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":155,"oldContent":"      developer.log('Unexpected error joining family: $e');"},{"type":"DELETE","lineNumber":158,"oldContent":"      throw const ServerException('An unexpected error occurred');"},{"type":"DELETE","lineNumber":161,"oldContent":"    }"},{"type":"INSERT","lineNumber":159,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":160,"content":"      developer.log('Unexpected error joining family: $e');"},{"type":"INSERT","lineNumber":161,"content":"      throw const ServerException('An unexpected error occurred');"},{"type":"INSERT","lineNumber":162,"content":"    }"},{"type":"INSERT","lineNumber":204,"content":"      developer.log('Unexpected error getting family: $e');"},{"type":"DELETE","lineNumber":205,"oldContent":"      rethrow;"},{"type":"DELETE","lineNumber":210,"oldContent":"      if (userId.isEmpty) {"},{"type":"INSERT","lineNumber":211,"content":"    try {"},{"type":"INSERT","lineNumber":212,"content":"      // Input validation"},{"type":"INSERT","lineNumber":213,"content":"      if (userId.isEmpty) {"},{"type":"DELETE","lineNumber":214,"oldContent":"    try {"},{"type":"DELETE","lineNumber":216,"oldContent":"      // Input validation"},{"type":"DELETE","lineNumber":247,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":251,"oldContent":""},{"type":"DELETE","lineNumber":253,"oldContent":"  @override"},{"type":"DELETE","lineNumber":254,"oldContent":"  @transactional"},{"type":"INSERT","lineNumber":251,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":257,"oldContent":"      // Input validation"},{"type":"DELETE","lineNumber":258,"oldContent":"      if (familyId.isEmpty) {"},{"type":"DELETE","lineNumber":260,"oldContent":"        throw const ServerException('Family ID cannot be empty');"},{"type":"DELETE","lineNumber":262,"oldContent":"      }"},{"type":"INSERT","lineNumber":256,"content":""},{"type":"INSERT","lineNumber":257,"content":"  @override"},{"type":"INSERT","lineNumber":258,"content":"  @transactional"},{"type":"INSERT","lineNumber":261,"content":"      // Input validation"},{"type":"INSERT","lineNumber":262,"content":"      if (familyId.isEmpty) {"},{"type":"INSERT","lineNumber":263,"content":"        throw const ServerException('Family ID cannot be empty');"},{"type":"INSERT","lineNumber":264,"content":"      }"},{"type":"MODIFY","lineNumber":267,"content":"      const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // Exclude similar-looking characters","oldContent":"      const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // Exclude similar-looking characters"},{"type":"MODIFY","lineNumber":271,"content":"          8,","oldContent":"          8,"},{"type":"DELETE","lineNumber":273,"oldContent":"      // Use a transaction to ensure data consistency"},{"type":"DELETE","lineNumber":275,"oldContent":"      await firestore.runTransaction((transaction) async {"},{"type":"DELETE","lineNumber":278,"oldContent":"        // Verify family exists"},{"type":"DELETE","lineNumber":280,"oldContent":"        final familyDoc = await transaction.get("},{"type":"DELETE","lineNumber":283,"oldContent":"          firestore.collection('families').doc(familyId),"},{"type":"INSERT","lineNumber":280,"content":"      // Use a transaction to ensure data consistency"},{"type":"INSERT","lineNumber":281,"content":"      await firestore.runTransaction((transaction) async {"},{"type":"INSERT","lineNumber":282,"content":"        // Verify family exists"},{"type":"INSERT","lineNumber":283,"content":"        final familyDoc = await transaction.get("},{"type":"INSERT","lineNumber":284,"content":"          firestore.collection('families').doc(familyId),"},{"type":"INSERT","lineNumber":286,"content":""},{"type":"DELETE","lineNumber":290,"oldContent":""},{"type":"MODIFY","lineNumber":300,"content":"      });","oldContent":"      });"},{"type":"DELETE","lineNumber":309,"oldContent":"    try {"},{"type":"INSERT","lineNumber":310,"content":"      developer.log('Unexpected error generating invite code: $e');"},{"type":"INSERT","lineNumber":311,"content":"      throw const ServerException('An unexpected error occurred');"},{"type":"INSERT","lineNumber":312,"content":"    }"},{"type":"INSERT","lineNumber":313,"content":"  }"},{"type":"INSERT","lineNumber":314,"content":""},{"type":"INSERT","lineNumber":315,"content":"  @override"},{"type":"INSERT","lineNumber":316,"content":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"INSERT","lineNumber":317,"content":"    try {"},{"type":"DELETE","lineNumber":313,"oldContent":"      developer.log('Unexpected error generating invite code: $e');"},{"type":"DELETE","lineNumber":316,"oldContent":"      throw const ServerException('An unexpected error occurred');"},{"type":"DELETE","lineNumber":319,"oldContent":"    }"},{"type":"DELETE","lineNumber":322,"oldContent":"  }"},{"type":"DELETE","lineNumber":325,"oldContent":""},{"type":"DELETE","lineNumber":328,"oldContent":"  @override"},{"type":"DELETE","lineNumber":330,"oldContent":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"DELETE","lineNumber":332,"oldContent":""},{"type":"DELETE","lineNumber":334,"oldContent":"}"},{"type":"DELETE","lineNumber":336,"oldContent":"  }"},{"type":"DELETE","lineNumber":338,"oldContent":"    }"},{"type":"DELETE","lineNumber":340,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":342,"oldContent":"      developer.log('Unexpected error validating invite code: $e');"},{"type":"DELETE","lineNumber":344,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":346,"oldContent":"      return false;"},{"type":"DELETE","lineNumber":348,"oldContent":"      // Don't expose internal errors to the user"},{"type":"DELETE","lineNumber":350,"oldContent":"      developer.log('Firebase error validating invite code: ${e.message}', error: e);"},{"type":"DELETE","lineNumber":352,"oldContent":"    } on FirebaseException catch (e) {"},{"type":"DELETE","lineNumber":354,"oldContent":"      return true;"},{"type":"DELETE","lineNumber":356,"oldContent":"      developer.log('Valid invite code found: $inviteCode');"},{"type":"DELETE","lineNumber":358,"oldContent":""},{"type":"DELETE","lineNumber":361,"oldContent":"      }"},{"type":"DELETE","lineNumber":362,"oldContent":"        return false;"},{"type":"DELETE","lineNumber":364,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":366,"oldContent":"        });"},{"type":"DELETE","lineNumber":368,"oldContent":"          'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":352,"content":"          'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":353,"content":"        });"},{"type":"INSERT","lineNumber":354,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":355,"content":"        return false;"},{"type":"INSERT","lineNumber":356,"content":"      }"},{"type":"INSERT","lineNumber":357,"content":""},{"type":"INSERT","lineNumber":358,"content":"      developer.log('Valid invite code found: $inviteCode');"},{"type":"INSERT","lineNumber":359,"content":"      return true;"},{"type":"INSERT","lineNumber":360,"content":"    } on FirebaseException catch (e) {"},{"type":"INSERT","lineNumber":361,"content":"      developer.log('Firebase error validating invite code: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":362,"content":"      // Don't expose internal errors to the user"},{"type":"INSERT","lineNumber":363,"content":"      return false;"},{"type":"INSERT","lineNumber":364,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":365,"content":"      developer.log('Unexpected error validating invite code: $e');"},{"type":"INSERT","lineNumber":366,"content":"      return false;"},{"type":"INSERT","lineNumber":367,"content":"    }"},{"type":"INSERT","lineNumber":368,"content":"  }"},{"type":"INSERT","lineNumber":369,"content":"}"},{"type":"INSERT","lineNumber":370,"content":""}]},{"timestamp":1754514103027,"changes":[{"type":"MODIFY","lineNumber":57,"content":"          memberJoinDates: {adminId: now}, adminId: '', updatedAt: ,","oldContent":"          memberJoinDates: {adminId: now}, adminId: '', updatedAt: null,"},{"type":"INSERT","lineNumber":77,"content":"    }"},{"type":"DELETE","lineNumber":79,"oldContent":"    }"},{"type":"DELETE","lineNumber":156,"oldContent":"    } catch (e) {"},{"type":"MODIFY","lineNumber":158,"content":"      rethrow;","oldContent":"      developer.log('Unexpected error joining family: $e');"},{"type":"INSERT","lineNumber":159,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":160,"content":"      developer.log('Unexpected error joining family: $e');"},{"type":"DELETE","lineNumber":162,"oldContent":"      rethrow;"},{"type":"MODIFY","lineNumber":211,"content":"    try {","oldContent":"    try {"},{"type":"MODIFY","lineNumber":214,"content":"        developer.log('checkFamilyMembership called with empty user ID');","oldContent":"        developer.log('checkFamilyMembership called with empty user ID');"},{"type":"MODIFY","lineNumber":251,"content":"    } catch (e) {","oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":253,"oldContent":""},{"type":"INSERT","lineNumber":254,"content":"    }"},{"type":"INSERT","lineNumber":255,"content":"  }"},{"type":"INSERT","lineNumber":256,"content":""},{"type":"DELETE","lineNumber":257,"oldContent":"    }"},{"type":"INSERT","lineNumber":259,"content":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"INSERT","lineNumber":260,"content":"    try {"},{"type":"DELETE","lineNumber":259,"oldContent":"  }"},{"type":"DELETE","lineNumber":262,"oldContent":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"DELETE","lineNumber":264,"oldContent":"    try {"},{"type":"INSERT","lineNumber":266,"content":"      // Generate a random 8-character alphanumeric code"},{"type":"DELETE","lineNumber":267,"oldContent":"      const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // Exclude similar-looking characters"},{"type":"INSERT","lineNumber":270,"content":"        Iterable.generate("},{"type":"DELETE","lineNumber":271,"oldContent":"          8,"},{"type":"INSERT","lineNumber":277,"content":"      final expiresAt = DateTime.now().add(const Duration(days: 7));"},{"type":"INSERT","lineNumber":278,"content":"      final expiresAtTimestamp = Timestamp.fromDate(expiresAt);"},{"type":"INSERT","lineNumber":279,"content":""},{"type":"DELETE","lineNumber":279,"oldContent":"      final expiresAt = DateTime.now().add(const Duration(days: 7));"},{"type":"DELETE","lineNumber":281,"oldContent":"      final expiresAtTimestamp = Timestamp.fromDate(expiresAt);"},{"type":"DELETE","lineNumber":284,"oldContent":""},{"type":"INSERT","lineNumber":299,"content":"        );"},{"type":"DELETE","lineNumber":300,"oldContent":"      });"},{"type":"MODIFY","lineNumber":310,"content":"      developer.log('Unexpected error generating invite code: $e');","oldContent":"      developer.log('Unexpected error generating invite code: $e');"},{"type":"DELETE","lineNumber":312,"oldContent":"      // Input validation"},{"type":"DELETE","lineNumber":314,"oldContent":"      if (inviteCode.isEmpty) {"},{"type":"DELETE","lineNumber":317,"oldContent":"        developer.log('Attempted to validate empty invite code');"},{"type":"DELETE","lineNumber":319,"oldContent":"        return false;"},{"type":"INSERT","lineNumber":318,"content":"      // Input validation"},{"type":"INSERT","lineNumber":319,"content":"      if (inviteCode.isEmpty) {"},{"type":"INSERT","lineNumber":320,"content":"        developer.log('Attempted to validate empty invite code');"},{"type":"INSERT","lineNumber":321,"content":"        return false;"},{"type":"INSERT","lineNumber":342,"content":"      "},{"type":"INSERT","lineNumber":343,"content":"      if (expiresAt == null) {"},{"type":"INSERT","lineNumber":344,"content":"        developer.log('Invite code has no expiration date: $inviteCode');"},{"type":"INSERT","lineNumber":345,"content":"        return false;"},{"type":"INSERT","lineNumber":346,"content":"      }"},{"type":"INSERT","lineNumber":347,"content":""},{"type":"INSERT","lineNumber":348,"content":"      if (expiresAt.toDate().isBefore(now)) {"},{"type":"INSERT","lineNumber":349,"content":"        // Clean up expired code"},{"type":"INSERT","lineNumber":350,"content":"        await result.docs.first.reference.update({"},{"type":"INSERT","lineNumber":351,"content":"          'currentInviteCode': null,"},{"type":"DELETE","lineNumber":344,"oldContent":"      "},{"type":"DELETE","lineNumber":347,"oldContent":"      if (expiresAt == null) {"},{"type":"DELETE","lineNumber":350,"oldContent":"        developer.log('Invite code has no expiration date: $inviteCode');"},{"type":"DELETE","lineNumber":353,"oldContent":"        return false;"},{"type":"DELETE","lineNumber":355,"oldContent":"      }"},{"type":"DELETE","lineNumber":359,"oldContent":""},{"type":"DELETE","lineNumber":362,"oldContent":"      if (expiresAt.toDate().isBefore(now)) {"},{"type":"DELETE","lineNumber":365,"oldContent":"        // Clean up expired code"},{"type":"DELETE","lineNumber":368,"oldContent":"        await result.docs.first.reference.update({"},{"type":"DELETE","lineNumber":370,"oldContent":"          'currentInviteCode': null,"}]},{"timestamp":1754514109286,"changes":[{"type":"DELETE","lineNumber":81,"oldContent":"  @transactional"},{"type":"INSERT","lineNumber":156,"content":"    } on ServerException {"},{"type":"DELETE","lineNumber":159,"oldContent":"    } on ServerException {"},{"type":"INSERT","lineNumber":209,"content":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"DELETE","lineNumber":211,"oldContent":"    try {"},{"type":"INSERT","lineNumber":212,"content":"      if (userId.isEmpty) {"},{"type":"DELETE","lineNumber":214,"oldContent":"        developer.log('checkFamilyMembership called with empty user ID');"},{"type":"INSERT","lineNumber":249,"content":"      rethrow;"},{"type":"DELETE","lineNumber":251,"oldContent":"    } catch (e) {"},{"type":"MODIFY","lineNumber":253,"content":"    }","oldContent":"    }"},{"type":"MODIFY","lineNumber":256,"content":"  @override","oldContent":"  @override"},{"type":"MODIFY","lineNumber":260,"content":"      // Input validation","oldContent":"      // Input validation"},{"type":"DELETE","lineNumber":278,"oldContent":"      // Use a transaction to ensure data consistency"},{"type":"DELETE","lineNumber":280,"oldContent":"      await firestore.runTransaction((transaction) async {"},{"type":"INSERT","lineNumber":279,"content":"      // Use a transaction to ensure data consistency"},{"type":"INSERT","lineNumber":280,"content":"      await firestore.runTransaction((transaction) async {"},{"type":"INSERT","lineNumber":308,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":310,"oldContent":"      developer.log('Unexpected error generating invite code: $e');"},{"type":"MODIFY","lineNumber":315,"content":"  Future<bool> validateInviteCode(String inviteCode) async {","oldContent":"      // Input validation"},{"type":"INSERT","lineNumber":316,"content":"    try {"},{"type":"INSERT","lineNumber":317,"content":"      // Input validation"},{"type":"DELETE","lineNumber":319,"oldContent":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"DELETE","lineNumber":321,"oldContent":"    try {"},{"type":"DELETE","lineNumber":343,"oldContent":"          'inviteCodeExpiresAt': null,"},{"type":"DELETE","lineNumber":345,"oldContent":"        });"},{"type":"DELETE","lineNumber":348,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":350,"oldContent":"        return false;"},{"type":"DELETE","lineNumber":353,"oldContent":"      }"},{"type":"DELETE","lineNumber":355,"oldContent":""},{"type":"INSERT","lineNumber":351,"content":"          'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":352,"content":"        });"},{"type":"INSERT","lineNumber":353,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":354,"content":"        return false;"},{"type":"INSERT","lineNumber":355,"content":"      }"},{"type":"INSERT","lineNumber":356,"content":""}]},{"timestamp":1754514119056,"changes":[{"type":"MODIFY","lineNumber":57,"content":"          memberJoinDates: {adminId: now},","oldContent":"          memberJoinDates: {adminId: now}, adminId: '', updatedAt: ,"},{"type":"INSERT","lineNumber":81,"content":"  @transactional"},{"type":"DELETE","lineNumber":155,"oldContent":"    } on ServerException {"},{"type":"INSERT","lineNumber":157,"content":"    } on ServerException {"},{"type":"DELETE","lineNumber":208,"oldContent":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"INSERT","lineNumber":210,"content":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"DELETE","lineNumber":211,"oldContent":"      if (userId.isEmpty) {"},{"type":"INSERT","lineNumber":213,"content":"      if (userId.isEmpty) {"},{"type":"DELETE","lineNumber":248,"oldContent":"      rethrow;"},{"type":"INSERT","lineNumber":250,"content":"      rethrow;"},{"type":"DELETE","lineNumber":252,"oldContent":"    }"},{"type":"INSERT","lineNumber":254,"content":"    }"},{"type":"DELETE","lineNumber":255,"oldContent":"  @override"},{"type":"INSERT","lineNumber":257,"content":"  @override"},{"type":"DELETE","lineNumber":258,"oldContent":"      // Input validation"},{"type":"MODIFY","lineNumber":259,"content":"  Future<String> generateInviteCode(String familyId) async {","oldContent":"      // Input validation"},{"type":"INSERT","lineNumber":261,"content":"      // Input validation"},{"type":"DELETE","lineNumber":277,"oldContent":"      // Use a transaction to ensure data consistency"},{"type":"DELETE","lineNumber":279,"oldContent":"      await firestore.runTransaction((transaction) async {"},{"type":"INSERT","lineNumber":280,"content":"      // Use a transaction to ensure data consistency"},{"type":"INSERT","lineNumber":281,"content":"      await firestore.runTransaction((transaction) async {"},{"type":"DELETE","lineNumber":307,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":309,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":315,"content":"  @override"},{"type":"DELETE","lineNumber":316,"oldContent":"  @override"},{"type":"DELETE","lineNumber":346,"oldContent":"          'inviteCodeExpiresAt': null,"},{"type":"DELETE","lineNumber":348,"oldContent":"        });"},{"type":"INSERT","lineNumber":349,"content":"        // Clean up expired code"},{"type":"INSERT","lineNumber":350,"content":"        await result.docs.first.reference.update({"},{"type":"INSERT","lineNumber":351,"content":"          'currentInviteCode': null,"},{"type":"INSERT","lineNumber":352,"content":"          'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":353,"content":"        });"},{"type":"DELETE","lineNumber":352,"oldContent":"        // Clean up expired code"},{"type":"DELETE","lineNumber":355,"oldContent":"        await result.docs.first.reference.update({"},{"type":"DELETE","lineNumber":356,"oldContent":"          'currentInviteCode': null,"}]},{"timestamp":1754515807309,"changes":[{"type":"DELETE","lineNumber":29,"oldContent":"  @transactional"},{"type":"DELETE","lineNumber":81,"oldContent":"  @transactional"},{"type":"DELETE","lineNumber":258,"oldContent":"  @transactional"},{"type":"DELETE","lineNumber":279,"oldContent":"      // Use a transaction to ensure data consistency"},{"type":"INSERT","lineNumber":277,"content":"      // Use a transaction to ensure data consistency"},{"type":"DELETE","lineNumber":315,"oldContent":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"INSERT","lineNumber":313,"content":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"DELETE","lineNumber":348,"oldContent":"        // Clean up expired code"},{"type":"INSERT","lineNumber":346,"content":"        // Clean up expired code"},{"type":"DELETE","lineNumber":351,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":353,"oldContent":"        return false;"},{"type":"INSERT","lineNumber":351,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":352,"content":"        return false;"}]},{"timestamp":1754515822371,"changes":[{"type":"INSERT","lineNumber":53,"content":"          adminId: adminId,"},{"type":"DELETE","lineNumber":274,"oldContent":"      // Use a transaction to ensure data consistency"},{"type":"INSERT","lineNumber":278,"content":"      // Use a transaction to ensure data consistency"},{"type":"DELETE","lineNumber":310,"oldContent":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"INSERT","lineNumber":314,"content":"  Future<bool> validateInviteCode(String inviteCode) async {"},{"type":"DELETE","lineNumber":343,"oldContent":"        // Clean up expired code"},{"type":"INSERT","lineNumber":347,"content":"        // Clean up expired code"},{"type":"DELETE","lineNumber":348,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":349,"oldContent":"        return false;"},{"type":"INSERT","lineNumber":352,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":353,"content":"        return false;"}]},{"timestamp":1754515841134,"changes":[{"type":"DELETE","lineNumber":84,"oldContent":"      if (inviteCode.isEmpty) {"},{"type":"DELETE","lineNumber":85,"oldContent":"        throw const ServerException('Invite code cannot be empty');"},{"type":"INSERT","lineNumber":84,"content":"      if (inviteCode.isEmpty || userId.isEmpty) {"},{"type":"INSERT","lineNumber":85,"content":"        throw const ServerException('Invite code and user ID cannot be empty.');"},{"type":"DELETE","lineNumber":87,"oldContent":"      if (userId.isEmpty) {"},{"type":"DELETE","lineNumber":88,"oldContent":"        throw const ServerException('User ID cannot be empty');"},{"type":"DELETE","lineNumber":89,"oldContent":"      }"},{"type":"DELETE","lineNumber":103,"oldContent":"              .limit(1),"},{"type":"INSERT","lineNumber":100,"content":"              .limit(1)"},{"type":"INSERT","lineNumber":101,"content":"              .get(),"},{"type":"MODIFY","lineNumber":350,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');","oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"}]},{"timestamp":1754515995318,"changes":[{"type":"DELETE","lineNumber":97,"oldContent":"              .limit(1)"},{"type":"MODIFY","lineNumber":100,"content":"              .limit(1)","oldContent":"              .get(),"},{"type":"INSERT","lineNumber":101,"content":"              .get(),"},{"type":"DELETE","lineNumber":208,"oldContent":"    try {"},{"type":"DELETE","lineNumber":209,"oldContent":"      // Input validation"},{"type":"DELETE","lineNumber":210,"oldContent":"      if (userId.isEmpty) {"},{"type":"DELETE","lineNumber":211,"oldContent":"        developer.log('checkFamilyMembership called with empty user ID');"},{"type":"DELETE","lineNumber":212,"oldContent":"        return false;"},{"type":"DELETE","lineNumber":213,"oldContent":"      }"},{"type":"DELETE","lineNumber":214,"oldContent":""},{"type":"DELETE","lineNumber":215,"oldContent":"      // Get user document with server timestamp"},{"type":"DELETE","lineNumber":216,"oldContent":"      final userDoc = await firestore"},{"type":"DELETE","lineNumber":217,"oldContent":"          .collection('users')"},{"type":"DELETE","lineNumber":218,"oldContent":"          .doc(userId)"},{"type":"DELETE","lineNumber":219,"oldContent":"          .get(const GetOptions(source: Source.server));"},{"type":"DELETE","lineNumber":220,"oldContent":"      "},{"type":"DELETE","lineNumber":221,"oldContent":"      if (!userDoc.exists) {"},{"type":"DELETE","lineNumber":222,"oldContent":"        developer.log('User not found with ID: $userId');"},{"type":"DELETE","lineNumber":223,"oldContent":"        return false;"},{"type":"DELETE","lineNumber":224,"oldContent":"      }"},{"type":"DELETE","lineNumber":225,"oldContent":""},{"type":"DELETE","lineNumber":226,"oldContent":"      final userData = userDoc.data();"},{"type":"DELETE","lineNumber":227,"oldContent":"      if (userData == null) {"},{"type":"DELETE","lineNumber":228,"oldContent":"        developer.log('User data is null for ID: $userId');"},{"type":"DELETE","lineNumber":229,"oldContent":"        return false;"},{"type":"DELETE","lineNumber":230,"oldContent":"      }"},{"type":"DELETE","lineNumber":231,"oldContent":""},{"type":"DELETE","lineNumber":232,"oldContent":"      final familyId = userData['familyId'] as String?;"},{"type":"DELETE","lineNumber":233,"oldContent":"      final hasFamily = familyId != null && familyId.isNotEmpty;"},{"type":"DELETE","lineNumber":234,"oldContent":"      "},{"type":"DELETE","lineNumber":235,"oldContent":"      if (hasFamily) {"},{"type":"DELETE","lineNumber":236,"oldContent":"        developer.log('User $userId is a member of family $familyId');"},{"type":"DELETE","lineNumber":237,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":238,"oldContent":"        developer.log('User $userId is not a member of any family');"},{"type":"DELETE","lineNumber":239,"oldContent":"      }"},{"type":"DELETE","lineNumber":240,"oldContent":"      "},{"type":"DELETE","lineNumber":241,"oldContent":"      return hasFamily;"},{"type":"DELETE","lineNumber":242,"oldContent":"    } on FirebaseException catch (e) {"},{"type":"DELETE","lineNumber":243,"oldContent":"      developer.log("},{"type":"DELETE","lineNumber":244,"oldContent":"        'Firebase error checking family membership: ${e.message}',"},{"type":"DELETE","lineNumber":245,"oldContent":"        error: e,"},{"type":"DELETE","lineNumber":246,"oldContent":"      );"},{"type":"DELETE","lineNumber":247,"oldContent":"      rethrow;"},{"type":"DELETE","lineNumber":248,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":249,"oldContent":"      developer.log('Unexpected error checking family membership: $e');"},{"type":"DELETE","lineNumber":250,"oldContent":"      rethrow;"},{"type":"DELETE","lineNumber":251,"oldContent":"    }"},{"type":"INSERT","lineNumber":208,"content":"    // TODO: Implement actual check against Firestore"},{"type":"INSERT","lineNumber":209,"content":"    return false;"},{"type":"DELETE","lineNumber":348,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":349,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":306,"content":"          'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":308,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"}]},{"timestamp":1754516112705,"changes":[{"type":"MODIFY","lineNumber":98,"content":"              .collection('families')","oldContent":"              .get(),"},{"type":"INSERT","lineNumber":99,"content":"              .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"DELETE","lineNumber":101,"oldContent":"              .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"DELETE","lineNumber":237,"oldContent":"        final familyDoc = await transaction.get("},{"type":"DELETE","lineNumber":238,"oldContent":"          firestore.collection('families').doc(familyId),"},{"type":"DELETE","lineNumber":239,"oldContent":"        );"},{"type":"INSERT","lineNumber":237,"content":"        final familyRef = firestore.collection('families').doc(familyId);"},{"type":"INSERT","lineNumber":238,"content":"        final familyDoc = await transaction.get(familyRef);"},{"type":"INSERT","lineNumber":244,"content":"        final family = FamilyModel.fromFirestore(familyDoc);"},{"type":"INSERT","lineNumber":245,"content":""},{"type":"INSERT","lineNumber":246,"content":"        if (family.memberIds.contains(familyId)) {"},{"type":"INSERT","lineNumber":247,"content":"          throw const ServerException('User is already a member of this family');"},{"type":"INSERT","lineNumber":248,"content":"        }"},{"type":"INSERT","lineNumber":249,"content":""},{"type":"DELETE","lineNumber":247,"oldContent":"          firestore.collection('families').doc(familyId),"},{"type":"INSERT","lineNumber":252,"content":"          familyRef,"},{"type":"DELETE","lineNumber":264,"oldContent":"          'inviteCodeExpiresAt': null,"},{"type":"DELETE","lineNumber":267,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":311,"content":"          'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":313,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"}]},{"timestamp":1754516294229,"changes":[{"type":"INSERT","lineNumber":56,"content":"          updatedAt: now,"},{"type":"DELETE","lineNumber":219,"oldContent":"      throw const ServerException('Failed to generate invite code');"},{"type":"INSERT","lineNumber":220,"content":""},{"type":"INSERT","lineNumber":244,"content":""},{"type":"DELETE","lineNumber":245,"oldContent":""},{"type":"DELETE","lineNumber":246,"oldContent":"        // Update the family document with the new invite code"},{"type":"DELETE","lineNumber":248,"oldContent":"        transaction.update("},{"type":"MODIFY","lineNumber":251,"content":"        // Update the family document with the new invite code","oldContent":"          {"},{"type":"INSERT","lineNumber":252,"content":"        transaction.update("},{"type":"INSERT","lineNumber":253,"content":"          familyRef,"},{"type":"INSERT","lineNumber":254,"content":"          {"},{"type":"DELETE","lineNumber":256,"oldContent":"          familyRef,"},{"type":"INSERT","lineNumber":312,"content":"          'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":314,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":314,"oldContent":"          'inviteCodeExpiresAt': null,"},{"type":"DELETE","lineNumber":317,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":329,"content":"}"},{"type":"INSERT","lineNumber":330,"content":""}]},{"timestamp":1754516353174,"changes":[{"type":"DELETE","lineNumber":91,"oldContent":"      if (userDoc.exists && userDoc.data()?['familyId'] != null) {"},{"type":"DELETE","lineNumber":92,"oldContent":"        throw const ServerException('You already belong to a family');"},{"type":"INSERT","lineNumber":91,"content":"      if (userDoc.exists && (userDoc.data()! as Map).containsKey('familyId')) {"},{"type":"INSERT","lineNumber":92,"content":"        throw const ServerException('User is already in a family.');"},{"type":"DELETE","lineNumber":95,"oldContent":"      // Find family by invite code within a transaction"},{"type":"DELETE","lineNumber":96,"oldContent":"      return await firestore.runTransaction<Family>((transaction) async {"},{"type":"DELETE","lineNumber":97,"oldContent":"        final familyQuery = await transaction.get("},{"type":"DELETE","lineNumber":98,"oldContent":"          firestore"},{"type":"DELETE","lineNumber":99,"oldContent":"              .collection('families')"},{"type":"DELETE","lineNumber":100,"oldContent":"              .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"DELETE","lineNumber":101,"oldContent":"              .limit(1)"},{"type":"DELETE","lineNumber":102,"oldContent":"              .get(),"},{"type":"DELETE","lineNumber":103,"oldContent":"        );"},{"type":"INSERT","lineNumber":95,"content":"      final familyQuery = await firestore"},{"type":"INSERT","lineNumber":96,"content":"          .collection('families')"},{"type":"INSERT","lineNumber":97,"content":"          .where('currentInviteCode', isEqualTo: inviteCode)"},{"type":"INSERT","lineNumber":98,"content":"          .limit(1)"},{"type":"INSERT","lineNumber":99,"content":"          .get();"},{"type":"DELETE","lineNumber":105,"oldContent":"        if (familyQuery.docs.isEmpty) {"},{"type":"DELETE","lineNumber":106,"oldContent":"          throw const ServerException('Invalid or expired invite code');"},{"type":"DELETE","lineNumber":107,"oldContent":"        }"},{"type":"INSERT","lineNumber":101,"content":"      if (familyQuery.docs.isEmpty) {"},{"type":"INSERT","lineNumber":102,"content":"        throw const ServerException('Invalid invite code');"},{"type":"INSERT","lineNumber":103,"content":"      }"},{"type":"DELETE","lineNumber":109,"oldContent":"        final familyDoc = familyQuery.docs.first;"},{"type":"DELETE","lineNumber":110,"oldContent":"        final familyData = familyDoc.data() as Map<String, dynamic>;"},{"type":"DELETE","lineNumber":111,"oldContent":"        "},{"type":"DELETE","lineNumber":112,"oldContent":"        // Check if invite code is expired"},{"type":"DELETE","lineNumber":113,"oldContent":"        final expiresAt = familyData['inviteCodeExpiresAt'] as Timestamp?;"},{"type":"DELETE","lineNumber":114,"oldContent":"        if (expiresAt != null && expiresAt.toDate().isBefore(DateTime.now())) {"},{"type":"DELETE","lineNumber":115,"oldContent":"          // Clean up expired code"},{"type":"DELETE","lineNumber":116,"oldContent":"          transaction.update(familyDoc.reference, {"},{"type":"DELETE","lineNumber":117,"oldContent":"            'currentInviteCode': null,"},{"type":"DELETE","lineNumber":118,"oldContent":"            'inviteCodeExpiresAt': null,"},{"type":"DELETE","lineNumber":119,"oldContent":"          });"},{"type":"DELETE","lineNumber":120,"oldContent":"          throw const ServerException('Invite code has expired');"},{"type":"DELETE","lineNumber":121,"oldContent":"        }"},{"type":"INSERT","lineNumber":105,"content":"      final familyDoc = familyQuery.docs.first;"},{"type":"INSERT","lineNumber":106,"content":"      final family = FamilyModel.fromJson(familyDoc.data() as Map<String, dynamic>);"},{"type":"DELETE","lineNumber":123,"oldContent":"        final family = FamilyModel.fromJson({"},{"type":"DELETE","lineNumber":124,"oldContent":"          ...familyData,"},{"type":"DELETE","lineNumber":125,"oldContent":"          'id': familyDoc.id,"},{"type":"INSERT","lineNumber":108,"content":"      // Check if invite code is expired"},{"type":"INSERT","lineNumber":109,"content":"      final expiresAt = family.inviteCodeExpiresAt;"},{"type":"INSERT","lineNumber":110,"content":"      if (expiresAt != null && expiresAt.toDate().isBefore(DateTime.now())) {"},{"type":"INSERT","lineNumber":111,"content":"        // Clean up expired code"},{"type":"INSERT","lineNumber":112,"content":"        await familyDoc.reference.update({"},{"type":"INSERT","lineNumber":113,"content":"          'currentInviteCode': null,"},{"type":"INSERT","lineNumber":114,"content":"          'inviteCodeExpiresAt': null,"},{"type":"INSERT","lineNumber":116,"content":"        throw const ServerException('Invite code has expired');"},{"type":"INSERT","lineNumber":117,"content":"      }"},{"type":"DELETE","lineNumber":128,"oldContent":"        // Check if user is already a member"},{"type":"DELETE","lineNumber":129,"oldContent":"        if (family.memberIds.contains(userId)) {"},{"type":"DELETE","lineNumber":130,"oldContent":"          return family;"},{"type":"DELETE","lineNumber":131,"oldContent":"        }"},{"type":"INSERT","lineNumber":119,"content":"      // Check if user is already a member"},{"type":"INSERT","lineNumber":120,"content":"      if (family.memberIds.contains(userId)) {"},{"type":"INSERT","lineNumber":121,"content":"        throw const ServerException('User is already a member of this family');"},{"type":"INSERT","lineNumber":122,"content":"      }"},{"type":"DELETE","lineNumber":133,"oldContent":"        final now = DateTime.now();"},{"type":"DELETE","lineNumber":134,"oldContent":"        "},{"type":"DELETE","lineNumber":135,"oldContent":"        // Add user to family members"},{"type":"DELETE","lineNumber":136,"oldContent":"        transaction.update(familyDoc.reference, {"},{"type":"DELETE","lineNumber":137,"oldContent":"          'memberIds': FieldValue.arrayUnion([userId]),"},{"type":"DELETE","lineNumber":138,"oldContent":"          'memberJoinDates.${userId}': now,"},{"type":"DELETE","lineNumber":139,"oldContent":"        });"},{"type":"INSERT","lineNumber":124,"content":"      final now = DateTime.now();"},{"type":"INSERT","lineNumber":125,"content":"      "},{"type":"INSERT","lineNumber":126,"content":"      // Add user to family members"},{"type":"INSERT","lineNumber":127,"content":"      await familyDoc.reference.update({"},{"type":"INSERT","lineNumber":128,"content":"        'memberIds': FieldValue.arrayUnion([userId]),"},{"type":"INSERT","lineNumber":129,"content":"        'memberJoinDates.${userId}': now,"},{"type":"INSERT","lineNumber":130,"content":"      });"},{"type":"DELETE","lineNumber":141,"oldContent":"        // Update user's family reference"},{"type":"DELETE","lineNumber":142,"oldContent":"        transaction.update("},{"type":"DELETE","lineNumber":143,"oldContent":"          firestore.collection('users').doc(userId),"},{"type":"DELETE","lineNumber":144,"oldContent":"          {'familyId': family.id},"},{"type":"DELETE","lineNumber":145,"oldContent":"        );"},{"type":"DELETE","lineNumber":146,"oldContent":""},{"type":"DELETE","lineNumber":147,"oldContent":"        return family.copyWith("},{"type":"DELETE","lineNumber":148,"oldContent":"          memberIds: [...family.memberIds, userId],"},{"type":"DELETE","lineNumber":149,"oldContent":"          memberJoinDates: {...family.memberJoinDates, userId: now},"},{"type":"DELETE","lineNumber":150,"oldContent":"        );"},{"type":"INSERT","lineNumber":132,"content":"      // Update user's family reference"},{"type":"INSERT","lineNumber":133,"content":"      await firestore.collection('users').doc(userId).update({"},{"type":"INSERT","lineNumber":134,"content":"        'familyId': family.id,"},{"type":"INSERT","lineNumber":136,"content":""},{"type":"INSERT","lineNumber":137,"content":"      return family.copyWith("},{"type":"INSERT","lineNumber":138,"content":"        memberIds: [...family.memberIds, userId],"},{"type":"INSERT","lineNumber":139,"content":"        memberJoinDates: {...family.memberJoinDates, userId: now},"},{"type":"INSERT","lineNumber":140,"content":"      );"},{"type":"INSERT","lineNumber":197,"content":"  Future<Family?> getCurrentFamily(String userId) async {"},{"type":"INSERT","lineNumber":198,"content":"    try {"},{"type":"INSERT","lineNumber":199,"content":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"INSERT","lineNumber":200,"content":"      final familyId = (userDoc.data() as Map<String, dynamic>)['familyId'] as String?;"},{"type":"INSERT","lineNumber":201,"content":""},{"type":"INSERT","lineNumber":202,"content":"      if (familyId == null) {"},{"type":"INSERT","lineNumber":203,"content":"        return null;"},{"type":"INSERT","lineNumber":204,"content":"      }"},{"type":"INSERT","lineNumber":205,"content":""},{"type":"INSERT","lineNumber":206,"content":"      final familyDoc = await firestore.collection('families').doc(familyId).get();"},{"type":"INSERT","lineNumber":207,"content":"      if (familyDoc.exists) {"},{"type":"INSERT","lineNumber":208,"content":"        return FamilyModel.fromJson(familyDoc.data() as Map<String, dynamic>);"},{"type":"INSERT","lineNumber":209,"content":"      }"},{"type":"INSERT","lineNumber":210,"content":"      return null;"},{"type":"INSERT","lineNumber":211,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":212,"content":"      throw const ServerException('Could not fetch current family');"},{"type":"INSERT","lineNumber":213,"content":"    }"},{"type":"INSERT","lineNumber":214,"content":"  }"},{"type":"INSERT","lineNumber":215,"content":""},{"type":"INSERT","lineNumber":216,"content":"  @override"},{"type":"INSERT","lineNumber":253,"content":""},{"type":"DELETE","lineNumber":246,"oldContent":""},{"type":"INSERT","lineNumber":259,"content":""},{"type":"DELETE","lineNumber":252,"oldContent":""},{"type":"DELETE","lineNumber":254,"oldContent":"            'currentInviteCode': code,"},{"type":"INSERT","lineNumber":264,"content":"            'currentInviteCode': code,"},{"type":"DELETE","lineNumber":312,"oldContent":"        });"},{"type":"INSERT","lineNumber":322,"content":"        });"},{"type":"INSERT","lineNumber":323,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":316,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":329,"oldContent":""},{"type":"INSERT","lineNumber":339,"content":""}]},{"timestamp":1754516545628,"changes":[{"type":"INSERT","lineNumber":9,"content":"import 'family_remote_data_source.dart';"},{"type":"DELETE","lineNumber":10,"oldContent":"  Future<Family> createFamily(String name, String adminId);"},{"type":"DELETE","lineNumber":11,"oldContent":"  Future<Family?> getFamily(String familyId);"},{"type":"DELETE","lineNumber":12,"oldContent":"  Future<bool> checkFamilyMembership(String userId);"},{"type":"DELETE","lineNumber":13,"oldContent":"  Future<String> generateInviteCode(String familyId);"},{"type":"DELETE","lineNumber":14,"oldContent":"  Future<bool> validateInviteCode(String inviteCode);"},{"type":"DELETE","lineNumber":15,"oldContent":"}"},{"type":"DELETE","lineNumber":16,"oldContent":""},{"type":"INSERT","lineNumber":11,"content":"@Injectable(as: FamilyRemoteDataSource)"},{"type":"DELETE","lineNumber":29,"oldContent":"      // First create the family document"},{"type":"DELETE","lineNumber":30,"oldContent":"      final familyDoc = firestore.collection('families').doc();"},{"type":"DELETE","lineNumber":38,"oldContent":"      await firestore.collection('users').doc(adminId).update({"},{"type":"INSERT","lineNumber":31,"content":""},{"type":"INSERT","lineNumber":93,"content":""},{"type":"DELETE","lineNumber":106,"oldContent":"      // Check if invite code is expired"},{"type":"INSERT","lineNumber":101,"content":"      // Check if invite code is expired"},{"type":"INSERT","lineNumber":108,"content":"        });"},{"type":"INSERT","lineNumber":111,"content":""},{"type":"DELETE","lineNumber":124,"oldContent":"        });"},{"type":"DELETE","lineNumber":126,"oldContent":""},{"type":"DELETE","lineNumber":130,"oldContent":"      // Update user's family reference"},{"type":"INSERT","lineNumber":125,"content":"      // Update user's family reference"},{"type":"INSERT","lineNumber":128,"content":"      });"},{"type":"DELETE","lineNumber":139,"oldContent":""},{"type":"DELETE","lineNumber":140,"oldContent":"      });"},{"type":"DELETE","lineNumber":186,"oldContent":"  Future<Family?> getCurrentFamily(String userId) async {"},{"type":"DELETE","lineNumber":188,"oldContent":"    try {"},{"type":"DELETE","lineNumber":190,"oldContent":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"DELETE","lineNumber":192,"oldContent":"      final familyId = (userDoc.data() as Map<String, dynamic>)['familyId'] as String?;"},{"type":"DELETE","lineNumber":194,"oldContent":""},{"type":"DELETE","lineNumber":196,"oldContent":"      if (familyId == null) {"},{"type":"DELETE","lineNumber":198,"oldContent":"        return null;"},{"type":"DELETE","lineNumber":200,"oldContent":"      }"},{"type":"DELETE","lineNumber":202,"oldContent":""},{"type":"DELETE","lineNumber":204,"oldContent":"      final familyDoc = await firestore.collection('families').doc(familyId).get();"},{"type":"DELETE","lineNumber":206,"oldContent":"      if (familyDoc.exists) {"},{"type":"INSERT","lineNumber":190,"content":"  Future<Family?> getCurrentFamily(String userId) async {"},{"type":"INSERT","lineNumber":191,"content":"    try {"},{"type":"INSERT","lineNumber":192,"content":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"INSERT","lineNumber":193,"content":"      final familyId = (userDoc.data() as Map<String, dynamic>)['familyId'] as String?;"},{"type":"INSERT","lineNumber":194,"content":""},{"type":"INSERT","lineNumber":195,"content":"      if (familyId == null) {"},{"type":"INSERT","lineNumber":196,"content":"        return null;"},{"type":"INSERT","lineNumber":197,"content":"      }"},{"type":"INSERT","lineNumber":198,"content":""},{"type":"INSERT","lineNumber":199,"content":"      final familyDoc = await firestore.collection('families').doc(familyId).get();"},{"type":"INSERT","lineNumber":200,"content":"      if (familyDoc.exists) {"},{"type":"DELETE","lineNumber":209,"oldContent":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"DELETE","lineNumber":211,"oldContent":"    // TODO: Implement actual check against Firestore"},{"type":"DELETE","lineNumber":213,"oldContent":"    return false;"},{"type":"DELETE","lineNumber":215,"oldContent":"  }"},{"type":"DELETE","lineNumber":217,"oldContent":""},{"type":"INSERT","lineNumber":207,"content":"  }"},{"type":"INSERT","lineNumber":208,"content":""},{"type":"INSERT","lineNumber":210,"content":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"INSERT","lineNumber":211,"content":"    // TODO: Implement actual check against Firestore"},{"type":"INSERT","lineNumber":212,"content":"    return false;"},{"type":"DELETE","lineNumber":221,"oldContent":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"DELETE","lineNumber":223,"oldContent":"    try {"},{"type":"INSERT","lineNumber":216,"content":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"INSERT","lineNumber":217,"content":"    try {"},{"type":"INSERT","lineNumber":246,"content":""},{"type":"INSERT","lineNumber":252,"content":""},{"type":"DELETE","lineNumber":260,"oldContent":""},{"type":"INSERT","lineNumber":257,"content":"            'currentInviteCode': code,"},{"type":"DELETE","lineNumber":266,"oldContent":""},{"type":"DELETE","lineNumber":272,"oldContent":"            'currentInviteCode': code,"},{"type":"INSERT","lineNumber":315,"content":"        });"},{"type":"INSERT","lineNumber":316,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":329,"oldContent":"        });"},{"type":"DELETE","lineNumber":331,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"}]},{"timestamp":1754516600187,"changes":[{"type":"DELETE","lineNumber":24,"oldContent":""},{"type":"INSERT","lineNumber":31,"content":""},{"type":"DELETE","lineNumber":86,"oldContent":""},{"type":"INSERT","lineNumber":93,"content":""},{"type":"DELETE","lineNumber":95,"oldContent":"      // Check if invite code is expired"},{"type":"DELETE","lineNumber":102,"oldContent":"        });"},{"type":"INSERT","lineNumber":101,"content":"      // Check if invite code is expired"},{"type":"DELETE","lineNumber":106,"oldContent":""},{"type":"INSERT","lineNumber":108,"content":"        });"},{"type":"INSERT","lineNumber":111,"content":""},{"type":"DELETE","lineNumber":120,"oldContent":"      // Update user's family reference"},{"type":"DELETE","lineNumber":123,"oldContent":"      });"},{"type":"INSERT","lineNumber":125,"content":"      // Update user's family reference"},{"type":"INSERT","lineNumber":128,"content":"      });"},{"type":"INSERT","lineNumber":181,"content":"      developer.log('Firebase error getting family: ${e.message}', error: e);"},{"type":"INSERT","lineNumber":182,"content":"      throw const ServerException('Failed to retrieve family information');"},{"type":"INSERT","lineNumber":183,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":184,"content":"      developer.log('Unexpected error getting family: $e');"},{"type":"INSERT","lineNumber":185,"content":"      rethrow;"},{"type":"INSERT","lineNumber":186,"content":"    }"},{"type":"INSERT","lineNumber":187,"content":"  }"},{"type":"INSERT","lineNumber":188,"content":""},{"type":"INSERT","lineNumber":189,"content":"  @override"},{"type":"DELETE","lineNumber":183,"oldContent":"      developer.log('Firebase error getting family: ${e.message}', error: e);"},{"type":"DELETE","lineNumber":186,"oldContent":"      throw const ServerException('Failed to retrieve family information');"},{"type":"DELETE","lineNumber":189,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":192,"oldContent":"      developer.log('Unexpected error getting family: $e');"},{"type":"DELETE","lineNumber":195,"oldContent":"      rethrow;"},{"type":"DELETE","lineNumber":197,"oldContent":"    }"},{"type":"DELETE","lineNumber":198,"oldContent":"  }"},{"type":"DELETE","lineNumber":199,"oldContent":""},{"type":"DELETE","lineNumber":200,"oldContent":"  }"},{"type":"DELETE","lineNumber":201,"oldContent":"  @override"},{"type":"DELETE","lineNumber":202,"oldContent":""},{"type":"DELETE","lineNumber":204,"oldContent":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"DELETE","lineNumber":206,"oldContent":"    // TODO: Implement actual check against Firestore"},{"type":"DELETE","lineNumber":207,"oldContent":"    return false;"},{"type":"DELETE","lineNumber":210,"oldContent":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"DELETE","lineNumber":212,"oldContent":"    try {"},{"type":"INSERT","lineNumber":207,"content":"  }"},{"type":"INSERT","lineNumber":208,"content":""},{"type":"INSERT","lineNumber":210,"content":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"INSERT","lineNumber":211,"content":"    final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"INSERT","lineNumber":212,"content":"    return userDoc.exists && (userDoc.data()!).containsKey('familyId');"},{"type":"INSERT","lineNumber":216,"content":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"INSERT","lineNumber":217,"content":"    try {"},{"type":"DELETE","lineNumber":239,"oldContent":""},{"type":"MODIFY","lineNumber":246,"content":"","oldContent":""},{"type":"MODIFY","lineNumber":252,"content":"","oldContent":"            'currentInviteCode': code,"},{"type":"INSERT","lineNumber":257,"content":"            'currentInviteCode': code,"},{"type":"DELETE","lineNumber":308,"oldContent":"        });"},{"type":"DELETE","lineNumber":310,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":315,"content":"        });"},{"type":"INSERT","lineNumber":316,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":331,"content":""},{"type":"INSERT","lineNumber":332,"content":"  @override"},{"type":"INSERT","lineNumber":333,"content":"  Future<String> generateNewInviteCode(String familyId) async {"},{"type":"INSERT","lineNumber":334,"content":"    // This method seems redundant, but is required by the interface for now."},{"type":"INSERT","lineNumber":335,"content":"    return generateInviteCode(familyId);"},{"type":"INSERT","lineNumber":336,"content":"  }"}]},{"timestamp":1754516863779,"changes":[{"type":"MODIFY","lineNumber":31,"content":"","oldContent":""},{"type":"MODIFY","lineNumber":93,"content":"","oldContent":""},{"type":"MODIFY","lineNumber":101,"content":"      // Check if invite code is expired","oldContent":"      // Check if invite code is expired"},{"type":"DELETE","lineNumber":106,"oldContent":"        });"},{"type":"INSERT","lineNumber":108,"content":"        });"},{"type":"MODIFY","lineNumber":111,"content":"","oldContent":""},{"type":"DELETE","lineNumber":123,"oldContent":"      // Update user's family reference"},{"type":"INSERT","lineNumber":125,"content":"      // Update user's family reference"},{"type":"MODIFY","lineNumber":128,"content":"      });","oldContent":"      });"},{"type":"DELETE","lineNumber":182,"oldContent":"  Future<Family?> getCurrentFamily(String userId) async {"},{"type":"DELETE","lineNumber":184,"oldContent":"    try {"},{"type":"DELETE","lineNumber":187,"oldContent":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"MODIFY","lineNumber":189,"content":"  @override","oldContent":"      final familyId = (userDoc.data() as Map<String, dynamic>)['familyId'] as String?;"},{"type":"INSERT","lineNumber":190,"content":"  Future<Family?> getCurrentFamily(String userId) async {"},{"type":"INSERT","lineNumber":191,"content":"    try {"},{"type":"INSERT","lineNumber":192,"content":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"INSERT","lineNumber":193,"content":"      final familyId = (userDoc.data() as Map<String, dynamic>)['familyId'] as String?;"},{"type":"DELETE","lineNumber":195,"oldContent":"  @override"},{"type":"DELETE","lineNumber":203,"oldContent":"  }"},{"type":"DELETE","lineNumber":204,"oldContent":""},{"type":"DELETE","lineNumber":207,"oldContent":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"DELETE","lineNumber":208,"oldContent":"    final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"DELETE","lineNumber":210,"oldContent":"    return userDoc.exists && (userDoc.data()!).containsKey('familyId');"},{"type":"DELETE","lineNumber":212,"oldContent":"  @override"},{"type":"DELETE","lineNumber":214,"oldContent":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"INSERT","lineNumber":209,"content":"  @override"},{"type":"INSERT","lineNumber":210,"content":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"INSERT","lineNumber":212,"content":"      final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"INSERT","lineNumber":213,"content":"      if (userDoc.exists && (userDoc.data()!).containsKey('familyId')) {"},{"type":"INSERT","lineNumber":214,"content":"        return true;"},{"type":"INSERT","lineNumber":215,"content":"      }"},{"type":"INSERT","lineNumber":216,"content":"      return false;"},{"type":"INSERT","lineNumber":217,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":218,"content":"      throw ServerException('Error checking family membership');"},{"type":"INSERT","lineNumber":219,"content":"    }"},{"type":"INSERT","lineNumber":220,"content":"  }"},{"type":"INSERT","lineNumber":221,"content":""},{"type":"INSERT","lineNumber":223,"content":"  Future<String> generateInviteCode(String familyId) async {"},{"type":"INSERT","lineNumber":224,"content":"    try {"},{"type":"DELETE","lineNumber":245,"oldContent":""},{"type":"INSERT","lineNumber":253,"content":""},{"type":"DELETE","lineNumber":251,"oldContent":""},{"type":"INSERT","lineNumber":259,"content":""},{"type":"DELETE","lineNumber":256,"oldContent":"            'currentInviteCode': code,"},{"type":"INSERT","lineNumber":264,"content":"            'currentInviteCode': code,"},{"type":"DELETE","lineNumber":313,"oldContent":"        });"},{"type":"DELETE","lineNumber":315,"oldContent":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"INSERT","lineNumber":322,"content":"        });"},{"type":"INSERT","lineNumber":323,"content":"        developer.log('Expired invite code cleaned up: $inviteCode');"},{"type":"DELETE","lineNumber":332,"oldContent":"}"},{"type":"DELETE","lineNumber":334,"oldContent":""},{"type":"DELETE","lineNumber":336,"oldContent":"  }"},{"type":"INSERT","lineNumber":343,"content":"  }"},{"type":"INSERT","lineNumber":344,"content":"}"},{"type":"INSERT","lineNumber":345,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/screens/success_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/screens/success_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:lottie/lottie.dart';\n\nclass SuccessScreen extends StatelessWidget {\n  final String title;\n  final String message;\n  final String buttonText;\n  final VoidCallback? onButtonPressed;\n  final String? nextRoute;\n  final Map<String, dynamic>? arguments;\n\n  const SuccessScreen({\n    super.key,\n    required this.title,\n    required this.message,\n    this.buttonText = 'Continue',\n    this.onButtonPressed,\n    this.nextRoute,\n    this.arguments,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      body: SafeArea(\n        child: Padding(\n          padding: const EdgeInsets.all(24.0),\n          child: Column(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              // Success animation\n              SizedBox(\n                width: 200,\n                height: 200,\n                child: Lottie.asset(\n                  'assets/animations/success_animation.json',\n                  fit: BoxFit.contain,\n                ),\n              ),\n              \n              const SizedBox(height: 32),\n              \n              // Title\n              Text(\n                title,\n                style: const TextStyle(\n                  fontSize: 28,\n                  fontWeight: FontWeight.bold,\n                ),\n                textAlign: TextAlign.center,\n              ),\n              \n              const SizedBox(height: 16),\n              \n              // Message\n              Text(\n                message,\n                style: TextStyle(\n                  fontSize: 16,\n                  color: Colors.grey[600],\n                  height: 1.5,\n                ),\n                textAlign: TextAlign.center,\n              ),\n              \n              const SizedBox(height: 48),\n              \n              // Continue button\n              SizedBox(\n                width: double.infinity,\n                child: ElevatedButton(\n                  onPressed: () {\n                    Navigator.pushReplacementNamed(\n                      context,\n                      nextRoute,\n                      arguments: arguments,\n                    );\n                  },\n                  style: ElevatedButton.styleFrom(\n                    padding: const EdgeInsets.symmetric(vertical: 16),\n                    shape: RoundedRectangleBorder(\n                      borderRadius: BorderRadius.circular(12),\n                    ),\n                  ),\n                  child: const Text(\n                    'Continue',\n                    style: TextStyle(fontSize: 16),\n                  ),\n                ),\n              ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n}\n","baseTimestamp":1754510983412,"deltas":[{"timestamp":1754511003790,"changes":[{"type":"INSERT","lineNumber":57,"content":"                style: const TextStyle("},{"type":"INSERT","lineNumber":58,"content":"                  fontSize: 16,"},{"type":"INSERT","lineNumber":59,"content":"                  color: Colors.grey,"},{"type":"INSERT","lineNumber":60,"content":"                ),"},{"type":"INSERT","lineNumber":61,"content":"                textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":62,"content":"              ),"},{"type":"INSERT","lineNumber":63,"content":"              "},{"type":"INSERT","lineNumber":64,"content":"              const SizedBox(height: 40),"},{"type":"INSERT","lineNumber":65,"content":"              "},{"type":"INSERT","lineNumber":66,"content":"              // Message"},{"type":"INSERT","lineNumber":67,"content":"              Text("},{"type":"INSERT","lineNumber":68,"content":"                message,"},{"type":"DELETE","lineNumber":72,"oldContent":"                    Navigator.pushReplacementNamed("},{"type":"DELETE","lineNumber":73,"oldContent":"                      context,"},{"type":"DELETE","lineNumber":74,"oldContent":"                      nextRoute,"},{"type":"DELETE","lineNumber":75,"oldContent":"                      arguments: arguments,"},{"type":"DELETE","lineNumber":76,"oldContent":"                    );"},{"type":"INSERT","lineNumber":84,"content":"                    if (onButtonPressed != null) {"},{"type":"INSERT","lineNumber":85,"content":"                      onButtonPressed!();"},{"type":"INSERT","lineNumber":86,"content":"                    } else if (nextRoute != null) {"},{"type":"INSERT","lineNumber":87,"content":"                      Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":88,"content":"                        context,"},{"type":"INSERT","lineNumber":89,"content":"                        nextRoute!,"},{"type":"INSERT","lineNumber":90,"content":"                        arguments: arguments,"},{"type":"INSERT","lineNumber":91,"content":"                      );"},{"type":"INSERT","lineNumber":92,"content":"                    } else {"},{"type":"INSERT","lineNumber":93,"content":"                      Navigator.of(context).pop();"},{"type":"INSERT","lineNumber":94,"content":"                    }"},{"type":"DELETE","lineNumber":84,"oldContent":"                  child: const Text("},{"type":"DELETE","lineNumber":85,"oldContent":"                    'Continue',"},{"type":"DELETE","lineNumber":86,"oldContent":"                    style: TextStyle(fontSize: 16),"},{"type":"INSERT","lineNumber":102,"content":"                  child: Text("},{"type":"INSERT","lineNumber":103,"content":"                    buttonText,"},{"type":"INSERT","lineNumber":104,"content":"                    style: const TextStyle(fontSize: 16),"}]},{"timestamp":1754515388742,"changes":[{"type":"MODIFY","lineNumber":18,"content":"    this.arguments, required onPressed,","oldContent":"    this.arguments,"},{"type":"DELETE","lineNumber":58,"oldContent":"                style: TextStyle("},{"type":"DELETE","lineNumber":60,"oldContent":"                  fontSize: 16,"},{"type":"DELETE","lineNumber":62,"oldContent":"                  color: Colors.grey[600],"},{"type":"DELETE","lineNumber":64,"oldContent":"                  height: 1.5,"},{"type":"DELETE","lineNumber":66,"oldContent":"                ),"},{"type":"DELETE","lineNumber":68,"oldContent":"                textAlign: TextAlign.center,"},{"type":"DELETE","lineNumber":70,"oldContent":"              ),"},{"type":"INSERT","lineNumber":66,"content":"              // Message"},{"type":"INSERT","lineNumber":67,"content":"              Text("},{"type":"INSERT","lineNumber":68,"content":"                message,"},{"type":"INSERT","lineNumber":69,"content":"                style: TextStyle("},{"type":"INSERT","lineNumber":70,"content":"                  fontSize: 16,"},{"type":"INSERT","lineNumber":71,"content":"                  color: Colors.grey[600],"},{"type":"INSERT","lineNumber":72,"content":"                  height: 1.5,"},{"type":"INSERT","lineNumber":73,"content":"                ),"},{"type":"INSERT","lineNumber":74,"content":"                textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":75,"content":"              ),"},{"type":"DELETE","lineNumber":75,"oldContent":"              // Message"},{"type":"DELETE","lineNumber":77,"oldContent":"              Text("},{"type":"DELETE","lineNumber":79,"oldContent":"                message,"},{"type":"INSERT","lineNumber":84,"content":"                    if (onButtonPressed != null) {"},{"type":"INSERT","lineNumber":85,"content":"                      onButtonPressed!();"},{"type":"INSERT","lineNumber":86,"content":"                    } else if (nextRoute != null) {"},{"type":"INSERT","lineNumber":87,"content":"                      Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":88,"content":"                        context,"},{"type":"INSERT","lineNumber":89,"content":"                        nextRoute!,"},{"type":"INSERT","lineNumber":90,"content":"                        arguments: arguments,"},{"type":"INSERT","lineNumber":91,"content":"                      );"},{"type":"INSERT","lineNumber":92,"content":"                    } else {"},{"type":"INSERT","lineNumber":93,"content":"                      Navigator.of(context).pop();"},{"type":"INSERT","lineNumber":94,"content":"                    }"},{"type":"DELETE","lineNumber":91,"oldContent":"                    if (onButtonPressed != null) {"},{"type":"DELETE","lineNumber":92,"oldContent":"                      onButtonPressed!();"},{"type":"DELETE","lineNumber":93,"oldContent":"                    } else if (nextRoute != null) {"},{"type":"DELETE","lineNumber":94,"oldContent":"                      Navigator.pushReplacementNamed("},{"type":"INSERT","lineNumber":102,"content":"                  child: Text("},{"type":"INSERT","lineNumber":103,"content":"                    buttonText,"},{"type":"INSERT","lineNumber":104,"content":"                    style: const TextStyle(fontSize: 16),"},{"type":"DELETE","lineNumber":96,"oldContent":"                        context,"},{"type":"DELETE","lineNumber":98,"oldContent":"                        nextRoute!,"},{"type":"DELETE","lineNumber":100,"oldContent":"                        arguments: arguments,"},{"type":"DELETE","lineNumber":102,"oldContent":"                      );"},{"type":"DELETE","lineNumber":104,"oldContent":"                    } else {"},{"type":"DELETE","lineNumber":106,"oldContent":"                      Navigator.of(context).pop();"},{"type":"DELETE","lineNumber":108,"oldContent":"                    }"},{"type":"DELETE","lineNumber":113,"oldContent":"                    style: const TextStyle(fontSize: 16),"},{"type":"DELETE","lineNumber":114,"oldContent":"                    buttonText,"},{"type":"DELETE","lineNumber":115,"oldContent":"                  child: Text("}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/usecase.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/usecase.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';\n\ntypedef FutureEither<Type> = Future<Either<AuthFailure, Type>>;\n\nabstract class UseCase<Type, Params> {\n  FutureEither<Type> call(Params params);\n}\n","baseTimestamp":1754511077714,"deltas":[{"timestamp":1754515134839,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:family_tree_firebase/core/error/failures.dart';","oldContent":"import 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';"},{"type":"MODIFY","lineNumber":3,"content":"/// Generic typedef returning either a Failure or [Type].","oldContent":"typedef FutureEither<Type> = Future<Either<AuthFailure, Type>>;"},{"type":"INSERT","lineNumber":4,"content":"typedef FutureEither<Type> = Future<Either<Failure, Type>>;"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/check_auth_status.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/check_auth_status.dart","baseContent":"import 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/auth/domain/entities/user_entity.dart';\nimport 'package:family_tree_firebase/features/auth/domain/repositories/auth_repository.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart';\n\nclass CheckAuthStatus implements UseCase<UserEntity?, NoParams> {\n  final AuthRepository repository;\n\n  const CheckAuthStatus(this.repository);\n\n  @override\n  FutureEither<UserEntity?> call(NoParams params) async {\n    final currentUser = await repository.getCurrentUser();\n    return currentUser.fold(\n      (failure) => Left(failure),\n      (user) => Right(user),\n    );\n  }\n}\n","baseTimestamp":1754511100606,"deltas":[{"timestamp":1754512231970,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'dart:async';"},{"type":"INSERT","lineNumber":1,"content":""},{"type":"INSERT","lineNumber":2,"content":"import 'package:dartz/dartz.dart';"},{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';"},{"type":"DELETE","lineNumber":15,"oldContent":"      (failure) => Left(failure),"},{"type":"INSERT","lineNumber":19,"content":"      (failure) => Left(failure) as FutureOr<Either<AuthFailure, UserEntity?>> Function(),"}]},{"timestamp":1754512236056,"changes":[{"type":"DELETE","lineNumber":1,"oldContent":"import 'package:family_tree_firebase/core/error/failures.dart';"},{"type":"MODIFY","lineNumber":3,"content":"import 'package:family_tree_firebase/core/error/failures.dart';","oldContent":"import 'package:family_tree_firebase/core/usecases/usecase.dart';"},{"type":"INSERT","lineNumber":4,"content":"import 'package:family_tree_firebase/core/usecases/usecase.dart';"},{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';"},{"type":"DELETE","lineNumber":9,"oldContent":"import 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';"},{"type":"INSERT","lineNumber":19,"content":"      (failure) => Left(failure) as FutureOr<Either<AuthFailure, UserEntity?>> Function() as FutureOr<Either<AuthFailure, UserEntity?>> Function(),"},{"type":"DELETE","lineNumber":22,"oldContent":"      (failure) => Left(failure) as FutureOr<Either<AuthFailure, UserEntity?>> Function(),"}]},{"timestamp":1754512247463,"changes":[{"type":"INSERT","lineNumber":2,"content":"import 'package:dartz/dartz.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:dartz/dartz.dart';"},{"type":"MODIFY","lineNumber":19,"content":"      (failure) => Left(failure) as FutureOr<Either<AuthFailure, UserEntity?>> Function(),","oldContent":"      (failure) => Left(failure) as FutureOr<Either<AuthFailure, UserEntity?>> Function() as FutureOr<Either<AuthFailure, UserEntity?>> Function(),"}]},{"timestamp":1754512250226,"changes":[{"type":"DELETE","lineNumber":0,"oldContent":"import 'dart:async';"},{"type":"DELETE","lineNumber":1,"oldContent":""},{"type":"DELETE","lineNumber":2,"oldContent":"import 'package:dartz/dartz.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":"import 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';"},{"type":"DELETE","lineNumber":19,"oldContent":"      (failure) => Left(failure) as FutureOr<Either<AuthFailure, UserEntity?>> Function(),"},{"type":"INSERT","lineNumber":15,"content":"      (failure) => Left(failure),"}]},{"timestamp":1754512323007,"changes":[{"type":"DELETE","lineNumber":11,"oldContent":"      (failure) => Left(failure),"},{"type":"DELETE","lineNumber":14,"oldContent":"    final currentUser = await repository.getCurrentUser();"},{"type":"DELETE","lineNumber":15,"oldContent":"    return currentUser.fold("},{"type":"DELETE","lineNumber":16,"oldContent":"      (user) => Right(user),"},{"type":"DELETE","lineNumber":17,"oldContent":"    );"},{"type":"INSERT","lineNumber":13,"content":"    try {"},{"type":"INSERT","lineNumber":14,"content":"      final currentUser = await repository.getCurrentUser();"},{"type":"INSERT","lineNumber":15,"content":"      return currentUser.fold("},{"type":"INSERT","lineNumber":16,"content":"        () => const Right(null), // Handle None case (no user)"},{"type":"INSERT","lineNumber":17,"content":"        (user) => Right(user),   // Handle Some case (user exists)"},{"type":"INSERT","lineNumber":18,"content":"      );"},{"type":"INSERT","lineNumber":19,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":20,"content":"      return Left(AuthFailure('Failed to check authentication status: $e'));"},{"type":"INSERT","lineNumber":21,"content":"    }"}]},{"timestamp":1754512355225,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:dartz/dartz.dart';"},{"type":"DELETE","lineNumber":12,"oldContent":"    try {"},{"type":"INSERT","lineNumber":14,"content":"    try {"},{"type":"DELETE","lineNumber":19,"oldContent":"  }"},{"type":"DELETE","lineNumber":21,"oldContent":"}"},{"type":"MODIFY","lineNumber":23,"content":"  }","oldContent":""},{"type":"INSERT","lineNumber":24,"content":"}"},{"type":"INSERT","lineNumber":25,"content":""}]},{"timestamp":1754512360095,"changes":[{"type":"INSERT","lineNumber":7,"content":"import '../failures/auth_failure.dart';"},{"type":"INSERT","lineNumber":8,"content":""},{"type":"INSERT","lineNumber":24,"content":"    }"},{"type":"DELETE","lineNumber":24,"oldContent":"    }"}]},{"timestamp":1754512370565,"changes":[{"type":"INSERT","lineNumber":7,"content":"import '../../../../core/usecases/usecase.dart';"},{"type":"DELETE","lineNumber":8,"oldContent":"class CheckAuthStatus implements UseCase<UserEntity?, NoParams> {"},{"type":"INSERT","lineNumber":10,"content":"class CheckAuthStatus implements UseCase<UserEntity?, NoParams> {"},{"type":"INSERT","lineNumber":25,"content":"    }"},{"type":"DELETE","lineNumber":26,"oldContent":"    }"}]},{"timestamp":1754512382184,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:family_tree_firebase/core/usecases/usecase.dart' hide UseCase;","oldContent":"import 'package:family_tree_firebase/core/usecases/usecase.dart';"},{"type":"MODIFY","lineNumber":7,"content":"import '../../../../core/usecases/usecase.dart' hide UseCase;","oldContent":"import '../../../../core/usecases/usecase.dart';"},{"type":"MODIFY","lineNumber":26,"content":"  }","oldContent":"  }"}]},{"timestamp":1754515503532,"changes":[{"type":"MODIFY","lineNumber":24,"content":"      return Left(UnexpectedFailure('Failed to check authentication status: $e'));","oldContent":"      return Left(AuthFailure('Failed to check authentication status: $e'));"},{"type":"INSERT","lineNumber":25,"content":"    }"},{"type":"DELETE","lineNumber":26,"oldContent":"  }"}]},{"timestamp":1754515697854,"changes":[{"type":"MODIFY","lineNumber":24,"content":"      return Left(UnexpectedFailure());","oldContent":"      return Left(UnexpectedFailure('Failed to check authentication status: $e'));"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/delete_account.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/delete_account.dart","baseContent":"import 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';\nimport 'package:family_tree_firebase/features/auth/domain/repositories/auth_repository.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart';\n\nclass DeleteAccount implements UseCase<Unit, NoParams> {\n  final AuthRepository repository;\n\n  const DeleteAccount(this.repository);\n\n  @override\n  FutureEither<Unit> call(NoParams params) async {\n    return await repository.deleteAccount();\n  }\n}\n","baseTimestamp":1754511123710,"deltas":[{"timestamp":1754511351432,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:dartz/dartz.dart';"},{"type":"INSERT","lineNumber":1,"content":"import 'package:family_tree_firebase/core/usecases/usecase.dart';"},{"type":"DELETE","lineNumber":2,"oldContent":"import 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart';"}]},{"timestamp":1754512405584,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';","oldContent":"import 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';"},{"type":"INSERT","lineNumber":4,"content":"import 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart' show FutureEither;"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/sign_out.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/sign_out.dart","baseContent":"import 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';\nimport 'package:family_tree_firebase/features/auth/domain/repositories/auth_repository.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart';\n\nclass SignOut implements UseCase<Unit, NoParams> {\n  final AuthRepository repository;\n\n  const SignOut(this.repository);\n\n  @override\n  FutureEither<Unit> call(NoParams params) async {\n    return await repository.signOut();\n  }\n}\n","baseTimestamp":1754511144856,"deltas":[{"timestamp":1754511183894,"changes":[{"type":"INSERT","lineNumber":4,"content":"import '../../../../core/usecases/usecase.dart';"},{"type":"INSERT","lineNumber":5,"content":""}]},{"timestamp":1754511188942,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:dartz/dartz.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"class SignOut implements UseCase<Unit, NoParams> {"},{"type":"INSERT","lineNumber":7,"content":"class SignOut implements UseCase<Unit, NoParams> {"}]},{"timestamp":1754511215151,"changes":[{"type":"MODIFY","lineNumber":3,"content":"import 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart' hide UseCase;","oldContent":"import 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart';"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/sign_in_with_apple.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/sign_in_with_apple.dart","baseContent":"import 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';\nimport 'package:family_tree_firebase/features/auth/domain/repositories/auth_repository.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart' hide UseCase;\n\nclass SignInWithApple implements UseCase<Unit, NoParams> {\n  final AuthRepository repository;\n\n  const SignInWithApple(this.repository);\n\n  @override\n  Future<Either<Failure, Unit>> call(NoParams params) async {\n    return await repository.signInWithApple();\n  }\n}\n","baseTimestamp":1754511362166,"deltas":[{"timestamp":1754511412918,"changes":[{"type":"MODIFY","lineNumber":11,"content":"  FutureEither<Unit> call(NoParams params) async {","oldContent":"  Future<Either<Failure, Unit>> call(NoParams params) async {"}]},{"timestamp":1754512448998,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:dartz/dartz.dart';"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/sign_in_with_google.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/sign_in_with_google.dart","baseContent":"import 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';\nimport 'package:family_tree_firebase/features/auth/domain/repositories/auth_repository.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart' hide UseCase;\n\nclass SignInWithGoogle implements UseCase<Unit, NoParams> {\n  final AuthRepository repository;\n\n  const SignInWithGoogle(this.repository);\n\n  @override\n  Future<Either<Failure, Unit>> call(NoParams params) async {\n    return await repository.signInWithGoogle();\n  }\n}\n","baseTimestamp":1754511368045,"deltas":[{"timestamp":1754511373230,"changes":[{"type":"INSERT","lineNumber":5,"content":"import '../../../../core/error/failures.dart';"},{"type":"INSERT","lineNumber":6,"content":""}]},{"timestamp":1754511380354,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:dartz/dartz.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":"class SignInWithGoogle implements UseCase<Unit, NoParams> {"},{"type":"INSERT","lineNumber":8,"content":"class SignInWithGoogle implements UseCase<Unit, NoParams> {"}]},{"timestamp":1754511405032,"changes":[{"type":"MODIFY","lineNumber":14,"content":"  FutureEither<Unit> call(NoParams params) async {","oldContent":"  Future<Either<Failure, Unit>> call(NoParams params) async {"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/network/network_info_impl.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/network/network_info_impl.dart","baseContent":"import 'dart:async';\nimport 'package:connectivity_plus/connectivity_plus.dart';\nimport 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/network/network_info.dart';\n\nclass NetworkInfoImpl implements NetworkInfo {\n  final Connectivity connectivity;\n  final StreamController<bool> _connectionStatusController = StreamController<bool>.broadcast();\n\n  NetworkInfoImpl({required this.connectivity}) {\n    // Listen to connectivity changes\n    connectivity.onConnectivityChanged.listen((ConnectivityResult result) {\n      _connectionStatusController.add(_isConnected(result));\n    });\n  }\n\n  @override\n  Future<bool> get isConnected async {\n    final connectivityResult = await connectivity.checkConnectivity();\n    return _isConnected(connectivityResult);\n  }\n\n  @override\n  Future<Either<Failure, bool>> isConnectedWithFailure() async {\n    try {\n      final isConnected = await this.isConnected;\n      return Right(isConnected);\n    } catch (e) {\n      return Left(NetworkFailure('Network connectivity check failed'));\n    }\n  }\n\n  bool _isConnected(ConnectivityResult result) {\n    return result == ConnectivityResult.wifi ||\n        result == ConnectivityResult.ethernet ||\n        result == ConnectivityResult.mobile ||\n        result == ConnectivityResult.vpn;\n  }\n\n  void dispose() {\n    _connectionStatusController.close();\n  }\n}\n","baseTimestamp":1754511781221},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/data/datasources/auth_remote_data_source_impl.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/data/datasources/auth_remote_data_source_impl.dart","baseContent":"import 'dart:async';\n\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:google_sign_in/google_sign_in.dart';\nimport 'package:sign_in_with_apple/sign_in_with_apple.dart';\nimport 'package:family_tree_firebase/features/auth/data/models/user_model.dart';\nimport 'auth_remote_data_source.dart';\n\nclass AuthRemoteDataSourceImpl implements AuthRemoteDataSource {\n  final FirebaseAuth _firebaseAuth;\n  final GoogleSignIn _googleSignIn;\n\n  AuthRemoteDataSourceImpl({\n    FirebaseAuth? firebaseAuth,\n    GoogleSignIn? googleSignIn,\n  })  : _firebaseAuth = firebaseAuth ?? FirebaseAuth.instance,\n        _googleSignIn = googleSignIn ?? GoogleSignIn.standard();\n\n  @override\n  Future<bool> isSignedIn() async {\n    final currentUser = _firebaseAuth.currentUser;\n    return currentUser != null;\n  }\n\n  @override\n  Future<UserModel?> getCurrentUser() async {\n    final user = _firebaseAuth.currentUser;\n    if (user == null) return null;\n    \n    final token = await user.getIdToken();\n    return UserModel.fromFirebaseUser(user, token);\n  }\n\n  @override\n  Future<UserCredential> signInWithEmailAndPassword({\n    required String email,\n    required String password,\n  }) async {\n    return await _firebaseAuth.signInWithEmailAndPassword(\n      email: email,\n      password: password,\n    );\n  }\n\n  @override\n  Future<UserCredential> registerWithEmailAndPassword({\n    required String email,\n    required String password,\n    required String displayName,\n    String? phoneNumber,\n  }) async {\n    final userCredential = await _firebaseAuth.createUserWithEmailAndPassword(\n      email: email,\n      password: password,\n    );\n    \n    await userCredential.user?.updateDisplayName(displayName);\n    if (phoneNumber != null) {\n      await userCredential.user?.updatePhoneNumber(phoneNumber as PhoneAuthCredential);\n    }\n    \n    return userCredential;\n  }\n\n  @override\n  Future<UserCredential> signInWithGoogle() async {\n    final googleUser = await _googleSignIn.signIn();\n    if (googleUser == null) {\n      throw Exception('Google Sign In was cancelled');\n    }\n\n    final googleAuth = await googleUser.authentication;\n    final credential = GoogleAuthProvider.credential(\n      accessToken: googleAuth.accessToken,\n      idToken: googleAuth.idToken,\n    );\n\n    return await _firebaseAuth.signInWithCredential(credential);\n  }\n\n  @override\n  Future<UserCredential> signInWithApple() async {\n    final appleCredential = await SignInWithApple.getAppleIDCredential(\n      scopes: [\n        AppleIDAuthorizationScopes.email,\n        AppleIDAuthorizationScopes.fullName,\n      ],\n    );\n\n    final oauthCredential = OAuthProvider('apple.com').credential(\n      idToken: appleCredential.identityToken,\n      accessToken: appleCredential.authorizationCode,\n    );\n\n    return await _firebaseAuth.signInWithCredential(oauthCredential);\n  }\n\n  @override\n  Future<String> sendOtpToPhoneNumber({required String phoneNumber}) async {\n    final completer = Completer<String>();\n    \n    await _firebaseAuth.verifyPhoneNumber(\n      phoneNumber: phoneNumber,\n      verificationCompleted: (PhoneAuthCredential credential) {\n        // Auto-verification completed\n        _firebaseAuth.signInWithCredential(credential);\n      },\n      verificationFailed: (FirebaseAuthException e) {\n        completer.completeError(e);\n      },\n      codeSent: (String verificationId, int? resendToken) {\n        completer.complete(verificationId);\n      },\n      codeAutoRetrievalTimeout: (String verificationId) {\n        // Auto-resolution timed out...\n      },\n    );\n    \n    return completer.future;\n  }\n\n  @override\n  Future<UserCredential> verifyOtp({\n    required String verificationId,\n    required String smsCode,\n  }) async {\n    final credential = PhoneAuthProvider.credential(\n      verificationId: verificationId,\n      smsCode: smsCode,\n    );\n    \n    return await _firebaseAuth.signInWithCredential(credential);\n  }\n\n  @override\n  Future<void> signOut() async {\n    await Future.wait([\n      _firebaseAuth.signOut(),\n      _googleSignIn.signOut(),\n    ]);\n  }\n\n  @override\n  Future<String> getAuthToken() async {\n    final user = _firebaseAuth.currentUser;\n    if (user == null) throw Exception('No user is signed in');\n    \n    final token = await user.getIdToken();\n    return token ?? '';\n  }\n\n  @override\n  Future<void> updateUserProfile({\n    String? displayName,\n    String? photoUrl,\n    String? phoneNumber,\n  }) async {\n    final user = _firebaseAuth.currentUser;\n    if (user == null) throw Exception('No user is signed in');\n    \n    await user.updateDisplayName(displayName);\n    if (photoUrl != null) {\n      await user.updatePhotoURL(photoUrl);\n    }\n    if (phoneNumber != null) {\n      // Note: Updating phone number requires re-authentication\n      // This is a simplified example - in a real app, you'd need to handle re-authentication\n      throw UnimplementedError('Phone number update not implemented');\n    }\n  }\n\n  @override\n  Future<void> sendPasswordResetEmail(String email) async {\n    await _firebaseAuth.sendPasswordResetEmail(email: email);\n  }\n\n  @override\n  Future<void> deleteAccount() async {\n    final user = _firebaseAuth.currentUser;\n    if (user == null) throw Exception('No user is signed in');\n    \n    await user.delete();\n  }\n}\n","baseTimestamp":1754511986066,"deltas":[{"timestamp":1754592762566,"changes":[{"type":"DELETE","lineNumber":51,"oldContent":"    final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"DELETE","lineNumber":52,"oldContent":"      email: email,"},{"type":"DELETE","lineNumber":53,"oldContent":"      password: password,"},{"type":"DELETE","lineNumber":54,"oldContent":"    );"},{"type":"DELETE","lineNumber":55,"oldContent":"    "},{"type":"DELETE","lineNumber":56,"oldContent":"    await userCredential.user?.updateDisplayName(displayName);"},{"type":"DELETE","lineNumber":57,"oldContent":"    if (phoneNumber != null) {"},{"type":"DELETE","lineNumber":58,"oldContent":"      await userCredential.user?.updatePhoneNumber(phoneNumber as PhoneAuthCredential);"},{"type":"INSERT","lineNumber":51,"content":"    try {"},{"type":"INSERT","lineNumber":52,"content":"      // First create the user with email and password"},{"type":"INSERT","lineNumber":53,"content":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"INSERT","lineNumber":54,"content":"        email: email,"},{"type":"INSERT","lineNumber":55,"content":"        password: password,"},{"type":"INSERT","lineNumber":56,"content":"      );"},{"type":"INSERT","lineNumber":57,"content":"      "},{"type":"INSERT","lineNumber":58,"content":"      // Update the display name"},{"type":"INSERT","lineNumber":59,"content":"      if (userCredential.user != null) {"},{"type":"INSERT","lineNumber":60,"content":"        await userCredential.user!.updateDisplayName(displayName);"},{"type":"INSERT","lineNumber":61,"content":"        "},{"type":"INSERT","lineNumber":62,"content":"        // Phone verification should be handled separately with OTP"},{"type":"INSERT","lineNumber":63,"content":"        // We'll just store the phone number in the user's profile for now"},{"type":"INSERT","lineNumber":64,"content":"        if (phoneNumber != null && phoneNumber.isNotEmpty) {"},{"type":"INSERT","lineNumber":65,"content":"          await userCredential.user!.updatePhoneNumber(null); // This will be set after OTP verification"},{"type":"INSERT","lineNumber":66,"content":"          // You might want to store the phone number in Firestore or your database here"},{"type":"INSERT","lineNumber":67,"content":"        }"},{"type":"INSERT","lineNumber":68,"content":"      }"},{"type":"INSERT","lineNumber":69,"content":"      "},{"type":"INSERT","lineNumber":70,"content":"      return userCredential;"},{"type":"INSERT","lineNumber":71,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":72,"content":"      // If there's an error, delete the created user to avoid partial registration"},{"type":"INSERT","lineNumber":73,"content":"      if (_firebaseAuth.currentUser != null) {"},{"type":"INSERT","lineNumber":74,"content":"        await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":75,"content":"      }"},{"type":"INSERT","lineNumber":76,"content":"      rethrow;"},{"type":"DELETE","lineNumber":60,"oldContent":"    "},{"type":"DELETE","lineNumber":61,"oldContent":"    return userCredential;"}]},{"timestamp":1754592806396,"changes":[{"type":"DELETE","lineNumber":60,"oldContent":"    }"},{"type":"INSERT","lineNumber":61,"content":"        await userCredential.user!.reload();"},{"type":"MODIFY","lineNumber":63,"content":"        // For now, we'll just store the phone number in the user's profile","oldContent":"        // Phone verification should be handled separately with OTP"},{"type":"INSERT","lineNumber":64,"content":"        // The actual phone number verification will be handled in the OTP flow"},{"type":"INSERT","lineNumber":65,"content":"        if (phoneNumber != null && phoneNumber.isNotEmpty) {"},{"type":"INSERT","lineNumber":66,"content":"          // Store the phone number in the user's custom claims or Firestore"},{"type":"INSERT","lineNumber":67,"content":"          // For now, we'll just update the phone number in the user profile"},{"type":"INSERT","lineNumber":68,"content":"          // Note: This won't verify the phone number"},{"type":"INSERT","lineNumber":69,"content":"          // To verify the phone number, use the OTP flow after registration"},{"type":"INSERT","lineNumber":70,"content":"        }"},{"type":"INSERT","lineNumber":71,"content":"      }"},{"type":"INSERT","lineNumber":72,"content":"      "},{"type":"INSERT","lineNumber":73,"content":"      return userCredential;"},{"type":"INSERT","lineNumber":74,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":75,"content":"      // If there's an error, delete the created user to avoid partial registration"},{"type":"INSERT","lineNumber":76,"content":"      if (_firebaseAuth.currentUser != null) {"},{"type":"INSERT","lineNumber":77,"content":"        try {"},{"type":"INSERT","lineNumber":78,"content":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":79,"content":"        } catch (deleteError) {"},{"type":"INSERT","lineNumber":80,"content":"          // Ignore delete errors as the user might not have been created"},{"type":"INSERT","lineNumber":81,"content":"        }"},{"type":"INSERT","lineNumber":82,"content":"      }"},{"type":"INSERT","lineNumber":83,"content":"      rethrow; // Re-throw the original error"},{"type":"INSERT","lineNumber":84,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":85,"content":"      // For any other type of error, clean up and rethrow"},{"type":"INSERT","lineNumber":86,"content":"      if (_firebaseAuth.currentUser != null) {"},{"type":"INSERT","lineNumber":87,"content":"        try {"},{"type":"INSERT","lineNumber":88,"content":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":89,"content":"        } catch (deleteError) {"},{"type":"INSERT","lineNumber":90,"content":"          // Ignore delete errors"},{"type":"INSERT","lineNumber":91,"content":"        }"},{"type":"INSERT","lineNumber":92,"content":"      }"},{"type":"INSERT","lineNumber":93,"content":"      rethrow;"},{"type":"INSERT","lineNumber":94,"content":"    }"},{"type":"DELETE","lineNumber":65,"oldContent":"        // We'll just store the phone number in the user's profile for now"},{"type":"DELETE","lineNumber":67,"oldContent":"        if (phoneNumber != null && phoneNumber.isNotEmpty) {"},{"type":"DELETE","lineNumber":69,"oldContent":"          await userCredential.user!.updatePhoneNumber(null); // This will be set after OTP verification"},{"type":"DELETE","lineNumber":71,"oldContent":"          // You might want to store the phone number in Firestore or your database here"},{"type":"DELETE","lineNumber":73,"oldContent":"        }"},{"type":"DELETE","lineNumber":75,"oldContent":"      }"},{"type":"DELETE","lineNumber":77,"oldContent":"      "},{"type":"DELETE","lineNumber":79,"oldContent":"      return userCredential;"},{"type":"DELETE","lineNumber":81,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":83,"oldContent":"      // If there's an error, delete the created user to avoid partial registration"},{"type":"DELETE","lineNumber":85,"oldContent":"      if (_firebaseAuth.currentUser != null) {"},{"type":"DELETE","lineNumber":87,"oldContent":"        await _firebaseAuth.currentUser!.delete();"},{"type":"DELETE","lineNumber":89,"oldContent":"      }"},{"type":"DELETE","lineNumber":91,"oldContent":"      rethrow;"}]},{"timestamp":1754593002463,"changes":[{"type":"INSERT","lineNumber":51,"content":"    print('Starting Firebase user creation for: $email');"},{"type":"INSERT","lineNumber":54,"content":"      print('Creating user with email and password...');"},{"type":"INSERT","lineNumber":60,"content":"      print('User created successfully: ${userCredential.user?.uid}');"},{"type":"INSERT","lineNumber":61,"content":"      "},{"type":"DELETE","lineNumber":60,"oldContent":"        await userCredential.user!.reload();"},{"type":"DELETE","lineNumber":61,"oldContent":"        await userCredential.user!.updateDisplayName(displayName);"},{"type":"INSERT","lineNumber":64,"content":"        print('Updating display name to: $displayName');"},{"type":"INSERT","lineNumber":65,"content":"        try {"},{"type":"INSERT","lineNumber":66,"content":"          await userCredential.user!.updateDisplayName(displayName);"},{"type":"INSERT","lineNumber":67,"content":"          await userCredential.user!.reload();"},{"type":"INSERT","lineNumber":68,"content":"          print('Display name updated successfully');"},{"type":"INSERT","lineNumber":69,"content":"        } catch (updateError) {"},{"type":"INSERT","lineNumber":70,"content":"          print('Error updating display name: $updateError');"},{"type":"INSERT","lineNumber":71,"content":"          // Continue even if display name update fails"},{"type":"INSERT","lineNumber":72,"content":"        }"},{"type":"DELETE","lineNumber":63,"oldContent":"        // For now, we'll just store the phone number in the user's profile"},{"type":"DELETE","lineNumber":64,"oldContent":"        // The actual phone number verification will be handled in the OTP flow"},{"type":"DELETE","lineNumber":65,"oldContent":"  }"},{"type":"INSERT","lineNumber":74,"content":"        // Handle phone number if provided"},{"type":"DELETE","lineNumber":67,"oldContent":"          // Store the phone number in the user's custom claims or Firestore"},{"type":"DELETE","lineNumber":68,"oldContent":""},{"type":"DELETE","lineNumber":69,"oldContent":"          // For now, we'll just update the phone number in the user profile"},{"type":"DELETE","lineNumber":70,"oldContent":"          // Note: This won't verify the phone number"},{"type":"DELETE","lineNumber":71,"oldContent":"  @override"},{"type":"DELETE","lineNumber":72,"oldContent":"          // To verify the phone number, use the OTP flow after registration"},{"type":"INSERT","lineNumber":76,"content":"          print('Phone number provided: $phoneNumber');"},{"type":"INSERT","lineNumber":77,"content":"          // We'll handle phone verification in a separate step after registration"},{"type":"INSERT","lineNumber":78,"content":"          // For now, we'll just store the phone number in the user's profile"},{"type":"INSERT","lineNumber":79,"content":"          try {"},{"type":"INSERT","lineNumber":80,"content":"            // This is just for storage, not verification"},{"type":"INSERT","lineNumber":81,"content":"            // The actual verification will be done via OTP"},{"type":"INSERT","lineNumber":82,"content":"            await userCredential.user!.updatePhoneNumber(null);"},{"type":"INSERT","lineNumber":83,"content":"            print('Phone number field initialized for future verification');"},{"type":"INSERT","lineNumber":84,"content":"          } catch (phoneError) {"},{"type":"INSERT","lineNumber":85,"content":"            print('Error initializing phone number field: $phoneError');"},{"type":"INSERT","lineNumber":86,"content":"            // Continue even if phone number initialization fails"},{"type":"INSERT","lineNumber":87,"content":"          }"},{"type":"DELETE","lineNumber":74,"oldContent":"  Future<UserCredential> signInWithGoogle() async {"},{"type":"DELETE","lineNumber":77,"oldContent":"    final googleUser = await _googleSignIn.signIn();"},{"type":"DELETE","lineNumber":80,"oldContent":"    if (googleUser == null) {"},{"type":"INSERT","lineNumber":93,"content":"      print('FirebaseAuthException during registration:');"},{"type":"INSERT","lineNumber":94,"content":"      print('Code: ${e.code}');"},{"type":"INSERT","lineNumber":95,"content":"      print('Message: ${e.message}');"},{"type":"INSERT","lineNumber":96,"content":"      print('Email: ${e.email}');"},{"type":"INSERT","lineNumber":97,"content":"      print('Credential: ${e.credential}');"},{"type":"INSERT","lineNumber":98,"content":"      "},{"type":"DELETE","lineNumber":83,"oldContent":"      throw Exception('Google Sign In was cancelled');"},{"type":"INSERT","lineNumber":101,"content":"        print('Attempting to clean up partially created user...');"},{"type":"DELETE","lineNumber":86,"oldContent":"    }"},{"type":"INSERT","lineNumber":104,"content":"          print('Successfully cleaned up partially created user');"},{"type":"DELETE","lineNumber":88,"oldContent":"          // Ignore delete errors as the user might not have been created"},{"type":"DELETE","lineNumber":89,"oldContent":""},{"type":"INSERT","lineNumber":106,"content":"          print('Error during user cleanup: $deleteError');"},{"type":"INSERT","lineNumber":107,"content":"          // Continue with the original error"},{"type":"DELETE","lineNumber":92,"oldContent":"    final googleAuth = await googleUser.authentication;"},{"type":"DELETE","lineNumber":94,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":95,"oldContent":"    final credential = GoogleAuthProvider.credential("},{"type":"INSERT","lineNumber":111,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":112,"content":"      print('Unexpected error during registration:');"},{"type":"INSERT","lineNumber":113,"content":"      print('Error: $e');"},{"type":"INSERT","lineNumber":114,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":115,"content":"      "},{"type":"DELETE","lineNumber":98,"oldContent":"      accessToken: googleAuth.accessToken,"},{"type":"INSERT","lineNumber":118,"content":"        print('Attempting to clean up after unexpected error...');"},{"type":"DELETE","lineNumber":101,"oldContent":"      idToken: googleAuth.idToken,"},{"type":"DELETE","lineNumber":103,"oldContent":"          // Ignore delete errors"},{"type":"DELETE","lineNumber":104,"oldContent":"    );"},{"type":"INSERT","lineNumber":122,"content":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"DELETE","lineNumber":107,"oldContent":""},{"type":"DELETE","lineNumber":109,"oldContent":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":126,"content":"    } finally {"},{"type":"INSERT","lineNumber":127,"content":"      print('Registration process completed');"},{"type":"INSERT","lineNumber":132,"content":"  Future<UserCredential> signInWithGoogle() async {"},{"type":"INSERT","lineNumber":133,"content":"    final googleUser = await _googleSignIn.signIn();"},{"type":"INSERT","lineNumber":134,"content":"    if (googleUser == null) {"},{"type":"INSERT","lineNumber":135,"content":"      throw Exception('Google Sign In was cancelled');"},{"type":"INSERT","lineNumber":136,"content":"    }"},{"type":"INSERT","lineNumber":137,"content":""},{"type":"INSERT","lineNumber":138,"content":"    final googleAuth = await googleUser.authentication;"},{"type":"INSERT","lineNumber":139,"content":"    final credential = GoogleAuthProvider.credential("},{"type":"INSERT","lineNumber":140,"content":"      accessToken: googleAuth.accessToken,"},{"type":"INSERT","lineNumber":141,"content":"      idToken: googleAuth.idToken,"},{"type":"INSERT","lineNumber":142,"content":"    );"},{"type":"INSERT","lineNumber":143,"content":""},{"type":"INSERT","lineNumber":144,"content":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":145,"content":"  }"},{"type":"INSERT","lineNumber":146,"content":""},{"type":"INSERT","lineNumber":147,"content":"  @override"}]},{"timestamp":1754593295349,"changes":[{"type":"MODIFY","lineNumber":55,"content":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword(","oldContent":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"DELETE","lineNumber":60,"oldContent":"      // Update the display name"},{"type":"DELETE","lineNumber":61,"oldContent":"      if (userCredential.user != null) {"},{"type":"DELETE","lineNumber":64,"oldContent":"        "},{"type":"INSERT","lineNumber":62,"content":"      // Update the display name"},{"type":"INSERT","lineNumber":63,"content":"      if (userCredential.user != null) {"},{"type":"DELETE","lineNumber":68,"oldContent":"        if (phoneNumber != null && phoneNumber.isNotEmpty) {"},{"type":"DELETE","lineNumber":75,"oldContent":"        }"},{"type":"INSERT","lineNumber":73,"content":"        "},{"type":"DELETE","lineNumber":77,"oldContent":"      }"},{"type":"INSERT","lineNumber":75,"content":"        if (phoneNumber != null && phoneNumber.isNotEmpty) {"},{"type":"DELETE","lineNumber":79,"oldContent":"      "},{"type":"DELETE","lineNumber":81,"oldContent":"          // For now, we'll just store the phone number in the user's profile"},{"type":"INSERT","lineNumber":78,"content":"          // The phone number will be verified using OTP later"},{"type":"INSERT","lineNumber":79,"content":"          print('Phone number will be verified via OTP flow');"},{"type":"INSERT","lineNumber":80,"content":"          "},{"type":"INSERT","lineNumber":81,"content":"          // Note: We're not setting the phone number here as it requires verification"},{"type":"INSERT","lineNumber":82,"content":"          // The phone number will be set after successful OTP verification"},{"type":"INSERT","lineNumber":83,"content":"        }"},{"type":"INSERT","lineNumber":84,"content":"      }"},{"type":"INSERT","lineNumber":85,"content":"      "},{"type":"DELETE","lineNumber":83,"oldContent":"          try {"},{"type":"DELETE","lineNumber":85,"oldContent":"            // This is just for storage, not verification"},{"type":"DELETE","lineNumber":86,"oldContent":"            // The actual verification will be done via OTP"},{"type":"INSERT","lineNumber":88,"content":"      print('FirebaseAuthException during registration:');"},{"type":"INSERT","lineNumber":89,"content":"      print('Code: ${e.code}');"},{"type":"INSERT","lineNumber":90,"content":"      print('Message: ${e.message}');"},{"type":"INSERT","lineNumber":91,"content":"      print('Email: ${e.email}');"},{"type":"INSERT","lineNumber":92,"content":"      print('Credential: ${e.credential}');"},{"type":"INSERT","lineNumber":93,"content":"      "},{"type":"DELETE","lineNumber":88,"oldContent":"            await userCredential.user!.updatePhoneNumber(null);"},{"type":"DELETE","lineNumber":90,"oldContent":"            print('Phone number field initialized for future verification');"},{"type":"DELETE","lineNumber":91,"oldContent":"          } catch (phoneError) {"},{"type":"INSERT","lineNumber":96,"content":"        print('Attempting to clean up partially created user...');"},{"type":"DELETE","lineNumber":93,"oldContent":"            print('Error initializing phone number field: $phoneError');"},{"type":"DELETE","lineNumber":95,"oldContent":"            // Continue even if phone number initialization fails"},{"type":"DELETE","lineNumber":96,"oldContent":"          }"},{"type":"INSERT","lineNumber":99,"content":"          print('Successfully cleaned up partially created user');"},{"type":"INSERT","lineNumber":101,"content":"          print('Error during user cleanup: $deleteError');"},{"type":"INSERT","lineNumber":102,"content":"          // Continue with the original error"},{"type":"DELETE","lineNumber":100,"oldContent":"      print('FirebaseAuthException during registration:');"},{"type":"DELETE","lineNumber":102,"oldContent":"      print('Code: ${e.code}');"},{"type":"DELETE","lineNumber":103,"oldContent":"      print('Message: ${e.message}');"},{"type":"DELETE","lineNumber":104,"oldContent":"      print('Email: ${e.email}');"},{"type":"INSERT","lineNumber":106,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":107,"content":"      print('Unexpected error during registration:');"},{"type":"INSERT","lineNumber":108,"content":"      print('Error: $e');"},{"type":"INSERT","lineNumber":109,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":110,"content":"      "},{"type":"DELETE","lineNumber":106,"oldContent":"      print('Credential: ${e.credential}');"},{"type":"DELETE","lineNumber":108,"oldContent":"      "},{"type":"INSERT","lineNumber":113,"content":"        print('Attempting to clean up after unexpected error...');"},{"type":"DELETE","lineNumber":111,"oldContent":"        print('Attempting to clean up partially created user...');"},{"type":"DELETE","lineNumber":113,"oldContent":"          print('Successfully cleaned up partially created user');"},{"type":"INSERT","lineNumber":117,"content":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"DELETE","lineNumber":115,"oldContent":"          print('Error during user cleanup: $deleteError');"},{"type":"DELETE","lineNumber":117,"oldContent":"          // Continue with the original error"},{"type":"INSERT","lineNumber":121,"content":"    } finally {"},{"type":"INSERT","lineNumber":122,"content":"      print('Registration process completed');"},{"type":"DELETE","lineNumber":120,"oldContent":"    } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":122,"oldContent":"      print('Unexpected error during registration:');"},{"type":"DELETE","lineNumber":124,"oldContent":"      print('Error: $e');"},{"type":"DELETE","lineNumber":126,"oldContent":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":127,"content":"  Future<UserCredential> signInWithGoogle() async {"},{"type":"INSERT","lineNumber":128,"content":"    final googleUser = await _googleSignIn.signIn();"},{"type":"INSERT","lineNumber":129,"content":"    if (googleUser == null) {"},{"type":"INSERT","lineNumber":130,"content":"      throw Exception('Google Sign In was cancelled');"},{"type":"INSERT","lineNumber":131,"content":"    }"},{"type":"INSERT","lineNumber":132,"content":""},{"type":"INSERT","lineNumber":133,"content":"    final googleAuth = await googleUser.authentication;"},{"type":"INSERT","lineNumber":134,"content":"    final credential = GoogleAuthProvider.credential("},{"type":"INSERT","lineNumber":135,"content":"      accessToken: googleAuth.accessToken,"},{"type":"INSERT","lineNumber":136,"content":"      idToken: googleAuth.idToken,"},{"type":"INSERT","lineNumber":137,"content":"    );"},{"type":"INSERT","lineNumber":138,"content":""},{"type":"INSERT","lineNumber":139,"content":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":140,"content":"  }"},{"type":"INSERT","lineNumber":141,"content":""},{"type":"INSERT","lineNumber":142,"content":"  @override"},{"type":"DELETE","lineNumber":128,"oldContent":"      "},{"type":"DELETE","lineNumber":132,"oldContent":"        print('Attempting to clean up after unexpected error...');"},{"type":"DELETE","lineNumber":137,"oldContent":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"DELETE","lineNumber":142,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":144,"oldContent":"      print('Registration process completed');"},{"type":"DELETE","lineNumber":150,"oldContent":"  Future<UserCredential> signInWithGoogle() async {"},{"type":"DELETE","lineNumber":152,"oldContent":"    final googleUser = await _googleSignIn.signIn();"},{"type":"DELETE","lineNumber":154,"oldContent":"    if (googleUser == null) {"},{"type":"DELETE","lineNumber":156,"oldContent":"      throw Exception('Google Sign In was cancelled');"},{"type":"DELETE","lineNumber":158,"oldContent":"    }"},{"type":"DELETE","lineNumber":160,"oldContent":""},{"type":"DELETE","lineNumber":162,"oldContent":"    final googleAuth = await googleUser.authentication;"},{"type":"DELETE","lineNumber":164,"oldContent":"    final credential = GoogleAuthProvider.credential("},{"type":"DELETE","lineNumber":166,"oldContent":"      accessToken: googleAuth.accessToken,"},{"type":"DELETE","lineNumber":168,"oldContent":"      idToken: googleAuth.idToken,"},{"type":"DELETE","lineNumber":170,"oldContent":"    );"},{"type":"DELETE","lineNumber":172,"oldContent":""},{"type":"DELETE","lineNumber":174,"oldContent":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":176,"oldContent":"  }"},{"type":"DELETE","lineNumber":178,"oldContent":""},{"type":"DELETE","lineNumber":180,"oldContent":"  @override"}]},{"timestamp":1754593694929,"changes":[{"type":"MODIFY","lineNumber":51,"content":"    print('Starting Firebase user creation');","oldContent":"    print('Starting Firebase user creation for: $email');"},{"type":"INSERT","lineNumber":52,"content":"    print('Email: $email');"},{"type":"INSERT","lineNumber":53,"content":"    print('Display Name: $displayName');"},{"type":"INSERT","lineNumber":54,"content":"    print('Phone: $phoneNumber');"},{"type":"INSERT","lineNumber":55,"content":"    "},{"type":"INSERT","lineNumber":56,"content":"    // Validate required fields"},{"type":"INSERT","lineNumber":57,"content":"    if (email.isEmpty) {"},{"type":"INSERT","lineNumber":58,"content":"      throw FirebaseAuthException("},{"type":"INSERT","lineNumber":59,"content":"        code: 'invalid-email',"},{"type":"INSERT","lineNumber":60,"content":"        message: 'Email cannot be empty',"},{"type":"INSERT","lineNumber":61,"content":"      );"},{"type":"INSERT","lineNumber":62,"content":"    }"},{"type":"INSERT","lineNumber":63,"content":"    "},{"type":"INSERT","lineNumber":64,"content":"    if (password.isEmpty) {"},{"type":"INSERT","lineNumber":65,"content":"      throw FirebaseAuthException("},{"type":"INSERT","lineNumber":66,"content":"        code: 'weak-password',"},{"type":"INSERT","lineNumber":67,"content":"        message: 'Password cannot be empty',"},{"type":"INSERT","lineNumber":68,"content":"      );"},{"type":"INSERT","lineNumber":69,"content":"    }"},{"type":"INSERT","lineNumber":70,"content":"    "},{"type":"INSERT","lineNumber":73,"content":"      print('Creating user with email and password...');"},{"type":"DELETE","lineNumber":55,"oldContent":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"DELETE","lineNumber":56,"oldContent":"        email: email,"},{"type":"INSERT","lineNumber":75,"content":"        email: email.trim(),"},{"type":"DELETE","lineNumber":60,"oldContent":"      // Update the display name"},{"type":"DELETE","lineNumber":62,"oldContent":"      if (userCredential.user != null) {"},{"type":"INSERT","lineNumber":81,"content":"      // Update the display name"},{"type":"INSERT","lineNumber":82,"content":"      if (userCredential.user != null) {"},{"type":"DELETE","lineNumber":66,"oldContent":"          await userCredential.user!.updateDisplayName(displayName);"},{"type":"INSERT","lineNumber":85,"content":"          await userCredential.user!.updateDisplayName(displayName.trim());"},{"type":"DELETE","lineNumber":71,"oldContent":"        "},{"type":"DELETE","lineNumber":74,"oldContent":"        if (phoneNumber != null && phoneNumber.isNotEmpty) {"},{"type":"INSERT","lineNumber":92,"content":"        "},{"type":"DELETE","lineNumber":76,"oldContent":"          // The phone number will be verified using OTP later"},{"type":"INSERT","lineNumber":94,"content":"        if (phoneNumber != null && phoneNumber.trim().isNotEmpty) {"},{"type":"DELETE","lineNumber":78,"oldContent":"          print('Phone number will be verified via OTP flow');"},{"type":"DELETE","lineNumber":79,"oldContent":"          "},{"type":"DELETE","lineNumber":81,"oldContent":"          // Note: We're not setting the phone number here as it requires verification"},{"type":"DELETE","lineNumber":82,"oldContent":"          // The phone number will be set after successful OTP verification"},{"type":"DELETE","lineNumber":83,"oldContent":"      return userCredential;"},{"type":"INSERT","lineNumber":97,"content":"          // The phone number will be verified using OTP later"},{"type":"INSERT","lineNumber":98,"content":"          print('Phone number will be verified via OTP flow');"},{"type":"DELETE","lineNumber":86,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":88,"oldContent":"      // If there's an error, delete the created user to avoid partial registration"},{"type":"INSERT","lineNumber":102,"content":"      return userCredential;"},{"type":"INSERT","lineNumber":103,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":91,"oldContent":"      if (_firebaseAuth.currentUser != null) {"},{"type":"DELETE","lineNumber":95,"oldContent":"        try {"},{"type":"DELETE","lineNumber":97,"oldContent":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":110,"content":"      // If there's an error, delete the created user to avoid partial registration"},{"type":"INSERT","lineNumber":111,"content":"      if (_firebaseAuth.currentUser != null) {"},{"type":"INSERT","lineNumber":113,"content":"        try {"},{"type":"INSERT","lineNumber":114,"content":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":115,"content":"          print('Successfully cleaned up partially created user');"},{"type":"INSERT","lineNumber":117,"content":"          print('Error during user cleanup: $deleteError');"},{"type":"INSERT","lineNumber":118,"content":"          // Continue with the original error"},{"type":"DELETE","lineNumber":101,"oldContent":"          print('Successfully cleaned up partially created user');"},{"type":"DELETE","lineNumber":103,"oldContent":"          print('Error during user cleanup: $deleteError');"},{"type":"DELETE","lineNumber":105,"oldContent":"          // Continue with the original error"},{"type":"DELETE","lineNumber":106,"oldContent":"      // For any other type of error, clean up and rethrow"},{"type":"DELETE","lineNumber":109,"oldContent":"      if (_firebaseAuth.currentUser != null) {"},{"type":"DELETE","lineNumber":112,"oldContent":"        try {"},{"type":"INSERT","lineNumber":127,"content":"      // For any other type of error, clean up and rethrow"},{"type":"INSERT","lineNumber":128,"content":"      if (_firebaseAuth.currentUser != null) {"},{"type":"INSERT","lineNumber":129,"content":"        print('Attempting to clean up after unexpected error...');"},{"type":"INSERT","lineNumber":130,"content":"        try {"},{"type":"DELETE","lineNumber":116,"oldContent":"        print('Attempting to clean up after unexpected error...');"},{"type":"INSERT","lineNumber":133,"content":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"DELETE","lineNumber":119,"oldContent":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"DELETE","lineNumber":121,"oldContent":"    }"},{"type":"DELETE","lineNumber":123,"oldContent":"  }"},{"type":"INSERT","lineNumber":139,"content":"    }"},{"type":"INSERT","lineNumber":140,"content":"  }"},{"type":"DELETE","lineNumber":128,"oldContent":"  Future<UserCredential> signInWithApple() async {"},{"type":"DELETE","lineNumber":131,"oldContent":"    final appleCredential = await SignInWithApple.getAppleIDCredential("},{"type":"DELETE","lineNumber":133,"oldContent":"      scopes: ["},{"type":"DELETE","lineNumber":135,"oldContent":"        AppleIDAuthorizationScopes.email,"},{"type":"DELETE","lineNumber":138,"oldContent":"        AppleIDAuthorizationScopes.fullName,"},{"type":"DELETE","lineNumber":140,"oldContent":"      ],"},{"type":"DELETE","lineNumber":142,"oldContent":"    );"},{"type":"INSERT","lineNumber":153,"content":"    );"},{"type":"INSERT","lineNumber":155,"content":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":156,"content":"  }"},{"type":"INSERT","lineNumber":157,"content":""},{"type":"INSERT","lineNumber":158,"content":"  @override"},{"type":"INSERT","lineNumber":159,"content":"  Future<UserCredential> signInWithApple() async {"},{"type":"INSERT","lineNumber":160,"content":"    final appleCredential = await SignInWithApple.getAppleIDCredential("},{"type":"INSERT","lineNumber":161,"content":"      scopes: ["},{"type":"INSERT","lineNumber":162,"content":"        AppleIDAuthorizationScopes.email,"},{"type":"INSERT","lineNumber":163,"content":"        AppleIDAuthorizationScopes.fullName,"},{"type":"INSERT","lineNumber":164,"content":"      ],"},{"type":"DELETE","lineNumber":148,"oldContent":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":150,"oldContent":"  }"},{"type":"DELETE","lineNumber":152,"oldContent":""},{"type":"DELETE","lineNumber":154,"oldContent":"  @override"}]},{"timestamp":1754594479177,"changes":[{"type":"DELETE","lineNumber":53,"oldContent":"    try {"},{"type":"DELETE","lineNumber":55,"oldContent":"      // First create the user with email and password"},{"type":"DELETE","lineNumber":57,"oldContent":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"DELETE","lineNumber":61,"oldContent":"        password: password,"},{"type":"DELETE","lineNumber":63,"oldContent":"      );"},{"type":"DELETE","lineNumber":65,"oldContent":"      "},{"type":"DELETE","lineNumber":68,"oldContent":"      print('User created successfully: ${userCredential.user?.uid}');"},{"type":"DELETE","lineNumber":71,"oldContent":"      "},{"type":"DELETE","lineNumber":73,"oldContent":"        print('Updating display name to: $displayName');"},{"type":"DELETE","lineNumber":75,"oldContent":"        try {"},{"type":"DELETE","lineNumber":78,"oldContent":"          await userCredential.user!.reload();"},{"type":"DELETE","lineNumber":80,"oldContent":"          print('Display name updated successfully');"},{"type":"DELETE","lineNumber":82,"oldContent":"        } catch (updateError) {"},{"type":"INSERT","lineNumber":71,"content":"    try {"},{"type":"INSERT","lineNumber":72,"content":"      // First create the user with email and password"},{"type":"INSERT","lineNumber":73,"content":"      print('Creating user with email and password...');"},{"type":"INSERT","lineNumber":74,"content":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"INSERT","lineNumber":75,"content":"        email: email.trim(),"},{"type":"INSERT","lineNumber":76,"content":"        password: password,"},{"type":"INSERT","lineNumber":77,"content":"      );"},{"type":"INSERT","lineNumber":78,"content":"      "},{"type":"INSERT","lineNumber":79,"content":"      print('User created successfully: ${userCredential.user?.uid}');"},{"type":"INSERT","lineNumber":80,"content":"      "},{"type":"INSERT","lineNumber":81,"content":"      // Update the display name"},{"type":"INSERT","lineNumber":82,"content":"      if (userCredential.user != null) {"},{"type":"INSERT","lineNumber":83,"content":"        print('Updating display name to: $displayName');"},{"type":"INSERT","lineNumber":84,"content":"        try {"},{"type":"INSERT","lineNumber":85,"content":"          await userCredential.user!.updateDisplayName(displayName.trim());"},{"type":"INSERT","lineNumber":86,"content":"          await userCredential.user!.reload();"},{"type":"INSERT","lineNumber":87,"content":"          print('Display name updated successfully');"},{"type":"INSERT","lineNumber":88,"content":"        } catch (updateError) {"},{"type":"DELETE","lineNumber":86,"oldContent":"      print('Creating user with email and password...');"},{"type":"DELETE","lineNumber":88,"oldContent":"        email: email.trim(),"},{"type":"INSERT","lineNumber":92,"content":"        "},{"type":"INSERT","lineNumber":94,"content":"        if (phoneNumber != null && phoneNumber.trim().isNotEmpty) {"},{"type":"DELETE","lineNumber":92,"oldContent":"      // Update the display name"},{"type":"DELETE","lineNumber":93,"oldContent":"      if (userCredential.user != null) {"},{"type":"INSERT","lineNumber":97,"content":"          // The phone number will be verified using OTP later"},{"type":"INSERT","lineNumber":98,"content":"          print('Phone number will be verified via OTP flow');"},{"type":"DELETE","lineNumber":95,"oldContent":"          await userCredential.user!.updateDisplayName(displayName.trim());"},{"type":"INSERT","lineNumber":102,"content":"      return userCredential;"},{"type":"INSERT","lineNumber":103,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":100,"oldContent":"        "},{"type":"DELETE","lineNumber":103,"oldContent":"        if (phoneNumber != null && phoneNumber.trim().isNotEmpty) {"},{"type":"DELETE","lineNumber":106,"oldContent":"          // The phone number will be verified using OTP later"},{"type":"DELETE","lineNumber":107,"oldContent":"          print('Phone number will be verified via OTP flow');"},{"type":"INSERT","lineNumber":110,"content":"      // If there's an error, delete the created user to avoid partial registration"},{"type":"INSERT","lineNumber":111,"content":"      if (_firebaseAuth.currentUser != null) {"},{"type":"INSERT","lineNumber":113,"content":"        try {"},{"type":"INSERT","lineNumber":114,"content":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":115,"content":"          print('Successfully cleaned up partially created user');"},{"type":"INSERT","lineNumber":117,"content":"          print('Error during user cleanup: $deleteError');"},{"type":"INSERT","lineNumber":118,"content":"          // Continue with the original error"},{"type":"DELETE","lineNumber":111,"oldContent":"      return userCredential;"},{"type":"DELETE","lineNumber":113,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":117,"oldContent":"      // If there's an error, delete the created user to avoid partial registration"},{"type":"DELETE","lineNumber":119,"oldContent":"      if (_firebaseAuth.currentUser != null) {"},{"type":"DELETE","lineNumber":121,"oldContent":"        try {"},{"type":"INSERT","lineNumber":127,"content":"      // For any other type of error, clean up and rethrow"},{"type":"INSERT","lineNumber":128,"content":"      if (_firebaseAuth.currentUser != null) {"},{"type":"INSERT","lineNumber":129,"content":"        print('Attempting to clean up after unexpected error...');"},{"type":"INSERT","lineNumber":130,"content":"        try {"},{"type":"DELETE","lineNumber":124,"oldContent":"          await _firebaseAuth.currentUser!.delete();"},{"type":"DELETE","lineNumber":125,"oldContent":"          print('Successfully cleaned up partially created user');"},{"type":"DELETE","lineNumber":127,"oldContent":"          print('Error during user cleanup: $deleteError');"},{"type":"INSERT","lineNumber":133,"content":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"DELETE","lineNumber":129,"oldContent":"          // Continue with the original error"},{"type":"INSERT","lineNumber":139,"content":"    }"},{"type":"INSERT","lineNumber":140,"content":"  }"},{"type":"DELETE","lineNumber":136,"oldContent":"      // For any other type of error, clean up and rethrow"},{"type":"DELETE","lineNumber":138,"oldContent":"      if (_firebaseAuth.currentUser != null) {"},{"type":"DELETE","lineNumber":139,"oldContent":"        print('Attempting to clean up after unexpected error...');"},{"type":"DELETE","lineNumber":141,"oldContent":"        try {"},{"type":"DELETE","lineNumber":144,"oldContent":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"DELETE","lineNumber":148,"oldContent":"    }"},{"type":"DELETE","lineNumber":150,"oldContent":"  }"},{"type":"INSERT","lineNumber":153,"content":"    );"},{"type":"INSERT","lineNumber":155,"content":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":156,"content":"  }"},{"type":"INSERT","lineNumber":157,"content":""},{"type":"INSERT","lineNumber":158,"content":"  @override"},{"type":"INSERT","lineNumber":159,"content":"  Future<UserCredential> signInWithApple() async {"},{"type":"INSERT","lineNumber":160,"content":"    final appleCredential = await SignInWithApple.getAppleIDCredential("},{"type":"INSERT","lineNumber":161,"content":"      scopes: ["},{"type":"INSERT","lineNumber":162,"content":"        AppleIDAuthorizationScopes.email,"},{"type":"INSERT","lineNumber":163,"content":"        AppleIDAuthorizationScopes.fullName,"},{"type":"INSERT","lineNumber":164,"content":"      ],"},{"type":"DELETE","lineNumber":160,"oldContent":"    );"},{"type":"DELETE","lineNumber":161,"oldContent":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":163,"oldContent":"  }"},{"type":"DELETE","lineNumber":165,"oldContent":""},{"type":"INSERT","lineNumber":174,"content":""},{"type":"INSERT","lineNumber":176,"content":"  // Format phone number to E.164 standard (e.g., +14155552671)"},{"type":"INSERT","lineNumber":177,"content":"  String _formatPhoneNumber(String phoneNumber) {"},{"type":"INSERT","lineNumber":178,"content":"    // Remove all non-digit characters"},{"type":"INSERT","lineNumber":179,"content":"    String digits = phoneNumber.replaceAll(RegExp(r'[^0-9]'), '');"},{"type":"INSERT","lineNumber":180,"content":"    "},{"type":"INSERT","lineNumber":181,"content":"    // If the number starts with '0', replace with country code (e.g., '91' for India)"},{"type":"INSERT","lineNumber":182,"content":"    if (digits.startsWith('0')) {"},{"type":"INSERT","lineNumber":183,"content":"      digits = digits.substring(1);"},{"type":"INSERT","lineNumber":184,"content":"    }"},{"type":"INSERT","lineNumber":185,"content":"    "},{"type":"INSERT","lineNumber":186,"content":"    // If number doesn't start with '+', add the default country code (India +91)"},{"type":"INSERT","lineNumber":187,"content":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":188,"content":"      // Default to India (+91) if no country code is provided"},{"type":"INSERT","lineNumber":189,"content":"      digits = '91$digits';"},{"type":"INSERT","lineNumber":190,"content":"    }"},{"type":"INSERT","lineNumber":191,"content":"    "},{"type":"INSERT","lineNumber":192,"content":"    // Ensure the number starts with a '+' for E.164 format"},{"type":"INSERT","lineNumber":193,"content":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":194,"content":"      digits = '+$digits';"},{"type":"INSERT","lineNumber":195,"content":"    }"},{"type":"INSERT","lineNumber":196,"content":"    "},{"type":"INSERT","lineNumber":197,"content":"    return digits;"},{"type":"INSERT","lineNumber":198,"content":"  }"},{"type":"DELETE","lineNumber":169,"oldContent":"  Future<UserCredential> signInWithApple() async {"},{"type":"DELETE","lineNumber":171,"oldContent":"    final appleCredential = await SignInWithApple.getAppleIDCredential("},{"type":"DELETE","lineNumber":173,"oldContent":"      scopes: ["},{"type":"DELETE","lineNumber":175,"oldContent":"        AppleIDAuthorizationScopes.email,"},{"type":"DELETE","lineNumber":177,"oldContent":"        AppleIDAuthorizationScopes.fullName,"},{"type":"INSERT","lineNumber":204,"content":"    // Format the phone number to E.164 standard"},{"type":"INSERT","lineNumber":205,"content":"    final formattedPhoneNumber = _formatPhoneNumber(phoneNumber);"},{"type":"INSERT","lineNumber":206,"content":"    print('Formatted phone number for OTP: $formattedPhoneNumber');"},{"type":"INSERT","lineNumber":207,"content":"    "},{"type":"DELETE","lineNumber":179,"oldContent":"      ],"},{"type":"DELETE","lineNumber":180,"oldContent":"      phoneNumber: phoneNumber,"},{"type":"INSERT","lineNumber":209,"content":"      phoneNumber: formattedPhoneNumber,"}]},{"timestamp":1754594499632,"changes":[{"type":"INSERT","lineNumber":64,"content":"    if (password.isEmpty) {"},{"type":"INSERT","lineNumber":65,"content":"      throw FirebaseAuthException("},{"type":"INSERT","lineNumber":66,"content":"        code: 'weak-password',"},{"type":"INSERT","lineNumber":67,"content":"        message: 'Password cannot be empty',"},{"type":"INSERT","lineNumber":68,"content":"      );"},{"type":"INSERT","lineNumber":69,"content":"    }"},{"type":"INSERT","lineNumber":70,"content":"    "},{"type":"DELETE","lineNumber":66,"oldContent":"    if (password.isEmpty) {"},{"type":"DELETE","lineNumber":69,"oldContent":"      throw FirebaseAuthException("},{"type":"DELETE","lineNumber":72,"oldContent":"        code: 'weak-password',"},{"type":"DELETE","lineNumber":74,"oldContent":"        message: 'Password cannot be empty',"},{"type":"DELETE","lineNumber":77,"oldContent":"      );"},{"type":"DELETE","lineNumber":80,"oldContent":"    }"},{"type":"DELETE","lineNumber":83,"oldContent":"    "},{"type":"DELETE","lineNumber":85,"oldContent":"          print('Error updating display name: $updateError');"},{"type":"DELETE","lineNumber":87,"oldContent":"          // Continue even if display name update fails"},{"type":"DELETE","lineNumber":90,"oldContent":"        }"},{"type":"INSERT","lineNumber":89,"content":"          print('Error updating display name: $updateError');"},{"type":"INSERT","lineNumber":90,"content":"          // Continue even if display name update fails"},{"type":"INSERT","lineNumber":91,"content":"        }"},{"type":"INSERT","lineNumber":92,"content":"        "},{"type":"INSERT","lineNumber":94,"content":"        if (phoneNumber != null && phoneNumber.trim().isNotEmpty) {"},{"type":"DELETE","lineNumber":95,"oldContent":"        "},{"type":"DELETE","lineNumber":96,"oldContent":"        if (phoneNumber != null && phoneNumber.trim().isNotEmpty) {"},{"type":"INSERT","lineNumber":97,"content":"          // The phone number will be verified using OTP later"},{"type":"INSERT","lineNumber":98,"content":"          print('Phone number will be verified via OTP flow');"},{"type":"DELETE","lineNumber":99,"oldContent":"          // The phone number will be verified using OTP later"},{"type":"DELETE","lineNumber":101,"oldContent":"          print('Phone number will be verified via OTP flow');"},{"type":"INSERT","lineNumber":102,"content":"      return userCredential;"},{"type":"INSERT","lineNumber":103,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":105,"oldContent":"      return userCredential;"},{"type":"DELETE","lineNumber":107,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":110,"oldContent":"        print('Attempting to clean up partially created user...');"},{"type":"DELETE","lineNumber":111,"oldContent":"        } catch (deleteError) {"},{"type":"DELETE","lineNumber":113,"oldContent":"        }"},{"type":"DELETE","lineNumber":115,"oldContent":"      }"},{"type":"INSERT","lineNumber":112,"content":"        print('Attempting to clean up partially created user...');"},{"type":"DELETE","lineNumber":118,"oldContent":"      rethrow; // Re-throw the original error"},{"type":"DELETE","lineNumber":120,"oldContent":"    } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":121,"oldContent":"      print('Unexpected error during registration:');"},{"type":"INSERT","lineNumber":116,"content":"        } catch (deleteError) {"},{"type":"INSERT","lineNumber":119,"content":"        }"},{"type":"INSERT","lineNumber":120,"content":"      }"},{"type":"INSERT","lineNumber":121,"content":"      rethrow; // Re-throw the original error"},{"type":"INSERT","lineNumber":122,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":123,"content":"      print('Unexpected error during registration:');"},{"type":"DELETE","lineNumber":127,"oldContent":"          await _firebaseAuth.currentUser!.delete();"},{"type":"DELETE","lineNumber":128,"oldContent":"        } catch (deleteError) {"},{"type":"MODIFY","lineNumber":131,"content":"          await _firebaseAuth.currentUser!.delete();","oldContent":"        }"},{"type":"INSERT","lineNumber":132,"content":"        } catch (deleteError) {"},{"type":"INSERT","lineNumber":133,"content":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"INSERT","lineNumber":134,"content":"        }"},{"type":"DELETE","lineNumber":137,"oldContent":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"INSERT","lineNumber":139,"content":"    }"},{"type":"INSERT","lineNumber":140,"content":"  }"},{"type":"DELETE","lineNumber":142,"oldContent":"    }"},{"type":"DELETE","lineNumber":143,"oldContent":"  }"},{"type":"DELETE","lineNumber":155,"oldContent":"    );"},{"type":"DELETE","lineNumber":157,"oldContent":""},{"type":"DELETE","lineNumber":159,"oldContent":"    final oauthCredential = OAuthProvider('apple.com').credential("},{"type":"DELETE","lineNumber":161,"oldContent":"      idToken: appleCredential.identityToken,"},{"type":"DELETE","lineNumber":163,"oldContent":"      accessToken: appleCredential.authorizationCode,"},{"type":"DELETE","lineNumber":165,"oldContent":"    );"},{"type":"DELETE","lineNumber":169,"oldContent":""},{"type":"INSERT","lineNumber":165,"content":"    );"},{"type":"INSERT","lineNumber":166,"content":""},{"type":"INSERT","lineNumber":167,"content":"    final oauthCredential = OAuthProvider('apple.com').credential("},{"type":"INSERT","lineNumber":168,"content":"      idToken: appleCredential.identityToken,"},{"type":"INSERT","lineNumber":169,"content":"      accessToken: appleCredential.authorizationCode,"},{"type":"INSERT","lineNumber":170,"content":"    );"},{"type":"INSERT","lineNumber":171,"content":""},{"type":"DELETE","lineNumber":174,"oldContent":"  @override"},{"type":"DELETE","lineNumber":177,"oldContent":"  Future<String> sendOtpToPhoneNumber({required String phoneNumber}) async {"},{"type":"DELETE","lineNumber":178,"oldContent":""},{"type":"DELETE","lineNumber":179,"oldContent":"    final completer = Completer<String>();"},{"type":"DELETE","lineNumber":181,"oldContent":"    "},{"type":"DELETE","lineNumber":184,"oldContent":"    await _firebaseAuth.verifyPhoneNumber("},{"type":"DELETE","lineNumber":188,"oldContent":"      verificationCompleted: (PhoneAuthCredential credential) {"},{"type":"DELETE","lineNumber":190,"oldContent":"        // Auto-verification completed"},{"type":"DELETE","lineNumber":192,"oldContent":"        _firebaseAuth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":194,"oldContent":"      },"},{"type":"DELETE","lineNumber":196,"oldContent":"      verificationFailed: (FirebaseAuthException e) {"},{"type":"DELETE","lineNumber":198,"oldContent":"        completer.completeError(e);"},{"type":"DELETE","lineNumber":200,"oldContent":"      },"},{"type":"DELETE","lineNumber":202,"oldContent":"      codeSent: (String verificationId, int? resendToken) {"},{"type":"DELETE","lineNumber":204,"oldContent":"        completer.complete(verificationId);"},{"type":"DELETE","lineNumber":206,"oldContent":"      },"},{"type":"DELETE","lineNumber":208,"oldContent":"      codeAutoRetrievalTimeout: (String verificationId) {"},{"type":"DELETE","lineNumber":210,"oldContent":"        // Auto-resolution timed out..."},{"type":"DELETE","lineNumber":212,"oldContent":"      },"},{"type":"DELETE","lineNumber":214,"oldContent":"    );"},{"type":"INSERT","lineNumber":197,"content":"    return digits;"},{"type":"INSERT","lineNumber":198,"content":"  }"},{"type":"INSERT","lineNumber":199,"content":""},{"type":"INSERT","lineNumber":200,"content":"  @override"},{"type":"INSERT","lineNumber":201,"content":"  Future<String> sendOtpToPhoneNumber({required String phoneNumber}) async {"},{"type":"INSERT","lineNumber":202,"content":"    final completer = Completer<String>();"},{"type":"INSERT","lineNumber":204,"content":"    try {"},{"type":"INSERT","lineNumber":205,"content":"      // Validate phone number is not empty"},{"type":"INSERT","lineNumber":206,"content":"      if (phoneNumber.trim().isEmpty) {"},{"type":"INSERT","lineNumber":207,"content":"        throw FirebaseAuthException("},{"type":"INSERT","lineNumber":208,"content":"          code: 'invalid-phone-number',"},{"type":"INSERT","lineNumber":209,"content":"          message: 'Phone number cannot be empty',"},{"type":"INSERT","lineNumber":210,"content":"        );"},{"type":"INSERT","lineNumber":211,"content":"      }"},{"type":"INSERT","lineNumber":212,"content":"      "},{"type":"INSERT","lineNumber":213,"content":"      // Format the phone number to E.164 standard"},{"type":"INSERT","lineNumber":214,"content":"      final formattedPhoneNumber = _formatPhoneNumber(phoneNumber);"},{"type":"INSERT","lineNumber":215,"content":"      print('Formatted phone number for OTP: $formattedPhoneNumber');"},{"type":"INSERT","lineNumber":216,"content":"      "},{"type":"INSERT","lineNumber":217,"content":"      // Additional validation for the formatted number"},{"type":"INSERT","lineNumber":218,"content":"      if (formattedPhoneNumber.length < 12) { // +91 + 10 digits"},{"type":"INSERT","lineNumber":219,"content":"        throw FirebaseAuthException("},{"type":"INSERT","lineNumber":220,"content":"          code: 'invalid-phone-number',"},{"type":"INSERT","lineNumber":221,"content":"          message: 'Phone number is too short',"},{"type":"INSERT","lineNumber":222,"content":"        );"},{"type":"INSERT","lineNumber":223,"content":"      }"},{"type":"INSERT","lineNumber":224,"content":"      "},{"type":"INSERT","lineNumber":225,"content":"      await _firebaseAuth.verifyPhoneNumber("},{"type":"INSERT","lineNumber":226,"content":"        phoneNumber: formattedPhoneNumber,"},{"type":"INSERT","lineNumber":227,"content":"        verificationCompleted: (PhoneAuthCredential credential) {"},{"type":"INSERT","lineNumber":228,"content":"          // Auto-verification completed"},{"type":"INSERT","lineNumber":229,"content":"          _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":230,"content":"        },"},{"type":"INSERT","lineNumber":231,"content":"        verificationFailed: (FirebaseAuthException e) {"},{"type":"INSERT","lineNumber":232,"content":"          print('Phone verification failed: ${e.code} - ${e.message}');"},{"type":"INSERT","lineNumber":233,"content":"          "},{"type":"INSERT","lineNumber":234,"content":"          // Map Firebase error codes to more user-friendly messages"},{"type":"INSERT","lineNumber":235,"content":"          String errorMessage = 'Failed to verify phone number';"},{"type":"INSERT","lineNumber":236,"content":"          switch (e.code) {"},{"type":"INSERT","lineNumber":237,"content":"            case 'invalid-phone-number':"},{"type":"INSERT","lineNumber":238,"content":"              errorMessage = 'The provided phone number is not valid';"},{"type":"INSERT","lineNumber":239,"content":"              break;"},{"type":"INSERT","lineNumber":240,"content":"            case 'too-many-requests':"},{"type":"INSERT","lineNumber":241,"content":"              errorMessage = 'Too many requests. Please try again later.';"},{"type":"INSERT","lineNumber":242,"content":"              break;"},{"type":"INSERT","lineNumber":243,"content":"            case 'quota-exceeded':"},{"type":"INSERT","lineNumber":244,"content":"              errorMessage = 'Quota exceeded. Please try again later.';"},{"type":"INSERT","lineNumber":245,"content":"              break;"},{"type":"INSERT","lineNumber":246,"content":"            default:"},{"type":"INSERT","lineNumber":247,"content":"              errorMessage = 'Failed to verify phone number: ${e.message}';"},{"type":"INSERT","lineNumber":248,"content":"          }"},{"type":"INSERT","lineNumber":249,"content":"          "},{"type":"INSERT","lineNumber":250,"content":"          completer.completeError(FirebaseAuthException("},{"type":"INSERT","lineNumber":251,"content":"            code: e.code,"},{"type":"INSERT","lineNumber":252,"content":"            message: errorMessage,"},{"type":"INSERT","lineNumber":253,"content":"          ));"},{"type":"INSERT","lineNumber":254,"content":"        },"},{"type":"INSERT","lineNumber":255,"content":"        codeSent: (String verificationId, int? resendToken) {"},{"type":"INSERT","lineNumber":256,"content":"          completer.complete(verificationId);"},{"type":"INSERT","lineNumber":257,"content":"        },"},{"type":"INSERT","lineNumber":258,"content":"        codeAutoRetrievalTimeout: (String verificationId) {"},{"type":"INSERT","lineNumber":259,"content":"          // Auto-resolution timed out..."},{"type":"INSERT","lineNumber":260,"content":"          // You can choose to handle this case if needed"},{"type":"INSERT","lineNumber":261,"content":"          print('Auto resolution timed out for verification ID: $verificationId');"},{"type":"INSERT","lineNumber":262,"content":"        },"},{"type":"INSERT","lineNumber":263,"content":"      );"},{"type":"INSERT","lineNumber":264,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":265,"content":"      // Handle any unexpected errors"},{"type":"INSERT","lineNumber":266,"content":"      print('Unexpected error in sendOtpToPhoneNumber: $e');"},{"type":"INSERT","lineNumber":267,"content":"      if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":268,"content":"        if (e is FirebaseAuthException) {"},{"type":"INSERT","lineNumber":269,"content":"          completer.completeError(e);"},{"type":"INSERT","lineNumber":270,"content":"        } else {"},{"type":"INSERT","lineNumber":271,"content":"          completer.completeError(FirebaseAuthException("},{"type":"INSERT","lineNumber":272,"content":"            code: 'unknown-error',"},{"type":"INSERT","lineNumber":273,"content":"            message: 'An unexpected error occurred. Please try again.',"},{"type":"INSERT","lineNumber":274,"content":"          ));"},{"type":"INSERT","lineNumber":275,"content":"        }"},{"type":"INSERT","lineNumber":276,"content":"      }"},{"type":"INSERT","lineNumber":277,"content":"    }"},{"type":"INSERT","lineNumber":278,"content":"    "},{"type":"DELETE","lineNumber":219,"oldContent":"    return digits;"},{"type":"DELETE","lineNumber":221,"oldContent":"  }"},{"type":"DELETE","lineNumber":228,"oldContent":"    // Format the phone number to E.164 standard"},{"type":"DELETE","lineNumber":230,"oldContent":"    final formattedPhoneNumber = _formatPhoneNumber(phoneNumber);"},{"type":"DELETE","lineNumber":232,"oldContent":"    print('Formatted phone number for OTP: $formattedPhoneNumber');"},{"type":"DELETE","lineNumber":234,"oldContent":"    "},{"type":"DELETE","lineNumber":237,"oldContent":"      phoneNumber: formattedPhoneNumber,"}]},{"timestamp":1754610085423,"changes":[{"type":"DELETE","lineNumber":65,"oldContent":"    try {"},{"type":"DELETE","lineNumber":67,"oldContent":"      // First create the user with email and password"},{"type":"DELETE","lineNumber":70,"oldContent":"      print('Creating user with email and password...');"},{"type":"DELETE","lineNumber":72,"oldContent":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"INSERT","lineNumber":71,"content":"    try {"},{"type":"INSERT","lineNumber":72,"content":"      // First create the user with email and password"},{"type":"INSERT","lineNumber":73,"content":"      print('Creating user with email and password...');"},{"type":"INSERT","lineNumber":74,"content":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"DELETE","lineNumber":87,"oldContent":"          print('Error updating display name: $updateError');"},{"type":"INSERT","lineNumber":88,"content":"        } catch (updateError) {"},{"type":"INSERT","lineNumber":89,"content":"          print('Error updating display name: $updateError');"},{"type":"DELETE","lineNumber":91,"oldContent":"        } catch (updateError) {"},{"type":"MODIFY","lineNumber":95,"content":"          print('Phone number provided: $phoneNumber');","oldContent":"          print('Phone number provided: $phoneNumber');"},{"type":"MODIFY","lineNumber":99,"content":"        }","oldContent":"        }"},{"type":"MODIFY","lineNumber":104,"content":"      print('FirebaseAuthException during registration:');","oldContent":"      print('FirebaseAuthException during registration:');"},{"type":"DELETE","lineNumber":110,"oldContent":"        print('Attempting to clean up partially created user...');"},{"type":"DELETE","lineNumber":113,"oldContent":"        } catch (deleteError) {"},{"type":"INSERT","lineNumber":112,"content":"        print('Attempting to clean up partially created user...');"},{"type":"MODIFY","lineNumber":116,"content":"        } catch (deleteError) {","oldContent":"        }"},{"type":"INSERT","lineNumber":117,"content":"          print('Error during user cleanup: $deleteError');"},{"type":"INSERT","lineNumber":118,"content":"          // Continue with the original error"},{"type":"INSERT","lineNumber":119,"content":"        }"},{"type":"DELETE","lineNumber":121,"oldContent":"          print('Error during user cleanup: $deleteError');"},{"type":"DELETE","lineNumber":123,"oldContent":"          // Continue with the original error"},{"type":"INSERT","lineNumber":129,"content":"        print('Attempting to clean up after unexpected error...');"},{"type":"INSERT","lineNumber":130,"content":"        try {"},{"type":"DELETE","lineNumber":131,"oldContent":"        print('Attempting to clean up after unexpected error...');"},{"type":"DELETE","lineNumber":133,"oldContent":"        try {"},{"type":"MODIFY","lineNumber":141,"content":"","oldContent":""},{"type":"INSERT","lineNumber":160,"content":"    final appleCredential = await SignInWithApple.getAppleIDCredential("},{"type":"INSERT","lineNumber":161,"content":"      scopes: ["},{"type":"INSERT","lineNumber":162,"content":"        AppleIDAuthorizationScopes.email,"},{"type":"INSERT","lineNumber":163,"content":"        AppleIDAuthorizationScopes.fullName,"},{"type":"INSERT","lineNumber":164,"content":"      ],"},{"type":"DELETE","lineNumber":162,"oldContent":"    final appleCredential = await SignInWithApple.getAppleIDCredential("},{"type":"DELETE","lineNumber":164,"oldContent":"      scopes: ["},{"type":"DELETE","lineNumber":166,"oldContent":"        AppleIDAuthorizationScopes.email,"},{"type":"DELETE","lineNumber":169,"oldContent":"        AppleIDAuthorizationScopes.fullName,"},{"type":"DELETE","lineNumber":171,"oldContent":"      ],"},{"type":"DELETE","lineNumber":186,"oldContent":"    return digits;"},{"type":"INSERT","lineNumber":187,"content":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":188,"content":"      // Default to India (+91) if no country code is provided"},{"type":"INSERT","lineNumber":189,"content":"      digits = '91$digits';"},{"type":"INSERT","lineNumber":190,"content":"    }"},{"type":"INSERT","lineNumber":191,"content":"    "},{"type":"INSERT","lineNumber":192,"content":"    // Ensure the number starts with a '+' for E.164 format"},{"type":"INSERT","lineNumber":193,"content":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":194,"content":"      digits = '+$digits';"},{"type":"INSERT","lineNumber":195,"content":"    }"},{"type":"INSERT","lineNumber":196,"content":"    "},{"type":"INSERT","lineNumber":197,"content":"    return digits;"},{"type":"DELETE","lineNumber":190,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":193,"oldContent":"      // Default to India (+91) if no country code is provided"},{"type":"DELETE","lineNumber":195,"oldContent":"      digits = '91$digits';"},{"type":"INSERT","lineNumber":203,"content":"    "},{"type":"DELETE","lineNumber":198,"oldContent":"    }"},{"type":"DELETE","lineNumber":201,"oldContent":"    "},{"type":"DELETE","lineNumber":204,"oldContent":"    // Ensure the number starts with a '+' for E.164 format"},{"type":"DELETE","lineNumber":207,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":210,"oldContent":"      digits = '+$digits';"},{"type":"DELETE","lineNumber":213,"oldContent":"    }"},{"type":"DELETE","lineNumber":215,"oldContent":"    "},{"type":"DELETE","lineNumber":217,"oldContent":"    "},{"type":"DELETE","lineNumber":219,"oldContent":"    return completer.future;"},{"type":"DELETE","lineNumber":222,"oldContent":"  }"},{"type":"DELETE","lineNumber":225,"oldContent":""},{"type":"DELETE","lineNumber":227,"oldContent":"  @override"},{"type":"DELETE","lineNumber":229,"oldContent":"  Future<UserCredential> verifyOtp({"},{"type":"INSERT","lineNumber":225,"content":"      // Set a timeout for the verification process"},{"type":"INSERT","lineNumber":226,"content":"      final timeout = Timer(const Duration(seconds: 60), () {"},{"type":"INSERT","lineNumber":227,"content":"        if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":228,"content":"          completer.completeError("},{"type":"INSERT","lineNumber":229,"content":"            FirebaseAuthException("},{"type":"INSERT","lineNumber":230,"content":"              code: 'timeout',"},{"type":"INSERT","lineNumber":231,"content":"              message: 'Verification code request timed out. Please try again.',"},{"type":"INSERT","lineNumber":232,"content":"            ),"},{"type":"INSERT","lineNumber":233,"content":"          );"},{"type":"INSERT","lineNumber":234,"content":"        }"},{"type":"INSERT","lineNumber":235,"content":"      });"},{"type":"INSERT","lineNumber":236,"content":"      "},{"type":"DELETE","lineNumber":231,"oldContent":"    required String verificationId,"},{"type":"DELETE","lineNumber":233,"oldContent":"    required String smsCode,"},{"type":"DELETE","lineNumber":234,"oldContent":"        verificationCompleted: (PhoneAuthCredential credential) {"},{"type":"DELETE","lineNumber":235,"oldContent":"  }) async {"},{"type":"DELETE","lineNumber":236,"oldContent":"          // Auto-verification completed"},{"type":"DELETE","lineNumber":237,"oldContent":"          _firebaseAuth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":238,"oldContent":"    final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":239,"content":"        timeout: const Duration(seconds: 60),"},{"type":"INSERT","lineNumber":240,"content":"        verificationCompleted: (PhoneAuthCredential credential) async {"},{"type":"INSERT","lineNumber":241,"content":"          print('Auto-verification completed');"},{"type":"INSERT","lineNumber":242,"content":"          // Auto-verification completed on some devices"},{"type":"INSERT","lineNumber":243,"content":"          if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":244,"content":"            // Sign in with the credential"},{"type":"INSERT","lineNumber":245,"content":"            try {"},{"type":"INSERT","lineNumber":246,"content":"              final userCredential = await _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":247,"content":"              print('Auto sign in successful: ${userCredential.user?.uid}');"},{"type":"INSERT","lineNumber":248,"content":"              // If auto-verification happens, we still need to complete with the verification ID"},{"type":"INSERT","lineNumber":249,"content":"              // But we don't have it here, so we'll complete with an empty string"},{"type":"INSERT","lineNumber":250,"content":"              // The verificationCompleted callback is only called on some devices"},{"type":"INSERT","lineNumber":251,"content":"              completer.complete('auto-verified');"},{"type":"INSERT","lineNumber":252,"content":"            } catch (e) {"},{"type":"INSERT","lineNumber":253,"content":"              print('Error during auto sign in: $e');"},{"type":"INSERT","lineNumber":254,"content":"              if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":255,"content":"                completer.completeError("},{"type":"INSERT","lineNumber":256,"content":"                  FirebaseAuthException("},{"type":"INSERT","lineNumber":257,"content":"                    code: 'auto-verify-failed',"},{"type":"INSERT","lineNumber":258,"content":"                    message: 'Failed to sign in automatically. Please try again.',"},{"type":"INSERT","lineNumber":259,"content":"                  ),"},{"type":"INSERT","lineNumber":260,"content":"                );"},{"type":"INSERT","lineNumber":261,"content":"              }"},{"type":"INSERT","lineNumber":262,"content":"            }"},{"type":"INSERT","lineNumber":263,"content":"          }"},{"type":"INSERT","lineNumber":264,"content":"          timeout.cancel();"},{"type":"DELETE","lineNumber":241,"oldContent":"      verificationId: verificationId,"},{"type":"DELETE","lineNumber":244,"oldContent":"      smsCode: smsCode,"},{"type":"DELETE","lineNumber":247,"oldContent":"    );"},{"type":"DELETE","lineNumber":249,"oldContent":"    "},{"type":"DELETE","lineNumber":252,"oldContent":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":254,"oldContent":"  }"},{"type":"DELETE","lineNumber":256,"oldContent":""},{"type":"DELETE","lineNumber":258,"oldContent":"  @override"},{"type":"DELETE","lineNumber":260,"oldContent":"  Future<void> signOut() async {"},{"type":"DELETE","lineNumber":262,"oldContent":"    await Future.wait(["},{"type":"DELETE","lineNumber":264,"oldContent":"      _firebaseAuth.signOut(),"},{"type":"DELETE","lineNumber":266,"oldContent":"      _googleSignIn.signOut(),"},{"type":"INSERT","lineNumber":281,"content":"            case 'invalid-verification-code':"},{"type":"INSERT","lineNumber":282,"content":"              errorMessage = 'Invalid verification code';"},{"type":"INSERT","lineNumber":283,"content":"              break;"},{"type":"INSERT","lineNumber":284,"content":"            case 'session-expired':"},{"type":"INSERT","lineNumber":285,"content":"              errorMessage = 'The SMS code has expired. Please request a new one.';"},{"type":"INSERT","lineNumber":286,"content":"              break;"},{"type":"DELETE","lineNumber":268,"oldContent":"    ]);"},{"type":"DELETE","lineNumber":270,"oldContent":"  }"},{"type":"DELETE","lineNumber":272,"oldContent":""},{"type":"INSERT","lineNumber":291,"content":"          if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":292,"content":"            completer.completeError("},{"type":"INSERT","lineNumber":293,"content":"              FirebaseAuthException("},{"type":"INSERT","lineNumber":294,"content":"                code: e.code,"},{"type":"INSERT","lineNumber":295,"content":"                message: errorMessage,"},{"type":"INSERT","lineNumber":296,"content":"              ),"},{"type":"INSERT","lineNumber":297,"content":"            );"},{"type":"INSERT","lineNumber":298,"content":"          }"},{"type":"INSERT","lineNumber":299,"content":"          timeout.cancel();"},{"type":"INSERT","lineNumber":300,"content":"        },"},{"type":"INSERT","lineNumber":301,"content":"        codeSent: (String verificationId, int? resendToken) {"},{"type":"INSERT","lineNumber":302,"content":"          print('SMS code sent. Verification ID: $verificationId');"},{"type":"INSERT","lineNumber":303,"content":"          if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":304,"content":"            completer.complete(verificationId);"},{"type":"INSERT","lineNumber":305,"content":"          }"},{"type":"INSERT","lineNumber":306,"content":"          timeout.cancel();"},{"type":"INSERT","lineNumber":307,"content":"        },"},{"type":"INSERT","lineNumber":308,"content":"        codeAutoRetrievalTimeout: (String verificationId) {"},{"type":"INSERT","lineNumber":309,"content":"          print('Auto resolution timed out for verification ID: $verificationId');"},{"type":"INSERT","lineNumber":310,"content":"          // On some devices, auto-retrieval may time out"},{"type":"INSERT","lineNumber":311,"content":"          // We'll still complete with the verification ID as the user can enter it manually"},{"type":"INSERT","lineNumber":312,"content":"          if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":313,"content":"            completer.complete(verificationId);"},{"type":"INSERT","lineNumber":314,"content":"          }"},{"type":"INSERT","lineNumber":315,"content":"          timeout.cancel();"},{"type":"INSERT","lineNumber":316,"content":"        },"},{"type":"INSERT","lineNumber":317,"content":"      );"},{"type":"INSERT","lineNumber":318,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":319,"content":"      // Handle any unexpected errors"},{"type":"INSERT","lineNumber":320,"content":"      print('Unexpected error in sendOtpToPhoneNumber:');"},{"type":"INSERT","lineNumber":321,"content":"      print('Error: $e');"},{"type":"INSERT","lineNumber":322,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":323,"content":"      "},{"type":"INSERT","lineNumber":324,"content":"      if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":325,"content":"        if (e is FirebaseAuthException) {"},{"type":"INSERT","lineNumber":326,"content":"          completer.completeError(e);"},{"type":"INSERT","lineNumber":327,"content":"        } else {"},{"type":"INSERT","lineNumber":328,"content":"          completer.completeError("},{"type":"INSERT","lineNumber":329,"content":"            FirebaseAuthException("},{"type":"INSERT","lineNumber":330,"content":"              code: 'unknown-error',"},{"type":"INSERT","lineNumber":331,"content":"              message: 'An unexpected error occurred. Please try again.',"},{"type":"INSERT","lineNumber":332,"content":"            ),"},{"type":"INSERT","lineNumber":333,"content":"          );"},{"type":"INSERT","lineNumber":334,"content":"        }"},{"type":"INSERT","lineNumber":335,"content":"      }"},{"type":"INSERT","lineNumber":336,"content":"    }"},{"type":"INSERT","lineNumber":337,"content":"    "},{"type":"INSERT","lineNumber":338,"content":"    return completer.future;"},{"type":"INSERT","lineNumber":339,"content":"  }"},{"type":"INSERT","lineNumber":340,"content":""},{"type":"DELETE","lineNumber":275,"oldContent":"          completer.completeError(FirebaseAuthException("},{"type":"INSERT","lineNumber":342,"content":"  Future<UserCredential> verifyOtp({"},{"type":"INSERT","lineNumber":343,"content":"    required String verificationId,"},{"type":"INSERT","lineNumber":344,"content":"    required String smsCode,"},{"type":"INSERT","lineNumber":345,"content":"  }) async {"},{"type":"INSERT","lineNumber":346,"content":"    final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":347,"content":"      verificationId: verificationId,"},{"type":"INSERT","lineNumber":348,"content":"      smsCode: smsCode,"},{"type":"INSERT","lineNumber":349,"content":"    );"},{"type":"INSERT","lineNumber":350,"content":"    "},{"type":"INSERT","lineNumber":351,"content":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":352,"content":"  }"},{"type":"INSERT","lineNumber":353,"content":""},{"type":"INSERT","lineNumber":354,"content":"  @override"},{"type":"INSERT","lineNumber":355,"content":"  Future<void> signOut() async {"},{"type":"INSERT","lineNumber":356,"content":"    await Future.wait(["},{"type":"INSERT","lineNumber":357,"content":"      _firebaseAuth.signOut(),"},{"type":"INSERT","lineNumber":358,"content":"      _googleSignIn.signOut(),"},{"type":"INSERT","lineNumber":359,"content":"    ]);"},{"type":"INSERT","lineNumber":360,"content":"  }"},{"type":"INSERT","lineNumber":361,"content":""},{"type":"INSERT","lineNumber":362,"content":"  @override"},{"type":"DELETE","lineNumber":277,"oldContent":"            code: e.code,"},{"type":"DELETE","lineNumber":279,"oldContent":"            message: errorMessage,"},{"type":"DELETE","lineNumber":281,"oldContent":"          ));"},{"type":"DELETE","lineNumber":283,"oldContent":"        },"},{"type":"DELETE","lineNumber":285,"oldContent":"        codeSent: (String verificationId, int? resendToken) {"},{"type":"DELETE","lineNumber":287,"oldContent":"          completer.complete(verificationId);"},{"type":"DELETE","lineNumber":289,"oldContent":"        },"},{"type":"DELETE","lineNumber":291,"oldContent":"        codeAutoRetrievalTimeout: (String verificationId) {"},{"type":"DELETE","lineNumber":293,"oldContent":"          // Auto-resolution timed out..."},{"type":"DELETE","lineNumber":295,"oldContent":"          // You can choose to handle this case if needed"},{"type":"DELETE","lineNumber":297,"oldContent":"          print('Auto resolution timed out for verification ID: $verificationId');"},{"type":"DELETE","lineNumber":299,"oldContent":"        },"},{"type":"DELETE","lineNumber":301,"oldContent":"      );"},{"type":"DELETE","lineNumber":303,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":305,"oldContent":"      // Handle any unexpected errors"},{"type":"DELETE","lineNumber":307,"oldContent":"      print('Unexpected error in sendOtpToPhoneNumber: $e');"},{"type":"DELETE","lineNumber":309,"oldContent":"      if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":311,"oldContent":"        if (e is FirebaseAuthException) {"},{"type":"DELETE","lineNumber":313,"oldContent":"          completer.completeError(e);"},{"type":"DELETE","lineNumber":315,"oldContent":"        } else {"},{"type":"DELETE","lineNumber":317,"oldContent":"          completer.completeError(FirebaseAuthException("},{"type":"DELETE","lineNumber":319,"oldContent":"            code: 'unknown-error',"},{"type":"DELETE","lineNumber":321,"oldContent":"            message: 'An unexpected error occurred. Please try again.',"},{"type":"DELETE","lineNumber":323,"oldContent":"          ));"},{"type":"DELETE","lineNumber":325,"oldContent":"        }"},{"type":"DELETE","lineNumber":327,"oldContent":"      }"},{"type":"DELETE","lineNumber":329,"oldContent":"    }"},{"type":"DELETE","lineNumber":331,"oldContent":"    "}]},{"timestamp":1754617126132,"changes":[{"type":"DELETE","lineNumber":68,"oldContent":"    try {"},{"type":"INSERT","lineNumber":69,"content":"    }"},{"type":"INSERT","lineNumber":70,"content":"    "},{"type":"INSERT","lineNumber":71,"content":"    if (displayName.isEmpty) {"},{"type":"INSERT","lineNumber":72,"content":"      throw FirebaseAuthException("},{"type":"INSERT","lineNumber":73,"content":"        code: 'invalid-argument',"},{"type":"INSERT","lineNumber":74,"content":"        message: 'Display name cannot be empty',"},{"type":"INSERT","lineNumber":75,"content":"      );"},{"type":"INSERT","lineNumber":76,"content":"    }"},{"type":"INSERT","lineNumber":77,"content":"    "},{"type":"INSERT","lineNumber":78,"content":"    try {"},{"type":"DELETE","lineNumber":72,"oldContent":"    }"},{"type":"DELETE","lineNumber":74,"oldContent":"    "},{"type":"INSERT","lineNumber":88,"content":"      if (userCredential.user == null) {"},{"type":"INSERT","lineNumber":89,"content":"        throw FirebaseAuthException("},{"type":"INSERT","lineNumber":90,"content":"          code: 'user-creation-failed',"},{"type":"INSERT","lineNumber":91,"content":"          message: 'Failed to create user',"},{"type":"INSERT","lineNumber":92,"content":"        );"},{"type":"INSERT","lineNumber":93,"content":"      }"},{"type":"INSERT","lineNumber":94,"content":"      "},{"type":"INSERT","lineNumber":95,"content":"      final user = userCredential.user!;"},{"type":"INSERT","lineNumber":96,"content":"      "},{"type":"DELETE","lineNumber":82,"oldContent":"      if (userCredential.user != null) {"},{"type":"DELETE","lineNumber":83,"oldContent":"        print('Updating display name to: $displayName');"},{"type":"DELETE","lineNumber":84,"oldContent":"        try {"},{"type":"DELETE","lineNumber":85,"oldContent":"          await userCredential.user!.updateDisplayName(displayName.trim());"},{"type":"DELETE","lineNumber":86,"oldContent":"          await userCredential.user!.reload();"},{"type":"DELETE","lineNumber":87,"oldContent":"        } catch (updateError) {"},{"type":"DELETE","lineNumber":88,"oldContent":"          print('Display name updated successfully');"},{"type":"DELETE","lineNumber":89,"oldContent":"          print('Error updating display name: $updateError');"},{"type":"DELETE","lineNumber":90,"oldContent":"          // Continue even if display name update fails"},{"type":"DELETE","lineNumber":91,"oldContent":"        }"},{"type":"DELETE","lineNumber":92,"oldContent":"        "},{"type":"DELETE","lineNumber":93,"oldContent":"        // Handle phone number if provided"},{"type":"DELETE","lineNumber":94,"oldContent":"          print('Phone number provided: $phoneNumber');"},{"type":"DELETE","lineNumber":95,"oldContent":"          print('Phone number provided: $phoneNumber');"},{"type":"DELETE","lineNumber":96,"oldContent":"          // We'll handle phone verification in a separate step after registration"},{"type":"DELETE","lineNumber":97,"oldContent":"          // The phone number will be verified using OTP later"},{"type":"DELETE","lineNumber":98,"oldContent":"        }"},{"type":"DELETE","lineNumber":99,"oldContent":"        }"},{"type":"INSERT","lineNumber":98,"content":"      print('Updating display name to: $displayName');"},{"type":"INSERT","lineNumber":99,"content":"      try {"},{"type":"INSERT","lineNumber":100,"content":"        await user.updateDisplayName(displayName.trim());"},{"type":"INSERT","lineNumber":101,"content":"        await user.reload();"},{"type":"INSERT","lineNumber":102,"content":"        print('Display name updated successfully');"},{"type":"INSERT","lineNumber":103,"content":"      } catch (updateError) {"},{"type":"INSERT","lineNumber":104,"content":"        print('Error updating display name: $updateError');"},{"type":"INSERT","lineNumber":105,"content":"        // Continue even if display name update fails"},{"type":"INSERT","lineNumber":108,"content":"      // Save user data to Firestore"},{"type":"INSERT","lineNumber":109,"content":"      try {"},{"type":"INSERT","lineNumber":110,"content":"        await FirebaseFirestore.instance.collection('users').doc(user.uid).set({"},{"type":"INSERT","lineNumber":111,"content":"          'id': user.uid,"},{"type":"INSERT","lineNumber":112,"content":"          'email': email.trim(),"},{"type":"INSERT","lineNumber":113,"content":"          'displayName': displayName.trim(),"},{"type":"INSERT","lineNumber":114,"content":"          'phoneNumber': phoneNumber?.trim(),"},{"type":"INSERT","lineNumber":115,"content":"          'emailVerified': false,"},{"type":"INSERT","lineNumber":116,"content":"          'createdAt': FieldValue.serverTimestamp(),"},{"type":"INSERT","lineNumber":117,"content":"          'updatedAt': FieldValue.serverTimestamp(),"},{"type":"INSERT","lineNumber":118,"content":"        });"},{"type":"INSERT","lineNumber":119,"content":"        print('User data saved to Firestore');"},{"type":"INSERT","lineNumber":120,"content":"      } catch (firestoreError) {"},{"type":"INSERT","lineNumber":121,"content":"        print('Error saving user data to Firestore: $firestoreError');"},{"type":"INSERT","lineNumber":122,"content":"        // Clean up the user if Firestore save fails"},{"type":"INSERT","lineNumber":123,"content":"        await user.delete();"},{"type":"INSERT","lineNumber":124,"content":"        rethrow FirebaseAuthException("},{"type":"INSERT","lineNumber":125,"content":"          code: 'firestore-error',"},{"type":"INSERT","lineNumber":126,"content":"          message: 'Failed to save user data',"},{"type":"INSERT","lineNumber":127,"content":"        );"},{"type":"INSERT","lineNumber":128,"content":"      }"},{"type":"INSERT","lineNumber":129,"content":"      "},{"type":"INSERT","lineNumber":130,"content":"      // Handle phone number if provided"},{"type":"INSERT","lineNumber":131,"content":"      if (phoneNumber != null && phoneNumber.trim().isNotEmpty) {"},{"type":"INSERT","lineNumber":132,"content":"        print('Phone number provided: $phoneNumber');"},{"type":"INSERT","lineNumber":133,"content":"        // We'll handle phone verification in a separate step after registration"},{"type":"INSERT","lineNumber":134,"content":"        // The phone number will be verified using OTP later"},{"type":"INSERT","lineNumber":135,"content":"        print('Phone number will be verified via OTP flow');"},{"type":"INSERT","lineNumber":136,"content":"      }"},{"type":"INSERT","lineNumber":137,"content":"      "},{"type":"INSERT","lineNumber":139,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":104,"oldContent":"      print('FirebaseAuthException during registration:');"},{"type":"DELETE","lineNumber":111,"oldContent":"        print('Attempting to clean up partially created user...');"},{"type":"INSERT","lineNumber":148,"content":"        print('Attempting to clean up partially created user...');"},{"type":"INSERT","lineNumber":151,"content":"          print('Successfully cleaned up partially created user');"},{"type":"DELETE","lineNumber":117,"oldContent":"          print('Successfully cleaned up partially created user');"},{"type":"DELETE","lineNumber":119,"oldContent":"      }"},{"type":"INSERT","lineNumber":156,"content":"      }"},{"type":"DELETE","lineNumber":130,"oldContent":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":167,"content":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":176,"content":"  }"},{"type":"DELETE","lineNumber":141,"oldContent":""},{"type":"DELETE","lineNumber":161,"oldContent":"    );"},{"type":"DELETE","lineNumber":163,"oldContent":""},{"type":"DELETE","lineNumber":166,"oldContent":"    final oauthCredential = OAuthProvider('apple.com').credential("},{"type":"INSERT","lineNumber":201,"content":"    );"},{"type":"INSERT","lineNumber":202,"content":""},{"type":"INSERT","lineNumber":203,"content":"    final oauthCredential = OAuthProvider('apple.com').credential("},{"type":"DELETE","lineNumber":186,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":223,"content":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":189,"oldContent":"  }"},{"type":"DELETE","lineNumber":191,"oldContent":""},{"type":"DELETE","lineNumber":194,"oldContent":"  @override"},{"type":"DELETE","lineNumber":196,"oldContent":"  Future<String> sendOtpToPhoneNumber({required String phoneNumber}) async {"},{"type":"DELETE","lineNumber":199,"oldContent":"    final completer = Completer<String>();"},{"type":"DELETE","lineNumber":202,"oldContent":"    try {"},{"type":"INSERT","lineNumber":234,"content":"  }"},{"type":"INSERT","lineNumber":235,"content":""},{"type":"INSERT","lineNumber":236,"content":"  @override"},{"type":"INSERT","lineNumber":237,"content":"  Future<String> sendOtpToPhoneNumber({required String phoneNumber}) async {"},{"type":"INSERT","lineNumber":238,"content":"    final completer = Completer<String>();"},{"type":"INSERT","lineNumber":239,"content":"    "},{"type":"INSERT","lineNumber":240,"content":"    try {"},{"type":"DELETE","lineNumber":208,"oldContent":"    "},{"type":"INSERT","lineNumber":259,"content":"      }"},{"type":"INSERT","lineNumber":260,"content":"      "},{"type":"DELETE","lineNumber":225,"oldContent":"      }"},{"type":"DELETE","lineNumber":228,"oldContent":"      "},{"type":"DELETE","lineNumber":231,"oldContent":"      await _firebaseAuth.verifyPhoneNumber("},{"type":"DELETE","lineNumber":234,"oldContent":"        phoneNumber: formattedPhoneNumber,"},{"type":"INSERT","lineNumber":273,"content":"      await _firebaseAuth.verifyPhoneNumber("},{"type":"INSERT","lineNumber":274,"content":"        phoneNumber: formattedPhoneNumber,"},{"type":"DELETE","lineNumber":240,"oldContent":"        },"},{"type":"DELETE","lineNumber":242,"oldContent":"        verificationFailed: (FirebaseAuthException e) {"},{"type":"DELETE","lineNumber":245,"oldContent":"          print('Phone verification failed: ${e.code} - ${e.message}');"},{"type":"DELETE","lineNumber":247,"oldContent":"          "},{"type":"DELETE","lineNumber":250,"oldContent":"          // Map Firebase error codes to more user-friendly messages"},{"type":"DELETE","lineNumber":252,"oldContent":"          String errorMessage = 'Failed to verify phone number';"},{"type":"DELETE","lineNumber":255,"oldContent":"          switch (e.code) {"},{"type":"DELETE","lineNumber":258,"oldContent":"            case 'invalid-phone-number':"},{"type":"DELETE","lineNumber":260,"oldContent":"              errorMessage = 'The provided phone number is not valid';"},{"type":"DELETE","lineNumber":263,"oldContent":"              break;"},{"type":"DELETE","lineNumber":266,"oldContent":"            case 'too-many-requests':"},{"type":"DELETE","lineNumber":269,"oldContent":"              errorMessage = 'Too many requests. Please try again later.';"},{"type":"DELETE","lineNumber":272,"oldContent":"              break;"},{"type":"DELETE","lineNumber":275,"oldContent":"            case 'quota-exceeded':"},{"type":"DELETE","lineNumber":278,"oldContent":"              errorMessage = 'Quota exceeded. Please try again later.';"},{"type":"DELETE","lineNumber":280,"oldContent":"              break;"},{"type":"DELETE","lineNumber":281,"oldContent":"            default:"},{"type":"DELETE","lineNumber":282,"oldContent":"              errorMessage = 'Failed to verify phone number: ${e.message}';"},{"type":"DELETE","lineNumber":283,"oldContent":"          }"},{"type":"INSERT","lineNumber":301,"content":"        },"},{"type":"INSERT","lineNumber":302,"content":"        verificationFailed: (FirebaseAuthException e) {"},{"type":"INSERT","lineNumber":303,"content":"          print('Phone verification failed: ${e.code} - ${e.message}');"},{"type":"DELETE","lineNumber":285,"oldContent":"  @override"},{"type":"DELETE","lineNumber":286,"oldContent":"  Future<String> getAuthToken() async {"},{"type":"DELETE","lineNumber":287,"oldContent":"    final user = _firebaseAuth.currentUser;"},{"type":"DELETE","lineNumber":288,"oldContent":"    if (user == null) throw Exception('No user is signed in');"},{"type":"INSERT","lineNumber":305,"content":"          // Map Firebase error codes to more user-friendly messages"},{"type":"INSERT","lineNumber":306,"content":"          String errorMessage = 'Failed to verify phone number';"},{"type":"INSERT","lineNumber":307,"content":"          switch (e.code) {"},{"type":"INSERT","lineNumber":308,"content":"            case 'invalid-phone-number':"},{"type":"INSERT","lineNumber":309,"content":"              errorMessage = 'The provided phone number is not valid';"},{"type":"INSERT","lineNumber":310,"content":"              break;"},{"type":"INSERT","lineNumber":311,"content":"            case 'too-many-requests':"},{"type":"INSERT","lineNumber":312,"content":"              errorMessage = 'Too many requests. Please try again later.';"},{"type":"INSERT","lineNumber":313,"content":"              break;"},{"type":"INSERT","lineNumber":314,"content":"            case 'quota-exceeded':"},{"type":"INSERT","lineNumber":315,"content":"              errorMessage = 'Quota exceeded. Please try again later.';"},{"type":"INSERT","lineNumber":316,"content":"              break;"},{"type":"DELETE","lineNumber":291,"oldContent":"    "},{"type":"DELETE","lineNumber":294,"oldContent":"    final token = await user.getIdToken();"},{"type":"DELETE","lineNumber":297,"oldContent":"    return token ?? '';"},{"type":"DELETE","lineNumber":298,"oldContent":"  }"},{"type":"DELETE","lineNumber":299,"oldContent":""},{"type":"INSERT","lineNumber":323,"content":"            default:"},{"type":"INSERT","lineNumber":324,"content":"              errorMessage = 'Failed to verify phone number: ${e.message}';"},{"type":"INSERT","lineNumber":325,"content":"          }"},{"type":"INSERT","lineNumber":326,"content":"          "},{"type":"DELETE","lineNumber":302,"oldContent":"  @override"},{"type":"DELETE","lineNumber":305,"oldContent":"  Future<void> updateUserProfile({"},{"type":"DELETE","lineNumber":308,"oldContent":"    String? displayName,"},{"type":"DELETE","lineNumber":311,"oldContent":"    String? photoUrl,"},{"type":"DELETE","lineNumber":314,"oldContent":"    String? phoneNumber,"},{"type":"DELETE","lineNumber":317,"oldContent":"  }) async {"},{"type":"DELETE","lineNumber":320,"oldContent":"    final user = _firebaseAuth.currentUser;"},{"type":"DELETE","lineNumber":323,"oldContent":"    if (user == null) throw Exception('No user is signed in');"},{"type":"DELETE","lineNumber":326,"oldContent":"    "},{"type":"DELETE","lineNumber":329,"oldContent":"    await user.updateDisplayName(displayName);"},{"type":"DELETE","lineNumber":332,"oldContent":"    if (photoUrl != null) {"},{"type":"DELETE","lineNumber":335,"oldContent":"      await user.updatePhotoURL(photoUrl);"},{"type":"DELETE","lineNumber":338,"oldContent":"    }"},{"type":"DELETE","lineNumber":341,"oldContent":"    if (phoneNumber != null) {"},{"type":"DELETE","lineNumber":344,"oldContent":"      // Note: Updating phone number requires re-authentication"},{"type":"DELETE","lineNumber":347,"oldContent":"      // This is a simplified example - in a real app, you'd need to handle re-authentication"},{"type":"DELETE","lineNumber":350,"oldContent":"      throw UnimplementedError('Phone number update not implemented');"},{"type":"DELETE","lineNumber":353,"oldContent":"    }"},{"type":"DELETE","lineNumber":356,"oldContent":"  }"},{"type":"DELETE","lineNumber":359,"oldContent":""},{"type":"DELETE","lineNumber":362,"oldContent":"  @override"},{"type":"DELETE","lineNumber":364,"oldContent":"  Future<void> sendPasswordResetEmail(String email) async {"},{"type":"DELETE","lineNumber":366,"oldContent":"    await _firebaseAuth.sendPasswordResetEmail(email: email);"},{"type":"DELETE","lineNumber":368,"oldContent":"  }"},{"type":"DELETE","lineNumber":370,"oldContent":""},{"type":"DELETE","lineNumber":372,"oldContent":"  @override"},{"type":"DELETE","lineNumber":374,"oldContent":"  Future<void> deleteAccount() async {"},{"type":"DELETE","lineNumber":376,"oldContent":"    final user = _firebaseAuth.currentUser;"},{"type":"DELETE","lineNumber":378,"oldContent":"    if (user == null) throw Exception('No user is signed in');"},{"type":"DELETE","lineNumber":379,"oldContent":"    "},{"type":"INSERT","lineNumber":377,"content":"  @override"},{"type":"DELETE","lineNumber":381,"oldContent":"    await user.delete();"},{"type":"DELETE","lineNumber":383,"oldContent":"  }"},{"type":"DELETE","lineNumber":385,"oldContent":"}"},{"type":"DELETE","lineNumber":387,"oldContent":""},{"type":"DELETE","lineNumber":389,"oldContent":"  @override"},{"type":"DELETE","lineNumber":391,"oldContent":""},{"type":"DELETE","lineNumber":393,"oldContent":"  }"},{"type":"DELETE","lineNumber":395,"oldContent":"    ]);"},{"type":"DELETE","lineNumber":397,"oldContent":"      _googleSignIn.signOut(),"},{"type":"DELETE","lineNumber":399,"oldContent":"      _firebaseAuth.signOut(),"},{"type":"DELETE","lineNumber":401,"oldContent":"    await Future.wait(["},{"type":"INSERT","lineNumber":390,"content":"  @override"},{"type":"INSERT","lineNumber":392,"content":"    await Future.wait(["},{"type":"INSERT","lineNumber":393,"content":"      _firebaseAuth.signOut(),"},{"type":"INSERT","lineNumber":394,"content":"      _googleSignIn.signOut(),"},{"type":"INSERT","lineNumber":395,"content":"    ]);"},{"type":"INSERT","lineNumber":396,"content":"  }"},{"type":"INSERT","lineNumber":397,"content":""},{"type":"INSERT","lineNumber":399,"content":"  Future<String> getAuthToken() async {"},{"type":"INSERT","lineNumber":400,"content":"    final user = _firebaseAuth.currentUser;"},{"type":"INSERT","lineNumber":401,"content":"    if (user == null) throw Exception('No user is signed in');"},{"type":"INSERT","lineNumber":402,"content":"    "},{"type":"INSERT","lineNumber":403,"content":"    final token = await user.getIdToken();"},{"type":"INSERT","lineNumber":404,"content":"    return token ?? '';"},{"type":"INSERT","lineNumber":405,"content":"  }"},{"type":"INSERT","lineNumber":406,"content":""},{"type":"INSERT","lineNumber":407,"content":"  @override"},{"type":"INSERT","lineNumber":408,"content":"  Future<void> updateUserProfile({"},{"type":"INSERT","lineNumber":409,"content":"    String? displayName,"},{"type":"INSERT","lineNumber":410,"content":"    String? photoUrl,"},{"type":"INSERT","lineNumber":411,"content":"    String? phoneNumber,"},{"type":"INSERT","lineNumber":412,"content":"  }) async {"},{"type":"INSERT","lineNumber":413,"content":"    final user = _firebaseAuth.currentUser;"},{"type":"INSERT","lineNumber":414,"content":"    if (user == null) throw Exception('No user is signed in');"},{"type":"INSERT","lineNumber":415,"content":"    "},{"type":"INSERT","lineNumber":416,"content":"    await user.updateDisplayName(displayName);"},{"type":"INSERT","lineNumber":417,"content":"    if (photoUrl != null) {"},{"type":"INSERT","lineNumber":418,"content":"      await user.updatePhotoURL(photoUrl);"},{"type":"INSERT","lineNumber":419,"content":"    }"},{"type":"INSERT","lineNumber":420,"content":"    if (phoneNumber != null) {"},{"type":"INSERT","lineNumber":421,"content":"      // Note: Updating phone number requires re-authentication"},{"type":"INSERT","lineNumber":422,"content":"      // This is a simplified example - in a real app, you'd need to handle re-authentication"},{"type":"INSERT","lineNumber":423,"content":"      throw UnimplementedError('Phone number update not implemented');"},{"type":"INSERT","lineNumber":424,"content":"    }"},{"type":"INSERT","lineNumber":425,"content":"  }"},{"type":"INSERT","lineNumber":426,"content":""},{"type":"INSERT","lineNumber":427,"content":"  @override"},{"type":"INSERT","lineNumber":428,"content":"  Future<void> sendPasswordResetEmail(String email) async {"},{"type":"INSERT","lineNumber":429,"content":"    await _firebaseAuth.sendPasswordResetEmail(email: email);"},{"type":"INSERT","lineNumber":430,"content":"  }"},{"type":"INSERT","lineNumber":431,"content":""},{"type":"INSERT","lineNumber":432,"content":"  @override"},{"type":"INSERT","lineNumber":433,"content":"  Future<void> deleteAccount() async {"},{"type":"INSERT","lineNumber":434,"content":"    final user = _firebaseAuth.currentUser;"},{"type":"INSERT","lineNumber":435,"content":"    if (user == null) throw Exception('No user is signed in');"},{"type":"INSERT","lineNumber":436,"content":"    "},{"type":"INSERT","lineNumber":437,"content":"    await user.delete();"},{"type":"INSERT","lineNumber":438,"content":"  }"},{"type":"INSERT","lineNumber":439,"content":"}"},{"type":"INSERT","lineNumber":440,"content":""}]},{"timestamp":1754617141318,"changes":[{"type":"INSERT","lineNumber":2,"content":"import 'package:cloud_firestore/cloud_firestore.dart';"},{"type":"DELETE","lineNumber":68,"oldContent":"    }"},{"type":"INSERT","lineNumber":70,"content":"    }"},{"type":"DELETE","lineNumber":71,"oldContent":"      // First create the user with email and password"},{"type":"DELETE","lineNumber":73,"oldContent":"      print('Creating user with email and password...');"},{"type":"DELETE","lineNumber":76,"oldContent":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"DELETE","lineNumber":79,"oldContent":"        email: email.trim(),"},{"type":"DELETE","lineNumber":81,"oldContent":"        password: password,"},{"type":"DELETE","lineNumber":83,"oldContent":"      );"},{"type":"INSERT","lineNumber":80,"content":"      // First create the user with email and password"},{"type":"INSERT","lineNumber":81,"content":"      print('Creating user with email and password...');"},{"type":"INSERT","lineNumber":82,"content":"      final userCredential = await _firebaseAuth.createUserWithEmailAndPassword("},{"type":"INSERT","lineNumber":83,"content":"        email: email.trim(),"},{"type":"INSERT","lineNumber":84,"content":"        password: password,"},{"type":"INSERT","lineNumber":85,"content":"      );"},{"type":"DELETE","lineNumber":88,"oldContent":"      // Update the display name"},{"type":"INSERT","lineNumber":98,"content":"      // Update the display name"},{"type":"DELETE","lineNumber":101,"oldContent":"      }"},{"type":"DELETE","lineNumber":103,"oldContent":"      "},{"type":"DELETE","lineNumber":105,"oldContent":"      return userCredential;"},{"type":"DELETE","lineNumber":107,"oldContent":"      print('FirebaseAuthException during registration:');"},{"type":"DELETE","lineNumber":110,"oldContent":"      print('Code: ${e.code}');"},{"type":"DELETE","lineNumber":111,"oldContent":"      print('Message: ${e.message}');"},{"type":"DELETE","lineNumber":112,"oldContent":"      print('Email: ${e.email}');"},{"type":"INSERT","lineNumber":107,"content":"      }"},{"type":"INSERT","lineNumber":108,"content":"      "},{"type":"DELETE","lineNumber":114,"oldContent":"      print('Credential: ${e.credential}');"},{"type":"DELETE","lineNumber":116,"oldContent":"      "},{"type":"DELETE","lineNumber":118,"oldContent":"      // If there's an error, delete the created user to avoid partial registration"},{"type":"DELETE","lineNumber":121,"oldContent":"      if (_firebaseAuth.currentUser != null) {"},{"type":"DELETE","lineNumber":123,"oldContent":"        try {"},{"type":"DELETE","lineNumber":125,"oldContent":"          await _firebaseAuth.currentUser!.delete();"},{"type":"DELETE","lineNumber":127,"oldContent":"        } catch (deleteError) {"},{"type":"DELETE","lineNumber":129,"oldContent":"          print('Error during user cleanup: $deleteError');"},{"type":"DELETE","lineNumber":132,"oldContent":"          // Continue with the original error"},{"type":"DELETE","lineNumber":135,"oldContent":"        }"},{"type":"DELETE","lineNumber":137,"oldContent":"      rethrow; // Re-throw the original error"},{"type":"DELETE","lineNumber":139,"oldContent":"    } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":141,"oldContent":"      print('Unexpected error during registration:');"},{"type":"DELETE","lineNumber":143,"oldContent":"      print('Error: $e');"},{"type":"DELETE","lineNumber":145,"oldContent":"      print('Stack trace: $stackTrace');"},{"type":"DELETE","lineNumber":147,"oldContent":"      "},{"type":"DELETE","lineNumber":149,"oldContent":"      // For any other type of error, clean up and rethrow"},{"type":"DELETE","lineNumber":151,"oldContent":"      if (_firebaseAuth.currentUser != null) {"},{"type":"DELETE","lineNumber":153,"oldContent":"        print('Attempting to clean up after unexpected error...');"},{"type":"DELETE","lineNumber":156,"oldContent":"        try {"},{"type":"DELETE","lineNumber":158,"oldContent":"        } catch (deleteError) {"},{"type":"DELETE","lineNumber":160,"oldContent":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"DELETE","lineNumber":162,"oldContent":"        }"},{"type":"INSERT","lineNumber":138,"content":"      "},{"type":"INSERT","lineNumber":139,"content":"      return userCredential;"},{"type":"INSERT","lineNumber":140,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":141,"content":"      print('FirebaseAuthException during registration:');"},{"type":"INSERT","lineNumber":142,"content":"      print('Code: ${e.code}');"},{"type":"INSERT","lineNumber":143,"content":"      print('Message: ${e.message}');"},{"type":"INSERT","lineNumber":144,"content":"      print('Email: ${e.email}');"},{"type":"INSERT","lineNumber":145,"content":"      print('Credential: ${e.credential}');"},{"type":"INSERT","lineNumber":146,"content":"      "},{"type":"INSERT","lineNumber":147,"content":"      // If there's an error, delete the created user to avoid partial registration"},{"type":"INSERT","lineNumber":148,"content":"      if (_firebaseAuth.currentUser != null) {"},{"type":"INSERT","lineNumber":149,"content":"        print('Attempting to clean up partially created user...');"},{"type":"INSERT","lineNumber":150,"content":"        try {"},{"type":"INSERT","lineNumber":151,"content":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":152,"content":"          print('Successfully cleaned up partially created user');"},{"type":"INSERT","lineNumber":153,"content":"        } catch (deleteError) {"},{"type":"INSERT","lineNumber":154,"content":"          print('Error during user cleanup: $deleteError');"},{"type":"INSERT","lineNumber":155,"content":"          // Continue with the original error"},{"type":"INSERT","lineNumber":156,"content":"        }"},{"type":"DELETE","lineNumber":166,"oldContent":"      rethrow;"},{"type":"INSERT","lineNumber":158,"content":"      rethrow; // Re-throw the original error"},{"type":"INSERT","lineNumber":159,"content":"    } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":160,"content":"      print('Unexpected error during registration:');"},{"type":"INSERT","lineNumber":161,"content":"      print('Error: $e');"},{"type":"INSERT","lineNumber":162,"content":"      print('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":164,"content":"      // For any other type of error, clean up and rethrow"},{"type":"INSERT","lineNumber":165,"content":"      if (_firebaseAuth.currentUser != null) {"},{"type":"INSERT","lineNumber":166,"content":"        print('Attempting to clean up after unexpected error...');"},{"type":"INSERT","lineNumber":167,"content":"        try {"},{"type":"INSERT","lineNumber":168,"content":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":169,"content":"        } catch (deleteError) {"},{"type":"INSERT","lineNumber":170,"content":"          print('Error during cleanup after unexpected error: $deleteError');"},{"type":"INSERT","lineNumber":171,"content":"        }"},{"type":"INSERT","lineNumber":172,"content":"      }"},{"type":"INSERT","lineNumber":173,"content":"      rethrow;"},{"type":"DELETE","lineNumber":170,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":177,"content":"  }"},{"type":"DELETE","lineNumber":179,"oldContent":"        print('Attempting to clean up partially created user...');"},{"type":"DELETE","lineNumber":183,"oldContent":"          print('Successfully cleaned up partially created user');"},{"type":"DELETE","lineNumber":189,"oldContent":"      }"},{"type":"DELETE","lineNumber":198,"oldContent":"          await _firebaseAuth.currentUser!.delete();"},{"type":"INSERT","lineNumber":202,"content":"    );"},{"type":"INSERT","lineNumber":203,"content":""},{"type":"INSERT","lineNumber":204,"content":"    final oauthCredential = OAuthProvider('apple.com').credential("},{"type":"DELETE","lineNumber":208,"oldContent":"  }"},{"type":"INSERT","lineNumber":224,"content":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":228,"oldContent":"    );"},{"type":"DELETE","lineNumber":230,"oldContent":""},{"type":"DELETE","lineNumber":231,"oldContent":"    final oauthCredential = OAuthProvider('apple.com').credential("},{"type":"INSERT","lineNumber":235,"content":"  }"},{"type":"INSERT","lineNumber":236,"content":""},{"type":"INSERT","lineNumber":237,"content":"  @override"},{"type":"INSERT","lineNumber":238,"content":"  Future<String> sendOtpToPhoneNumber({required String phoneNumber}) async {"},{"type":"INSERT","lineNumber":239,"content":"    final completer = Completer<String>();"},{"type":"INSERT","lineNumber":240,"content":"    "},{"type":"INSERT","lineNumber":241,"content":"    try {"},{"type":"DELETE","lineNumber":251,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":260,"content":"      }"},{"type":"INSERT","lineNumber":261,"content":"      "},{"type":"DELETE","lineNumber":260,"oldContent":"  }"},{"type":"DELETE","lineNumber":261,"oldContent":""},{"type":"DELETE","lineNumber":263,"oldContent":"  @override"},{"type":"DELETE","lineNumber":265,"oldContent":"  Future<String> sendOtpToPhoneNumber({required String phoneNumber}) async {"},{"type":"DELETE","lineNumber":267,"oldContent":"    final completer = Completer<String>();"},{"type":"DELETE","lineNumber":269,"oldContent":"    "},{"type":"INSERT","lineNumber":274,"content":"      await _firebaseAuth.verifyPhoneNumber("},{"type":"INSERT","lineNumber":275,"content":"        phoneNumber: formattedPhoneNumber,"},{"type":"DELETE","lineNumber":271,"oldContent":"    try {"},{"type":"DELETE","lineNumber":283,"oldContent":"      }"},{"type":"DELETE","lineNumber":285,"oldContent":"      "},{"type":"DELETE","lineNumber":294,"oldContent":"      await _firebaseAuth.verifyPhoneNumber("},{"type":"DELETE","lineNumber":296,"oldContent":"        phoneNumber: formattedPhoneNumber,"},{"type":"INSERT","lineNumber":302,"content":"        },"},{"type":"INSERT","lineNumber":303,"content":"        verificationFailed: (FirebaseAuthException e) {"},{"type":"INSERT","lineNumber":304,"content":"          print('Phone verification failed: ${e.code} - ${e.message}');"},{"type":"INSERT","lineNumber":306,"content":"          // Map Firebase error codes to more user-friendly messages"},{"type":"INSERT","lineNumber":307,"content":"          String errorMessage = 'Failed to verify phone number';"},{"type":"INSERT","lineNumber":308,"content":"          switch (e.code) {"},{"type":"INSERT","lineNumber":309,"content":"            case 'invalid-phone-number':"},{"type":"INSERT","lineNumber":310,"content":"              errorMessage = 'The provided phone number is not valid';"},{"type":"INSERT","lineNumber":311,"content":"              break;"},{"type":"INSERT","lineNumber":312,"content":"            case 'too-many-requests':"},{"type":"INSERT","lineNumber":313,"content":"              errorMessage = 'Too many requests. Please try again later.';"},{"type":"INSERT","lineNumber":314,"content":"              break;"},{"type":"INSERT","lineNumber":315,"content":"            case 'quota-exceeded':"},{"type":"INSERT","lineNumber":316,"content":"              errorMessage = 'Quota exceeded. Please try again later.';"},{"type":"INSERT","lineNumber":317,"content":"              break;"},{"type":"INSERT","lineNumber":324,"content":"            default:"},{"type":"INSERT","lineNumber":325,"content":"              errorMessage = 'Failed to verify phone number: ${e.message}';"},{"type":"INSERT","lineNumber":326,"content":"          }"},{"type":"INSERT","lineNumber":327,"content":"          "},{"type":"DELETE","lineNumber":309,"oldContent":"        },"},{"type":"DELETE","lineNumber":311,"oldContent":"        verificationFailed: (FirebaseAuthException e) {"},{"type":"DELETE","lineNumber":312,"oldContent":"          print('Phone verification failed: ${e.code} - ${e.message}');"},{"type":"DELETE","lineNumber":315,"oldContent":"          // Map Firebase error codes to more user-friendly messages"},{"type":"DELETE","lineNumber":316,"oldContent":"          String errorMessage = 'Failed to verify phone number';"},{"type":"DELETE","lineNumber":318,"oldContent":"          switch (e.code) {"},{"type":"DELETE","lineNumber":320,"oldContent":"            case 'invalid-phone-number':"},{"type":"DELETE","lineNumber":321,"oldContent":"              errorMessage = 'The provided phone number is not valid';"},{"type":"DELETE","lineNumber":323,"oldContent":"              break;"},{"type":"DELETE","lineNumber":325,"oldContent":"            case 'too-many-requests':"},{"type":"DELETE","lineNumber":326,"oldContent":"              errorMessage = 'Too many requests. Please try again later.';"},{"type":"DELETE","lineNumber":328,"oldContent":"              break;"},{"type":"DELETE","lineNumber":330,"oldContent":"            case 'quota-exceeded':"},{"type":"DELETE","lineNumber":331,"oldContent":"              errorMessage = 'Quota exceeded. Please try again later.';"},{"type":"DELETE","lineNumber":333,"oldContent":"              break;"},{"type":"DELETE","lineNumber":339,"oldContent":"            default:"},{"type":"DELETE","lineNumber":340,"oldContent":"              errorMessage = 'Failed to verify phone number: ${e.message}';"},{"type":"DELETE","lineNumber":342,"oldContent":"          }"},{"type":"DELETE","lineNumber":344,"oldContent":"          "},{"type":"DELETE","lineNumber":376,"oldContent":"  @override"},{"type":"INSERT","lineNumber":378,"content":"  @override"},{"type":"DELETE","lineNumber":383,"oldContent":"  @override"},{"type":"DELETE","lineNumber":385,"oldContent":"    await Future.wait(["},{"type":"INSERT","lineNumber":386,"content":"    );"},{"type":"INSERT","lineNumber":387,"content":"    "},{"type":"INSERT","lineNumber":388,"content":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":389,"content":"  }"},{"type":"INSERT","lineNumber":390,"content":""},{"type":"INSERT","lineNumber":391,"content":"  @override"},{"type":"INSERT","lineNumber":392,"content":"  Future<void> signOut() async {"},{"type":"INSERT","lineNumber":393,"content":"    await Future.wait(["},{"type":"DELETE","lineNumber":389,"oldContent":"    );"},{"type":"DELETE","lineNumber":392,"oldContent":"    "},{"type":"DELETE","lineNumber":394,"oldContent":"    return await _firebaseAuth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":399,"content":"  @override"},{"type":"DELETE","lineNumber":397,"oldContent":"  }"},{"type":"DELETE","lineNumber":400,"oldContent":""},{"type":"DELETE","lineNumber":402,"oldContent":"  Future<void> signOut() async {"},{"type":"DELETE","lineNumber":404,"oldContent":"  @override"},{"type":"DELETE","lineNumber":407,"oldContent":""},{"type":"DELETE","lineNumber":408,"oldContent":"}"},{"type":"DELETE","lineNumber":410,"oldContent":"  }"},{"type":"DELETE","lineNumber":412,"oldContent":"    await user.delete();"},{"type":"DELETE","lineNumber":414,"oldContent":"    "},{"type":"DELETE","lineNumber":416,"oldContent":"    if (user == null) throw Exception('No user is signed in');"},{"type":"DELETE","lineNumber":418,"oldContent":"    final user = _firebaseAuth.currentUser;"},{"type":"DELETE","lineNumber":420,"oldContent":"  Future<void> deleteAccount() async {"},{"type":"DELETE","lineNumber":422,"oldContent":"  @override"},{"type":"DELETE","lineNumber":424,"oldContent":""},{"type":"DELETE","lineNumber":426,"oldContent":"  }"},{"type":"DELETE","lineNumber":428,"oldContent":"    await _firebaseAuth.sendPasswordResetEmail(email: email);"},{"type":"DELETE","lineNumber":430,"oldContent":"  Future<void> sendPasswordResetEmail(String email) async {"},{"type":"DELETE","lineNumber":432,"oldContent":"  @override"},{"type":"DELETE","lineNumber":434,"oldContent":""},{"type":"DELETE","lineNumber":436,"oldContent":"  }"},{"type":"DELETE","lineNumber":438,"oldContent":"    }"},{"type":"INSERT","lineNumber":425,"content":"    }"},{"type":"INSERT","lineNumber":426,"content":"  }"},{"type":"INSERT","lineNumber":427,"content":""},{"type":"INSERT","lineNumber":428,"content":"  @override"},{"type":"INSERT","lineNumber":429,"content":"  Future<void> sendPasswordResetEmail(String email) async {"},{"type":"INSERT","lineNumber":430,"content":"    await _firebaseAuth.sendPasswordResetEmail(email: email);"},{"type":"INSERT","lineNumber":431,"content":"  }"},{"type":"INSERT","lineNumber":432,"content":""},{"type":"INSERT","lineNumber":433,"content":"  @override"},{"type":"INSERT","lineNumber":434,"content":"  Future<void> deleteAccount() async {"},{"type":"INSERT","lineNumber":435,"content":"    final user = _firebaseAuth.currentUser;"},{"type":"INSERT","lineNumber":436,"content":"    if (user == null) throw Exception('No user is signed in');"},{"type":"INSERT","lineNumber":437,"content":"    "},{"type":"INSERT","lineNumber":438,"content":"    await user.delete();"},{"type":"INSERT","lineNumber":439,"content":"  }"},{"type":"INSERT","lineNumber":440,"content":"}"},{"type":"INSERT","lineNumber":441,"content":""}]},{"timestamp":1754617444646,"changes":[{"type":"DELETE","lineNumber":77,"oldContent":"      // First create the user with email and password"},{"type":"INSERT","lineNumber":78,"content":"    "},{"type":"INSERT","lineNumber":79,"content":"    try {"},{"type":"INSERT","lineNumber":80,"content":"      // First create the user with email and password"},{"type":"DELETE","lineNumber":81,"oldContent":"    "},{"type":"DELETE","lineNumber":84,"oldContent":"    try {"},{"type":"DELETE","lineNumber":105,"oldContent":"      }"},{"type":"DELETE","lineNumber":106,"oldContent":"      "},{"type":"INSERT","lineNumber":107,"content":"      }"},{"type":"INSERT","lineNumber":108,"content":"      "},{"type":"DELETE","lineNumber":123,"oldContent":"      "},{"type":"INSERT","lineNumber":124,"content":"        await user.delete();"},{"type":"INSERT","lineNumber":125,"content":"        throw FirebaseAuthException("},{"type":"INSERT","lineNumber":126,"content":"          code: 'firestore-error',"},{"type":"INSERT","lineNumber":127,"content":"          message: 'Failed to save user data',"},{"type":"INSERT","lineNumber":128,"content":"        );"},{"type":"INSERT","lineNumber":129,"content":"      }"},{"type":"INSERT","lineNumber":130,"content":"      "},{"type":"INSERT","lineNumber":131,"content":"      // Handle phone number if provided"},{"type":"INSERT","lineNumber":132,"content":"      if (phoneNumber != null && phoneNumber.trim().isNotEmpty) {"},{"type":"INSERT","lineNumber":133,"content":"        print('Phone number provided: $phoneNumber');"},{"type":"INSERT","lineNumber":134,"content":"        // We'll handle phone verification in a separate step after registration"},{"type":"INSERT","lineNumber":135,"content":"        // The phone number will be verified using OTP later"},{"type":"INSERT","lineNumber":136,"content":"        print('Phone number will be verified via OTP flow');"},{"type":"INSERT","lineNumber":137,"content":"      }"},{"type":"INSERT","lineNumber":138,"content":"      "},{"type":"DELETE","lineNumber":127,"oldContent":"        await user.delete();"},{"type":"DELETE","lineNumber":130,"oldContent":"        rethrow FirebaseAuthException("},{"type":"DELETE","lineNumber":133,"oldContent":"          code: 'firestore-error',"},{"type":"DELETE","lineNumber":136,"oldContent":"          message: 'Failed to save user data',"},{"type":"DELETE","lineNumber":139,"oldContent":"        );"},{"type":"DELETE","lineNumber":142,"oldContent":"      }"},{"type":"DELETE","lineNumber":145,"oldContent":"      "},{"type":"DELETE","lineNumber":148,"oldContent":"      // Handle phone number if provided"},{"type":"DELETE","lineNumber":150,"oldContent":"      if (phoneNumber != null && phoneNumber.trim().isNotEmpty) {"},{"type":"DELETE","lineNumber":152,"oldContent":"        print('Phone number provided: $phoneNumber');"},{"type":"INSERT","lineNumber":157,"content":"      }"},{"type":"DELETE","lineNumber":155,"oldContent":"        // We'll handle phone verification in a separate step after registration"},{"type":"DELETE","lineNumber":158,"oldContent":"        // The phone number will be verified using OTP later"},{"type":"DELETE","lineNumber":160,"oldContent":"        print('Phone number will be verified via OTP flow');"},{"type":"INSERT","lineNumber":163,"content":"      "},{"type":"DELETE","lineNumber":162,"oldContent":"      }"},{"type":"DELETE","lineNumber":164,"oldContent":"      }"},{"type":"DELETE","lineNumber":167,"oldContent":"      "},{"type":"DELETE","lineNumber":169,"oldContent":"    } finally {"},{"type":"DELETE","lineNumber":171,"oldContent":"      print('Registration process completed');"},{"type":"DELETE","lineNumber":174,"oldContent":"    }"},{"type":"DELETE","lineNumber":176,"oldContent":""},{"type":"INSERT","lineNumber":174,"content":"    } finally {"},{"type":"INSERT","lineNumber":175,"content":"      print('Registration process completed');"},{"type":"INSERT","lineNumber":176,"content":"    }"},{"type":"INSERT","lineNumber":177,"content":"  }"},{"type":"INSERT","lineNumber":178,"content":""},{"type":"DELETE","lineNumber":182,"oldContent":"  }"},{"type":"INSERT","lineNumber":202,"content":"    );"},{"type":"INSERT","lineNumber":203,"content":""},{"type":"INSERT","lineNumber":204,"content":"    final oauthCredential = OAuthProvider('apple.com').credential("},{"type":"DELETE","lineNumber":205,"oldContent":"    );"},{"type":"DELETE","lineNumber":207,"oldContent":""},{"type":"DELETE","lineNumber":208,"oldContent":"    final oauthCredential = OAuthProvider('apple.com').credential("},{"type":"INSERT","lineNumber":224,"content":"    if (!digits.startsWith('+')) {"},{"type":"DELETE","lineNumber":228,"oldContent":"    if (!digits.startsWith('+')) {"},{"type":"INSERT","lineNumber":235,"content":"  }"},{"type":"INSERT","lineNumber":236,"content":""},{"type":"INSERT","lineNumber":237,"content":"  @override"},{"type":"INSERT","lineNumber":238,"content":"  Future<String> sendOtpToPhoneNumber({required String phoneNumber}) async {"},{"type":"INSERT","lineNumber":239,"content":"    final completer = Completer<String>();"},{"type":"INSERT","lineNumber":240,"content":"    "},{"type":"INSERT","lineNumber":241,"content":"    try {"},{"type":"DELETE","lineNumber":237,"oldContent":"  }"},{"type":"DELETE","lineNumber":239,"oldContent":""},{"type":"DELETE","lineNumber":241,"oldContent":"  @override"},{"type":"DELETE","lineNumber":243,"oldContent":"  Future<String> sendOtpToPhoneNumber({required String phoneNumber}) async {"},{"type":"DELETE","lineNumber":245,"oldContent":"    final completer = Completer<String>();"},{"type":"DELETE","lineNumber":247,"oldContent":"    "},{"type":"DELETE","lineNumber":249,"oldContent":"    try {"},{"type":"INSERT","lineNumber":260,"content":"      }"},{"type":"INSERT","lineNumber":261,"content":"      "},{"type":"DELETE","lineNumber":268,"oldContent":"      }"},{"type":"DELETE","lineNumber":269,"oldContent":"      "},{"type":"INSERT","lineNumber":274,"content":"      await _firebaseAuth.verifyPhoneNumber("},{"type":"INSERT","lineNumber":275,"content":"        phoneNumber: formattedPhoneNumber,"},{"type":"DELETE","lineNumber":277,"oldContent":"      await _firebaseAuth.verifyPhoneNumber("},{"type":"DELETE","lineNumber":279,"oldContent":"        phoneNumber: formattedPhoneNumber,"},{"type":"DELETE","lineNumber":302,"oldContent":"          "},{"type":"DELETE","lineNumber":304,"oldContent":"            case 'invalid-verification-code':"},{"type":"DELETE","lineNumber":306,"oldContent":"              errorMessage = 'Invalid verification code';"},{"type":"DELETE","lineNumber":308,"oldContent":"              break;"},{"type":"DELETE","lineNumber":309,"oldContent":"            case 'session-expired':"},{"type":"INSERT","lineNumber":305,"content":"          "},{"type":"DELETE","lineNumber":311,"oldContent":"              errorMessage = 'The SMS code has expired. Please request a new one.';"},{"type":"DELETE","lineNumber":313,"oldContent":"              break;"},{"type":"DELETE","lineNumber":315,"oldContent":"          if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":318,"oldContent":"            completer.completeError("},{"type":"DELETE","lineNumber":322,"oldContent":"              FirebaseAuthException("},{"type":"DELETE","lineNumber":324,"oldContent":"                code: e.code,"},{"type":"DELETE","lineNumber":328,"oldContent":"                message: errorMessage,"},{"type":"DELETE","lineNumber":329,"oldContent":"              ),"},{"type":"DELETE","lineNumber":330,"oldContent":"            );"},{"type":"INSERT","lineNumber":318,"content":"            case 'invalid-verification-code':"},{"type":"INSERT","lineNumber":319,"content":"              errorMessage = 'Invalid verification code';"},{"type":"INSERT","lineNumber":320,"content":"              break;"},{"type":"INSERT","lineNumber":321,"content":"            case 'session-expired':"},{"type":"INSERT","lineNumber":322,"content":"              errorMessage = 'The SMS code has expired. Please request a new one.';"},{"type":"INSERT","lineNumber":323,"content":"              break;"},{"type":"DELETE","lineNumber":332,"oldContent":"          }"},{"type":"INSERT","lineNumber":328,"content":"          if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":329,"content":"            completer.completeError("},{"type":"INSERT","lineNumber":330,"content":"              FirebaseAuthException("},{"type":"INSERT","lineNumber":331,"content":"                code: e.code,"},{"type":"INSERT","lineNumber":332,"content":"                message: errorMessage,"},{"type":"INSERT","lineNumber":333,"content":"              ),"},{"type":"INSERT","lineNumber":334,"content":"            );"},{"type":"INSERT","lineNumber":335,"content":"          }"},{"type":"MODIFY","lineNumber":386,"content":"    );","oldContent":"    );"},{"type":"DELETE","lineNumber":388,"oldContent":"      _firebaseAuth.signOut(),"},{"type":"DELETE","lineNumber":390,"oldContent":"      _googleSignIn.signOut(),"},{"type":"DELETE","lineNumber":393,"oldContent":"    ]);"},{"type":"DELETE","lineNumber":395,"oldContent":"  }"},{"type":"INSERT","lineNumber":394,"content":"      _firebaseAuth.signOut(),"},{"type":"INSERT","lineNumber":395,"content":"      _googleSignIn.signOut(),"},{"type":"INSERT","lineNumber":396,"content":"    ]);"},{"type":"INSERT","lineNumber":397,"content":"  }"},{"type":"INSERT","lineNumber":399,"content":"  @override"},{"type":"DELETE","lineNumber":402,"oldContent":"  @override"},{"type":"DELETE","lineNumber":416,"oldContent":"    }"},{"type":"INSERT","lineNumber":417,"content":"    await user.updateDisplayName(displayName);"},{"type":"INSERT","lineNumber":418,"content":"    if (photoUrl != null) {"},{"type":"INSERT","lineNumber":419,"content":"      await user.updatePhotoURL(photoUrl);"},{"type":"INSERT","lineNumber":420,"content":"    }"},{"type":"INSERT","lineNumber":421,"content":"    if (phoneNumber != null) {"},{"type":"INSERT","lineNumber":422,"content":"      // Note: Updating phone number requires re-authentication"},{"type":"INSERT","lineNumber":423,"content":"      // This is a simplified example - in a real app, you'd need to handle re-authentication"},{"type":"INSERT","lineNumber":424,"content":"      throw UnimplementedError('Phone number update not implemented');"},{"type":"INSERT","lineNumber":425,"content":"    }"},{"type":"DELETE","lineNumber":420,"oldContent":"    await user.updateDisplayName(displayName);"},{"type":"DELETE","lineNumber":423,"oldContent":"    if (photoUrl != null) {"},{"type":"DELETE","lineNumber":426,"oldContent":"      await user.updatePhotoURL(photoUrl);"},{"type":"DELETE","lineNumber":429,"oldContent":"    }"},{"type":"DELETE","lineNumber":432,"oldContent":"    if (phoneNumber != null) {"},{"type":"DELETE","lineNumber":435,"oldContent":"      // Note: Updating phone number requires re-authentication"},{"type":"DELETE","lineNumber":438,"oldContent":"      // This is a simplified example - in a real app, you'd need to handle re-authentication"},{"type":"DELETE","lineNumber":440,"oldContent":"      throw UnimplementedError('Phone number update not implemented');"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/data/repositories/auth_repository_impl.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/data/repositories/auth_repository_impl.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:family_tree_firebase/core/error/exceptions.dart';\nimport 'package:family_tree_firebase/features/auth/data/datasources/auth_remote_data_source.dart';\nimport 'package:family_tree_firebase/features/auth/domain/entities/user_entity.dart';\nimport 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';\nimport 'package:family_tree_firebase/features/auth/domain/repositories/auth_repository.dart';\n\nclass AuthRepositoryImpl implements AuthRepository {\n  final AuthRemoteDataSource remoteDataSource;\n\n  AuthRepositoryImpl({required this.remoteDataSource});\n\n  @override\n  Future<bool> isSignedIn() async {\n    try {\n      return await remoteDataSource.isSignedIn();\n    } catch (e) {\n      return false;\n    }\n  }\n\n  @override\n  Future<Option<UserEntity>> getCurrentUser() async {\n    try {\n      final user = await remoteDataSource.getCurrentUser();\n      if (user == null) {\n        return const None();\n      }\n      return optionOf(user.toEntity());\n    } catch (e) {\n      return const None();\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, Unit>> signInWithEmailAndPassword({\n    required String email,\n    required String password,\n  }) async {\n    try {\n      await remoteDataSource.signInWithEmailAndPassword(\n        email: email,\n        password: password,\n      );\n      return const Right(unit);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } catch (e) {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, Unit>> registerWithEmailAndPassword({\n    required String email,\n    required String password,\n    required String displayName,\n    String? phoneNumber,\n  }) async {\n    try {\n      await remoteDataSource.registerWithEmailAndPassword(\n        email: email,\n        password: password,\n        displayName: displayName,\n        phoneNumber: phoneNumber,\n      );\n      return const Right(unit);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } catch (e) {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, Unit>> signInWithGoogle() async {\n    try {\n      await remoteDataSource.signInWithGoogle();\n      return const Right(unit);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } on Exception {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, Unit>> signInWithApple() async {\n    try {\n      await remoteDataSource.signInWithApple();\n      return const Right(unit);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } on Exception {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, String>> sendOtpToPhoneNumber({\n    required String phoneNumber,\n  }) async {\n    try {\n      final verificationId = await remoteDataSource.sendOtpToPhoneNumber(\n        phoneNumber: phoneNumber,\n      );\n      return Right(verificationId);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } on Exception {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, Unit>> verifyOtp({\n    required String verificationId,\n    required String smsCode,\n  }) async {\n    try {\n      await remoteDataSource.verifyOtp(\n        verificationId: verificationId,\n        smsCode: smsCode,\n      );\n      return const Right(unit);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } on Exception {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, Unit>> signOut() async {\n    try {\n      await remoteDataSource.signOut();\n      return const Right(unit);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } on Exception {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, String>> getAuthToken() async {\n    try {\n      final token = await remoteDataSource.getAuthToken();\n      return Right(token);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } on Exception {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, Unit>> updateUserProfile({\n    String? displayName,\n    String? photoUrl,\n    String? phoneNumber,\n  }) async {\n    try {\n      await remoteDataSource.updateUserProfile(\n        displayName: displayName,\n        photoUrl: photoUrl,\n        phoneNumber: phoneNumber,\n      );\n      return const Right(unit);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } on Exception {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, Unit>> sendPasswordResetEmail(String email) async {\n    try {\n      await remoteDataSource.sendPasswordResetEmail(email);\n      return const Right(unit);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } on Exception {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  @override\n  Future<Either<AuthFailure, Unit>> deleteAccount() async {\n    try {\n      await remoteDataSource.deleteAccount();\n      return const Right(unit);\n    } on FirebaseAuthException catch (e) {\n      return Left(_handleFirebaseAuthException(e));\n    } on Exception {\n      return const Left(UnexpectedFailure());\n    }\n  }\n\n  AuthFailure _handleFirebaseAuthException(FirebaseAuthException e) {\n    switch (e.code) {\n      case 'invalid-email':\n        return const InvalidEmailFailure();\n      case 'user-disabled':\n        return const UserDisabledFailure();\n      case 'user-not-found':\n        return const UserNotFoundFailure();\n      case 'wrong-password':\n        return const InvalidPasswordFailure();\n      case 'email-already-in-use':\n        return const EmailAlreadyInUseFailure();\n      case 'operation-not-allowed':\n      case 'account-exists-with-different-credential':\n      case 'auth-domain-config-required':\n      case 'cancelled-popup-request':\n      case 'popup-blocked':\n      case 'popup-closed-by-user':\n      case 'unauthorized-domain':\n      case 'web-storage-unsupported':\n        return const UnexpectedFailure();\n      case 'invalid-verification-code':\n        return const InvalidVerificationCodeFailure();\n      case 'invalid-verification-id':\n      case 'session-expired':\n        return const SessionExpiredFailure();\n      case 'network-request-failed':\n        return const NetworkFailure();\n      default:\n        return const UnexpectedFailure();\n    }\n  }\n}\n","baseTimestamp":1754512173608,"deltas":[{"timestamp":1754515862199,"changes":[{"type":"MODIFY","lineNumber":29,"content":"      return optionOf(user);","oldContent":"      return optionOf(user.toEntity());"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/register_with_email_and_password.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/register_with_email_and_password.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/features/auth/domain/repositories/auth_repository.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';\n\nclass RegisterWithEmailAndPassword implements UseCase<Unit, RegisterWithEmailAndPasswordParams> {\n  final AuthRepository repository;\n\n  const RegisterWithEmailAndPassword(this.repository);\n\n  @override\n  Future<Either<AuthFailure, Unit>> call(RegisterWithEmailAndPasswordParams params) async {\n    return await repository.registerWithEmailAndPassword(\n      email: params.email,\n      password: params.password,\n      displayName: params.displayName,\n      phoneNumber: params.phoneNumber,\n    );\n  }\n}\n\nclass RegisterWithEmailAndPasswordParams {\n  final String email;\n  final String password;\n  final String displayName;\n  final String? phoneNumber;\n\n  const RegisterWithEmailAndPasswordParams({\n    required this.email,\n    required this.password,\n    required this.displayName,\n    this.phoneNumber, required String name,\n  });\n}\n","baseTimestamp":1754513070488,"deltas":[{"timestamp":1754513077151,"changes":[{"type":"MODIFY","lineNumber":31,"content":"    this.phoneNumber, required String name, String? phone,","oldContent":"    this.phoneNumber, required String name,"}]},{"timestamp":1754592688247,"changes":[{"type":"MODIFY","lineNumber":31,"content":"    this.phoneNumber,","oldContent":"    this.phoneNumber, required String name, String? phone,"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/data/models/family_model.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/data/models/family_model.dart","baseContent":"import 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:equatable/equatable.dart';\nimport 'package:family_tree_firebase/features/family/domain/entities/family.dart';\n\nclass FamilyModel extends Family {\n  const FamilyModel({\n    required String id,\n    required String name,\n    required String createdBy,\n    required DateTime createdAt,\n    List<String> memberIds = const [],\n    Map<String, DateTime> memberJoinDates = const {},\n    String? currentInviteCode,\n    DateTime? inviteCodeExpiresAt, required String adminId,\n  }) : super(\n          id: id,\n          name: name,\n          createdBy: createdBy,\n          createdAt: createdAt,\n          memberIds: memberIds,\n          memberJoinDates: memberJoinDates,\n          currentInviteCode: currentInviteCode,\n          inviteCodeExpiresAt: inviteCodeExpiresAt,\n        );\n\n  /// Creates a FamilyModel from a JSON map\n  factory FamilyModel.fromJson(Map<String, dynamic> json) {\n    // Handle Timestamp to DateTime conversion\n    final createdAt = json['createdAt'] is Timestamp\n        ? (json['createdAt'] as Timestamp).toDate()\n        : DateTime.parse(json['createdAt'].toString());\n\n    // Handle member join dates\n    final memberJoinDates = <String, DateTime>{};\n    if (json['memberJoinDates'] != null) {\n      (json['memberJoinDates'] as Map<String, dynamic>).forEach((key, value) {\n        memberJoinDates[key] = value is Timestamp\n            ? value.toDate()\n            : DateTime.parse(value.toString());\n      });\n    }\n\n    // Handle invite code expiry\n    DateTime? inviteCodeExpiresAt;\n    if (json['inviteCodeExpiresAt'] != null) {\n      inviteCodeExpiresAt = json['inviteCodeExpiresAt'] is Timestamp\n          ? (json['inviteCodeExpiresAt'] as Timestamp).toDate()\n          : DateTime.parse(json['inviteCodeExpiresAt'].toString());\n    }\n\n    return FamilyModel(\n      id: json['id'] as String,\n      name: json['name'] as String,\n      createdBy: json['createdBy'] as String,\n      createdAt: createdAt,\n      memberIds: List<String>.from(json['memberIds'] as List? ?? []),\n      memberJoinDates: memberJoinDates,\n      currentInviteCode: json['currentInviteCode'] as String?,\n      inviteCodeExpiresAt: inviteCodeExpiresAt,\n    );\n  }\n\n  /// Converts the FamilyModel to a JSON map\n  Map<String, dynamic> toJson() {\n    return {\n      'id': id,\n      'name': name,\n      'createdBy': createdBy,\n      'createdAt': Timestamp.fromDate(createdAt),\n      'memberIds': memberIds,\n      'memberJoinDates': {\n        for (var entry in memberJoinDates.entries)\n          entry.key: Timestamp.fromDate(entry.value),\n      },\n      'currentInviteCode': currentInviteCode,\n      'inviteCodeExpiresAt': inviteCodeExpiresAt != null\n          ? Timestamp.fromDate(inviteCodeExpiresAt!)\n          : null,\n    };\n  }\n\n  /// Creates a copy of this model with the given fields replaced with the new values\n  @override\n  FamilyModel copyWith({\n    String? id,\n    String? name,\n    String? createdBy,\n    DateTime? createdAt,\n    List<String>? memberIds,\n    Map<String, DateTime>? memberJoinDates,\n    String? currentInviteCode,\n    DateTime? inviteCodeExpiresAt,\n  }) {\n    return FamilyModel(\n      id: id ?? this.id,\n      name: name ?? this.name,\n      createdBy: createdBy ?? this.createdBy,\n      createdAt: createdAt ?? this.createdAt,\n      memberIds: memberIds ?? this.memberIds,\n      memberJoinDates: memberJoinDates ?? this.memberJoinDates,\n      currentInviteCode: currentInviteCode ?? this.currentInviteCode,\n      inviteCodeExpiresAt: inviteCodeExpiresAt ?? this.inviteCodeExpiresAt,\n    );\n  }\n}\n","baseTimestamp":1754513165805,"deltas":[{"timestamp":1754513173042,"changes":[{"type":"MODIFY","lineNumber":58,"content":"      inviteCodeExpiresAt: inviteCodeExpiresAt, adminId: '',","oldContent":"      inviteCodeExpiresAt: inviteCodeExpiresAt,"}]},{"timestamp":1754513179449,"changes":[{"type":"MODIFY","lineNumber":101,"content":"      inviteCodeExpiresAt: inviteCodeExpiresAt ?? this.inviteCodeExpiresAt, adminId: '',","oldContent":"      inviteCodeExpiresAt: inviteCodeExpiresAt ?? this.inviteCodeExpiresAt,"}]},{"timestamp":1754513187607,"changes":[{"type":"MODIFY","lineNumber":13,"content":"    DateTime? inviteCodeExpiresAt, required String adminId, required DateTime updatedAt,","oldContent":"    DateTime? inviteCodeExpiresAt, required String adminId,"}]},{"timestamp":1754513194085,"changes":[{"type":"MODIFY","lineNumber":58,"content":"      inviteCodeExpiresAt: inviteCodeExpiresAt, adminId: '', updatedAt: null,","oldContent":"      inviteCodeExpiresAt: inviteCodeExpiresAt, adminId: '',"}]},{"timestamp":1754513204310,"changes":[{"type":"MODIFY","lineNumber":101,"content":"      inviteCodeExpiresAt: inviteCodeExpiresAt ?? this.inviteCodeExpiresAt, adminId: '', updatedAt: null,","oldContent":"      inviteCodeExpiresAt: inviteCodeExpiresAt ?? this.inviteCodeExpiresAt, adminId: '',"}]},{"timestamp":1754513210791,"changes":[{"type":"MODIFY","lineNumber":58,"content":"      inviteCodeExpiresAt: inviteCodeExpiresAt, adminId: '', updatedAt: ,","oldContent":"      inviteCodeExpiresAt: inviteCodeExpiresAt, adminId: '', updatedAt: null,"}]},{"timestamp":1754513214444,"changes":[{"type":"MODIFY","lineNumber":58,"content":"      inviteCodeExpiresAt: inviteCodeExpiresAt, adminId: '', updatedAt: null,","oldContent":"      inviteCodeExpiresAt: inviteCodeExpiresAt, adminId: '', updatedAt: ,"}]},{"timestamp":1754515996910,"changes":[{"type":"INSERT","lineNumber":92,"content":"    DateTime? updatedAt,"},{"type":"MODIFY","lineNumber":102,"content":"      inviteCodeExpiresAt: inviteCodeExpiresAt ?? this.inviteCodeExpiresAt,","oldContent":"      inviteCodeExpiresAt: inviteCodeExpiresAt ?? this.inviteCodeExpiresAt, adminId: '', updatedAt: null,"},{"type":"INSERT","lineNumber":103,"content":"      adminId: '', "},{"type":"INSERT","lineNumber":104,"content":"      updatedAt: updatedAt ?? this.updatedAt,"}]},{"timestamp":1754516092102,"changes":[{"type":"INSERT","lineNumber":5,"content":"  final String id;"},{"type":"INSERT","lineNumber":6,"content":"  final String name;"},{"type":"INSERT","lineNumber":7,"content":"  final String createdBy;"},{"type":"INSERT","lineNumber":8,"content":"  final DateTime createdAt;"},{"type":"INSERT","lineNumber":9,"content":"  final List<String> memberIds;"},{"type":"INSERT","lineNumber":10,"content":"  final Map<String, DateTime> memberJoinDates;"},{"type":"INSERT","lineNumber":11,"content":"  final String? currentInviteCode;"},{"type":"INSERT","lineNumber":12,"content":"  final DateTime? inviteCodeExpiresAt;"},{"type":"INSERT","lineNumber":13,"content":"  final String adminId;"},{"type":"INSERT","lineNumber":14,"content":"  final DateTime updatedAt;"},{"type":"INSERT","lineNumber":15,"content":""},{"type":"DELETE","lineNumber":6,"oldContent":"    required String id,"},{"type":"DELETE","lineNumber":7,"oldContent":"    required String name,"},{"type":"DELETE","lineNumber":8,"oldContent":"    required String createdBy,"},{"type":"DELETE","lineNumber":9,"oldContent":"    required DateTime createdAt,"},{"type":"DELETE","lineNumber":10,"oldContent":"    List<String> memberIds = const [],"},{"type":"DELETE","lineNumber":11,"oldContent":"    Map<String, DateTime> memberJoinDates = const {},"},{"type":"DELETE","lineNumber":12,"oldContent":"    String? currentInviteCode,"},{"type":"DELETE","lineNumber":13,"oldContent":"    DateTime? inviteCodeExpiresAt, required String adminId, required DateTime updatedAt,"},{"type":"INSERT","lineNumber":17,"content":"    required this.id,"},{"type":"INSERT","lineNumber":18,"content":"    required this.name,"},{"type":"INSERT","lineNumber":19,"content":"    required this.createdBy,"},{"type":"INSERT","lineNumber":20,"content":"    required this.createdAt,"},{"type":"INSERT","lineNumber":21,"content":"    required this.memberIds,"},{"type":"INSERT","lineNumber":22,"content":"    required this.memberJoinDates,"},{"type":"INSERT","lineNumber":23,"content":"    this.currentInviteCode,"},{"type":"INSERT","lineNumber":24,"content":"    this.inviteCodeExpiresAt,"},{"type":"INSERT","lineNumber":25,"content":"    required this.adminId,"},{"type":"INSERT","lineNumber":26,"content":"    required this.updatedAt,"},{"type":"DELETE","lineNumber":58,"oldContent":"      inviteCodeExpiresAt: inviteCodeExpiresAt, adminId: '', updatedAt: null,"},{"type":"INSERT","lineNumber":71,"content":"      inviteCodeExpiresAt: inviteCodeExpiresAt,"},{"type":"INSERT","lineNumber":72,"content":"      adminId: json['adminId'] as String,"},{"type":"INSERT","lineNumber":73,"content":"      updatedAt: json['updatedAt'].toDate(),"},{"type":"INSERT","lineNumber":93,"content":"      'adminId': adminId,"},{"type":"INSERT","lineNumber":94,"content":"      'updatedAt': Timestamp.fromDate(updatedAt),"},{"type":"INSERT","lineNumber":109,"content":"    String? adminId,"},{"type":"DELETE","lineNumber":102,"oldContent":"      inviteCodeExpiresAt: inviteCodeExpiresAt ?? this.inviteCodeExpiresAt, adminId: '', updatedAt: null,"},{"type":"DELETE","lineNumber":104,"oldContent":"      adminId: '', "},{"type":"DELETE","lineNumber":105,"oldContent":"  }"},{"type":"INSERT","lineNumber":121,"content":"      adminId: adminId ?? this.adminId,"},{"type":"INSERT","lineNumber":123,"content":"    );"},{"type":"INSERT","lineNumber":124,"content":"  }"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/failures/auth_failure.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/failures/auth_failure.dart","baseContent":"import 'package:equatable/equatable.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\n\nabstract class AuthFailure extends Failure {\n  const AuthFailure(String message, [StackTrace? stackTrace]) : super(message, stackTrace);\n}\n\n// Email/Password Failures\nclass InvalidEmailFailure extends AuthFailure {\n  const InvalidEmailFailure() : super('Please enter a valid email address');\n}\n\nclass InvalidPasswordFailure extends AuthFailure {\n  const InvalidPasswordFailure() : super('Password must be at least 6 characters');\n}\n\n// User Failures\nclass UserDisabledFailure extends AuthFailure {\n  const UserDisabledFailure() : super('This account has been disabled');\n}\n\nclass UserNotFoundFailure extends AuthFailure {\n  const UserNotFoundFailure() : super('No user found with these credentials');\n}\n\nclass EmailAlreadyInUseFailure extends AuthFailure {\n  const EmailAlreadyInUseFailure() : super('An account already exists with this email');\n}\n\n// OTP Failures\nclass InvalidVerificationCodeFailure extends AuthFailure {\n  const InvalidVerificationCodeFailure() : super('The verification code is invalid');\n}\n\nclass SessionExpiredFailure extends AuthFailure {\n  const SessionExpiredFailure() : super('The verification code has expired');\n}\n\n// Server/Network Failures\nclass ServerFailure extends AuthFailure {\n  const ServerFailure() : super('An error occurred. Please try again later.');\n}\n\nclass NetworkFailure extends AuthFailure {\n  const NetworkFailure() : super('No internet connection');\n}\n\n// Generic Failure\nclass UnexpectedFailure extends AuthFailure {\n  const UnexpectedFailure() : super('An unexpected error occurred');\n}\n","baseTimestamp":1754515035103},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/splash/presentation/viewmodels/splash_viewmodel.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/splash/presentation/viewmodels/splash_viewmodel.dart","baseContent":"import 'package:flutter/foundation.dart';\nimport 'package:family_tree_firebase/core/base/base_viewmodel.dart';\nimport 'package:family_tree_firebase/features/auth/domain/usecases/check_auth_status.dart';\n\nimport '../../../../core/usecases/usecase.dart';\n\nclass SplashViewModel extends BaseViewModel {\n  final CheckAuthStatus checkAuthStatus;\n  \n  SplashViewModel({required this.checkAuthStatus});\n  \n  Future<bool> checkAuthentication() async {\n    try {\n      setLoading(true);\n      final result = await checkAuthStatus(NoParams());\n      return result.fold(\n        (failure) => false,\n        (user) => user != null,\n      );\n    } catch (e) {\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }\n}\n","baseTimestamp":1754515419332},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/send_password_reset_email.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/domain/usecases/send_password_reset_email.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/auth/domain/failures/auth_failure.dart';\nimport 'package:family_tree_firebase/features/auth/domain/repositories/auth_repository.dart';\n\nclass SendPasswordResetEmailParams {\n  final String email;\n\n  const SendPasswordResetEmailParams({required this.email});\n}\n\nclass SendPasswordResetEmail implements UseCase<Unit, SendPasswordResetEmailParams> {\n  final AuthRepository repository;\n\n  SendPasswordResetEmail(this.repository);\n\n  @override\n  Future<Either<AuthFailure, Unit>> call(SendPasswordResetEmailParams params) async {\n    return await repository.sendPasswordResetEmail(params.email);\n  }\n}\n","baseTimestamp":1754515504392},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/di/family_injection_container.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/di/family_injection_container.dart","baseContent":"import 'package:get_it/get_it.dart';\nimport 'package:injectable/injectable.dart';\n\nimport '../data/datasources/family_remote_data_source.dart';\nimport '../data/datasources/family_remote_data_source_impl.dart';\nimport '../data/repositories/family_repository_impl.dart';\nimport '../domain/repositories/family_repository.dart';\nimport '../domain/usecases/check_family_membership.dart';\nimport '../domain/usecases/create_family.dart';\nimport '../domain/usecases/generate_invite_code.dart';\nimport '../domain/usecases/get_current_family.dart';\nimport '../domain/usecases/join_family.dart';\nimport '../domain/usecases/validate_invite_code.dart';\nimport '../presentation/viewmodels/family_viewmodel.dart';\n\nfinal sl = GetIt.instance;\n\n@injectableInit\nFuture<void> initFamilyFeature() async {\n  // ViewModel\n  sl.registerFactory(\n    () => FamilyViewModel(\n      createFamily: sl(),\n      getCurrentFamily: sl(),\n      generateInviteCode: sl(),\n      joinFamily: sl(),\n      checkFamilyMembership: sl(),\n    ),\n  );\n\n  // Use cases\n  sl.registerLazySingleton(() => CheckFamilyMembership(sl()));\n  sl.registerLazySingleton(() => CreateFamily(sl()));\n  sl.registerLazySingleton(() => JoinFamily(sl()));\n  sl.registerLazySingleton(() => ValidateInviteCode(sl()));\n  sl.registerLazySingleton(() => GenerateInviteCode(sl()));\n  sl.registerLazySingleton(() => GetCurrentFamily(sl()));\n\n  // Repository\n  sl.registerLazySingleton<FamilyRepository>(\n    () => FamilyRepositoryImpl(remoteDataSource: sl(), firebaseAuth: sl()),\n  );\n\n  // Data sources\n  sl.registerLazySingleton<FamilyRemoteDataSource>(\n    () => FamilyRemoteDataSourceImpl(\n      firestore: sl(),\n      firebaseAuth: sl(),\n    ),\n  );\n}\n","baseTimestamp":1754515719867,"deltas":[{"timestamp":1754516285811,"changes":[{"type":"INSERT","lineNumber":27,"content":"      validateInviteCode: sl(),"}]},{"timestamp":1754516321049,"changes":[{"type":"DELETE","lineNumber":4,"oldContent":"import '../data/datasources/family_remote_data_source_impl.dart';"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/data/datasources/family_remote_data_source.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/data/datasources/family_remote_data_source.dart","baseContent":"import 'dart:async';\nimport 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/error/exception.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/features/family/data/models/family_model.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\n\nabstract class FamilyRemoteDataSource {\n  Future<FamilyModel> createFamily(String familyName, String createdBy);\n  Future<FamilyModel> joinFamily(String inviteCode, String userId);\n  Future<FamilyModel?> getCurrentFamily(String userId);\n  Future<bool> validateInviteCode(String inviteCode);\n  Future<String> generateNewInviteCode(String familyId);\n  Future<bool> checkFamilyMembership(String userId);\n}\n\nclass FamilyRemoteDataSourceImpl implements FamilyRemoteDataSource {\n  final FirebaseFirestore firestore;\n  final FirebaseAuth firebaseAuth;\n\n  FamilyRemoteDataSourceImpl({\n    required this.firestore,\n    required this.firebaseAuth,\n  });\n\n  @override\n  Future<FamilyModel> createFamily(String familyName, String createdBy) async {\n    try {\n      final currentUser = firebaseAuth.currentUser;\n      if (currentUser == null || currentUser.uid != createdBy) {\n        throw const ServerException('User not authenticated');\n      }\n\n      // Check if user is already in a family\n      final userDoc = await firestore.collection('users').doc(createdBy).get();\n      if (userDoc.exists && userDoc.data()?['familyId'] != null) {\n        throw const ServerException('User already in a family');\n      }\n\n      // Generate a unique family ID\n      final familyRef = firestore.collection('families').doc();\n      \n      // Generate initial invite code\n      final inviteCode = await _generateUniqueInviteCode();\n      \n      // Create family data\n      final familyData = {\n        'id': familyRef.id,\n        'name': familyName,\n        'createdBy': createdBy,\n        'createdAt': FieldValue.serverTimestamp(),\n        'memberIds': [createdBy],\n        'memberJoinDates': {\n          createdBy: FieldValue.serverTimestamp(),\n        },\n        'currentInviteCode': inviteCode,\n        'inviteCodeExpiresAt': _getInviteCodeExpiry(),\n        'inviteCodesHistory': [inviteCode],\n      };\n\n      // Start a batch write to ensure data consistency\n      final batch = firestore.batch();\n      \n      // Create family document\n      batch.set(familyRef, familyData);\n      \n      // Update user document with family ID\n      batch.set(\n        firestore.collection('users').doc(createdBy),\n        {'familyId': familyRef.id},\n        SetOptions(merge: true),\n      );\n      \n      // Commit the batch\n      await batch.commit();\n\n      return FamilyModel.fromJson(familyData);\n    } on FirebaseException catch (e) {\n      throw ServerException(e.message ?? 'Failed to create family');\n    } on ServerException {\n      rethrow;\n    } catch (e) {\n      throw ServerException('Unexpected error: $e');\n    }\n  }\n\n  @override\n  Future<FamilyModel> joinFamily(String inviteCode, String userId) async {\n    try {\n      // Find family with the given invite code\n      final querySnapshot = await firestore\n          .collection('families')\n          .where('currentInviteCode', isEqualTo: inviteCode)\n          .limit(1)\n          .get();\n\n      if (querySnapshot.docs.isEmpty) {\n        throw const ServerException('Invalid or expired invite code');\n      }\n\n      final familyDoc = querySnapshot.docs.first;\n      final familyData = familyDoc.data();\n      final familyId = familyDoc.id;\n      \n      // Check if invite code is expired\n      final expiryTimestamp = familyData['inviteCodeExpiresAt'] as Timestamp?;\n      if (expiryTimestamp == null || expiryTimestamp.toDate().isBefore(DateTime.now())) {\n        throw const ServerException('Invite code has expired');\n      }\n      \n      // Check if user is already in this family\n      final memberIds = List<String>.from(familyData['memberIds'] ?? []);\n      if (memberIds.contains(userId)) {\n        throw const ServerException('You are already a member of this family');\n      }\n      \n      // Start a batch write to ensure data consistency\n      final batch = firestore.batch();\n      \n      // Update family document to add the new member\n      batch.update(familyDoc.reference, {\n        'memberIds': FieldValue.arrayUnion([userId]),\n        'memberJoinDates.${userId}': FieldValue.serverTimestamp(),\n      });\n      \n      // Update user document with family ID\n      batch.set(\n        firestore.collection('users').doc(userId),\n        {'familyId': familyId},\n        SetOptions(merge: true),\n      );\n      \n      // Commit the batch\n      await batch.commit();\n      \n      // Return the updated family data\n      return FamilyModel.fromJson({\n        ...familyData,\n        'id': familyId,\n        'memberIds': [...memberIds, userId],\n      });\n    } on FirebaseException catch (e) {\n      throw ServerException(e.message ?? 'Failed to join family');\n    } on ServerException {\n      rethrow;\n    } catch (e) {\n      throw ServerException('Unexpected error: $e');\n    }\n  }\n\n  @override\n  Future<FamilyModel?> getCurrentFamily(String userId) async {\n    try {\n      // Get user document to find family ID\n      final userDoc = await firestore.collection('users').doc(userId).get();\n      final familyId = userDoc.data()?['familyId'] as String?;\n      \n      if (familyId == null) return null;\n      \n      // Get family document\n      final familyDoc = await firestore.collection('families').doc(familyId).get();\n      if (!familyDoc.exists) return null;\n      \n      return FamilyModel.fromJson({\n        ...?familyDoc.data(),\n        'id': familyDoc.id,\n      });\n    } on FirebaseException catch (e) {\n      throw ServerException(e.message ?? 'Failed to get family');\n    } catch (e) {\n      throw ServerException('Unexpected error: $e');\n    }\n  }\n\n  @override\n  Future<bool> validateInviteCode(String inviteCode) async {\n    try {\n      final querySnapshot = await firestore\n          .collection('families')\n          .where('currentInviteCode', isEqualTo: inviteCode)\n          .limit(1)\n          .get();\n\n      if (querySnapshot.docs.isEmpty) return false;\n      \n      final familyData = querySnapshot.docs.first.data();\n      final expiryTimestamp = familyData['inviteCodeExpiresAt'] as Timestamp?;\n      \n      // Check if invite code is expired\n      return expiryTimestamp != null && expiryTimestamp.toDate().isAfter(DateTime.now());\n    } catch (e) {\n      return false;\n    }\n  }\n\n  @override\n  Future<String> generateNewInviteCode(String familyId) async {\n    try {\n      final newCode = await _generateUniqueInviteCode();\n      \n      await firestore.collection('families').doc(familyId).update({\n        'currentInviteCode': newCode,\n        'inviteCodeExpiresAt': _getInviteCodeExpiry(),\n        'inviteCodesHistory': FieldValue.arrayUnion([newCode]),\n      });\n      \n      return newCode;\n    } on FirebaseException catch (e) {\n      throw ServerException(e.message ?? 'Failed to generate invite code');\n    } catch (e) {\n      throw ServerException('Unexpected error: $e');\n    }\n  }\n  \n  // Helper method to generate a unique invite code\n  Future<String> _generateUniqueInviteCode() async {\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n    final random = DateTime.now().millisecondsSinceEpoch;\n    String code;\n    bool isUnique = false;\n    \n    // Try up to 5 times to generate a unique code\n    for (int i = 0; i < 5 && !isUnique; i++) {\n      // Generate a random 8-character code\n      code = String.fromCharCodes(\n        Iterable.generate(8, (index) => chars.codeUnitAt((random + index + i) % chars.length)),\n      );\n      \n      // Check if code is already in use\n      final querySnapshot = await firestore\n          .collection('families')\n          .where('currentInviteCode', isEqualTo: code)\n          .limit(1)\n          .get();\n      \n      if (querySnapshot.docs.isEmpty) {\n        return code;\n      }\n    }\n    \n    // If we couldn't find a unique code after several attempts\n    throw const ServerException('Failed to generate a unique invite code');\n  }\n  \n  // Helper method to get the expiry date for an invite code (7 days from now)\n  DateTime _getInviteCodeExpiry() {\n    return DateTime.now().add(const Duration(days: 7));\n  }\n}\n","baseTimestamp":1754515977431,"deltas":[{"timestamp":1754517024238,"changes":[{"type":"INSERT","lineNumber":215,"content":"  @override"},{"type":"INSERT","lineNumber":216,"content":"  Future<bool> checkFamilyMembership(String userId) async {"},{"type":"INSERT","lineNumber":217,"content":"    final userDoc = await firestore.collection('users').doc(userId).get();"},{"type":"INSERT","lineNumber":218,"content":"    return userDoc.exists && (userDoc.data()!).containsKey('familyId');"},{"type":"INSERT","lineNumber":219,"content":"  }"},{"type":"INSERT","lineNumber":220,"content":""}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/usecases/generate_invite_code.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/usecases/generate_invite_code.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:equatable/equatable.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/usecases/usecase.dart';\nimport 'package:family_tree_firebase/features/family/domain/repositories/family_repository.dart';\n\nclass GenerateInviteCode extends UseCase<String, GenerateInviteCodeParams> {\n  final FamilyRepository repository;\n\n  GenerateInviteCode(this.repository);\n\n  @override\n  Future<Either<Failure, String>> call(GenerateInviteCodeParams params) async {\n    return await repository.generateInviteCode(params.familyId);\n  }\n}\n\nclass GenerateInviteCodeParams extends Equatable {\n  final String familyId;\n\n  const GenerateInviteCodeParams({required this.familyId});\n\n  @override\n  List<Object?> get props => [familyId];\n}\n","baseTimestamp":1754516277598},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/repositories/family_repository.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/domain/repositories/family_repository.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/features/family/domain/entities/family.dart';\n\nabstract class FamilyRepository {\n  /// Creates a new family with the given name and returns the generated invite code\n  Future<Either<Failure, String>> createFamily(String familyName);\n  \n  /// Joins a family using the provided invite code\n  Future<Either<Failure, Family>> joinFamily(String inviteCode);\n  \n  /// Gets the current user's family if they are part of one\n  Future<Either<Failure, Family?>> getCurrentFamily();\n  \n  /// Validates if an invite code is valid and not expired\n  Future<Either<Failure, bool>> validateInviteCode(String inviteCode);\n  \n  /// Generates a new invite code for the current user's family\n  Future<Either<Failure, String>> generateInviteCode(String familyId);\n  \n  /// Checks if the current user is a member of any family\n  Future<Either<Failure, bool>> checkFamilyMembership(String userId);\n}\n","baseTimestamp":1754516447685},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/data/repositories/family_repository_impl.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/family/data/repositories/family_repository_impl.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/error/exceptions.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/features/family/data/datasources/family_remote_data_source.dart';\nimport 'package:family_tree_firebase/features/family/domain/entities/family.dart';\nimport 'package:family_tree_firebase/features/family/domain/repositories/family_repository.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\n\nclass FamilyRepositoryImpl implements FamilyRepository {\n  final FamilyRemoteDataSource remoteDataSource;\n  final FirebaseAuth firebaseAuth;\n\n  FamilyRepositoryImpl({\n    required this.remoteDataSource,\n    required this.firebaseAuth,\n  });\n\n  @override\n  Future<Either<Failure, String>> createFamily(String familyName) async {\n    try {\n      final currentUser = firebaseAuth.currentUser;\n      if (currentUser == null) {\n        return const Left(PermissionDeniedFailure('User not authenticated'));\n      }\n\n      final family = await remoteDataSource.createFamily(\n        familyName,\n        currentUser.uid,\n      );\n      \n      return Right(family.id);\n    } on ServerException catch (e) {\n      return Left(ServerFailure(e.message));\n    } on FirebaseAuthException catch (e) {\n      return Left(AuthenticationFailure(e.message ?? 'Authentication failed'));\n    } catch (e) {\n      return Left(ServerFailure('Failed to create family: $e'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Family>> joinFamily(String inviteCode) async {\n    try {\n      final currentUser = firebaseAuth.currentUser;\n      if (currentUser == null) {\n        return const Left(PermissionDeniedFailure('User not authenticated'));\n      }\n\n      final family = await remoteDataSource.joinFamily(\n        inviteCode,\n        currentUser.uid,\n      );\n      \n      return Right(family);\n    } on ServerException catch (e) {\n      if (e.message.contains('already a member')) {\n        return const Left(AlreadyInFamilyFailure('Already a member of a family'));\n      } else if (e.message.contains('expired') || e.message.contains('Invalid')) {\n        return const Left(InvalidInviteCodeFailure('Invalid or expired invite code'));\n      }\n      return Left(ServerFailure(e.message));\n    } on FirebaseAuthException catch (e) {\n      return Left(AuthenticationFailure(e.message ?? 'Authentication failed'));\n    } catch (e) {\n      return Left(ServerFailure('Failed to join family: $e'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Family?>> getCurrentFamily() async {\n    try {\n      final currentUser = firebaseAuth.currentUser;\n      if (currentUser == null) {\n        return const Left(PermissionDeniedFailure('User not authenticated'));\n      }\n\n      final family = await remoteDataSource.getCurrentFamily(currentUser.uid);\n      return Right(family);\n    } on ServerException catch (e) {\n      return Left(ServerFailure(e.message));\n    } on FirebaseAuthException catch (e) {\n      return Left(AuthenticationFailure(e.message ?? 'Authentication failed'));\n    } catch (e) {\n      return Left(ServerFailure('Failed to get family: $e'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, String>> generateInviteCode(String familyId) async {\n    try {\n      final code = await remoteDataSource.generateNewInviteCode(familyId);\n      return Right(code);\n    } on ServerException catch (e) {\n      return Left(ServerFailure(e.message));\n    } on FirebaseAuthException catch (e) {\n      return Left(AuthenticationFailure(e.message ?? 'Authentication failed'));\n    } catch (e) {\n      return Left(ServerFailure('Failed to generate invite code: $e'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, bool>> validateInviteCode(String inviteCode) async {\n    try {\n      final isValid = await remoteDataSource.validateInviteCode(inviteCode);\n      return Right(isValid);\n    } on ServerException catch (e) {\n      return Left(ServerFailure(e.message));\n    } catch (e) {\n      return Left(ServerFailure('Failed to validate invite code: $e'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, bool>> checkFamilyMembership(String userId) async {\n    try {\n      final currentUser = firebaseAuth.currentUser;\n      if (currentUser == null) {\n        return const Left(PermissionDeniedFailure('User not authenticated'));\n      }\n\n      final isMember = await remoteDataSource.checkFamilyMembership(userId);\n      return Right(isMember);\n    } on ServerException catch (e) {\n      return Left(ServerFailure(e.message));\n    } on FirebaseAuthException catch (e) {\n      return Left(AuthenticationFailure(e.message ?? 'Authentication failed'));\n    } catch (e) {\n      return Left(ServerFailure('Failed to check family membership: $e'));\n    }\n  }\n}\n","baseTimestamp":1754516449618},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/data/repositories/story_repository_impl.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/data/repositories/story_repository_impl.dart","baseContent":"import 'dart:async';\n\nimport 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/error/exceptions.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/network/network_info.dart';\nimport 'package:family_tree_firebase/features/home/data/datasources/story_remote_data_source.dart';\nimport 'package:family_tree_firebase/features/home/domain/entities/story.dart';\nimport 'package:family_tree_firebase/features/home/domain/repositories/story_repository.dart';\nimport 'package:injectable/injectable.dart';\n\n@LazySingleton(as: StoryRepository)\nclass StoryRepositoryImpl implements StoryRepository {\n  final StoryRemoteDataSource remoteDataSource;\n  final NetworkInfo networkInfo;\n\n  StoryRepositoryImpl({\n    required this.remoteDataSource,\n    required this.networkInfo,\n  });\n\n  @override\n  Future<Either<Failure, List<Story>>> getStories({\n    String? familyId,\n    int limit = 20,\n    String? lastStoryId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        final stories = await remoteDataSource.getStories(\n          familyId: familyId,\n          limit: limit,\n          lastStoryId: lastStoryId,\n        );\n        return Right(stories);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n          return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Unexpected error: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Story>> createStory({\n    required String userId,\n    required String userName,\n    String? userAvatar,\n    required List<String> mediaUrls,\n    String? caption,\n    Duration? duration,\n    String? familyId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        final story = await remoteDataSource.createStory(\n          userId: userId,\n          userName: userName,\n          userAvatar: userAvatar,\n          mediaUrls: mediaUrls,\n          caption: caption,\n          duration: duration,\n          familyId: familyId,\n        );\n        return Right(story);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to create story: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Unit>> viewStory({\n    required String storyId,\n    required String userId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        await remoteDataSource.viewStory(\n          storyId: storyId,\n          userId: userId,\n        );\n        return const Right(unit);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to view story: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Unit>> deleteStory({\n    required String storyId,\n    required String userId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        await remoteDataSource.deleteStory(\n          storyId: storyId,\n          userId: userId,\n        );\n        return const Right(unit);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on UnauthorizedException {\n        return const Left(UnauthorizedFailure(message: 'Not authorized to delete this story'));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to delete story: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Unit>> reportStory({\n    required String storyId,\n    required String userId,\n    required String reason,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        await remoteDataSource.reportStory(\n          storyId: storyId,\n          userId: userId,\n          reason: reason,\n        );\n        return const Right(unit);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to report story: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, List<Story>>> getUserStories({\n    required String userId,\n    int limit = 20,\n    String? lastStoryId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        final stories = await remoteDataSource.getUserStories(\n          userId: userId,\n          limit: limit,\n          lastStoryId: lastStoryId,\n        );\n        return Right(stories);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to fetch user stories: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n}\n","baseTimestamp":1754517160055,"deltas":[{"timestamp":1754517162983,"changes":[{"type":"MODIFY","lineNumber":38,"content":"        return const Left(NetworkFailure(message: 'No internet connection'));","oldContent":"          return const Left(NetworkFailure(message: 'No internet connection'));"}]},{"timestamp":1754598448772,"changes":[{"type":"DELETE","lineNumber":35,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":36,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":37,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":38,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":39,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":40,"oldContent":"        return Left(ServerFailure(message: 'Unexpected error: $e'));"},{"type":"INSERT","lineNumber":35,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":36,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":37,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":38,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":39,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":40,"content":"        return Left(ServerFailure('Unexpected error: $e', stackTrace));"}]},{"timestamp":1754598535827,"changes":[{"type":"DELETE","lineNumber":69,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":70,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":71,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":72,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":73,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":74,"oldContent":"        return Left(ServerFailure(message: 'Failed to create story: $e'));"},{"type":"INSERT","lineNumber":69,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":70,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":71,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":72,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":73,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":74,"content":"        return Left(ServerFailure('Failed to create story: $e', stackTrace));"},{"type":"MODIFY","lineNumber":77,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":93,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":94,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":95,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":96,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":97,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":98,"oldContent":"        return Left(ServerFailure(message: 'Failed to view story: $e'));"},{"type":"INSERT","lineNumber":93,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":94,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":95,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":96,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":97,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":98,"content":"        return Left(ServerFailure('Failed to view story: $e', stackTrace));"},{"type":"MODIFY","lineNumber":101,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":117,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":118,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":119,"oldContent":"      } on UnauthorizedException {"},{"type":"DELETE","lineNumber":120,"oldContent":"        return const Left(UnauthorizedFailure(message: 'Not authorized to delete this story'));"},{"type":"DELETE","lineNumber":121,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":122,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":123,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":124,"oldContent":"        return Left(ServerFailure(message: 'Failed to delete story: $e'));"},{"type":"INSERT","lineNumber":117,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":118,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":119,"content":"      } on UnauthorizedException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":120,"content":"        return Left(UnauthorizedFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":121,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":122,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":123,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":124,"content":"        return Left(ServerFailure('Failed to delete story: $e', stackTrace));"},{"type":"MODIFY","lineNumber":127,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":145,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":146,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":147,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":148,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":149,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":150,"oldContent":"        return Left(ServerFailure(message: 'Failed to report story: $e'));"},{"type":"INSERT","lineNumber":145,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":146,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":147,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":148,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":149,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":150,"content":"        return Left(ServerFailure('Failed to report story: $e', stackTrace));"},{"type":"MODIFY","lineNumber":153,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":171,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":172,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":173,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":174,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":175,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":176,"oldContent":"        return Left(ServerFailure(message: 'Failed to fetch user stories: $e'));"},{"type":"INSERT","lineNumber":171,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":172,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":173,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":174,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":175,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":176,"content":"        return Left(ServerFailure('Failed to fetch user stories: $e', stackTrace));"},{"type":"MODIFY","lineNumber":179,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"}]},{"timestamp":1754599657958,"changes":[{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/home/data/datasources/exceptions.dart';"},{"type":"DELETE","lineNumber":37,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":38,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":39,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"MODIFY","lineNumber":44,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":71,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":72,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":73,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":95,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":96,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":97,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":121,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":122,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":123,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":147,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":148,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":149,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":173,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":174,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":175,"content":"        return Left(NetworkFailure(e.message, stackTrace));"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/di/home_injection_container.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/di/home_injection_container.dart","baseContent":"import 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:get_it/get_it.dart';\nimport 'package:injectable/injectable.dart';\nimport 'package:family_tree_firebase/features/home/data/datasources/post_remote_data_source.dart';\nimport 'package:family_tree_firebase/features/home/data/datasources/story_remote_data_source.dart';\nimport 'package:family_tree_firebase/features/home/data/repositories/post_repository_impl.dart';\nimport 'package:family_tree_firebase/features/home/data/repositories/story_repository_impl.dart';\nimport 'package:family_tree_firebase/features/home/domain/repositories/post_repository.dart';\nimport 'package:family_tree_firebase/features/home/domain/repositories/story_repository.dart';\nimport 'package:family_tree_firebase/features/home/domain/usecases/add_comment.dart';\nimport 'package:family_tree_firebase/features/home/domain/usecases/get_posts.dart';\nimport 'package:family_tree_firebase/features/home/domain/usecases/get_stories.dart';\nimport 'package:family_tree_firebase/features/home/domain/usecases/like_post.dart';\nimport 'package:family_tree_firebase/features/home/presentation/viewmodels/home_viewmodel.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:firebase_firestore/firebase_firestore.dart';\nimport 'package:family_tree_firebase/core/network/network_info.dart';\n\nfinal sl = GetIt.instance;\n\n@injectableInit\nFuture<void> initHomeFeature() async {\n  // Register data sources\n  if (!sl.isRegistered<PostRemoteDataSource>()) {\n    sl.registerLazySingleton<PostRemoteDataSource>(\n      () => PostRemoteDataSourceImpl(\n        firestore: sl<FirebaseFirestore>(),\n        firebaseAuth: sl<FirebaseAuth>(),\n        networkInfo: sl<NetworkInfo>(),\n      ),\n    );\n  }\n\n  if (!sl.isRegistered<StoryRemoteDataSource>()) {\n    sl.registerLazySingleton<StoryRemoteDataSource>(\n      () => StoryRemoteDataSourceImpl(\n        firestore: sl<FirebaseFirestore>(),\n        firebaseAuth: sl<FirebaseAuth>(),\n        networkInfo: sl<NetworkInfo>(),\n      ),\n    );\n  }\n\n  // Register repositories\n  if (!sl.isRegistered<PostRepository>()) {\n    sl.registerLazySingleton<PostRepository>(\n      () => PostRepositoryImpl(\n        remoteDataSource: sl<PostRemoteDataSource>(),\n        networkInfo: sl<NetworkInfo>(),\n      ),\n    );\n  }\n\n  if (!sl.isRegistered<StoryRepository>()) {\n    sl.registerLazySingleton<StoryRepository>(\n      () => StoryRepositoryImpl(\n        remoteDataSource: sl<StoryRemoteDataSource>(),\n        networkInfo: sl<NetworkInfo>(),\n      ),\n    );\n  }\n\n  // Register use cases\n  if (!sl.isRegistered<GetPosts>()) {\n    sl.registerLazySingleton(() => GetPosts(sl<PostRepository>()));\n  }\n\n  if (!sl.isRegistered<GetStories>()) {\n    sl.registerLazySingleton(() => GetStories(sl<StoryRepository>()));\n  }\n\n  if (!sl.isRegistered<LikePost>()) {\n    sl.registerLazySingleton(() => LikePost(sl<PostRepository>()));\n  }\n\n  if (!sl.isRegistered<AddComment>()) {\n    sl.registerLazySingleton(() => AddComment(sl<PostRepository>()));\n  }\n\n  // Register ViewModel\n  if (!sl.isRegistered<HomeViewModel>()) {\n    sl.registerFactory(\n      () => HomeViewModel(\n        getPosts: sl<GetPosts>(),\n        getStories: sl<GetStories>(),\n        likePostUseCase: sl<LikePost>(),\n        addCommentUseCase: sl<AddComment>(),\n      ),\n    );\n  }\n}\n","baseTimestamp":1754598212640,"deltas":[{"timestamp":1754598218254,"changes":[{"type":"DELETE","lineNumber":15,"oldContent":"import 'package:firebase_firestore/firebase_firestore.dart';"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/data/datasources/post_remote_data_source.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/data/datasources/post_remote_data_source.dart","baseContent":"import 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/error/exceptions.dart';\nimport 'package:family_tree_firebase/features/home/data/datasources/exceptions.dart';\nimport 'package:family_tree_firebase/core/network/network_info.dart';\nimport 'package:family_tree_firebase/features/home/domain/entities/comment.dart';\nimport 'package:family_tree_firebase/features/home/domain/entities/post.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:injectable/injectable.dart';\n\nabstract class PostRemoteDataSource {\n  Future<List<Post>> getPosts({\n    String? familyId,\n    int limit = 10,\n    String? lastPostId,\n  });\n\n  Future<Unit> likePost({\n    required String postId,\n    required String userId,\n  });\n\n  Future<Comment> addComment({\n    required String postId,\n    required String userId,\n    required String content,\n    required String userName,\n    String? userAvatar,\n  });\n\n  Future<List<Comment>> getComments({\n    required String postId,\n    int limit = 20,\n    String? lastCommentId,\n  });\n\n  Future<Post> createPost({\n    required String userId,\n    required String content,\n    required String userName,\n    String? userAvatar,\n    List<String>? imageUrls,\n    String? familyId,\n  });\n\n  Future<Unit> deletePost({\n    required String postId,\n    required String userId,\n  });\n}\n\n@LazySingleton(as: PostRemoteDataSource)\nclass PostRemoteDataSourceImpl implements PostRemoteDataSource {\n  final FirebaseFirestore firestore;\n  final FirebaseAuth firebaseAuth;\n  final NetworkInfo networkInfo;\n\n  PostRemoteDataSourceImpl({\n    required this.firestore,\n    required this.firebaseAuth,\n    required this.networkInfo,\n  });\n\n  @override\n  Future<List<Post>> getPosts({\n    String? familyId,\n    int limit = 10,\n    String? lastPostId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      Query postsQuery = firestore\n          .collection('posts')\n          .orderBy('timestamp', descending: true)\n          .limit(limit);\n\n      if (familyId != null) {\n        postsQuery = postsQuery.where('familyId', isEqualTo: familyId);\n      }\n\n      if (lastPostId != null) {\n        final lastDoc = await firestore.collection('posts').doc(lastPostId).get();\n        postsQuery = postsQuery.startAfterDocument(lastDoc);\n      }\n\n      final querySnapshot = await postsQuery.get();\n      final currentUserId = firebaseAuth.currentUser?.uid;\n\n      return querySnapshot.docs.map((doc) {\n        final data = doc.data() as Map<String, dynamic>;\n        return Post(\n          id: doc.id,\n          userId: data['userId'],\n          userName: data['userName'],\n          userAvatar: data['userAvatar'],\n          content: data['content'] ?? '',\n          imageUrls: List<String>.from(data['imageUrls'] ?? []),\n          timestamp: (data['timestamp'] as Timestamp).toDate(),\n          likes: List<String>.from(data['likes'] ?? []),\n          commentCount: data['commentCount'] ?? 0,\n          familyId: data['familyId'],\n          isLiked: currentUserId != null && (data['likes'] as List<dynamic>).contains(currentUserId),\n          isPinned: data['isPinned'] ?? false,\n          isReported: data['isReported'] ?? false,\n          updatedAt: data['updatedAt']?.toDate(),\n        );\n      }).toList();\n    } catch (e) {\n      throw ServerException(message: 'Failed to fetch posts: $e');\n    }\n  }\n\n  @override\n  Future<Unit> likePost({\n    required String postId,\n    required String userId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      final postRef = firestore.collection('posts').doc(postId);\n      await firestore.runTransaction((transaction) async {\n        final postDoc = await transaction.get(postRef);\n        if (!postDoc.exists) {\n          throw NotFoundException('Post not found');\n        }\n\n        final data = postDoc.data()!;\n        final likes = List<String>.from(data['likes'] ?? []);\n        final isLiked = likes.contains(userId);\n\n        if (isLiked) {\n          likes.remove(userId);\n        } else {\n          likes.add(userId);\n        }\n\n        transaction.update(postRef, {\n          'likes': likes,\n          'updatedAt': FieldValue.serverTimestamp(),\n        });\n      });\n      return unit;\n    } catch (e) {\n      throw ServerException(message: 'Failed to like post: $e');\n    }\n  }\n\n  @override\n  Future<Comment> addComment({\n    required String postId,\n    required String userId,\n    required String content,\n    required String userName,\n    String? userAvatar,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      final commentRef = firestore\n          .collection('posts')\n          .doc(postId)\n          .collection('comments')\n          .doc();\n\n      final commentData = {\n        'id': commentRef.id,\n        'postId': postId,\n        'userId': userId,\n        'userName': userName,\n        'userAvatar': userAvatar,\n        'content': content,\n        'timestamp': FieldValue.serverTimestamp(),\n        'likes': [],\n        'isEdited': false,\n        'parentCommentId': null,\n        'replies': [],\n        'replyCount': 0,\n      };\n\n      await firestore.runTransaction((transaction) async {\n        // Add the comment\n        transaction.set(commentRef, commentData);\n        \n        // Increment the comment count on the post\n        final postRef = firestore.collection('posts').doc(postId);\n        transaction.update(postRef, {\n          'commentCount': FieldValue.increment(1),\n          'updatedAt': FieldValue.serverTimestamp(),\n        });\n      });\n\n      return Comment(\n        id: commentRef.id,\n        postId: postId,\n        userId: userId,\n        userName: userName,\n        userAvatar: userAvatar,\n        content: content,\n        timestamp: DateTime.now(),\n        likes: [],\n        isLiked: false,\n        isEdited: false,\n        parentCommentId: null,\n        replies: [],\n        replyCount: 0,\n      );\n    } catch (e) {\n      throw ServerException(message: 'Failed to add comment: $e');\n    }\n  }\n\n  @override\n  Future<List<Comment>> getComments({\n    required String postId,\n    int limit = 20,\n    String? lastCommentId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      var query = firestore\n          .collection('posts')\n          .doc(postId)\n          .collection('comments')\n          .orderBy('timestamp', descending: true)\n          .limit(limit);\n\n      if (lastCommentId != null) {\n        final lastDoc = await firestore\n            .collection('posts')\n            .doc(postId)\n            .collection('comments')\n            .doc(lastCommentId)\n            .get();\n        query = query.startAfterDocument(lastDoc);\n      }\n\n      final querySnapshot = await query.get();\n      final currentUserId = firebaseAuth.currentUser?.uid;\n\n      return querySnapshot.docs.map((doc) {\n        final data = doc.data();\n        return Comment(\n          id: doc.id,\n          postId: data['postId'],\n          userId: data['userId'],\n          userName: data['userName'],\n          userAvatar: data['userAvatar'],\n          content: data['content'],\n          timestamp: (data['timestamp'] as Timestamp).toDate(),\n          likes: List<String>.from(data['likes'] ?? []),\n          isLiked: currentUserId != null && (data['likes'] as List<dynamic>).contains(currentUserId),\n          isEdited: data['isEdited'] ?? false,\n          parentCommentId: data['parentCommentId'],\n          replies: List<String>.from(data['replies'] ?? []),\n          replyCount: data['replyCount'] ?? 0,\n        );\n      }).toList();\n    } catch (e) {\n      throw ServerException(message: 'Failed to fetch comments: $e');\n    }\n  }\n\n  @override\n  Future<Post> createPost({\n    required String userId,\n    required String content,\n    required String userName,\n    String? userAvatar,\n    List<String>? imageUrls,\n    String? familyId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      final postRef = firestore.collection('posts').doc();\n      final timestamp = FieldValue.serverTimestamp();\n      \n      final postData = {\n        'id': postRef.id,\n        'userId': userId,\n        'userName': userName,\n        'userAvatar': userAvatar,\n        'content': content,\n        'imageUrls': imageUrls ?? [],\n        'timestamp': timestamp,\n        'likes': [],\n        'commentCount': 0,\n        'familyId': familyId,\n        'isPinned': false,\n        'isReported': false,\n        'updatedAt': timestamp,\n      };\n\n      await postRef.set(postData);\n\n      return Post(\n        id: postRef.id,\n        userId: userId,\n        userName: userName,\n        userAvatar: userAvatar,\n        content: content,\n        imageUrls: imageUrls ?? [],\n        timestamp: DateTime.now(),\n        likes: [],\n        commentCount: 0,\n        familyId: familyId,\n        isLiked: false,\n        isPinned: false,\n        isReported: false,\n        updatedAt: DateTime.now(),\n      );\n    } catch (e) {\n      throw ServerException(message: 'Failed to create post: $e');\n    }\n  }\n\n  @override\n  Future<Unit> deletePost({\n    required String postId,\n    required String userId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      final postRef = firestore.collection('posts').doc(postId);\n      \n      await firestore.runTransaction((transaction) async {\n        final postDoc = await transaction.get(postRef);\n        if (!postDoc.exists) {\n          throw NotFoundException('Post not found');\n        }\n\n        final data = postDoc.data()!;\n        if (data['userId'] != userId) {\n          throw const UnauthorizedException('Not authorized to delete this post');\n        }\n\n        // Delete the post\n        transaction.delete(postRef);\n        \n        // Optionally: Delete all comments for this post\n        // Note: This might be better handled with a Cloud Function\n        // to avoid long-running transactions\n        final commentsSnapshot = await postRef.collection('comments').get();\n        for (var doc in commentsSnapshot.docs) {\n          transaction.delete(doc.reference);\n        }\n      });\n\n      return unit;\n    } catch (e) {\n      throw ServerException(message: 'Failed to delete post: $e');\n    }\n  }\n}\n","baseTimestamp":1754598271805,"deltas":[{"timestamp":1754599437327,"changes":[{"type":"MODIFY","lineNumber":111,"content":"      throw const ServerException('Failed to fetch posts');","oldContent":"      throw ServerException(message: 'Failed to fetch posts: $e');"},{"type":"MODIFY","lineNumber":149,"content":"      throw const ServerException('Failed to like post');","oldContent":"      throw ServerException(message: 'Failed to like post: $e');"},{"type":"MODIFY","lineNumber":215,"content":"      throw const ServerException('Failed to add comment');","oldContent":"      throw ServerException(message: 'Failed to add comment: $e');"},{"type":"MODIFY","lineNumber":269,"content":"      throw const ServerException('Failed to fetch comments');","oldContent":"      throw ServerException(message: 'Failed to fetch comments: $e');"},{"type":"MODIFY","lineNumber":325,"content":"      throw const ServerException('Failed to create post');","oldContent":"      throw ServerException(message: 'Failed to create post: $e');"},{"type":"MODIFY","lineNumber":366,"content":"      throw const ServerException('Failed to delete post');","oldContent":"      throw ServerException(message: 'Failed to delete post: $e');"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/data/datasources/story_remote_data_source.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/data/datasources/story_remote_data_source.dart","baseContent":"import 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/features/home/data/datasources/exceptions.dart';\nimport 'package:family_tree_firebase/core/network/network_info.dart';\nimport 'package:family_tree_firebase/features/home/domain/entities/story.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:injectable/injectable.dart';\n\nabstract class StoryRemoteDataSource {\n  Future<List<Story>> getStories({\n    String? familyId,\n    int limit = 20,\n    String? lastStoryId,\n  });\n\n  Future<Story> createStory({\n    required String userId,\n    required String userName,\n    String? userAvatar,\n    required List<String> mediaUrls,\n    String? caption,\n    Duration? duration,\n    String? familyId,\n  });\n\n  Future<Unit> viewStory({\n    required String storyId,\n    required String userId,\n  });\n\n  Future<Unit> deleteStory({\n    required String storyId,\n    required String userId,\n  });\n\n  Future<Unit> reportStory({\n    required String storyId,\n    required String userId,\n    required String reason,\n  });\n\n  Future<List<Story>> getUserStories({\n    required String userId,\n    int limit = 20,\n    String? lastStoryId,\n  });\n}\n\n@LazySingleton(as: StoryRemoteDataSource)\nclass StoryRemoteDataSourceImpl implements StoryRemoteDataSource {\n  final FirebaseFirestore firestore;\n  final FirebaseAuth firebaseAuth;\n  final NetworkInfo networkInfo;\n\n  StoryRemoteDataSourceImpl({\n    required this.firestore,\n    required this.firebaseAuth,\n    required this.networkInfo,\n  });\n\n  @override\n  Future<List<Story>> getStories({\n    String? familyId,\n    int limit = 20,\n    String? lastStoryId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      Query storiesQuery = firestore\n          .collection('stories')\n          .where('timestamp', isGreaterThan: _get24HoursAgo())\n          .orderBy('timestamp', descending: true)\n          .limit(limit);\n\n      if (familyId != null) {\n        storiesQuery = storiesQuery.where('familyId', isEqualTo: familyId);\n      }\n\n      if (lastStoryId != null) {\n        final lastDoc = await firestore.collection('stories').doc(lastStoryId).get();\n        storiesQuery = storiesQuery.startAfterDocument(lastDoc);\n      }\n\n      final querySnapshot = await storiesQuery.get();\n      final currentUserId = firebaseAuth.currentUser?.uid;\n\n      return querySnapshot.docs.map((doc) {\n        final data = doc.data() as Map<String, dynamic>;\n        return _mapDocumentToStory(doc.id, data, currentUserId);\n      }).toList();\n    } catch (e) {\n      throw ServerException(message: 'Failed to fetch stories: $e');\n    }\n  }\n\n  @override\n  Future<Story> createStory({\n    required String userId,\n    required String userName,\n    String? userAvatar,\n    required List<String> mediaUrls,\n    String? caption,\n    Duration? duration,\n    String? familyId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      final storyRef = firestore.collection('stories').doc();\n      final timestamp = FieldValue.serverTimestamp();\n      \n      final storyData = {\n        'id': storyRef.id,\n        'userId': userId,\n        'userName': userName,\n        'userAvatar': userAvatar,\n        'media': mediaUrls.map((url) => {\n          'url': url,\n          'type': _getMediaType(url),\n          'duration': duration?.inSeconds,\n        }).toList(),\n        'caption': caption,\n        'timestamp': timestamp,\n        'viewers': [],\n        'viewCount': 0,\n        'familyId': familyId,\n        'isArchived': false,\n        'isReported': false,\n      };\n\n      await storyRef.set(storyData);\n\n      return Story(\n        id: storyRef.id,\n        userId: userId,\n        userName: userName,\n        userAvatar: userAvatar,\n        media: mediaUrls.map((url) => StoryMedia(\n          url: url,\n          type: _getMediaType(url),\n          duration: duration,\n        )).toList(),\n        caption: caption,\n        timestamp: DateTime.now(),\n        viewers: [],\n        viewCount: 0,\n        isViewed: false,\n        familyId: familyId,\n        isArchived: false,\n        isReported: false,\n      );\n    } catch (e) {\n      throw ServerException(message: 'Failed to create story: $e');\n    }\n  }\n\n  @override\n  Future<Unit> viewStory({\n    required String storyId,\n    required String userId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      final storyRef = firestore.collection('stories').doc(storyId);\n      \n      await firestore.runTransaction((transaction) async {\n        final storyDoc = await transaction.get(storyRef);\n        if (!storyDoc.exists) {\n          throw NotFoundException('Story not found');\n        }\n\n        final data = storyDoc.data()!;\n        final viewers = List<String>.from(data['viewers'] ?? []);\n        \n        if (!viewers.contains(userId)) {\n          viewers.add(userId);\n          transaction.update(storyRef, {\n            'viewers': viewers,\n            'viewCount': FieldValue.increment(1),\n          });\n        }\n      });\n\n      return unit;\n    } catch (e) {\n      throw ServerException(message: 'Failed to view story: $e');\n    }\n  }\n\n  @override\n  Future<Unit> deleteStory({\n    required String storyId,\n    required String userId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      final storyRef = firestore.collection('stories').doc(storyId);\n      \n      await firestore.runTransaction((transaction) async {\n        final storyDoc = await transaction.get(storyRef);\n        if (!storyDoc.exists) {\n          throw NotFoundException('Story not found');\n        }\n\n        final data = storyDoc.data()!;\n        if (data['userId'] != userId) {\n          throw const UnauthorizedException('Not authorized to delete this story');\n        }\n\n        transaction.delete(storyRef);\n      });\n\n      return unit;\n    } catch (e) {\n      throw ServerException(message: 'Failed to delete story: $e');\n    }\n  }\n\n  @override\n  Future<Unit> reportStory({\n    required String storyId,\n    required String userId,\n    required String reason,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      final reportRef = firestore.collection('reports').doc();\n      \n      await reportRef.set({\n        'id': reportRef.id,\n        'type': 'story',\n        'targetId': storyId,\n        'reporterId': userId,\n        'reason': reason,\n        'timestamp': FieldValue.serverTimestamp(),\n        'status': 'pending',\n      });\n\n      // Mark the story as reported\n      await firestore.collection('stories').doc(storyId).update({\n        'isReported': true,\n      });\n\n      return unit;\n    } catch (e) {\n      throw ServerException(message: 'Failed to report story: $e');\n    }\n  }\n\n  @override\n  Future<List<Story>> getUserStories({\n    required String userId,\n    int limit = 20,\n    String? lastStoryId,\n  }) async {\n    if (!await networkInfo.isConnected) {\n      throw NetworkException();\n    }\n\n    try {\n      Query storiesQuery = firestore\n          .collection('stories')\n          .where('userId', isEqualTo: userId)\n          .orderBy('timestamp', descending: true)\n          .limit(limit);\n\n      if (lastStoryId != null) {\n        final lastDoc = await firestore.collection('stories').doc(lastStoryId).get();\n        storiesQuery = storiesQuery.startAfterDocument(lastDoc);\n      }\n\n      final querySnapshot = await storiesQuery.get();\n      final currentUserId = firebaseAuth.currentUser?.uid;\n\n      return querySnapshot.docs.map((doc) {\n        final data = doc.data() as Map<String, dynamic>;\n        return _mapDocumentToStory(doc.id, data, currentUserId);\n      }).toList();\n    } catch (e) {\n      throw ServerException(message: 'Failed to fetch user stories: $e');\n    }\n  }\n\n  // Helper methods\n  String _getMediaType(String url) {\n    final extension = url.split('.').last.toLowerCase();\n    if (['jpg', 'jpeg', 'png', 'gif', 'webp'].contains(extension)) {\n      return 'image';\n    } else if (['mp4', 'mov', 'avi', 'webm'].contains(extension)) {\n      return 'video';\n    }\n    return 'unknown';\n  }\n\n  DateTime _get24HoursAgo() {\n    return DateTime.now().subtract(const Duration(hours: 24));\n  }\n\n  Story _mapDocumentToStory(String id, Map<String, dynamic> data, String? currentUserId) {\n    final media = (data['media'] as List<dynamic>?)?.map((item) {\n      return StoryMedia(\n        url: item['url'] as String,\n        type: item['type'] as String? ?? 'image', // Default to 'image' if type is not specified\n        duration: item['duration'] != null \n            ? Duration(seconds: (item['duration'] as num).toInt()) \n            : null,\n        thumbnailUrl: item['thumbnailUrl'] as String?,\n      );\n    }).toList() ?? [];\n\n    final viewers = List<String>.from(data['viewers'] ?? []);\n    final timestamp = (data['timestamp'] as Timestamp).toDate();\n    \n    return Story(\n      id: id,\n      userId: data['userId'] as String,\n      userName: data['userName'] as String,\n      userAvatar: data['userAvatar'] as String?,\n      media: media,\n      caption: data['caption'] as String?,\n      timestamp: timestamp,\n      viewers: viewers,\n      viewCount: (data['viewCount'] as num?)?.toInt() ?? 0,\n      isViewed: currentUserId != null && viewers.contains(currentUserId),\n      familyId: data['familyId'] as String?,\n      isArchived: data['isArchived'] as bool? ?? false,\n      isReported: data['isReported'] as bool? ?? false,\n    );\n  }\n}\n","baseTimestamp":1754598286911,"deltas":[{"timestamp":1754599449523,"changes":[{"type":"INSERT","lineNumber":3,"content":"import 'package:family_tree_firebase/core/error/exceptions.dart';"},{"type":"MODIFY","lineNumber":95,"content":"      throw const ServerException('Failed to fetch stories');","oldContent":"      throw ServerException(message: 'Failed to fetch stories: $e');"},{"type":"MODIFY","lineNumber":158,"content":"      throw const ServerException('Failed to create story');","oldContent":"      throw ServerException(message: 'Failed to create story: $e');"},{"type":"MODIFY","lineNumber":194,"content":"      throw const ServerException('Failed to view story');","oldContent":"      throw ServerException(message: 'Failed to view story: $e');"},{"type":"MODIFY","lineNumber":226,"content":"      throw const ServerException('Failed to delete story');","oldContent":"      throw ServerException(message: 'Failed to delete story: $e');"},{"type":"MODIFY","lineNumber":260,"content":"      throw const ServerException('Failed to report story');","oldContent":"      throw ServerException(message: 'Failed to report story: $e');"},{"type":"MODIFY","lineNumber":294,"content":"      throw const ServerException('Failed to fetch user stories');","oldContent":"      throw ServerException(message: 'Failed to fetch user stories: $e');"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/data/repositories/post_repository_impl.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/data/repositories/post_repository_impl.dart","baseContent":"import 'package:dartz/dartz.dart';\nimport 'package:family_tree_firebase/core/error/exceptions.dart';\nimport 'package:family_tree_firebase/core/error/failures.dart';\nimport 'package:family_tree_firebase/core/network/network_info.dart';\nimport 'package:family_tree_firebase/features/home/data/datasources/post_remote_data_source.dart';\nimport 'package:family_tree_firebase/features/home/domain/entities/comment.dart';\nimport 'package:family_tree_firebase/features/home/domain/entities/post.dart';\nimport 'package:family_tree_firebase/features/home/domain/repositories/post_repository.dart';\nimport 'package:injectable/injectable.dart';\n\n@LazySingleton(as: PostRepository)\nclass PostRepositoryImpl implements PostRepository {\n  final PostRemoteDataSource remoteDataSource;\n  final NetworkInfo networkInfo;\n\n  PostRepositoryImpl({\n    required this.remoteDataSource,\n    required this.networkInfo,\n  });\n\n  @override\n  Future<Either<Failure, List<Post>>> getPosts({\n    String? familyId,\n    int limit = 10,\n    String? lastPostId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        final posts = await remoteDataSource.getPosts(\n          familyId: familyId,\n          limit: limit,\n          lastPostId: lastPostId,\n        );\n        return Right(posts);\n      } on ServerException catch (e, stackTrace) {\n        return Left(ServerFailure(e.message, stackTrace));\n      } on NetworkException catch (_, stackTrace) {\n        return Left(const NetworkFailure('No internet connection'), stackTrace);\n      } catch (e, stackTrace) {\n        return Left(ServerFailure('Unexpected error: $e', stackTrace));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Unit>> likePost({\n    required String postId,\n    required String userId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        await remoteDataSource.likePost(\n          postId: postId,\n          userId: userId,\n        );\n        return const Right(unit);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to like post: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Comment>> addComment({\n    required String postId,\n    required String userId,\n    required String content,\n    required String userName,\n    String? userAvatar,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        final comment = await remoteDataSource.addComment(\n          postId: postId,\n          userId: userId,\n          content: content,\n          userName: userName,\n          userAvatar: userAvatar,\n        );\n        return Right(comment);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to add comment: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, List<Comment>>> getComments({\n    required String postId,\n    int limit = 20,\n    String? lastCommentId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        final comments = await remoteDataSource.getComments(\n          postId: postId,\n          limit: limit,\n          lastCommentId: lastCommentId,\n        );\n        return Right(comments);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to get comments: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Post>> createPost({\n    required String userId,\n    required String content,\n    required String userName,\n    String? userAvatar,\n    List<String>? imageUrls,\n    String? familyId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        final post = await remoteDataSource.createPost(\n          userId: userId,\n          content: content,\n          userName: userName,\n          userAvatar: userAvatar,\n          imageUrls: imageUrls,\n          familyId: familyId,\n        );\n        return Right(post);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to create post: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Unit>> deletePost({\n    required String postId,\n    required String userId,\n  }) async {\n    if (await networkInfo.isConnected) {\n      try {\n        await remoteDataSource.deletePost(\n          postId: postId,\n          userId: userId,\n        );\n        return const Right(unit);\n      } on ServerException catch (e) {\n        return Left(ServerFailure(message: e.message));\n      } on NetworkException {\n        return const Left(NetworkFailure(message: 'No internet connection'));\n      } on UnauthorizedException {\n        return const Left(UnauthorizedFailure(message: 'Not authorized to delete this post'));\n      } catch (e) {\n        return Left(ServerFailure(message: 'Failed to delete post: $e'));\n      }\n    } else {\n      return const Left(NetworkFailure(message: 'No internet connection'));\n    }\n  }\n\n  @override\n  Future<Either<Failure, Unit>> reportPost({\n    required String postId,\n    required String userId,\n    required String reason,\n  }) async {\n    // Implementation for reporting a post\n    // This would typically involve creating a report in a separate collection\n    // and possibly flagging the post for review\n    return const Left(UnimplementedFailure(message: 'Report post not implemented'));\n  }\n}\n","baseTimestamp":1754598314806,"deltas":[{"timestamp":1754598337794,"changes":[{"type":"DELETE","lineNumber":170,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":171,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":172,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":173,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":174,"oldContent":"      } on UnauthorizedException {"},{"type":"DELETE","lineNumber":175,"oldContent":"        return const Left(UnauthorizedFailure(message: 'Not authorized to delete this post'));"},{"type":"DELETE","lineNumber":176,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":177,"oldContent":"        return Left(ServerFailure(message: 'Failed to delete post: $e'));"},{"type":"INSERT","lineNumber":170,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":171,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":172,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":173,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":174,"content":"      } on UnauthorizedException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":175,"content":"        return Left(UnauthorizedFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":176,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":177,"content":"        return Left(ServerFailure('Failed to delete post: $e', stackTrace));"}]},{"timestamp":1754598434397,"changes":[{"type":"DELETE","lineNumber":58,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":59,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":60,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":61,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":62,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":63,"oldContent":"        return Left(ServerFailure(message: 'Failed to like post: $e'));"},{"type":"INSERT","lineNumber":58,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":59,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":60,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":61,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":62,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":63,"content":"        return Left(ServerFailure('Failed to like post: $e', stackTrace));"},{"type":"MODIFY","lineNumber":66,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":88,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":89,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":90,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":91,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":92,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":93,"oldContent":"        return Left(ServerFailure(message: 'Failed to add comment: $e'));"},{"type":"INSERT","lineNumber":88,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":89,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":90,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":91,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":92,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":93,"content":"        return Left(ServerFailure('Failed to add comment: $e', stackTrace));"},{"type":"MODIFY","lineNumber":96,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":114,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":115,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":116,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":117,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":118,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":119,"oldContent":"        return Left(ServerFailure(message: 'Failed to get comments: $e'));"},{"type":"INSERT","lineNumber":114,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":115,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":116,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":117,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":118,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":119,"content":"        return Left(ServerFailure('Failed to get comments: $e', stackTrace));"},{"type":"MODIFY","lineNumber":122,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":146,"oldContent":"      } on ServerException catch (e) {"},{"type":"DELETE","lineNumber":147,"oldContent":"        return Left(ServerFailure(message: e.message));"},{"type":"DELETE","lineNumber":148,"oldContent":"      } on NetworkException {"},{"type":"DELETE","lineNumber":149,"oldContent":"        return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"DELETE","lineNumber":150,"oldContent":"      } catch (e) {"},{"type":"DELETE","lineNumber":151,"oldContent":"        return Left(ServerFailure(message: 'Failed to create post: $e'));"},{"type":"INSERT","lineNumber":146,"content":"      } on ServerException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":147,"content":"        return Left(ServerFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":148,"content":"      } on NetworkException catch (_, stackTrace) {"},{"type":"INSERT","lineNumber":149,"content":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":150,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":151,"content":"        return Left(ServerFailure('Failed to create post: $e', stackTrace));"},{"type":"MODIFY","lineNumber":154,"content":"      return const Left(NetworkFailure('No internet connection'));","oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"}]},{"timestamp":1754599474112,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'dart:async';"},{"type":"INSERT","lineNumber":1,"content":""},{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/home/data/datasources/exceptions.dart';"},{"type":"DELETE","lineNumber":36,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"DELETE","lineNumber":37,"oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":39,"content":"      } on NetworkException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":40,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":42,"oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"INSERT","lineNumber":45,"content":"      return const Left(NetworkFailure('No internet connection'));"}]},{"timestamp":1754599530285,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:dartz/dartz.dart';","oldContent":"import 'package:dartz/dartz.dart';"},{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/home/data/datasources/exceptions.dart';"},{"type":"DELETE","lineNumber":8,"oldContent":"import 'package:family_tree_firebase/features/home/data/datasources/exceptions.dart';"},{"type":"DELETE","lineNumber":39,"oldContent":"      } catch (e, stackTrace) {"},{"type":"MODIFY","lineNumber":41,"content":"      } catch (e, stackTrace) {","oldContent":"        return Left(ServerFailure('Unexpected error: $e', stackTrace));"},{"type":"INSERT","lineNumber":42,"content":"        return Left(ServerFailure('Unexpected error: $e', stackTrace));"},{"type":"INSERT","lineNumber":45,"content":"      return const Left(NetworkFailure('No internet connection'));"},{"type":"DELETE","lineNumber":47,"oldContent":"      return const Left(NetworkFailure('No internet connection'));"},{"type":"DELETE","lineNumber":77,"oldContent":"    required String content,"},{"type":"INSERT","lineNumber":79,"content":"    required String content,"},{"type":"INSERT","lineNumber":80,"content":"    String? parentCommentId,"},{"type":"DELETE","lineNumber":86,"oldContent":"          content: content,"},{"type":"INSERT","lineNumber":89,"content":"          content: content,"},{"type":"INSERT","lineNumber":90,"content":"          parentCommentId: parentCommentId,"},{"type":"DELETE","lineNumber":93,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":95,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":96,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":106,"oldContent":"    int limit = 20,"},{"type":"INSERT","lineNumber":108,"content":"    int limit = 50,"},{"type":"DELETE","lineNumber":119,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":121,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":122,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":122,"oldContent":"        return Left(ServerFailure('Failed to get comments: $e', stackTrace));"},{"type":"INSERT","lineNumber":124,"content":"        return Left(ServerFailure('Failed to fetch comments: $e', stackTrace));"},{"type":"DELETE","lineNumber":132,"oldContent":"    required String content,"},{"type":"DELETE","lineNumber":135,"oldContent":"    List<String>? imageUrls,"},{"type":"INSERT","lineNumber":136,"content":"    required String content,"},{"type":"INSERT","lineNumber":137,"content":"    List<String>? mediaUrls,"},{"type":"DELETE","lineNumber":142,"oldContent":"          content: content,"},{"type":"DELETE","lineNumber":145,"oldContent":"          imageUrls: imageUrls,"},{"type":"INSERT","lineNumber":146,"content":"          content: content,"},{"type":"INSERT","lineNumber":147,"content":"          mediaUrls: mediaUrls,"},{"type":"DELETE","lineNumber":151,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":153,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":154,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":175,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":177,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":178,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":183,"oldContent":"      return const Left(NetworkFailure(message: 'No internet connection'));"},{"type":"INSERT","lineNumber":185,"content":"      return const Left(NetworkFailure('No internet connection'));"},{"type":"DELETE","lineNumber":193,"oldContent":"    // Implementation for reporting a post"},{"type":"DELETE","lineNumber":194,"oldContent":"    // This would typically involve creating a report in a separate collection"},{"type":"DELETE","lineNumber":195,"oldContent":"    // and possibly flagging the post for review"},{"type":"MODIFY","lineNumber":195,"content":"    return Left(ServerFailure('Report post not implemented'));","oldContent":"    return const Left(UnimplementedFailure(message: 'Report post not implemented'));"}]},{"timestamp":1754600715164,"changes":[{"type":"INSERT","lineNumber":1,"content":""},{"type":"DELETE","lineNumber":2,"oldContent":"import 'package:dartz/dartz.dart';"},{"type":"INSERT","lineNumber":40,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"DELETE","lineNumber":42,"oldContent":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"MODIFY","lineNumber":78,"content":"    required String userName,","oldContent":"    required String userName,"},{"type":"DELETE","lineNumber":80,"oldContent":"    String? parentCommentId,"},{"type":"INSERT","lineNumber":86,"content":"          content: content,"},{"type":"DELETE","lineNumber":89,"oldContent":"          content: content,"},{"type":"DELETE","lineNumber":91,"oldContent":"          parentCommentId: parentCommentId,"},{"type":"MODIFY","lineNumber":95,"content":"      } catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"MODIFY","lineNumber":107,"content":"    String? lastCommentId,","oldContent":"    String? lastCommentId,"},{"type":"DELETE","lineNumber":121,"oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"DELETE","lineNumber":124,"oldContent":"      }"},{"type":"INSERT","lineNumber":121,"content":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":123,"content":"      }"},{"type":"INSERT","lineNumber":135,"content":"    List<String>? imageUrls,"},{"type":"DELETE","lineNumber":138,"oldContent":"    List<String>? mediaUrls,"},{"type":"INSERT","lineNumber":145,"content":"          imageUrls: imageUrls,"},{"type":"DELETE","lineNumber":148,"oldContent":"          mediaUrls: mediaUrls,"},{"type":"MODIFY","lineNumber":153,"content":"      } catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"MODIFY","lineNumber":177,"content":"      } on UnauthorizedException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"MODIFY","lineNumber":184,"content":"    }","oldContent":"    }"}]},{"timestamp":1754604649347,"changes":[{"type":"DELETE","lineNumber":63,"oldContent":"      } on NetworkException catch (_, stackTrace) {"},{"type":"MODIFY","lineNumber":63,"content":"      } on NetworkException catch (e, stackTrace) {","oldContent":"        return Left(const NetworkFailure('No internet connection'), stackTrace);"},{"type":"INSERT","lineNumber":64,"content":"        return Left(NetworkFailure(e.message, stackTrace));"},{"type":"INSERT","lineNumber":77,"content":"    required String content,"},{"type":"DELETE","lineNumber":78,"oldContent":"    required String userName,"},{"type":"MODIFY","lineNumber":86,"content":"          content: content,","oldContent":"          content: content,"},{"type":"DELETE","lineNumber":93,"oldContent":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":95,"content":"      } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":105,"oldContent":"    String? lastCommentId,"},{"type":"DELETE","lineNumber":106,"oldContent":"    String? lastCommentId,"},{"type":"INSERT","lineNumber":105,"content":"    required String postId,"},{"type":"INSERT","lineNumber":107,"content":"    String? lastCommentId,"},{"type":"DELETE","lineNumber":119,"oldContent":"      } catch (e, stackTrace) {"},{"type":"MODIFY","lineNumber":121,"content":"      } catch (e, stackTrace) {","oldContent":"      }"},{"type":"INSERT","lineNumber":123,"content":"      }"},{"type":"DELETE","lineNumber":133,"oldContent":"    List<String>? imageUrls,"},{"type":"INSERT","lineNumber":135,"content":"    List<String>? imageUrls,"},{"type":"DELETE","lineNumber":143,"oldContent":"          imageUrls: imageUrls,"},{"type":"INSERT","lineNumber":145,"content":"          imageUrls: imageUrls,"},{"type":"DELETE","lineNumber":151,"oldContent":"      } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":153,"content":"      } catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":175,"oldContent":"      } on UnauthorizedException catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":177,"content":"      } on UnauthorizedException catch (e, stackTrace) {"},{"type":"DELETE","lineNumber":182,"oldContent":"    }"},{"type":"DELETE","lineNumber":183,"oldContent":"    }"},{"type":"INSERT","lineNumber":182,"content":"    } else {"},{"type":"INSERT","lineNumber":184,"content":"    }"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/error/failures.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/core/error/failures.dart","baseContent":"import 'package:equatable/equatable.dart';\n\nabstract class Failure extends Equatable {\n  final String message;\n  final StackTrace? stackTrace;\n\n  const Failure(this.message, [this.stackTrace]);\n\n  @override\n  List<Object?> get props => [message, stackTrace];\n}\n\n// General failures\nclass ServerFailure extends Failure {\n  const ServerFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass CacheFailure extends Failure {\n  const CacheFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass NetworkFailure extends Failure {\n  const NetworkFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass InvalidInputFailure extends Failure {\n  const InvalidInputFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\n// Authentication failures\nclass AuthenticationFailure extends Failure {\n  const AuthenticationFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass InvalidCredentialsFailure extends Failure {\n  const InvalidCredentialsFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass EmailAlreadyInUseFailure extends Failure {\n  const EmailAlreadyInUseFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass UnauthorizedFailure extends Failure {\n  const UnauthorizedFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass WeakPasswordFailure extends Failure {\n  const WeakPasswordFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\n// Family failures\nclass FamilyNotFoundFailure extends Failure {\n  const FamilyNotFoundFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass InvalidInviteCodeFailure extends Failure {\n  const InvalidInviteCodeFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass AlreadyInFamilyFailure extends Failure {\n  const AlreadyInFamilyFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\nclass PermissionDeniedFailure extends Failure {\n  const PermissionDeniedFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\n// Not found failure\nclass NotFoundFailure extends Failure {\n  const NotFoundFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n\n// Validation failure\nclass ValidationFailure extends Failure {\n  const ValidationFailure(String message, [StackTrace? stackTrace])\n      : super(message, stackTrace);\n}\n","baseTimestamp":1754599707906},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/app.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/app.dart","baseContent":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_bloc.dart';\nimport 'package:family_tree_firebase/features/auth/presentation/screens/login_screen.dart';\nimport 'package:family_tree_firebase/features/auth/presentation/screens/otp_verification_screen.dart';\nimport 'package:family_tree_firebase/features/auth/presentation/screens/register_screen.dart';\nimport 'package:family_tree_firebase/features/auth/presentation/screens/success_screen.dart';\nimport 'package:family_tree_firebase/features/home/presentation/screens/home_screen.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:firebase_core/firebase_core.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter_bloc/flutter_bloc.dart';\n\nvoid main() async {\n  WidgetsFlutterBinding.ensureInitialized();\n  await Firebase.initializeApp();\n  runApp(const MyApp());\n}\n\nclass MyApp extends StatelessWidget {\n  const MyApp({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return MultiBlocProvider(\n      providers: [\n        BlocProvider(create: (_) => AuthBloc()..add(CheckAuthStatus())),\n      ],\n      child: MaterialApp(\n        title: 'Family Tree App',\n        debugShowCheckedModeBanner: false,\n        theme: ThemeData(\n          primarySwatch: Colors.orange,\n          scaffoldBackgroundColor: const Color(0xFFF5F5F5),\n          appBarTheme: const AppBarTheme(\n            elevation: 0,\n            backgroundColor: Colors.transparent,\n            iconTheme: IconThemeData(color: Color(0xFF333333)),\n            titleTextStyle: TextStyle(\n              color: Color(0xFF333333),\n              fontSize: 20,\n              fontWeight: FontWeight.bold,\n            ),\n          ),\n          inputDecorationTheme: InputDecorationTheme(\n            filled: true,\n            fillColor: Colors.white,\n            contentPadding: const EdgeInsets.symmetric(\n              horizontal: 16,\n              vertical: 16,\n            ),\n            border: OutlineInputBorder(\n              borderRadius: BorderRadius.circular(12.0),\n              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),\n            ),\n            enabledBorder: OutlineInputBorder(\n              borderRadius: BorderRadius.circular(12.0),\n              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),\n            ),\n            focusedBorder: OutlineInputBorder(\n              borderRadius: BorderRadius.circular(12.0),\n              borderSide: const BorderSide(color: Color(0xFFFF6B35)),\n            ),\n            errorBorder: OutlineInputBorder(\n              borderRadius: BorderRadius.circular(12.0),\n              borderSide: const BorderSide(color: Colors.red),\n            ),\n          ),\n          elevatedButtonTheme: ElevatedButtonThemeData(\n            style: ElevatedButton.styleFrom(\n              backgroundColor: const Color(0xFFFF6B35),\n              foregroundColor: Colors.white,\n              elevation: 0,\n              shape: RoundedRectangleBorder(\n                borderRadius: BorderRadius.circular(12.0),\n              ),\n              minimumSize: const Size(double.infinity, 56),\n              textStyle: const TextStyle(\n                fontSize: 16,\n                fontWeight: FontWeight.bold,\n              ),\n            ),\n          ),\n          outlinedButtonTheme: OutlinedButtonThemeData(\n            style: OutlinedButton.styleFrom(\n              foregroundColor: const Color(0xFFFF6B35),\n              side: const BorderSide(color: Color(0xFFFF6B35)),\n              shape: RoundedRectangleBorder(\n                borderRadius: BorderRadius.circular(12.0),\n              ),\n              minimumSize: const Size(double.infinity, 56),\n              textStyle: const TextStyle(\n                fontSize: 16,\n                fontWeight: FontWeight.bold,\n              ),\n            ),\n          ),\n        ),\n        home: BlocBuilder<AuthBloc, AuthState>(\n          builder: (context, state) {\n            // Show loading indicator while checking auth status\n            if (state.status == AuthStatus.initial) {\n              return const Scaffold(\n                body: Center(\n                  child: CircularProgressIndicator(\n                    color: Color(0xFFFF6B35),\n                  ),\n                ),\n              );\n            }\n\n            // Show login screen if not authenticated\n            if (state.status != AuthStatus.authenticated) {\n              return const LoginScreen();\n            }\n\n            // Show home screen if authenticated\n            return const SuccessScreen(\n              title: 'Welcome!',\n              message: 'You are successfully logged in.',\n            );\n          },\n        ),\n        routes: {\n          '/login': (context) => const LoginScreen(),\n          '/register': (context) => const RegisterScreen(),\n          '/success': (context) => const SuccessScreen(\n                title: 'Success!',\n                message: 'Operation completed successfully.',\n              ),\n        },\n      ),\n    );\n  }\n}\n","baseTimestamp":1754621991748,"deltas":[{"timestamp":1754622081866,"changes":[{"type":"INSERT","lineNumber":1,"content":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_event.dart';"},{"type":"INSERT","lineNumber":2,"content":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_state.dart';"}]},{"timestamp":1754622127027,"changes":[{"type":"MODIFY","lineNumber":3,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/login_screen.dart';","oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/login_screen.dart';"},{"type":"DELETE","lineNumber":8,"oldContent":"import 'package:firebase_auth/firebase_auth.dart';"},{"type":"INSERT","lineNumber":12,"content":"class App extends StatelessWidget {"},{"type":"INSERT","lineNumber":13,"content":"  const App({super.key});"},{"type":"INSERT","lineNumber":14,"content":""},{"type":"INSERT","lineNumber":15,"content":"  @override"},{"type":"INSERT","lineNumber":16,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":17,"content":"    return MaterialApp("},{"type":"INSERT","lineNumber":18,"content":"      title: 'Family Tree',"},{"type":"INSERT","lineNumber":19,"content":"      debugShowCheckedModeBanner: false,"},{"type":"INSERT","lineNumber":20,"content":"      theme: ThemeData("},{"type":"INSERT","lineNumber":21,"content":"        colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),"},{"type":"INSERT","lineNumber":22,"content":"        useMaterial3: true,"},{"type":"INSERT","lineNumber":23,"content":"      ),"},{"type":"INSERT","lineNumber":24,"content":"      home: BlocBuilder<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":25,"content":"        builder: (context, state) {"},{"type":"INSERT","lineNumber":26,"content":"          // Show loading indicator while checking auth status"},{"type":"INSERT","lineNumber":27,"content":"          if (state.status == AuthStatus.initial) {"},{"type":"INSERT","lineNumber":28,"content":"            return const Scaffold("},{"type":"INSERT","lineNumber":29,"content":"              body: Center(child: CircularProgressIndicator()),"},{"type":"INSERT","lineNumber":30,"content":"            );"},{"type":"INSERT","lineNumber":31,"content":"          }"},{"type":"INSERT","lineNumber":32,"content":""},{"type":"INSERT","lineNumber":33,"content":"          // Show login screen if not authenticated"},{"type":"INSERT","lineNumber":34,"content":"          if (state.status == AuthStatus.unauthenticated) {"},{"type":"INSERT","lineNumber":35,"content":"            return const LoginScreen();"},{"type":"INSERT","lineNumber":36,"content":"          }"},{"type":"INSERT","lineNumber":37,"content":""},{"type":"INSERT","lineNumber":38,"content":"          // Show home screen if authenticated"},{"type":"INSERT","lineNumber":39,"content":"          if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":40,"content":"            return const HomeScreen();"},{"type":"INSERT","lineNumber":41,"content":"          }"},{"type":"INSERT","lineNumber":42,"content":""},{"type":"INSERT","lineNumber":43,"content":"          // Show loading indicator for other states"},{"type":"INSERT","lineNumber":44,"content":"          return const Scaffold("},{"type":"INSERT","lineNumber":45,"content":"            body: Center(child: CircularProgressIndicator()),"},{"type":"INSERT","lineNumber":46,"content":"          );"},{"type":"INSERT","lineNumber":47,"content":"        },"},{"type":"INSERT","lineNumber":48,"content":"      ),"},{"type":"INSERT","lineNumber":49,"content":"      routes: {"},{"type":"INSERT","lineNumber":50,"content":"        '/login': (context) => const LoginScreen(),"},{"type":"INSERT","lineNumber":51,"content":"        '/register': (context) => const RegisterScreen(),"},{"type":"INSERT","lineNumber":52,"content":"        '/home': (context) => const HomeScreen(),"},{"type":"INSERT","lineNumber":53,"content":"        '/otp-verification': (context) => const OtpVerificationScreen(),"},{"type":"INSERT","lineNumber":54,"content":"        '/success': (context) => SuccessScreen("},{"type":"INSERT","lineNumber":55,"content":"              title: 'Success!',"},{"type":"INSERT","lineNumber":56,"content":"              message: 'Your account has been created successfully.',"},{"type":"INSERT","lineNumber":57,"content":"              onContinue: () {"},{"type":"INSERT","lineNumber":58,"content":"                Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":59,"content":"                  context,"},{"type":"INSERT","lineNumber":60,"content":"                  '/home',"},{"type":"INSERT","lineNumber":61,"content":"                  (route) => false,"},{"type":"INSERT","lineNumber":62,"content":"                );"},{"type":"INSERT","lineNumber":63,"content":"              },"},{"type":"INSERT","lineNumber":64,"content":"            ),"},{"type":"INSERT","lineNumber":65,"content":"      },"},{"type":"INSERT","lineNumber":66,"content":"      onGenerateRoute: (settings) {"},{"type":"INSERT","lineNumber":67,"content":"        // Handle named routes with arguments"},{"type":"INSERT","lineNumber":68,"content":"        if (settings.name == '/otp-verification') {"},{"type":"INSERT","lineNumber":69,"content":"          final args = settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":70,"content":"          return MaterialPageRoute("},{"type":"INSERT","lineNumber":71,"content":"            builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":72,"content":"              verificationId: args?['verificationId'],"},{"type":"INSERT","lineNumber":73,"content":"              phoneNumber: args?['phoneNumber'],"},{"type":"INSERT","lineNumber":74,"content":"              resendToken: args?['resendToken'],"},{"type":"INSERT","lineNumber":75,"content":"            ),"},{"type":"INSERT","lineNumber":76,"content":"          );"},{"type":"INSERT","lineNumber":77,"content":"        }"},{"type":"INSERT","lineNumber":78,"content":"        return null;"},{"type":"INSERT","lineNumber":79,"content":"      },"},{"type":"INSERT","lineNumber":80,"content":"    );"},{"type":"INSERT","lineNumber":81,"content":"  }"},{"type":"INSERT","lineNumber":82,"content":"}"},{"type":"INSERT","lineNumber":83,"content":""}]},{"timestamp":1754622142089,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_state.dart';","oldContent":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_event.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/login_screen.dart';"},{"type":"MODIFY","lineNumber":11,"content":"class App extends StatelessWidget {","oldContent":"class App extends StatelessWidget {"},{"type":"DELETE","lineNumber":14,"oldContent":"void main() async {"},{"type":"DELETE","lineNumber":16,"oldContent":"  WidgetsFlutterBinding.ensureInitialized();"},{"type":"DELETE","lineNumber":18,"oldContent":"  await Firebase.initializeApp();"},{"type":"DELETE","lineNumber":20,"oldContent":"  runApp(const MyApp());"},{"type":"DELETE","lineNumber":22,"oldContent":"}"},{"type":"DELETE","lineNumber":24,"oldContent":""},{"type":"DELETE","lineNumber":26,"oldContent":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":28,"oldContent":"  const MyApp({super.key});"},{"type":"DELETE","lineNumber":30,"oldContent":""},{"type":"DELETE","lineNumber":32,"oldContent":"  @override"},{"type":"DELETE","lineNumber":34,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":36,"oldContent":"    return MultiBlocProvider("},{"type":"DELETE","lineNumber":38,"oldContent":"      providers: ["},{"type":"DELETE","lineNumber":40,"oldContent":"        BlocProvider(create: (_) => AuthBloc()..add(CheckAuthStatus())),"},{"type":"DELETE","lineNumber":42,"oldContent":"      ],"},{"type":"DELETE","lineNumber":44,"oldContent":"      child: MaterialApp("},{"type":"DELETE","lineNumber":46,"oldContent":"        title: 'Family Tree App',"},{"type":"DELETE","lineNumber":48,"oldContent":"        debugShowCheckedModeBanner: false,"},{"type":"DELETE","lineNumber":50,"oldContent":"        theme: ThemeData("},{"type":"DELETE","lineNumber":52,"oldContent":"          primarySwatch: Colors.orange,"},{"type":"DELETE","lineNumber":54,"oldContent":"          scaffoldBackgroundColor: const Color(0xFFF5F5F5),"},{"type":"DELETE","lineNumber":56,"oldContent":"          appBarTheme: const AppBarTheme("},{"type":"DELETE","lineNumber":58,"oldContent":"            elevation: 0,"},{"type":"DELETE","lineNumber":60,"oldContent":"            backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":62,"oldContent":"            iconTheme: IconThemeData(color: Color(0xFF333333)),"},{"type":"DELETE","lineNumber":64,"oldContent":"            titleTextStyle: TextStyle("},{"type":"DELETE","lineNumber":66,"oldContent":"              color: Color(0xFF333333),"},{"type":"DELETE","lineNumber":68,"oldContent":"              fontSize: 20,"},{"type":"DELETE","lineNumber":70,"oldContent":"              fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":72,"oldContent":"            ),"},{"type":"DELETE","lineNumber":74,"oldContent":"          ),"},{"type":"DELETE","lineNumber":76,"oldContent":"          inputDecorationTheme: InputDecorationTheme("},{"type":"DELETE","lineNumber":78,"oldContent":"            filled: true,"},{"type":"DELETE","lineNumber":80,"oldContent":"            fillColor: Colors.white,"},{"type":"DELETE","lineNumber":82,"oldContent":"            contentPadding: const EdgeInsets.symmetric("},{"type":"DELETE","lineNumber":84,"oldContent":"              horizontal: 16,"},{"type":"DELETE","lineNumber":86,"oldContent":"              vertical: 16,"},{"type":"DELETE","lineNumber":88,"oldContent":"            ),"},{"type":"DELETE","lineNumber":90,"oldContent":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":52,"content":"        '/otp-verification': (context) {"},{"type":"INSERT","lineNumber":53,"content":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":54,"content":"          return OtpVerificationScreen("},{"type":"INSERT","lineNumber":55,"content":"            verificationId: args?['verificationId'] ?? '',"},{"type":"INSERT","lineNumber":56,"content":"            email: args?['email'] ?? '',"},{"type":"INSERT","lineNumber":57,"content":"          );"},{"type":"INSERT","lineNumber":58,"content":"        },"},{"type":"INSERT","lineNumber":59,"content":"        '/success': (context) {"},{"type":"INSERT","lineNumber":60,"content":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":61,"content":"          return SuccessScreen("},{"type":"INSERT","lineNumber":62,"content":"            title: args?['title'] ?? 'Success!',"},{"type":"INSERT","lineNumber":63,"content":"            message: args?['message'] ?? 'Operation completed successfully.',"},{"type":"INSERT","lineNumber":64,"content":"            buttonText: args?['buttonText'] ?? 'Continue',"},{"type":"INSERT","lineNumber":65,"content":"            onButtonPressed: () {"},{"type":"INSERT","lineNumber":66,"content":"              Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":67,"content":"                context,"},{"type":"INSERT","lineNumber":68,"content":"                '/home',"},{"type":"INSERT","lineNumber":69,"content":"                (route) => false,"},{"type":"INSERT","lineNumber":70,"content":"              );"},{"type":"INSERT","lineNumber":71,"content":"            },"},{"type":"INSERT","lineNumber":72,"content":"          );"},{"type":"INSERT","lineNumber":73,"content":"        },"},{"type":"INSERT","lineNumber":74,"content":"      },"},{"type":"INSERT","lineNumber":75,"content":"      onGenerateRoute: (settings) {"},{"type":"INSERT","lineNumber":76,"content":"        // Handle named routes with arguments"},{"type":"INSERT","lineNumber":77,"content":"        if (settings.name == '/otp-verification') {"},{"type":"INSERT","lineNumber":78,"content":"          final args = settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":79,"content":"          return MaterialPageRoute("},{"type":"INSERT","lineNumber":80,"content":"            builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":81,"content":"              verificationId: args?['verificationId'],"},{"type":"INSERT","lineNumber":82,"content":"              phoneNumber: args?['phoneNumber'],"},{"type":"INSERT","lineNumber":83,"content":"              resendToken: args?['resendToken'],"},{"type":"INSERT","lineNumber":84,"content":"            ),"},{"type":"INSERT","lineNumber":85,"content":"          );"},{"type":"INSERT","lineNumber":86,"content":"        }"},{"type":"INSERT","lineNumber":87,"content":"        return null;"},{"type":"INSERT","lineNumber":88,"content":"      },"},{"type":"INSERT","lineNumber":89,"content":"    );"},{"type":"INSERT","lineNumber":90,"content":"  }"},{"type":"INSERT","lineNumber":91,"content":"}"},{"type":"INSERT","lineNumber":92,"content":""},{"type":"INSERT","lineNumber":93,"content":"void main() async {"},{"type":"INSERT","lineNumber":94,"content":"  WidgetsFlutterBinding.ensureInitialized();"},{"type":"INSERT","lineNumber":95,"content":"  await Firebase.initializeApp();"},{"type":"INSERT","lineNumber":96,"content":"  runApp(const MyApp());"},{"type":"INSERT","lineNumber":97,"content":"}"},{"type":"INSERT","lineNumber":98,"content":""},{"type":"INSERT","lineNumber":99,"content":"class MyApp extends StatelessWidget {"},{"type":"INSERT","lineNumber":100,"content":"  const MyApp({super.key});"},{"type":"INSERT","lineNumber":101,"content":""},{"type":"INSERT","lineNumber":102,"content":"  @override"},{"type":"INSERT","lineNumber":103,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":104,"content":"    return MultiBlocProvider("},{"type":"INSERT","lineNumber":105,"content":"      providers: ["},{"type":"INSERT","lineNumber":106,"content":"        BlocProvider(create: (_) => AuthBloc()..add(CheckAuthStatus())),"},{"type":"INSERT","lineNumber":107,"content":"      ],"},{"type":"INSERT","lineNumber":108,"content":"      child: MaterialApp("},{"type":"INSERT","lineNumber":109,"content":"        title: 'Family Tree App',"},{"type":"INSERT","lineNumber":110,"content":"        debugShowCheckedModeBanner: false,"},{"type":"INSERT","lineNumber":111,"content":"        theme: ThemeData("},{"type":"INSERT","lineNumber":112,"content":"          primarySwatch: Colors.orange,"},{"type":"INSERT","lineNumber":113,"content":"          scaffoldBackgroundColor: const Color(0xFFF5F5F5),"},{"type":"INSERT","lineNumber":114,"content":"          appBarTheme: const AppBarTheme("},{"type":"INSERT","lineNumber":115,"content":"            elevation: 0,"},{"type":"INSERT","lineNumber":116,"content":"            backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":117,"content":"            iconTheme: IconThemeData(color: Color(0xFF333333)),"},{"type":"INSERT","lineNumber":118,"content":"            titleTextStyle: TextStyle("},{"type":"INSERT","lineNumber":119,"content":"              color: Color(0xFF333333),"},{"type":"INSERT","lineNumber":120,"content":"              fontSize: 20,"},{"type":"INSERT","lineNumber":121,"content":"              fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":122,"content":"            ),"},{"type":"INSERT","lineNumber":123,"content":"          ),"},{"type":"INSERT","lineNumber":124,"content":"          inputDecorationTheme: InputDecorationTheme("},{"type":"INSERT","lineNumber":125,"content":"            filled: true,"},{"type":"INSERT","lineNumber":126,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":127,"content":"            contentPadding: const EdgeInsets.symmetric("},{"type":"INSERT","lineNumber":128,"content":"              horizontal: 16,"},{"type":"INSERT","lineNumber":129,"content":"              vertical: 16,"},{"type":"INSERT","lineNumber":130,"content":"            ),"},{"type":"INSERT","lineNumber":131,"content":"            border: OutlineInputBorder("},{"type":"DELETE","lineNumber":93,"oldContent":"        '/otp-verification': (context) => const OtpVerificationScreen(),"},{"type":"DELETE","lineNumber":95,"oldContent":"        '/success': (context) => SuccessScreen("},{"type":"DELETE","lineNumber":97,"oldContent":"              title: 'Success!',"},{"type":"DELETE","lineNumber":99,"oldContent":"              message: 'Your account has been created successfully.',"},{"type":"DELETE","lineNumber":101,"oldContent":"              onContinue: () {"},{"type":"DELETE","lineNumber":103,"oldContent":"                Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":105,"oldContent":"                  context,"},{"type":"DELETE","lineNumber":107,"oldContent":"                  '/home',"},{"type":"DELETE","lineNumber":109,"oldContent":"                  (route) => false,"},{"type":"DELETE","lineNumber":111,"oldContent":"                );"},{"type":"DELETE","lineNumber":113,"oldContent":"              },"},{"type":"DELETE","lineNumber":115,"oldContent":"            ),"},{"type":"DELETE","lineNumber":117,"oldContent":"      },"},{"type":"DELETE","lineNumber":119,"oldContent":"      onGenerateRoute: (settings) {"},{"type":"DELETE","lineNumber":121,"oldContent":"        // Handle named routes with arguments"},{"type":"DELETE","lineNumber":123,"oldContent":"        if (settings.name == '/otp-verification') {"},{"type":"DELETE","lineNumber":125,"oldContent":"          final args = settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":127,"oldContent":"          return MaterialPageRoute("},{"type":"DELETE","lineNumber":129,"oldContent":"            builder: (context) => OtpVerificationScreen("},{"type":"DELETE","lineNumber":131,"oldContent":"              verificationId: args?['verificationId'],"},{"type":"DELETE","lineNumber":133,"oldContent":"              phoneNumber: args?['phoneNumber'],"},{"type":"DELETE","lineNumber":135,"oldContent":"              resendToken: args?['resendToken'],"},{"type":"DELETE","lineNumber":137,"oldContent":"            ),"},{"type":"DELETE","lineNumber":139,"oldContent":"          );"},{"type":"DELETE","lineNumber":141,"oldContent":"        }"},{"type":"DELETE","lineNumber":143,"oldContent":"        return null;"},{"type":"DELETE","lineNumber":145,"oldContent":"      },"},{"type":"DELETE","lineNumber":147,"oldContent":"    );"},{"type":"DELETE","lineNumber":149,"oldContent":"  }"},{"type":"DELETE","lineNumber":151,"oldContent":"}"},{"type":"DELETE","lineNumber":153,"oldContent":""}]},{"timestamp":1754628757284,"changes":[{"type":"DELETE","lineNumber":1,"oldContent":"import 'package:family_tree_firebase/features/auth/presentation/bloc/auth_state.dart';"},{"type":"MODIFY","lineNumber":10,"content":"class App extends StatelessWidget {","oldContent":"class App extends StatelessWidget {"},{"type":"INSERT","lineNumber":31,"content":"          // Show login screen if not authenticated"},{"type":"INSERT","lineNumber":32,"content":"          if (state.status == AuthStatus.unauthenticated) {"},{"type":"INSERT","lineNumber":33,"content":"            return const LoginScreen();"},{"type":"INSERT","lineNumber":34,"content":"          }"},{"type":"INSERT","lineNumber":35,"content":""},{"type":"INSERT","lineNumber":36,"content":"          // Show home screen if authenticated"},{"type":"INSERT","lineNumber":37,"content":"          if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":38,"content":"            return const HomeScreen();"},{"type":"INSERT","lineNumber":39,"content":"          }"},{"type":"INSERT","lineNumber":40,"content":""},{"type":"INSERT","lineNumber":41,"content":"          // Show loading indicator for other states"},{"type":"INSERT","lineNumber":42,"content":"          return const Scaffold("},{"type":"INSERT","lineNumber":43,"content":"            body: Center(child: CircularProgressIndicator()),"},{"type":"INSERT","lineNumber":44,"content":"          );"},{"type":"INSERT","lineNumber":45,"content":"        },"},{"type":"INSERT","lineNumber":46,"content":"      ),"},{"type":"INSERT","lineNumber":47,"content":"      routes: {"},{"type":"INSERT","lineNumber":48,"content":"        '/login': (context) => const LoginScreen(),"},{"type":"INSERT","lineNumber":49,"content":"        '/register': (context) => const RegisterScreen(),"},{"type":"INSERT","lineNumber":50,"content":"        '/home': (context) => const HomeScreen(),"},{"type":"DELETE","lineNumber":34,"oldContent":"          // Show login screen if not authenticated"},{"type":"DELETE","lineNumber":37,"oldContent":"          if (state.status == AuthStatus.unauthenticated) {"},{"type":"DELETE","lineNumber":38,"oldContent":"            email: args?['email'] ?? '',"},{"type":"INSERT","lineNumber":55,"content":"            phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":40,"oldContent":"            return const LoginScreen();"},{"type":"DELETE","lineNumber":43,"oldContent":"          }"},{"type":"DELETE","lineNumber":46,"oldContent":""},{"type":"DELETE","lineNumber":49,"oldContent":"          // Show home screen if authenticated"},{"type":"DELETE","lineNumber":51,"oldContent":"            onButtonPressed: () {"},{"type":"DELETE","lineNumber":52,"oldContent":"          if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":64,"content":"            onPressed: () {"},{"type":"DELETE","lineNumber":55,"oldContent":"            return const HomeScreen();"},{"type":"DELETE","lineNumber":58,"oldContent":"          }"},{"type":"DELETE","lineNumber":61,"oldContent":""},{"type":"DELETE","lineNumber":64,"oldContent":"          // Show loading indicator for other states"},{"type":"DELETE","lineNumber":67,"oldContent":"          return const Scaffold("},{"type":"DELETE","lineNumber":70,"oldContent":"            body: Center(child: CircularProgressIndicator()),"},{"type":"DELETE","lineNumber":73,"oldContent":"          );"},{"type":"DELETE","lineNumber":75,"oldContent":"              verificationId: args?['verificationId'],"},{"type":"DELETE","lineNumber":76,"oldContent":"        },"},{"type":"DELETE","lineNumber":77,"oldContent":"              phoneNumber: args?['phoneNumber'],"},{"type":"DELETE","lineNumber":78,"oldContent":"              resendToken: args?['resendToken'],"},{"type":"DELETE","lineNumber":79,"oldContent":"      ),"},{"type":"INSERT","lineNumber":80,"content":"              verificationId: args?['verificationId'] ?? '',"},{"type":"INSERT","lineNumber":81,"content":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":82,"oldContent":"      routes: {"},{"type":"DELETE","lineNumber":85,"oldContent":"        '/login': (context) => const LoginScreen(),"},{"type":"DELETE","lineNumber":88,"oldContent":"        '/register': (context) => const RegisterScreen(),"},{"type":"DELETE","lineNumber":91,"oldContent":"        '/home': (context) => const HomeScreen(),"},{"type":"DELETE","lineNumber":93,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":96,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":99,"oldContent":"            ),"},{"type":"DELETE","lineNumber":102,"oldContent":"            enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":105,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":108,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":111,"oldContent":"            ),"},{"type":"DELETE","lineNumber":114,"oldContent":"            focusedBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":117,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":120,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFFF6B35)),"},{"type":"DELETE","lineNumber":123,"oldContent":"            ),"},{"type":"DELETE","lineNumber":126,"oldContent":"            errorBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":129,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":132,"oldContent":"              borderSide: const BorderSide(color: Colors.red),"},{"type":"DELETE","lineNumber":135,"oldContent":"            ),"},{"type":"DELETE","lineNumber":139,"oldContent":"          ),"},{"type":"DELETE","lineNumber":141,"oldContent":"          elevatedButtonTheme: ElevatedButtonThemeData("},{"type":"DELETE","lineNumber":144,"oldContent":"            style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":147,"oldContent":"              backgroundColor: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":150,"oldContent":"              foregroundColor: Colors.white,"},{"type":"INSERT","lineNumber":130,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":131,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":132,"content":"            ),"},{"type":"INSERT","lineNumber":133,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":134,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":135,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":136,"content":"            ),"},{"type":"INSERT","lineNumber":137,"content":"            focusedBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":138,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":139,"content":"              borderSide: const BorderSide(color: Color(0xFFFF6B35)),"},{"type":"INSERT","lineNumber":140,"content":"            ),"},{"type":"INSERT","lineNumber":141,"content":"            errorBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":142,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":143,"content":"              borderSide: const BorderSide(color: Colors.red),"},{"type":"INSERT","lineNumber":144,"content":"            ),"},{"type":"INSERT","lineNumber":145,"content":"          ),"},{"type":"INSERT","lineNumber":146,"content":"          elevatedButtonTheme: ElevatedButtonThemeData("},{"type":"INSERT","lineNumber":147,"content":"            style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":148,"content":"              backgroundColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":149,"content":"              foregroundColor: Colors.white,"}]},{"timestamp":1754630011688,"changes":[{"type":"MODIFY","lineNumber":10,"content":"class App extends StatelessWidget {","oldContent":"class App extends StatelessWidget {"},{"type":"MODIFY","lineNumber":31,"content":"          // Show login screen if not authenticated","oldContent":"          // Show login screen if not authenticated"},{"type":"DELETE","lineNumber":33,"oldContent":"        '/otp-verification': (context) {"},{"type":"DELETE","lineNumber":35,"oldContent":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":38,"oldContent":"          return OtpVerificationScreen("},{"type":"DELETE","lineNumber":40,"oldContent":"            verificationId: args?['verificationId'] ?? '',"},{"type":"DELETE","lineNumber":44,"oldContent":"          );"},{"type":"DELETE","lineNumber":47,"oldContent":"        },"},{"type":"DELETE","lineNumber":49,"oldContent":"        '/success': (context) {"},{"type":"DELETE","lineNumber":52,"oldContent":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":54,"oldContent":"          return SuccessScreen("},{"type":"DELETE","lineNumber":57,"oldContent":"            title: args?['title'] ?? 'Success!',"},{"type":"DELETE","lineNumber":59,"oldContent":"            message: args?['message'] ?? 'Operation completed successfully.',"},{"type":"INSERT","lineNumber":51,"content":"        '/otp-verification': (context) {"},{"type":"INSERT","lineNumber":52,"content":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":53,"content":"          return OtpVerificationScreen("},{"type":"INSERT","lineNumber":54,"content":"            verificationId: args?['verificationId'] ?? '',"},{"type":"INSERT","lineNumber":55,"content":"            phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"INSERT","lineNumber":56,"content":"          );"},{"type":"INSERT","lineNumber":57,"content":"        },"},{"type":"INSERT","lineNumber":58,"content":"        '/success': (context) {"},{"type":"INSERT","lineNumber":59,"content":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":60,"content":"          return SuccessScreen("},{"type":"INSERT","lineNumber":61,"content":"            title: args?['title'] ?? 'Success!',"},{"type":"INSERT","lineNumber":62,"content":"            message: args?['message'] ?? 'Operation completed successfully.',"},{"type":"INSERT","lineNumber":64,"content":"            onPressed: () {"},{"type":"DELETE","lineNumber":65,"oldContent":"            phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":72,"oldContent":"            onPressed: () {"},{"type":"MODIFY","lineNumber":82,"content":"            ),","oldContent":"            ),"},{"type":"INSERT","lineNumber":85,"content":"        // Handle home route"},{"type":"INSERT","lineNumber":86,"content":"        if (settings.name == '/home') {"},{"type":"INSERT","lineNumber":87,"content":"          return MaterialPageRoute(builder: (context) => const HomeScreen());"},{"type":"INSERT","lineNumber":88,"content":"        }"},{"type":"INSERT","lineNumber":91,"content":"      onUnknownRoute: (settings) {"},{"type":"INSERT","lineNumber":92,"content":"        // Handle unknown routes by redirecting to home or login"},{"type":"INSERT","lineNumber":93,"content":"        return MaterialPageRoute("},{"type":"INSERT","lineNumber":94,"content":"          builder: (context) => BlocBuilder<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":95,"content":"            builder: (context, state) {"},{"type":"INSERT","lineNumber":96,"content":"              if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":97,"content":"                return const HomeScreen();"},{"type":"INSERT","lineNumber":98,"content":"              }"},{"type":"INSERT","lineNumber":99,"content":"              return const LoginScreen();"},{"type":"INSERT","lineNumber":100,"content":"            },"},{"type":"INSERT","lineNumber":101,"content":"          ),"},{"type":"INSERT","lineNumber":102,"content":"        );"},{"type":"INSERT","lineNumber":103,"content":"      },"},{"type":"DELETE","lineNumber":115,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":117,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":134,"content":"              color: Color(0xFF333333),"},{"type":"INSERT","lineNumber":135,"content":"              fontSize: 20,"},{"type":"INSERT","lineNumber":136,"content":"              fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":138,"content":"          ),"},{"type":"INSERT","lineNumber":139,"content":"          inputDecorationTheme: InputDecorationTheme("},{"type":"INSERT","lineNumber":140,"content":"            filled: true,"},{"type":"INSERT","lineNumber":141,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":142,"content":"            contentPadding: const EdgeInsets.symmetric("},{"type":"INSERT","lineNumber":143,"content":"              horizontal: 16,"},{"type":"INSERT","lineNumber":144,"content":"              vertical: 16,"},{"type":"INSERT","lineNumber":145,"content":"            ),"},{"type":"INSERT","lineNumber":146,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":147,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":148,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":149,"content":"            ),"},{"type":"DELETE","lineNumber":121,"oldContent":"              color: Color(0xFF333333),"},{"type":"DELETE","lineNumber":123,"oldContent":"              fontSize: 20,"},{"type":"DELETE","lineNumber":126,"oldContent":"              fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":128,"oldContent":"            ),"},{"type":"DELETE","lineNumber":130,"oldContent":"          ),"},{"type":"DELETE","lineNumber":133,"oldContent":"          inputDecorationTheme: InputDecorationTheme("},{"type":"DELETE","lineNumber":136,"oldContent":"            filled: true,"},{"type":"DELETE","lineNumber":138,"oldContent":"            fillColor: Colors.white,"},{"type":"DELETE","lineNumber":141,"oldContent":"            contentPadding: const EdgeInsets.symmetric("},{"type":"DELETE","lineNumber":143,"oldContent":"              horizontal: 16,"},{"type":"DELETE","lineNumber":146,"oldContent":"              vertical: 16,"},{"type":"DELETE","lineNumber":148,"oldContent":"            ),"},{"type":"DELETE","lineNumber":149,"oldContent":"            border: OutlineInputBorder("}]},{"timestamp":1754638427075,"changes":[{"type":"INSERT","lineNumber":9,"content":""},{"type":"DELETE","lineNumber":10,"oldContent":"class App extends StatelessWidget {"},{"type":"DELETE","lineNumber":30,"oldContent":"          // Show login screen if not authenticated"},{"type":"DELETE","lineNumber":31,"oldContent":"          // Show login screen if not authenticated"},{"type":"INSERT","lineNumber":30,"content":""},{"type":"INSERT","lineNumber":31,"content":"          // Show registration screen first for new users"},{"type":"MODIFY","lineNumber":33,"content":"            // Check if it's a new user (not coming back from login)","oldContent":"            return const LoginScreen();"},{"type":"INSERT","lineNumber":34,"content":"            final isNewUser = ModalRoute.of(context)?.settings.arguments as bool? ?? true;"},{"type":"INSERT","lineNumber":35,"content":"            if (isNewUser) {"},{"type":"INSERT","lineNumber":36,"content":"              return const RegisterScreen();"},{"type":"INSERT","lineNumber":37,"content":"            } else {"},{"type":"INSERT","lineNumber":38,"content":"              return const LoginScreen();"},{"type":"INSERT","lineNumber":39,"content":"            }"},{"type":"DELETE","lineNumber":44,"oldContent":"        '/otp-verification': (context) {"},{"type":"INSERT","lineNumber":51,"content":"        },"},{"type":"INSERT","lineNumber":52,"content":"      ),"},{"type":"INSERT","lineNumber":53,"content":"      routes: {"},{"type":"INSERT","lineNumber":54,"content":"        '/login': (context) => const LoginScreen(),"},{"type":"INSERT","lineNumber":55,"content":"        '/register': (context) => const RegisterScreen(),"},{"type":"INSERT","lineNumber":56,"content":"        '/home': (context) => const HomeScreen(),"},{"type":"INSERT","lineNumber":57,"content":"        '/otp-verification': (context) {"},{"type":"DELETE","lineNumber":48,"oldContent":"        },"},{"type":"DELETE","lineNumber":51,"oldContent":"      ),"},{"type":"DELETE","lineNumber":53,"oldContent":"      routes: {"},{"type":"DELETE","lineNumber":56,"oldContent":"        '/login': (context) => const LoginScreen(),"},{"type":"DELETE","lineNumber":59,"oldContent":"        '/register': (context) => const RegisterScreen(),"},{"type":"DELETE","lineNumber":61,"oldContent":"        '/home': (context) => const HomeScreen(),"},{"type":"DELETE","lineNumber":64,"oldContent":"              Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":71,"content":"              Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":87,"content":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":82,"oldContent":"            ),"},{"type":"DELETE","lineNumber":86,"oldContent":"        return null;"},{"type":"DELETE","lineNumber":88,"oldContent":"      },"},{"type":"DELETE","lineNumber":90,"oldContent":"    );"},{"type":"INSERT","lineNumber":95,"content":"        return null;"},{"type":"INSERT","lineNumber":96,"content":"      },"},{"type":"INSERT","lineNumber":97,"content":"      onUnknownRoute: (settings) {"},{"type":"INSERT","lineNumber":98,"content":"        // Handle unknown routes by redirecting to home or login"},{"type":"INSERT","lineNumber":99,"content":"        return MaterialPageRoute("},{"type":"INSERT","lineNumber":100,"content":"          builder: (context) => BlocBuilder<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":101,"content":"            builder: (context, state) {"},{"type":"INSERT","lineNumber":102,"content":"              if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":103,"content":"                return const HomeScreen();"},{"type":"INSERT","lineNumber":104,"content":"              }"},{"type":"INSERT","lineNumber":105,"content":"              return const LoginScreen();"},{"type":"INSERT","lineNumber":106,"content":"            },"},{"type":"INSERT","lineNumber":107,"content":"          ),"},{"type":"INSERT","lineNumber":108,"content":"        );"},{"type":"INSERT","lineNumber":109,"content":"      },"},{"type":"INSERT","lineNumber":110,"content":"    );"},{"type":"DELETE","lineNumber":95,"oldContent":"      onUnknownRoute: (settings) {"},{"type":"DELETE","lineNumber":97,"oldContent":"        // Handle unknown routes by redirecting to home or login"},{"type":"DELETE","lineNumber":99,"oldContent":"        return MaterialPageRoute("},{"type":"DELETE","lineNumber":101,"oldContent":"          builder: (context) => BlocBuilder<AuthBloc, AuthState>("},{"type":"DELETE","lineNumber":103,"oldContent":"            builder: (context, state) {"},{"type":"DELETE","lineNumber":105,"oldContent":"              if (state.status == AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":107,"oldContent":"                return const HomeScreen();"},{"type":"DELETE","lineNumber":109,"oldContent":"              }"},{"type":"DELETE","lineNumber":111,"oldContent":"              return const LoginScreen();"},{"type":"DELETE","lineNumber":113,"oldContent":"            },"},{"type":"DELETE","lineNumber":115,"oldContent":"          ),"},{"type":"DELETE","lineNumber":117,"oldContent":"        );"},{"type":"DELETE","lineNumber":119,"oldContent":"      },"},{"type":"INSERT","lineNumber":140,"content":"              color: Color(0xFF333333),"},{"type":"INSERT","lineNumber":141,"content":"              fontSize: 20,"},{"type":"INSERT","lineNumber":142,"content":"              fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":144,"content":"          ),"},{"type":"INSERT","lineNumber":145,"content":"          inputDecorationTheme: InputDecorationTheme("},{"type":"INSERT","lineNumber":146,"content":"            filled: true,"},{"type":"INSERT","lineNumber":147,"content":"            fillColor: Colors.white,"},{"type":"INSERT","lineNumber":148,"content":"            contentPadding: const EdgeInsets.symmetric("},{"type":"INSERT","lineNumber":149,"content":"              horizontal: 16,"},{"type":"INSERT","lineNumber":150,"content":"              vertical: 16,"},{"type":"INSERT","lineNumber":151,"content":"            ),"},{"type":"INSERT","lineNumber":152,"content":"            border: OutlineInputBorder("},{"type":"INSERT","lineNumber":153,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":154,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":155,"content":"            ),"},{"type":"DELETE","lineNumber":143,"oldContent":"              color: Color(0xFF333333),"},{"type":"DELETE","lineNumber":145,"oldContent":"              fontSize: 20,"},{"type":"DELETE","lineNumber":147,"oldContent":"              fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":149,"oldContent":"          ),"},{"type":"DELETE","lineNumber":150,"oldContent":"          inputDecorationTheme: InputDecorationTheme("},{"type":"DELETE","lineNumber":152,"oldContent":"            filled: true,"},{"type":"DELETE","lineNumber":154,"oldContent":"            fillColor: Colors.white,"},{"type":"DELETE","lineNumber":155,"oldContent":"            contentPadding: const EdgeInsets.symmetric("},{"type":"DELETE","lineNumber":157,"oldContent":"              horizontal: 16,"},{"type":"DELETE","lineNumber":158,"oldContent":"              vertical: 16,"},{"type":"DELETE","lineNumber":160,"oldContent":"            ),"},{"type":"DELETE","lineNumber":162,"oldContent":"            border: OutlineInputBorder("},{"type":"DELETE","lineNumber":163,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":165,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":166,"oldContent":"            ),"}]},{"timestamp":1754652352274,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:family_tree_firebase/core/service_locator.dart';"},{"type":"MODIFY","lineNumber":16,"content":"    return MultiBlocProvider(","oldContent":"    return MaterialApp("},{"type":"INSERT","lineNumber":17,"content":"      providers: ["},{"type":"INSERT","lineNumber":18,"content":"        BlocProvider<AuthBloc>("},{"type":"INSERT","lineNumber":19,"content":"          create: (context) => sl<AuthBloc>(),"},{"type":"INSERT","lineNumber":20,"content":"        ),"},{"type":"INSERT","lineNumber":21,"content":"      ],"},{"type":"INSERT","lineNumber":22,"content":"      child: MaterialApp("},{"type":"DELETE","lineNumber":35,"oldContent":"          }"},{"type":"DELETE","lineNumber":37,"oldContent":""},{"type":"DELETE","lineNumber":39,"oldContent":"          // Show home screen if authenticated"},{"type":"DELETE","lineNumber":41,"oldContent":"          if (state.status == AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":43,"oldContent":"            return const HomeScreen();"},{"type":"INSERT","lineNumber":49,"content":"          // Show home screen if authenticated"},{"type":"INSERT","lineNumber":50,"content":"          if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":51,"content":"            return const HomeScreen();"},{"type":"INSERT","lineNumber":52,"content":"          }"},{"type":"INSERT","lineNumber":53,"content":""},{"type":"DELETE","lineNumber":51,"oldContent":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":52,"oldContent":"          return OtpVerificationScreen("},{"type":"DELETE","lineNumber":53,"oldContent":"            verificationId: args?['verificationId'] ?? '',"},{"type":"DELETE","lineNumber":54,"oldContent":"            phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":57,"oldContent":"          );"},{"type":"DELETE","lineNumber":60,"oldContent":"        },"},{"type":"DELETE","lineNumber":62,"oldContent":"        '/success': (context) {"},{"type":"INSERT","lineNumber":66,"content":"          return OtpVerificationScreen("},{"type":"INSERT","lineNumber":67,"content":"            verificationId: args?['verificationId'] ?? '',"},{"type":"INSERT","lineNumber":68,"content":"            phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"INSERT","lineNumber":69,"content":"          );"},{"type":"INSERT","lineNumber":70,"content":"        },"},{"type":"INSERT","lineNumber":71,"content":"        '/success': (context) {"},{"type":"INSERT","lineNumber":72,"content":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":78,"content":"              Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":76,"oldContent":"              Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":94,"content":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":91,"oldContent":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":95,"oldContent":"  }"},{"type":"DELETE","lineNumber":96,"oldContent":"}"},{"type":"DELETE","lineNumber":97,"oldContent":""},{"type":"DELETE","lineNumber":100,"oldContent":"void main() async {"},{"type":"DELETE","lineNumber":103,"oldContent":"  WidgetsFlutterBinding.ensureInitialized();"},{"type":"DELETE","lineNumber":106,"oldContent":"  await Firebase.initializeApp();"},{"type":"DELETE","lineNumber":109,"oldContent":"  runApp(const MyApp());"},{"type":"DELETE","lineNumber":112,"oldContent":"}"},{"type":"DELETE","lineNumber":115,"oldContent":""},{"type":"MODIFY","lineNumber":118,"content":"  }","oldContent":"class MyApp extends StatelessWidget {"},{"type":"INSERT","lineNumber":119,"content":"}"},{"type":"INSERT","lineNumber":120,"content":""},{"type":"INSERT","lineNumber":121,"content":"void main() async {"},{"type":"INSERT","lineNumber":122,"content":"  WidgetsFlutterBinding.ensureInitialized();"},{"type":"INSERT","lineNumber":123,"content":"  await Firebase.initializeApp();"},{"type":"INSERT","lineNumber":124,"content":"  runApp(const MyApp());"},{"type":"INSERT","lineNumber":125,"content":"}"},{"type":"INSERT","lineNumber":126,"content":""},{"type":"INSERT","lineNumber":127,"content":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":140,"oldContent":"            ),"},{"type":"DELETE","lineNumber":141,"oldContent":"            enabledBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":142,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":143,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":144,"oldContent":"            ),"},{"type":"DELETE","lineNumber":145,"oldContent":"            focusedBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":147,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":149,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFFF6B35)),"},{"type":"DELETE","lineNumber":153,"oldContent":"            errorBorder: OutlineInputBorder("},{"type":"DELETE","lineNumber":156,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"DELETE","lineNumber":159,"oldContent":"              borderSide: const BorderSide(color: Colors.red),"},{"type":"DELETE","lineNumber":163,"oldContent":"            ),"},{"type":"DELETE","lineNumber":166,"oldContent":"          ),"},{"type":"INSERT","lineNumber":163,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":164,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":165,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"INSERT","lineNumber":166,"content":"            ),"},{"type":"INSERT","lineNumber":167,"content":"            focusedBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":168,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":169,"content":"              borderSide: const BorderSide(color: Color(0xFFFF6B35)),"},{"type":"INSERT","lineNumber":170,"content":"            ),"},{"type":"INSERT","lineNumber":171,"content":"            errorBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":172,"content":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":173,"content":"              borderSide: const BorderSide(color: Colors.red),"},{"type":"INSERT","lineNumber":174,"content":"            ),"},{"type":"INSERT","lineNumber":175,"content":"          ),"},{"type":"DELETE","lineNumber":233,"oldContent":"    );"},{"type":"INSERT","lineNumber":240,"content":"    ));"}]},{"timestamp":1754652382328,"changes":[{"type":"DELETE","lineNumber":16,"oldContent":"    return MaterialApp("},{"type":"DELETE","lineNumber":19,"oldContent":"      debugShowCheckedModeBanner: false,"},{"type":"DELETE","lineNumber":21,"oldContent":"      theme: ThemeData("},{"type":"DELETE","lineNumber":23,"oldContent":"        colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),"},{"type":"DELETE","lineNumber":25,"oldContent":"        useMaterial3: true,"},{"type":"DELETE","lineNumber":27,"oldContent":"      ),"},{"type":"INSERT","lineNumber":23,"content":"        title: 'Family Tree',"},{"type":"INSERT","lineNumber":24,"content":"        debugShowCheckedModeBanner: false,"},{"type":"INSERT","lineNumber":25,"content":"        theme: ThemeData("},{"type":"INSERT","lineNumber":26,"content":"          colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),"},{"type":"INSERT","lineNumber":27,"content":"          useMaterial3: true,"},{"type":"INSERT","lineNumber":28,"content":"        ),"},{"type":"DELETE","lineNumber":49,"oldContent":"          // Show loading indicator for other states"},{"type":"DELETE","lineNumber":50,"oldContent":"          return const Scaffold("},{"type":"DELETE","lineNumber":52,"oldContent":"            body: Center(child: CircularProgressIndicator()),"},{"type":"MODIFY","lineNumber":54,"content":"          // Show loading indicator for other states","oldContent":"          );"},{"type":"INSERT","lineNumber":55,"content":"          return const Scaffold("},{"type":"INSERT","lineNumber":56,"content":"            body: Center(child: CircularProgressIndicator()),"},{"type":"INSERT","lineNumber":57,"content":"          );"},{"type":"DELETE","lineNumber":67,"oldContent":"          return SuccessScreen("},{"type":"DELETE","lineNumber":69,"oldContent":"            title: args?['title'] ?? 'Success!',"},{"type":"DELETE","lineNumber":71,"oldContent":"            message: args?['message'] ?? 'Operation completed successfully.',"},{"type":"DELETE","lineNumber":73,"oldContent":"            buttonText: args?['buttonText'] ?? 'Continue',"},{"type":"DELETE","lineNumber":75,"oldContent":"            onPressed: () {"},{"type":"DELETE","lineNumber":77,"oldContent":"                context,"},{"type":"INSERT","lineNumber":73,"content":"          return SuccessScreen("},{"type":"INSERT","lineNumber":74,"content":"            title: args?['title'] ?? 'Success!',"},{"type":"INSERT","lineNumber":75,"content":"            message: args?['message'] ?? 'Operation completed successfully.',"},{"type":"INSERT","lineNumber":76,"content":"            buttonText: args?['buttonText'] ?? 'Continue',"},{"type":"INSERT","lineNumber":77,"content":"            onPressed: () {"},{"type":"INSERT","lineNumber":78,"content":"              Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":79,"content":"                context,"},{"type":"DELETE","lineNumber":84,"oldContent":"              Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":94,"content":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":100,"oldContent":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"INSERT","lineNumber":116,"content":"      },"},{"type":"INSERT","lineNumber":117,"content":"    );"},{"type":"DELETE","lineNumber":118,"oldContent":"      },"},{"type":"DELETE","lineNumber":120,"oldContent":"    );"},{"type":"DELETE","lineNumber":122,"oldContent":"  const MyApp({super.key});"},{"type":"DELETE","lineNumber":124,"oldContent":""},{"type":"DELETE","lineNumber":126,"oldContent":"  @override"},{"type":"DELETE","lineNumber":128,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":130,"oldContent":"    return MultiBlocProvider("},{"type":"DELETE","lineNumber":132,"oldContent":"      providers: ["},{"type":"INSERT","lineNumber":128,"content":"  const MyApp({super.key});"},{"type":"INSERT","lineNumber":129,"content":""},{"type":"INSERT","lineNumber":130,"content":"  @override"},{"type":"INSERT","lineNumber":131,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":132,"content":"    return MultiBlocProvider("},{"type":"INSERT","lineNumber":133,"content":"      providers: ["},{"type":"DELETE","lineNumber":159,"oldContent":"            enabledBorder: OutlineInputBorder("},{"type":"MODIFY","lineNumber":160,"content":"              borderRadius: BorderRadius.circular(12.0),","oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"INSERT","lineNumber":162,"content":"            ),"},{"type":"INSERT","lineNumber":163,"content":"            enabledBorder: OutlineInputBorder("},{"type":"INSERT","lineNumber":165,"content":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":166,"oldContent":"              borderSide: const BorderSide(color: Color(0xFFE0E0E0)),"},{"type":"DELETE","lineNumber":168,"oldContent":"            ),"},{"type":"DELETE","lineNumber":170,"oldContent":"          elevatedButtonTheme: ElevatedButtonThemeData("},{"type":"DELETE","lineNumber":172,"oldContent":"            style: ElevatedButton.styleFrom("},{"type":"DELETE","lineNumber":174,"oldContent":"              backgroundColor: const Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":176,"oldContent":"              foregroundColor: Colors.white,"},{"type":"DELETE","lineNumber":178,"oldContent":"              elevation: 0,"},{"type":"DELETE","lineNumber":180,"oldContent":"              shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":176,"content":"          elevatedButtonTheme: ElevatedButtonThemeData("},{"type":"INSERT","lineNumber":177,"content":"            style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":178,"content":"              backgroundColor: const Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":179,"content":"              foregroundColor: Colors.white,"},{"type":"INSERT","lineNumber":180,"content":"              elevation: 0,"},{"type":"INSERT","lineNumber":181,"content":"              shape: RoundedRectangleBorder("},{"type":"INSERT","lineNumber":240,"content":"    );"},{"type":"DELETE","lineNumber":243,"oldContent":"    ));"}]},{"timestamp":1754652644300,"changes":[{"type":"INSERT","lineNumber":20,"content":"        ),"},{"type":"INSERT","lineNumber":21,"content":"      ],"},{"type":"INSERT","lineNumber":22,"content":"      child: MaterialApp("},{"type":"DELETE","lineNumber":22,"oldContent":"        ),"},{"type":"DELETE","lineNumber":25,"oldContent":"      ],"},{"type":"DELETE","lineNumber":28,"oldContent":"      child: MaterialApp("},{"type":"INSERT","lineNumber":51,"content":"            return const HomeScreen();"},{"type":"INSERT","lineNumber":52,"content":"          }"},{"type":"INSERT","lineNumber":53,"content":""},{"type":"DELETE","lineNumber":53,"oldContent":"            return const HomeScreen();"},{"type":"DELETE","lineNumber":55,"oldContent":"          }"},{"type":"DELETE","lineNumber":57,"oldContent":""},{"type":"INSERT","lineNumber":70,"content":"        },"},{"type":"INSERT","lineNumber":71,"content":"        '/success': (context) {"},{"type":"INSERT","lineNumber":72,"content":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":72,"oldContent":"        },"},{"type":"DELETE","lineNumber":75,"oldContent":"        '/success': (context) {"},{"type":"DELETE","lineNumber":78,"oldContent":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"MODIFY","lineNumber":117,"content":"        ","oldContent":"  }"},{"type":"INSERT","lineNumber":119,"content":"  }"},{"type":"INSERT","lineNumber":126,"content":"}"},{"type":"INSERT","lineNumber":127,"content":""},{"type":"INSERT","lineNumber":128,"content":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":127,"oldContent":"}"},{"type":"DELETE","lineNumber":130,"oldContent":""},{"type":"DELETE","lineNumber":133,"oldContent":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":159,"oldContent":"              borderRadius: BorderRadius.circular(12.0),"},{"type":"MODIFY","lineNumber":161,"content":"              borderRadius: BorderRadius.circular(12.0),","oldContent":"            ),"},{"type":"INSERT","lineNumber":163,"content":"            ),"},{"type":"DELETE","lineNumber":165,"oldContent":"            ),"},{"type":"INSERT","lineNumber":167,"content":"            ),"},{"type":"INSERT","lineNumber":174,"content":"              borderSide: const BorderSide(color: Colors.red),"},{"type":"INSERT","lineNumber":175,"content":"            ),"},{"type":"INSERT","lineNumber":176,"content":"          ),"},{"type":"DELETE","lineNumber":175,"oldContent":"              borderSide: const BorderSide(color: Colors.red),"},{"type":"DELETE","lineNumber":178,"oldContent":"            ),"},{"type":"DELETE","lineNumber":181,"oldContent":"          ),"}]},{"timestamp":1754652658405,"changes":[{"type":"DELETE","lineNumber":21,"oldContent":"        title: 'Family Tree',"},{"type":"MODIFY","lineNumber":23,"content":"        title: 'Family Tree',","oldContent":"        debugShowCheckedModeBanner: false,"},{"type":"INSERT","lineNumber":24,"content":"        debugShowCheckedModeBanner: false,"},{"type":"DELETE","lineNumber":52,"oldContent":"          // Show loading indicator for other states"},{"type":"MODIFY","lineNumber":54,"content":"          // Show loading indicator for other states","oldContent":"          return const Scaffold("},{"type":"INSERT","lineNumber":55,"content":"          return const Scaffold("},{"type":"DELETE","lineNumber":71,"oldContent":"          return SuccessScreen("},{"type":"MODIFY","lineNumber":73,"content":"          return SuccessScreen(","oldContent":"            title: args?['title'] ?? 'Success!',"},{"type":"INSERT","lineNumber":74,"content":"            title: args?['title'] ?? 'Success!',"},{"type":"MODIFY","lineNumber":117,"content":"","oldContent":"        "},{"type":"DELETE","lineNumber":126,"oldContent":"  const MyApp({super.key});"},{"type":"MODIFY","lineNumber":129,"content":"  const MyApp({super.key});","oldContent":""},{"type":"INSERT","lineNumber":130,"content":""},{"type":"DELETE","lineNumber":174,"oldContent":"          elevatedButtonTheme: ElevatedButtonThemeData("},{"type":"MODIFY","lineNumber":177,"content":"          elevatedButtonTheme: ElevatedButtonThemeData(","oldContent":"            style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":178,"content":"            style: ElevatedButton.styleFrom("}]},{"timestamp":1754652853712,"changes":[{"type":"INSERT","lineNumber":10,"content":"import 'package:flutter/services.dart';"},{"type":"INSERT","lineNumber":11,"content":"import 'package:get_storage/get_storage.dart';"},{"type":"DELETE","lineNumber":11,"oldContent":"class App extends StatelessWidget {"},{"type":"DELETE","lineNumber":12,"oldContent":"  const App({super.key});"},{"type":"DELETE","lineNumber":13,"oldContent":""},{"type":"DELETE","lineNumber":14,"oldContent":"  @override"},{"type":"DELETE","lineNumber":15,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":16,"oldContent":"    return MultiBlocProvider("},{"type":"DELETE","lineNumber":17,"oldContent":"      providers: ["},{"type":"DELETE","lineNumber":18,"oldContent":"        BlocProvider<AuthBloc>("},{"type":"DELETE","lineNumber":19,"oldContent":"          create: (context) => sl<AuthBloc>(),"},{"type":"DELETE","lineNumber":20,"oldContent":"        ),"},{"type":"DELETE","lineNumber":21,"oldContent":"      ],"},{"type":"DELETE","lineNumber":22,"oldContent":"        title: 'Family Tree',"},{"type":"DELETE","lineNumber":23,"oldContent":"        debugShowCheckedModeBanner: false,"},{"type":"DELETE","lineNumber":24,"oldContent":"      child: MaterialApp("},{"type":"DELETE","lineNumber":25,"oldContent":"        theme: ThemeData("},{"type":"DELETE","lineNumber":26,"oldContent":"          colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),"},{"type":"DELETE","lineNumber":27,"oldContent":"          useMaterial3: true,"},{"type":"DELETE","lineNumber":28,"oldContent":"        ),"},{"type":"DELETE","lineNumber":29,"oldContent":"      home: BlocBuilder<AuthBloc, AuthState>("},{"type":"DELETE","lineNumber":30,"oldContent":"        builder: (context, state) {"},{"type":"DELETE","lineNumber":31,"oldContent":"          // Show loading indicator while checking auth status"},{"type":"DELETE","lineNumber":32,"oldContent":"          if (state.status == AuthStatus.initial) {"},{"type":"DELETE","lineNumber":33,"oldContent":"            return const Scaffold("},{"type":"DELETE","lineNumber":34,"oldContent":"              body: Center(child: CircularProgressIndicator()),"},{"type":"DELETE","lineNumber":35,"oldContent":"            );"},{"type":"DELETE","lineNumber":36,"oldContent":"          }"},{"type":"DELETE","lineNumber":37,"oldContent":""},{"type":"DELETE","lineNumber":38,"oldContent":"          // Show registration screen first for new users"},{"type":"DELETE","lineNumber":39,"oldContent":"          if (state.status == AuthStatus.unauthenticated) {"},{"type":"DELETE","lineNumber":40,"oldContent":"            // Check if it's a new user (not coming back from login)"},{"type":"DELETE","lineNumber":41,"oldContent":"            final isNewUser = ModalRoute.of(context)?.settings.arguments as bool? ?? true;"},{"type":"DELETE","lineNumber":42,"oldContent":"            if (isNewUser) {"},{"type":"DELETE","lineNumber":43,"oldContent":"              return const RegisterScreen();"},{"type":"DELETE","lineNumber":44,"oldContent":"            } else {"},{"type":"DELETE","lineNumber":45,"oldContent":"              return const LoginScreen();"},{"type":"DELETE","lineNumber":46,"oldContent":"            }"},{"type":"DELETE","lineNumber":47,"oldContent":"          }"},{"type":"DELETE","lineNumber":48,"oldContent":""},{"type":"DELETE","lineNumber":49,"oldContent":"          // Show home screen if authenticated"},{"type":"DELETE","lineNumber":50,"oldContent":"          if (state.status == AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":51,"oldContent":"            return const HomeScreen();"},{"type":"DELETE","lineNumber":52,"oldContent":"          }"},{"type":"DELETE","lineNumber":53,"oldContent":"          // Show loading indicator for other states"},{"type":"DELETE","lineNumber":54,"oldContent":"          return const Scaffold("},{"type":"DELETE","lineNumber":55,"oldContent":""},{"type":"DELETE","lineNumber":56,"oldContent":"            body: Center(child: CircularProgressIndicator()),"},{"type":"DELETE","lineNumber":57,"oldContent":"          );"},{"type":"DELETE","lineNumber":58,"oldContent":"        },"},{"type":"DELETE","lineNumber":59,"oldContent":"      ),"},{"type":"DELETE","lineNumber":60,"oldContent":"      routes: {"},{"type":"DELETE","lineNumber":61,"oldContent":"        '/login': (context) => const LoginScreen(),"},{"type":"DELETE","lineNumber":62,"oldContent":"        '/register': (context) => const RegisterScreen(),"},{"type":"DELETE","lineNumber":63,"oldContent":"        '/home': (context) => const HomeScreen(),"},{"type":"DELETE","lineNumber":64,"oldContent":"        '/otp-verification': (context) {"},{"type":"DELETE","lineNumber":65,"oldContent":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":66,"oldContent":"          return OtpVerificationScreen("},{"type":"DELETE","lineNumber":67,"oldContent":"            verificationId: args?['verificationId'] ?? '',"},{"type":"DELETE","lineNumber":68,"oldContent":"            phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":69,"oldContent":"          );"},{"type":"DELETE","lineNumber":70,"oldContent":"        },"},{"type":"DELETE","lineNumber":71,"oldContent":"        '/success': (context) {"},{"type":"DELETE","lineNumber":72,"oldContent":"          return SuccessScreen("},{"type":"DELETE","lineNumber":73,"oldContent":"            title: args?['title'] ?? 'Success!',"},{"type":"DELETE","lineNumber":74,"oldContent":"          final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":75,"oldContent":"            message: args?['message'] ?? 'Operation completed successfully.',"},{"type":"DELETE","lineNumber":76,"oldContent":"            buttonText: args?['buttonText'] ?? 'Continue',"},{"type":"DELETE","lineNumber":77,"oldContent":"            onPressed: () {"},{"type":"DELETE","lineNumber":78,"oldContent":"              Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":79,"oldContent":"                context,"},{"type":"DELETE","lineNumber":80,"oldContent":"                '/home',"},{"type":"DELETE","lineNumber":81,"oldContent":"                (route) => false,"},{"type":"DELETE","lineNumber":82,"oldContent":"              );"},{"type":"DELETE","lineNumber":83,"oldContent":"            },"},{"type":"DELETE","lineNumber":84,"oldContent":"          );"},{"type":"DELETE","lineNumber":85,"oldContent":"        },"},{"type":"DELETE","lineNumber":86,"oldContent":"      },"},{"type":"DELETE","lineNumber":87,"oldContent":"      onGenerateRoute: (settings) {"},{"type":"DELETE","lineNumber":88,"oldContent":"        // Handle named routes with arguments"},{"type":"DELETE","lineNumber":89,"oldContent":"        if (settings.name == '/otp-verification') {"},{"type":"DELETE","lineNumber":90,"oldContent":"          final args = settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":91,"oldContent":"          return MaterialPageRoute("},{"type":"DELETE","lineNumber":92,"oldContent":"            builder: (context) => OtpVerificationScreen("},{"type":"DELETE","lineNumber":93,"oldContent":"              verificationId: args?['verificationId'] ?? '',"},{"type":"DELETE","lineNumber":94,"oldContent":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"INSERT","lineNumber":13,"content":"void main() async {"},{"type":"INSERT","lineNumber":14,"content":"  WidgetsFlutterBinding.ensureInitialized();"},{"type":"INSERT","lineNumber":15,"content":"  "},{"type":"INSERT","lineNumber":16,"content":"  try {"},{"type":"INSERT","lineNumber":17,"content":"    // Initialize local storage"},{"type":"INSERT","lineNumber":18,"content":"    await GetStorage.init();"},{"type":"INSERT","lineNumber":19,"content":"    "},{"type":"INSERT","lineNumber":20,"content":"    // Initialize Firebase"},{"type":"INSERT","lineNumber":21,"content":"    await Firebase.initializeApp("},{"type":"INSERT","lineNumber":22,"content":"      options: DefaultFirebaseOptions.currentPlatform,"},{"type":"INSERT","lineNumber":23,"content":"    );"},{"type":"INSERT","lineNumber":24,"content":"    "},{"type":"INSERT","lineNumber":25,"content":"    // Initialize dependency injection"},{"type":"INSERT","lineNumber":26,"content":"    await di.init();"},{"type":"INSERT","lineNumber":27,"content":"    "},{"type":"INSERT","lineNumber":28,"content":"    // Set preferred orientations"},{"type":"INSERT","lineNumber":29,"content":"    await SystemChrome.setPreferredOrientations(["},{"type":"INSERT","lineNumber":30,"content":"      DeviceOrientation.portraitUp,"},{"type":"INSERT","lineNumber":31,"content":"      DeviceOrientation.portraitDown,"},{"type":"INSERT","lineNumber":32,"content":"    ]);"},{"type":"INSERT","lineNumber":33,"content":"    "},{"type":"INSERT","lineNumber":34,"content":"    // Set system UI overlay style"},{"type":"INSERT","lineNumber":35,"content":"    SystemChrome.setSystemUIOverlayStyle(const SystemUiOverlayStyle("},{"type":"INSERT","lineNumber":36,"content":"      statusBarColor: Colors.transparent,"},{"type":"INSERT","lineNumber":37,"content":"      statusBarIconBrightness: Brightness.dark,"},{"type":"INSERT","lineNumber":38,"content":"      statusBarBrightness: Brightness.light,"},{"type":"INSERT","lineNumber":39,"content":"    ));"},{"type":"INSERT","lineNumber":40,"content":"    "},{"type":"INSERT","lineNumber":41,"content":"    runApp(const MyApp());"},{"type":"INSERT","lineNumber":42,"content":"  } catch (e, stackTrace) {"},{"type":"INSERT","lineNumber":43,"content":"    // Handle initialization errors"},{"type":"INSERT","lineNumber":44,"content":"    debugPrint('Initialization error: $e');"},{"type":"INSERT","lineNumber":45,"content":"    debugPrint('Stack trace: $stackTrace');"},{"type":"INSERT","lineNumber":46,"content":"    "},{"type":"INSERT","lineNumber":47,"content":"    runApp("},{"type":"INSERT","lineNumber":48,"content":"      MaterialApp("},{"type":"INSERT","lineNumber":49,"content":"        home: Scaffold("},{"type":"INSERT","lineNumber":50,"content":"          body: Center("},{"type":"INSERT","lineNumber":51,"content":"            child: Column("},{"type":"INSERT","lineNumber":52,"content":"              mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":53,"content":"              children: ["},{"type":"INSERT","lineNumber":54,"content":"                const Text("},{"type":"INSERT","lineNumber":55,"content":"                  'Initialization Error',"},{"type":"INSERT","lineNumber":56,"content":"                  style: TextStyle(fontSize: 20, fontWeight: FontWeight.bold),"},{"type":"INSERT","lineNumber":57,"content":"                ),"},{"type":"INSERT","lineNumber":58,"content":"                const SizedBox(height: 16),"},{"type":"INSERT","lineNumber":59,"content":"                Text("},{"type":"INSERT","lineNumber":60,"content":"                  e.toString(),"},{"type":"INSERT","lineNumber":61,"content":"                  textAlign: TextAlign.center,"},{"type":"INSERT","lineNumber":62,"content":"                  style: const TextStyle(color: Colors.red),"},{"type":"INSERT","lineNumber":63,"content":"                ),"},{"type":"INSERT","lineNumber":64,"content":"              ],"},{"type":"DELETE","lineNumber":96,"oldContent":"          );"},{"type":"DELETE","lineNumber":97,"oldContent":"        }"},{"type":"DELETE","lineNumber":98,"oldContent":"        // Handle home route"},{"type":"DELETE","lineNumber":99,"oldContent":"        if (settings.name == '/home') {"},{"type":"DELETE","lineNumber":100,"oldContent":"          return MaterialPageRoute(builder: (context) => const HomeScreen());"},{"type":"DELETE","lineNumber":101,"oldContent":"        }"},{"type":"DELETE","lineNumber":102,"oldContent":"        return null;"},{"type":"DELETE","lineNumber":103,"oldContent":"      },"},{"type":"DELETE","lineNumber":104,"oldContent":"      onUnknownRoute: (settings) {"},{"type":"DELETE","lineNumber":105,"oldContent":"        // Handle unknown routes by redirecting to home or login"},{"type":"DELETE","lineNumber":106,"oldContent":"        return MaterialPageRoute("},{"type":"DELETE","lineNumber":107,"oldContent":"          builder: (context) => BlocBuilder<AuthBloc, AuthState>("},{"type":"DELETE","lineNumber":108,"oldContent":"            builder: (context, state) {"},{"type":"DELETE","lineNumber":109,"oldContent":"              if (state.status == AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":110,"oldContent":"                return const HomeScreen();"},{"type":"DELETE","lineNumber":111,"oldContent":"              }"},{"type":"DELETE","lineNumber":112,"oldContent":"              return const LoginScreen();"},{"type":"DELETE","lineNumber":113,"oldContent":"            },"},{"type":"DELETE","lineNumber":115,"oldContent":"        );"},{"type":"DELETE","lineNumber":116,"oldContent":"      },"},{"type":"DELETE","lineNumber":117,"oldContent":""},{"type":"INSERT","lineNumber":67,"content":"        ),"},{"type":"INSERT","lineNumber":68,"content":"      ),"},{"type":"DELETE","lineNumber":122,"oldContent":"void main() async {"},{"type":"DELETE","lineNumber":123,"oldContent":"  WidgetsFlutterBinding.ensureInitialized();"},{"type":"DELETE","lineNumber":124,"oldContent":"  await Firebase.initializeApp();"},{"type":"DELETE","lineNumber":125,"oldContent":"  runApp(const MyApp());"},{"type":"DELETE","lineNumber":126,"oldContent":"}"},{"type":"DELETE","lineNumber":127,"oldContent":""},{"type":"INSERT","lineNumber":73,"content":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":130,"oldContent":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":135,"oldContent":"        BlocProvider(create: (_) => AuthBloc()..add(CheckAuthStatus())),"},{"type":"INSERT","lineNumber":80,"content":"        BlocProvider<AuthBloc>("},{"type":"INSERT","lineNumber":81,"content":"          create: (context) => sl<AuthBloc>()..add(CheckAuthStatus()),"},{"type":"INSERT","lineNumber":82,"content":"        ),"},{"type":"DELETE","lineNumber":138,"oldContent":"        title: 'Family Tree App',"},{"type":"INSERT","lineNumber":85,"content":"        title: 'Family Tree',"},{"type":"INSERT","lineNumber":90,"content":"          colorScheme: ColorScheme.fromSeed(seedColor: Colors.orange),"},{"type":"INSERT","lineNumber":91,"content":"          useMaterial3: true,"},{"type":"DELETE","lineNumber":175,"oldContent":"            style: ElevatedButton.styleFrom("},{"type":"INSERT","lineNumber":124,"content":"            ),"},{"type":"INSERT","lineNumber":125,"content":"          ),"},{"type":"DELETE","lineNumber":178,"oldContent":"          ),"},{"type":"DELETE","lineNumber":220,"oldContent":"            // Show login screen if not authenticated"},{"type":"DELETE","lineNumber":221,"oldContent":"            if (state.status != AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":222,"oldContent":"              return const LoginScreen();"},{"type":"INSERT","lineNumber":169,"content":"            // Show registration screen first for new users"},{"type":"INSERT","lineNumber":170,"content":"            if (state.status == AuthStatus.unauthenticated) {"},{"type":"INSERT","lineNumber":171,"content":"              // Check if it's a new user (not coming back from login)"},{"type":"INSERT","lineNumber":172,"content":"              final isNewUser = ModalRoute.of(context)?.settings.arguments as bool? ?? true;"},{"type":"INSERT","lineNumber":173,"content":"              if (isNewUser) {"},{"type":"INSERT","lineNumber":174,"content":"                return const RegisterScreen();"},{"type":"INSERT","lineNumber":175,"content":"              } else {"},{"type":"INSERT","lineNumber":176,"content":"                return const LoginScreen();"},{"type":"INSERT","lineNumber":177,"content":"              }"},{"type":"DELETE","lineNumber":226,"oldContent":"            return const SuccessScreen("},{"type":"DELETE","lineNumber":227,"oldContent":"              title: 'Welcome!',"},{"type":"DELETE","lineNumber":228,"oldContent":"              message: 'You are successfully logged in.',"},{"type":"INSERT","lineNumber":181,"content":"            if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":182,"content":"              return const HomeScreen();"},{"type":"INSERT","lineNumber":183,"content":"            }"},{"type":"INSERT","lineNumber":184,"content":""},{"type":"INSERT","lineNumber":185,"content":"            // Show loading indicator for other states"},{"type":"INSERT","lineNumber":186,"content":"            return const Scaffold("},{"type":"INSERT","lineNumber":187,"content":"              body: Center(child: CircularProgressIndicator()),"},{"type":"DELETE","lineNumber":235,"oldContent":"          '/success': (context) => const SuccessScreen("},{"type":"DELETE","lineNumber":236,"oldContent":"                title: 'Success!',"},{"type":"DELETE","lineNumber":237,"oldContent":"                message: 'Operation completed successfully.',"},{"type":"INSERT","lineNumber":194,"content":"          '/home': (context) => const HomeScreen(),"},{"type":"INSERT","lineNumber":195,"content":"          '/otp-verification': (context) {"},{"type":"INSERT","lineNumber":196,"content":"            final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":197,"content":"            return OtpVerificationScreen("},{"type":"INSERT","lineNumber":198,"content":"              verificationId: args?['verificationId'] ?? '',"},{"type":"INSERT","lineNumber":199,"content":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"INSERT","lineNumber":200,"content":"            );"},{"type":"INSERT","lineNumber":201,"content":"          },"},{"type":"INSERT","lineNumber":202,"content":"          '/success': (context) {"},{"type":"INSERT","lineNumber":203,"content":"            final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":204,"content":"            return SuccessScreen("},{"type":"INSERT","lineNumber":205,"content":"              title: args?['title'] ?? 'Success!',"},{"type":"INSERT","lineNumber":206,"content":"              message: args?['message'] ?? 'Operation completed successfully.',"},{"type":"INSERT","lineNumber":207,"content":"              buttonText: args?['buttonText'] ?? 'Continue',"},{"type":"INSERT","lineNumber":208,"content":"              onPressed: () {"},{"type":"INSERT","lineNumber":209,"content":"                Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":210,"content":"                  context,"},{"type":"INSERT","lineNumber":211,"content":"                  '/home',"},{"type":"INSERT","lineNumber":212,"content":"                  (route) => false,"},{"type":"INSERT","lineNumber":213,"content":"                );"},{"type":"INSERT","lineNumber":214,"content":"              },"},{"type":"INSERT","lineNumber":215,"content":"            );"},{"type":"INSERT","lineNumber":216,"content":"          },"},{"type":"INSERT","lineNumber":217,"content":"        },"},{"type":"INSERT","lineNumber":218,"content":"        onGenerateRoute: (settings) {"},{"type":"INSERT","lineNumber":219,"content":"          // Handle named routes with arguments"},{"type":"INSERT","lineNumber":220,"content":"          if (settings.name == '/otp-verification') {"},{"type":"INSERT","lineNumber":221,"content":"            final args = settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":222,"content":"            return MaterialPageRoute("},{"type":"INSERT","lineNumber":223,"content":"              builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":224,"content":"                verificationId: args?['verificationId'] ?? '',"},{"type":"INSERT","lineNumber":225,"content":"                phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"INSERT","lineNumber":227,"content":"            );"},{"type":"INSERT","lineNumber":228,"content":"          }"},{"type":"INSERT","lineNumber":229,"content":"          // Handle home route"},{"type":"INSERT","lineNumber":230,"content":"          if (settings.name == '/home') {"},{"type":"INSERT","lineNumber":231,"content":"            return MaterialPageRoute(builder: (context) => const HomeScreen());"},{"type":"INSERT","lineNumber":232,"content":"          }"},{"type":"INSERT","lineNumber":233,"content":"          return null;"},{"type":"INSERT","lineNumber":235,"content":"        onUnknownRoute: (settings) {"},{"type":"INSERT","lineNumber":236,"content":"          // Handle unknown routes by redirecting to home or login"},{"type":"INSERT","lineNumber":237,"content":"          return MaterialPageRoute("},{"type":"INSERT","lineNumber":238,"content":"            builder: (context) => BlocBuilder<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":239,"content":"              builder: (context, state) {"},{"type":"INSERT","lineNumber":240,"content":"                if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":241,"content":"                  return const HomeScreen();"},{"type":"INSERT","lineNumber":242,"content":"                }"},{"type":"INSERT","lineNumber":243,"content":"                return const LoginScreen();"},{"type":"INSERT","lineNumber":244,"content":"              },"},{"type":"INSERT","lineNumber":245,"content":"            ),"},{"type":"INSERT","lineNumber":246,"content":"          );"},{"type":"INSERT","lineNumber":247,"content":"        },"}]},{"timestamp":1754652883874,"changes":[{"type":"DELETE","lineNumber":11,"oldContent":""},{"type":"INSERT","lineNumber":12,"content":"import 'firebase_options.dart';"},{"type":"INSERT","lineNumber":13,"content":"import 'core/service_locator.dart' as di;"},{"type":"INSERT","lineNumber":14,"content":""},{"type":"INSERT","lineNumber":30,"content":"    // Initialize dependency injection"},{"type":"INSERT","lineNumber":31,"content":"    await di.init();"},{"type":"INSERT","lineNumber":32,"content":"    "},{"type":"DELETE","lineNumber":65,"oldContent":"        ),"},{"type":"DELETE","lineNumber":66,"oldContent":"      ),"},{"type":"DELETE","lineNumber":67,"oldContent":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":68,"oldContent":"        BlocProvider<AuthBloc>("},{"type":"DELETE","lineNumber":69,"oldContent":"          create: (context) => sl<AuthBloc>()..add(CheckAuthStatus()),"},{"type":"DELETE","lineNumber":70,"oldContent":"        ),"},{"type":"DELETE","lineNumber":71,"oldContent":"        title: 'Family Tree',"},{"type":"DELETE","lineNumber":72,"oldContent":"          colorScheme: ColorScheme.fromSeed(seedColor: Colors.orange),"},{"type":"DELETE","lineNumber":73,"oldContent":"          useMaterial3: true,"},{"type":"INSERT","lineNumber":72,"content":"        ),"},{"type":"INSERT","lineNumber":73,"content":"      ),"},{"type":"DELETE","lineNumber":80,"oldContent":"            ),"},{"type":"DELETE","lineNumber":81,"oldContent":"          ),"},{"type":"INSERT","lineNumber":78,"content":"class MyApp extends StatelessWidget {"},{"type":"INSERT","lineNumber":85,"content":"        BlocProvider<AuthBloc>("},{"type":"INSERT","lineNumber":86,"content":"          create: (context) => sl<AuthBloc>()..add(CheckAuthStatus()),"},{"type":"INSERT","lineNumber":87,"content":"        ),"},{"type":"INSERT","lineNumber":90,"content":"        title: 'Family Tree',"},{"type":"INSERT","lineNumber":95,"content":"          colorScheme: ColorScheme.fromSeed(seedColor: Colors.orange),"},{"type":"INSERT","lineNumber":96,"content":"          useMaterial3: true,"},{"type":"DELETE","lineNumber":120,"oldContent":"            // Show registration screen first for new users"},{"type":"DELETE","lineNumber":122,"oldContent":"            if (state.status == AuthStatus.unauthenticated) {"},{"type":"DELETE","lineNumber":124,"oldContent":"              // Check if it's a new user (not coming back from login)"},{"type":"DELETE","lineNumber":126,"oldContent":"              final isNewUser = ModalRoute.of(context)?.settings.arguments as bool? ?? true;"},{"type":"DELETE","lineNumber":128,"oldContent":"              if (isNewUser) {"},{"type":"DELETE","lineNumber":130,"oldContent":"                return const RegisterScreen();"},{"type":"DELETE","lineNumber":132,"oldContent":"              } else {"},{"type":"DELETE","lineNumber":133,"oldContent":"                return const LoginScreen();"},{"type":"INSERT","lineNumber":129,"content":"            ),"},{"type":"INSERT","lineNumber":130,"content":"          ),"},{"type":"DELETE","lineNumber":135,"oldContent":"              }"},{"type":"DELETE","lineNumber":139,"oldContent":"            if (state.status == AuthStatus.authenticated) {"},{"type":"DELETE","lineNumber":141,"oldContent":"              return const HomeScreen();"},{"type":"DELETE","lineNumber":143,"oldContent":"            }"},{"type":"DELETE","lineNumber":145,"oldContent":""},{"type":"DELETE","lineNumber":147,"oldContent":"            // Show loading indicator for other states"},{"type":"DELETE","lineNumber":149,"oldContent":"            return const Scaffold("},{"type":"DELETE","lineNumber":151,"oldContent":"              body: Center(child: CircularProgressIndicator()),"},{"type":"DELETE","lineNumber":159,"oldContent":"          '/home': (context) => const HomeScreen(),"},{"type":"DELETE","lineNumber":161,"oldContent":"          '/otp-verification': (context) {"},{"type":"DELETE","lineNumber":163,"oldContent":"            final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":165,"oldContent":"            return OtpVerificationScreen("},{"type":"DELETE","lineNumber":167,"oldContent":"              verificationId: args?['verificationId'] ?? '',"},{"type":"DELETE","lineNumber":169,"oldContent":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":171,"oldContent":"            );"},{"type":"DELETE","lineNumber":173,"oldContent":"          },"},{"type":"DELETE","lineNumber":175,"oldContent":"          '/success': (context) {"},{"type":"DELETE","lineNumber":177,"oldContent":"            final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":179,"oldContent":"            return SuccessScreen("},{"type":"DELETE","lineNumber":181,"oldContent":"              title: args?['title'] ?? 'Success!',"},{"type":"DELETE","lineNumber":183,"oldContent":"              message: args?['message'] ?? 'Operation completed successfully.',"},{"type":"DELETE","lineNumber":185,"oldContent":"              buttonText: args?['buttonText'] ?? 'Continue',"},{"type":"DELETE","lineNumber":187,"oldContent":"              onPressed: () {"},{"type":"DELETE","lineNumber":189,"oldContent":"                Navigator.pushNamedAndRemoveUntil("},{"type":"DELETE","lineNumber":191,"oldContent":"                  context,"},{"type":"DELETE","lineNumber":193,"oldContent":"                  '/home',"},{"type":"DELETE","lineNumber":195,"oldContent":"                  (route) => false,"},{"type":"DELETE","lineNumber":197,"oldContent":"                );"},{"type":"DELETE","lineNumber":199,"oldContent":"              },"},{"type":"DELETE","lineNumber":201,"oldContent":"            );"},{"type":"DELETE","lineNumber":203,"oldContent":"          },"},{"type":"DELETE","lineNumber":205,"oldContent":"        },"},{"type":"DELETE","lineNumber":207,"oldContent":"        onGenerateRoute: (settings) {"},{"type":"DELETE","lineNumber":209,"oldContent":"          // Handle named routes with arguments"},{"type":"INSERT","lineNumber":174,"content":"            // Show registration screen first for new users"},{"type":"INSERT","lineNumber":175,"content":"            if (state.status == AuthStatus.unauthenticated) {"},{"type":"INSERT","lineNumber":176,"content":"              // Check if it's a new user (not coming back from login)"},{"type":"INSERT","lineNumber":177,"content":"              final isNewUser = ModalRoute.of(context)?.settings.arguments as bool? ?? true;"},{"type":"INSERT","lineNumber":178,"content":"              if (isNewUser) {"},{"type":"INSERT","lineNumber":179,"content":"                return const RegisterScreen();"},{"type":"INSERT","lineNumber":180,"content":"              } else {"},{"type":"INSERT","lineNumber":181,"content":"                return const LoginScreen();"},{"type":"INSERT","lineNumber":182,"content":"              }"},{"type":"INSERT","lineNumber":183,"content":"            }"},{"type":"INSERT","lineNumber":184,"content":""},{"type":"INSERT","lineNumber":185,"content":"            // Show home screen if authenticated"},{"type":"INSERT","lineNumber":186,"content":"            if (state.status == AuthStatus.authenticated) {"},{"type":"INSERT","lineNumber":187,"content":"              return const HomeScreen();"},{"type":"INSERT","lineNumber":188,"content":"            }"},{"type":"INSERT","lineNumber":189,"content":""},{"type":"INSERT","lineNumber":190,"content":"            // Show loading indicator for other states"},{"type":"INSERT","lineNumber":191,"content":"            return const Scaffold("},{"type":"INSERT","lineNumber":192,"content":"              body: Center(child: CircularProgressIndicator()),"},{"type":"INSERT","lineNumber":193,"content":"            );"},{"type":"INSERT","lineNumber":194,"content":"          },"},{"type":"INSERT","lineNumber":195,"content":"        ),"},{"type":"INSERT","lineNumber":196,"content":"        routes: {"},{"type":"INSERT","lineNumber":197,"content":"          '/login': (context) => const LoginScreen(),"},{"type":"INSERT","lineNumber":198,"content":"          '/register': (context) => const RegisterScreen(),"},{"type":"INSERT","lineNumber":199,"content":"          '/home': (context) => const HomeScreen(),"},{"type":"INSERT","lineNumber":200,"content":"          '/otp-verification': (context) {"},{"type":"INSERT","lineNumber":201,"content":"            final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":202,"content":"            return OtpVerificationScreen("},{"type":"INSERT","lineNumber":203,"content":"              verificationId: args?['verificationId'] ?? '',"},{"type":"INSERT","lineNumber":204,"content":"              phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"INSERT","lineNumber":205,"content":"            );"},{"type":"INSERT","lineNumber":206,"content":"          },"},{"type":"INSERT","lineNumber":207,"content":"          '/success': (context) {"},{"type":"INSERT","lineNumber":208,"content":"            final args = ModalRoute.of(context)!.settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":209,"content":"            return SuccessScreen("},{"type":"INSERT","lineNumber":210,"content":"              title: args?['title'] ?? 'Success!',"},{"type":"INSERT","lineNumber":211,"content":"              message: args?['message'] ?? 'Operation completed successfully.',"},{"type":"INSERT","lineNumber":212,"content":"              buttonText: args?['buttonText'] ?? 'Continue',"},{"type":"INSERT","lineNumber":213,"content":"              onPressed: () {"},{"type":"INSERT","lineNumber":214,"content":"                Navigator.pushNamedAndRemoveUntil("},{"type":"INSERT","lineNumber":215,"content":"                  context,"},{"type":"INSERT","lineNumber":216,"content":"                  '/home',"},{"type":"INSERT","lineNumber":217,"content":"                  (route) => false,"},{"type":"INSERT","lineNumber":218,"content":"                );"},{"type":"INSERT","lineNumber":219,"content":"              },"},{"type":"INSERT","lineNumber":220,"content":"            );"},{"type":"INSERT","lineNumber":221,"content":"          },"},{"type":"INSERT","lineNumber":222,"content":"        },"},{"type":"INSERT","lineNumber":223,"content":"        onGenerateRoute: (settings) {"},{"type":"INSERT","lineNumber":224,"content":"          // Handle named routes with arguments"},{"type":"DELETE","lineNumber":215,"oldContent":"            }"},{"type":"DELETE","lineNumber":217,"oldContent":""},{"type":"DELETE","lineNumber":219,"oldContent":"            // Show home screen if authenticated"},{"type":"INSERT","lineNumber":231,"content":"              ),"},{"type":"DELETE","lineNumber":223,"oldContent":"            );"},{"type":"DELETE","lineNumber":225,"oldContent":"          },"},{"type":"DELETE","lineNumber":227,"oldContent":"        ),"},{"type":"DELETE","lineNumber":229,"oldContent":"        routes: {"},{"type":"DELETE","lineNumber":231,"oldContent":"          '/login': (context) => const LoginScreen(),"},{"type":"DELETE","lineNumber":232,"oldContent":"          '/register': (context) => const RegisterScreen(),"},{"type":"INSERT","lineNumber":239,"content":"        },"},{"type":"DELETE","lineNumber":237,"oldContent":"              ),"},{"type":"DELETE","lineNumber":239,"oldContent":"        },"},{"type":"DELETE","lineNumber":241,"oldContent":"      ),"},{"type":"DELETE","lineNumber":243,"oldContent":"    );"},{"type":"DELETE","lineNumber":245,"oldContent":"  }"},{"type":"DELETE","lineNumber":247,"oldContent":"}"},{"type":"DELETE","lineNumber":249,"oldContent":""},{"type":"MODIFY","lineNumber":252,"content":"        },","oldContent":"        },"},{"type":"INSERT","lineNumber":253,"content":"      ),"},{"type":"INSERT","lineNumber":254,"content":"    );"},{"type":"INSERT","lineNumber":255,"content":"  }"},{"type":"INSERT","lineNumber":256,"content":"}"},{"type":"INSERT","lineNumber":257,"content":""}]},{"timestamp":1754652898970,"changes":[{"type":"MODIFY","lineNumber":12,"content":"import 'firebase_options.dart';","oldContent":"import 'firebase_options.dart';"},{"type":"MODIFY","lineNumber":15,"content":"void main() async {","oldContent":"void main() async {"},{"type":"DELETE","lineNumber":32,"oldContent":"    // Initialize dependency injection"},{"type":"DELETE","lineNumber":34,"oldContent":"    await di.init();"},{"type":"DELETE","lineNumber":36,"oldContent":"    "},{"type":"DELETE","lineNumber":70,"oldContent":"        ),"},{"type":"DELETE","lineNumber":71,"oldContent":"      ),"},{"type":"INSERT","lineNumber":69,"content":"        ),"},{"type":"INSERT","lineNumber":70,"content":"      ),"},{"type":"MODIFY","lineNumber":75,"content":"class MyApp extends StatelessWidget {","oldContent":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":82,"oldContent":"        BlocProvider<AuthBloc>("},{"type":"DELETE","lineNumber":84,"oldContent":"          create: (context) => sl<AuthBloc>()..add(CheckAuthStatus()),"},{"type":"DELETE","lineNumber":86,"oldContent":"        ),"},{"type":"INSERT","lineNumber":82,"content":"        BlocProvider<AuthBloc>("},{"type":"INSERT","lineNumber":83,"content":"          create: (context) => sl<AuthBloc>()..add(CheckAuthStatus()),"},{"type":"INSERT","lineNumber":84,"content":"        ),"},{"type":"DELETE","lineNumber":95,"oldContent":"          appBarTheme: const AppBarTheme("},{"type":"DELETE","lineNumber":97,"oldContent":"            elevation: 0,"},{"type":"INSERT","lineNumber":94,"content":"          appBarTheme: const AppBarTheme("},{"type":"INSERT","lineNumber":95,"content":"            elevation: 0,"},{"type":"DELETE","lineNumber":127,"oldContent":"            ),"},{"type":"DELETE","lineNumber":129,"oldContent":"          ),"},{"type":"INSERT","lineNumber":126,"content":"            ),"},{"type":"INSERT","lineNumber":127,"content":"          ),"},{"type":"DELETE","lineNumber":155,"oldContent":"            // Show registration screen first for new users"},{"type":"INSERT","lineNumber":153,"content":"                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":154,"content":"              ),"},{"type":"INSERT","lineNumber":155,"content":"            ),"},{"type":"INSERT","lineNumber":156,"content":"          ),"},{"type":"INSERT","lineNumber":157,"content":"        ),"},{"type":"INSERT","lineNumber":158,"content":"        home: BlocBuilder<AuthBloc, AuthState>("},{"type":"INSERT","lineNumber":159,"content":"          builder: (context, state) {"},{"type":"INSERT","lineNumber":160,"content":"            // Show loading indicator while checking auth status"},{"type":"INSERT","lineNumber":161,"content":"            if (state.status == AuthStatus.initial) {"},{"type":"INSERT","lineNumber":162,"content":"              return const Scaffold("},{"type":"INSERT","lineNumber":163,"content":"                body: Center("},{"type":"INSERT","lineNumber":164,"content":"                  child: CircularProgressIndicator("},{"type":"INSERT","lineNumber":165,"content":"                    color: Color(0xFFFF6B35),"},{"type":"INSERT","lineNumber":166,"content":"                  ),"},{"type":"INSERT","lineNumber":167,"content":"                ),"},{"type":"INSERT","lineNumber":168,"content":"              );"},{"type":"INSERT","lineNumber":169,"content":"            }"},{"type":"INSERT","lineNumber":170,"content":""},{"type":"INSERT","lineNumber":171,"content":"            // Show registration screen first for new users"},{"type":"DELETE","lineNumber":159,"oldContent":"                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":162,"oldContent":"              ),"},{"type":"DELETE","lineNumber":165,"oldContent":"            ),"},{"type":"DELETE","lineNumber":168,"oldContent":"          ),"},{"type":"DELETE","lineNumber":171,"oldContent":"        ),"},{"type":"DELETE","lineNumber":174,"oldContent":"        home: BlocBuilder<AuthBloc, AuthState>("},{"type":"DELETE","lineNumber":177,"oldContent":"          builder: (context, state) {"},{"type":"DELETE","lineNumber":180,"oldContent":"            // Show loading indicator while checking auth status"},{"type":"DELETE","lineNumber":183,"oldContent":"            if (state.status == AuthStatus.initial) {"},{"type":"DELETE","lineNumber":186,"oldContent":"              return const Scaffold("},{"type":"DELETE","lineNumber":189,"oldContent":"                body: Center("},{"type":"DELETE","lineNumber":192,"oldContent":"                  child: CircularProgressIndicator("},{"type":"DELETE","lineNumber":195,"oldContent":"                    color: Color(0xFFFF6B35),"},{"type":"DELETE","lineNumber":198,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":201,"oldContent":"                ),"},{"type":"DELETE","lineNumber":204,"oldContent":"              );"},{"type":"DELETE","lineNumber":207,"oldContent":"            }"},{"type":"DELETE","lineNumber":210,"oldContent":""},{"type":"DELETE","lineNumber":212,"oldContent":"          if (settings.name == '/otp-verification') {"},{"type":"DELETE","lineNumber":214,"oldContent":"            final args = settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":216,"oldContent":"            return MaterialPageRoute("},{"type":"DELETE","lineNumber":218,"oldContent":"              builder: (context) => OtpVerificationScreen("},{"type":"DELETE","lineNumber":221,"oldContent":"                verificationId: args?['verificationId'] ?? '',"},{"type":"DELETE","lineNumber":224,"oldContent":"                phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"DELETE","lineNumber":227,"oldContent":"            );"},{"type":"DELETE","lineNumber":229,"oldContent":"          }"},{"type":"DELETE","lineNumber":231,"oldContent":"          // Handle home route"},{"type":"INSERT","lineNumber":222,"content":"          if (settings.name == '/otp-verification') {"},{"type":"INSERT","lineNumber":223,"content":"            final args = settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":224,"content":"            return MaterialPageRoute("},{"type":"INSERT","lineNumber":225,"content":"              builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":226,"content":"                verificationId: args?['verificationId'] ?? '',"},{"type":"INSERT","lineNumber":227,"content":"                phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"INSERT","lineNumber":228,"content":"              ),"},{"type":"INSERT","lineNumber":229,"content":"            );"},{"type":"INSERT","lineNumber":230,"content":"          }"},{"type":"INSERT","lineNumber":231,"content":"          // Handle home route"},{"type":"DELETE","lineNumber":238,"oldContent":"              ),"},{"type":"INSERT","lineNumber":236,"content":"        },"},{"type":"DELETE","lineNumber":244,"oldContent":"        },"},{"type":"INSERT","lineNumber":248,"content":"          );"},{"type":"DELETE","lineNumber":252,"oldContent":"        },"},{"type":"DELETE","lineNumber":254,"oldContent":""},{"type":"DELETE","lineNumber":256,"oldContent":"}"},{"type":"INSERT","lineNumber":253,"content":"}"},{"type":"INSERT","lineNumber":254,"content":""}]},{"timestamp":1754654448352,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:family_tree_firebase/features/auth/presentation/screens/login_screen_new.dart';","oldContent":"import 'package:family_tree_firebase/features/auth/presentation/screens/login_screen.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:family_tree_firebase/features/home/presentation/screens/main_app_screen.dart';"},{"type":"INSERT","lineNumber":12,"content":"import 'package:get_storage/get_storage.dart';"},{"type":"DELETE","lineNumber":12,"oldContent":"import 'firebase_options.dart';"},{"type":"INSERT","lineNumber":15,"content":""},{"type":"DELETE","lineNumber":15,"oldContent":"void main() async {"},{"type":"DELETE","lineNumber":66,"oldContent":"        ),"},{"type":"DELETE","lineNumber":68,"oldContent":"      ),"},{"type":"INSERT","lineNumber":70,"content":"        ),"},{"type":"INSERT","lineNumber":71,"content":"      ),"},{"type":"DELETE","lineNumber":72,"oldContent":"class MyApp extends StatelessWidget {"},{"type":"MODIFY","lineNumber":73,"content":"  }","oldContent":"class MyApp extends StatelessWidget {"},{"type":"INSERT","lineNumber":76,"content":"class MyApp extends StatelessWidget {"},{"type":"DELETE","lineNumber":79,"oldContent":"        BlocProvider<AuthBloc>("},{"type":"DELETE","lineNumber":80,"oldContent":"          create: (context) => sl<AuthBloc>()..add(CheckAuthStatus()),"},{"type":"DELETE","lineNumber":82,"oldContent":"        ),"},{"type":"INSERT","lineNumber":83,"content":"        BlocProvider<AuthBloc>("},{"type":"INSERT","lineNumber":84,"content":"          create: (context) => sl<AuthBloc>()..add(CheckAuthStatus()),"},{"type":"INSERT","lineNumber":85,"content":"        ),"},{"type":"DELETE","lineNumber":91,"oldContent":"          appBarTheme: const AppBarTheme("},{"type":"DELETE","lineNumber":93,"oldContent":"            elevation: 0,"},{"type":"INSERT","lineNumber":95,"content":"          appBarTheme: const AppBarTheme("},{"type":"INSERT","lineNumber":96,"content":"            elevation: 0,"},{"type":"DELETE","lineNumber":123,"oldContent":"            ),"},{"type":"DELETE","lineNumber":125,"oldContent":"          ),"},{"type":"INSERT","lineNumber":127,"content":"            ),"},{"type":"INSERT","lineNumber":128,"content":"          ),"},{"type":"DELETE","lineNumber":150,"oldContent":"                fontWeight: FontWeight.bold,"},{"type":"DELETE","lineNumber":152,"oldContent":"              ),"},{"type":"INSERT","lineNumber":153,"content":"                fontSize: 16,"},{"type":"INSERT","lineNumber":154,"content":"                fontWeight: FontWeight.bold,"},{"type":"INSERT","lineNumber":155,"content":"              ),"},{"type":"DELETE","lineNumber":156,"oldContent":"                fontSize: 16,"},{"type":"DELETE","lineNumber":158,"oldContent":"            if (state.status == AuthStatus.unauthenticated) {"},{"type":"DELETE","lineNumber":160,"oldContent":"              // Check if it's a new user (not coming back from login)"},{"type":"DELETE","lineNumber":163,"oldContent":"              final isNewUser = ModalRoute.of(context)?.settings.arguments as bool? ?? true;"},{"type":"DELETE","lineNumber":165,"oldContent":"              if (isNewUser) {"},{"type":"DELETE","lineNumber":168,"oldContent":"                return const RegisterScreen();"},{"type":"DELETE","lineNumber":170,"oldContent":"              } else {"},{"type":"DELETE","lineNumber":173,"oldContent":"                return const LoginScreen();"},{"type":"DELETE","lineNumber":175,"oldContent":"              }"},{"type":"DELETE","lineNumber":178,"oldContent":"            }"},{"type":"DELETE","lineNumber":180,"oldContent":""},{"type":"INSERT","lineNumber":173,"content":"            if (state.status == AuthStatus.unauthenticated) {"},{"type":"INSERT","lineNumber":174,"content":"              // Check if it's a new user (not coming back from login)"},{"type":"INSERT","lineNumber":175,"content":"              final isNewUser = ModalRoute.of(context)?.settings.arguments as bool? ?? true;"},{"type":"INSERT","lineNumber":176,"content":"              if (isNewUser) {"},{"type":"INSERT","lineNumber":177,"content":"                return const RegisterScreen();"},{"type":"INSERT","lineNumber":178,"content":"              } else {"},{"type":"INSERT","lineNumber":179,"content":"                return const LoginScreen();"},{"type":"INSERT","lineNumber":180,"content":"              }"},{"type":"INSERT","lineNumber":181,"content":"            }"},{"type":"INSERT","lineNumber":182,"content":""},{"type":"MODIFY","lineNumber":185,"content":"              return const MainAppScreen();","oldContent":"              return const HomeScreen();"},{"type":"DELETE","lineNumber":214,"oldContent":"          if (settings.name == '/otp-verification') {"},{"type":"DELETE","lineNumber":216,"oldContent":"            final args = settings.arguments as Map<String, dynamic>?;"},{"type":"INSERT","lineNumber":217,"content":"              },"},{"type":"INSERT","lineNumber":218,"content":"            );"},{"type":"INSERT","lineNumber":219,"content":"          },"},{"type":"INSERT","lineNumber":220,"content":"        },"},{"type":"INSERT","lineNumber":221,"content":"        onGenerateRoute: (settings) {"},{"type":"INSERT","lineNumber":222,"content":"          // Handle named routes with arguments"},{"type":"INSERT","lineNumber":223,"content":"          if (settings.name == '/otp-verification') {"},{"type":"INSERT","lineNumber":224,"content":"            final args = settings.arguments as Map<String, dynamic>?;"},{"type":"DELETE","lineNumber":220,"oldContent":"              },"},{"type":"DELETE","lineNumber":222,"oldContent":"            );"},{"type":"DELETE","lineNumber":225,"oldContent":"          },"},{"type":"DELETE","lineNumber":228,"oldContent":"        },"},{"type":"DELETE","lineNumber":230,"oldContent":"        onGenerateRoute: (settings) {"},{"type":"DELETE","lineNumber":231,"oldContent":"          // Handle named routes with arguments"},{"type":"DELETE","lineNumber":234,"oldContent":"        },"},{"type":"INSERT","lineNumber":237,"content":"        },"},{"type":"DELETE","lineNumber":245,"oldContent":"          );"},{"type":"INSERT","lineNumber":249,"content":"          );"},{"type":"DELETE","lineNumber":250,"oldContent":"}"},{"type":"DELETE","lineNumber":252,"oldContent":""},{"type":"INSERT","lineNumber":254,"content":"}"},{"type":"INSERT","lineNumber":255,"content":""}]},{"timestamp":1754654478512,"changes":[{"type":"MODIFY","lineNumber":3,"content":"import 'package:family_tree_firebase/features/home/presentation/screens/main_app_screen.dart' as main_app;","oldContent":"import 'package:family_tree_firebase/features/home/presentation/screens/main_app_screen.dart';"},{"type":"MODIFY","lineNumber":13,"content":"import 'firebase_options.dart';","oldContent":"import 'firebase_options.dart';"},{"type":"MODIFY","lineNumber":16,"content":"void main() async {","oldContent":"void main() async {"},{"type":"MODIFY","lineNumber":70,"content":"        ),","oldContent":"        ),"},{"type":"DELETE","lineNumber":81,"oldContent":"        BlocProvider<AuthBloc>("},{"type":"MODIFY","lineNumber":83,"content":"        BlocProvider<AuthBloc>(","oldContent":"          create: (context) => sl<AuthBloc>()..add(CheckAuthStatus()),"},{"type":"INSERT","lineNumber":84,"content":"          create: (context) => sl<AuthBloc>()..add(CheckAuthStatus()),"},{"type":"MODIFY","lineNumber":95,"content":"          appBarTheme: const AppBarTheme(","oldContent":"          appBarTheme: const AppBarTheme("},{"type":"MODIFY","lineNumber":127,"content":"            ),","oldContent":"            ),"},{"type":"MODIFY","lineNumber":153,"content":"                fontSize: 16,","oldContent":"                fontSize: 16,"},{"type":"MODIFY","lineNumber":156,"content":"            ),","oldContent":"            ),"},{"type":"INSERT","lineNumber":168,"content":"                ),"},{"type":"INSERT","lineNumber":169,"content":"              );"},{"type":"INSERT","lineNumber":170,"content":"            }"},{"type":"INSERT","lineNumber":171,"content":""},{"type":"INSERT","lineNumber":172,"content":"            // Show registration screen first for new users"},{"type":"DELETE","lineNumber":170,"oldContent":"                ),"},{"type":"DELETE","lineNumber":173,"oldContent":"              );"},{"type":"DELETE","lineNumber":175,"oldContent":"            }"},{"type":"DELETE","lineNumber":178,"oldContent":""},{"type":"DELETE","lineNumber":181,"oldContent":"            // Show registration screen first for new users"},{"type":"DELETE","lineNumber":185,"oldContent":"              return const HomeScreen();"},{"type":"MODIFY","lineNumber":185,"content":"              return const main_app.MainAppScreen();","oldContent":"              return const MainAppScreen();"},{"type":"INSERT","lineNumber":186,"content":"            }"},{"type":"MODIFY","lineNumber":217,"content":"              },","oldContent":"              },"},{"type":"DELETE","lineNumber":219,"oldContent":"            return MaterialPageRoute("},{"type":"DELETE","lineNumber":221,"oldContent":"              builder: (context) => OtpVerificationScreen("},{"type":"DELETE","lineNumber":224,"oldContent":"                verificationId: args?['verificationId'] ?? '',"},{"type":"DELETE","lineNumber":227,"oldContent":"                phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"INSERT","lineNumber":225,"content":"            return MaterialPageRoute("},{"type":"INSERT","lineNumber":226,"content":"              builder: (context) => OtpVerificationScreen("},{"type":"INSERT","lineNumber":227,"content":"                verificationId: args?['verificationId'] ?? '',"},{"type":"INSERT","lineNumber":228,"content":"                phoneNumber: args?['phoneNumber'] ?? '',"},{"type":"MODIFY","lineNumber":254,"content":"}","oldContent":"}"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/bloc/auth_bloc.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/auth/presentation/bloc/auth_bloc.dart","baseContent":"import 'dart:async';\n\nimport 'package:bloc/bloc.dart';\nimport 'package:equatable/equatable.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:flutter/foundation.dart';\nimport 'package:meta/meta.dart';\n\n// Auth Status\nenum AuthStatus {\n  initial,\n  loading,\n  authenticated,\n  unauthenticated,\n  otpSent,\n  verificationInProgress,\n  verificationSuccessful,\n  verificationFailed,\n  error,\n}\n\n// Auth State\nclass AuthState extends Equatable {\n  final AuthStatus status;\n  final User? user;\n  final String? error;\n  final String? verificationId;\n  final int? resendToken;\n  final bool isNewUser;\n\n  const AuthState({\n    this.status = AuthStatus.initial,\n    this.user,\n    this.error,\n    this.verificationId,\n    this.resendToken,\n    this.isNewUser = false,\n  });\n\n  AuthState copyWith({\n    AuthStatus? status,\n    User? user,\n    String? error,\n    String? verificationId,\n    int? resendToken,\n    bool? isNewUser,\n  }) {\n    return AuthState(\n      status: status ?? this.status,\n      user: user ?? this.user,\n      error: error,\n      verificationId: verificationId ?? this.verificationId,\n      resendToken: resendToken ?? this.resendToken,\n      isNewUser: isNewUser ?? this.isNewUser,\n    );\n  }\n\n  @override\n  List<Object?> get props => [\n        status,\n        user,\n        error,\n        verificationId,\n        resendToken,\n        isNewUser,\n      ];\n}\n\n// Auth Events\nabstract class AuthEvent extends Equatable {\n  const AuthEvent();\n\n  @override\n  List<Object> get props => [];\n}\n\nclass CheckAuthStatus extends AuthEvent {}\n\nclass LoginRequested extends AuthEvent {\n  final String email;\n  final String password;\n\n  const LoginRequested({required this.email, required this.password});\n\n  @override\n  List<Object> get props => [email, password];\n}\n\nclass RegisterRequested extends AuthEvent {\n  final String name;\n  final String email;\n  final String phoneNumber;\n  final String password;\n\n  const RegisterRequested({\n    required this.name,\n    required this.email,\n    required this.phoneNumber,\n    required this.password,\n  });\n\n  @override\n  List<Object> get props => [name, email, phoneNumber, password];\n}\n\nclass SendOtpRequested extends AuthEvent {\n  final String phoneNumber;\n\n  const SendOtpRequested({required this.phoneNumber});\n\n  @override\n  List<Object> get props => [phoneNumber];\n}\n\nclass VerifyOtpRequested extends AuthEvent {\n  final String verificationId;\n  final String smsCode;\n\n  const VerifyOtpRequested({\n    required this.verificationId,\n    required this.smsCode,\n  });\n\n  @override\n  List<Object> get props => [verificationId, smsCode];\n}\n\nclass LogoutRequested extends AuthEvent {}\n\n// Auth Bloc\n\nclass AuthBloc extends Bloc<AuthEvent, AuthState> {\n  final FirebaseAuth _auth = FirebaseAuth.instance;\n  StreamSubscription<User?>? _authSubscription;\n\n  AuthBloc() : super(const AuthState()) {\n    on<CheckAuthStatus>(_onCheckAuthStatus);\n    on<LoginWithEmailAndPasswordRequested>(_onLoginWithEmailAndPassword);\n    on<RegisterWithEmailAndPasswordRequested>(_onRegisterWithEmailAndPassword);\n    on<SendOtpRequested>(_onSendOtpRequested);\n    on<VerifyOtpRequested>(_onVerifyOtpRequested);\n    on<LogoutRequested>(_onLogoutRequested);\n\n    // Listen to auth state changes\n    _authSubscription = _auth.authStateChanges().listen((user) {\n      if (user != null) {\n        emit(state.copyWith(\n          user: user,\n          status: AuthStatus.authenticated,\n        ));\n      } else {\n        emit(state.copyWith(\n          status: AuthStatus.unauthenticated,\n          user: null,\n        ));\n      }\n    });\n  }\n\n  Future<void> _onCheckAuthStatus(\n    CheckAuthStatus event,\n    Emitter<AuthState> emit,\n  ) async {\n    final user = _auth.currentUser;\n    if (user != null) {\n      emit(state.copyWith(\n        status: AuthStatus.authenticated,\n        user: user,\n      ));\n    } else {\n      emit(state.copyWith(status: AuthStatus.unauthenticated));\n    }\n  }\n\n  Future<void> _onLoginWithEmailAndPassword(\n    LoginWithEmailAndPasswordRequested event,\n    Emitter<AuthState> emit,\n  ) async {\n    try {\n      emit(state.copyWith(status: AuthStatus.loading));\n      await _auth.signInWithEmailAndPassword(\n        email: event.email,\n        password: event.password,\n      );\n      // State will be updated by the authStateChanges listener\n    } on FirebaseAuthException catch (e) {\n      emit(state.copyWith(\n        status: AuthStatus.error,\n        error: _getErrorMessage(e.code),\n      ));\n    } catch (e) {\n      emit(state.copyWith(\n        status: AuthStatus.error,\n        error: 'An unexpected error occurred. Please try again.',\n      ));\n    }\n  }\n\n  Future<void> _onRegisterWithEmailAndPassword(\n    RegisterWithEmailAndPasswordRequested event,\n    Emitter<AuthState> emit,\n  ) async {\n    try {\n      emit(state.copyWith(status: AuthStatus.loading));\n      \n      // Create user with email and password\n      final credential = await _auth.createUserWithEmailAndPassword(\n        email: event.email,\n        password: event.password,\n      );\n\n      // Update user profile with display name\n      await credential.user?.updateDisplayName(event.name);\n      \n      // Update user profile with phone number (custom claim or Firestore would be better)\n      await credential.user?.updatePhoneNumber(event.phoneNumber as PhoneAuthCredential);\n\n      // State will be updated by the authStateChanges listener\n    } on FirebaseAuthException catch (e) {\n      emit(state.copyWith(\n        status: AuthStatus.error,\n        error: _getErrorMessage(e.code),\n      ));\n    } catch (e) {\n      emit(state.copyWith(\n        status: AuthStatus.error,\n        error: 'An unexpected error occurred. Please try again.',\n      ));\n    }\n  }\n\n  Future<void> _onSendOtpRequested(\n    SendOtpRequested event,\n    Emitter<AuthState> emit,\n  ) async {\n    try {\n      emit(state.copyWith(status: AuthStatus.loading));\n      \n      await _auth.verifyPhoneNumber(\n        phoneNumber: event.phoneNumber,\n        verificationCompleted: (PhoneAuthCredential credential) async {\n          // Auto-verify on Android devices\n          await _auth.signInWithCredential(credential);\n        },\n        verificationFailed: (FirebaseAuthException e) {\n          emit(state.copyWith(\n            status: AuthStatus.verificationFailed,\n            error: _getErrorMessage(e.code),\n          ));\n        },\n        codeSent: (String verificationId, int? resendToken) {\n          emit(state.copyWith(\n            status: AuthStatus.otpSent,\n            verificationId: verificationId,\n            resendToken: resendToken,\n          ));\n        },\n        codeAutoRetrievalTimeout: (String verificationId) {\n          // Auto-resolution timeout, you might want to handle this case\n        },\n        timeout: const Duration(seconds: 60),\n      );\n    } catch (e) {\n      emit(state.copyWith(\n        status: AuthStatus.error,\n        error: 'Failed to send OTP. Please try again.',\n      ));\n    }\n  }\n\n  Future<void> _onVerifyOtpRequested(\n    VerifyOtpRequested event,\n    Emitter<AuthState> emit,\n  ) async {\n    try {\n      emit(state.copyWith(status: AuthStatus.verificationInProgress));\n      \n      final credential = PhoneAuthProvider.credential(\n        verificationId: event.verificationId,\n        smsCode: event.smsCode,\n      );\n\n      await _auth.signInWithCredential(credential);\n      \n      emit(state.copyWith(\n        status: AuthStatus.verificationSuccessful,\n      ));\n    } on FirebaseAuthException catch (e) {\n      emit(state.copyWith(\n        status: AuthStatus.verificationFailed,\n        error: _getErrorMessage(e.code),\n      ));\n    } catch (e) {\n      emit(state.copyWith(\n        status: AuthStatus.error,\n        error: 'Failed to verify OTP. Please try again.',\n      ));\n    }\n  }\n\n  Future<void> _onLogoutRequested(\n    LogoutRequested event,\n    Emitter<AuthState> emit,\n  ) async {\n    try {\n      await _auth.signOut();\n      emit(state.copyWith(\n        status: AuthStatus.unauthenticated,\n        user: null,\n      ));\n    } catch (e) {\n      emit(state.copyWith(\n        status: AuthStatus.error,\n        error: 'Failed to sign out. Please try again.',\n      ));\n    }\n  }\n\n  String _getErrorMessage(String code) {\n    switch (code) {\n      case 'user-not-found':\n        return 'No user found with this email.';\n      case 'wrong-password':\n        return 'Incorrect password. Please try again.';\n      case 'email-already-in-use':\n        return 'An account already exists with this email.';\n      case 'invalid-email':\n        return 'Please enter a valid email address.';\n      case 'weak-password':\n        return 'The password provided is too weak.';\n      case 'too-many-requests':\n        return 'Too many attempts. Please try again later.';\n      case 'operation-not-allowed':\n        return 'This operation is not allowed. Please contact support.';\n      case 'session-expired':\n        return 'Session expired. Please try again.';\n      case 'invalid-verification-code':\n        return 'Invalid verification code. Please try again.';\n      case 'invalid-verification-id':\n        return 'Invalid verification ID. Please request a new OTP.';\n      case 'quota-exceeded':\n        return 'Quota exceeded. Please try again later.';\n      default:\n        return 'An error occurred. Please try again.';\n    }\n  }\n\n  @override\n  Future<void> close() {\n    _authSubscription?.cancel();\n    return super.close();\n  }\n}\n","baseTimestamp":1754628411151,"deltas":[{"timestamp":1754628486173,"changes":[{"type":"DELETE","lineNumber":137,"oldContent":"    on<LoginWithEmailAndPasswordRequested>(_onLoginWithEmailAndPassword);"},{"type":"MODIFY","lineNumber":137,"content":"    on<LoginRequested>(_onLoginRequested);","oldContent":"    on<RegisterWithEmailAndPasswordRequested>(_onRegisterWithEmailAndPassword);"},{"type":"INSERT","lineNumber":138,"content":"    on<RegisterRequested>(_onRegisterRequested);"}]},{"timestamp":1754628501319,"changes":[{"type":"MODIFY","lineNumber":138,"content":"    on<RegisterRequested>(_onRegisterRequested);","oldContent":"    on<RegisterWithEmailAndPasswordRequested>(_onRegisterWithEmailAndPassword);"},{"type":"DELETE","lineNumber":174,"oldContent":"  Future<void> _onLoginWithEmailAndPassword("},{"type":"DELETE","lineNumber":175,"oldContent":"    LoginWithEmailAndPasswordRequested event,"},{"type":"INSERT","lineNumber":174,"content":"  Future<void> _onLoginRequested("},{"type":"INSERT","lineNumber":175,"content":"    LoginRequested event,"},{"type":"MODIFY","lineNumber":180,"content":"      final userCredential = await _auth.signInWithEmailAndPassword(","oldContent":"      await _auth.signInWithEmailAndPassword("},{"type":"MODIFY","lineNumber":184,"content":"      if (userCredential.user != null) {","oldContent":"      // State will be updated by the authStateChanges listener"},{"type":"INSERT","lineNumber":185,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":186,"content":"          status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":187,"content":"          user: userCredential.user,"},{"type":"INSERT","lineNumber":188,"content":"        ));"},{"type":"INSERT","lineNumber":189,"content":"      } else {"},{"type":"INSERT","lineNumber":190,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":191,"content":"          status: AuthStatus.unauthenticated,"},{"type":"INSERT","lineNumber":192,"content":"          error: 'User not found',"},{"type":"INSERT","lineNumber":193,"content":"        ));"},{"type":"INSERT","lineNumber":194,"content":"      }"},{"type":"DELETE","lineNumber":193,"oldContent":"        error: 'An unexpected error occurred. Please try again.',"},{"type":"INSERT","lineNumber":203,"content":"        error: e.toString(),"},{"type":"DELETE","lineNumber":198,"oldContent":"  Future<void> _onRegisterWithEmailAndPassword("},{"type":"DELETE","lineNumber":199,"oldContent":"    RegisterWithEmailAndPasswordRequested event,"},{"type":"INSERT","lineNumber":208,"content":"  Future<void> _onRegisterRequested("},{"type":"INSERT","lineNumber":209,"content":"    RegisterRequested event,"}]},{"timestamp":1754628879306,"changes":[{"type":"MODIFY","lineNumber":108,"content":"  const SendOtpRequested(String phoneNumber, {required this.phoneNumber});","oldContent":"  const SendOtpRequested({required this.phoneNumber});"},{"type":"DELETE","lineNumber":186,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":188,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":190,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":192,"oldContent":"        error: _getErrorMessage(e.code),"},{"type":"DELETE","lineNumber":194,"oldContent":"      ));"},{"type":"DELETE","lineNumber":196,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":198,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":200,"oldContent":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":195,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":196,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":197,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":198,"content":"        error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":200,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":201,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":202,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":203,"content":"        error: e.toString(),"},{"type":"INSERT","lineNumber":204,"content":"      ));"},{"type":"INSERT","lineNumber":208,"content":"  Future<void> _onRegisterRequested("},{"type":"INSERT","lineNumber":209,"content":"    RegisterRequested event,"},{"type":"DELETE","lineNumber":210,"oldContent":"        error: e.toString(),"},{"type":"DELETE","lineNumber":216,"oldContent":"  Future<void> _onRegisterRequested("},{"type":"DELETE","lineNumber":218,"oldContent":"    RegisterRequested event,"}]},{"timestamp":1754628919923,"changes":[{"type":"MODIFY","lineNumber":108,"content":"  const SendOtpRequested(this.phoneNumber);","oldContent":"  const SendOtpRequested(String phoneNumber, {required this.phoneNumber});"},{"type":"DELETE","lineNumber":190,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":191,"content":"          status: AuthStatus.unauthenticated,"},{"type":"INSERT","lineNumber":192,"content":"          error: 'User not found',"},{"type":"INSERT","lineNumber":193,"content":"        ));"},{"type":"INSERT","lineNumber":194,"content":"      }"},{"type":"INSERT","lineNumber":195,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":194,"oldContent":"          status: AuthStatus.unauthenticated,"},{"type":"DELETE","lineNumber":196,"oldContent":"          error: 'User not found',"},{"type":"INSERT","lineNumber":199,"content":"      ));"},{"type":"DELETE","lineNumber":199,"oldContent":"        ));"},{"type":"DELETE","lineNumber":201,"oldContent":"      }"},{"type":"DELETE","lineNumber":204,"oldContent":"      ));"},{"type":"DELETE","lineNumber":208,"oldContent":"    Emitter<AuthState> emit,"},{"type":"MODIFY","lineNumber":210,"content":"    Emitter<AuthState> emit,","oldContent":"  ) async {"},{"type":"INSERT","lineNumber":211,"content":"  ) async {"}]},{"timestamp":1754628935008,"changes":[{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:flutter/foundation.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":"import 'package:meta/meta.dart';"},{"type":"MODIFY","lineNumber":189,"content":"          status: AuthStatus.unauthenticated,","oldContent":"          status: AuthStatus.unauthenticated,"},{"type":"DELETE","lineNumber":193,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":195,"oldContent":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":194,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":195,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":197,"content":"      ));"},{"type":"DELETE","lineNumber":201,"oldContent":"      ));"},{"type":"INSERT","lineNumber":207,"content":"    RegisterRequested event,"},{"type":"DELETE","lineNumber":211,"oldContent":"    RegisterRequested event,"}]},{"timestamp":1754629755753,"changes":[{"type":"DELETE","lineNumber":187,"oldContent":"          status: AuthStatus.unauthenticated,"},{"type":"DELETE","lineNumber":188,"oldContent":"          status: AuthStatus.unauthenticated,"},{"type":"INSERT","lineNumber":187,"content":"      } else {"},{"type":"INSERT","lineNumber":189,"content":"          status: AuthStatus.unauthenticated,"},{"type":"DELETE","lineNumber":191,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":193,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":195,"oldContent":"      ));"},{"type":"INSERT","lineNumber":194,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":195,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":197,"content":"      ));"},{"type":"DELETE","lineNumber":205,"oldContent":"    RegisterRequested event,"},{"type":"INSERT","lineNumber":207,"content":"    RegisterRequested event,"},{"type":"MODIFY","lineNumber":244,"content":"      // Validate phone number format (basic validation)","oldContent":"      emit(state.copyWith(status: AuthStatus.loading));"},{"type":"INSERT","lineNumber":245,"content":"      if (event.phoneNumber.isEmpty || event.phoneNumber.length < 10) {"},{"type":"INSERT","lineNumber":246,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":247,"content":"          status: AuthStatus.error,"},{"type":"INSERT","lineNumber":248,"content":"          error: 'Please enter a valid phone number',"},{"type":"INSERT","lineNumber":249,"content":"        ));"},{"type":"INSERT","lineNumber":250,"content":"        return;"},{"type":"INSERT","lineNumber":251,"content":"      }"},{"type":"INSERT","lineNumber":252,"content":""},{"type":"INSERT","lineNumber":253,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":254,"content":"        status: AuthStatus.loading,"},{"type":"INSERT","lineNumber":255,"content":"        error: null, // Clear any previous errors"},{"type":"INSERT","lineNumber":256,"content":"      ));"},{"type":"INSERT","lineNumber":258,"content":"      // Format phone number with country code if needed"},{"type":"INSERT","lineNumber":259,"content":"      String formattedPhoneNumber = event.phoneNumber;"},{"type":"INSERT","lineNumber":260,"content":"      if (!formattedPhoneNumber.startsWith('+')) {"},{"type":"INSERT","lineNumber":261,"content":"        formattedPhoneNumber = '+91$formattedPhoneNumber'; // Default to India (+91)"},{"type":"INSERT","lineNumber":262,"content":"      }"},{"type":"INSERT","lineNumber":263,"content":""},{"type":"DELETE","lineNumber":247,"oldContent":"        phoneNumber: event.phoneNumber,"},{"type":"INSERT","lineNumber":265,"content":"        phoneNumber: formattedPhoneNumber,"},{"type":"DELETE","lineNumber":250,"oldContent":"          await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":268,"content":"          try {"},{"type":"INSERT","lineNumber":269,"content":"            await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":270,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":271,"content":"              status: AuthStatus.verificationSuccessful,"},{"type":"INSERT","lineNumber":272,"content":"            ));"},{"type":"INSERT","lineNumber":273,"content":"          } catch (e) {"},{"type":"INSERT","lineNumber":274,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":275,"content":"              status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":276,"content":"              error: 'Auto-verification failed. Please enter OTP manually.',"},{"type":"INSERT","lineNumber":277,"content":"            ));"},{"type":"INSERT","lineNumber":278,"content":"          }"},{"type":"INSERT","lineNumber":281,"content":"          String errorMessage = _getErrorMessage(e.code);"},{"type":"INSERT","lineNumber":282,"content":"          if (e.code == 'too-many-requests') {"},{"type":"INSERT","lineNumber":283,"content":"            errorMessage = 'Too many requests. Please try again later.';"},{"type":"INSERT","lineNumber":284,"content":"          } else if (e.code == 'invalid-phone-number') {"},{"type":"INSERT","lineNumber":285,"content":"            errorMessage = 'The provided phone number is not valid.';"},{"type":"INSERT","lineNumber":286,"content":"          }"},{"type":"INSERT","lineNumber":287,"content":"          "},{"type":"DELETE","lineNumber":255,"oldContent":"            error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":290,"content":"            error: errorMessage,"},{"type":"INSERT","lineNumber":298,"content":"            error: null, // Clear any previous errors"},{"type":"DELETE","lineNumber":266,"oldContent":"          // Auto-resolution timeout, you might want to handle this case"},{"type":"INSERT","lineNumber":302,"content":"          // Handle timeout if needed"},{"type":"INSERT","lineNumber":303,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":304,"content":"            status: AuthStatus.otpTimeout,"},{"type":"INSERT","lineNumber":305,"content":"            verificationId: verificationId,"},{"type":"INSERT","lineNumber":306,"content":"          ));"},{"type":"INSERT","lineNumber":310,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":311,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":312,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":313,"content":"        error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":314,"content":"      ));"},{"type":"DELETE","lineNumber":273,"oldContent":"        error: 'Failed to send OTP. Please try again.',"},{"type":"INSERT","lineNumber":318,"content":"        error: 'Failed to send OTP. Please check your connection and try again.',"}]},{"timestamp":1754629770873,"changes":[{"type":"INSERT","lineNumber":13,"content":"  otpTimeout,"},{"type":"DELETE","lineNumber":188,"oldContent":"          status: AuthStatus.unauthenticated,"},{"type":"INSERT","lineNumber":190,"content":"          status: AuthStatus.unauthenticated,"},{"type":"DELETE","lineNumber":192,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":194,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":196,"oldContent":"      ));"},{"type":"INSERT","lineNumber":195,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":196,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":198,"content":"      ));"},{"type":"DELETE","lineNumber":206,"oldContent":"    RegisterRequested event,"},{"type":"INSERT","lineNumber":208,"content":"    RegisterRequested event,"},{"type":"DELETE","lineNumber":246,"oldContent":"      "},{"type":"DELETE","lineNumber":248,"oldContent":"      await _auth.verifyPhoneNumber("},{"type":"DELETE","lineNumber":251,"oldContent":"        verificationCompleted: (PhoneAuthCredential credential) async {"},{"type":"DELETE","lineNumber":253,"oldContent":"          // Auto-verify on Android devices"},{"type":"DELETE","lineNumber":256,"oldContent":"        },"},{"type":"DELETE","lineNumber":258,"oldContent":"        verificationFailed: (FirebaseAuthException e) {"},{"type":"DELETE","lineNumber":260,"oldContent":"          emit(state.copyWith("},{"type":"DELETE","lineNumber":262,"oldContent":"            status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":258,"content":"      "},{"type":"INSERT","lineNumber":259,"content":"      // Format phone number with country code if needed"},{"type":"INSERT","lineNumber":260,"content":"      String formattedPhoneNumber = event.phoneNumber;"},{"type":"INSERT","lineNumber":261,"content":"      if (!formattedPhoneNumber.startsWith('+')) {"},{"type":"INSERT","lineNumber":262,"content":"        formattedPhoneNumber = '+91$formattedPhoneNumber'; // Default to India (+91)"},{"type":"INSERT","lineNumber":263,"content":"      }"},{"type":"INSERT","lineNumber":264,"content":""},{"type":"INSERT","lineNumber":265,"content":"      await _auth.verifyPhoneNumber("},{"type":"INSERT","lineNumber":266,"content":"        phoneNumber: formattedPhoneNumber,"},{"type":"INSERT","lineNumber":267,"content":"        verificationCompleted: (PhoneAuthCredential credential) async {"},{"type":"INSERT","lineNumber":268,"content":"          // Auto-verify on Android devices"},{"type":"INSERT","lineNumber":269,"content":"          try {"},{"type":"INSERT","lineNumber":270,"content":"            await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":271,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":272,"content":"              status: AuthStatus.verificationSuccessful,"},{"type":"INSERT","lineNumber":273,"content":"            ));"},{"type":"INSERT","lineNumber":274,"content":"          } catch (e) {"},{"type":"INSERT","lineNumber":275,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":276,"content":"              status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":277,"content":"              error: 'Auto-verification failed. Please enter OTP manually.',"},{"type":"INSERT","lineNumber":278,"content":"            ));"},{"type":"INSERT","lineNumber":279,"content":"          }"},{"type":"INSERT","lineNumber":280,"content":"        },"},{"type":"INSERT","lineNumber":281,"content":"        verificationFailed: (FirebaseAuthException e) {"},{"type":"INSERT","lineNumber":282,"content":"          String errorMessage = _getErrorMessage(e.code);"},{"type":"INSERT","lineNumber":283,"content":"          if (e.code == 'too-many-requests') {"},{"type":"INSERT","lineNumber":284,"content":"            errorMessage = 'Too many requests. Please try again later.';"},{"type":"INSERT","lineNumber":285,"content":"          } else if (e.code == 'invalid-phone-number') {"},{"type":"INSERT","lineNumber":286,"content":"            errorMessage = 'The provided phone number is not valid.';"},{"type":"INSERT","lineNumber":287,"content":"          }"},{"type":"INSERT","lineNumber":288,"content":"          "},{"type":"INSERT","lineNumber":289,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":290,"content":"            status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":291,"content":"            error: errorMessage,"},{"type":"DELETE","lineNumber":267,"oldContent":"      // Format phone number with country code if needed"},{"type":"DELETE","lineNumber":269,"oldContent":"      String formattedPhoneNumber = event.phoneNumber;"},{"type":"DELETE","lineNumber":271,"oldContent":"      if (!formattedPhoneNumber.startsWith('+')) {"},{"type":"DELETE","lineNumber":273,"oldContent":"        formattedPhoneNumber = '+91$formattedPhoneNumber'; // Default to India (+91)"},{"type":"DELETE","lineNumber":275,"oldContent":"      }"},{"type":"DELETE","lineNumber":277,"oldContent":""},{"type":"INSERT","lineNumber":299,"content":"            error: null, // Clear any previous errors"},{"type":"DELETE","lineNumber":280,"oldContent":"        phoneNumber: formattedPhoneNumber,"},{"type":"INSERT","lineNumber":303,"content":"          // Handle timeout if needed"},{"type":"INSERT","lineNumber":304,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":305,"content":"            status: AuthStatus.otpTimeout,"},{"type":"INSERT","lineNumber":306,"content":"            verificationId: verificationId,"},{"type":"INSERT","lineNumber":307,"content":"          ));"},{"type":"DELETE","lineNumber":283,"oldContent":"          try {"},{"type":"DELETE","lineNumber":285,"oldContent":"            await _auth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":287,"oldContent":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":311,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":312,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":313,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":314,"content":"        error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":315,"content":"      ));"},{"type":"DELETE","lineNumber":289,"oldContent":"              status: AuthStatus.verificationSuccessful,"},{"type":"DELETE","lineNumber":291,"oldContent":"            ));"},{"type":"DELETE","lineNumber":293,"oldContent":"          } catch (e) {"},{"type":"DELETE","lineNumber":294,"oldContent":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":319,"content":"        error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"DELETE","lineNumber":296,"oldContent":"              status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":298,"oldContent":"              error: 'Auto-verification failed. Please enter OTP manually.',"},{"type":"DELETE","lineNumber":300,"oldContent":"            ));"},{"type":"DELETE","lineNumber":302,"oldContent":"          }"},{"type":"DELETE","lineNumber":306,"oldContent":"          String errorMessage = _getErrorMessage(e.code);"},{"type":"DELETE","lineNumber":308,"oldContent":"          if (e.code == 'too-many-requests') {"},{"type":"DELETE","lineNumber":310,"oldContent":"            errorMessage = 'Too many requests. Please try again later.';"},{"type":"DELETE","lineNumber":312,"oldContent":"          } else if (e.code == 'invalid-phone-number') {"},{"type":"DELETE","lineNumber":314,"oldContent":"            errorMessage = 'The provided phone number is not valid.';"},{"type":"DELETE","lineNumber":316,"oldContent":"          }"},{"type":"DELETE","lineNumber":318,"oldContent":"          "},{"type":"DELETE","lineNumber":322,"oldContent":"            error: errorMessage,"},{"type":"DELETE","lineNumber":331,"oldContent":"            error: null, // Clear any previous errors"},{"type":"DELETE","lineNumber":336,"oldContent":"          // Handle timeout if needed"},{"type":"DELETE","lineNumber":338,"oldContent":"          emit(state.copyWith("},{"type":"DELETE","lineNumber":340,"oldContent":"            status: AuthStatus.otpTimeout,"},{"type":"DELETE","lineNumber":342,"oldContent":"            verificationId: verificationId,"},{"type":"DELETE","lineNumber":344,"oldContent":"          ));"},{"type":"DELETE","lineNumber":349,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":351,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":353,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":355,"oldContent":"        error: _getErrorMessage(e.code),"},{"type":"DELETE","lineNumber":357,"oldContent":"      ));"},{"type":"DELETE","lineNumber":362,"oldContent":"        error: 'Failed to send OTP. Please check your connection and try again.',"}]},{"timestamp":1754632036683,"changes":[{"type":"MODIFY","lineNumber":195,"content":"      emit(state.copyWith(","oldContent":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":254,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":255,"content":"        status: AuthStatus.loading,"},{"type":"INSERT","lineNumber":256,"content":"        error: null, // Clear any previous errors"},{"type":"INSERT","lineNumber":257,"content":"      ));"},{"type":"DELETE","lineNumber":256,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":259,"oldContent":"        status: AuthStatus.loading,"},{"type":"DELETE","lineNumber":262,"oldContent":"        error: null, // Clear any previous errors"},{"type":"DELETE","lineNumber":264,"oldContent":"      ));"},{"type":"DELETE","lineNumber":266,"oldContent":"          ));"},{"type":"DELETE","lineNumber":268,"oldContent":"        },"},{"type":"DELETE","lineNumber":271,"oldContent":"        codeSent: (String verificationId, int? resendToken) {"},{"type":"DELETE","lineNumber":274,"oldContent":"          emit(state.copyWith("},{"type":"DELETE","lineNumber":277,"oldContent":"            status: AuthStatus.otpSent,"},{"type":"DELETE","lineNumber":280,"oldContent":"            verificationId: verificationId,"},{"type":"DELETE","lineNumber":283,"oldContent":"            resendToken: resendToken,"},{"type":"DELETE","lineNumber":286,"oldContent":"          ));"},{"type":"DELETE","lineNumber":289,"oldContent":"        },"},{"type":"DELETE","lineNumber":291,"oldContent":"        codeAutoRetrievalTimeout: (String verificationId) {"},{"type":"DELETE","lineNumber":293,"oldContent":"        },"},{"type":"DELETE","lineNumber":296,"oldContent":"        timeout: const Duration(seconds: 60),"},{"type":"DELETE","lineNumber":299,"oldContent":"      );"},{"type":"DELETE","lineNumber":302,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":305,"oldContent":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":292,"content":"          ));"},{"type":"INSERT","lineNumber":293,"content":"        },"},{"type":"INSERT","lineNumber":294,"content":"        codeSent: (String verificationId, int? resendToken) {"},{"type":"INSERT","lineNumber":295,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":296,"content":"            status: AuthStatus.otpSent,"},{"type":"INSERT","lineNumber":297,"content":"            verificationId: verificationId,"},{"type":"INSERT","lineNumber":298,"content":"            resendToken: resendToken,"},{"type":"INSERT","lineNumber":299,"content":"            error: null, // Clear any previous errors"},{"type":"INSERT","lineNumber":300,"content":"          ));"},{"type":"INSERT","lineNumber":301,"content":"        },"},{"type":"INSERT","lineNumber":302,"content":"        codeAutoRetrievalTimeout: (String verificationId) {"},{"type":"INSERT","lineNumber":303,"content":"          // Handle timeout if needed"},{"type":"INSERT","lineNumber":304,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":305,"content":"            status: AuthStatus.otpTimeout,"},{"type":"INSERT","lineNumber":306,"content":"            verificationId: verificationId,"},{"type":"INSERT","lineNumber":307,"content":"          ));"},{"type":"INSERT","lineNumber":308,"content":"        },"},{"type":"INSERT","lineNumber":309,"content":"        timeout: const Duration(seconds: 60),"},{"type":"INSERT","lineNumber":310,"content":"      );"},{"type":"INSERT","lineNumber":311,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":312,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":314,"content":"        error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":316,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":317,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":318,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":319,"content":"        error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"INSERT","lineNumber":320,"content":"      ));"},{"type":"DELETE","lineNumber":310,"oldContent":"            error: null, // Clear any previous errors"},{"type":"DELETE","lineNumber":313,"oldContent":"          // Handle timeout if needed"},{"type":"DELETE","lineNumber":315,"oldContent":"          emit(state.copyWith("},{"type":"DELETE","lineNumber":317,"oldContent":"            status: AuthStatus.otpTimeout,"},{"type":"DELETE","lineNumber":319,"oldContent":"            verificationId: verificationId,"},{"type":"DELETE","lineNumber":320,"oldContent":"          ));"},{"type":"DELETE","lineNumber":323,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":325,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":326,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":328,"oldContent":"        error: _getErrorMessage(e.code),"},{"type":"DELETE","lineNumber":329,"oldContent":"      ));"},{"type":"DELETE","lineNumber":332,"oldContent":"        error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"MODIFY","lineNumber":336,"content":"      final userCredential = await _auth.signInWithCredential(credential);","oldContent":"      await _auth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":338,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":339,"oldContent":"        status: AuthStatus.verificationSuccessful,"},{"type":"DELETE","lineNumber":340,"oldContent":"      ));"},{"type":"INSERT","lineNumber":338,"content":"      if (userCredential.user != null) {"},{"type":"INSERT","lineNumber":339,"content":"        // Update user data in the state"},{"type":"INSERT","lineNumber":340,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":341,"content":"          status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":342,"content":"          user: userCredential.user,"},{"type":"INSERT","lineNumber":343,"content":"          isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"INSERT","lineNumber":344,"content":"        ));"},{"type":"INSERT","lineNumber":345,"content":"      } else {"},{"type":"INSERT","lineNumber":346,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":347,"content":"          status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":348,"content":"          error: 'User not found after verification',"},{"type":"INSERT","lineNumber":349,"content":"        ));"},{"type":"INSERT","lineNumber":350,"content":"      }"}]},{"timestamp":1754642592939,"changes":[{"type":"INSERT","lineNumber":194,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":195,"oldContent":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":244,"content":"    // Create a Completer to handle the async operation"},{"type":"INSERT","lineNumber":245,"content":"    final completer = Completer<void>();"},{"type":"INSERT","lineNumber":246,"content":"    "},{"type":"DELETE","lineNumber":255,"oldContent":"      "},{"type":"DELETE","lineNumber":257,"oldContent":"      // Format phone number with country code if needed"},{"type":"INSERT","lineNumber":261,"content":"      "},{"type":"INSERT","lineNumber":262,"content":"      // Format phone number with country code if needed"},{"type":"DELETE","lineNumber":265,"oldContent":"      await _auth.verifyPhoneNumber("},{"type":"DELETE","lineNumber":266,"oldContent":"        phoneNumber: formattedPhoneNumber,"},{"type":"DELETE","lineNumber":267,"oldContent":"        verificationCompleted: (PhoneAuthCredential credential) async {"},{"type":"DELETE","lineNumber":268,"oldContent":"          // Auto-verify on Android devices"},{"type":"DELETE","lineNumber":269,"oldContent":"          try {"},{"type":"DELETE","lineNumber":270,"oldContent":"            await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":268,"content":"      // Handle verification callbacks"},{"type":"INSERT","lineNumber":269,"content":"      void handleVerificationCompleted(PhoneAuthCredential credential) async {"},{"type":"INSERT","lineNumber":270,"content":"        try {"},{"type":"INSERT","lineNumber":271,"content":"          await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":272,"content":"          if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":274,"oldContent":"          } catch (e) {"},{"type":"INSERT","lineNumber":276,"content":"            completer.complete();"},{"type":"INSERT","lineNumber":277,"content":"          }"},{"type":"INSERT","lineNumber":278,"content":"        } catch (e) {"},{"type":"INSERT","lineNumber":279,"content":"          if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":284,"content":"            completer.completeError(e);"},{"type":"DELETE","lineNumber":280,"oldContent":"        },"},{"type":"DELETE","lineNumber":281,"oldContent":"        verificationFailed: (FirebaseAuthException e) {"},{"type":"DELETE","lineNumber":282,"oldContent":"          ));"},{"type":"INSERT","lineNumber":286,"content":"        }"},{"type":"INSERT","lineNumber":287,"content":"      }"},{"type":"INSERT","lineNumber":288,"content":""},{"type":"INSERT","lineNumber":289,"content":"      void handleVerificationFailed(FirebaseAuthException e) {"},{"type":"INSERT","lineNumber":290,"content":"        if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":284,"oldContent":"        },"},{"type":"DELETE","lineNumber":285,"oldContent":"        codeSent: (String verificationId, int? resendToken) {"},{"type":"DELETE","lineNumber":287,"oldContent":"          emit(state.copyWith("},{"type":"DELETE","lineNumber":289,"oldContent":"            status: AuthStatus.otpSent,"},{"type":"DELETE","lineNumber":290,"oldContent":"            verificationId: verificationId,"},{"type":"DELETE","lineNumber":292,"oldContent":"            resendToken: resendToken,"},{"type":"DELETE","lineNumber":294,"oldContent":"            error: null, // Clear any previous errors"},{"type":"DELETE","lineNumber":295,"oldContent":"          ));"},{"type":"DELETE","lineNumber":297,"oldContent":"        },"},{"type":"DELETE","lineNumber":299,"oldContent":"        codeAutoRetrievalTimeout: (String verificationId) {"},{"type":"DELETE","lineNumber":300,"oldContent":"          // Handle timeout if needed"},{"type":"DELETE","lineNumber":302,"oldContent":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":300,"content":"            error: errorMessage,"},{"type":"INSERT","lineNumber":301,"content":"          ));"},{"type":"INSERT","lineNumber":302,"content":"          completer.completeError(e);"},{"type":"INSERT","lineNumber":303,"content":"        }"},{"type":"INSERT","lineNumber":304,"content":"      }"},{"type":"INSERT","lineNumber":305,"content":""},{"type":"INSERT","lineNumber":306,"content":"      void handleCodeSent(String verificationId, int? resendToken) {"},{"type":"INSERT","lineNumber":307,"content":"        if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":308,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":309,"content":"            status: AuthStatus.otpSent,"},{"type":"INSERT","lineNumber":310,"content":"            verificationId: verificationId,"},{"type":"INSERT","lineNumber":311,"content":"            resendToken: resendToken,"},{"type":"INSERT","lineNumber":312,"content":"            error: null, // Clear any previous errors"},{"type":"INSERT","lineNumber":313,"content":"          ));"},{"type":"INSERT","lineNumber":314,"content":"          completer.complete();"},{"type":"INSERT","lineNumber":315,"content":"        }"},{"type":"INSERT","lineNumber":316,"content":"      }"},{"type":"INSERT","lineNumber":317,"content":""},{"type":"INSERT","lineNumber":318,"content":"      void handleCodeAutoRetrievalTimeout(String verificationId) {"},{"type":"INSERT","lineNumber":319,"content":"        if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":320,"content":"          emit(state.copyWith("},{"type":"DELETE","lineNumber":306,"oldContent":"            error: errorMessage,"},{"type":"DELETE","lineNumber":308,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":309,"oldContent":"        },"},{"type":"DELETE","lineNumber":310,"oldContent":"      ));"},{"type":"INSERT","lineNumber":324,"content":"          completer.complete();"},{"type":"INSERT","lineNumber":325,"content":"        }"},{"type":"INSERT","lineNumber":326,"content":"      }"},{"type":"INSERT","lineNumber":327,"content":""},{"type":"INSERT","lineNumber":328,"content":"      // Start the phone number verification"},{"type":"INSERT","lineNumber":329,"content":"      _auth.verifyPhoneNumber("},{"type":"INSERT","lineNumber":330,"content":"        phoneNumber: formattedPhoneNumber,"},{"type":"INSERT","lineNumber":331,"content":"        verificationCompleted: handleVerificationCompleted,"},{"type":"INSERT","lineNumber":332,"content":"        verificationFailed: handleVerificationFailed,"},{"type":"INSERT","lineNumber":333,"content":"        codeSent: handleCodeSent,"},{"type":"INSERT","lineNumber":334,"content":"        codeAutoRetrievalTimeout: handleCodeAutoRetrievalTimeout,"},{"type":"DELETE","lineNumber":312,"oldContent":"    }"},{"type":"INSERT","lineNumber":337,"content":""},{"type":"INSERT","lineNumber":338,"content":"      // Wait for the verification process to complete"},{"type":"INSERT","lineNumber":339,"content":"      await completer.future;"},{"type":"INSERT","lineNumber":341,"content":"      if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":342,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":343,"content":"          status: AuthStatus.error,"},{"type":"INSERT","lineNumber":344,"content":"          error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":345,"content":"        ));"},{"type":"INSERT","lineNumber":346,"content":"      }"},{"type":"INSERT","lineNumber":347,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":348,"content":"      if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":349,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":350,"content":"          status: AuthStatus.error,"},{"type":"INSERT","lineNumber":351,"content":"          error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"INSERT","lineNumber":352,"content":"      ));"},{"type":"INSERT","lineNumber":353,"content":"    }"},{"type":"DELETE","lineNumber":316,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":318,"oldContent":"        error: _getErrorMessage(e.code),"},{"type":"DELETE","lineNumber":320,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":322,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":323,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":325,"oldContent":"        error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"DELETE","lineNumber":326,"oldContent":"      ));"},{"type":"DELETE","lineNumber":342,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":344,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":346,"oldContent":"        status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":348,"oldContent":"        error: _getErrorMessage(e.code),"},{"type":"DELETE","lineNumber":350,"oldContent":"      ));"},{"type":"DELETE","lineNumber":352,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":354,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":356,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":358,"oldContent":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"INSERT","lineNumber":383,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":384,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":385,"content":"        status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":386,"content":"        error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":388,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":389,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":390,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":391,"content":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"INSERT","lineNumber":392,"content":"      ));"}]},{"timestamp":1754642622205,"changes":[{"type":"DELETE","lineNumber":245,"oldContent":"    try {"},{"type":"MODIFY","lineNumber":247,"content":"    try {","oldContent":"      // Validate phone number format (basic validation)"},{"type":"INSERT","lineNumber":248,"content":"      // Validate phone number format (basic validation)"},{"type":"DELETE","lineNumber":261,"oldContent":"      String formattedPhoneNumber = event.phoneNumber;"},{"type":"MODIFY","lineNumber":263,"content":"      String formattedPhoneNumber = event.phoneNumber;","oldContent":"      if (!formattedPhoneNumber.startsWith('+')) {"},{"type":"INSERT","lineNumber":264,"content":"      if (!formattedPhoneNumber.startsWith('+')) {"},{"type":"MODIFY","lineNumber":273,"content":"            emit(state.copyWith(","oldContent":"            emit(state.copyWith("},{"type":"DELETE","lineNumber":276,"oldContent":"            emit(state.copyWith("},{"type":"DELETE","lineNumber":278,"oldContent":"              status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":280,"oldContent":"              error: 'Auto-verification failed. Please enter OTP manually.',"},{"type":"DELETE","lineNumber":282,"oldContent":"            ));"},{"type":"DELETE","lineNumber":284,"oldContent":"          }"},{"type":"DELETE","lineNumber":285,"oldContent":"          String errorMessage = _getErrorMessage(e.code);"},{"type":"INSERT","lineNumber":280,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":281,"content":"              status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":282,"content":"              error: 'Auto-verification failed. Please enter OTP manually.',"},{"type":"INSERT","lineNumber":283,"content":"            ));"},{"type":"INSERT","lineNumber":285,"content":"          }"},{"type":"DELETE","lineNumber":288,"oldContent":"          if (e.code == 'too-many-requests') {"},{"type":"MODIFY","lineNumber":291,"content":"          String errorMessage = _getErrorMessage(e.code);","oldContent":"            errorMessage = 'Too many requests. Please try again later.';"},{"type":"INSERT","lineNumber":292,"content":"          if (e.code == 'too-many-requests') {"},{"type":"INSERT","lineNumber":293,"content":"            errorMessage = 'Too many requests. Please try again later.';"},{"type":"INSERT","lineNumber":298,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":299,"content":"            status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":300,"oldContent":"          emit(state.copyWith("},{"type":"DELETE","lineNumber":303,"oldContent":"            status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":305,"oldContent":"            status: AuthStatus.otpTimeout,"},{"type":"DELETE","lineNumber":307,"oldContent":"            verificationId: verificationId,"},{"type":"DELETE","lineNumber":310,"oldContent":"          ));"},{"type":"DELETE","lineNumber":315,"oldContent":"        timeout: const Duration(seconds: 60),"},{"type":"DELETE","lineNumber":318,"oldContent":"      );"},{"type":"DELETE","lineNumber":320,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":322,"oldContent":"  }"},{"type":"DELETE","lineNumber":325,"oldContent":""},{"type":"DELETE","lineNumber":328,"oldContent":"  Future<void> _onVerifyOtpRequested("},{"type":"DELETE","lineNumber":330,"oldContent":"    VerifyOtpRequested event,"},{"type":"INSERT","lineNumber":321,"content":"            status: AuthStatus.otpTimeout,"},{"type":"INSERT","lineNumber":322,"content":"            verificationId: verificationId,"},{"type":"INSERT","lineNumber":323,"content":"          ));"},{"type":"DELETE","lineNumber":332,"oldContent":"    Emitter<AuthState> emit,"},{"type":"DELETE","lineNumber":336,"oldContent":"  ) async {"},{"type":"DELETE","lineNumber":338,"oldContent":"    try {"},{"type":"DELETE","lineNumber":340,"oldContent":"      emit(state.copyWith(status: AuthStatus.verificationInProgress));"},{"type":"DELETE","lineNumber":342,"oldContent":"      "},{"type":"DELETE","lineNumber":344,"oldContent":"      final credential = PhoneAuthProvider.credential("},{"type":"DELETE","lineNumber":346,"oldContent":"        verificationId: event.verificationId,"},{"type":"DELETE","lineNumber":348,"oldContent":"        smsCode: event.smsCode,"},{"type":"INSERT","lineNumber":335,"content":"        timeout: const Duration(seconds: 60),"},{"type":"DELETE","lineNumber":352,"oldContent":"      final userCredential = await _auth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":353,"oldContent":""},{"type":"DELETE","lineNumber":354,"oldContent":"      "},{"type":"DELETE","lineNumber":356,"oldContent":"      if (userCredential.user != null) {"},{"type":"DELETE","lineNumber":358,"oldContent":"        // Update user data in the state"},{"type":"DELETE","lineNumber":359,"oldContent":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":340,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":361,"oldContent":"          status: AuthStatus.authenticated,"},{"type":"DELETE","lineNumber":364,"oldContent":"          user: userCredential.user,"},{"type":"DELETE","lineNumber":367,"oldContent":"          isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"DELETE","lineNumber":370,"oldContent":"        ));"},{"type":"DELETE","lineNumber":373,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":376,"oldContent":"        emit(state.copyWith("},{"type":"DELETE","lineNumber":377,"oldContent":"      ));"},{"type":"INSERT","lineNumber":352,"content":"        ));"},{"type":"INSERT","lineNumber":353,"content":"      }"},{"type":"INSERT","lineNumber":355,"content":"  }"},{"type":"INSERT","lineNumber":356,"content":""},{"type":"INSERT","lineNumber":357,"content":"  Future<void> _onVerifyOtpRequested("},{"type":"INSERT","lineNumber":358,"content":"    VerifyOtpRequested event,"},{"type":"INSERT","lineNumber":359,"content":"    Emitter<AuthState> emit,"},{"type":"INSERT","lineNumber":360,"content":"  ) async {"},{"type":"INSERT","lineNumber":361,"content":"    try {"},{"type":"INSERT","lineNumber":362,"content":"      emit(state.copyWith(status: AuthStatus.verificationInProgress));"},{"type":"INSERT","lineNumber":363,"content":"      "},{"type":"INSERT","lineNumber":364,"content":"      final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":365,"content":"        verificationId: event.verificationId,"},{"type":"INSERT","lineNumber":366,"content":"        smsCode: event.smsCode,"},{"type":"INSERT","lineNumber":367,"content":"      );"},{"type":"INSERT","lineNumber":368,"content":""},{"type":"INSERT","lineNumber":369,"content":"      final userCredential = await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":370,"content":"      "},{"type":"INSERT","lineNumber":371,"content":"      if (userCredential.user != null) {"},{"type":"INSERT","lineNumber":372,"content":"        // Update user data in the state"},{"type":"INSERT","lineNumber":373,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":374,"content":"          status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":375,"content":"          user: userCredential.user,"},{"type":"INSERT","lineNumber":376,"content":"          isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"INSERT","lineNumber":377,"content":"        ));"},{"type":"INSERT","lineNumber":378,"content":"      } else {"},{"type":"INSERT","lineNumber":379,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":384,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":385,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":386,"content":"        status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":387,"content":"        error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":389,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":390,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":391,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":392,"content":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"INSERT","lineNumber":393,"content":"      ));"},{"type":"DELETE","lineNumber":406,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":408,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":410,"oldContent":"        status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":412,"oldContent":"        error: _getErrorMessage(e.code),"},{"type":"DELETE","lineNumber":415,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":417,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":419,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":421,"oldContent":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"DELETE","lineNumber":423,"oldContent":"      ));"}]},{"timestamp":1754644322063,"changes":[{"type":"INSERT","lineNumber":246,"content":"    "},{"type":"DELETE","lineNumber":248,"oldContent":"    "},{"type":"INSERT","lineNumber":262,"content":"      // Format phone number with country code if needed"},{"type":"DELETE","lineNumber":264,"oldContent":"      // Format phone number with country code if needed"},{"type":"INSERT","lineNumber":272,"content":"          if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":273,"oldContent":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":278,"content":"        } catch (e) {"},{"type":"INSERT","lineNumber":279,"content":"          if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":280,"oldContent":"        } catch (e) {"},{"type":"DELETE","lineNumber":283,"oldContent":"          if (!completer.isCompleted) {"},{"type":"MODIFY","lineNumber":285,"content":"          }","oldContent":"          }"},{"type":"INSERT","lineNumber":289,"content":"      void handleVerificationFailed(FirebaseAuthException e) {"},{"type":"INSERT","lineNumber":290,"content":"        if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":291,"oldContent":"      void handleVerificationFailed(FirebaseAuthException e) {"},{"type":"DELETE","lineNumber":293,"oldContent":"        if (!completer.isCompleted) {"},{"type":"MODIFY","lineNumber":300,"content":"            error: errorMessage,","oldContent":"            error: errorMessage,"},{"type":"DELETE","lineNumber":315,"oldContent":"            status: AuthStatus.otpTimeout,"},{"type":"DELETE","lineNumber":317,"oldContent":"            verificationId: verificationId,"},{"type":"DELETE","lineNumber":318,"oldContent":"          ));"},{"type":"INSERT","lineNumber":321,"content":"            status: AuthStatus.otpTimeout,"},{"type":"INSERT","lineNumber":322,"content":"            verificationId: verificationId,"},{"type":"INSERT","lineNumber":323,"content":"          ));"},{"type":"DELETE","lineNumber":327,"oldContent":"        timeout: const Duration(seconds: 60),"},{"type":"DELETE","lineNumber":331,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":335,"content":"        timeout: const Duration(seconds: 60),"},{"type":"INSERT","lineNumber":338,"content":"      // Wait for the verification process to complete"},{"type":"INSERT","lineNumber":339,"content":"      await completer.future;"},{"type":"INSERT","lineNumber":340,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":341,"content":"      if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":342,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":343,"content":"          status: AuthStatus.error,"},{"type":"INSERT","lineNumber":344,"content":"          error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":347,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":348,"content":"      if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":349,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":350,"content":"          status: AuthStatus.error,"},{"type":"INSERT","lineNumber":351,"content":"          error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"INSERT","lineNumber":352,"content":"        ));"},{"type":"INSERT","lineNumber":353,"content":"      }"},{"type":"INSERT","lineNumber":354,"content":"    }"},{"type":"DELETE","lineNumber":342,"oldContent":"      // Wait for the verification process to complete"},{"type":"DELETE","lineNumber":345,"oldContent":"      await completer.future;"},{"type":"DELETE","lineNumber":349,"oldContent":"      if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":363,"content":"      "},{"type":"INSERT","lineNumber":364,"content":"      // For testing: Auto-verify if OTP is 000000"},{"type":"INSERT","lineNumber":365,"content":"      if (event.smsCode == '000000') {"},{"type":"INSERT","lineNumber":366,"content":"        // Create a mock user for testing"},{"type":"INSERT","lineNumber":368,"content":"          status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":369,"content":"          user: _auth.currentUser,"},{"type":"INSERT","lineNumber":370,"content":"          isNewUser: true,"},{"type":"INSERT","lineNumber":371,"content":"        ));"},{"type":"INSERT","lineNumber":372,"content":"        return;"},{"type":"INSERT","lineNumber":373,"content":"      }"},{"type":"DELETE","lineNumber":354,"oldContent":"          status: AuthStatus.error,"},{"type":"DELETE","lineNumber":357,"oldContent":"          error: _getErrorMessage(e.code),"},{"type":"DELETE","lineNumber":359,"oldContent":"        ));"},{"type":"DELETE","lineNumber":362,"oldContent":"      }"},{"type":"DELETE","lineNumber":364,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":367,"oldContent":"      if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":370,"oldContent":"        emit(state.copyWith("},{"type":"DELETE","lineNumber":372,"oldContent":"          status: AuthStatus.error,"},{"type":"DELETE","lineNumber":374,"oldContent":"          error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"DELETE","lineNumber":378,"oldContent":"    }"},{"type":"DELETE","lineNumber":384,"oldContent":"      ));"},{"type":"DELETE","lineNumber":386,"oldContent":"    }"},{"type":"DELETE","lineNumber":388,"oldContent":"  }"},{"type":"DELETE","lineNumber":390,"oldContent":""},{"type":"INSERT","lineNumber":399,"content":"      ));"},{"type":"INSERT","lineNumber":400,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":401,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":402,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":403,"content":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"INSERT","lineNumber":404,"content":"      ));"},{"type":"INSERT","lineNumber":405,"content":"    }"},{"type":"INSERT","lineNumber":406,"content":"  }"},{"type":"INSERT","lineNumber":407,"content":""},{"type":"DELETE","lineNumber":394,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":396,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":398,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":400,"oldContent":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"DELETE","lineNumber":402,"oldContent":"      ));"}]},{"timestamp":1754644745552,"changes":[{"type":"DELETE","lineNumber":223,"oldContent":"      // Update user profile with phone number (custom claim or Firestore would be better)"},{"type":"DELETE","lineNumber":224,"oldContent":"      await credential.user?.updatePhoneNumber(event.phoneNumber as PhoneAuthCredential);"},{"type":"DELETE","lineNumber":225,"oldContent":""},{"type":"DELETE","lineNumber":226,"oldContent":"      // State will be updated by the authStateChanges listener"},{"type":"INSERT","lineNumber":223,"content":"      // Send OTP for phone verification"},{"type":"INSERT","lineNumber":224,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":225,"content":"        status: AuthStatus.otpSent,"},{"type":"INSERT","lineNumber":226,"content":"        user: credential.user,"},{"type":"INSERT","lineNumber":227,"content":"      );"},{"type":"INSERT","lineNumber":228,"content":"      "},{"type":"INSERT","lineNumber":229,"content":"      // Trigger OTP sending"},{"type":"INSERT","lineNumber":230,"content":"      add(SendOtpRequested(event.phoneNumber));"},{"type":"INSERT","lineNumber":231,"content":"      "},{"type":"DELETE","lineNumber":279,"oldContent":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":285,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":289,"content":"            completer.completeError(e);"},{"type":"DELETE","lineNumber":285,"oldContent":"          }"},{"type":"DELETE","lineNumber":290,"oldContent":"          String errorMessage = _getErrorMessage(e.code);"},{"type":"INSERT","lineNumber":296,"content":"          String errorMessage = _getErrorMessage(e.code);"},{"type":"INSERT","lineNumber":304,"content":"            status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":300,"oldContent":"            error: errorMessage,"},{"type":"DELETE","lineNumber":318,"oldContent":"            status: AuthStatus.otpTimeout,"},{"type":"DELETE","lineNumber":320,"oldContent":"            verificationId: verificationId,"},{"type":"DELETE","lineNumber":322,"oldContent":"          ));"},{"type":"INSERT","lineNumber":326,"content":"            status: AuthStatus.otpTimeout,"},{"type":"INSERT","lineNumber":327,"content":"            verificationId: verificationId,"},{"type":"INSERT","lineNumber":328,"content":"          ));"},{"type":"DELETE","lineNumber":333,"oldContent":"        timeout: const Duration(seconds: 60),"},{"type":"INSERT","lineNumber":340,"content":"        timeout: const Duration(seconds: 60),"},{"type":"DELETE","lineNumber":337,"oldContent":"      // Wait for the verification process to complete"},{"type":"INSERT","lineNumber":343,"content":"      // Wait for the verification process to complete"},{"type":"DELETE","lineNumber":340,"oldContent":"        ));"},{"type":"INSERT","lineNumber":346,"content":"      if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":347,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":348,"content":"          status: AuthStatus.error,"},{"type":"INSERT","lineNumber":349,"content":"          error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":350,"content":"        ));"},{"type":"INSERT","lineNumber":352,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":344,"oldContent":"  }"},{"type":"INSERT","lineNumber":356,"content":"          error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"INSERT","lineNumber":357,"content":"        ));"},{"type":"INSERT","lineNumber":358,"content":"      }"},{"type":"INSERT","lineNumber":359,"content":"    }"},{"type":"INSERT","lineNumber":360,"content":"  }"},{"type":"DELETE","lineNumber":348,"oldContent":"          error: _getErrorMessage(e.code),"},{"type":"DELETE","lineNumber":351,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":353,"oldContent":"      if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":355,"oldContent":"        emit(state.copyWith("},{"type":"DELETE","lineNumber":356,"oldContent":"          status: AuthStatus.error,"},{"type":"DELETE","lineNumber":358,"oldContent":"          error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"DELETE","lineNumber":360,"oldContent":"        ));"},{"type":"INSERT","lineNumber":368,"content":"      "},{"type":"INSERT","lineNumber":369,"content":"      // For testing: Auto-verify if OTP is 000000"},{"type":"INSERT","lineNumber":370,"content":"      if (event.smsCode == '000000') {"},{"type":"INSERT","lineNumber":371,"content":"        // Create a mock user for testing"},{"type":"INSERT","lineNumber":373,"content":"          status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":374,"content":"          user: _auth.currentUser,"},{"type":"INSERT","lineNumber":375,"content":"          isNewUser: true,"},{"type":"INSERT","lineNumber":376,"content":"        ));"},{"type":"INSERT","lineNumber":377,"content":"        return;"},{"type":"DELETE","lineNumber":364,"oldContent":"    }"},{"type":"DELETE","lineNumber":370,"oldContent":"      "},{"type":"DELETE","lineNumber":372,"oldContent":"      // For testing: Auto-verify if OTP is 000000"},{"type":"DELETE","lineNumber":373,"oldContent":"      if (event.smsCode == '000000') {"},{"type":"DELETE","lineNumber":375,"oldContent":"        // Create a mock user for testing"},{"type":"DELETE","lineNumber":377,"oldContent":"          status: AuthStatus.authenticated,"},{"type":"DELETE","lineNumber":379,"oldContent":"          user: _auth.currentUser,"},{"type":"DELETE","lineNumber":381,"oldContent":"          isNewUser: true,"},{"type":"DELETE","lineNumber":382,"oldContent":"        ));"},{"type":"DELETE","lineNumber":384,"oldContent":"        return;"},{"type":"DELETE","lineNumber":385,"oldContent":"      }"},{"type":"INSERT","lineNumber":404,"content":"      ));"},{"type":"INSERT","lineNumber":405,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":406,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":407,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":408,"content":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"INSERT","lineNumber":409,"content":"      ));"},{"type":"INSERT","lineNumber":410,"content":"    }"},{"type":"INSERT","lineNumber":411,"content":"  }"},{"type":"INSERT","lineNumber":412,"content":""},{"type":"DELETE","lineNumber":403,"oldContent":"      ));"},{"type":"DELETE","lineNumber":405,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":406,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":408,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":409,"oldContent":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"DELETE","lineNumber":411,"oldContent":"      ));"},{"type":"DELETE","lineNumber":413,"oldContent":"    }"},{"type":"DELETE","lineNumber":415,"oldContent":"  }"},{"type":"DELETE","lineNumber":417,"oldContent":""}]},{"timestamp":1754644760631,"changes":[{"type":"DELETE","lineNumber":227,"oldContent":"      );"},{"type":"DELETE","lineNumber":228,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":227,"content":"      ));"},{"type":"DELETE","lineNumber":230,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":232,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":234,"oldContent":"        error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":232,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":233,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":234,"content":"        status: AuthStatus.error,"},{"type":"INSERT","lineNumber":235,"content":"        error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":285,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":289,"content":"            completer.completeError(e);"},{"type":"DELETE","lineNumber":289,"oldContent":"            emit(state.copyWith("},{"type":"DELETE","lineNumber":293,"oldContent":"            completer.completeError(e);"},{"type":"INSERT","lineNumber":296,"content":"          String errorMessage = _getErrorMessage(e.code);"},{"type":"DELETE","lineNumber":300,"oldContent":"          String errorMessage = _getErrorMessage(e.code);"},{"type":"INSERT","lineNumber":304,"content":"            status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":308,"oldContent":"            status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":326,"content":"            status: AuthStatus.otpTimeout,"},{"type":"INSERT","lineNumber":327,"content":"            verificationId: verificationId,"},{"type":"INSERT","lineNumber":328,"content":"          ));"},{"type":"DELETE","lineNumber":328,"oldContent":"            status: AuthStatus.otpTimeout,"},{"type":"DELETE","lineNumber":330,"oldContent":"            verificationId: verificationId,"},{"type":"DELETE","lineNumber":332,"oldContent":"          ));"},{"type":"INSERT","lineNumber":340,"content":"        timeout: const Duration(seconds: 60),"},{"type":"INSERT","lineNumber":343,"content":"      // Wait for the verification process to complete"},{"type":"DELETE","lineNumber":343,"oldContent":"        timeout: const Duration(seconds: 60),"},{"type":"DELETE","lineNumber":345,"oldContent":"      }"},{"type":"DELETE","lineNumber":346,"oldContent":"      // Wait for the verification process to complete"},{"type":"DELETE","lineNumber":349,"oldContent":"      if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":351,"oldContent":"        emit(state.copyWith("},{"type":"DELETE","lineNumber":352,"oldContent":""},{"type":"DELETE","lineNumber":353,"oldContent":"          status: AuthStatus.error,"},{"type":"DELETE","lineNumber":355,"oldContent":"  Future<void> _onVerifyOtpRequested("},{"type":"DELETE","lineNumber":357,"oldContent":"    VerifyOtpRequested event,"},{"type":"INSERT","lineNumber":351,"content":"      }"},{"type":"DELETE","lineNumber":359,"oldContent":"    Emitter<AuthState> emit,"},{"type":"DELETE","lineNumber":360,"oldContent":"  ) async {"},{"type":"INSERT","lineNumber":353,"content":"      if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":354,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":355,"content":"          status: AuthStatus.error,"},{"type":"DELETE","lineNumber":363,"oldContent":"    try {"},{"type":"DELETE","lineNumber":366,"oldContent":"      emit(state.copyWith(status: AuthStatus.verificationInProgress));"},{"type":"INSERT","lineNumber":361,"content":""},{"type":"INSERT","lineNumber":362,"content":"  Future<void> _onVerifyOtpRequested("},{"type":"INSERT","lineNumber":363,"content":"    VerifyOtpRequested event,"},{"type":"INSERT","lineNumber":364,"content":"    Emitter<AuthState> emit,"},{"type":"INSERT","lineNumber":365,"content":"  ) async {"},{"type":"INSERT","lineNumber":366,"content":"    try {"},{"type":"INSERT","lineNumber":367,"content":"      emit(state.copyWith(status: AuthStatus.verificationInProgress));"},{"type":"INSERT","lineNumber":368,"content":"      "},{"type":"INSERT","lineNumber":369,"content":"      // For testing: Auto-verify if OTP is 000000"},{"type":"INSERT","lineNumber":370,"content":"      if (event.smsCode == '000000') {"},{"type":"INSERT","lineNumber":371,"content":"        // Create a mock user for testing"},{"type":"INSERT","lineNumber":373,"content":"          status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":374,"content":"          user: _auth.currentUser,"},{"type":"INSERT","lineNumber":375,"content":"          isNewUser: true,"},{"type":"INSERT","lineNumber":376,"content":"        ));"},{"type":"INSERT","lineNumber":377,"content":"        return;"},{"type":"DELETE","lineNumber":374,"oldContent":"      "},{"type":"DELETE","lineNumber":376,"oldContent":"      // For testing: Auto-verify if OTP is 000000"},{"type":"DELETE","lineNumber":378,"oldContent":"      if (event.smsCode == '000000') {"},{"type":"DELETE","lineNumber":379,"oldContent":"        // Create a mock user for testing"},{"type":"DELETE","lineNumber":381,"oldContent":"          status: AuthStatus.authenticated,"},{"type":"DELETE","lineNumber":382,"oldContent":"          user: _auth.currentUser,"},{"type":"DELETE","lineNumber":384,"oldContent":"          isNewUser: true,"},{"type":"DELETE","lineNumber":385,"oldContent":"        ));"},{"type":"DELETE","lineNumber":387,"oldContent":"        return;"},{"type":"DELETE","lineNumber":404,"oldContent":"  Future<void> _onLogoutRequested("},{"type":"DELETE","lineNumber":405,"oldContent":"    LogoutRequested event,"},{"type":"DELETE","lineNumber":406,"oldContent":"    Emitter<AuthState> emit,"},{"type":"DELETE","lineNumber":407,"oldContent":"  ) async {"},{"type":"DELETE","lineNumber":409,"oldContent":"    try {"},{"type":"DELETE","lineNumber":413,"oldContent":"      await _auth.signOut();"},{"type":"DELETE","lineNumber":417,"oldContent":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":413,"content":"  Future<void> _onLogoutRequested("},{"type":"INSERT","lineNumber":414,"content":"    LogoutRequested event,"},{"type":"INSERT","lineNumber":415,"content":"    Emitter<AuthState> emit,"},{"type":"INSERT","lineNumber":416,"content":"  ) async {"},{"type":"INSERT","lineNumber":417,"content":"    try {"},{"type":"INSERT","lineNumber":418,"content":"      await _auth.signOut();"},{"type":"INSERT","lineNumber":419,"content":"      emit(state.copyWith("}]},{"timestamp":1754644790800,"changes":[{"type":"INSERT","lineNumber":230,"content":"      add(SendOtpRequested(event.phoneNumber));"},{"type":"INSERT","lineNumber":231,"content":"      "},{"type":"DELETE","lineNumber":232,"oldContent":"      add(SendOtpRequested(event.phoneNumber));"},{"type":"DELETE","lineNumber":235,"oldContent":"      "},{"type":"MODIFY","lineNumber":290,"content":"          }","oldContent":"          }"},{"type":"DELETE","lineNumber":327,"oldContent":"          completer.complete();"},{"type":"MODIFY","lineNumber":329,"content":"          completer.complete();","oldContent":"        }"},{"type":"INSERT","lineNumber":330,"content":"        }"},{"type":"MODIFY","lineNumber":344,"content":"      await completer.future;","oldContent":"      await completer.future;"},{"type":"INSERT","lineNumber":349,"content":"          error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":350,"content":"        ));"},{"type":"INSERT","lineNumber":352,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":352,"oldContent":"          error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":356,"content":"          error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"DELETE","lineNumber":355,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":358,"content":"      }"},{"type":"INSERT","lineNumber":359,"content":"    }"},{"type":"INSERT","lineNumber":360,"content":"  }"},{"type":"DELETE","lineNumber":357,"oldContent":"          error: 'Failed to send OTP. Please check your connection and try again.',"},{"type":"DELETE","lineNumber":359,"oldContent":"        ));"},{"type":"DELETE","lineNumber":362,"oldContent":"      }"},{"type":"DELETE","lineNumber":364,"oldContent":"    }"},{"type":"DELETE","lineNumber":367,"oldContent":"  }"},{"type":"DELETE","lineNumber":369,"oldContent":"        emit(state.copyWith("},{"type":"MODIFY","lineNumber":371,"content":"        // Just update the state to verified, don't sign in again","oldContent":"      }"},{"type":"INSERT","lineNumber":372,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":373,"content":"          status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":374,"content":"          user: _auth.currentUser,"},{"type":"INSERT","lineNumber":375,"content":"          isNewUser: _auth.currentUser?.metadata.creationTime == _auth.currentUser?.metadata.lastSignInTime,"},{"type":"INSERT","lineNumber":376,"content":"        ));"},{"type":"INSERT","lineNumber":377,"content":"        return;"},{"type":"INSERT","lineNumber":378,"content":"      }"},{"type":"DELETE","lineNumber":374,"oldContent":"        // Create a mock user for testing"},{"type":"DELETE","lineNumber":377,"oldContent":"          status: AuthStatus.authenticated,"},{"type":"DELETE","lineNumber":379,"oldContent":"          user: _auth.currentUser,"},{"type":"DELETE","lineNumber":380,"oldContent":"          isNewUser: true,"},{"type":"DELETE","lineNumber":382,"oldContent":"        ));"},{"type":"DELETE","lineNumber":383,"oldContent":"        return;"},{"type":"DELETE","lineNumber":385,"oldContent":"      final userCredential = await _auth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":386,"oldContent":"      "},{"type":"DELETE","lineNumber":387,"oldContent":"      if (userCredential.user != null) {"},{"type":"DELETE","lineNumber":388,"oldContent":"        // Update user data in the state"},{"type":"INSERT","lineNumber":385,"content":"      // If user is already signed in (during registration), link the phone credential"},{"type":"INSERT","lineNumber":386,"content":"      if (_auth.currentUser != null) {"},{"type":"INSERT","lineNumber":387,"content":"        await _auth.currentUser!.linkWithCredential(credential);"},{"type":"DELETE","lineNumber":391,"oldContent":"          user: userCredential.user,"},{"type":"DELETE","lineNumber":392,"oldContent":"          isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"INSERT","lineNumber":390,"content":"          user: _auth.currentUser,"},{"type":"DELETE","lineNumber":395,"oldContent":"        emit(state.copyWith("},{"type":"DELETE","lineNumber":396,"oldContent":"          status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":397,"oldContent":"          error: 'User not found after verification',"},{"type":"DELETE","lineNumber":398,"oldContent":"        ));"},{"type":"INSERT","lineNumber":393,"content":"        // For login with phone number"},{"type":"INSERT","lineNumber":394,"content":"        final userCredential = await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":395,"content":"        "},{"type":"INSERT","lineNumber":396,"content":"        if (userCredential.user != null) {"},{"type":"INSERT","lineNumber":397,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":398,"content":"            status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":399,"content":"            user: userCredential.user,"},{"type":"INSERT","lineNumber":400,"content":"            isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"INSERT","lineNumber":401,"content":"          ));"},{"type":"INSERT","lineNumber":402,"content":"        } else {"},{"type":"INSERT","lineNumber":403,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":404,"content":"            status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":405,"content":"            error: 'User not found after verification',"},{"type":"INSERT","lineNumber":406,"content":"          ));"},{"type":"INSERT","lineNumber":407,"content":"        }"},{"type":"INSERT","lineNumber":417,"content":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"INSERT","lineNumber":418,"content":"      ));"},{"type":"INSERT","lineNumber":419,"content":"    }"},{"type":"INSERT","lineNumber":420,"content":"  }"},{"type":"INSERT","lineNumber":421,"content":""},{"type":"DELETE","lineNumber":410,"oldContent":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"DELETE","lineNumber":412,"oldContent":"      ));"},{"type":"DELETE","lineNumber":414,"oldContent":"    }"},{"type":"DELETE","lineNumber":417,"oldContent":"  }"},{"type":"DELETE","lineNumber":419,"oldContent":""}]},{"timestamp":1754645212139,"changes":[{"type":"INSERT","lineNumber":26,"content":"  final String? phoneNumber;"},{"type":"INSERT","lineNumber":35,"content":"    this.phoneNumber,"},{"type":"INSERT","lineNumber":45,"content":"    String? phoneNumber,"},{"type":"INSERT","lineNumber":54,"content":"      phoneNumber: phoneNumber ?? this.phoneNumber,"},{"type":"DELETE","lineNumber":231,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":236,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":293,"content":"            completer.completeError(e);"},{"type":"DELETE","lineNumber":290,"oldContent":"          }"},{"type":"INSERT","lineNumber":332,"content":"          ));"},{"type":"DELETE","lineNumber":330,"oldContent":"          ));"},{"type":"INSERT","lineNumber":347,"content":"      // Wait for the verification process to complete"},{"type":"DELETE","lineNumber":344,"oldContent":"      await completer.future;"},{"type":"DELETE","lineNumber":350,"oldContent":"      }"},{"type":"INSERT","lineNumber":355,"content":"      }"},{"type":"INSERT","lineNumber":356,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":354,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":356,"oldContent":"        ));"},{"type":"DELETE","lineNumber":358,"oldContent":""},{"type":"INSERT","lineNumber":361,"content":"        ));"},{"type":"DELETE","lineNumber":360,"oldContent":"  Future<void> _onVerifyOtpRequested("},{"type":"INSERT","lineNumber":365,"content":""},{"type":"INSERT","lineNumber":366,"content":"  Future<void> _onVerifyOtpRequested("},{"type":"INSERT","lineNumber":374,"content":"      if (event.smsCode == '000000') {"},{"type":"DELETE","lineNumber":372,"oldContent":"      if (event.smsCode == '000000') {"},{"type":"DELETE","lineNumber":374,"oldContent":"      "},{"type":"DELETE","lineNumber":377,"oldContent":"      final credential = PhoneAuthProvider.credential("},{"type":"DELETE","lineNumber":379,"oldContent":"        verificationId: event.verificationId,"},{"type":"INSERT","lineNumber":383,"content":"      "},{"type":"INSERT","lineNumber":384,"content":"      final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":385,"content":"        verificationId: event.verificationId,"},{"type":"DELETE","lineNumber":389,"oldContent":"          user: _auth.currentUser,"},{"type":"DELETE","lineNumber":391,"oldContent":"        // For login with phone number"},{"type":"INSERT","lineNumber":394,"content":"          user: _auth.currentUser,"},{"type":"DELETE","lineNumber":393,"oldContent":"        final userCredential = await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":397,"content":"        // For login with phone number"},{"type":"INSERT","lineNumber":398,"content":"        final userCredential = await _auth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":400,"oldContent":"      }"},{"type":"DELETE","lineNumber":402,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":404,"oldContent":"      emit(state.copyWith("},{"type":"DELETE","lineNumber":406,"oldContent":"        status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":408,"oldContent":"        error: _getErrorMessage(e.code),"},{"type":"DELETE","lineNumber":410,"oldContent":"      ));"},{"type":"DELETE","lineNumber":412,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":414,"oldContent":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":412,"content":"      }"},{"type":"INSERT","lineNumber":413,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"INSERT","lineNumber":414,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":415,"content":"        status: AuthStatus.verificationFailed,"},{"type":"INSERT","lineNumber":416,"content":"        error: _getErrorMessage(e.code),"},{"type":"INSERT","lineNumber":417,"content":"      ));"},{"type":"INSERT","lineNumber":418,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":419,"content":"      emit(state.copyWith("},{"type":"INSERT","lineNumber":421,"content":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"INSERT","lineNumber":422,"content":"      ));"},{"type":"INSERT","lineNumber":423,"content":"    }"},{"type":"INSERT","lineNumber":424,"content":"  }"},{"type":"INSERT","lineNumber":425,"content":""},{"type":"DELETE","lineNumber":423,"oldContent":"        error: 'Failed to verify OTP. Please try again.',"},{"type":"DELETE","lineNumber":424,"oldContent":"      ));"},{"type":"DELETE","lineNumber":426,"oldContent":"    }"},{"type":"DELETE","lineNumber":427,"oldContent":"  }"},{"type":"DELETE","lineNumber":429,"oldContent":""}]},{"timestamp":1754645287326,"changes":[{"type":"MODIFY","lineNumber":36,"content":"    this.resendToken,","oldContent":"    this.resendToken,"},{"type":"INSERT","lineNumber":45,"content":"    String? phoneNumber,"},{"type":"DELETE","lineNumber":47,"oldContent":"    String? phoneNumber,"},{"type":"INSERT","lineNumber":54,"content":"      phoneNumber: phoneNumber ?? this.phoneNumber,"},{"type":"DELETE","lineNumber":57,"oldContent":"      phoneNumber: phoneNumber ?? this.phoneNumber,"},{"type":"INSERT","lineNumber":236,"content":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":239,"oldContent":"    } on FirebaseAuthException catch (e) {"},{"type":"DELETE","lineNumber":253,"oldContent":"    // Create a Completer to handle the async operation"},{"type":"INSERT","lineNumber":276,"content":"      // Store the formatted phone number in state"},{"type":"INSERT","lineNumber":277,"content":"      emit(state.copyWith(phoneNumber: formattedPhoneNumber));"},{"type":"INSERT","lineNumber":278,"content":""},{"type":"DELETE","lineNumber":280,"oldContent":"          await _auth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":281,"oldContent":"          if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":282,"content":"          // If user is already signed in (registration flow), link the phone credential"},{"type":"INSERT","lineNumber":283,"content":"          if (_auth.currentUser != null) {"},{"type":"INSERT","lineNumber":284,"content":"            await _auth.currentUser!.linkWithCredential(credential);"},{"type":"INSERT","lineNumber":287,"content":"              user: _auth.currentUser,"},{"type":"INSERT","lineNumber":289,"content":"          } else {"},{"type":"INSERT","lineNumber":290,"content":"            // For login flow, sign in with the credential"},{"type":"INSERT","lineNumber":291,"content":"            final userCredential = await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":292,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":293,"content":"              status: AuthStatus.verificationSuccessful,"},{"type":"INSERT","lineNumber":294,"content":"              user: userCredential.user,"},{"type":"INSERT","lineNumber":295,"content":"              isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"INSERT","lineNumber":296,"content":"            ));"},{"type":"INSERT","lineNumber":297,"content":"          }"},{"type":"INSERT","lineNumber":298,"content":"          if (!completer.isCompleted) {"},{"type":"INSERT","lineNumber":307,"content":"            completer.completeError(e);"},{"type":"DELETE","lineNumber":296,"oldContent":"            completer.completeError(e);"},{"type":"DELETE","lineNumber":321,"oldContent":"            error: null, // Clear any previous errors"},{"type":"INSERT","lineNumber":335,"content":"            phoneNumber: formattedPhoneNumber, // Store the formatted phone number"},{"type":"INSERT","lineNumber":346,"content":"          ));"},{"type":"DELETE","lineNumber":335,"oldContent":"          ));"},{"type":"INSERT","lineNumber":361,"content":"      // Wait for the verification process to complete"},{"type":"DELETE","lineNumber":350,"oldContent":"      // Wait for the verification process to complete"},{"type":"INSERT","lineNumber":369,"content":"      }"},{"type":"INSERT","lineNumber":370,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":357,"oldContent":"      }"},{"type":"DELETE","lineNumber":359,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":361,"oldContent":"      }"},{"type":"INSERT","lineNumber":376,"content":"      }"},{"type":"INSERT","lineNumber":379,"content":""},{"type":"INSERT","lineNumber":380,"content":"  Future<void> _onVerifyOtpRequested("},{"type":"DELETE","lineNumber":367,"oldContent":""},{"type":"DELETE","lineNumber":369,"oldContent":"  Future<void> _onVerifyOtpRequested("},{"type":"DELETE","lineNumber":373,"oldContent":"      // For testing: Auto-verify if OTP is 000000"},{"type":"DELETE","lineNumber":374,"oldContent":"        // Just update the state to verified, don't sign in again"},{"type":"DELETE","lineNumber":375,"oldContent":"        emit(state.copyWith("},{"type":"DELETE","lineNumber":376,"oldContent":"          status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":387,"content":"      // For testing purposes, allow any OTP"},{"type":"DELETE","lineNumber":378,"oldContent":"          user: _auth.currentUser,"},{"type":"DELETE","lineNumber":379,"oldContent":"          isNewUser: _auth.currentUser?.metadata.creationTime == _auth.currentUser?.metadata.lastSignInTime,"},{"type":"DELETE","lineNumber":380,"oldContent":"        ));"},{"type":"INSERT","lineNumber":389,"content":"        // If user is already signed in (registration flow), just update the state"},{"type":"INSERT","lineNumber":390,"content":"        if (_auth.currentUser != null) {"},{"type":"INSERT","lineNumber":391,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":392,"content":"            status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":393,"content":"            user: _auth.currentUser,"},{"type":"INSERT","lineNumber":394,"content":"            isNewUser: _auth.currentUser?.metadata.creationTime == _auth.currentUser?.metadata.lastSignInTime,"},{"type":"INSERT","lineNumber":395,"content":"          ));"},{"type":"INSERT","lineNumber":396,"content":"        } else {"},{"type":"INSERT","lineNumber":397,"content":"          // For login flow, create a test user"},{"type":"INSERT","lineNumber":398,"content":"          final testCredential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":399,"content":"            verificationId: event.verificationId,"},{"type":"INSERT","lineNumber":400,"content":"            smsCode: '000000',"},{"type":"INSERT","lineNumber":401,"content":"          );"},{"type":"INSERT","lineNumber":402,"content":"          final userCredential = await _auth.signInWithCredential(testCredential);"},{"type":"INSERT","lineNumber":403,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":404,"content":"            status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":405,"content":"            user: userCredential.user,"},{"type":"INSERT","lineNumber":406,"content":"            isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"INSERT","lineNumber":407,"content":"          ));"},{"type":"INSERT","lineNumber":408,"content":"        }"},{"type":"INSERT","lineNumber":411,"content":""},{"type":"INSERT","lineNumber":412,"content":"      // Create a PhoneAuthCredential with the code"},{"type":"INSERT","lineNumber":413,"content":"      final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":414,"content":"        verificationId: event.verificationId,"},{"type":"DELETE","lineNumber":384,"oldContent":"      "},{"type":"DELETE","lineNumber":386,"oldContent":"      final credential = PhoneAuthProvider.credential("},{"type":"DELETE","lineNumber":388,"oldContent":"        verificationId: event.verificationId,"},{"type":"DELETE","lineNumber":389,"oldContent":"      // If user is already signed in (during registration), link the phone credential"},{"type":"INSERT","lineNumber":418,"content":"      // If user is already signed in (registration flow), link the phone credential"},{"type":"DELETE","lineNumber":394,"oldContent":"        ));"},{"type":"INSERT","lineNumber":424,"content":"        ));"},{"type":"DELETE","lineNumber":397,"oldContent":"        "},{"type":"INSERT","lineNumber":426,"content":"        // For login flow, sign in with the credential"},{"type":"INSERT","lineNumber":427,"content":"        final userCredential = await _auth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":399,"oldContent":"        // For login with phone number"},{"type":"DELETE","lineNumber":401,"oldContent":"        final userCredential = await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":438,"content":"          ));"},{"type":"INSERT","lineNumber":439,"content":"        }"},{"type":"DELETE","lineNumber":412,"oldContent":"          ));"},{"type":"DELETE","lineNumber":415,"oldContent":"        }"},{"type":"DELETE","lineNumber":417,"oldContent":"        status: AuthStatus.error,"},{"type":"DELETE","lineNumber":419,"oldContent":"  Future<void> _onLogoutRequested("},{"type":"DELETE","lineNumber":421,"oldContent":"    LogoutRequested event,"},{"type":"DELETE","lineNumber":423,"oldContent":"    Emitter<AuthState> emit,"},{"type":"DELETE","lineNumber":424,"oldContent":"  ) async {"},{"type":"INSERT","lineNumber":448,"content":"        status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":426,"oldContent":"    try {"},{"type":"DELETE","lineNumber":428,"oldContent":"      await _auth.signOut();"},{"type":"INSERT","lineNumber":454,"content":"  Future<void> _onLogoutRequested("},{"type":"INSERT","lineNumber":455,"content":"    LogoutRequested event,"},{"type":"INSERT","lineNumber":456,"content":"    Emitter<AuthState> emit,"},{"type":"INSERT","lineNumber":457,"content":"  ) async {"},{"type":"INSERT","lineNumber":458,"content":"    try {"},{"type":"INSERT","lineNumber":459,"content":"      await _auth.signOut();"}]},{"timestamp":1754653662017,"changes":[{"type":"INSERT","lineNumber":5,"content":"import 'package:cloud_firestore/cloud_firestore.dart';"},{"type":"INSERT","lineNumber":6,"content":"import 'package:family_tree_firebase/features/auth/domain/models/user_model.dart';"},{"type":"INSERT","lineNumber":37,"content":"    this.phoneNumber,"},{"type":"DELETE","lineNumber":36,"oldContent":"    this.resendToken,"},{"type":"INSERT","lineNumber":229,"content":"      // Create user document in Firestore"},{"type":"INSERT","lineNumber":230,"content":"      if (credential.user != null) {"},{"type":"INSERT","lineNumber":231,"content":"        final user = UserModel("},{"type":"INSERT","lineNumber":232,"content":"          id: credential.user!.uid,"},{"type":"INSERT","lineNumber":233,"content":"          name: event.name,"},{"type":"INSERT","lineNumber":234,"content":"          phoneNumber: event.phoneNumber,"},{"type":"INSERT","lineNumber":235,"content":"          email: event.email,"},{"type":"INSERT","lineNumber":236,"content":"          createdAt: DateTime.now(),"},{"type":"INSERT","lineNumber":237,"content":"          updatedAt: DateTime.now(),"},{"type":"INSERT","lineNumber":238,"content":"        );"},{"type":"INSERT","lineNumber":239,"content":"        "},{"type":"INSERT","lineNumber":240,"content":"        await FirebaseFirestore.instance"},{"type":"INSERT","lineNumber":241,"content":"            .collection('users')"},{"type":"INSERT","lineNumber":242,"content":"            .doc(credential.user!.uid)"},{"type":"INSERT","lineNumber":243,"content":"            .set(user.toJson());"},{"type":"INSERT","lineNumber":244,"content":"      }"},{"type":"INSERT","lineNumber":245,"content":"      "},{"type":"DELETE","lineNumber":275,"oldContent":"      // Store the formatted phone number in state"},{"type":"INSERT","lineNumber":295,"content":"      // Store the formatted phone number in state"},{"type":"DELETE","lineNumber":278,"oldContent":"      // Handle verification callbacks"},{"type":"INSERT","lineNumber":298,"content":"      // Handle verification callbacks"},{"type":"DELETE","lineNumber":283,"oldContent":"            emit(state.copyWith("},{"type":"DELETE","lineNumber":285,"oldContent":"              status: AuthStatus.verificationSuccessful,"},{"type":"INSERT","lineNumber":304,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":305,"content":"              status: AuthStatus.verificationSuccessful,"},{"type":"INSERT","lineNumber":306,"content":"              user: _auth.currentUser,"},{"type":"INSERT","lineNumber":308,"content":"          } else {"},{"type":"INSERT","lineNumber":309,"content":"            // For login flow, sign in with the credential"},{"type":"INSERT","lineNumber":310,"content":"            final userCredential = await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":311,"content":"            emit(state.copyWith("},{"type":"INSERT","lineNumber":312,"content":"              status: AuthStatus.verificationSuccessful,"},{"type":"INSERT","lineNumber":313,"content":"              user: userCredential.user,"},{"type":"INSERT","lineNumber":314,"content":"              isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"INSERT","lineNumber":315,"content":"            ));"},{"type":"INSERT","lineNumber":316,"content":"          }"},{"type":"INSERT","lineNumber":317,"content":"          if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":290,"oldContent":"              user: _auth.currentUser,"},{"type":"DELETE","lineNumber":293,"oldContent":"          } else {"},{"type":"DELETE","lineNumber":295,"oldContent":"            // For login flow, sign in with the credential"},{"type":"DELETE","lineNumber":297,"oldContent":"            final userCredential = await _auth.signInWithCredential(credential);"},{"type":"DELETE","lineNumber":299,"oldContent":"            emit(state.copyWith("},{"type":"DELETE","lineNumber":301,"oldContent":"              status: AuthStatus.verificationSuccessful,"},{"type":"INSERT","lineNumber":326,"content":"            completer.completeError(e);"},{"type":"DELETE","lineNumber":303,"oldContent":"              user: userCredential.user,"},{"type":"DELETE","lineNumber":305,"oldContent":"              isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"DELETE","lineNumber":307,"oldContent":"            ));"},{"type":"DELETE","lineNumber":308,"oldContent":"          }"},{"type":"DELETE","lineNumber":310,"oldContent":"          if (!completer.isCompleted) {"},{"type":"DELETE","lineNumber":320,"oldContent":"            completer.completeError(e);"},{"type":"INSERT","lineNumber":354,"content":"            phoneNumber: formattedPhoneNumber, // Store the formatted phone number"},{"type":"INSERT","lineNumber":365,"content":"          ));"},{"type":"DELETE","lineNumber":348,"oldContent":"            phoneNumber: formattedPhoneNumber, // Store the formatted phone number"},{"type":"DELETE","lineNumber":359,"oldContent":"          ));"},{"type":"INSERT","lineNumber":380,"content":"      // Wait for the verification process to complete"},{"type":"INSERT","lineNumber":388,"content":"      }"},{"type":"INSERT","lineNumber":389,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":372,"oldContent":"      // Wait for the verification process to complete"},{"type":"INSERT","lineNumber":395,"content":"      }"},{"type":"INSERT","lineNumber":398,"content":""},{"type":"INSERT","lineNumber":399,"content":"  Future<void> _onVerifyOtpRequested("},{"type":"DELETE","lineNumber":379,"oldContent":"      }"},{"type":"DELETE","lineNumber":380,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":384,"oldContent":"      }"},{"type":"DELETE","lineNumber":385,"oldContent":"      if (event.smsCode == '000000') {"},{"type":"DELETE","lineNumber":386,"oldContent":""},{"type":"DELETE","lineNumber":387,"oldContent":"  Future<void> _onVerifyOtpRequested("},{"type":"DELETE","lineNumber":388,"oldContent":"        return;"},{"type":"DELETE","lineNumber":389,"oldContent":"      }"},{"type":"DELETE","lineNumber":390,"oldContent":"        smsCode: event.smsCode,"},{"type":"DELETE","lineNumber":391,"oldContent":"      );"},{"type":"DELETE","lineNumber":393,"oldContent":""},{"type":"INSERT","lineNumber":407,"content":"      if (event.smsCode == '000000') {"},{"type":"DELETE","lineNumber":396,"oldContent":"      if (_auth.currentUser != null) {"},{"type":"INSERT","lineNumber":410,"content":"          // Ensure user document exists"},{"type":"INSERT","lineNumber":411,"content":"          await _ensureUserDocumentExists(_auth.currentUser!);"},{"type":"INSERT","lineNumber":412,"content":"          "},{"type":"DELETE","lineNumber":398,"oldContent":"        await _auth.currentUser!.linkWithCredential(credential);"},{"type":"DELETE","lineNumber":400,"oldContent":"        emit(state.copyWith("},{"type":"DELETE","lineNumber":402,"oldContent":"          status: AuthStatus.authenticated,"},{"type":"DELETE","lineNumber":405,"oldContent":"          user: _auth.currentUser,"},{"type":"DELETE","lineNumber":407,"oldContent":"      } else {"},{"type":"DELETE","lineNumber":410,"oldContent":"        if (userCredential.user != null) {"},{"type":"DELETE","lineNumber":413,"oldContent":"          emit(state.copyWith("},{"type":"DELETE","lineNumber":416,"oldContent":"            status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":425,"content":"          "},{"type":"INSERT","lineNumber":426,"content":"          // Ensure user document exists"},{"type":"INSERT","lineNumber":427,"content":"          if (userCredential.user != null) {"},{"type":"INSERT","lineNumber":428,"content":"            await _ensureUserDocumentExists(userCredential.user!);"},{"type":"INSERT","lineNumber":429,"content":"          }"},{"type":"INSERT","lineNumber":430,"content":"          "},{"type":"DELETE","lineNumber":418,"oldContent":"            user: userCredential.user,"},{"type":"DELETE","lineNumber":420,"oldContent":"            isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"INSERT","lineNumber":434,"content":"            isNewUser: userCredential.additionalUserInfo?.isNewUser ?? false,"},{"type":"INSERT","lineNumber":436,"content":"        }"},{"type":"INSERT","lineNumber":437,"content":"        return;"},{"type":"INSERT","lineNumber":438,"content":"      }"},{"type":"INSERT","lineNumber":439,"content":""},{"type":"INSERT","lineNumber":440,"content":"      // Create a PhoneAuthCredential with the code"},{"type":"INSERT","lineNumber":441,"content":"      final credential = PhoneAuthProvider.credential("},{"type":"INSERT","lineNumber":442,"content":"        verificationId: event.verificationId,"},{"type":"INSERT","lineNumber":443,"content":"        smsCode: event.smsCode,"},{"type":"INSERT","lineNumber":444,"content":"      );"},{"type":"INSERT","lineNumber":445,"content":""},{"type":"INSERT","lineNumber":446,"content":"      // If user is already signed in (registration flow), link the phone credential"},{"type":"INSERT","lineNumber":447,"content":"      if (_auth.currentUser != null) {"},{"type":"INSERT","lineNumber":448,"content":"        await _auth.currentUser!.linkWithCredential(credential);"},{"type":"INSERT","lineNumber":449,"content":"        "},{"type":"INSERT","lineNumber":450,"content":"        // Ensure user document exists"},{"type":"INSERT","lineNumber":451,"content":"        await _ensureUserDocumentExists(_auth.currentUser!);"},{"type":"INSERT","lineNumber":452,"content":"        "},{"type":"INSERT","lineNumber":453,"content":"        emit(state.copyWith("},{"type":"INSERT","lineNumber":454,"content":"          status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":455,"content":"          user: _auth.currentUser,"},{"type":"INSERT","lineNumber":456,"content":"        ));"},{"type":"INSERT","lineNumber":457,"content":"      } else {"},{"type":"INSERT","lineNumber":458,"content":"        // For login flow, sign in with the credential"},{"type":"INSERT","lineNumber":459,"content":"        final userCredential = await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":460,"content":"        if (userCredential.user != null) {"},{"type":"INSERT","lineNumber":461,"content":"          // Ensure user document exists"},{"type":"INSERT","lineNumber":462,"content":"          await _ensureUserDocumentExists(userCredential.user!);"},{"type":"INSERT","lineNumber":463,"content":"          "},{"type":"INSERT","lineNumber":464,"content":"          emit(state.copyWith("},{"type":"INSERT","lineNumber":465,"content":"            status: AuthStatus.authenticated,"},{"type":"INSERT","lineNumber":466,"content":"            user: userCredential.user,"},{"type":"DELETE","lineNumber":424,"oldContent":"        } else {"},{"type":"INSERT","lineNumber":469,"content":"        } else {"},{"type":"DELETE","lineNumber":427,"oldContent":"        }"},{"type":"INSERT","lineNumber":473,"content":"          ));"},{"type":"INSERT","lineNumber":474,"content":"        }"},{"type":"DELETE","lineNumber":431,"oldContent":""},{"type":"DELETE","lineNumber":433,"oldContent":"      // Create a PhoneAuthCredential with the code"},{"type":"DELETE","lineNumber":434,"oldContent":"      final credential = PhoneAuthProvider.credential("},{"type":"DELETE","lineNumber":436,"oldContent":"        verificationId: event.verificationId,"},{"type":"DELETE","lineNumber":439,"oldContent":"      // If user is already signed in (registration flow), link the phone credential"},{"type":"DELETE","lineNumber":443,"oldContent":"        ));"},{"type":"INSERT","lineNumber":483,"content":"        status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":445,"oldContent":"        // For login flow, sign in with the credential"},{"type":"DELETE","lineNumber":446,"oldContent":"        final userCredential = await _auth.signInWithCredential(credential);"},{"type":"INSERT","lineNumber":489,"content":"  Future<void> _onLogoutRequested("},{"type":"INSERT","lineNumber":490,"content":"    LogoutRequested event,"},{"type":"INSERT","lineNumber":491,"content":"    Emitter<AuthState> emit,"},{"type":"INSERT","lineNumber":492,"content":"  ) async {"},{"type":"INSERT","lineNumber":493,"content":"    try {"},{"type":"INSERT","lineNumber":494,"content":"      await _auth.signOut();"},{"type":"DELETE","lineNumber":457,"oldContent":"          ));"},{"type":"DELETE","lineNumber":459,"oldContent":"        }"},{"type":"INSERT","lineNumber":507,"content":"  // Helper method to ensure a user document exists in Firestore"},{"type":"INSERT","lineNumber":508,"content":"  Future<void> _ensureUserDocumentExists(User user) async {"},{"type":"INSERT","lineNumber":509,"content":"    final userDoc = await FirebaseFirestore.instance"},{"type":"INSERT","lineNumber":510,"content":"        .collection('users')"},{"type":"INSERT","lineNumber":511,"content":"        .doc(user.uid)"},{"type":"INSERT","lineNumber":512,"content":"        .get();"},{"type":"INSERT","lineNumber":513,"content":""},{"type":"INSERT","lineNumber":514,"content":"    if (!userDoc.exists) {"},{"type":"INSERT","lineNumber":515,"content":"      // Create a new user document if it doesn't exist"},{"type":"INSERT","lineNumber":516,"content":"      final newUser = UserModel("},{"type":"INSERT","lineNumber":517,"content":"        id: user.uid,"},{"type":"INSERT","lineNumber":518,"content":"        name: user.displayName ?? 'New User',"},{"type":"INSERT","lineNumber":519,"content":"        phoneNumber: user.phoneNumber ?? '',"},{"type":"INSERT","lineNumber":520,"content":"        email: user.email,"},{"type":"INSERT","lineNumber":521,"content":"        profileImageUrl: user.photoURL,"},{"type":"INSERT","lineNumber":522,"content":"        createdAt: DateTime.now(),"},{"type":"INSERT","lineNumber":523,"content":"        updatedAt: DateTime.now(),"},{"type":"INSERT","lineNumber":524,"content":"      );"},{"type":"INSERT","lineNumber":525,"content":"      "},{"type":"INSERT","lineNumber":526,"content":"      await FirebaseFirestore.instance"},{"type":"INSERT","lineNumber":527,"content":"          .collection('users')"},{"type":"INSERT","lineNumber":528,"content":"          .doc(user.uid)"},{"type":"INSERT","lineNumber":529,"content":"          .set(newUser.toJson());"},{"type":"INSERT","lineNumber":530,"content":"    }"},{"type":"INSERT","lineNumber":531,"content":"  }"},{"type":"INSERT","lineNumber":532,"content":""},{"type":"DELETE","lineNumber":469,"oldContent":"        status: AuthStatus.verificationFailed,"},{"type":"DELETE","lineNumber":476,"oldContent":"  Future<void> _onLogoutRequested("},{"type":"DELETE","lineNumber":478,"oldContent":"    LogoutRequested event,"},{"type":"DELETE","lineNumber":480,"oldContent":"    Emitter<AuthState> emit,"},{"type":"DELETE","lineNumber":482,"oldContent":"  ) async {"},{"type":"DELETE","lineNumber":484,"oldContent":"    try {"},{"type":"DELETE","lineNumber":486,"oldContent":"      await _auth.signOut();"}]}]},"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/presentation/screens/main_app_screen.dart":{"filePath":"/Users/rathin/Desktop/My_projects/family_tree_firebase/lib/features/home/presentation/screens/main_app_screen.dart","baseContent":"import 'package:flutter/material.dart';\nimport 'package:google_fonts/google_fonts.dart';\nimport 'package:family_tree_firebase/features/home/presentation/screens/home_screen.dart';\nimport 'package:family_tree_firebase/features/gifts/presentation/screens/gifts_screen.dart';\nimport 'package:family_tree_firebase/features/family/presentation/screens/family_home_screen.dart';\nimport 'package:family_tree_firebase/features/settings/presentation/screens/settings_screen.dart';\n\nclass MainAppScreen extends StatefulWidget {\n  const MainAppScreen({Key? key}) : super(key: key);\n\n  @override\n  _MainAppScreenState createState() => _MainAppScreenState();\n}\n\nclass _MainAppScreenState extends State<MainAppScreen> {\n  int _selectedIndex = 0;\n\n  final List<Widget> _screens = [\n    const HomeScreen(),\n    const GiftsScreen(),\n    const FamilyHomeScreen(),\n    const SettingsScreen(),\n  ];\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      body: _screens[_selectedIndex],\n      bottomNavigationBar: Container(\n        decoration: BoxDecoration(\n          boxShadow: [\n            BoxShadow(\n              color: Colors.grey.withOpacity(0.2),\n              spreadRadius: 1,\n              blurRadius: 10,\n              offset: const Offset(0, -2),\n            ),\n          ],\n        ),\n        child: BottomNavigationBar(\n          currentIndex: _selectedIndex,\n          onTap: (index) => setState(() => _selectedIndex = index),\n          type: BottomNavigationBarType.fixed,\n          selectedItemColor: const Color(0xFF6A11CB),\n          unselectedItemColor: Colors.grey[600],\n          selectedLabelStyle: GoogleFonts.poppins(fontSize: 12, fontWeight: FontWeight.w500),\n          unselectedLabelStyle: GoogleFonts.poppins(fontSize: 12, fontWeight: FontWeight.w500),\n          items: const [\n            BottomNavigationBarItem(\n              icon: Icon(Icons.home_outlined),\n              activeIcon: Icon(Icons.home_filled),\n              label: 'Home',\n            ),\n            BottomNavigationBarItem(\n              icon: Icon(Icons.card_giftcard_outlined),\n              activeIcon: Icon(Icons.card_giftcard),\n              label: 'Gifts',\n            ),\n            BottomNavigationBarItem(\n              icon: Icon(Icons.people_outline),\n              activeIcon: Icon(Icons.people),\n              label: 'Family',\n            ),\n            BottomNavigationBarItem(\n              icon: Icon(Icons.settings_outlined),\n              activeIcon: Icon(Icons.settings),\n              label: 'Settings',\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n\n// Keep only the SettingsScreen as a placeholder for now\nclass SettingsScreen extends StatelessWidget {\n  const SettingsScreen({Key? key}) : super(key: key);\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Settings'),\n      ),\n      body: const Center(\n        child: Text('Settings Screen - Coming Soon'),\n      ),\n    );\n  }\n}\n","baseTimestamp":1754655199120,"deltas":[{"timestamp":1754655228839,"changes":[{"type":"DELETE","lineNumber":5,"oldContent":"import 'package:family_tree_firebase/features/settings/presentation/screens/settings_screen.dart';"},{"type":"INSERT","lineNumber":6,"content":""}]},{"timestamp":1754655243930,"changes":[{"type":"INSERT","lineNumber":5,"content":"import 'package:family_tree_firebase/features/settings/presentation/screens/settings_screen.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":""},{"type":"DELETE","lineNumber":75,"oldContent":"// Keep only the SettingsScreen as a placeholder for now"},{"type":"DELETE","lineNumber":76,"oldContent":"class SettingsScreen extends StatelessWidget {"},{"type":"DELETE","lineNumber":77,"oldContent":"  const SettingsScreen({Key? key}) : super(key: key);"},{"type":"DELETE","lineNumber":79,"oldContent":"  @override"},{"type":"DELETE","lineNumber":80,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":81,"oldContent":"    return Scaffold("},{"type":"DELETE","lineNumber":82,"oldContent":"      appBar: AppBar("},{"type":"DELETE","lineNumber":83,"oldContent":"        title: const Text('Settings'),"},{"type":"DELETE","lineNumber":84,"oldContent":"      ),"},{"type":"DELETE","lineNumber":85,"oldContent":"      body: const Center("},{"type":"DELETE","lineNumber":86,"oldContent":"        child: Text('Settings Screen - Coming Soon'),"},{"type":"DELETE","lineNumber":87,"oldContent":"      ),"},{"type":"DELETE","lineNumber":88,"oldContent":"    );"},{"type":"DELETE","lineNumber":89,"oldContent":"  }"},{"type":"DELETE","lineNumber":90,"oldContent":"}"}]}]}}}